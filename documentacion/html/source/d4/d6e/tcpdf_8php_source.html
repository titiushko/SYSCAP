<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>SYSCAP: Fichero Fuente SYSCAPlibraries/tcpdf/tcpdf.php</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">SYSCAP
   &#160;<span id="projectnumber">1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generado por Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Buscar');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Página&#160;principal</span></a></li>
      <li><a href="../../annotated.html"><span>Estructuras&#160;de&#160;Datos</span></a></li>
      <li class="current"><a href="../../files.html"><span>Archivos</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Buscar" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>Lista&#160;de&#160;archivos</span></a></li>
      <li><a href="../../globals.html"><span>Globales</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_b16de32928bda842420f443066771e9c.html">syscap</a></li><li class="navelem"><a class="el" href="../../dir_1ad257335a35d4d2c12c935abad2321e.html">application</a></li><li class="navelem"><a class="el" href="../../dir_e10108077aaa9f056d90648ede8de600.html">libraries</a></li><li class="navelem"><a class="el" href="../../dir_7bc1fe1325c75e08aa7f68b2bd45cfd5.html">tcpdf</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">tcpdf.php</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d4/d6e/tcpdf_8php.html">Ir a la documentación de este archivo.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;&lt;?php</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//============================================================+</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// File name   : tcpdf.php</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// Version     : 6.0.097</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// Begin       : 2002-08-03</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// Last Update : 2014-10-20</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// Author      : Nicola Asuni - Tecnick.com LTD - www.tecnick.com - info@tecnick.com</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// License     : GNU-LGPL v3 (http://www.gnu.org/copyleft/lesser.html)</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// -------------------------------------------------------------------</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// Copyright (C) 2002-2014 Nicola Asuni - Tecnick.com LTD</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// This file is part of TCPDF software library.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">// TCPDF is free software: you can redistribute it and/or modify it</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// under the terms of the GNU Lesser General Public License as</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">// published by the Free Software Foundation, either version 3 of the</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">// License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">// TCPDF is distributed in the hope that it will be useful, but</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">// WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">// See the GNU Lesser General Public License for more details.</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">// You should have received a copy of the License</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">// along with TCPDF. If not, see</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">// &lt;http://www.tecnick.com/pagefiles/tcpdf/LICENSE.TXT&gt;.</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">// See LICENSE.TXT file for more information.</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">// -------------------------------------------------------------------</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">// Description :</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">//   This is a PHP class for generating PDF documents without requiring external extensions.</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">// NOTE:</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">//   This class was originally derived in 2002 from the Public</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">//   Domain FPDF class by Olivier Plathey (http://www.fpdf.org),</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">//   but now is almost entirely rewritten and contains thousands of</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">//   new lines of code and hundreds new features.</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">// Main features:</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">//  * no external libraries are required for the basic functions;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">//  * all standard page formats, custom page formats, custom margins and units of measure;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">//  * UTF-8 Unicode and Right-To-Left languages;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">//  * TrueTypeUnicode, TrueType, Type1 and CID-0 fonts;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">//  * font subsetting;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">//  * methods to publish some XHTML + CSS code, Javascript and Forms;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">//  * images, graphic (geometric figures) and transformation methods;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">//  * supports JPEG, PNG and SVG images natively, all images supported by GD (GD, GD2, GD2PART, GIF, JPEG, PNG, BMP, XBM, XPM) and all images supported via ImagMagick (http://www.imagemagick.org/www/formats.html)</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">//  * 1D and 2D barcodes: CODE 39, ANSI MH10.8M-1983, USD-3, 3 of 9, CODE 93, USS-93, Standard 2 of 5, Interleaved 2 of 5, CODE 128 A/B/C, 2 and 5 Digits UPC-Based Extention, EAN 8, EAN 13, UPC-A, UPC-E, MSI, POSTNET, PLANET, RMS4CC (Royal Mail 4-state Customer Code), CBC (Customer Bar Code), KIX (Klant index - Customer index), Intelligent Mail Barcode, Onecode, USPS-B-3200, CODABAR, CODE 11, PHARMACODE, PHARMACODE TWO-TRACKS, Datamatrix, QR-Code, PDF417;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">//  * JPEG and PNG ICC profiles, Grayscale, RGB, CMYK, Spot Colors and Transparencies;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">//  * automatic page header and footer management;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">//  * document encryption up to 256 bit and digital signature certifications;</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">//  * transactions to UNDO commands;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">//  * PDF annotations, including links, text and file attachments;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">//  * text rendering modes (fill, stroke and clipping);</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">//  * multiple columns mode;</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">//  * no-write page regions;</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">//  * bookmarks, named destinations and table of content;</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">//  * text hyphenation;</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">//  * text stretching and spacing (tracking);</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">//  * automatic page break, line break and text alignments including justification;</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">//  * automatic page numbering and page groups;</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">//  * move and delete pages;</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">//  * page compression (requires php-zlib extension);</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">//  * XOBject Templates;</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">//  * Layers and object visibility.</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">//  * PDF/A-1b support</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">//============================================================+</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">// TCPDF configuration</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;require_once(dirname(__FILE__).<span class="stringliteral">&#39;/tcpdf_autoconfig.php&#39;</span>);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">// TCPDF static font methods and data</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;require_once(dirname(__FILE__).<span class="stringliteral">&#39;/include/tcpdf_font_data.php&#39;</span>);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">// TCPDF static font methods and data</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;require_once(dirname(__FILE__).<span class="stringliteral">&#39;/include/tcpdf_fonts.php&#39;</span>);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">// TCPDF static color methods and data</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;require_once(dirname(__FILE__).<span class="stringliteral">&#39;/include/tcpdf_colors.php&#39;</span>);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">// TCPDF static image methods and data</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;require_once(dirname(__FILE__).<span class="stringliteral">&#39;/include/tcpdf_images.php&#39;</span>);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">// TCPDF static methods and data</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;require_once(dirname(__FILE__).<span class="stringliteral">&#39;/include/tcpdf_static.php&#39;</span>);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div>
<div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html">  134</a></span>&#160;<span class="keyword">class </span><a class="code" href="../../d4/d40/classTCPDF.html">TCPDF</a> {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="comment">// Protected properties</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div>
<div class="line"><a name="l00142"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">  142</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div>
<div class="line"><a name="l00148"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">  148</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div>
<div class="line"><a name="l00154"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#af34383b2ad0cda65b8327d62065afdbc">  154</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#af34383b2ad0cda65b8327d62065afdbc">$offsets</a> = array();</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div>
<div class="line"><a name="l00160"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#abd475a94dce95a71e139e29d378d1dd4">  160</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#abd475a94dce95a71e139e29d378d1dd4">$pageobjects</a> = array();</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div>
<div class="line"><a name="l00166"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a61840390b5ae16c58b1b6bd6b060af46">  166</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a61840390b5ae16c58b1b6bd6b060af46">$buffer</a>;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div>
<div class="line"><a name="l00172"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#abb8b93313ba45826395085b42bffdab8">  172</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#abb8b93313ba45826395085b42bffdab8">$pages</a> = array();</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div>
<div class="line"><a name="l00178"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ae950ca495f922385c27c6ded218c3cfa">  178</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ae950ca495f922385c27c6ded218c3cfa">$state</a>;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div>
<div class="line"><a name="l00184"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a9e5fbe1cabbea954c6b5d4f9837bc3b0">  184</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a9e5fbe1cabbea954c6b5d4f9837bc3b0">$compress</a>;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div>
<div class="line"><a name="l00190"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#abdf07c1c5b4fb70b3ed325031d187257">  190</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#abdf07c1c5b4fb70b3ed325031d187257">$CurOrientation</a>;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div>
<div class="line"><a name="l00196"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a50525de041ad2206e3a360bc99dabd19">  196</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a50525de041ad2206e3a360bc99dabd19">$pagedim</a> = array();</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div>
<div class="line"><a name="l00202"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">  202</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a>;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div>
<div class="line"><a name="l00208"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a2b9dd5ea5f109626189153dadd12f680">  208</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a2b9dd5ea5f109626189153dadd12f680">$fwPt</a>;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div>
<div class="line"><a name="l00214"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a48d90dc02b21b040d95122abf89a2b18">  214</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a48d90dc02b21b040d95122abf89a2b18">$fhPt</a>;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div>
<div class="line"><a name="l00220"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ab5675888a7271f898545886b4c3277c3">  220</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ab5675888a7271f898545886b4c3277c3">$wPt</a>;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div>
<div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a7965ee64ad21a3c638933ae96cb23f94">  226</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a7965ee64ad21a3c638933ae96cb23f94">$hPt</a>;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div>
<div class="line"><a name="l00232"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">  232</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div>
<div class="line"><a name="l00238"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">  238</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div>
<div class="line"><a name="l00244"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da">  244</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da">$lMargin</a>;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div>
<div class="line"><a name="l00250"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a44fb75b85bea40ced25fdea9d89dc8e9">  250</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a44fb75b85bea40ced25fdea9d89dc8e9">$rMargin</a>;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div>
<div class="line"><a name="l00256"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a196f73a0f173f0d5977c7eb7a53b53d5">  256</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a196f73a0f173f0d5977c7eb7a53b53d5">$clMargin</a>;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div>
<div class="line"><a name="l00262"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a04f8930e0bdba4d6c1462425cb75fb5f">  262</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a04f8930e0bdba4d6c1462425cb75fb5f">$crMargin</a>;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div>
<div class="line"><a name="l00268"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ace8343242b398fd16a4acb1926b6efa7">  268</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ace8343242b398fd16a4acb1926b6efa7">$tMargin</a>;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div>
<div class="line"><a name="l00274"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#acfe6c98519acb01dd53aa153c12bf79b">  274</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#acfe6c98519acb01dd53aa153c12bf79b">$bMargin</a>;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div>
<div class="line"><a name="l00281"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">  281</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$cell_padding</a> = array(<span class="charliteral">&#39;T&#39;</span> =&gt; 0, <span class="charliteral">&#39;R&#39;</span> =&gt; 0, <span class="charliteral">&#39;B&#39;</span> =&gt; 0, <span class="charliteral">&#39;L&#39;</span> =&gt; 0);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div>
<div class="line"><a name="l00288"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a6decef4569cfd79d75e47cab1315fa77">  288</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a6decef4569cfd79d75e47cab1315fa77">$cell_margin</a> = array(<span class="charliteral">&#39;T&#39;</span> =&gt; 0, <span class="charliteral">&#39;R&#39;</span> =&gt; 0, <span class="charliteral">&#39;B&#39;</span> =&gt; 0, <span class="charliteral">&#39;L&#39;</span> =&gt; 0);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div>
<div class="line"><a name="l00294"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">  294</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div>
<div class="line"><a name="l00300"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">  300</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div>
<div class="line"><a name="l00306"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a41e87b05a84dd56c2c824af49470e295">  306</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a41e87b05a84dd56c2c824af49470e295">$lasth</a>;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div>
<div class="line"><a name="l00312"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a5971d565157974939d3edf96baeb0eeb">  312</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a5971d565157974939d3edf96baeb0eeb">$LineWidth</a>;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div>
<div class="line"><a name="l00318"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a0ba200eb136effe5ff79cafed3f0fd92">  318</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a0ba200eb136effe5ff79cafed3f0fd92">$CoreFonts</a>;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div>
<div class="line"><a name="l00324"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#acbeb582e8fb3a6771c5d7c1279966ddb">  324</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#acbeb582e8fb3a6771c5d7c1279966ddb">$fonts</a> = array();</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div>
<div class="line"><a name="l00330"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a514d8fa634d23eac396e0b4471acccba">  330</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a514d8fa634d23eac396e0b4471acccba">$FontFiles</a> = array();</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div>
<div class="line"><a name="l00336"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a73e52ac5a6301ce1ea8a6b1a9fc45e71">  336</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a73e52ac5a6301ce1ea8a6b1a9fc45e71">$diffs</a> = array();</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div>
<div class="line"><a name="l00342"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a2a3a0126924898c8bbf889ecd5f8b5b5">  342</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a2a3a0126924898c8bbf889ecd5f8b5b5">$images</a> = array();</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div>
<div class="line"><a name="l00348"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ab9f43ce707ad6b533224aab3fddffebb">  348</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ab9f43ce707ad6b533224aab3fddffebb">$cached_files</a> = array();</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div>
<div class="line"><a name="l00354"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a9ce01e710ad7b958dbb41269770461f5">  354</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a9ce01e710ad7b958dbb41269770461f5">$PageAnnots</a> = array();</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div>
<div class="line"><a name="l00360"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ab050e61a9d3a6d628990a26c9032ec0e">  360</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ab050e61a9d3a6d628990a26c9032ec0e">$links</a> = array();</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div>
<div class="line"><a name="l00366"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a642c62438ec9c983283a98d5099ba7ba">  366</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a642c62438ec9c983283a98d5099ba7ba">$FontFamily</a>;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div>
<div class="line"><a name="l00372"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a6fce74bcde6c138d286dce274950dff7">  372</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a6fce74bcde6c138d286dce274950dff7">$FontStyle</a>;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div>
<div class="line"><a name="l00379"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a628e3e22a136173a0bac253ce9842c56">  379</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a628e3e22a136173a0bac253ce9842c56">$FontAscent</a>;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div>
<div class="line"><a name="l00386"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a7f6ac3771776732243563ec438ab055f">  386</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a7f6ac3771776732243563ec438ab055f">$FontDescent</a>;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div>
<div class="line"><a name="l00392"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a55b5b6cb30c082e93dfdcddb1d7fb41b">  392</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a55b5b6cb30c082e93dfdcddb1d7fb41b">$underline</a>;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div>
<div class="line"><a name="l00398"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ae47afd58a8f71596ad26a55444208b55">  398</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ae47afd58a8f71596ad26a55444208b55">$overline</a>;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div>
<div class="line"><a name="l00404"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a6053be73563ad95518920ecdc8cae6fb">  404</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a6053be73563ad95518920ecdc8cae6fb">$CurrentFont</a>;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div>
<div class="line"><a name="l00410"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a9a787786c9f1a04f54f1dec622869d4d">  410</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a9a787786c9f1a04f54f1dec622869d4d">$FontSizePt</a>;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div>
<div class="line"><a name="l00416"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aa4460c72a6e45784dff4dad7708c372c">  416</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#aa4460c72a6e45784dff4dad7708c372c">$FontSize</a>;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div>
<div class="line"><a name="l00422"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a0315276a2fb102cd8ef24a440741b3d4">  422</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a0315276a2fb102cd8ef24a440741b3d4">$DrawColor</a>;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div>
<div class="line"><a name="l00428"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a6917075860ef7a8d300698ff6f678a04">  428</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a6917075860ef7a8d300698ff6f678a04">$FillColor</a>;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div>
<div class="line"><a name="l00434"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ade7bced891aaa3b0a5ce236eb7a5c8ba">  434</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ade7bced891aaa3b0a5ce236eb7a5c8ba">$TextColor</a>;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div>
<div class="line"><a name="l00440"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a27c982afeec6a29678a0b16ae0b4e755">  440</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a27c982afeec6a29678a0b16ae0b4e755">$ColorFlag</a>;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;</div>
<div class="line"><a name="l00446"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ad252eae91d3151b11d1dd15aebe9a4a4">  446</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ad252eae91d3151b11d1dd15aebe9a4a4">$AutoPageBreak</a>;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div>
<div class="line"><a name="l00452"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ae8f57f5a0dc2a796269772b2cd490c5e">  452</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ae8f57f5a0dc2a796269772b2cd490c5e">$PageBreakTrigger</a>;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div>
<div class="line"><a name="l00458"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ab991dc3ec6359223a68f1177746d61f3">  458</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ab991dc3ec6359223a68f1177746d61f3">$InHeader</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div>
<div class="line"><a name="l00464"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a0f0bc306116b145ea0efbc1c709a23b6">  464</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a0f0bc306116b145ea0efbc1c709a23b6">$InFooter</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div>
<div class="line"><a name="l00470"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a228f3f0796f010e77806ee1af35adcfe">  470</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a228f3f0796f010e77806ee1af35adcfe">$ZoomMode</a>;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;</div>
<div class="line"><a name="l00476"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#afc93b05f36dcad498c71cdfe214716ef">  476</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#afc93b05f36dcad498c71cdfe214716ef">$LayoutMode</a>;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div>
<div class="line"><a name="l00482"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ab5d6a8d1d360e0845909cd24f4637266">  482</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ab5d6a8d1d360e0845909cd24f4637266">$docinfounicode</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;</div>
<div class="line"><a name="l00488"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a63acf0babc0299784cbb54354329a734">  488</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a63acf0babc0299784cbb54354329a734">$title</a> = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div>
<div class="line"><a name="l00494"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#abb4e21366924e76df3400312434d95e1">  494</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#abb4e21366924e76df3400312434d95e1">$subject</a> = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div>
<div class="line"><a name="l00500"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a25c26ce9fab4b1d38773ab3629d985aa">  500</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a25c26ce9fab4b1d38773ab3629d985aa">$author</a> = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div>
<div class="line"><a name="l00506"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a752bede1485e51bff5ad315ca83c804d">  506</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a752bede1485e51bff5ad315ca83c804d">$keywords</a> = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div>
<div class="line"><a name="l00512"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a79a8b6ca37c76f3d5ebfb26be77613db">  512</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a79a8b6ca37c76f3d5ebfb26be77613db">$creator</a> = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div>
<div class="line"><a name="l00518"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aa763f850e5163efe95d15785b174de71">  518</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#aa763f850e5163efe95d15785b174de71">$starting_page_number</a> = 1;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;</div>
<div class="line"><a name="l00526"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ace8e68000d6185a28a180bbe4531b428">  526</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ace8e68000d6185a28a180bbe4531b428">$img_rb_x</a>;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div>
<div class="line"><a name="l00534"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#abc05496cf88772b492f67e87c53121d0">  534</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#abc05496cf88772b492f67e87c53121d0">$img_rb_y</a>;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;</div>
<div class="line"><a name="l00542"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ae476d39b2a2721941c0c3044a922b633">  542</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ae476d39b2a2721941c0c3044a922b633">$imgscale</a> = 1;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;</div>
<div class="line"><a name="l00550"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a148f0ae58c3b0f5644f8ab158b17c2ed">  550</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a148f0ae58c3b0f5644f8ab158b17c2ed">$isunicode</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div>
<div class="line"><a name="l00557"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a40cc24bda71b85b4013d070896cd97de">  557</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a40cc24bda71b85b4013d070896cd97de">$PDFVersion</a> = <span class="stringliteral">&#39;1.7&#39;</span>;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;</div>
<div class="line"><a name="l00563"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a9a8cd7928fa36f7a9679a00d908d1427">  563</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a9a8cd7928fa36f7a9679a00d908d1427">$header_xobjid</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div>
<div class="line"><a name="l00569"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ab79dc8e8a21ee6aa54d648f2afb1c49f">  569</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ab79dc8e8a21ee6aa54d648f2afb1c49f">$header_xobj_autoreset</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;</div>
<div class="line"><a name="l00575"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#afdcd761ffeab6ede2a7ed79cb2b5d33d">  575</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#afdcd761ffeab6ede2a7ed79cb2b5d33d">$header_margin</a>;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;</div>
<div class="line"><a name="l00581"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ad5cecadb5d4b25324516668aaf23c3ca">  581</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ad5cecadb5d4b25324516668aaf23c3ca">$footer_margin</a>;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div>
<div class="line"><a name="l00588"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a90bee4debe4218064059014965f8d52a">  588</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a90bee4debe4218064059014965f8d52a">$original_lMargin</a>;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div>
<div class="line"><a name="l00595"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a76d33e30b8292c2483e80bc98566483f">  595</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a76d33e30b8292c2483e80bc98566483f">$original_rMargin</a>;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;</div>
<div class="line"><a name="l00601"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aa29f2cb5b3679f1c6658e2a1e775bcb3">  601</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#aa29f2cb5b3679f1c6658e2a1e775bcb3">$header_font</a>;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div>
<div class="line"><a name="l00607"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a63fc9b0fba1a33cc5d27588f3e512df8">  607</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a63fc9b0fba1a33cc5d27588f3e512df8">$footer_font</a>;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div>
<div class="line"><a name="l00613"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f">  613</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f">$l</a>;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div>
<div class="line"><a name="l00619"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aa043d6a67959c785e8decc6ef1400cd8">  619</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#aa043d6a67959c785e8decc6ef1400cd8">$barcode</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;</div>
<div class="line"><a name="l00625"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a945deedf891e7d49d60b3fe2a7cbbf95">  625</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a945deedf891e7d49d60b3fe2a7cbbf95">$print_header</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;</div>
<div class="line"><a name="l00631"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a185c0c5c32718d210add5f1be3b2b14e">  631</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a185c0c5c32718d210add5f1be3b2b14e">$print_footer</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;</div>
<div class="line"><a name="l00637"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#abde8cefba6202d748b708b515bfce9ce">  637</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#abde8cefba6202d748b708b515bfce9ce">$header_logo</a> = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div>
<div class="line"><a name="l00643"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a5c3ee3344be02f70dcd5b3db312b28f0">  643</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a5c3ee3344be02f70dcd5b3db312b28f0">$header_logo_width</a> = 30;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;</div>
<div class="line"><a name="l00649"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a7a9badafb7fca4cb3d6fe7c5e771d79e">  649</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a7a9badafb7fca4cb3d6fe7c5e771d79e">$header_title</a> = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;</div>
<div class="line"><a name="l00655"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a47928b951e68ff27c1b4f39523aaeef7">  655</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a47928b951e68ff27c1b4f39523aaeef7">$header_string</a> = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;</div>
<div class="line"><a name="l00662"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a712ce18cedd4b397a0375d9972f6aea8">  662</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a712ce18cedd4b397a0375d9972f6aea8">$header_text_color</a> = array(0,0,0);</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;</div>
<div class="line"><a name="l00669"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a8038a0a2a6d0b98e1b86307a6f9ded1f">  669</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a8038a0a2a6d0b98e1b86307a6f9ded1f">$header_line_color</a> = array(0,0,0);</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;</div>
<div class="line"><a name="l00676"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a37c3ca1d77b99662e49c2931728f33a8">  676</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a37c3ca1d77b99662e49c2931728f33a8">$footer_text_color</a> = array(0,0,0);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;</div>
<div class="line"><a name="l00683"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a7195b85507609d798c03df2f183578b7">  683</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a7195b85507609d798c03df2f183578b7">$footer_line_color</a> = array(0,0,0);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;</div>
<div class="line"><a name="l00690"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a1dd465e43c8c86c254abafc6da408400">  690</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a1dd465e43c8c86c254abafc6da408400">$txtshadow</a> = array(<span class="stringliteral">&#39;enabled&#39;</span>=&gt;<span class="keyword">false</span>, <span class="stringliteral">&#39;depth_w&#39;</span>=&gt;0, <span class="stringliteral">&#39;depth_h&#39;</span>=&gt;0, <span class="stringliteral">&#39;color&#39;</span>=&gt;<span class="keyword">false</span>, <span class="stringliteral">&#39;opacity&#39;</span>=&gt;1, <span class="stringliteral">&#39;blend_mode&#39;</span>=&gt;<span class="stringliteral">&#39;Normal&#39;</span>);</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;</div>
<div class="line"><a name="l00696"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a58f2abc77f4289613100fcf64c52f0ae">  696</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a58f2abc77f4289613100fcf64c52f0ae">$default_table_columns</a> = 4;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <span class="comment">// variables for html parser</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;</div>
<div class="line"><a name="l00704"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ab3c410ce9315c42d12408f9982f626bc">  704</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ab3c410ce9315c42d12408f9982f626bc">$HREF</a> = array();</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;</div>
<div class="line"><a name="l00710"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#af75b91429604ea426b2aa255bbff089f">  710</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#af75b91429604ea426b2aa255bbff089f">$fontlist</a> = array();</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;</div>
<div class="line"><a name="l00716"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a98585a6dd732caf2ba4c0ae2d9aa9841">  716</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a98585a6dd732caf2ba4c0ae2d9aa9841">$fgcolor</a>;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;</div>
<div class="line"><a name="l00722"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#add40afd65a8b5349248c69d057cb462d">  722</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#add40afd65a8b5349248c69d057cb462d">$listordered</a> = array();</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;</div>
<div class="line"><a name="l00728"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a0e0245500627af0752a6954ec348fa92">  728</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a0e0245500627af0752a6954ec348fa92">$listcount</a> = array();</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;</div>
<div class="line"><a name="l00734"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a92b743d472f53d5260274c7915829ff7">  734</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a92b743d472f53d5260274c7915829ff7">$listnum</a> = 0;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;</div>
<div class="line"><a name="l00740"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a66ab086d27a31dd0a7a7c69ea87b3767">  740</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a66ab086d27a31dd0a7a7c69ea87b3767">$listindent</a> = 0;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;</div>
<div class="line"><a name="l00746"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a1f87a9ca1927053aed6c3188edeb1d28">  746</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a1f87a9ca1927053aed6c3188edeb1d28">$listindentlevel</a> = 0;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;</div>
<div class="line"><a name="l00752"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ae46a35098766581d1ad9ba173b17da5f">  752</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ae46a35098766581d1ad9ba173b17da5f">$bgcolor</a>;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;</div>
<div class="line"><a name="l00758"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a5d5b8dbfad7917b489603b4bc69dd9b8">  758</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a5d5b8dbfad7917b489603b4bc69dd9b8">$tempfontsize</a> = 10;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;</div>
<div class="line"><a name="l00764"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a91c1d0b385b593f4834a1fd3f9c4ab65">  764</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a91c1d0b385b593f4834a1fd3f9c4ab65">$lispacer</a> = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;</div>
<div class="line"><a name="l00771"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a274314ff17c5df9ae105f9c91893a4a7">  771</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a274314ff17c5df9ae105f9c91893a4a7">$encoding</a> = <span class="stringliteral">&#39;UTF-8&#39;</span>;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;</div>
<div class="line"><a name="l00778"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a22858ae709885860e1f6c5db6f754218">  778</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a22858ae709885860e1f6c5db6f754218">$internal_encoding</a>;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;</div>
<div class="line"><a name="l00785"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a4ccd9d69e0839838b105328953794a40">  785</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a4ccd9d69e0839838b105328953794a40">$rtl</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;</div>
<div class="line"><a name="l00792"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a81fcfeb26eaac6977cb9ade5a0944154">  792</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a81fcfeb26eaac6977cb9ade5a0944154">$tmprtl</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <span class="comment">// --- Variables used for document encryption:</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;</div>
<div class="line"><a name="l00801"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#affd380e0adfc726dbc519860de0b175c">  801</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#affd380e0adfc726dbc519860de0b175c">$encrypted</a>;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;</div>
<div class="line"><a name="l00808"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a06db7c5a86921654c8361f0e924d48b8">  808</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a06db7c5a86921654c8361f0e924d48b8">$encryptdata</a> = array();</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;</div>
<div class="line"><a name="l00815"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a8d4bf72b31a199786829e4bee4bae6f5">  815</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a8d4bf72b31a199786829e4bee4bae6f5">$last_enc_key</a>;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;</div>
<div class="line"><a name="l00822"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aa9eef41ab9ce56515dea68e21509eda6">  822</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#aa9eef41ab9ce56515dea68e21509eda6">$last_enc_key_c</a>;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;</div>
<div class="line"><a name="l00829"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a12227210f010059895875006d839f318">  829</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a12227210f010059895875006d839f318">$file_id</a>;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <span class="comment">// --- bookmark ---</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;</div>
<div class="line"><a name="l00838"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#afde44c5da51ba62be8c27491975c528f">  838</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#afde44c5da51ba62be8c27491975c528f">$outlines</a> = array();</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;</div>
<div class="line"><a name="l00845"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a106771c9857d515f45619020ec2bf5c6">  845</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a106771c9857d515f45619020ec2bf5c6">$OutlineRoot</a>;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    <span class="comment">// --- javascript and form ---</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;</div>
<div class="line"><a name="l00854"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a6b1f180bd6e591a9c20f8621e08125e5">  854</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a6b1f180bd6e591a9c20f8621e08125e5">$javascript</a> = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;</div>
<div class="line"><a name="l00861"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a67d3ebe4959018ae32058d9962d76c1c">  861</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a67d3ebe4959018ae32058d9962d76c1c">$n_js</a>;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;</div>
<div class="line"><a name="l00868"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a5436c5f4de6f6506231423ca3c4e9a6a">  868</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a5436c5f4de6f6506231423ca3c4e9a6a">$linethrough</a>;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;</div>
<div class="line"><a name="l00875"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a8a5cfe86f13b8b547ed17e97fa350a80">  875</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a8a5cfe86f13b8b547ed17e97fa350a80">$ur</a> = array();</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;</div>
<div class="line"><a name="l00882"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a22272525668774dab75d46dfd66ff2f2">  882</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a22272525668774dab75d46dfd66ff2f2">$dpi</a> = 72;</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;</div>
<div class="line"><a name="l00889"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#afb73712e74059488feca5f8b850ff6a4">  889</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#afb73712e74059488feca5f8b850ff6a4">$newpagegroup</a> = array();</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;</div>
<div class="line"><a name="l00896"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a3d3b6c9de1643d382406ebfecdbe415b">  896</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a3d3b6c9de1643d382406ebfecdbe415b">$pagegroups</a> = array();</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;</div>
<div class="line"><a name="l00903"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ac78410b152f371b7239405ba246cee92">  903</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ac78410b152f371b7239405ba246cee92">$currpagegroup</a> = 0;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;</div>
<div class="line"><a name="l00910"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a75a59cadddf08174c12801049c23b862">  910</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a75a59cadddf08174c12801049c23b862">$extgstates</a>;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;</div>
<div class="line"><a name="l00917"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a5d889cef79795c6d0e8c175fc820f87d">  917</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a5d889cef79795c6d0e8c175fc820f87d">$jpeg_quality</a>;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;</div>
<div class="line"><a name="l00924"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#af8cc74fe5806eb009a22791c3a4c7cce">  924</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#af8cc74fe5806eb009a22791c3a4c7cce">$cell_height_ratio</a> = <a class="code" href="../../d5/dc0/tcpdf__config_8php.html#aa677efad07ef009287d0490aa2eb21a2">K_CELL_HEIGHT_RATIO</a>;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;</div>
<div class="line"><a name="l00931"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#acb8e8249a228d343d4c5254f8cd6c75a">  931</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#acb8e8249a228d343d4c5254f8cd6c75a">$viewer_preferences</a>;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;</div>
<div class="line"><a name="l00938"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a69d53096e1daf8973011f291c78e4139">  938</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a69d53096e1daf8973011f291c78e4139">$PageMode</a>;</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;</div>
<div class="line"><a name="l00945"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ab52fb17ae0baa062810c29dbcbba8179">  945</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ab52fb17ae0baa062810c29dbcbba8179">$gradients</a> = array();</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;</div>
<div class="line"><a name="l00952"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a7cef73bdad50b34e32accaeb6292095d">  952</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a7cef73bdad50b34e32accaeb6292095d">$intmrk</a> = array();</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;</div>
<div class="line"><a name="l00959"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ae4db27f9e17c4a6f48117669fa94a1bb">  959</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ae4db27f9e17c4a6f48117669fa94a1bb">$bordermrk</a> = array();</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;</div>
<div class="line"><a name="l00966"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a9ffebab4b2d31f52b7afae1061b4fc4d">  966</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a9ffebab4b2d31f52b7afae1061b4fc4d">$emptypagemrk</a> = array();</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;</div>
<div class="line"><a name="l00973"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ad0bbadba37c598911425309c4f88d08e">  973</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ad0bbadba37c598911425309c4f88d08e">$cntmrk</a> = array();</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;</div>
<div class="line"><a name="l00980"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a9eeb118916ac86a5441ca15a24a243f2">  980</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a9eeb118916ac86a5441ca15a24a243f2">$footerpos</a> = array();</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;</div>
<div class="line"><a name="l00987"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a465409fb33aa269efd0fc709e1eaef58">  987</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a465409fb33aa269efd0fc709e1eaef58">$footerlen</a> = array();</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;</div>
<div class="line"><a name="l00994"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a505b4eabece70b8679ebdeb86964b798">  994</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a505b4eabece70b8679ebdeb86964b798">$newline</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;</div>
<div class="line"><a name="l01001"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a6478721dced8d81bbed6aed8dbe5a4d1"> 1001</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a6478721dced8d81bbed6aed8dbe5a4d1">$endlinex</a> = 0;</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;</div>
<div class="line"><a name="l01008"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a71e0449a3a1c35c8e5009450834787e7"> 1008</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a71e0449a3a1c35c8e5009450834787e7">$linestyleWidth</a> = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;</div>
<div class="line"><a name="l01015"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ad558e09c5de15501f3f845cd9f478a94"> 1015</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ad558e09c5de15501f3f845cd9f478a94">$linestyleCap</a> = <span class="stringliteral">&#39;0 J&#39;</span>;</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;</div>
<div class="line"><a name="l01022"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a321e26613df419d2d216805fa7405d68"> 1022</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a321e26613df419d2d216805fa7405d68">$linestyleJoin</a> = <span class="stringliteral">&#39;0 j&#39;</span>;</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;</div>
<div class="line"><a name="l01029"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a7310f6d7bd966343955e3133756df710"> 1029</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a7310f6d7bd966343955e3133756df710">$linestyleDash</a> = <span class="stringliteral">&#39;[] 0 d&#39;</span>;</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;</div>
<div class="line"><a name="l01036"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a7a2fb19f3fcf13ef670ba8cdf3b4c5a4"> 1036</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a7a2fb19f3fcf13ef670ba8cdf3b4c5a4">$openMarkedContent</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;</div>
<div class="line"><a name="l01043"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a96869f3f3defc5d706c09dbd987c2752"> 1043</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a96869f3f3defc5d706c09dbd987c2752">$htmlvspace</a> = 0;</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;</div>
<div class="line"><a name="l01050"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a25c924c6b9a12aba0d0a3e535eca224d"> 1050</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a25c924c6b9a12aba0d0a3e535eca224d">$spot_colors</a> = array();</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;</div>
<div class="line"><a name="l01057"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a0e77f99c65a62b6af3d07419e4750bc5"> 1057</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a0e77f99c65a62b6af3d07419e4750bc5">$lisymbol</a> = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;</div>
<div class="line"><a name="l01064"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#afa577c56100df8d110993150ae9e05dd"> 1064</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#afa577c56100df8d110993150ae9e05dd">$epsmarker</a> = <span class="stringliteral">&#39;x#!#EPS#!#x&#39;</span>;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;</div>
<div class="line"><a name="l01071"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ab9eb18c6a757b07560c111ffb1533049"> 1071</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ab9eb18c6a757b07560c111ffb1533049">$transfmatrix</a> = array();</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;</div>
<div class="line"><a name="l01078"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#af166f060da54f13a6d9871160284cc30"> 1078</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#af166f060da54f13a6d9871160284cc30">$transfmatrix_key</a> = 0;</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;</div>
<div class="line"><a name="l01085"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ac17fad9cbf5ec25f76e79adb61aa3f10"> 1085</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ac17fad9cbf5ec25f76e79adb61aa3f10">$booklet</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;</div>
<div class="line"><a name="l01092"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a0757c5909a61c91c055d5867c57e0d3e"> 1092</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a0757c5909a61c91c055d5867c57e0d3e">$feps</a> = 0.005;</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;</div>
<div class="line"><a name="l01099"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a17c2f9d587880ac42a8bb8638bd05811"> 1099</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a17c2f9d587880ac42a8bb8638bd05811">$tagvspaces</a> = array();</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;</div>
<div class="line"><a name="l01106"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a9d5b2e618c656365a57eeacc66940311"> 1106</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a9d5b2e618c656365a57eeacc66940311">$customlistindent</a> = -1;</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;</div>
<div class="line"><a name="l01113"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a8e4cdd8552955c46ab2d35bb0cbfa277"> 1113</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a8e4cdd8552955c46ab2d35bb0cbfa277">$opencell</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;</div>
<div class="line"><a name="l01120"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a906d52a85a3f7efd4949f6c05132e1a9"> 1120</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a906d52a85a3f7efd4949f6c05132e1a9">$embeddedfiles</a> = array();</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;</div>
<div class="line"><a name="l01127"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a7e72e7d134966fec42290897902c7aac"> 1127</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a7e72e7d134966fec42290897902c7aac">$premode</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;</div>
<div class="line"><a name="l01135"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a12cedc58d49cf0473c2d3d459f042cbc"> 1135</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a12cedc58d49cf0473c2d3d459f042cbc">$transfmrk</a> = array();</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;</div>
<div class="line"><a name="l01142"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ad314dda630c9467efd594d46d24abcd5"> 1142</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ad314dda630c9467efd594d46d24abcd5">$htmlLinkColorArray</a> = array(0, 0, 255);</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;</div>
<div class="line"><a name="l01149"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a5dedfd8b2f29748200d45a186182c86c"> 1149</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a5dedfd8b2f29748200d45a186182c86c">$htmlLinkFontStyle</a> = <span class="charliteral">&#39;U&#39;</span>;</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;</div>
<div class="line"><a name="l01156"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ae5dd5203ba48e26efcb24a6a6cabbb42"> 1156</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ae5dd5203ba48e26efcb24a6a6cabbb42">$numpages</a> = 0;</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;</div>
<div class="line"><a name="l01163"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a2111c4472eae611423616d58c1e85430"> 1163</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a2111c4472eae611423616d58c1e85430">$pagelen</a> = array();</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;</div>
<div class="line"><a name="l01170"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#afa3c48bada4819f910fb2d6a1ffc2c14"> 1170</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#afa3c48bada4819f910fb2d6a1ffc2c14">$numimages</a> = 0;</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;</div>
<div class="line"><a name="l01177"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a3a38b9e6a4264d6e2c7dd6e0c7a88905"> 1177</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a3a38b9e6a4264d6e2c7dd6e0c7a88905">$imagekeys</a> = array();</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;</div>
<div class="line"><a name="l01184"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ab2369921b0e2075fb797dc03f701f205"> 1184</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ab2369921b0e2075fb797dc03f701f205">$bufferlen</a> = 0;</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;</div>
<div class="line"><a name="l01191"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ae36b54ab4599f14fc4116bb77ffbcc6b"> 1191</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ae36b54ab4599f14fc4116bb77ffbcc6b">$diskcache</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;</div>
<div class="line"><a name="l01198"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#abe8ea9785cede5c50969a8c2a37aae84"> 1198</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#abe8ea9785cede5c50969a8c2a37aae84">$numfonts</a> = 0;</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;</div>
<div class="line"><a name="l01205"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a6286b84256565aa46926b83494525bd3"> 1205</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a6286b84256565aa46926b83494525bd3">$fontkeys</a> = array();</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;</div>
<div class="line"><a name="l01212"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a62801a15bfbe77fba2203df026b0d716"> 1212</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a62801a15bfbe77fba2203df026b0d716">$font_obj_ids</a> = array();</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;</div>
<div class="line"><a name="l01219"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a28c086439c0e458e09a76d0964518a6c"> 1219</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a28c086439c0e458e09a76d0964518a6c">$pageopen</a> = array();</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;</div>
<div class="line"><a name="l01226"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a25b565e4885c362df7211dd7f3b9c4fa"> 1226</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a25b565e4885c362df7211dd7f3b9c4fa">$default_monospaced_font</a> = <span class="stringliteral">&#39;courier&#39;</span>;</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;</div>
<div class="line"><a name="l01233"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a36337c6c1101f048451ef83c054e011b"> 1233</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a36337c6c1101f048451ef83c054e011b">$objcopy</a>;</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;</div>
<div class="line"><a name="l01240"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a6e8de9cf793935f3c61d1bf2c4e160ac"> 1240</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a6e8de9cf793935f3c61d1bf2c4e160ac">$cache_file_length</a> = array();</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;</div>
<div class="line"><a name="l01247"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ae7cd5ea4b0ef3a0910ed0044bea97f1d"> 1247</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ae7cd5ea4b0ef3a0910ed0044bea97f1d">$thead</a> = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;</div>
<div class="line"><a name="l01254"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a1545ffbbb4d3e78ac3bf8413300016eb"> 1254</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a1545ffbbb4d3e78ac3bf8413300016eb">$theadMargins</a> = array();</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;</div>
<div class="line"><a name="l01261"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a10e1f5a4bd93b5f2a81cc20509e2093d"> 1261</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a10e1f5a4bd93b5f2a81cc20509e2093d">$sign</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;</div>
<div class="line"><a name="l01268"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#afb1dec1e7e779c6bf5869c3ab7a295ed"> 1268</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#afb1dec1e7e779c6bf5869c3ab7a295ed">$signature_data</a> = array();</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;</div>
<div class="line"><a name="l01275"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ac8927d78b3aafff19cb3188f6879117b"> 1275</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ac8927d78b3aafff19cb3188f6879117b">$signature_max_length</a> = 11742;</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;</div>
<div class="line"><a name="l01282"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a462e1c7c06da31458cdb0d95acb086a8"> 1282</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a462e1c7c06da31458cdb0d95acb086a8">$signature_appearance</a> = array(<span class="stringliteral">&#39;page&#39;</span> =&gt; 1, <span class="stringliteral">&#39;rect&#39;</span> =&gt; <span class="stringliteral">&#39;0 0 0 0&#39;</span>);</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;</div>
<div class="line"><a name="l01289"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a708b96db375900604367c3fe1e0df118"> 1289</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a708b96db375900604367c3fe1e0df118">$empty_signature_appearance</a> = array();</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;</div>
<div class="line"><a name="l01296"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ac2cb5e6e0c0de533310a0965c5a2d908"> 1296</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ac2cb5e6e0c0de533310a0965c5a2d908">$tsa_timestamp</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;</div>
<div class="line"><a name="l01303"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a320d4c4b03adf1480bf550aa64cdf8f1"> 1303</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a320d4c4b03adf1480bf550aa64cdf8f1">$tsa_data</a> = array();</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;</div>
<div class="line"><a name="l01310"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a141a622244b576f4eb239b93c8826b32"> 1310</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a141a622244b576f4eb239b93c8826b32">$re_spaces</a> = <span class="stringliteral">&#39;/[^\S\xa0]/&#39;</span>;</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;</div>
<div class="line"><a name="l01317"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aef325c0f70f72018cd52744380c56d47"> 1317</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#aef325c0f70f72018cd52744380c56d47">$re_space</a> = array(<span class="charliteral">&#39;p&#39;</span> =&gt; <span class="stringliteral">&#39;[^\S\xa0]&#39;</span>, <span class="charliteral">&#39;m&#39;</span> =&gt; <span class="stringliteral">&#39;&#39;</span>);</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;</div>
<div class="line"><a name="l01324"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a127e3d16c986f858bfbe189c535c6ada"> 1324</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a127e3d16c986f858bfbe189c535c6ada">$sig_obj_id</a> = 0;</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;</div>
<div class="line"><a name="l01331"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a104cb1d0c57aea34a2a29edcb85fd772"> 1331</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a104cb1d0c57aea34a2a29edcb85fd772">$page_obj_id</a> = array();</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;</div>
<div class="line"><a name="l01338"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ab2887c4ed584490249c4964a4ec0e2fc"> 1338</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ab2887c4ed584490249c4964a4ec0e2fc">$form_obj_id</a> = array();</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;</div>
<div class="line"><a name="l01345"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aac92d698d00f2c049c2941a6faa8253b"> 1345</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#aac92d698d00f2c049c2941a6faa8253b">$default_form_prop</a> = array(<span class="stringliteral">&#39;lineWidth&#39;</span>=&gt;1, <span class="stringliteral">&#39;borderStyle&#39;</span>=&gt;<span class="stringliteral">&#39;solid&#39;</span>, <span class="stringliteral">&#39;fillColor&#39;</span>=&gt;array(255, 255, 255), <span class="stringliteral">&#39;strokeColor&#39;</span>=&gt;array(128, 128, 128));</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;</div>
<div class="line"><a name="l01352"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a5eeae8e0584a2f04846aea057780fd39"> 1352</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a5eeae8e0584a2f04846aea057780fd39">$js_objects</a> = array();</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;</div>
<div class="line"><a name="l01359"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a1302a2cfd195515184e2baab0ab20c7e"> 1359</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a1302a2cfd195515184e2baab0ab20c7e">$form_action</a> = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;</div>
<div class="line"><a name="l01366"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a792338a2edffd53283684c4b355611c7"> 1366</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a792338a2edffd53283684c4b355611c7">$form_enctype</a> = <span class="stringliteral">&#39;application/x-www-form-urlencoded&#39;</span>;</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;</div>
<div class="line"><a name="l01373"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a1fb5403b2b6997d476dc797787065bf4"> 1373</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a1fb5403b2b6997d476dc797787065bf4">$form_mode</a> = <span class="stringliteral">&#39;post&#39;</span>;</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;</div>
<div class="line"><a name="l01380"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a30c63dd9a18c06de743d3d6423e15a0d"> 1380</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a30c63dd9a18c06de743d3d6423e15a0d">$annotation_fonts</a> = array();</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;</div>
<div class="line"><a name="l01387"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ac1fbdc28360fd6efe6539755b08b321e"> 1387</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ac1fbdc28360fd6efe6539755b08b321e">$radiobutton_groups</a> = array();</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;</div>
<div class="line"><a name="l01394"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aa6f690ff30d06f1a76086ea16b24f3dd"> 1394</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#aa6f690ff30d06f1a76086ea16b24f3dd">$radio_groups</a> = array();</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;</div>
<div class="line"><a name="l01401"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ade9ed50def3b504470fe4f157092e7e2"> 1401</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ade9ed50def3b504470fe4f157092e7e2">$textindent</a> = 0;</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;</div>
<div class="line"><a name="l01408"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a9c8927b37b10208b3793fc9e05e14ab4"> 1408</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a9c8927b37b10208b3793fc9e05e14ab4">$start_transaction_page</a> = 0;</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;</div>
<div class="line"><a name="l01415"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ac168053a0ff19f84a7da3d525fa9b9a2"> 1415</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ac168053a0ff19f84a7da3d525fa9b9a2">$start_transaction_y</a> = 0;</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;</div>
<div class="line"><a name="l01422"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a12c5aa5d0e1d13569bdb1ca8e6442884"> 1422</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a12c5aa5d0e1d13569bdb1ca8e6442884">$inthead</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;</div>
<div class="line"><a name="l01429"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a860b030382957cd7a0835bb67d6e792c"> 1429</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a860b030382957cd7a0835bb67d6e792c">$columns</a> = array();</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;</div>
<div class="line"><a name="l01436"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aea769a906ed606706e862bd7576e9a34"> 1436</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#aea769a906ed606706e862bd7576e9a34">$num_columns</a> = 1;</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;</div>
<div class="line"><a name="l01443"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aab81c25eefaf486adf004eb20bc22881"> 1443</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#aab81c25eefaf486adf004eb20bc22881">$current_column</a> = 0;</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;</div>
<div class="line"><a name="l01450"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#af7f6494da3088dec66ca1172c546c9e2"> 1450</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#af7f6494da3088dec66ca1172c546c9e2">$column_start_page</a> = 0;</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;</div>
<div class="line"><a name="l01457"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ae738323ab05788503f5d9772a397c8d0"> 1457</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ae738323ab05788503f5d9772a397c8d0">$maxselcol</a> = array(<span class="stringliteral">&#39;page&#39;</span> =&gt; 0, <span class="stringliteral">&#39;column&#39;</span> =&gt; 0);</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;</div>
<div class="line"><a name="l01464"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a0199618a45cf13b30bf23d044e4c8103"> 1464</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a0199618a45cf13b30bf23d044e4c8103">$colxshift</a> = array(<span class="charliteral">&#39;x&#39;</span> =&gt; 0, <span class="charliteral">&#39;s&#39;</span> =&gt; array(<span class="charliteral">&#39;H&#39;</span> =&gt; 0, <span class="charliteral">&#39;V&#39;</span> =&gt; 0), <span class="charliteral">&#39;p&#39;</span> =&gt; array(<span class="charliteral">&#39;L&#39;</span> =&gt; 0, <span class="charliteral">&#39;T&#39;</span> =&gt; 0, <span class="charliteral">&#39;R&#39;</span> =&gt; 0, <span class="charliteral">&#39;B&#39;</span> =&gt; 0));</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;</div>
<div class="line"><a name="l01471"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a45310f49168f541285b71f190645ff45"> 1471</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a45310f49168f541285b71f190645ff45">$textrendermode</a> = 0;</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;</div>
<div class="line"><a name="l01478"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#acef86c1b60f2b45323f27c4dc9620922"> 1478</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#acef86c1b60f2b45323f27c4dc9620922">$textstrokewidth</a> = 0;</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;</div>
<div class="line"><a name="l01485"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aa24f8123d1e2d35446002d13a9715850"> 1485</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#aa24f8123d1e2d35446002d13a9715850">$strokecolor</a>;</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;</div>
<div class="line"><a name="l01492"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a06741a9ee7ad2babd6c212d50701dca8"> 1492</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a06741a9ee7ad2babd6c212d50701dca8">$pdfunit</a> = <span class="stringliteral">&#39;mm&#39;</span>;</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;</div>
<div class="line"><a name="l01498"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aa2a1cf622454f1a9931b2f79fab0f98f"> 1498</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#aa2a1cf622454f1a9931b2f79fab0f98f">$tocpage</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;</div>
<div class="line"><a name="l01505"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#adaa629208532173a3e3bc604f32c07d8"> 1505</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#adaa629208532173a3e3bc604f32c07d8">$rasterize_vector_images</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;</div>
<div class="line"><a name="l01512"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ad12417c3708effd84de35320ac10077a"> 1512</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ad12417c3708effd84de35320ac10077a">$font_subsetting</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;</div>
<div class="line"><a name="l01519"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a642af8de9018d16a0b916dd0d3f20ea8"> 1519</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a642af8de9018d16a0b916dd0d3f20ea8">$default_graphic_vars</a> = array();</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;</div>
<div class="line"><a name="l01526"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ab3fe86d6cc29768a5f1559585015e711"> 1526</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ab3fe86d6cc29768a5f1559585015e711">$xobjects</a> = array();</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;</div>
<div class="line"><a name="l01533"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aec5762185293ba0a36782ceeaba19a94"> 1533</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#aec5762185293ba0a36782ceeaba19a94">$inxobj</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;</div>
<div class="line"><a name="l01540"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#abe4390b4e1939e10c9b61a986adfc117"> 1540</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#abe4390b4e1939e10c9b61a986adfc117">$xobjid</a> = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;</div>
<div class="line"><a name="l01547"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a420a1fac2969936a7d57f4cb9c99849b"> 1547</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a420a1fac2969936a7d57f4cb9c99849b">$font_stretching</a> = 100;</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;</div>
<div class="line"><a name="l01554"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a3f4d91c3489a2c62b628c347551f7adf"> 1554</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a3f4d91c3489a2c62b628c347551f7adf">$font_spacing</a> = 0;</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;</div>
<div class="line"><a name="l01562"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a26a8652b0892c721a2904e0b3676682e"> 1562</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a26a8652b0892c721a2904e0b3676682e">$page_regions</a> = array();</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;</div>
<div class="line"><a name="l01568"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aa0c76ae0aa3fb88a2adbecbdd39a3736"> 1568</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#aa0c76ae0aa3fb88a2adbecbdd39a3736">$check_page_regions</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;</div>
<div class="line"><a name="l01575"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aaf231db32674770a4a2f254f22f5f826"> 1575</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#aaf231db32674770a4a2f254f22f5f826">$pdflayers</a> = array();</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;</div>
<div class="line"><a name="l01582"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a75ae8e6fcf6f618c962e18dc11987753"> 1582</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a75ae8e6fcf6f618c962e18dc11987753">$dests</a> = array();</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;</div>
<div class="line"><a name="l01589"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ac3f2312e2cdab48afc7999ee05ae71cb"> 1589</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ac3f2312e2cdab48afc7999ee05ae71cb">$n_dests</a>;</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;</div>
<div class="line"><a name="l01596"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a59be161aa1bfab0a103a9f9442638e1a"> 1596</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a59be161aa1bfab0a103a9f9442638e1a">$efnames</a> = array();</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;</div>
<div class="line"><a name="l01603"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a94d0edc7f6a71717a136e8408372cc22"> 1603</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a94d0edc7f6a71717a136e8408372cc22">$svgdir</a> = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;</div>
<div class="line"><a name="l01610"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a54142bcb00841f1e2be988fe37ad8dde"> 1610</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a54142bcb00841f1e2be988fe37ad8dde">$svgunit</a> = <span class="stringliteral">&#39;px&#39;</span>;</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;</div>
<div class="line"><a name="l01617"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#af4d75f0ad6d41ae94761b18f520eaaa8"> 1617</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#af4d75f0ad6d41ae94761b18f520eaaa8">$svggradients</a> = array();</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;</div>
<div class="line"><a name="l01624"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a295aec7c13f7d3c3a5e3b17a8d833cb2"> 1624</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a295aec7c13f7d3c3a5e3b17a8d833cb2">$svggradientid</a> = 0;</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;</div>
<div class="line"><a name="l01631"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a62459f3a2f6d85c0deb15f1f0ad30d0b"> 1631</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a62459f3a2f6d85c0deb15f1f0ad30d0b">$svgdefsmode</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;</div>
<div class="line"><a name="l01638"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a3f214500dcd7555dd9e7cfc2a0130086"> 1638</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a3f214500dcd7555dd9e7cfc2a0130086">$svgdefs</a> = array();</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;</div>
<div class="line"><a name="l01645"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a569179128414ccd12d17e0c7cbbd121f"> 1645</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a569179128414ccd12d17e0c7cbbd121f">$svgclipmode</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;</div>
<div class="line"><a name="l01652"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a11ee884b1e2c9ef718bf9744ce942940"> 1652</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a11ee884b1e2c9ef718bf9744ce942940">$svgclippaths</a> = array();</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;</div>
<div class="line"><a name="l01659"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a2748e6f033deb7641e4050e0370f1839"> 1659</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a2748e6f033deb7641e4050e0370f1839">$svgcliptm</a> = array();</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;</div>
<div class="line"><a name="l01666"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a6aa9631fbfb07623604d43d59cffeb5b"> 1666</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a6aa9631fbfb07623604d43d59cffeb5b">$svgclipid</a> = 0;</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;</div>
<div class="line"><a name="l01673"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aed7678d695337818bfcc454197f8674c"> 1673</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#aed7678d695337818bfcc454197f8674c">$svgtext</a> = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;</div>
<div class="line"><a name="l01680"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ad38280c03ec462b14d73b5c042ae7a76"> 1680</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ad38280c03ec462b14d73b5c042ae7a76">$svgtextmode</a> = array();</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;</div>
<div class="line"><a name="l01687"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ad1fedbeb11482327ed38385f0d21d349"> 1687</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ad1fedbeb11482327ed38385f0d21d349">$svgstyles</a> = array(array(</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;        <span class="stringliteral">&#39;alignment-baseline&#39;</span> =&gt; <span class="stringliteral">&#39;auto&#39;</span>,</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;        <span class="stringliteral">&#39;baseline-shift&#39;</span> =&gt; <span class="stringliteral">&#39;baseline&#39;</span>,</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;        <span class="stringliteral">&#39;clip&#39;</span> =&gt; <span class="stringliteral">&#39;auto&#39;</span>,</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;        <span class="stringliteral">&#39;clip-path&#39;</span> =&gt; <span class="stringliteral">&#39;none&#39;</span>,</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;        <span class="stringliteral">&#39;clip-rule&#39;</span> =&gt; <span class="stringliteral">&#39;nonzero&#39;</span>,</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;        <span class="stringliteral">&#39;color&#39;</span> =&gt; <span class="stringliteral">&#39;black&#39;</span>,</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;        <span class="stringliteral">&#39;color-interpolation&#39;</span> =&gt; <span class="stringliteral">&#39;sRGB&#39;</span>,</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;        <span class="stringliteral">&#39;color-interpolation-filters&#39;</span> =&gt; <span class="stringliteral">&#39;linearRGB&#39;</span>,</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;        <span class="stringliteral">&#39;color-profile&#39;</span> =&gt; <span class="stringliteral">&#39;auto&#39;</span>,</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;        <span class="stringliteral">&#39;color-rendering&#39;</span> =&gt; <span class="stringliteral">&#39;auto&#39;</span>,</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;        <span class="stringliteral">&#39;cursor&#39;</span> =&gt; <span class="stringliteral">&#39;auto&#39;</span>,</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;        <span class="stringliteral">&#39;direction&#39;</span> =&gt; <span class="stringliteral">&#39;ltr&#39;</span>,</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;        <span class="stringliteral">&#39;display&#39;</span> =&gt; <span class="stringliteral">&#39;inline&#39;</span>,</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;        <span class="stringliteral">&#39;dominant-baseline&#39;</span> =&gt; <span class="stringliteral">&#39;auto&#39;</span>,</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;        <span class="stringliteral">&#39;enable-background&#39;</span> =&gt; <span class="stringliteral">&#39;accumulate&#39;</span>,</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;        <span class="stringliteral">&#39;fill&#39;</span> =&gt; <span class="stringliteral">&#39;black&#39;</span>,</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;        <span class="stringliteral">&#39;fill-opacity&#39;</span> =&gt; 1,</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;        <span class="stringliteral">&#39;fill-rule&#39;</span> =&gt; <span class="stringliteral">&#39;nonzero&#39;</span>,</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;        <span class="stringliteral">&#39;filter&#39;</span> =&gt; <span class="stringliteral">&#39;none&#39;</span>,</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;        <span class="stringliteral">&#39;flood-color&#39;</span> =&gt; <span class="stringliteral">&#39;black&#39;</span>,</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;        <span class="stringliteral">&#39;flood-opacity&#39;</span> =&gt; 1,</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;        <span class="stringliteral">&#39;font&#39;</span> =&gt; <span class="stringliteral">&#39;&#39;</span>,</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;        <span class="stringliteral">&#39;font-family&#39;</span> =&gt; <span class="stringliteral">&#39;helvetica&#39;</span>,</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;        <span class="stringliteral">&#39;font-size&#39;</span> =&gt; <span class="stringliteral">&#39;medium&#39;</span>,</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;        <span class="stringliteral">&#39;font-size-adjust&#39;</span> =&gt; <span class="stringliteral">&#39;none&#39;</span>,</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;        <span class="stringliteral">&#39;font-stretch&#39;</span> =&gt; <span class="stringliteral">&#39;normal&#39;</span>,</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;        <span class="stringliteral">&#39;font-style&#39;</span> =&gt; <span class="stringliteral">&#39;normal&#39;</span>,</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;        <span class="stringliteral">&#39;font-variant&#39;</span> =&gt; <span class="stringliteral">&#39;normal&#39;</span>,</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;        <span class="stringliteral">&#39;font-weight&#39;</span> =&gt; <span class="stringliteral">&#39;normal&#39;</span>,</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;        <span class="stringliteral">&#39;glyph-orientation-horizontal&#39;</span> =&gt; <span class="stringliteral">&#39;0deg&#39;</span>,</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;        <span class="stringliteral">&#39;glyph-orientation-vertical&#39;</span> =&gt; <span class="stringliteral">&#39;auto&#39;</span>,</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;        <span class="stringliteral">&#39;image-rendering&#39;</span> =&gt; <span class="stringliteral">&#39;auto&#39;</span>,</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;        <span class="stringliteral">&#39;kerning&#39;</span> =&gt; <span class="stringliteral">&#39;auto&#39;</span>,</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;        <span class="stringliteral">&#39;letter-spacing&#39;</span> =&gt; <span class="stringliteral">&#39;normal&#39;</span>,</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;        <span class="stringliteral">&#39;lighting-color&#39;</span> =&gt; <span class="stringliteral">&#39;white&#39;</span>,</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;        <span class="stringliteral">&#39;marker&#39;</span> =&gt; <span class="stringliteral">&#39;&#39;</span>,</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;        <span class="stringliteral">&#39;marker-end&#39;</span> =&gt; <span class="stringliteral">&#39;none&#39;</span>,</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;        <span class="stringliteral">&#39;marker-mid&#39;</span> =&gt; <span class="stringliteral">&#39;none&#39;</span>,</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;        <span class="stringliteral">&#39;marker-start&#39;</span> =&gt; <span class="stringliteral">&#39;none&#39;</span>,</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;        <span class="stringliteral">&#39;mask&#39;</span> =&gt; <span class="stringliteral">&#39;none&#39;</span>,</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;        <span class="stringliteral">&#39;opacity&#39;</span> =&gt; 1,</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;        <span class="stringliteral">&#39;overflow&#39;</span> =&gt; <span class="stringliteral">&#39;auto&#39;</span>,</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;        <span class="stringliteral">&#39;pointer-events&#39;</span> =&gt; <span class="stringliteral">&#39;visiblePainted&#39;</span>,</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;        <span class="stringliteral">&#39;shape-rendering&#39;</span> =&gt; <span class="stringliteral">&#39;auto&#39;</span>,</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;        <span class="stringliteral">&#39;stop-color&#39;</span> =&gt; <span class="stringliteral">&#39;black&#39;</span>,</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;        <span class="stringliteral">&#39;stop-opacity&#39;</span> =&gt; 1,</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;        <span class="stringliteral">&#39;stroke&#39;</span> =&gt; <span class="stringliteral">&#39;none&#39;</span>,</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;        <span class="stringliteral">&#39;stroke-dasharray&#39;</span> =&gt; <span class="stringliteral">&#39;none&#39;</span>,</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;        <span class="stringliteral">&#39;stroke-dashoffset&#39;</span> =&gt; 0,</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;        <span class="stringliteral">&#39;stroke-linecap&#39;</span> =&gt; <span class="stringliteral">&#39;butt&#39;</span>,</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;        <span class="stringliteral">&#39;stroke-linejoin&#39;</span> =&gt; <span class="stringliteral">&#39;miter&#39;</span>,</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;        <span class="stringliteral">&#39;stroke-miterlimit&#39;</span> =&gt; 4,</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;        <span class="stringliteral">&#39;stroke-opacity&#39;</span> =&gt; 1,</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;        <span class="stringliteral">&#39;stroke-width&#39;</span> =&gt; 1,</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;        <span class="stringliteral">&#39;text-anchor&#39;</span> =&gt; <span class="stringliteral">&#39;start&#39;</span>,</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;        <span class="stringliteral">&#39;text-decoration&#39;</span> =&gt; <span class="stringliteral">&#39;none&#39;</span>,</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;        <span class="stringliteral">&#39;text-rendering&#39;</span> =&gt; <span class="stringliteral">&#39;auto&#39;</span>,</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;        <span class="stringliteral">&#39;unicode-bidi&#39;</span> =&gt; <span class="stringliteral">&#39;normal&#39;</span>,</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;        <span class="stringliteral">&#39;visibility&#39;</span> =&gt; <span class="stringliteral">&#39;visible&#39;</span>,</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;        <span class="stringliteral">&#39;word-spacing&#39;</span> =&gt; <span class="stringliteral">&#39;normal&#39;</span>,</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;        <span class="stringliteral">&#39;writing-mode&#39;</span> =&gt; <span class="stringliteral">&#39;lr-tb&#39;</span>,</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;        <span class="stringliteral">&#39;text-color&#39;</span> =&gt; <span class="stringliteral">&#39;black&#39;</span>,</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;        <span class="stringliteral">&#39;transfmatrix&#39;</span> =&gt; array(1, 0, 0, 1, 0, 0)</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;        ));</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;</div>
<div class="line"><a name="l01758"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a4702bedfb7ce4c5260c12d3637419c7a"> 1758</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a4702bedfb7ce4c5260c12d3637419c7a">$force_srgb</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;</div>
<div class="line"><a name="l01765"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aac34b7d5674382a748a05db919fbe759"> 1765</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#aac34b7d5674382a748a05db919fbe759">$pdfa_mode</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;</div>
<div class="line"><a name="l01772"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#af37c03f21372a70598f00034b7e41c0a"> 1772</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#af37c03f21372a70598f00034b7e41c0a">$doc_creation_timestamp</a>;</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;</div>
<div class="line"><a name="l01779"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a04519421e767c221f2f3bfbe51574896"> 1779</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a04519421e767c221f2f3bfbe51574896">$doc_modification_timestamp</a>;</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;</div>
<div class="line"><a name="l01786"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a08e9cd78d75c94166e9e4f629b4daa8c"> 1786</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a08e9cd78d75c94166e9e4f629b4daa8c">$custom_xmp</a> = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;</div>
<div class="line"><a name="l01794"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a271d4b388e1d57856c6f569cd97cb58f"> 1794</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a271d4b388e1d57856c6f569cd97cb58f">$overprint</a> = array(<span class="stringliteral">&#39;OP&#39;</span> =&gt; <span class="keyword">false</span>, <span class="stringliteral">&#39;op&#39;</span> =&gt; <span class="keyword">false</span>, <span class="stringliteral">&#39;OPM&#39;</span> =&gt; 0);</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;</div>
<div class="line"><a name="l01802"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ae4a86c2e1ba1b7026fbfb1eb43845f1a"> 1802</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#ae4a86c2e1ba1b7026fbfb1eb43845f1a">$alpha</a> = array(<span class="stringliteral">&#39;CA&#39;</span> =&gt; 1, <span class="stringliteral">&#39;ca&#39;</span> =&gt; 1, <span class="stringliteral">&#39;BM&#39;</span> =&gt; <span class="stringliteral">&#39;/Normal&#39;</span>, <span class="stringliteral">&#39;AIS&#39;</span> =&gt; <span class="keyword">false</span>);</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;</div>
<div class="line"><a name="l01809"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a2a0c1bccf252929e1d46725e97cfefdf"> 1809</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a2a0c1bccf252929e1d46725e97cfefdf">$page_boxes</a> = array(<span class="stringliteral">&#39;MediaBox&#39;</span>, <span class="stringliteral">&#39;CropBox&#39;</span>, <span class="stringliteral">&#39;BleedBox&#39;</span>, <span class="stringliteral">&#39;TrimBox&#39;</span>, <span class="stringliteral">&#39;ArtBox&#39;</span>);</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;</div>
<div class="line"><a name="l01816"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a83e077f753f29339c8eb08401e52e2f1"> 1816</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#a83e077f753f29339c8eb08401e52e2f1">$tcpdflink</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;</div>
<div class="line"><a name="l01823"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aca943b0187b25b36e1cb3e37e299ad1b"> 1823</a></span>&#160;    <span class="keyword">protected</span> <a class="code" href="../../d4/d40/classTCPDF.html#aca943b0187b25b36e1cb3e37e299ad1b">$gdgammacache</a> = array();</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;    <span class="comment">//------------------------------------------------------------</span></div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;    <span class="comment">// METHODS</span></div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;    <span class="comment">//------------------------------------------------------------</span></div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;</div>
<div class="line"><a name="l01845"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a134232ae3ad1ec186ed45046f94b7755"> 1845</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a134232ae3ad1ec186ed45046f94b7755">__construct</a>($orientation=<span class="charliteral">&#39;P&#39;</span>, $unit=<span class="stringliteral">&#39;mm&#39;</span>, $format=<span class="stringliteral">&#39;A4&#39;</span>, $unicode=<span class="keyword">true</span>, <a class="code" href="../../d4/d40/classTCPDF.html#a274314ff17c5df9ae105f9c91893a4a7">$encoding</a>=<span class="stringliteral">&#39;UTF-8&#39;</span>, <a class="code" href="../../d4/d40/classTCPDF.html#ae36b54ab4599f14fc4116bb77ffbcc6b">$diskcache</a>=<span class="keyword">false</span>, $pdfa=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;        <span class="comment">/* Set internal character encoding to ASCII */</span></div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;        <span class="keywordflow">if</span> (function_exists(<span class="stringliteral">&#39;mb_internal_encoding&#39;</span>) AND mb_internal_encoding()) {</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;            $this-&gt;internal_encoding = mb_internal_encoding();</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;            mb_internal_encoding(<span class="stringliteral">&#39;ASCII&#39;</span>);</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;        }</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;        <span class="comment">// set file ID for trailer</span></div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;        $serformat = (is_array($format) ? json_encode($format) : $format);</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;        $this-&gt;file_id = md5(TCPDF_STATIC::getRandomSeed(<span class="stringliteral">&#39;TCPDF&#39;</span>.$orientation.$unit.$serformat.$encoding));</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;        $this-&gt;font_obj_ids = array();</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;        $this-&gt;page_obj_id = array();</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;        $this-&gt;form_obj_id = array();</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;        <span class="comment">// set pdf/a mode</span></div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;        $this-&gt;pdfa_mode = $pdfa;</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;        $this-&gt;force_srgb = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;        <span class="comment">// set disk caching</span></div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;        $this-&gt;diskcache = <a class="code" href="../../d4/d40/classTCPDF.html#ae36b54ab4599f14fc4116bb77ffbcc6b">$diskcache</a> ? <span class="keyword">true</span> : <span class="keyword">false</span>;</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;        <span class="comment">// set language direction</span></div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;        $this-&gt;rtl = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;        $this-&gt;tmprtl = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;        <span class="comment">// some checks</span></div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a17346daa2c4848e475ad4f408376e2c2">_dochecks</a>();</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;        <span class="comment">// initialization of properties</span></div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;        $this-&gt;isunicode = $unicode;</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;        $this-&gt;page = 0;</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;        $this-&gt;transfmrk[0] = array();</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;        $this-&gt;pagedim = array();</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;        $this-&gt;n = 2;</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;        $this-&gt;buffer = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;        $this-&gt;pages = array();</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;        $this-&gt;state = 0;</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;        $this-&gt;fonts = array();</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;        $this-&gt;FontFiles = array();</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;        $this-&gt;diffs = array();</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;        $this-&gt;images = array();</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;        $this-&gt;links = array();</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;        $this-&gt;gradients = array();</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;        $this-&gt;InFooter = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;        $this-&gt;lasth = 0;</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;        $this-&gt;FontFamily = defined(<span class="stringliteral">&#39;PDF_FONT_NAME_MAIN&#39;</span>)?<a class="code" href="../../d5/dc0/tcpdf__config_8php.html#a24c5be6597b6e1ffd1a8011e2917ddf7">PDF_FONT_NAME_MAIN</a>:<span class="stringliteral">&#39;helvetica&#39;</span>;</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;        $this-&gt;FontStyle = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;        $this-&gt;FontSizePt = 12;</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;        $this-&gt;underline = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;        $this-&gt;overline = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;        $this-&gt;linethrough = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;        $this-&gt;DrawColor = <span class="stringliteral">&#39;0 G&#39;</span>;</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;        $this-&gt;FillColor = <span class="stringliteral">&#39;0 g&#39;</span>;</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;        $this-&gt;TextColor = <span class="stringliteral">&#39;0 g&#39;</span>;</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;        $this-&gt;ColorFlag = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;        $this-&gt;pdflayers = array();</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;        <span class="comment">// encryption values</span></div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;        $this-&gt;encrypted = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;        $this-&gt;last_enc_key = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;        <span class="comment">// standard Unicode fonts</span></div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;        $this-&gt;CoreFonts = array(</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;            <span class="stringliteral">&#39;courier&#39;</span>=&gt;<span class="stringliteral">&#39;Courier&#39;</span>,</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;            <span class="stringliteral">&#39;courierB&#39;</span>=&gt;<span class="stringliteral">&#39;Courier-Bold&#39;</span>,</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;            <span class="stringliteral">&#39;courierI&#39;</span>=&gt;<span class="stringliteral">&#39;Courier-Oblique&#39;</span>,</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;            <span class="stringliteral">&#39;courierBI&#39;</span>=&gt;<span class="stringliteral">&#39;Courier-BoldOblique&#39;</span>,</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;            <span class="stringliteral">&#39;helvetica&#39;</span>=&gt;<span class="stringliteral">&#39;Helvetica&#39;</span>,</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;            <span class="stringliteral">&#39;helveticaB&#39;</span>=&gt;<span class="stringliteral">&#39;Helvetica-Bold&#39;</span>,</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;            <span class="stringliteral">&#39;helveticaI&#39;</span>=&gt;<span class="stringliteral">&#39;Helvetica-Oblique&#39;</span>,</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;            <span class="stringliteral">&#39;helveticaBI&#39;</span>=&gt;<span class="stringliteral">&#39;Helvetica-BoldOblique&#39;</span>,</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;            <span class="stringliteral">&#39;times&#39;</span>=&gt;<span class="stringliteral">&#39;Times-Roman&#39;</span>,</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;            <span class="stringliteral">&#39;timesB&#39;</span>=&gt;<span class="stringliteral">&#39;Times-Bold&#39;</span>,</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;            <span class="stringliteral">&#39;timesI&#39;</span>=&gt;<span class="stringliteral">&#39;Times-Italic&#39;</span>,</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;            <span class="stringliteral">&#39;timesBI&#39;</span>=&gt;<span class="stringliteral">&#39;Times-BoldItalic&#39;</span>,</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;            <span class="stringliteral">&#39;symbol&#39;</span>=&gt;<span class="stringliteral">&#39;Symbol&#39;</span>,</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;            <span class="stringliteral">&#39;zapfdingbats&#39;</span>=&gt;<span class="stringliteral">&#39;ZapfDingbats&#39;</span></div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;        );</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;        <span class="comment">// set scale factor</span></div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aad2c0cbfe5b6330eed5850f87c2a32d9">setPageUnit</a>($unit);</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;        <span class="comment">// set page format and orientation</span></div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa389d4419c77510dc3998f0af78d8a00">setPageFormat</a>($format, $orientation);</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;        <span class="comment">// page margins (1 cm)</span></div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;        $margin = 28.35 / <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>;</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ab3bbdb7c85ea08d175fd559be6132ba0">SetMargins</a>($margin, $margin);</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;        $this-&gt;clMargin = <a class="code" href="../../d4/d40/classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da">$this-&gt;lMargin</a>;</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;        $this-&gt;crMargin = <a class="code" href="../../d4/d40/classTCPDF.html#a44fb75b85bea40ced25fdea9d89dc8e9">$this-&gt;rMargin</a>;</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;        <span class="comment">// internal cell padding</span></div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;        $cpadding = $margin / 10;</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aba22c5159414bb96cadfa66efd89bc7c">setCellPaddings</a>($cpadding, 0, $cpadding, 0);</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;        <span class="comment">// cell margins</span></div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a80e96cb97ad08e7feb952d2e5e8dc36d">setCellMargins</a>(0, 0, 0, 0);</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;        <span class="comment">// line width (0.2 mm)</span></div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;        $this-&gt;LineWidth = 0.57 / <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>;</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;        $this-&gt;linestyleWidth = sprintf(<span class="stringliteral">&#39;%F w&#39;</span>, ($this-&gt;LineWidth * $this-&gt;k));</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;        $this-&gt;linestyleCap = <span class="stringliteral">&#39;0 J&#39;</span>;</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;        $this-&gt;linestyleJoin = <span class="stringliteral">&#39;0 j&#39;</span>;</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;        $this-&gt;linestyleDash = <span class="stringliteral">&#39;[] 0 d&#39;</span>;</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;        <span class="comment">// automatic page break</span></div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4430365ea0b9015b4aefedad1ba77ea9">SetAutoPageBreak</a>(<span class="keyword">true</span>, (2 * $margin));</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;        <span class="comment">// full width display mode</span></div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ad99d9dea88f659fedf9fe11f30586a99">SetDisplayMode</a>(<span class="stringliteral">&#39;fullwidth&#39;</span>);</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;        <span class="comment">// compression</span></div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a6140a1ff2c5ed3f490592b6917f5adf3">SetCompression</a>();</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;        <span class="comment">// set default PDF version number</span></div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a2803ddf7b83704355bcf1225f06cfcbb">setPDFVersion</a>();</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;        $this-&gt;tcpdflink = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;        $this-&gt;encoding = <a class="code" href="../../d4/d40/classTCPDF.html#a274314ff17c5df9ae105f9c91893a4a7">$encoding</a>;</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;        $this-&gt;HREF = array();</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ae87d16aa348205f2a1654cc2ac42367c">getFontsList</a>();</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;        $this-&gt;fgcolor = array(<span class="charliteral">&#39;R&#39;</span> =&gt; 0, <span class="charliteral">&#39;G&#39;</span> =&gt; 0, <span class="charliteral">&#39;B&#39;</span> =&gt; 0);</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;        $this-&gt;strokecolor = array(<span class="charliteral">&#39;R&#39;</span> =&gt; 0, <span class="charliteral">&#39;G&#39;</span> =&gt; 0, <span class="charliteral">&#39;B&#39;</span> =&gt; 0);</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;        $this-&gt;bgcolor = array(<span class="charliteral">&#39;R&#39;</span> =&gt; 255, <span class="charliteral">&#39;G&#39;</span> =&gt; 255, <span class="charliteral">&#39;B&#39;</span> =&gt; 255);</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;        $this-&gt;extgstates = array();</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a7db5d71deb95779481ed9e99fcf3d19a">setTextShadow</a>();</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;        <span class="comment">// signature</span></div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;        $this-&gt;sign = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;        $this-&gt;tsa_timestamp = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;        $this-&gt;tsa_data = array();</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;        $this-&gt;signature_appearance = array(<span class="stringliteral">&#39;page&#39;</span> =&gt; 1, <span class="stringliteral">&#39;rect&#39;</span> =&gt; <span class="stringliteral">&#39;0 0 0 0&#39;</span>, <span class="stringliteral">&#39;name&#39;</span> =&gt; <span class="stringliteral">&#39;Signature&#39;</span>);</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;        $this-&gt;empty_signature_appearance = array();</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;        <span class="comment">// user&#39;s rights</span></div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;        $this-&gt;ur[<span class="stringliteral">&#39;enabled&#39;</span>] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;        $this-&gt;ur[<span class="stringliteral">&#39;document&#39;</span>] = <span class="stringliteral">&#39;/FullSave&#39;</span>;</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;        $this-&gt;ur[<span class="stringliteral">&#39;annots&#39;</span>] = <span class="stringliteral">&#39;/Create/Delete/Modify/Copy/Import/Export&#39;</span>;</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;        $this-&gt;ur[<span class="stringliteral">&#39;form&#39;</span>] = <span class="stringliteral">&#39;/Add/Delete/FillIn/Import/Export/SubmitStandalone/SpawnTemplate&#39;</span>;</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;        $this-&gt;ur[<span class="stringliteral">&#39;signature&#39;</span>] = <span class="stringliteral">&#39;/Modify&#39;</span>;</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;        $this-&gt;ur[<span class="stringliteral">&#39;ef&#39;</span>] = <span class="stringliteral">&#39;/Create/Delete/Modify/Import&#39;</span>;</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;        $this-&gt;ur[<span class="stringliteral">&#39;formex&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;        <span class="comment">// set default JPEG quality</span></div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;        $this-&gt;jpeg_quality = 75;</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;        <span class="comment">// initialize some settings</span></div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;        TCPDF_FONTS::utf8Bidi(array(<span class="stringliteral">&#39;&#39;</span>), <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>, $this-&gt;isunicode, $this-&gt;CurrentFont);</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;        <span class="comment">// set default font</span></div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#afd56e360c43553830d543323e81bc045">SetFont</a>($this-&gt;FontFamily, $this-&gt;FontStyle, $this-&gt;FontSizePt);</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aee22655aad0ae32a3194298585da16a2">setHeaderFont</a>(array($this-&gt;FontFamily, $this-&gt;FontStyle, $this-&gt;FontSizePt));</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af1b0f1f3ec868528230e8b0293a23a4c">setFooterFont</a>(array($this-&gt;FontFamily, $this-&gt;FontStyle, $this-&gt;FontSizePt));</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;        <span class="comment">// check if PCRE Unicode support is enabled</span></div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;isunicode AND (@preg_match(<span class="stringliteral">&#39;/\pL/u&#39;</span>, <span class="charliteral">&#39;a&#39;</span>) == 1)) {</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;            <span class="comment">// PCRE unicode support is turned ON</span></div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;            <span class="comment">// \s     : any whitespace character</span></div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;            <span class="comment">// \p{Z}  : any separator</span></div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;            <span class="comment">// \p{Lo} : Unicode letter or ideograph that does not have lowercase and uppercase variants. Is used to chunk chinese words.</span></div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;            <span class="comment">// \xa0   : Unicode Character &#39;NO-BREAK SPACE&#39; (U+00A0)</span></div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;            <span class="comment">//$this-&gt;setSpacesRE(&#39;/(?!\xa0)[\s\p{Z}\p{Lo}]/u&#39;);</span></div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a937dcd07bad79ae3900236f87b29194b">setSpacesRE</a>(<span class="stringliteral">&#39;/(?!\xa0)[\s\p{Z}]/u&#39;</span>);</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;            <span class="comment">// PCRE unicode support is turned OFF</span></div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a937dcd07bad79ae3900236f87b29194b">setSpacesRE</a>(<span class="stringliteral">&#39;/[^\S\xa0]/&#39;</span>);</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;        }</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;        $this-&gt;default_form_prop = array(<span class="stringliteral">&#39;lineWidth&#39;</span>=&gt;1, <span class="stringliteral">&#39;borderStyle&#39;</span>=&gt;<span class="stringliteral">&#39;solid&#39;</span>, <span class="stringliteral">&#39;fillColor&#39;</span>=&gt;array(255, 255, 255), <span class="stringliteral">&#39;strokeColor&#39;</span>=&gt;array(128, 128, 128));</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;        <span class="comment">// set document creation and modification timestamp</span></div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;        $this-&gt;doc_creation_timestamp = time();</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;        $this-&gt;doc_modification_timestamp = <a class="code" href="../../d4/d40/classTCPDF.html#af37c03f21372a70598f00034b7e41c0a">$this-&gt;doc_creation_timestamp</a>;</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;        <span class="comment">// get default graphic vars</span></div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;        $this-&gt;default_graphic_vars = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a24d3c102468b6ab9d2f4859a8b01863a">getGraphicVars</a>();</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;        $this-&gt;header_xobj_autoreset = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;        $this-&gt;custom_xmp = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;    }</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;</div>
<div class="line"><a name="l02002"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a5addd56687b7a3d97f6abac7c7cdb253"> 2002</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a5addd56687b7a3d97f6abac7c7cdb253">__destruct</a>() {</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;        <span class="comment">// restore internal encoding</span></div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;internal_encoding) AND !empty($this-&gt;internal_encoding)) {</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;            mb_internal_encoding($this-&gt;internal_encoding);</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;        }</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;        <span class="comment">// unset all class variables</span></div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ae91c72441bff1164a3ab9d237a4e1faa">_destroy</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;    }</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;</div>
<div class="line"><a name="l02017"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aad2c0cbfe5b6330eed5850f87c2a32d9"> 2017</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#aad2c0cbfe5b6330eed5850f87c2a32d9">setPageUnit</a>($unit) {</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;        $unit = strtolower($unit);</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;        <span class="comment">//Set scale factor</span></div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;        <span class="keywordflow">switch</span> ($unit) {</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;            <span class="comment">// points</span></div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;px&#39;</span>:</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;pt&#39;</span>: {</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;                $this-&gt;k = 1;</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;            }</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;            <span class="comment">// millimeters</span></div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;mm&#39;</span>: {</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;                $this-&gt;k = $this-&gt;dpi / 25.4;</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;            }</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;            <span class="comment">// centimeters</span></div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;cm&#39;</span>: {</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;                $this-&gt;k = $this-&gt;dpi / 2.54;</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;            }</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;            <span class="comment">// inches</span></div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;in&#39;</span>: {</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;                $this-&gt;k = <a class="code" href="../../d4/d40/classTCPDF.html#a22272525668774dab75d46dfd66ff2f2">$this-&gt;dpi</a>;</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;            }</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;            <span class="comment">// unsupported unit</span></div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;            <span class="keywordflow">default</span> : {</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;Incorrect unit: &#39;</span>.$unit);</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;            }</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;        }</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;        $this-&gt;pdfunit = $unit;</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;CurOrientation)) {</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ad6a3575405b61049ff85ce019df5451d">setPageOrientation</a>($this-&gt;CurOrientation);</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;        }</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;    }</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;</div>
<div class="line"><a name="l02109"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aa389d4419c77510dc3998f0af78d8a00"> 2109</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#aa389d4419c77510dc3998f0af78d8a00">setPageFormat</a>($format, $orientation=<span class="charliteral">&#39;P&#39;</span>) {</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;        <span class="keywordflow">if</span> (!empty($format) AND isset($this-&gt;pagedim[$this-&gt;page])) {</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;            <span class="comment">// remove inherited values</span></div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;            unset($this-&gt;pagedim[$this-&gt;page]);</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;        }</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;        <span class="keywordflow">if</span> (is_string($format)) {</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;            <span class="comment">// get page measures from format name</span></div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;            $pf = TCPDF_STATIC::getPageSizeFromFormat($format);</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;            $this-&gt;fwPt = $pf[0];</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;            $this-&gt;fhPt = $pf[1];</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;            <span class="comment">// the boundaries of the physical medium on which the page shall be displayed or printed</span></div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;            <span class="keywordflow">if</span> (isset($format[<span class="stringliteral">&#39;MediaBox&#39;</span>])) {</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;                $this-&gt;pagedim = TCPDF_STATIC::setPageBoxes($this-&gt;page, <span class="stringliteral">&#39;MediaBox&#39;</span>, $format[<span class="stringliteral">&#39;MediaBox&#39;</span>][<span class="stringliteral">&#39;llx&#39;</span>], $format[<span class="stringliteral">&#39;MediaBox&#39;</span>][<span class="stringliteral">&#39;lly&#39;</span>], $format[<span class="stringliteral">&#39;MediaBox&#39;</span>][<span class="stringliteral">&#39;urx&#39;</span>], $format[<span class="stringliteral">&#39;MediaBox&#39;</span>][<span class="stringliteral">&#39;ury&#39;</span>], <span class="keyword">false</span>, $this-&gt;k, $this-&gt;pagedim);</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;                $this-&gt;fwPt = (($format[<span class="stringliteral">&#39;MediaBox&#39;</span>][<span class="stringliteral">&#39;urx&#39;</span>] - $format[<span class="stringliteral">&#39;MediaBox&#39;</span>][<span class="stringliteral">&#39;llx&#39;</span>]) * $this-&gt;k);</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;                $this-&gt;fhPt = (($format[<span class="stringliteral">&#39;MediaBox&#39;</span>][<span class="stringliteral">&#39;ury&#39;</span>] - $format[<span class="stringliteral">&#39;MediaBox&#39;</span>][<span class="stringliteral">&#39;lly&#39;</span>]) * $this-&gt;k);</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;                <span class="keywordflow">if</span> (isset($format[0]) AND is_numeric($format[0]) AND isset($format[1]) AND is_numeric($format[1])) {</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;                    $pf = array(($format[0] * $this-&gt;k), ($format[1] * $this-&gt;k));</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;                    <span class="keywordflow">if</span> (!isset($format[<span class="stringliteral">&#39;format&#39;</span>])) {</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;                        <span class="comment">// default value</span></div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;                        $format[<span class="stringliteral">&#39;format&#39;</span>] = <span class="stringliteral">&#39;A4&#39;</span>;</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;                    }</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;                    $pf = TCPDF_STATIC::getPageSizeFromFormat($format[<span class="stringliteral">&#39;format&#39;</span>]);</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;                }</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;                $this-&gt;fwPt = $pf[0];</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;                $this-&gt;fhPt = $pf[1];</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;                $this-&gt;pagedim = TCPDF_STATIC::setPageBoxes($this-&gt;page, <span class="stringliteral">&#39;MediaBox&#39;</span>, 0, 0, $this-&gt;fwPt, $this-&gt;fhPt, <span class="keyword">true</span>, $this-&gt;k, $this-&gt;pagedim);</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;            }</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;            <span class="comment">// the visible region of default user space</span></div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;            <span class="keywordflow">if</span> (isset($format[<span class="stringliteral">&#39;CropBox&#39;</span>])) {</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;                $this-&gt;pagedim = TCPDF_STATIC::setPageBoxes($this-&gt;page, <span class="stringliteral">&#39;CropBox&#39;</span>, $format[<span class="stringliteral">&#39;CropBox&#39;</span>][<span class="stringliteral">&#39;llx&#39;</span>], $format[<span class="stringliteral">&#39;CropBox&#39;</span>][<span class="stringliteral">&#39;lly&#39;</span>], $format[<span class="stringliteral">&#39;CropBox&#39;</span>][<span class="stringliteral">&#39;urx&#39;</span>], $format[<span class="stringliteral">&#39;CropBox&#39;</span>][<span class="stringliteral">&#39;ury&#39;</span>], <span class="keyword">false</span>, $this-&gt;k, $this-&gt;pagedim);</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;            }</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;            <span class="comment">// the region to which the contents of the page shall be clipped when output in a production environment</span></div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;            <span class="keywordflow">if</span> (isset($format[<span class="stringliteral">&#39;BleedBox&#39;</span>])) {</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;                $this-&gt;pagedim = TCPDF_STATIC::setPageBoxes($this-&gt;page, <span class="stringliteral">&#39;BleedBox&#39;</span>, $format[<span class="stringliteral">&#39;BleedBox&#39;</span>][<span class="stringliteral">&#39;llx&#39;</span>], $format[<span class="stringliteral">&#39;BleedBox&#39;</span>][<span class="stringliteral">&#39;lly&#39;</span>], $format[<span class="stringliteral">&#39;BleedBox&#39;</span>][<span class="stringliteral">&#39;urx&#39;</span>], $format[<span class="stringliteral">&#39;BleedBox&#39;</span>][<span class="stringliteral">&#39;ury&#39;</span>], <span class="keyword">false</span>, $this-&gt;k, $this-&gt;pagedim);</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;            }</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;            <span class="comment">// the intended dimensions of the finished page after trimming</span></div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;            <span class="keywordflow">if</span> (isset($format[<span class="stringliteral">&#39;TrimBox&#39;</span>])) {</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;                $this-&gt;pagedim = TCPDF_STATIC::setPageBoxes($this-&gt;page, <span class="stringliteral">&#39;TrimBox&#39;</span>, $format[<span class="stringliteral">&#39;TrimBox&#39;</span>][<span class="stringliteral">&#39;llx&#39;</span>], $format[<span class="stringliteral">&#39;TrimBox&#39;</span>][<span class="stringliteral">&#39;lly&#39;</span>], $format[<span class="stringliteral">&#39;TrimBox&#39;</span>][<span class="stringliteral">&#39;urx&#39;</span>], $format[<span class="stringliteral">&#39;TrimBox&#39;</span>][<span class="stringliteral">&#39;ury&#39;</span>], <span class="keyword">false</span>, $this-&gt;k, $this-&gt;pagedim);</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;            }</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;            <span class="comment">// the page&#39;s meaningful content (including potential white space)</span></div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;            <span class="keywordflow">if</span> (isset($format[<span class="stringliteral">&#39;ArtBox&#39;</span>])) {</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;                $this-&gt;pagedim = TCPDF_STATIC::setPageBoxes($this-&gt;page, <span class="stringliteral">&#39;ArtBox&#39;</span>, $format[<span class="stringliteral">&#39;ArtBox&#39;</span>][<span class="stringliteral">&#39;llx&#39;</span>], $format[<span class="stringliteral">&#39;ArtBox&#39;</span>][<span class="stringliteral">&#39;lly&#39;</span>], $format[<span class="stringliteral">&#39;ArtBox&#39;</span>][<span class="stringliteral">&#39;urx&#39;</span>], $format[<span class="stringliteral">&#39;ArtBox&#39;</span>][<span class="stringliteral">&#39;ury&#39;</span>], <span class="keyword">false</span>, $this-&gt;k, $this-&gt;pagedim);</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;            }</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;            <span class="comment">// specify the colours and other visual characteristics that should be used in displaying guidelines on the screen for the various page boundaries</span></div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;            <span class="keywordflow">if</span> (isset($format[<span class="stringliteral">&#39;BoxColorInfo&#39;</span>])) {</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;                $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;BoxColorInfo&#39;</span>] = $format[<span class="stringliteral">&#39;BoxColorInfo&#39;</span>];</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;            }</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;            <span class="keywordflow">if</span> (isset($format[<span class="stringliteral">&#39;Rotate&#39;</span>]) AND (($format[<span class="stringliteral">&#39;Rotate&#39;</span>] % 90) == 0)) {</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;                <span class="comment">// The number of degrees by which the page shall be rotated clockwise when displayed or printed. The value shall be a multiple of 90.</span></div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;                $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;Rotate&#39;</span>] = intval($format[<span class="stringliteral">&#39;Rotate&#39;</span>]);</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;            }</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;            <span class="keywordflow">if</span> (isset($format[<span class="stringliteral">&#39;PZ&#39;</span>])) {</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;                <span class="comment">// The page&#39;s preferred zoom (magnification) factor</span></div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;                $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;PZ&#39;</span>] = floatval($format[<span class="stringliteral">&#39;PZ&#39;</span>]);</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;            }</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;            <span class="keywordflow">if</span> (isset($format[<span class="stringliteral">&#39;trans&#39;</span>])) {</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;                <span class="comment">// The style and duration of the visual transition to use when moving from another page to the given page during a presentation</span></div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;                <span class="keywordflow">if</span> (isset($format[<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;Dur&#39;</span>])) {</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;                    <span class="comment">// The page&#39;s display duration</span></div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;                    $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;Dur&#39;</span>] = floatval($format[<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;Dur&#39;</span>]);</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;                }</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;                $stansition_styles = array(<span class="stringliteral">&#39;Split&#39;</span>, <span class="stringliteral">&#39;Blinds&#39;</span>, <span class="stringliteral">&#39;Box&#39;</span>, <span class="stringliteral">&#39;Wipe&#39;</span>, <span class="stringliteral">&#39;Dissolve&#39;</span>, <span class="stringliteral">&#39;Glitter&#39;</span>, <span class="charliteral">&#39;R&#39;</span>, <span class="stringliteral">&#39;Fly&#39;</span>, <span class="stringliteral">&#39;Push&#39;</span>, <span class="stringliteral">&#39;Cover&#39;</span>, <span class="stringliteral">&#39;Uncover&#39;</span>, <span class="stringliteral">&#39;Fade&#39;</span>);</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;                <span class="keywordflow">if</span> (isset($format[<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;S&#39;</span>]) AND in_array($format[<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;S&#39;</span>], $stansition_styles)) {</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;                    <span class="comment">// The transition style that shall be used when moving to this page from another during a presentation</span></div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;                    $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;S&#39;</span>] = $format[<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;S&#39;</span>];</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;                    $valid_effect = array(<span class="stringliteral">&#39;Split&#39;</span>, <span class="stringliteral">&#39;Blinds&#39;</span>);</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;                    $valid_vals = array(<span class="charliteral">&#39;H&#39;</span>, <span class="charliteral">&#39;V&#39;</span>);</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;                    <span class="keywordflow">if</span> (isset($format[<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;Dm&#39;</span>]) AND in_array($format[<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;S&#39;</span>], $valid_effect) AND in_array($format[<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;Dm&#39;</span>], $valid_vals)) {</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;                        $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;Dm&#39;</span>] = $format[<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;Dm&#39;</span>];</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;                    }</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;                    $valid_effect = array(<span class="stringliteral">&#39;Split&#39;</span>, <span class="stringliteral">&#39;Box&#39;</span>, <span class="stringliteral">&#39;Fly&#39;</span>);</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;                    $valid_vals = array(<span class="charliteral">&#39;I&#39;</span>, <span class="charliteral">&#39;O&#39;</span>);</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;                    <span class="keywordflow">if</span> (isset($format[<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;M&#39;</span>]) AND in_array($format[<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;S&#39;</span>], $valid_effect) AND in_array($format[<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;M&#39;</span>], $valid_vals)) {</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;                        $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;M&#39;</span>] = $format[<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;M&#39;</span>];</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;                    }</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;                    $valid_effect = array(<span class="stringliteral">&#39;Wipe&#39;</span>, <span class="stringliteral">&#39;Glitter&#39;</span>, <span class="stringliteral">&#39;Fly&#39;</span>, <span class="stringliteral">&#39;Cover&#39;</span>, <span class="stringliteral">&#39;Uncover&#39;</span>, <span class="stringliteral">&#39;Push&#39;</span>);</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;                    <span class="keywordflow">if</span> (isset($format[<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;Di&#39;</span>]) AND in_array($format[<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;S&#39;</span>], $valid_effect)) {</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;                        <span class="keywordflow">if</span> (((($format[<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;Di&#39;</span>] == 90) OR ($format[<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;Di&#39;</span>] == 180)) AND ($format[<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;S&#39;</span>] == <span class="stringliteral">&#39;Wipe&#39;</span>))</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;                            OR (($format[<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;Di&#39;</span>] == 315) AND ($format[<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;S&#39;</span>] == <span class="stringliteral">&#39;Glitter&#39;</span>))</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;                            OR (($format[<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;Di&#39;</span>] == 0) OR ($format[<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;Di&#39;</span>] == 270))) {</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;                            $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;Di&#39;</span>] = intval($format[<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;Di&#39;</span>]);</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;                        }</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;                    }</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;                    <span class="keywordflow">if</span> (isset($format[<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;SS&#39;</span>]) AND ($format[<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;S&#39;</span>] == <span class="stringliteral">&#39;Fly&#39;</span>)) {</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;                        $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;SS&#39;</span>] = floatval($format[<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;SS&#39;</span>]);</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;                    }</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;                    <span class="keywordflow">if</span> (isset($format[<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;B&#39;</span>]) AND ($format[<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;B&#39;</span>] === <span class="keyword">true</span>) AND ($format[<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;S&#39;</span>] == <span class="stringliteral">&#39;Fly&#39;</span>)) {</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;                        $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;B&#39;</span>] = <span class="stringliteral">&#39;true&#39;</span>;</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;                    }</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;                    $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;S&#39;</span>] = <span class="charliteral">&#39;R&#39;</span>;</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;                }</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;                <span class="keywordflow">if</span> (isset($format[<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;D&#39;</span>])) {</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;                    <span class="comment">// The duration of the transition effect, in seconds</span></div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;                    $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;D&#39;</span>] = floatval($format[<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;D&#39;</span>]);</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;                    $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;D&#39;</span>] = 1;</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;                }</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;            }</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;        }</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ad6a3575405b61049ff85ce019df5451d">setPageOrientation</a>($orientation);</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;    }</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;</div>
<div class="line"><a name="l02223"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ad6a3575405b61049ff85ce019df5451d"> 2223</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ad6a3575405b61049ff85ce019df5451d">setPageOrientation</a>($orientation, $autopagebreak=<span class="stringliteral">&#39;&#39;</span>, $bottommargin=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;        <span class="keywordflow">if</span> (!isset($this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;MediaBox&#39;</span>])) {</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;            <span class="comment">// the boundaries of the physical medium on which the page shall be displayed or printed</span></div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;            $this-&gt;pagedim = TCPDF_STATIC::setPageBoxes($this-&gt;page, <span class="stringliteral">&#39;MediaBox&#39;</span>, 0, 0, $this-&gt;fwPt, $this-&gt;fhPt, <span class="keyword">true</span>, $this-&gt;k, $this-&gt;pagedim);</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;        }</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;        <span class="keywordflow">if</span> (!isset($this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;CropBox&#39;</span>])) {</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;            <span class="comment">// the visible region of default user space</span></div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;            $this-&gt;pagedim = TCPDF_STATIC::setPageBoxes($this-&gt;page, <span class="stringliteral">&#39;CropBox&#39;</span>, $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;MediaBox&#39;</span>][<span class="stringliteral">&#39;llx&#39;</span>], $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;MediaBox&#39;</span>][<span class="stringliteral">&#39;lly&#39;</span>], $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;MediaBox&#39;</span>][<span class="stringliteral">&#39;urx&#39;</span>], $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;MediaBox&#39;</span>][<span class="stringliteral">&#39;ury&#39;</span>], <span class="keyword">true</span>, $this-&gt;k, $this-&gt;pagedim);</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;        }</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;        <span class="keywordflow">if</span> (!isset($this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;BleedBox&#39;</span>])) {</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;            <span class="comment">// the region to which the contents of the page shall be clipped when output in a production environment</span></div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;            $this-&gt;pagedim = TCPDF_STATIC::setPageBoxes($this-&gt;page, <span class="stringliteral">&#39;BleedBox&#39;</span>, $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;CropBox&#39;</span>][<span class="stringliteral">&#39;llx&#39;</span>], $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;CropBox&#39;</span>][<span class="stringliteral">&#39;lly&#39;</span>], $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;CropBox&#39;</span>][<span class="stringliteral">&#39;urx&#39;</span>], $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;CropBox&#39;</span>][<span class="stringliteral">&#39;ury&#39;</span>], <span class="keyword">true</span>, $this-&gt;k, $this-&gt;pagedim);</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;        }</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;        <span class="keywordflow">if</span> (!isset($this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;TrimBox&#39;</span>])) {</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;            <span class="comment">// the intended dimensions of the finished page after trimming</span></div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;            $this-&gt;pagedim = TCPDF_STATIC::setPageBoxes($this-&gt;page, <span class="stringliteral">&#39;TrimBox&#39;</span>, $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;CropBox&#39;</span>][<span class="stringliteral">&#39;llx&#39;</span>], $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;CropBox&#39;</span>][<span class="stringliteral">&#39;lly&#39;</span>], $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;CropBox&#39;</span>][<span class="stringliteral">&#39;urx&#39;</span>], $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;CropBox&#39;</span>][<span class="stringliteral">&#39;ury&#39;</span>], <span class="keyword">true</span>, $this-&gt;k, $this-&gt;pagedim);</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;        }</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;        <span class="keywordflow">if</span> (!isset($this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;ArtBox&#39;</span>])) {</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;            <span class="comment">// the page&#39;s meaningful content (including potential white space)</span></div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;            $this-&gt;pagedim = TCPDF_STATIC::setPageBoxes($this-&gt;page, <span class="stringliteral">&#39;ArtBox&#39;</span>, $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;CropBox&#39;</span>][<span class="stringliteral">&#39;llx&#39;</span>], $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;CropBox&#39;</span>][<span class="stringliteral">&#39;lly&#39;</span>], $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;CropBox&#39;</span>][<span class="stringliteral">&#39;urx&#39;</span>], $this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;CropBox&#39;</span>][<span class="stringliteral">&#39;ury&#39;</span>], <span class="keyword">true</span>, $this-&gt;k, $this-&gt;pagedim);</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;        }</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;        <span class="keywordflow">if</span> (!isset($this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;Rotate&#39;</span>])) {</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;            <span class="comment">// The number of degrees by which the page shall be rotated clockwise when displayed or printed. The value shall be a multiple of 90.</span></div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;            $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;Rotate&#39;</span>] = 0;</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;        }</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;        <span class="keywordflow">if</span> (!isset($this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;PZ&#39;</span>])) {</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;            <span class="comment">// The page&#39;s preferred zoom (magnification) factor</span></div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;            $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;PZ&#39;</span>] = 1;</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;        }</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;fwPt &gt; $this-&gt;fhPt) {</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;            <span class="comment">// landscape</span></div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;            $default_orientation = <span class="charliteral">&#39;L&#39;</span>;</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;            <span class="comment">// portrait</span></div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;            $default_orientation = <span class="charliteral">&#39;P&#39;</span>;</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;        }</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;        $valid_orientations = array(<span class="charliteral">&#39;P&#39;</span>, <span class="charliteral">&#39;L&#39;</span>);</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;        <span class="keywordflow">if</span> (empty($orientation)) {</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;            $orientation = $default_orientation;</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;            $orientation = strtoupper($orientation[0]);</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;        }</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;        <span class="keywordflow">if</span> (in_array($orientation, $valid_orientations) AND ($orientation != $default_orientation)) {</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;            $this-&gt;CurOrientation = $orientation;</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;            $this-&gt;wPt = <a class="code" href="../../d4/d40/classTCPDF.html#a48d90dc02b21b040d95122abf89a2b18">$this-&gt;fhPt</a>;</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;            $this-&gt;hPt = <a class="code" href="../../d4/d40/classTCPDF.html#a2b9dd5ea5f109626189153dadd12f680">$this-&gt;fwPt</a>;</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;            $this-&gt;CurOrientation = $default_orientation;</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;            $this-&gt;wPt = <a class="code" href="../../d4/d40/classTCPDF.html#a2b9dd5ea5f109626189153dadd12f680">$this-&gt;fwPt</a>;</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;            $this-&gt;hPt = <a class="code" href="../../d4/d40/classTCPDF.html#a48d90dc02b21b040d95122abf89a2b18">$this-&gt;fhPt</a>;</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;        }</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;        <span class="keywordflow">if</span> ((abs($this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;MediaBox&#39;</span>][<span class="stringliteral">&#39;urx&#39;</span>] - $this-&gt;hPt) &lt; $this-&gt;feps) AND (abs($this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;MediaBox&#39;</span>][<span class="stringliteral">&#39;ury&#39;</span>] - $this-&gt;wPt) &lt; $this-&gt;feps)){</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;            <span class="comment">// swap X and Y coordinates (change page orientation)</span></div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;            $this-&gt;pagedim = TCPDF_STATIC::swapPageBoxCoordinates($this-&gt;page, $this-&gt;pagedim);</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;        }</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;        $this-&gt;w = ($this-&gt;wPt / <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>);</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;        $this-&gt;h = ($this-&gt;hPt / <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>);</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;        <span class="keywordflow">if</span> (TCPDF_STATIC::empty_string($autopagebreak)) {</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;            <span class="keywordflow">if</span> (isset($this-&gt;AutoPageBreak)) {</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;                $autopagebreak = <a class="code" href="../../d4/d40/classTCPDF.html#ad252eae91d3151b11d1dd15aebe9a4a4">$this-&gt;AutoPageBreak</a>;</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;                $autopagebreak = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;            }</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;        }</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;        <span class="keywordflow">if</span> (TCPDF_STATIC::empty_string($bottommargin)) {</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;            <span class="keywordflow">if</span> (isset($this-&gt;bMargin)) {</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;                $bottommargin = <a class="code" href="../../d4/d40/classTCPDF.html#acfe6c98519acb01dd53aa153c12bf79b">$this-&gt;bMargin</a>;</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;                <span class="comment">// default value = 2 cm</span></div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;                $bottommargin = 2 * 28.35 / <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>;</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;            }</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;        }</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4430365ea0b9015b4aefedad1ba77ea9">SetAutoPageBreak</a>($autopagebreak, $bottommargin);</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;        <span class="comment">// store page dimensions</span></div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;        $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="charliteral">&#39;w&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#ab5675888a7271f898545886b4c3277c3">$this-&gt;wPt</a>;</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;        $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="charliteral">&#39;h&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a7965ee64ad21a3c638933ae96cb23f94">$this-&gt;hPt</a>;</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;        $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;wk&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$this-&gt;w</a>;</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;        $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;hk&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$this-&gt;h</a>;</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;        $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;tm&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#ace8343242b398fd16a4acb1926b6efa7">$this-&gt;tMargin</a>;</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;        $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;bm&#39;</span>] = $bottommargin;</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;        $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;lm&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da">$this-&gt;lMargin</a>;</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;        $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;rm&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a44fb75b85bea40ced25fdea9d89dc8e9">$this-&gt;rMargin</a>;</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;        $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;pb&#39;</span>] = $autopagebreak;</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;        $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;or&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#abdf07c1c5b4fb70b3ed325031d187257">$this-&gt;CurOrientation</a>;</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;        $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;olm&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a90bee4debe4218064059014965f8d52a">$this-&gt;original_lMargin</a>;</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;        $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;orm&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a76d33e30b8292c2483e80bc98566483f">$this-&gt;original_rMargin</a>;</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;    }</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;</div>
<div class="line"><a name="l02329"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a937dcd07bad79ae3900236f87b29194b"> 2329</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a937dcd07bad79ae3900236f87b29194b">setSpacesRE</a>($re=<span class="stringliteral">&#39;/[^\S\xa0]/&#39;</span>) {</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;        $this-&gt;re_spaces = $re;</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;        $re_parts = explode(<span class="charliteral">&#39;/&#39;</span>, $re);</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;        <span class="comment">// get pattern parts</span></div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;        $this-&gt;re_space = array();</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;        <span class="keywordflow">if</span> (isset($re_parts[1]) AND !empty($re_parts[1])) {</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;            $this-&gt;re_space[<span class="charliteral">&#39;p&#39;</span>] = $re_parts[1];</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;            $this-&gt;re_space[<span class="charliteral">&#39;p&#39;</span>] = <span class="stringliteral">&#39;[\s]&#39;</span>;</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;        }</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;        <span class="comment">// set pattern modifiers</span></div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;        <span class="keywordflow">if</span> (isset($re_parts[2]) AND !empty($re_parts[2])) {</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;            $this-&gt;re_space[<span class="charliteral">&#39;m&#39;</span>] = $re_parts[2];</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;            $this-&gt;re_space[<span class="charliteral">&#39;m&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;        }</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;    }</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;</div>
<div class="line"><a name="l02354"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a7d067c080614c7f55b6623adfc80a1c1"> 2354</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a7d067c080614c7f55b6623adfc80a1c1">setRTL</a>($enable, $resetx=<span class="keyword">true</span>) {</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;        $enable = $enable ? <span class="keyword">true</span> : <span class="keyword">false</span>;</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;        $resetx = ($resetx AND ($enable != $this-&gt;rtl));</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;        $this-&gt;rtl = $enable;</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;        $this-&gt;tmprtl = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;        <span class="keywordflow">if</span> ($resetx) {</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a00969cf629d72b3d29ee435f15906820">Ln</a>(0);</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;        }</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;    }</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;</div>
<div class="line"><a name="l02370"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#af01238bb928c4e3de6ed6aaa855fd788"> 2370</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#af01238bb928c4e3de6ed6aaa855fd788">getRTL</a>() {</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#a4ccd9d69e0839838b105328953794a40">$this-&gt;rtl</a>;</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;    }</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;</div>
<div class="line"><a name="l02380"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a6bada8d1ad88d9fa54368619de43b866"> 2380</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a6bada8d1ad88d9fa54368619de43b866">setTempRTL</a>($mode) {</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;        $newmode = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;        <span class="keywordflow">switch</span> (strtoupper($mode)) {</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;LTR&#39;</span>:</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;L&#39;</span>: {</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;                    $newmode = <span class="charliteral">&#39;L&#39;</span>;</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;                }</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;            }</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;RTL&#39;</span>:</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;R&#39;</span>: {</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;                <span class="keywordflow">if</span> (!$this-&gt;rtl) {</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;                    $newmode = <span class="charliteral">&#39;R&#39;</span>;</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;                }</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;            }</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;            <span class="keywordflow">case</span> <span class="keyword">false</span>:</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;            <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;                $newmode = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;            }</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;        }</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;        $this-&gt;tmprtl = $newmode;</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;    }</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;</div>
<div class="line"><a name="l02412"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#accba6f1471acb211de74e6b34107041d"> 2412</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#accba6f1471acb211de74e6b34107041d">isRTLTextDir</a>() {</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;        <span class="keywordflow">return</span> ($this-&gt;rtl OR ($this-&gt;tmprtl == <span class="charliteral">&#39;R&#39;</span>));</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;    }</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;</div>
<div class="line"><a name="l02423"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a188a10529c5479241c1403f2d438e861"> 2423</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a188a10529c5479241c1403f2d438e861">setLastH</a>(<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>) {</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;        $this-&gt;lasth = <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>;</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;    }</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;</div>
<div class="line"><a name="l02433"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a25c7f71b3fcb19024497ea620f885346"> 2433</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a25c7f71b3fcb19024497ea620f885346">getCellHeight</a>($fontsize, $padding=TRUE) {</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;        $height = ($fontsize * <a class="code" href="../../d4/d40/classTCPDF.html#af8cc74fe5806eb009a22791c3a4c7cce">$this-&gt;cell_height_ratio</a>);</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;        <span class="keywordflow">if</span> ($padding) {</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;            $height += ($this-&gt;cell_padding[<span class="charliteral">&#39;T&#39;</span>] + $this-&gt;cell_padding[<span class="charliteral">&#39;B&#39;</span>]);</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;        }</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;        <span class="keywordflow">return</span> round($height, 6);</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;    }</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;</div>
<div class="line"><a name="l02446"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a10215105777b306528a827f3669e936e"> 2446</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a10215105777b306528a827f3669e936e">resetLastH</a>() {</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;        $this-&gt;lasth = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a25c7f71b3fcb19024497ea620f885346">getCellHeight</a>($this-&gt;FontSize);</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;    }</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;</div>
<div class="line"><a name="l02456"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#afe93f88db5be010a17cdf7c5ba4b9b10"> 2456</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#afe93f88db5be010a17cdf7c5ba4b9b10">getLastH</a>() {</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#a41e87b05a84dd56c2c824af49470e295">$this-&gt;lasth</a>;</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;    }</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;</div>
<div class="line"><a name="l02467"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#af4e98dda815a0a7123c6480a951b4e24"> 2467</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#af4e98dda815a0a7123c6480a951b4e24">setImageScale</a>($scale) {</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;        $this-&gt;imgscale = $scale;</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;    }</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;</div>
<div class="line"><a name="l02478"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a3cfc462353c8c404e621556232319d81"> 2478</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a3cfc462353c8c404e621556232319d81">getImageScale</a>() {</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#ae476d39b2a2721941c0c3044a922b633">$this-&gt;imgscale</a>;</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;    }</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;</div>
<div class="line"><a name="l02491"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a62e82c3bdf531f0c898926124696e77e"> 2491</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a62e82c3bdf531f0c898926124696e77e">getPageDimensions</a>($pagenum=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;        <span class="keywordflow">if</span> (empty($pagenum)) {</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;            $pagenum = <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>;</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;        }</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;        <span class="keywordflow">return</span> $this-&gt;pagedim[$pagenum];</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;    }</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;</div>
<div class="line"><a name="l02507"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a510ab21d6a373934bcd3bd4683704b7e"> 2507</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a510ab21d6a373934bcd3bd4683704b7e">getPageWidth</a>($pagenum=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;        <span class="keywordflow">if</span> (empty($pagenum)) {</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$this-&gt;w</a>;</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;        }</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;        <span class="keywordflow">return</span> $this-&gt;pagedim[$pagenum][<span class="charliteral">&#39;w&#39;</span>];</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;    }</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;</div>
<div class="line"><a name="l02523"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a8c7be67402e96a5220556cfa9db8500a"> 2523</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a8c7be67402e96a5220556cfa9db8500a">getPageHeight</a>($pagenum=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;        <span class="keywordflow">if</span> (empty($pagenum)) {</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$this-&gt;h</a>;</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;        }</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;        <span class="keywordflow">return</span> $this-&gt;pagedim[$pagenum][<span class="charliteral">&#39;h&#39;</span>];</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;    }</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;</div>
<div class="line"><a name="l02539"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a8203a3a6bda94f38f973de2825b76ea3"> 2539</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a8203a3a6bda94f38f973de2825b76ea3">getBreakMargin</a>($pagenum=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;        <span class="keywordflow">if</span> (empty($pagenum)) {</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#acfe6c98519acb01dd53aa153c12bf79b">$this-&gt;bMargin</a>;</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;        }</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;        <span class="keywordflow">return</span> $this-&gt;pagedim[$pagenum][<span class="stringliteral">&#39;bm&#39;</span>];</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;    }</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;</div>
<div class="line"><a name="l02553"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aae92c359fcd3d68b063b38de2a92aa51"> 2553</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#aae92c359fcd3d68b063b38de2a92aa51">getScaleFactor</a>() {</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>;</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;    }</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;</div>
<div class="line"><a name="l02567"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ab3bbdb7c85ea08d175fd559be6132ba0"> 2567</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ab3bbdb7c85ea08d175fd559be6132ba0">SetMargins</a>($left, $top, $right=-1, $keepmargins=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;        <span class="comment">//Set left, top and right margins</span></div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;        $this-&gt;lMargin = $left;</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;        $this-&gt;tMargin = $top;</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;        <span class="keywordflow">if</span> ($right == -1) {</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;            $right = $left;</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;        }</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;        $this-&gt;rMargin = $right;</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;        <span class="keywordflow">if</span> ($keepmargins) {</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;            <span class="comment">// overwrite original values</span></div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;            $this-&gt;original_lMargin = <a class="code" href="../../d4/d40/classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da">$this-&gt;lMargin</a>;</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;            $this-&gt;original_rMargin = <a class="code" href="../../d4/d40/classTCPDF.html#a44fb75b85bea40ced25fdea9d89dc8e9">$this-&gt;rMargin</a>;</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;        }</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;    }</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;</div>
<div class="line"><a name="l02589"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a28372fd5aa301e06535d2223025a0b29"> 2589</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a28372fd5aa301e06535d2223025a0b29">SetLeftMargin</a>($margin) {</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;        <span class="comment">//Set left margin</span></div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;        $this-&gt;lMargin = $margin;</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;        <span class="keywordflow">if</span> (($this-&gt;page &gt; 0) AND ($this-&gt;x &lt; $margin)) {</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;            $this-&gt;x = $margin;</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;        }</div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;    }</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;</div>
<div class="line"><a name="l02604"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a10b35d62b1ca2a4c8726aa910ccf7f57"> 2604</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a10b35d62b1ca2a4c8726aa910ccf7f57">SetTopMargin</a>($margin) {</div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;        <span class="comment">//Set top margin</span></div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;        $this-&gt;tMargin = $margin;</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;        <span class="keywordflow">if</span> (($this-&gt;page &gt; 0) AND ($this-&gt;y &lt; $margin)) {</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;            $this-&gt;y = $margin;</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;        }</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;    }</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;</div>
<div class="line"><a name="l02619"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a3cc157ddb157c99b7001bead20c6e7b0"> 2619</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a3cc157ddb157c99b7001bead20c6e7b0">SetRightMargin</a>($margin) {</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;        $this-&gt;rMargin = $margin;</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;        <span class="keywordflow">if</span> (($this-&gt;page &gt; 0) AND ($this-&gt;x &gt; ($this-&gt;w - $margin))) {</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;            $this-&gt;x = $this-&gt;w - $margin;</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;        }</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;    }</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;</div>
<div class="line"><a name="l02633"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a374b24751bf76e4ca5ba7694f87ec2c1"> 2633</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a374b24751bf76e4ca5ba7694f87ec2c1">SetCellPadding</a>($pad) {</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;        <span class="keywordflow">if</span> ($pad &gt;= 0) {</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;            $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>] = $pad;</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;            $this-&gt;cell_padding[<span class="charliteral">&#39;T&#39;</span>] = $pad;</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;            $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>] = $pad;</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;            $this-&gt;cell_padding[<span class="charliteral">&#39;B&#39;</span>] = $pad;</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;        }</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;    }</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;</div>
<div class="line"><a name="l02652"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aba22c5159414bb96cadfa66efd89bc7c"> 2652</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#aba22c5159414bb96cadfa66efd89bc7c">setCellPaddings</a>($left=<span class="stringliteral">&#39;&#39;</span>, $top=<span class="stringliteral">&#39;&#39;</span>, $right=<span class="stringliteral">&#39;&#39;</span>, $bottom=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;        <span class="keywordflow">if</span> (($left !== <span class="stringliteral">&#39;&#39;</span>) AND ($left &gt;= 0)) {</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;            $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>] = $left;</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;        }</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;        <span class="keywordflow">if</span> (($top !== <span class="stringliteral">&#39;&#39;</span>) AND ($top &gt;= 0)) {</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;            $this-&gt;cell_padding[<span class="charliteral">&#39;T&#39;</span>] = $top;</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;        }</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;        <span class="keywordflow">if</span> (($right !== <span class="stringliteral">&#39;&#39;</span>) AND ($right &gt;= 0)) {</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;            $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>] = $right;</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;        }</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;        <span class="keywordflow">if</span> (($bottom !== <span class="stringliteral">&#39;&#39;</span>) AND ($bottom &gt;= 0)) {</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;            $this-&gt;cell_padding[<span class="charliteral">&#39;B&#39;</span>] = $bottom;</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;        }</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;    }</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;</div>
<div class="line"><a name="l02674"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ae34b176081245381bd47ba322a3a522e"> 2674</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ae34b176081245381bd47ba322a3a522e">getCellPaddings</a>() {</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$this-&gt;cell_padding</a>;</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;    }</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;</div>
<div class="line"><a name="l02688"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a80e96cb97ad08e7feb952d2e5e8dc36d"> 2688</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a80e96cb97ad08e7feb952d2e5e8dc36d">setCellMargins</a>($left=<span class="stringliteral">&#39;&#39;</span>, $top=<span class="stringliteral">&#39;&#39;</span>, $right=<span class="stringliteral">&#39;&#39;</span>, $bottom=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;        <span class="keywordflow">if</span> (($left !== <span class="stringliteral">&#39;&#39;</span>) AND ($left &gt;= 0)) {</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;            $this-&gt;cell_margin[<span class="charliteral">&#39;L&#39;</span>] = $left;</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;        }</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;        <span class="keywordflow">if</span> (($top !== <span class="stringliteral">&#39;&#39;</span>) AND ($top &gt;= 0)) {</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;            $this-&gt;cell_margin[<span class="charliteral">&#39;T&#39;</span>] = $top;</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;        }</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;        <span class="keywordflow">if</span> (($right !== <span class="stringliteral">&#39;&#39;</span>) AND ($right &gt;= 0)) {</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;            $this-&gt;cell_margin[<span class="charliteral">&#39;R&#39;</span>] = $right;</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;        }</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;        <span class="keywordflow">if</span> (($bottom !== <span class="stringliteral">&#39;&#39;</span>) AND ($bottom &gt;= 0)) {</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;            $this-&gt;cell_margin[<span class="charliteral">&#39;B&#39;</span>] = $bottom;</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;        }</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;    }</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;</div>
<div class="line"><a name="l02710"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aebb91d5d8046cf1b91b65d3a2d8694be"> 2710</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#aebb91d5d8046cf1b91b65d3a2d8694be">getCellMargins</a>() {</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#a6decef4569cfd79d75e47cab1315fa77">$this-&gt;cell_margin</a>;</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;    }</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;</div>
<div class="line"><a name="l02721"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a574cf231b14aa43921ac83716b27b3e4"> 2721</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a574cf231b14aa43921ac83716b27b3e4">adjustCellPadding</a>($brd=0) {</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;        <span class="keywordflow">if</span> (empty($brd)) {</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;        }</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;        <span class="keywordflow">if</span> (is_string($brd)) {</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;            <span class="comment">// convert string to array</span></div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;            $slen = strlen($brd);</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;            $newbrd = array();</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;            <span class="keywordflow">for</span> ($i = 0; $i &lt; $slen; ++$i) {</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;                $newbrd[$brd[$i]] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;            }</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;            $brd = $newbrd;</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;        } elseif (($brd === 1) OR ($brd === <span class="keyword">true</span>) OR (is_numeric($brd) AND (intval($brd) &gt; 0))) {</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;            $brd = array(<span class="stringliteral">&#39;LRTB&#39;</span> =&gt; <span class="keyword">true</span>);</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;        }</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;        <span class="keywordflow">if</span> (!is_array($brd)) {</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;        }</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;        <span class="comment">// store current cell padding</span></div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;        $cp = <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$this-&gt;cell_padding</a>;</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;        <span class="comment">// select border mode</span></div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;        <span class="keywordflow">if</span> (isset($brd[<span class="stringliteral">&#39;mode&#39;</span>])) {</div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;            $mode = $brd[<span class="stringliteral">&#39;mode&#39;</span>];</div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;            unset($brd[<span class="stringliteral">&#39;mode&#39;</span>]);</div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;            $mode = <span class="stringliteral">&#39;normal&#39;</span>;</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;        }</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;        <span class="comment">// process borders</span></div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;        <span class="keywordflow">foreach</span> ($brd as $border =&gt; $style) {</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;            $line_width = <a class="code" href="../../d4/d40/classTCPDF.html#a5971d565157974939d3edf96baeb0eeb">$this-&gt;LineWidth</a>;</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;            <span class="keywordflow">if</span> (is_array($style) AND isset($style[<span class="stringliteral">&#39;width&#39;</span>])) {</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;                <span class="comment">// get border width</span></div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;                $line_width = $style[<span class="stringliteral">&#39;width&#39;</span>];</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;            }</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;            $adj = 0; <span class="comment">// line width inside the cell</span></div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;            <span class="keywordflow">switch</span> ($mode) {</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;                <span class="keywordflow">case</span> <span class="stringliteral">&#39;ext&#39;</span>: {</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;                    $adj = 0;</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;                }</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;                <span class="keywordflow">case</span> <span class="stringliteral">&#39;int&#39;</span>: {</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;                    $adj = $line_width;</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;                }</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;                <span class="keywordflow">case</span> <span class="stringliteral">&#39;normal&#39;</span>:</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;                <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;                    $adj = ($line_width / 2);</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;                }</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;            }</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;            <span class="comment">// correct internal cell padding if required to avoid overlap between text and lines</span></div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;            <span class="keywordflow">if</span> ((strpos($border,<span class="charliteral">&#39;T&#39;</span>) !== <span class="keyword">false</span>) AND ($this-&gt;cell_padding[<span class="charliteral">&#39;T&#39;</span>] &lt; $adj)) {</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;                $this-&gt;cell_padding[<span class="charliteral">&#39;T&#39;</span>] = $adj;</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;            }</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;            <span class="keywordflow">if</span> ((strpos($border,<span class="charliteral">&#39;R&#39;</span>) !== <span class="keyword">false</span>) AND ($this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>] &lt; $adj)) {</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;                $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>] = $adj;</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;            }</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;            <span class="keywordflow">if</span> ((strpos($border,<span class="charliteral">&#39;B&#39;</span>) !== <span class="keyword">false</span>) AND ($this-&gt;cell_padding[<span class="charliteral">&#39;B&#39;</span>] &lt; $adj)) {</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;                $this-&gt;cell_padding[<span class="charliteral">&#39;B&#39;</span>] = $adj;</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;            }</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;            <span class="keywordflow">if</span> ((strpos($border,<span class="charliteral">&#39;L&#39;</span>) !== <span class="keyword">false</span>) AND ($this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>] &lt; $adj)) {</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;                $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>] = $adj;</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;            }</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;        }</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;        <span class="keywordflow">return</span> array(<span class="charliteral">&#39;T&#39;</span> =&gt; ($this-&gt;cell_padding[<span class="charliteral">&#39;T&#39;</span>] - $cp[<span class="charliteral">&#39;T&#39;</span>]), <span class="charliteral">&#39;R&#39;</span> =&gt; ($this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>] - $cp[<span class="charliteral">&#39;R&#39;</span>]), <span class="charliteral">&#39;B&#39;</span> =&gt; ($this-&gt;cell_padding[<span class="charliteral">&#39;B&#39;</span>] - $cp[<span class="charliteral">&#39;B&#39;</span>]), <span class="charliteral">&#39;L&#39;</span> =&gt; ($this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>] - $cp[<span class="charliteral">&#39;L&#39;</span>]));</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;    }</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;</div>
<div class="line"><a name="l02796"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a4430365ea0b9015b4aefedad1ba77ea9"> 2796</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a4430365ea0b9015b4aefedad1ba77ea9">SetAutoPageBreak</a>($auto, $margin=0) {</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;        $this-&gt;AutoPageBreak = $auto ? <span class="keyword">true</span> : <span class="keyword">false</span>;</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;        $this-&gt;bMargin = $margin;</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;        $this-&gt;PageBreakTrigger = $this-&gt;h - $margin;</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;    }</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;</div>
<div class="line"><a name="l02808"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a73f32971feef0aa29e061bac60a90e7a"> 2808</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a73f32971feef0aa29e061bac60a90e7a">getAutoPageBreak</a>() {</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#ad252eae91d3151b11d1dd15aebe9a4a4">$this-&gt;AutoPageBreak</a>;</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;    }</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;</div>
<div class="line"><a name="l02820"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ad99d9dea88f659fedf9fe11f30586a99"> 2820</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ad99d9dea88f659fedf9fe11f30586a99">SetDisplayMode</a>($zoom, $layout=<span class="stringliteral">&#39;SinglePage&#39;</span>, $mode=<span class="stringliteral">&#39;UseNone&#39;</span>) {</div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;        <span class="keywordflow">if</span> (($zoom == <span class="stringliteral">&#39;fullpage&#39;</span>) OR ($zoom == <span class="stringliteral">&#39;fullwidth&#39;</span>) OR ($zoom == <span class="stringliteral">&#39;real&#39;</span>) OR ($zoom == <span class="stringliteral">&#39;default&#39;</span>) OR (!is_string($zoom))) {</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;            $this-&gt;ZoomMode = $zoom;</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;Incorrect zoom display mode: &#39;</span>.$zoom);</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;        }</div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;        $this-&gt;LayoutMode = TCPDF_STATIC::getPageLayoutMode($layout);</div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;        $this-&gt;PageMode = TCPDF_STATIC::getPageMode($mode);</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;    }</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;</div>
<div class="line"><a name="l02837"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a6140a1ff2c5ed3f490592b6917f5adf3"> 2837</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a6140a1ff2c5ed3f490592b6917f5adf3">SetCompression</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a9e5fbe1cabbea954c6b5d4f9837bc3b0">$compress</a>=<span class="keyword">true</span>) {</div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;        <span class="keywordflow">if</span> (function_exists(<span class="stringliteral">&#39;gzcompress&#39;</span>)) {</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;            $this-&gt;compress = <a class="code" href="../../d4/d40/classTCPDF.html#a9e5fbe1cabbea954c6b5d4f9837bc3b0">$compress</a> ? <span class="keyword">true</span> : <span class="keyword">false</span>;</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;            $this-&gt;compress = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;        }</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;    }</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;</div>
<div class="line"><a name="l02851"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a304b018598f42b236e0720a97a192e04"> 2851</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a304b018598f42b236e0720a97a192e04">setSRGBmode</a>($mode=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;        $this-&gt;force_srgb = $mode ? <span class="keyword">true</span> : <span class="keyword">false</span>;</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;    }</div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;</div>
<div class="line"><a name="l02862"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aa63bed5d5f585edcbfedceecea15a1db"> 2862</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#aa63bed5d5f585edcbfedceecea15a1db">SetDocInfoUnicode</a>($unicode=<span class="keyword">true</span>) {</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;        $this-&gt;docinfounicode = $unicode ? <span class="keyword">true</span> : <span class="keyword">false</span>;</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;    }</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;</div>
<div class="line"><a name="l02873"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ac467f297fed79882bcab2bf20d423efb"> 2873</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ac467f297fed79882bcab2bf20d423efb">SetTitle</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a63acf0babc0299784cbb54354329a734">$title</a>) {</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;        $this-&gt;title = <a class="code" href="../../d4/d40/classTCPDF.html#a63acf0babc0299784cbb54354329a734">$title</a>;</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;    }</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;</div>
<div class="line"><a name="l02884"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aca6e7dacb9814682736ba2c7129be338"> 2884</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#aca6e7dacb9814682736ba2c7129be338">SetSubject</a>(<a class="code" href="../../d4/d40/classTCPDF.html#abb4e21366924e76df3400312434d95e1">$subject</a>) {</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;        $this-&gt;subject = <a class="code" href="../../d4/d40/classTCPDF.html#abb4e21366924e76df3400312434d95e1">$subject</a>;</div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;    }</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;</div>
<div class="line"><a name="l02895"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a983e0a8da2a4d76c24efb0a91281712a"> 2895</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a983e0a8da2a4d76c24efb0a91281712a">SetAuthor</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a25c26ce9fab4b1d38773ab3629d985aa">$author</a>) {</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;        $this-&gt;author = <a class="code" href="../../d4/d40/classTCPDF.html#a25c26ce9fab4b1d38773ab3629d985aa">$author</a>;</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;    }</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;</div>
<div class="line"><a name="l02906"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#afbe8a897cf05ec784297f9b660c698b7"> 2906</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#afbe8a897cf05ec784297f9b660c698b7">SetKeywords</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a752bede1485e51bff5ad315ca83c804d">$keywords</a>) {</div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;        $this-&gt;keywords = <a class="code" href="../../d4/d40/classTCPDF.html#a752bede1485e51bff5ad315ca83c804d">$keywords</a>;</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;    }</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;</div>
<div class="line"><a name="l02917"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a1df083d5359c42f8b124771f1f92d9fa"> 2917</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a1df083d5359c42f8b124771f1f92d9fa">SetCreator</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a79a8b6ca37c76f3d5ebfb26be77613db">$creator</a>) {</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;        $this-&gt;creator = <a class="code" href="../../d4/d40/classTCPDF.html#a79a8b6ca37c76f3d5ebfb26be77613db">$creator</a>;</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;    }</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;</div>
<div class="line"><a name="l02927"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91"> 2927</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>($msg) {</div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;        <span class="comment">// unset all class variables</span></div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ae91c72441bff1164a3ab9d237a4e1faa">_destroy</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;        <span class="keywordflow">if</span> (defined(<span class="stringliteral">&#39;K_TCPDF_THROW_EXCEPTION_ERROR&#39;</span>) AND !<a class="code" href="../../d5/dc0/tcpdf__config_8php.html#a08375f80cec3cc396da966460d2fdb64">K_TCPDF_THROW_EXCEPTION_ERROR</a>) {</div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;            die(<span class="stringliteral">&#39;&lt;strong&gt;TCPDF ERROR: &lt;/strong&gt;&#39;</span>.$msg);</div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;            <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&#39;TCPDF ERROR: &#39;</span>.$msg);</div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;        }</div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;    }</div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;</div>
<div class="line"><a name="l02945"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a58f93b800daf9a608c3c1ad90a69e46e"> 2945</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a58f93b800daf9a608c3c1ad90a69e46e">Open</a>() {</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;        $this-&gt;state = 1;</div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;    }</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;</div>
<div class="line"><a name="l02957"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a2ea842192062587293c25981098c820c"> 2957</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a2ea842192062587293c25981098c820c">Close</a>() {</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;state == 3) {</div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;        }</div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;page == 0) {</div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a5171e20b366b74523709d84c349c1ced">AddPage</a>();</div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;        }</div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a996258e3c16a3bb8de1f5c1ff8b8c9d8">endLayer</a>();</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;tcpdflink) {</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;            <span class="comment">// save current graphic settings</span></div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;            $gvars = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a24d3c102468b6ab9d2f4859a8b01863a">getGraphicVars</a>();</div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aeb84582f37f9d68c1a9f5723849d0009">setEqualColumns</a>();</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;            $this-&gt;lastpage(<span class="keyword">true</span>);</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4430365ea0b9015b4aefedad1ba77ea9">SetAutoPageBreak</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;            $this-&gt;x = 0;</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;            $this-&gt;y = $this-&gt;h - (1 / <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>);</div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;            $this-&gt;lMargin = 0;</div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa316f47dbdd13a6dd2897d6be347cbbb">_outSaveGraphicsState</a>();</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;            $font = defined(<span class="stringliteral">&#39;PDF_FONT_NAME_MAIN&#39;</span>)?<a class="code" href="../../d5/dc0/tcpdf__config_8php.html#a24c5be6597b6e1ffd1a8011e2917ddf7">PDF_FONT_NAME_MAIN</a>:<span class="stringliteral">&#39;helvetica&#39;</span>;</div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#afd56e360c43553830d543323e81bc045">SetFont</a>($font, <span class="stringliteral">&#39;&#39;</span>, 1);</div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa194abd22d0ba5e5f2c52c5e05f4e107">setTextRenderingMode</a>(0, <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;            $msg = <span class="stringliteral">&quot;\x50\x6f\x77\x65\x72\x65\x64\x20\x62\x79\x20\x54\x43\x50\x44\x46\x20\x28\x77\x77\x77\x2e\x74\x63\x70\x64\x66\x2e\x6f\x72\x67\x29&quot;</span>;</div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;            $lnk = <span class="stringliteral">&quot;\x68\x74\x74\x70\x3a\x2f\x2f\x77\x77\x77\x2e\x74\x63\x70\x64\x66\x2e\x6f\x72\x67&quot;</span>;</div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a33b265e5eb3e4d1d4fedfe29f8166f31">Cell</a>(0, 0, $msg, 0, 0, <span class="charliteral">&#39;L&#39;</span>, 0, $lnk, 0, <span class="keyword">false</span>, <span class="charliteral">&#39;D&#39;</span>, <span class="charliteral">&#39;B&#39;</span>);</div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af623eface3ce63b2bc1709d47c84ab69">_outRestoreGraphicsState</a>();</div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;            <span class="comment">// restore graphic settings</span></div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a072053646725b19770a795050b3b6221">setGraphicVars</a>($gvars);</div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;        }</div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;        <span class="comment">// close page</span></div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a79a37b42b7c47e3ec1f5f150129d3b3c">endPage</a>();</div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;        <span class="comment">// close document</span></div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a55c3dfafc6dd5b278d0bc7298e829d77">_enddoc</a>();</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;        <span class="comment">// unset all class variables (except critical ones)</span></div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ae91c72441bff1164a3ab9d237a4e1faa">_destroy</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;    }</div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;</div>
<div class="line"><a name="l03001"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a99075a970e4fec86e1b31e8ecc923e00"> 3001</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a99075a970e4fec86e1b31e8ecc923e00">setPage</a>($pnum, $resetmargins=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;        <span class="keywordflow">if</span> (($pnum == $this-&gt;page) AND ($this-&gt;state == 2)) {</div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;        }</div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;        <span class="keywordflow">if</span> (($pnum &gt; 0) AND ($pnum &lt;= $this-&gt;numpages)) {</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;            $this-&gt;state = 2;</div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;            <span class="comment">// save current graphic settings</span></div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;            <span class="comment">//$gvars = $this-&gt;getGraphicVars();</span></div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;            $oldpage = <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>;</div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;            $this-&gt;page = $pnum;</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;            $this-&gt;wPt = $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="charliteral">&#39;w&#39;</span>];</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;            $this-&gt;hPt = $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="charliteral">&#39;h&#39;</span>];</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;            $this-&gt;w = $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;wk&#39;</span>];</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;            $this-&gt;h = $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;hk&#39;</span>];</div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;            $this-&gt;tMargin = $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;tm&#39;</span>];</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;            $this-&gt;bMargin = $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;bm&#39;</span>];</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;            $this-&gt;original_lMargin = $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;olm&#39;</span>];</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;            $this-&gt;original_rMargin = $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;orm&#39;</span>];</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;            $this-&gt;AutoPageBreak = $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;pb&#39;</span>];</div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;            $this-&gt;CurOrientation = $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;or&#39;</span>];</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4430365ea0b9015b4aefedad1ba77ea9">SetAutoPageBreak</a>($this-&gt;AutoPageBreak, $this-&gt;bMargin);</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;            <span class="comment">// restore graphic settings</span></div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;            <span class="comment">//$this-&gt;setGraphicVars($gvars);</span></div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;            <span class="keywordflow">if</span> ($resetmargins) {</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;                $this-&gt;lMargin = $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;olm&#39;</span>];</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;                $this-&gt;rMargin = $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;orm&#39;</span>];</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ad3439990de56253b039bca6a09305758">SetY</a>($this-&gt;tMargin);</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;                <span class="comment">// account for booklet mode</span></div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;olm&#39;</span>] != $this-&gt;pagedim[$oldpage][<span class="stringliteral">&#39;olm&#39;</span>]) {</div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;                    $deltam = $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;olm&#39;</span>] - $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;orm&#39;</span>];</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;                    $this-&gt;lMargin += $deltam;</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;                    $this-&gt;rMargin -= $deltam;</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;                }</div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;            }</div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;Wrong page number on setPage() function: &#39;</span>.$pnum);</div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;        }</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;    }</div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;</div>
<div class="line"><a name="l03048"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a0c5df96854236ada4bd14962d9ddbbb5"> 3048</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a0c5df96854236ada4bd14962d9ddbbb5">lastPage</a>($resetmargins=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a99075a970e4fec86e1b31e8ecc923e00">setPage</a>($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a9612d9b2bafafa217fc425a6dae4e5ac">getNumPages</a>(), $resetmargins);</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;    }</div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;</div>
<div class="line"><a name="l03059"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aa6e5b824889f7c484cc76ce1c134e2ed"> 3059</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#aa6e5b824889f7c484cc76ce1c134e2ed">getPage</a>() {</div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>;</div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;    }</div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;</div>
<div class="line"><a name="l03070"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a9612d9b2bafafa217fc425a6dae4e5ac"> 3070</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a9612d9b2bafafa217fc425a6dae4e5ac">getNumPages</a>() {</div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#ae5dd5203ba48e26efcb24a6a6cabbb42">$this-&gt;numpages</a>;</div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;    }</div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;</div>
<div class="line"><a name="l03083"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ad5303676c4d5a355672dd599eb263a50"> 3083</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ad5303676c4d5a355672dd599eb263a50">addTOCPage</a>($orientation=<span class="stringliteral">&#39;&#39;</span>, $format=<span class="stringliteral">&#39;&#39;</span>, $keepmargins=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a5171e20b366b74523709d84c349c1ced">AddPage</a>($orientation, $format, $keepmargins, <span class="keyword">true</span>);</div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;    }</div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;</div>
<div class="line"><a name="l03093"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a02a272341e600d3c69836d1a564d29e0"> 3093</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a02a272341e600d3c69836d1a564d29e0">endTOCPage</a>() {</div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a79a37b42b7c47e3ec1f5f150129d3b3c">endPage</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;    }</div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;</div>
<div class="line"><a name="l03108"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a5171e20b366b74523709d84c349c1ced"> 3108</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a5171e20b366b74523709d84c349c1ced">AddPage</a>($orientation=<span class="stringliteral">&#39;&#39;</span>, $format=<span class="stringliteral">&#39;&#39;</span>, $keepmargins=<span class="keyword">false</span>, <a class="code" href="../../d4/d40/classTCPDF.html#aa2a1cf622454f1a9931b2f79fab0f98f">$tocpage</a>=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;inxobj) {</div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;            <span class="comment">// we are inside an XObject template</span></div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;        }</div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;        <span class="keywordflow">if</span> (!isset($this-&gt;original_lMargin) OR $keepmargins) {</div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;            $this-&gt;original_lMargin = <a class="code" href="../../d4/d40/classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da">$this-&gt;lMargin</a>;</div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;        }</div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;        <span class="keywordflow">if</span> (!isset($this-&gt;original_rMargin) OR $keepmargins) {</div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;            $this-&gt;original_rMargin = <a class="code" href="../../d4/d40/classTCPDF.html#a44fb75b85bea40ced25fdea9d89dc8e9">$this-&gt;rMargin</a>;</div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;        }</div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;        <span class="comment">// terminate previous page</span></div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a79a37b42b7c47e3ec1f5f150129d3b3c">endPage</a>();</div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;        <span class="comment">// start new page</span></div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a02c319c0adc5a464351d428ae4602aae">startPage</a>($orientation, $format, <a class="code" href="../../d4/d40/classTCPDF.html#aa2a1cf622454f1a9931b2f79fab0f98f">$tocpage</a>);</div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;    }</div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;</div>
<div class="line"><a name="l03132"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a79a37b42b7c47e3ec1f5f150129d3b3c"> 3132</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a79a37b42b7c47e3ec1f5f150129d3b3c">endPage</a>(<a class="code" href="../../d4/d40/classTCPDF.html#aa2a1cf622454f1a9931b2f79fab0f98f">$tocpage</a>=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;        <span class="comment">// check if page is already closed</span></div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;        <span class="keywordflow">if</span> (($this-&gt;page == 0) OR ($this-&gt;numpages &gt; $this-&gt;page) OR (!$this-&gt;pageopen[$this-&gt;page])) {</div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;        }</div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;        <span class="comment">// print page footer</span></div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a7b0675e51b6f7ab3e4730feef3c86fb5">setFooter</a>();</div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;        <span class="comment">// close page</span></div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af037a681d72f4eeaecd641680257a16f">_endpage</a>();</div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;        <span class="comment">// mark page as closed</span></div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;        $this-&gt;pageopen[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#aa2a1cf622454f1a9931b2f79fab0f98f">$tocpage</a>) {</div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;            $this-&gt;tocpage = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;        }</div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;    }</div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;</div>
<div class="line"><a name="l03158"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a02c319c0adc5a464351d428ae4602aae"> 3158</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a02c319c0adc5a464351d428ae4602aae">startPage</a>($orientation=<span class="stringliteral">&#39;&#39;</span>, $format=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="../../d4/d40/classTCPDF.html#aa2a1cf622454f1a9931b2f79fab0f98f">$tocpage</a>=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#aa2a1cf622454f1a9931b2f79fab0f98f">$tocpage</a>) {</div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;            $this-&gt;tocpage = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;        }</div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;        <span class="comment">// move page numbers of documents to be attached</span></div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;tocpage) {</div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;            <span class="comment">// move reference to unexistent pages (used for page attachments)</span></div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;            <span class="comment">// adjust outlines</span></div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;            $tmpoutlines = <a class="code" href="../../d4/d40/classTCPDF.html#afde44c5da51ba62be8c27491975c528f">$this-&gt;outlines</a>;</div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;            <span class="keywordflow">foreach</span> ($tmpoutlines as $key =&gt; $outline) {</div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;                <span class="keywordflow">if</span> (!$outline[<span class="charliteral">&#39;f&#39;</span>] AND ($outline[<span class="charliteral">&#39;p&#39;</span>] &gt; $this-&gt;numpages)) {</div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;                    $this-&gt;outlines[$key][<span class="charliteral">&#39;p&#39;</span>] = ($outline[<span class="charliteral">&#39;p&#39;</span>] + 1);</div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;                }</div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;            }</div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;            <span class="comment">// adjust dests</span></div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;            $tmpdests = <a class="code" href="../../d4/d40/classTCPDF.html#a75ae8e6fcf6f618c962e18dc11987753">$this-&gt;dests</a>;</div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;            <span class="keywordflow">foreach</span> ($tmpdests as $key =&gt; $dest) {</div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;                <span class="keywordflow">if</span> (!$dest[<span class="charliteral">&#39;f&#39;</span>] AND ($dest[<span class="charliteral">&#39;p&#39;</span>] &gt; $this-&gt;numpages)) {</div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;                    $this-&gt;dests[$key][<span class="charliteral">&#39;p&#39;</span>] = ($dest[<span class="charliteral">&#39;p&#39;</span>] + 1);</div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;                }</div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;            }</div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;            <span class="comment">// adjust links</span></div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;            $tmplinks = <a class="code" href="../../d4/d40/classTCPDF.html#ab050e61a9d3a6d628990a26c9032ec0e">$this-&gt;links</a>;</div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;            <span class="keywordflow">foreach</span> ($tmplinks as $key =&gt; $link) {</div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;                <span class="keywordflow">if</span> (!$link[<span class="charliteral">&#39;f&#39;</span>] AND ($link[<span class="charliteral">&#39;p&#39;</span>] &gt; $this-&gt;numpages)) {</div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;                    $this-&gt;links[$key][<span class="charliteral">&#39;p&#39;</span>] = ($link[<span class="charliteral">&#39;p&#39;</span>] + 1);</div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;                }</div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;            }</div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;        }</div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;numpages &gt; $this-&gt;page) {</div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;            <span class="comment">// this page has been already added</span></div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a99075a970e4fec86e1b31e8ecc923e00">setPage</a>($this-&gt;page + 1);</div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ad3439990de56253b039bca6a09305758">SetY</a>($this-&gt;tMargin);</div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;        }</div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;        <span class="comment">// start a new page</span></div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;state == 0) {</div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a58f93b800daf9a608c3c1ad90a69e46e">Open</a>();</div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;        }</div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;        ++<a class="code" href="../../d4/d40/classTCPDF.html#ae5dd5203ba48e26efcb24a6a6cabbb42">$this-&gt;numpages</a>;</div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aae16fb109eb4f3aaa9ba860cfb1cf1f2">swapMargins</a>($this-&gt;booklet);</div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;        <span class="comment">// save current graphic settings</span></div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;        $gvars = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a24d3c102468b6ab9d2f4859a8b01863a">getGraphicVars</a>();</div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;        <span class="comment">// start new page</span></div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aeba2b911ed732e58cb99c0b9b29ed05f">_beginpage</a>($orientation, $format);</div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;        <span class="comment">// mark page as open</span></div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;        $this-&gt;pageopen[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;        <span class="comment">// restore graphic settings</span></div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a072053646725b19770a795050b3b6221">setGraphicVars</a>($gvars);</div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;        <span class="comment">// mark this point</span></div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a15d65cdde4d6d9df6d1c7fdb985c0e22">setPageMark</a>();</div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;        <span class="comment">// print page header</span></div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a9e36d6b325764815dd652636ece7eead">setHeader</a>();</div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;        <span class="comment">// restore graphic settings</span></div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a072053646725b19770a795050b3b6221">setGraphicVars</a>($gvars);</div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;        <span class="comment">// mark this point</span></div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a15d65cdde4d6d9df6d1c7fdb985c0e22">setPageMark</a>();</div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;        <span class="comment">// print table header (if any)</span></div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a52a8502589754eefe8da17efdd40329b">setTableHeader</a>();</div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;        <span class="comment">// set mark for empty page check</span></div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;        $this-&gt;emptypagemrk[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>]= $this-&gt;pagelen[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>];</div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;    }</div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;</div>
<div class="line"><a name="l03229"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a15d65cdde4d6d9df6d1c7fdb985c0e22"> 3229</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a15d65cdde4d6d9df6d1c7fdb985c0e22">setPageMark</a>() {</div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;        $this-&gt;intmrk[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>] = $this-&gt;pagelen[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>];</div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;        $this-&gt;bordermrk[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>] = $this-&gt;intmrk[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>];</div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a278cba1881265c0b47036a629a67863f">setContentMark</a>();</div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;    }</div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;</div>
<div class="line"><a name="l03242"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a278cba1881265c0b47036a629a67863f"> 3242</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a278cba1881265c0b47036a629a67863f">setContentMark</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>=0) {</div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a> &lt;= 0) {</div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a> = <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>;</div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;        }</div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;footerlen[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>])) {</div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;            $this-&gt;cntmrk[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>] = $this-&gt;pagelen[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>] - $this-&gt;footerlen[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>];</div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;            $this-&gt;cntmrk[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>] = $this-&gt;pagelen[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>];</div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;        }</div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;    }</div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;</div>
<div class="line"><a name="l03263"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a83795ec8999b91ef291c34d63209c8f2"> 3263</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a83795ec8999b91ef291c34d63209c8f2">setHeaderData</a>($ln=<span class="stringliteral">&#39;&#39;</span>, $lw=0, $ht=<span class="stringliteral">&#39;&#39;</span>, $hs=<span class="stringliteral">&#39;&#39;</span>, $tc=array(0,0,0), $lc=array(0,0,0)) {</div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;        $this-&gt;header_logo = $ln;</div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;        $this-&gt;header_logo_width = $lw;</div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;        $this-&gt;header_title = $ht;</div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;        $this-&gt;header_string = $hs;</div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;        $this-&gt;header_text_color = $tc;</div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;        $this-&gt;header_line_color = $lc;</div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;    }</div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;</div>
<div class="line"><a name="l03278"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a1185953f1c5222a3d048f4cde6500300"> 3278</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a1185953f1c5222a3d048f4cde6500300">setFooterData</a>($tc=array(0,0,0), $lc=array(0,0,0)) {</div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;        $this-&gt;footer_text_color = $tc;</div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;        $this-&gt;footer_line_color = $lc;</div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;    }</div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;</div>
<div class="line"><a name="l03290"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a70437676b6ee2c9ff985b38d5789fb90"> 3290</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a70437676b6ee2c9ff985b38d5789fb90">getHeaderData</a>() {</div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;        $ret = array();</div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;        $ret[<span class="stringliteral">&#39;logo&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#abde8cefba6202d748b708b515bfce9ce">$this-&gt;header_logo</a>;</div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;        $ret[<span class="stringliteral">&#39;logo_width&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a5c3ee3344be02f70dcd5b3db312b28f0">$this-&gt;header_logo_width</a>;</div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;        $ret[<span class="stringliteral">&#39;title&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a7a9badafb7fca4cb3d6fe7c5e771d79e">$this-&gt;header_title</a>;</div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;        $ret[<span class="stringliteral">&#39;string&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a47928b951e68ff27c1b4f39523aaeef7">$this-&gt;header_string</a>;</div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;        $ret[<span class="stringliteral">&#39;text_color&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a712ce18cedd4b397a0375d9972f6aea8">$this-&gt;header_text_color</a>;</div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;        $ret[<span class="stringliteral">&#39;line_color&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a8038a0a2a6d0b98e1b86307a6f9ded1f">$this-&gt;header_line_color</a>;</div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;        <span class="keywordflow">return</span> $ret;</div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;    }</div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;</div>
<div class="line"><a name="l03307"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#adf1682524d9c24f3b8c8f4aabf4bd034"> 3307</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#adf1682524d9c24f3b8c8f4aabf4bd034">setHeaderMargin</a>($hm=10) {</div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;        $this-&gt;header_margin = $hm;</div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;    }</div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;</div>
<div class="line"><a name="l03317"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#af2bfd0376f18244ad8c7aa3a85399c58"> 3317</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#af2bfd0376f18244ad8c7aa3a85399c58">getHeaderMargin</a>() {</div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#afdcd761ffeab6ede2a7ed79cb2b5d33d">$this-&gt;header_margin</a>;</div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;    }</div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;</div>
<div class="line"><a name="l03327"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a83d9c1f132f0147413259259b4a2ca7d"> 3327</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a83d9c1f132f0147413259259b4a2ca7d">setFooterMargin</a>($fm=10) {</div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;        $this-&gt;footer_margin = $fm;</div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;    }</div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;</div>
<div class="line"><a name="l03337"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a7f1fa220561198a793cdd56a3390438d"> 3337</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a7f1fa220561198a793cdd56a3390438d">getFooterMargin</a>() {</div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#ad5cecadb5d4b25324516668aaf23c3ca">$this-&gt;footer_margin</a>;</div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;    }</div>
<div class="line"><a name="l03345"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a9240c96d0ce715acb3ebe8e8362202f7"> 3345</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a9240c96d0ce715acb3ebe8e8362202f7">setPrintHeader</a>($val=<span class="keyword">true</span>) {</div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;        $this-&gt;print_header = $val ? <span class="keyword">true</span> : <span class="keyword">false</span>;</div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;    }</div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;</div>
<div class="line"><a name="l03354"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a8dc91462430bd190502e04aec229153f"> 3354</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a8dc91462430bd190502e04aec229153f">setPrintFooter</a>($val=<span class="keyword">true</span>) {</div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;        $this-&gt;print_footer = $val ? <span class="keyword">true</span> : <span class="keyword">false</span>;</div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;    }</div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;</div>
<div class="line"><a name="l03363"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a67b4394647eef529a62e103d20324a76"> 3363</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a67b4394647eef529a62e103d20324a76">getImageRBX</a>() {</div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#ace8e68000d6185a28a180bbe4531b428">$this-&gt;img_rb_x</a>;</div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;    }</div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;</div>
<div class="line"><a name="l03372"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a0368d51e3742f13e5972b2e2f7d6fd28"> 3372</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a0368d51e3742f13e5972b2e2f7d6fd28">getImageRBY</a>() {</div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#abc05496cf88772b492f67e87c53121d0">$this-&gt;img_rb_y</a>;</div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;    }</div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;</div>
<div class="line"><a name="l03380"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a615b71100b4526459d22e385fffe1660"> 3380</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a615b71100b4526459d22e385fffe1660">resetHeaderTemplate</a>() {</div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;        $this-&gt;header_xobjid = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;    }</div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;</div>
<div class="line"><a name="l03389"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a94ed72c3dc79bd9436fd02ad6de955a1"> 3389</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a94ed72c3dc79bd9436fd02ad6de955a1">setHeaderTemplateAutoreset</a>($val=<span class="keyword">true</span>) {</div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;        $this-&gt;header_xobj_autoreset = $val ? <span class="keyword">true</span> : <span class="keyword">false</span>;</div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;    }</div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;</div>
<div class="line"><a name="l03398"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a553f8a9bbb5301f983ebfd64544cb7a8"> 3398</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a553f8a9bbb5301f983ebfd64544cb7a8">Header</a>() {</div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;header_xobjid === <span class="keyword">false</span>) {</div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;            <span class="comment">// start a new XObject Template</span></div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;            $this-&gt;header_xobjid = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a7eae5df3511dac591b5b76ab5d8b9a68">startTemplate</a>($this-&gt;w, $this-&gt;tMargin);</div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;            $headerfont = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a2490e635d8ff11d41b6578bab46acba5">getHeaderFont</a>();</div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;            $headerdata = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a70437676b6ee2c9ff985b38d5789fb90">getHeaderData</a>();</div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;            $this-&gt;y = <a class="code" href="../../d4/d40/classTCPDF.html#afdcd761ffeab6ede2a7ed79cb2b5d33d">$this-&gt;header_margin</a>;</div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;                $this-&gt;x = $this-&gt;w - <a class="code" href="../../d4/d40/classTCPDF.html#a76d33e30b8292c2483e80bc98566483f">$this-&gt;original_rMargin</a>;</div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;                $this-&gt;x = <a class="code" href="../../d4/d40/classTCPDF.html#a90bee4debe4218064059014965f8d52a">$this-&gt;original_lMargin</a>;</div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;            }</div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;            <span class="keywordflow">if</span> (($headerdata[<span class="stringliteral">&#39;logo&#39;</span>]) AND ($headerdata[<span class="stringliteral">&#39;logo&#39;</span>] != <a class="code" href="../../d5/dc0/tcpdf__config_8php.html#aec29ec2331d6b086a2aa2316be8b47f1">K_BLANK_IMAGE</a>)) {</div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;                $imgtype = TCPDF_IMAGES::getImageFileType(<a class="code" href="../../d5/dc0/tcpdf__config_8php.html#a82a1d9035f18432d5e17e0e56d188a52">K_PATH_IMAGES</a>.$headerdata[<span class="stringliteral">&#39;logo&#39;</span>]);</div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;                <span class="keywordflow">if</span> (($imgtype == <span class="stringliteral">&#39;eps&#39;</span>) OR ($imgtype == <span class="stringliteral">&#39;ai&#39;</span>)) {</div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ace0583441eed657b827420fcfb37a3bd">ImageEps</a>(<a class="code" href="../../d5/dc0/tcpdf__config_8php.html#a82a1d9035f18432d5e17e0e56d188a52">K_PATH_IMAGES</a>.$headerdata[<span class="stringliteral">&#39;logo&#39;</span>], <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $headerdata[<span class="stringliteral">&#39;logo_width&#39;</span>]);</div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;                } elseif ($imgtype == <span class="stringliteral">&#39;svg&#39;</span>) {</div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a56536508fb1b5aede7d2ed27f56c2353">ImageSVG</a>(<a class="code" href="../../d5/dc0/tcpdf__config_8php.html#a82a1d9035f18432d5e17e0e56d188a52">K_PATH_IMAGES</a>.$headerdata[<span class="stringliteral">&#39;logo&#39;</span>], <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $headerdata[<span class="stringliteral">&#39;logo_width&#39;</span>]);</div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a714c2bee7d6b39d4d6d304540c761352">Image</a>(<a class="code" href="../../d5/dc0/tcpdf__config_8php.html#a82a1d9035f18432d5e17e0e56d188a52">K_PATH_IMAGES</a>.$headerdata[<span class="stringliteral">&#39;logo&#39;</span>], <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $headerdata[<span class="stringliteral">&#39;logo_width&#39;</span>]);</div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;                }</div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;                $imgy = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a0368d51e3742f13e5972b2e2f7d6fd28">getImageRBY</a>();</div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;                $imgy = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;            }</div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;            $cell_height = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a25c7f71b3fcb19024497ea620f885346">getCellHeight</a>($headerfont[2] / $this-&gt;k);</div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;            <span class="comment">// set starting margin for text data cell</span></div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af01238bb928c4e3de6ed6aaa855fd788">getRTL</a>()) {</div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;                $header_x = $this-&gt;original_rMargin + ($headerdata[<span class="stringliteral">&#39;logo_width&#39;</span>] * 1.1);</div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;                $header_x = $this-&gt;original_lMargin + ($headerdata[<span class="stringliteral">&#39;logo_width&#39;</span>] * 1.1);</div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;            }</div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;            $cw = $this-&gt;w - $this-&gt;original_lMargin - $this-&gt;original_rMargin - ($headerdata[<span class="stringliteral">&#39;logo_width&#39;</span>] * 1.1);</div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ae6e2854e4d5c71966ef5121934c24566">SetTextColorArray</a>($this-&gt;header_text_color);</div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;            <span class="comment">// header title</span></div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#afd56e360c43553830d543323e81bc045">SetFont</a>($headerfont[0], <span class="charliteral">&#39;B&#39;</span>, $headerfont[2] + 1);</div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8d831d202e6420fe8fa6aeae7d3a2e8e">SetX</a>($header_x);</div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a33b265e5eb3e4d1d4fedfe29f8166f31">Cell</a>($cw, $cell_height, $headerdata[<span class="stringliteral">&#39;title&#39;</span>], 0, 1, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="stringliteral">&#39;&#39;</span>, 0);</div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;            <span class="comment">// header string</span></div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#afd56e360c43553830d543323e81bc045">SetFont</a>($headerfont[0], $headerfont[1], $headerfont[2]);</div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8d831d202e6420fe8fa6aeae7d3a2e8e">SetX</a>($header_x);</div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa81d4b585de305c054760ec983ed3ece">MultiCell</a>($cw, $cell_height, $headerdata[<span class="stringliteral">&#39;string&#39;</span>], 0, <span class="stringliteral">&#39;&#39;</span>, 0, 1, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">true</span>, 0, <span class="keyword">false</span>, <span class="keyword">true</span>, 0, <span class="charliteral">&#39;T&#39;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;            <span class="comment">// print an ending header line</span></div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a3d9b3717cd9ad8db31642155c832d148">SetLineStyle</a>(array(<span class="stringliteral">&#39;width&#39;</span> =&gt; 0.85 / $this-&gt;k, <span class="stringliteral">&#39;cap&#39;</span> =&gt; <span class="stringliteral">&#39;butt&#39;</span>, <span class="stringliteral">&#39;join&#39;</span> =&gt; <span class="stringliteral">&#39;miter&#39;</span>, <span class="stringliteral">&#39;dash&#39;</span> =&gt; 0, <span class="stringliteral">&#39;color&#39;</span> =&gt; $headerdata[<span class="stringliteral">&#39;line_color&#39;</span>]));</div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ad3439990de56253b039bca6a09305758">SetY</a>((2.835 / $this-&gt;k) + max($imgy, $this-&gt;y));</div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8d831d202e6420fe8fa6aeae7d3a2e8e">SetX</a>($this-&gt;original_rMargin);</div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8d831d202e6420fe8fa6aeae7d3a2e8e">SetX</a>($this-&gt;original_lMargin);</div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;            }</div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a33b265e5eb3e4d1d4fedfe29f8166f31">Cell</a>(($this-&gt;w - $this-&gt;original_lMargin - $this-&gt;original_rMargin), 0, <span class="stringliteral">&#39;&#39;</span>, <span class="charliteral">&#39;T&#39;</span>, 0, <span class="charliteral">&#39;C&#39;</span>);</div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a0b98de81d99a1a0e983dd0016e30fc75">endTemplate</a>();</div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;        }</div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;        <span class="comment">// print header template</span></div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> = 0;</div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;        $dx = 0;</div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;        <span class="keywordflow">if</span> (!$this-&gt;header_xobj_autoreset AND $this-&gt;booklet AND (($this-&gt;page % 2) == 0)) {</div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;            <span class="comment">// adjust margins for booklet mode</span></div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;            $dx = ($this-&gt;original_lMargin - <a class="code" href="../../d4/d40/classTCPDF.html#a76d33e30b8292c2483e80bc98566483f">$this-&gt;original_rMargin</a>);</div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;        }</div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> = $this-&gt;w + $dx;</div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> = 0 + $dx;</div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;        }</div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a3a58677c9c6a6e9e7702fcb3041b7253">printTemplate</a>($this-&gt;header_xobjid, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, 0, 0, 0, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;header_xobj_autoreset) {</div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;            <span class="comment">// reset header xobject template at each page</span></div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;            $this-&gt;header_xobjid = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;        }</div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;    }</div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;</div>
<div class="line"><a name="l03475"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ae40eff8871e1deebf4bea96de4d8a3e4"> 3475</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ae40eff8871e1deebf4bea96de4d8a3e4">Footer</a>() {</div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;        $cur_y = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ae6e2854e4d5c71966ef5121934c24566">SetTextColorArray</a>($this-&gt;footer_text_color);</div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;        <span class="comment">//set style for cell border</span></div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;        $line_width = (0.85 / <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>);</div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a3d9b3717cd9ad8db31642155c832d148">SetLineStyle</a>(array(<span class="stringliteral">&#39;width&#39;</span> =&gt; $line_width, <span class="stringliteral">&#39;cap&#39;</span> =&gt; <span class="stringliteral">&#39;butt&#39;</span>, <span class="stringliteral">&#39;join&#39;</span> =&gt; <span class="stringliteral">&#39;miter&#39;</span>, <span class="stringliteral">&#39;dash&#39;</span> =&gt; 0, <span class="stringliteral">&#39;color&#39;</span> =&gt; $this-&gt;footer_line_color));</div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;        <span class="comment">//print document barcode</span></div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#aa043d6a67959c785e8decc6ef1400cd8">$barcode</a> = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa3deb91c4ae36afa6253c831df589b3d">getBarcode</a>();</div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;        <span class="keywordflow">if</span> (!empty(<a class="code" href="../../d4/d40/classTCPDF.html#aa043d6a67959c785e8decc6ef1400cd8">$barcode</a>)) {</div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a00969cf629d72b3d29ee435f15906820">Ln</a>($line_width);</div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;            $barcode_width = round(($this-&gt;w - $this-&gt;original_lMargin - $this-&gt;original_rMargin) / 3);</div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;            $style = array(</div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;                <span class="stringliteral">&#39;position&#39;</span> =&gt; $this-&gt;rtl?<span class="charliteral">&#39;R&#39;</span>:<span class="charliteral">&#39;L&#39;</span>,</div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;                <span class="stringliteral">&#39;align&#39;</span> =&gt; $this-&gt;rtl?<span class="charliteral">&#39;R&#39;</span>:<span class="charliteral">&#39;L&#39;</span>,</div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;                <span class="stringliteral">&#39;stretch&#39;</span> =&gt; <span class="keyword">false</span>,</div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;                <span class="stringliteral">&#39;fitwidth&#39;</span> =&gt; <span class="keyword">true</span>,</div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;                <span class="stringliteral">&#39;cellfitalign&#39;</span> =&gt; <span class="stringliteral">&#39;&#39;</span>,</div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;                <span class="stringliteral">&#39;border&#39;</span> =&gt; <span class="keyword">false</span>,</div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;                <span class="stringliteral">&#39;padding&#39;</span> =&gt; 0,</div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;                <span class="stringliteral">&#39;fgcolor&#39;</span> =&gt; array(0,0,0),</div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;                <span class="stringliteral">&#39;bgcolor&#39;</span> =&gt; <span class="keyword">false</span>,</div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;                <span class="stringliteral">&#39;text&#39;</span> =&gt; <span class="keyword">false</span></div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;            );</div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4816d61822a4bad6e35bb441c1699aab">write1DBarcode</a>(<a class="code" href="../../d4/d40/classTCPDF.html#aa043d6a67959c785e8decc6ef1400cd8">$barcode</a>, <span class="stringliteral">&#39;C128&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $cur_y + $line_width, <span class="stringliteral">&#39;&#39;</span>, (($this-&gt;footer_margin / 3) - $line_width), 0.3, $style, <span class="stringliteral">&#39;&#39;</span>);</div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;        }</div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;        $w_page = isset($this-&gt;l[<span class="stringliteral">&#39;w_page&#39;</span>]) ? $this-&gt;l[<span class="stringliteral">&#39;w_page&#39;</span>].<span class="charliteral">&#39; &#39;</span> : <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;        <span class="keywordflow">if</span> (empty($this-&gt;pagegroups)) {</div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;            $pagenumtxt = $w_page.$this-&gt;getAliasNumPage().<span class="stringliteral">&#39; / &#39;</span>.$this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a3a6255516dcf07089fe29f13b3ef67bf">getAliasNbPages</a>();</div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;            $pagenumtxt = $w_page.$this-&gt;getPageNumGroupAlias().<span class="stringliteral">&#39; / &#39;</span>.$this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af73382321461f24798a639c2f433a67f">getPageGroupAlias</a>();</div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;        }</div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ad3439990de56253b039bca6a09305758">SetY</a>($cur_y);</div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;        <span class="comment">//Print page number</span></div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af01238bb928c4e3de6ed6aaa855fd788">getRTL</a>()) {</div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8d831d202e6420fe8fa6aeae7d3a2e8e">SetX</a>($this-&gt;original_rMargin);</div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a33b265e5eb3e4d1d4fedfe29f8166f31">Cell</a>(0, 0, $pagenumtxt, <span class="charliteral">&#39;T&#39;</span>, 0, <span class="charliteral">&#39;L&#39;</span>);</div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8d831d202e6420fe8fa6aeae7d3a2e8e">SetX</a>($this-&gt;original_lMargin);</div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a33b265e5eb3e4d1d4fedfe29f8166f31">Cell</a>(0, 0, $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ad089fa332b723086484ae0497ae90590">getAliasRightShift</a>().$pagenumtxt, <span class="charliteral">&#39;T&#39;</span>, 0, <span class="charliteral">&#39;R&#39;</span>);</div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;        }</div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;    }</div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;</div>
<div class="line"><a name="l03522"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a9e36d6b325764815dd652636ece7eead"> 3522</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a9e36d6b325764815dd652636ece7eead">setHeader</a>() {</div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;        <span class="keywordflow">if</span> (!$this-&gt;print_header OR ($this-&gt;state != 2)) {</div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;        }</div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;        $this-&gt;InHeader = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a072053646725b19770a795050b3b6221">setGraphicVars</a>($this-&gt;default_graphic_vars);</div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;        $temp_thead = <a class="code" href="../../d4/d40/classTCPDF.html#ae7cd5ea4b0ef3a0910ed0044bea97f1d">$this-&gt;thead</a>;</div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;        $temp_theadMargins = <a class="code" href="../../d4/d40/classTCPDF.html#a1545ffbbb4d3e78ac3bf8413300016eb">$this-&gt;theadMargins</a>;</div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#a41e87b05a84dd56c2c824af49470e295">$lasth</a> = <a class="code" href="../../d4/d40/classTCPDF.html#a41e87b05a84dd56c2c824af49470e295">$this-&gt;lasth</a>;</div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#a505b4eabece70b8679ebdeb86964b798">$newline</a> = <a class="code" href="../../d4/d40/classTCPDF.html#a505b4eabece70b8679ebdeb86964b798">$this-&gt;newline</a>;</div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa316f47dbdd13a6dd2897d6be347cbbb">_outSaveGraphicsState</a>();</div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;        $this-&gt;rMargin = <a class="code" href="../../d4/d40/classTCPDF.html#a76d33e30b8292c2483e80bc98566483f">$this-&gt;original_rMargin</a>;</div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;        $this-&gt;lMargin = <a class="code" href="../../d4/d40/classTCPDF.html#a90bee4debe4218064059014965f8d52a">$this-&gt;original_lMargin</a>;</div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a374b24751bf76e4ca5ba7694f87ec2c1">SetCellPadding</a>(0);</div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;        <span class="comment">//set current position</span></div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a00ec13928f57b17c21040acc881fe482">SetXY</a>($this-&gt;original_rMargin, $this-&gt;header_margin);</div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a00ec13928f57b17c21040acc881fe482">SetXY</a>($this-&gt;original_lMargin, $this-&gt;header_margin);</div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;        }</div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#afd56e360c43553830d543323e81bc045">SetFont</a>($this-&gt;header_font[0], $this-&gt;header_font[1], $this-&gt;header_font[2]);</div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a553f8a9bbb5301f983ebfd64544cb7a8">Header</a>();</div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;        <span class="comment">//restore position</span></div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a00ec13928f57b17c21040acc881fe482">SetXY</a>($this-&gt;original_rMargin, $this-&gt;tMargin);</div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a00ec13928f57b17c21040acc881fe482">SetXY</a>($this-&gt;original_lMargin, $this-&gt;tMargin);</div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;        }</div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af623eface3ce63b2bc1709d47c84ab69">_outRestoreGraphicsState</a>();</div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;        $this-&gt;lasth = <a class="code" href="../../d4/d40/classTCPDF.html#a41e87b05a84dd56c2c824af49470e295">$lasth</a>;</div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;        $this-&gt;thead = $temp_thead;</div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;        $this-&gt;theadMargins = $temp_theadMargins;</div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;        $this-&gt;newline = <a class="code" href="../../d4/d40/classTCPDF.html#a505b4eabece70b8679ebdeb86964b798">$newline</a>;</div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;        $this-&gt;InHeader = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;    }</div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;</div>
<div class="line"><a name="l03563"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a7b0675e51b6f7ab3e4730feef3c86fb5"> 3563</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a7b0675e51b6f7ab3e4730feef3c86fb5">setFooter</a>() {</div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;state != 2) {</div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;        }</div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;        $this-&gt;InFooter = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;        <span class="comment">// save current graphic settings</span></div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;        $gvars = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a24d3c102468b6ab9d2f4859a8b01863a">getGraphicVars</a>();</div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;        <span class="comment">// mark this point</span></div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;        $this-&gt;footerpos[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>] = $this-&gt;pagelen[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>];</div>
<div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;print_footer) {</div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a072053646725b19770a795050b3b6221">setGraphicVars</a>($this-&gt;default_graphic_vars);</div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;            $this-&gt;current_column = 0;</div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;            $this-&gt;num_columns = 1;</div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;            $temp_thead = <a class="code" href="../../d4/d40/classTCPDF.html#ae7cd5ea4b0ef3a0910ed0044bea97f1d">$this-&gt;thead</a>;</div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;            $temp_theadMargins = <a class="code" href="../../d4/d40/classTCPDF.html#a1545ffbbb4d3e78ac3bf8413300016eb">$this-&gt;theadMargins</a>;</div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a41e87b05a84dd56c2c824af49470e295">$lasth</a> = <a class="code" href="../../d4/d40/classTCPDF.html#a41e87b05a84dd56c2c824af49470e295">$this-&gt;lasth</a>;</div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa316f47dbdd13a6dd2897d6be347cbbb">_outSaveGraphicsState</a>();</div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;            $this-&gt;rMargin = <a class="code" href="../../d4/d40/classTCPDF.html#a76d33e30b8292c2483e80bc98566483f">$this-&gt;original_rMargin</a>;</div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;            $this-&gt;lMargin = <a class="code" href="../../d4/d40/classTCPDF.html#a90bee4debe4218064059014965f8d52a">$this-&gt;original_lMargin</a>;</div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a374b24751bf76e4ca5ba7694f87ec2c1">SetCellPadding</a>(0);</div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;            <span class="comment">//set current position</span></div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;            $footer_y = $this-&gt;h - <a class="code" href="../../d4/d40/classTCPDF.html#ad5cecadb5d4b25324516668aaf23c3ca">$this-&gt;footer_margin</a>;</div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a00ec13928f57b17c21040acc881fe482">SetXY</a>($this-&gt;original_rMargin, $footer_y);</div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a00ec13928f57b17c21040acc881fe482">SetXY</a>($this-&gt;original_lMargin, $footer_y);</div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;            }</div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#afd56e360c43553830d543323e81bc045">SetFont</a>($this-&gt;footer_font[0], $this-&gt;footer_font[1], $this-&gt;footer_font[2]);</div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ae40eff8871e1deebf4bea96de4d8a3e4">Footer</a>();</div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;            <span class="comment">//restore position</span></div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a00ec13928f57b17c21040acc881fe482">SetXY</a>($this-&gt;original_rMargin, $this-&gt;tMargin);</div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a00ec13928f57b17c21040acc881fe482">SetXY</a>($this-&gt;original_lMargin, $this-&gt;tMargin);</div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;            }</div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af623eface3ce63b2bc1709d47c84ab69">_outRestoreGraphicsState</a>();</div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;            $this-&gt;lasth = <a class="code" href="../../d4/d40/classTCPDF.html#a41e87b05a84dd56c2c824af49470e295">$lasth</a>;</div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;            $this-&gt;thead = $temp_thead;</div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;            $this-&gt;theadMargins = $temp_theadMargins;</div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;        }</div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;        <span class="comment">// restore graphic settings</span></div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a072053646725b19770a795050b3b6221">setGraphicVars</a>($gvars);</div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;        $this-&gt;current_column = $gvars[<span class="stringliteral">&#39;current_column&#39;</span>];</div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;        $this-&gt;num_columns = $gvars[<span class="stringliteral">&#39;num_columns&#39;</span>];</div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;        <span class="comment">// calculate footer length</span></div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;        $this-&gt;footerlen[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>] = $this-&gt;pagelen[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>] - $this-&gt;footerpos[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>] + 1;</div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;        $this-&gt;InFooter = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;    }</div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;</div>
<div class="line"><a name="l03619"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a13f370f8e1553105eaa3553f52c3fc6c"> 3619</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a13f370f8e1553105eaa3553f52c3fc6c">inPageBody</a>() {</div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;        <span class="keywordflow">return</span> (($this-&gt;InHeader === <span class="keyword">false</span>) AND ($this-&gt;InFooter === <span class="keyword">false</span>));</div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;    }</div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;</div>
<div class="line"><a name="l03628"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a52a8502589754eefe8da17efdd40329b"> 3628</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a52a8502589754eefe8da17efdd40329b">setTableHeader</a>() {</div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;num_columns &gt; 1) {</div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;            <span class="comment">// multi column mode</span></div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;        }</div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;theadMargins[<span class="stringliteral">&#39;top&#39;</span>])) {</div>
<div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;            <span class="comment">// restore the original top-margin</span></div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;            $this-&gt;tMargin = $this-&gt;theadMargins[<span class="stringliteral">&#39;top&#39;</span>];</div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;            $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;tm&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#ace8343242b398fd16a4acb1926b6efa7">$this-&gt;tMargin</a>;</div>
<div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;            $this-&gt;y = <a class="code" href="../../d4/d40/classTCPDF.html#ace8343242b398fd16a4acb1926b6efa7">$this-&gt;tMargin</a>;</div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;        }</div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;        <span class="keywordflow">if</span> (!TCPDF_STATIC::empty_string($this-&gt;thead) AND (!$this-&gt;inthead)) {</div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;            <span class="comment">// set margins</span></div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;            $prev_lMargin = <a class="code" href="../../d4/d40/classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da">$this-&gt;lMargin</a>;</div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;            $prev_rMargin = <a class="code" href="../../d4/d40/classTCPDF.html#a44fb75b85bea40ced25fdea9d89dc8e9">$this-&gt;rMargin</a>;</div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;            $prev_cell_padding = <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$this-&gt;cell_padding</a>;</div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;            $this-&gt;lMargin = $this-&gt;theadMargins[<span class="stringliteral">&#39;lmargin&#39;</span>] + ($this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;olm&#39;</span>] - $this-&gt;pagedim[$this-&gt;theadMargins[<span class="stringliteral">&#39;page&#39;</span>]][<span class="stringliteral">&#39;olm&#39;</span>]);</div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;            $this-&gt;rMargin = $this-&gt;theadMargins[<span class="stringliteral">&#39;rmargin&#39;</span>] + ($this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;orm&#39;</span>] - $this-&gt;pagedim[$this-&gt;theadMargins[<span class="stringliteral">&#39;page&#39;</span>]][<span class="stringliteral">&#39;orm&#39;</span>]);</div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;            $this-&gt;cell_padding = $this-&gt;theadMargins[<span class="stringliteral">&#39;cell_padding&#39;</span>];</div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;                $this-&gt;x = $this-&gt;w - <a class="code" href="../../d4/d40/classTCPDF.html#a44fb75b85bea40ced25fdea9d89dc8e9">$this-&gt;rMargin</a>;</div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;                $this-&gt;x = <a class="code" href="../../d4/d40/classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da">$this-&gt;lMargin</a>;</div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;            }</div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;            <span class="comment">// account for special &quot;cell&quot; mode</span></div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;theadMargins[<span class="stringliteral">&#39;cell&#39;</span>]) {</div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;                    $this-&gt;x -= $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>];</div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;                    $this-&gt;x += $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>];</div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;                }</div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;            }</div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;            $gvars = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a24d3c102468b6ab9d2f4859a8b01863a">getGraphicVars</a>();</div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;            <span class="keywordflow">if</span> (!empty($this-&gt;theadMargins[<span class="stringliteral">&#39;gvars&#39;</span>])) {</div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;                <span class="comment">// set the correct graphic style</span></div>
<div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a072053646725b19770a795050b3b6221">setGraphicVars</a>($this-&gt;theadMargins[<span class="stringliteral">&#39;gvars&#39;</span>]);</div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;                $this-&gt;rMargin = $gvars[<span class="stringliteral">&#39;rMargin&#39;</span>];</div>
<div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;                $this-&gt;lMargin = $gvars[<span class="stringliteral">&#39;lMargin&#39;</span>];</div>
<div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;            }</div>
<div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;            <span class="comment">// print table header</span></div>
<div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac3fdf25fcd36f1dce04f92187c621407">writeHTML</a>($this-&gt;thead, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="stringliteral">&#39;&#39;</span>);</div>
<div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a072053646725b19770a795050b3b6221">setGraphicVars</a>($gvars);</div>
<div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;            <span class="comment">// set new top margin to skip the table headers</span></div>
<div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;            <span class="keywordflow">if</span> (!isset($this-&gt;theadMargins[<span class="stringliteral">&#39;top&#39;</span>])) {</div>
<div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;                $this-&gt;theadMargins[<span class="stringliteral">&#39;top&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#ace8343242b398fd16a4acb1926b6efa7">$this-&gt;tMargin</a>;</div>
<div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;            }</div>
<div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;            <span class="comment">// store end of header position</span></div>
<div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;            <span class="keywordflow">if</span> (!isset($this-&gt;columns[0][<span class="stringliteral">&#39;th&#39;</span>])) {</div>
<div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;                $this-&gt;columns[0][<span class="stringliteral">&#39;th&#39;</span>] = array();</div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;            }</div>
<div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;            $this-&gt;columns[0][<span class="stringliteral">&#39;th&#39;</span>][<span class="charliteral">&#39;\&#39;&#39;</span>.$this-&gt;page.<span class="charliteral">&#39;\&#39;&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;            $this-&gt;tMargin = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;            $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;tm&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#ace8343242b398fd16a4acb1926b6efa7">$this-&gt;tMargin</a>;</div>
<div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;            $this-&gt;lasth = 0;</div>
<div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;            $this-&gt;lMargin = $prev_lMargin;</div>
<div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;            $this-&gt;rMargin = $prev_rMargin;</div>
<div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;            $this-&gt;cell_padding = $prev_cell_padding;</div>
<div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;        }</div>
<div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;    }</div>
<div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;</div>
<div class="line"><a name="l03695"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a9ad828b184f08828f570a7e52316ba79"> 3695</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a9ad828b184f08828f570a7e52316ba79">PageNo</a>() {</div>
<div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>;</div>
<div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;    }</div>
<div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;</div>
<div class="line"><a name="l03705"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a8e520f160f6725a4f0a7d7affc67cbd8"> 3705</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a8e520f160f6725a4f0a7d7affc67cbd8">getAllSpotColors</a>() {</div>
<div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#a25c924c6b9a12aba0d0a3e535eca224d">$this-&gt;spot_colors</a>;</div>
<div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;    }</div>
<div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;</div>
<div class="line"><a name="l03722"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a082e1feab2282c76f5b7e2eaafc6f457"> 3722</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a082e1feab2282c76f5b7e2eaafc6f457">AddSpotColor</a>($name, $c, $m, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a>) {</div>
<div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;        <span class="keywordflow">if</span> (!isset($this-&gt;spot_colors[$name])) {</div>
<div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;            $i = (1 + count($this-&gt;spot_colors));</div>
<div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;            $this-&gt;spot_colors[$name] = array(<span class="charliteral">&#39;C&#39;</span> =&gt; $c, <span class="charliteral">&#39;M&#39;</span> =&gt; $m, <span class="charliteral">&#39;Y&#39;</span> =&gt; <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <span class="charliteral">&#39;K&#39;</span> =&gt; <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a>, <span class="stringliteral">&#39;name&#39;</span> =&gt; $name, <span class="charliteral">&#39;i&#39;</span> =&gt; $i);</div>
<div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;        }</div>
<div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;    }</div>
<div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;</div>
<div class="line"><a name="l03738"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#af8af438c6e81b9794dc8d37c8f602aaf"> 3738</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#af8af438c6e81b9794dc8d37c8f602aaf">setSpotColor</a>($type, $name, $tint=100) {</div>
<div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;        $spotcolor = TCPDF_COLORS::getSpotColor($name, $this-&gt;spot_colors);</div>
<div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;        <span class="keywordflow">if</span> ($spotcolor === <span class="keyword">false</span>) {</div>
<div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;Undefined spot color: &#39;</span>.$name.<span class="stringliteral">&#39;, you must add it using the AddSpotColor() method.&#39;</span>);</div>
<div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;        }</div>
<div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;        $tint = (max(0, min(100, $tint)) / 100);</div>
<div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;        $pdfcolor = sprintf(<span class="stringliteral">&#39;/CS%d &#39;</span>, $this-&gt;spot_colors[$name][<span class="charliteral">&#39;i&#39;</span>]);</div>
<div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;        <span class="keywordflow">switch</span> ($type) {</div>
<div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;draw&#39;</span>: {</div>
<div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;                $pdfcolor .= sprintf(<span class="stringliteral">&#39;CS %F SCN&#39;</span>, $tint);</div>
<div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;                $this-&gt;DrawColor = $pdfcolor;</div>
<div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;                $this-&gt;strokecolor = $spotcolor;</div>
<div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;            }</div>
<div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;fill&#39;</span>: {</div>
<div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;                $pdfcolor .= sprintf(<span class="stringliteral">&#39;cs %F scn&#39;</span>, $tint);</div>
<div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;                $this-&gt;FillColor = $pdfcolor;</div>
<div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;                $this-&gt;bgcolor = $spotcolor;</div>
<div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;            }</div>
<div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;text&#39;</span>: {</div>
<div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;                $pdfcolor .= sprintf(<span class="stringliteral">&#39;cs %F scn&#39;</span>, $tint);</div>
<div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;                $this-&gt;TextColor = $pdfcolor;</div>
<div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;                $this-&gt;fgcolor = $spotcolor;</div>
<div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;            }</div>
<div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;        }</div>
<div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;        $this-&gt;ColorFlag = ($this-&gt;FillColor != <a class="code" href="../../d4/d40/classTCPDF.html#ade7bced891aaa3b0a5ce236eb7a5c8ba">$this-&gt;TextColor</a>);</div>
<div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;state == 2) {</div>
<div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($pdfcolor);</div>
<div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;        }</div>
<div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;inxobj) {</div>
<div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;            <span class="comment">// we are inside an XObject template</span></div>
<div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;            $this-&gt;xobjects[<a class="code" href="../../d4/d40/classTCPDF.html#abe4390b4e1939e10c9b61a986adfc117">$this-&gt;xobjid</a>][<span class="stringliteral">&#39;spot_colors&#39;</span>][$name] = $this-&gt;spot_colors[$name];</div>
<div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;        }</div>
<div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;        <span class="keywordflow">return</span> $pdfcolor;</div>
<div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;    }</div>
<div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;</div>
<div class="line"><a name="l03784"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#af17e978f511addd7a3000d71ebf4ab55"> 3784</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#af17e978f511addd7a3000d71ebf4ab55">SetDrawSpotColor</a>($name, $tint=100) {</div>
<div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af8af438c6e81b9794dc8d37c8f602aaf">setSpotColor</a>(<span class="stringliteral">&#39;draw&#39;</span>, $name, $tint);</div>
<div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;    }</div>
<div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;</div>
<div class="line"><a name="l03796"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a78c46e485a0c0c10b0f8aee7169ffc67"> 3796</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a78c46e485a0c0c10b0f8aee7169ffc67">SetFillSpotColor</a>($name, $tint=100) {</div>
<div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af8af438c6e81b9794dc8d37c8f602aaf">setSpotColor</a>(<span class="stringliteral">&#39;fill&#39;</span>, $name, $tint);</div>
<div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;    }</div>
<div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;</div>
<div class="line"><a name="l03808"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#af18f6bdb79e68fd8ed6386d2bb98e9a2"> 3808</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#af18f6bdb79e68fd8ed6386d2bb98e9a2">SetTextSpotColor</a>($name, $tint=100) {</div>
<div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af8af438c6e81b9794dc8d37c8f602aaf">setSpotColor</a>(<span class="stringliteral">&#39;text&#39;</span>, $name, $tint);</div>
<div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;    }</div>
<div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;</div>
<div class="line"><a name="l03823"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aa0bd7035053a662b8d946ec411bebb14"> 3823</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#aa0bd7035053a662b8d946ec411bebb14">setColorArray</a>($type, $color, $ret=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;        <span class="keywordflow">if</span> (is_array($color)) {</div>
<div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;            $color = array_values($color);</div>
<div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;            <span class="comment">// component: grey, RGB red or CMYK cyan</span></div>
<div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;            $c = isset($color[0]) ? $color[0] : -1;</div>
<div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;            <span class="comment">// component: RGB green or CMYK magenta</span></div>
<div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;            $m = isset($color[1]) ? $color[1] : -1;</div>
<div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;            <span class="comment">// component: RGB blue or CMYK yellow</span></div>
<div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> = isset($color[2]) ? $color[2] : -1;</div>
<div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;            <span class="comment">// component: CMYK black</span></div>
<div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a> = isset($color[3]) ? $color[3] : -1;</div>
<div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;            <span class="comment">// color name</span></div>
<div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;            $name = isset($color[4]) ? $color[4] : <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;            <span class="keywordflow">if</span> ($c &gt;= 0) {</div>
<div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;                <span class="keywordflow">return</span> $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8b80c7e5aae2bc717b469eda5ee755fd">setColor</a>($type, $c, $m, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a>, $ret, $name);</div>
<div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;            }</div>
<div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;        }</div>
<div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;        <span class="keywordflow">return</span> <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;    }</div>
<div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;</div>
<div class="line"><a name="l03854"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a8f3481f3ce8a4fcd40ac1e1a6bd8960e"> 3854</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a8f3481f3ce8a4fcd40ac1e1a6bd8960e">SetDrawColorArray</a>($color, $ret=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;        <span class="keywordflow">return</span> $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa0bd7035053a662b8d946ec411bebb14">setColorArray</a>(<span class="stringliteral">&#39;draw&#39;</span>, $color, $ret);</div>
<div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;    }</div>
<div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;</div>
<div class="line"><a name="l03868"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a850dd347f649c99548a193f2b84a502e"> 3868</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a850dd347f649c99548a193f2b84a502e">SetFillColorArray</a>($color, $ret=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;        <span class="keywordflow">return</span> $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa0bd7035053a662b8d946ec411bebb14">setColorArray</a>(<span class="stringliteral">&#39;fill&#39;</span>, $color, $ret);</div>
<div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;    }</div>
<div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;</div>
<div class="line"><a name="l03881"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ae6e2854e4d5c71966ef5121934c24566"> 3881</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ae6e2854e4d5c71966ef5121934c24566">SetTextColorArray</a>($color, $ret=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;        <span class="keywordflow">return</span> $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa0bd7035053a662b8d946ec411bebb14">setColorArray</a>(<span class="stringliteral">&#39;text&#39;</span>, $color, $ret);</div>
<div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;    }</div>
<div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;</div>
<div class="line"><a name="l03898"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a8b80c7e5aae2bc717b469eda5ee755fd"> 3898</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a8b80c7e5aae2bc717b469eda5ee755fd">setColor</a>($type, $col1=0, $col2=-1, $col3=-1, $col4=-1, $ret=<span class="keyword">false</span>, $name=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;        <span class="comment">// set default values</span></div>
<div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;        <span class="keywordflow">if</span> (!is_numeric($col1)) {</div>
<div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;            $col1 = 0;</div>
<div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;        }</div>
<div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;        <span class="keywordflow">if</span> (!is_numeric($col2)) {</div>
<div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;            $col2 = -1;</div>
<div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;        }</div>
<div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;        <span class="keywordflow">if</span> (!is_numeric($col3)) {</div>
<div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;            $col3 = -1;</div>
<div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;        }</div>
<div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;        <span class="keywordflow">if</span> (!is_numeric($col4)) {</div>
<div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;            $col4 = -1;</div>
<div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;        }</div>
<div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;        <span class="comment">// set color by case</span></div>
<div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;        $suffix = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;        <span class="keywordflow">if</span> (($col2 == -1) AND ($col3 == -1) AND ($col4 == -1)) {</div>
<div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;            <span class="comment">// Grey scale</span></div>
<div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;            $col1 = max(0, min(255, $col1));</div>
<div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;            $intcolor = array(<span class="charliteral">&#39;G&#39;</span> =&gt; $col1);</div>
<div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;            $pdfcolor = sprintf(<span class="stringliteral">&#39;%F &#39;</span>, ($col1 / 255));</div>
<div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;            $suffix = <span class="charliteral">&#39;g&#39;</span>;</div>
<div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;        } elseif ($col4 == -1) {</div>
<div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;            <span class="comment">// RGB</span></div>
<div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;            $col1 = max(0, min(255, $col1));</div>
<div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;            $col2 = max(0, min(255, $col2));</div>
<div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;            $col3 = max(0, min(255, $col3));</div>
<div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;            $intcolor = array(<span class="charliteral">&#39;R&#39;</span> =&gt; $col1, <span class="charliteral">&#39;G&#39;</span> =&gt; $col2, <span class="charliteral">&#39;B&#39;</span> =&gt; $col3);</div>
<div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;            $pdfcolor = sprintf(<span class="stringliteral">&#39;%F %F %F &#39;</span>, ($col1 / 255), ($col2 / 255), ($col3 / 255));</div>
<div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;            $suffix = <span class="stringliteral">&#39;rg&#39;</span>;</div>
<div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;            $col1 = max(0, min(100, $col1));</div>
<div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;            $col2 = max(0, min(100, $col2));</div>
<div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;            $col3 = max(0, min(100, $col3));</div>
<div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;            $col4 = max(0, min(100, $col4));</div>
<div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;            <span class="keywordflow">if</span> (empty($name)) {</div>
<div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;                <span class="comment">// CMYK</span></div>
<div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;                $intcolor = array(<span class="charliteral">&#39;C&#39;</span> =&gt; $col1, <span class="charliteral">&#39;M&#39;</span> =&gt; $col2, <span class="charliteral">&#39;Y&#39;</span> =&gt; $col3, <span class="charliteral">&#39;K&#39;</span> =&gt; $col4);</div>
<div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;                $pdfcolor = sprintf(<span class="stringliteral">&#39;%F %F %F %F &#39;</span>, ($col1 / 100), ($col2 / 100), ($col3 / 100), ($col4 / 100));</div>
<div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;                $suffix = <span class="charliteral">&#39;k&#39;</span>;</div>
<div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;                <span class="comment">// SPOT COLOR</span></div>
<div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;                $intcolor = array(<span class="charliteral">&#39;C&#39;</span> =&gt; $col1, <span class="charliteral">&#39;M&#39;</span> =&gt; $col2, <span class="charliteral">&#39;Y&#39;</span> =&gt; $col3, <span class="charliteral">&#39;K&#39;</span> =&gt; $col4, <span class="stringliteral">&#39;name&#39;</span> =&gt; $name);</div>
<div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a082e1feab2282c76f5b7e2eaafc6f457">AddSpotColor</a>($name, $col1, $col2, $col3, $col4);</div>
<div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;                $pdfcolor = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af8af438c6e81b9794dc8d37c8f602aaf">setSpotColor</a>($type, $name, 100);</div>
<div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;            }</div>
<div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;        }</div>
<div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;        <span class="keywordflow">switch</span> ($type) {</div>
<div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;draw&#39;</span>: {</div>
<div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;                $pdfcolor .= strtoupper($suffix);</div>
<div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;                $this-&gt;DrawColor = $pdfcolor;</div>
<div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;                $this-&gt;strokecolor = $intcolor;</div>
<div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;            }</div>
<div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;fill&#39;</span>: {</div>
<div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;                $pdfcolor .= $suffix;</div>
<div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;                $this-&gt;FillColor = $pdfcolor;</div>
<div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;                $this-&gt;bgcolor = $intcolor;</div>
<div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;            }</div>
<div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;text&#39;</span>: {</div>
<div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;                $pdfcolor .= $suffix;</div>
<div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;                $this-&gt;TextColor = $pdfcolor;</div>
<div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;                $this-&gt;fgcolor = $intcolor;</div>
<div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;            }</div>
<div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;        }</div>
<div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;        $this-&gt;ColorFlag = ($this-&gt;FillColor != <a class="code" href="../../d4/d40/classTCPDF.html#ade7bced891aaa3b0a5ce236eb7a5c8ba">$this-&gt;TextColor</a>);</div>
<div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;        <span class="keywordflow">if</span> (($type != <span class="stringliteral">&#39;text&#39;</span>) AND ($this-&gt;state == 2)) {</div>
<div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;            <span class="keywordflow">if</span> (!$ret) {</div>
<div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($pdfcolor);</div>
<div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;            }</div>
<div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;            <span class="keywordflow">return</span> $pdfcolor;</div>
<div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;        }</div>
<div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;        <span class="keywordflow">return</span> <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;    }</div>
<div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;</div>
<div class="line"><a name="l03988"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a3d0447ea40384cf67763041a55cf6eca"> 3988</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a3d0447ea40384cf67763041a55cf6eca">SetDrawColor</a>($col1=0, $col2=-1, $col3=-1, $col4=-1, $ret=<span class="keyword">false</span>, $name=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;        <span class="keywordflow">return</span> $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8b80c7e5aae2bc717b469eda5ee755fd">setColor</a>(<span class="stringliteral">&#39;draw&#39;</span>, $col1, $col2, $col3, $col4, $ret, $name);</div>
<div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;    }</div>
<div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;</div>
<div class="line"><a name="l04005"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#abad599cd85cc60cbe9cbb7765ccfb535"> 4005</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#abad599cd85cc60cbe9cbb7765ccfb535">SetFillColor</a>($col1=0, $col2=-1, $col3=-1, $col4=-1, $ret=<span class="keyword">false</span>, $name=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;        <span class="keywordflow">return</span> $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8b80c7e5aae2bc717b469eda5ee755fd">setColor</a>(<span class="stringliteral">&#39;fill&#39;</span>, $col1, $col2, $col3, $col4, $ret, $name);</div>
<div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;    }</div>
<div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;</div>
<div class="line"><a name="l04022"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ab1c0ea925d0e76abd0298ebab4f75140"> 4022</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ab1c0ea925d0e76abd0298ebab4f75140">SetTextColor</a>($col1=0, $col2=-1, $col3=-1, $col4=-1, $ret=<span class="keyword">false</span>, $name=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;        <span class="keywordflow">return</span> $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8b80c7e5aae2bc717b469eda5ee755fd">setColor</a>(<span class="stringliteral">&#39;text&#39;</span>, $col1, $col2, $col3, $col4, $ret, $name);</div>
<div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;    }</div>
<div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;</div>
<div class="line"><a name="l04038"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a8075c1f04b6fbddc957cff786c4b16d9"> 4038</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a8075c1f04b6fbddc957cff786c4b16d9">GetStringWidth</a>($s, $fontname=<span class="stringliteral">&#39;&#39;</span>, $fontstyle=<span class="stringliteral">&#39;&#39;</span>, $fontsize=0, $getarray=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;        <span class="keywordflow">return</span> $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#afe09291dfba7203e225a507e71e1d43e">GetArrStringWidth</a>(TCPDF_FONTS::utf8Bidi(TCPDF_FONTS::UTF8StringToArray($s, $this-&gt;isunicode, $this-&gt;CurrentFont), $s, $this-&gt;tmprtl, $this-&gt;isunicode, $this-&gt;CurrentFont), $fontname, $fontstyle, $fontsize, $getarray);</div>
<div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;    }</div>
<div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;</div>
<div class="line"><a name="l04054"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#afe09291dfba7203e225a507e71e1d43e"> 4054</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#afe09291dfba7203e225a507e71e1d43e">GetArrStringWidth</a>($sa, $fontname=<span class="stringliteral">&#39;&#39;</span>, $fontstyle=<span class="stringliteral">&#39;&#39;</span>, $fontsize=0, $getarray=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;        <span class="comment">// store current values</span></div>
<div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;        <span class="keywordflow">if</span> (!TCPDF_STATIC::empty_string($fontname)) {</div>
<div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;            $prev_FontFamily = <a class="code" href="../../d4/d40/classTCPDF.html#a642c62438ec9c983283a98d5099ba7ba">$this-&gt;FontFamily</a>;</div>
<div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;            $prev_FontStyle = <a class="code" href="../../d4/d40/classTCPDF.html#a6fce74bcde6c138d286dce274950dff7">$this-&gt;FontStyle</a>;</div>
<div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;            $prev_FontSizePt = <a class="code" href="../../d4/d40/classTCPDF.html#a9a787786c9f1a04f54f1dec622869d4d">$this-&gt;FontSizePt</a>;</div>
<div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#afd56e360c43553830d543323e81bc045">SetFont</a>($fontname, $fontstyle, $fontsize, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;default&#39;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;        }</div>
<div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;        <span class="comment">// convert UTF-8 array to Latin1 if required</span></div>
<div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;isunicode AND (!$this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a81c8257af5d6d6e40f1bb77d6b507b97">isUnicodeFont</a>())) {</div>
<div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;            $sa = TCPDF_FONTS::UTF8ArrToLatin1Arr($sa);</div>
<div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;        }</div>
<div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = 0; <span class="comment">// total width</span></div>
<div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;        $wa = array(); <span class="comment">// array of characters widths</span></div>
<div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;        <span class="keywordflow">foreach</span> ($sa as $ck =&gt; $char) {</div>
<div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;            <span class="comment">// character width</span></div>
<div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;            $cw = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a281f922889bd1ae2dc96e421042ad8e4">GetCharWidth</a>($char, isset($sa[($ck + 1)]));</div>
<div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;            $wa[] = $cw;</div>
<div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> += $cw;</div>
<div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;        }</div>
<div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;        <span class="comment">// restore previous values</span></div>
<div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;        <span class="keywordflow">if</span> (!TCPDF_STATIC::empty_string($fontname)) {</div>
<div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#afd56e360c43553830d543323e81bc045">SetFont</a>($prev_FontFamily, $prev_FontStyle, $prev_FontSizePt, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;default&#39;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;        }</div>
<div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;        <span class="keywordflow">if</span> ($getarray) {</div>
<div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;            <span class="keywordflow">return</span> $wa;</div>
<div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;        }</div>
<div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>;</div>
<div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;    }</div>
<div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;</div>
<div class="line"><a name="l04093"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a281f922889bd1ae2dc96e421042ad8e4"> 4093</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a281f922889bd1ae2dc96e421042ad8e4">GetCharWidth</a>($char, $notlast=<span class="keyword">true</span>) {</div>
<div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;        <span class="comment">// get raw width</span></div>
<div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;        $chw = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af484c6dc7debd34e2310f9f391448de7">getRawCharWidth</a>($char);</div>
<div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;        <span class="keywordflow">if</span> (($this-&gt;font_spacing &lt; 0) OR (($this-&gt;font_spacing &gt; 0) AND $notlast)) {</div>
<div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;            <span class="comment">// increase/decrease font spacing</span></div>
<div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;            $chw += <a class="code" href="../../d4/d40/classTCPDF.html#a3f4d91c3489a2c62b628c347551f7adf">$this-&gt;font_spacing</a>;</div>
<div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;        }</div>
<div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;font_stretching != 100) {</div>
<div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;            <span class="comment">// fixed stretching mode</span></div>
<div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;            $chw *= ($this-&gt;font_stretching / 100);</div>
<div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;        }</div>
<div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;        <span class="keywordflow">return</span> $chw;</div>
<div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;    }</div>
<div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;</div>
<div class="line"><a name="l04115"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#af484c6dc7debd34e2310f9f391448de7"> 4115</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#af484c6dc7debd34e2310f9f391448de7">getRawCharWidth</a>($char) {</div>
<div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;        <span class="keywordflow">if</span> ($char == 173) {</div>
<div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;            <span class="comment">// SHY character will not be printed</span></div>
<div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;            <span class="keywordflow">return</span> (0);</div>
<div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;        }</div>
<div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;CurrentFont[<span class="stringliteral">&#39;cw&#39;</span>][$char])) {</div>
<div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = $this-&gt;CurrentFont[<span class="stringliteral">&#39;cw&#39;</span>][$char];</div>
<div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;        } elseif (isset($this-&gt;CurrentFont[<span class="stringliteral">&#39;dw&#39;</span>])) {</div>
<div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;            <span class="comment">// default width</span></div>
<div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = $this-&gt;CurrentFont[<span class="stringliteral">&#39;dw&#39;</span>];</div>
<div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;        } elseif (isset($this-&gt;CurrentFont[<span class="stringliteral">&#39;cw&#39;</span>][32])) {</div>
<div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;            <span class="comment">// default width</span></div>
<div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = $this-&gt;CurrentFont[<span class="stringliteral">&#39;cw&#39;</span>][32];</div>
<div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = 600;</div>
<div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;        }</div>
<div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;        <span class="keywordflow">return</span> $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a2ade1952794fe6eb23191314fd74550c">getAbsFontMeasure</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>);</div>
<div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;    }</div>
<div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;</div>
<div class="line"><a name="l04141"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ac9dc6318fd217971aff282532ab91e43"> 4141</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ac9dc6318fd217971aff282532ab91e43">GetNumChars</a>($s) {</div>
<div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a81c8257af5d6d6e40f1bb77d6b507b97">isUnicodeFont</a>()) {</div>
<div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;            <span class="keywordflow">return</span> count(TCPDF_FONTS::UTF8StringToArray($s, $this-&gt;isunicode, $this-&gt;CurrentFont));</div>
<div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;        }</div>
<div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;        <span class="keywordflow">return</span> strlen($s);</div>
<div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;    }</div>
<div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;</div>
<div class="line"><a name="l04153"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ae87d16aa348205f2a1654cc2ac42367c"> 4153</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ae87d16aa348205f2a1654cc2ac42367c">getFontsList</a>() {</div>
<div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;        <span class="keywordflow">if</span> (($fontsdir = opendir(TCPDF_FONTS::_getfontpath())) !== <span class="keyword">false</span>) {</div>
<div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;            <span class="keywordflow">while</span> (($file = readdir($fontsdir)) !== <span class="keyword">false</span>) {</div>
<div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;                <span class="keywordflow">if</span> (substr($file, -4) == <span class="stringliteral">&#39;.php&#39;</span>) {</div>
<div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;                    array_push($this-&gt;fontlist, strtolower(basename($file, <span class="stringliteral">&#39;.php&#39;</span>)));</div>
<div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;                }</div>
<div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;            }</div>
<div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;            closedir($fontsdir);</div>
<div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;        }</div>
<div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;    }</div>
<div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;</div>
<div class="line"><a name="l04172"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a7d007815ed4a9c0aa036f6de09e81c3b"> 4172</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a7d007815ed4a9c0aa036f6de09e81c3b">unichr</a>($c) {</div>
<div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;        <span class="keywordflow">return</span> TCPDF_FONTS::unichr($c, $this-&gt;isunicode);</div>
<div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;    }</div>
<div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;</div>
<div class="line"><a name="l04192"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a471562985997be1573d387f0aeae6964"> 4192</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a471562985997be1573d387f0aeae6964">addTTFfont</a>($fontfile, $fonttype=<span class="stringliteral">&#39;&#39;</span>, $enc=<span class="stringliteral">&#39;&#39;</span>, $flags=32, $outpath=<span class="stringliteral">&#39;&#39;</span>, $platid=3, $encid=1, $addcbbox=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;        <span class="keywordflow">return</span> TCPDF_FONTS::addTTFfont($fontfile, $fonttype, $enc, $flags, $outpath, $platid, $encid, $addcbbox);</div>
<div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;    }</div>
<div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;</div>
<div class="line"><a name="l04209"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a06cba4fc5e83b02bb37a947e56196776"> 4209</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a06cba4fc5e83b02bb37a947e56196776">AddFont</a>($family, $style=<span class="stringliteral">&#39;&#39;</span>, $fontfile=<span class="stringliteral">&#39;&#39;</span>, $subset=<span class="stringliteral">&#39;default&#39;</span>) {</div>
<div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;        <span class="keywordflow">if</span> ($subset === <span class="stringliteral">&#39;default&#39;</span>) {</div>
<div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;            $subset = <a class="code" href="../../d4/d40/classTCPDF.html#ad12417c3708effd84de35320ac10077a">$this-&gt;font_subsetting</a>;</div>
<div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;        }</div>
<div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;pdfa_mode) {</div>
<div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;            $subset = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;        }</div>
<div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;        <span class="keywordflow">if</span> (TCPDF_STATIC::empty_string($family)) {</div>
<div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;            <span class="keywordflow">if</span> (!TCPDF_STATIC::empty_string($this-&gt;FontFamily)) {</div>
<div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;                $family = <a class="code" href="../../d4/d40/classTCPDF.html#a642c62438ec9c983283a98d5099ba7ba">$this-&gt;FontFamily</a>;</div>
<div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;Empty font family&#39;</span>);</div>
<div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;            }</div>
<div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;        }</div>
<div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;        <span class="comment">// move embedded styles on $style</span></div>
<div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;        <span class="keywordflow">if</span> (substr($family, -1) == <span class="charliteral">&#39;I&#39;</span>) {</div>
<div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;            $style .= <span class="charliteral">&#39;I&#39;</span>;</div>
<div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;            $family = substr($family, 0, -1);</div>
<div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;        }</div>
<div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;        <span class="keywordflow">if</span> (substr($family, -1) == <span class="charliteral">&#39;B&#39;</span>) {</div>
<div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;            $style .= <span class="charliteral">&#39;B&#39;</span>;</div>
<div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;            $family = substr($family, 0, -1);</div>
<div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;        }</div>
<div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;        <span class="comment">// normalize family name</span></div>
<div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;        $family = strtolower($family);</div>
<div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;        <span class="keywordflow">if</span> ((!$this-&gt;isunicode) AND ($family == <span class="stringliteral">&#39;arial&#39;</span>)) {</div>
<div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;            $family = <span class="stringliteral">&#39;helvetica&#39;</span>;</div>
<div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;        }</div>
<div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;        <span class="keywordflow">if</span> (($family == <span class="stringliteral">&#39;symbol&#39;</span>) OR ($family == <span class="stringliteral">&#39;zapfdingbats&#39;</span>)) {</div>
<div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;            $style = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;        }</div>
<div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;pdfa_mode AND (isset($this-&gt;CoreFonts[$family]))) {</div>
<div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;            <span class="comment">// all fonts must be embedded</span></div>
<div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;            $family = <span class="stringliteral">&#39;pdfa&#39;</span>.$family;</div>
<div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;        }</div>
<div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;        $tempstyle = strtoupper($style);</div>
<div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;        $style = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;        <span class="comment">// underline</span></div>
<div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;        <span class="keywordflow">if</span> (strpos($tempstyle, <span class="charliteral">&#39;U&#39;</span>) !== <span class="keyword">false</span>) {</div>
<div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;            $this-&gt;underline = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;            $this-&gt;underline = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;        }</div>
<div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;        <span class="comment">// line-through (deleted)</span></div>
<div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;        <span class="keywordflow">if</span> (strpos($tempstyle, <span class="charliteral">&#39;D&#39;</span>) !== <span class="keyword">false</span>) {</div>
<div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;            $this-&gt;linethrough = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;            $this-&gt;linethrough = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;        }</div>
<div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;        <span class="comment">// overline</span></div>
<div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;        <span class="keywordflow">if</span> (strpos($tempstyle, <span class="charliteral">&#39;O&#39;</span>) !== <span class="keyword">false</span>) {</div>
<div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;            $this-&gt;overline = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;            $this-&gt;overline = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;        }</div>
<div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;        <span class="comment">// bold</span></div>
<div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;        <span class="keywordflow">if</span> (strpos($tempstyle, <span class="charliteral">&#39;B&#39;</span>) !== <span class="keyword">false</span>) {</div>
<div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;            $style .= <span class="charliteral">&#39;B&#39;</span>;</div>
<div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;        }</div>
<div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;        <span class="comment">// oblique</span></div>
<div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;        <span class="keywordflow">if</span> (strpos($tempstyle, <span class="charliteral">&#39;I&#39;</span>) !== <span class="keyword">false</span>) {</div>
<div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;            $style .= <span class="charliteral">&#39;I&#39;</span>;</div>
<div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;        }</div>
<div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;        $bistyle = $style;</div>
<div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;        $fontkey = $family.$style;</div>
<div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;        $font_style = $style.($this-&gt;underline ? <span class="charliteral">&#39;U&#39;</span> : <span class="stringliteral">&#39;&#39;</span>).($this-&gt;linethrough ? <span class="charliteral">&#39;D&#39;</span> : <span class="stringliteral">&#39;&#39;</span>).($this-&gt;overline ? <span class="charliteral">&#39;O&#39;</span> : <span class="stringliteral">&#39;&#39;</span>);</div>
<div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;        $fontdata = array(<span class="stringliteral">&#39;fontkey&#39;</span> =&gt; $fontkey, <span class="stringliteral">&#39;family&#39;</span> =&gt; $family, <span class="stringliteral">&#39;style&#39;</span> =&gt; $font_style);</div>
<div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;        <span class="comment">// check if the font has been already added</span></div>
<div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;        $fb = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac63fff093a17846764bbcc09af7c8640">getFontBuffer</a>($fontkey);</div>
<div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;        <span class="keywordflow">if</span> ($fb !== <span class="keyword">false</span>) {</div>
<div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;inxobj) {</div>
<div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;                <span class="comment">// we are inside an XObject template</span></div>
<div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;                $this-&gt;xobjects[<a class="code" href="../../d4/d40/classTCPDF.html#abe4390b4e1939e10c9b61a986adfc117">$this-&gt;xobjid</a>][<span class="stringliteral">&#39;fonts&#39;</span>][$fontkey] = $fb[<span class="charliteral">&#39;i&#39;</span>];</div>
<div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;            }</div>
<div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;            <span class="keywordflow">return</span> $fontdata;</div>
<div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;        }</div>
<div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;        <span class="comment">// get specified font directory (if any)</span></div>
<div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;        $fontdir = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;        <span class="keywordflow">if</span> (!TCPDF_STATIC::empty_string($fontfile)) {</div>
<div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;            $fontdir = dirname($fontfile);</div>
<div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;            <span class="keywordflow">if</span> (TCPDF_STATIC::empty_string($fontdir) OR ($fontdir == <span class="charliteral">&#39;.&#39;</span>)) {</div>
<div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;                $fontdir = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;                $fontdir .= <span class="charliteral">&#39;/&#39;</span>;</div>
<div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;            }</div>
<div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;        }</div>
<div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;        <span class="comment">// true when the font style variation is missing</span></div>
<div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;        $missing_style = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;        <span class="comment">// search and include font file</span></div>
<div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;        <span class="keywordflow">if</span> (TCPDF_STATIC::empty_string($fontfile) OR (!@file_exists($fontfile))) {</div>
<div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;            <span class="comment">// build a standard filenames for specified font</span></div>
<div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;            $tmp_fontfile = str_replace(<span class="charliteral">&#39; &#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $family).strtolower($style).<span class="stringliteral">&#39;.php&#39;</span>;</div>
<div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;            $fontfile = TCPDF_FONTS::getFontFullPath($tmp_fontfile, $fontdir);</div>
<div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;            <span class="keywordflow">if</span> (TCPDF_STATIC::empty_string($fontfile)) {</div>
<div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;                $missing_style = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;                <span class="comment">// try to remove the style part</span></div>
<div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;                $tmp_fontfile = str_replace(<span class="charliteral">&#39; &#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $family).<span class="stringliteral">&#39;.php&#39;</span>;</div>
<div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;                $fontfile = TCPDF_FONTS::getFontFullPath($tmp_fontfile, $fontdir);</div>
<div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;            }</div>
<div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;        }</div>
<div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;        <span class="comment">// include font file</span></div>
<div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;        <span class="keywordflow">if</span> (!TCPDF_STATIC::empty_string($fontfile) AND (@file_exists($fontfile))) {</div>
<div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;            include($fontfile);</div>
<div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;Could not include font definition file: &#39;</span>.$family.<span class="stringliteral">&#39;&#39;</span>);</div>
<div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;        }</div>
<div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;        <span class="comment">// check font parameters</span></div>
<div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;        <span class="keywordflow">if</span> ((!isset($type)) OR (!isset($cw))) {</div>
<div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;The font definition file has a bad format: &#39;</span>.$fontfile.<span class="stringliteral">&#39;&#39;</span>);</div>
<div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;        }</div>
<div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;        <span class="comment">// SET default parameters</span></div>
<div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;        <span class="keywordflow">if</span> (!isset($file) OR TCPDF_STATIC::empty_string($file)) {</div>
<div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;            $file = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;        }</div>
<div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;        <span class="keywordflow">if</span> (!isset($enc) OR TCPDF_STATIC::empty_string($enc)) {</div>
<div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;            $enc = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;        }</div>
<div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;        <span class="keywordflow">if</span> (!isset($cidinfo) OR TCPDF_STATIC::empty_string($cidinfo)) {</div>
<div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;            $cidinfo = array(<span class="stringliteral">&#39;Registry&#39;</span>=&gt;<span class="stringliteral">&#39;Adobe&#39;</span>, <span class="stringliteral">&#39;Ordering&#39;</span>=&gt;<span class="stringliteral">&#39;Identity&#39;</span>, <span class="stringliteral">&#39;Supplement&#39;</span>=&gt;0);</div>
<div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;            $cidinfo[<span class="stringliteral">&#39;uni2cid&#39;</span>] = array();</div>
<div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;        }</div>
<div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;        <span class="keywordflow">if</span> (!isset($ctg) OR TCPDF_STATIC::empty_string($ctg)) {</div>
<div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;            $ctg = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;        }</div>
<div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;        <span class="keywordflow">if</span> (!isset($desc) OR TCPDF_STATIC::empty_string($desc)) {</div>
<div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;            $desc = array();</div>
<div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;        }</div>
<div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;        <span class="keywordflow">if</span> (!isset($up) OR TCPDF_STATIC::empty_string($up)) {</div>
<div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;            $up = -100;</div>
<div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;        }</div>
<div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;        <span class="keywordflow">if</span> (!isset($ut) OR TCPDF_STATIC::empty_string($ut)) {</div>
<div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;            $ut = 50;</div>
<div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;        }</div>
<div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;        <span class="keywordflow">if</span> (!isset($cw) OR TCPDF_STATIC::empty_string($cw)) {</div>
<div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;            $cw = array();</div>
<div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;        }</div>
<div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;        <span class="keywordflow">if</span> (!isset($dw) OR TCPDF_STATIC::empty_string($dw)) {</div>
<div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;            <span class="comment">// set default width</span></div>
<div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;            <span class="keywordflow">if</span> (isset($desc[<span class="stringliteral">&#39;MissingWidth&#39;</span>]) AND ($desc[<span class="stringliteral">&#39;MissingWidth&#39;</span>] &gt; 0)) {</div>
<div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;                $dw = $desc[<span class="stringliteral">&#39;MissingWidth&#39;</span>];</div>
<div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;            } elseif (isset($cw[32])) {</div>
<div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;                $dw = $cw[32];</div>
<div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;                $dw = 600;</div>
<div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;            }</div>
<div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;        }</div>
<div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;        ++<a class="code" href="../../d4/d40/classTCPDF.html#abe8ea9785cede5c50969a8c2a37aae84">$this-&gt;numfonts</a>;</div>
<div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;        <span class="keywordflow">if</span> ($type == <span class="stringliteral">&#39;core&#39;</span>) {</div>
<div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;            $name = $this-&gt;CoreFonts[$fontkey];</div>
<div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;            $subset = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;        } elseif (($type == <span class="stringliteral">&#39;TrueType&#39;</span>) OR ($type == <span class="stringliteral">&#39;Type1&#39;</span>)) {</div>
<div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;            $subset = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;        } elseif ($type == <span class="stringliteral">&#39;TrueTypeUnicode&#39;</span>) {</div>
<div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;            $enc = <span class="stringliteral">&#39;Identity-H&#39;</span>;</div>
<div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;        } elseif ($type == <span class="stringliteral">&#39;cidfont0&#39;</span>) {</div>
<div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;pdfa_mode) {</div>
<div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;All fonts must be embedded in PDF/A mode!&#39;</span>);</div>
<div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;            }</div>
<div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;Unknow font type: &#39;</span>.$type.<span class="stringliteral">&#39;&#39;</span>);</div>
<div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;        }</div>
<div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;        <span class="comment">// set name if unset</span></div>
<div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;        <span class="keywordflow">if</span> (!isset($name) OR empty($name)) {</div>
<div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;            $name = $fontkey;</div>
<div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;        }</div>
<div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;        <span class="comment">// create artificial font style variations if missing (only works with non-embedded fonts)</span></div>
<div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;        <span class="keywordflow">if</span> (($type != <span class="stringliteral">&#39;core&#39;</span>) AND $missing_style) {</div>
<div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;            <span class="comment">// style variations</span></div>
<div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;            $styles = array(<span class="stringliteral">&#39;&#39;</span> =&gt; <span class="stringliteral">&#39;&#39;</span>, <span class="charliteral">&#39;B&#39;</span> =&gt; <span class="stringliteral">&#39;,Bold&#39;</span>, <span class="charliteral">&#39;I&#39;</span> =&gt; <span class="stringliteral">&#39;,Italic&#39;</span>, <span class="stringliteral">&#39;BI&#39;</span> =&gt; <span class="stringliteral">&#39;,BoldItalic&#39;</span>);</div>
<div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;            $name .= $styles[$bistyle];</div>
<div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;            <span class="comment">// artificial bold</span></div>
<div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;            <span class="keywordflow">if</span> (strpos($bistyle, <span class="charliteral">&#39;B&#39;</span>) !== <span class="keyword">false</span>) {</div>
<div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;                <span class="keywordflow">if</span> (isset($desc[<span class="stringliteral">&#39;StemV&#39;</span>])) {</div>
<div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;                    <span class="comment">// from normal to bold</span></div>
<div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;                    $desc[<span class="stringliteral">&#39;StemV&#39;</span>] = round($desc[<span class="stringliteral">&#39;StemV&#39;</span>] * 1.75);</div>
<div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;                    <span class="comment">// bold</span></div>
<div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;                    $desc[<span class="stringliteral">&#39;StemV&#39;</span>] = 123;</div>
<div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;                }</div>
<div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;            }</div>
<div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160;            <span class="comment">// artificial italic</span></div>
<div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;            <span class="keywordflow">if</span> (strpos($bistyle, <span class="charliteral">&#39;I&#39;</span>) !== <span class="keyword">false</span>) {</div>
<div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;                <span class="keywordflow">if</span> (isset($desc[<span class="stringliteral">&#39;ItalicAngle&#39;</span>])) {</div>
<div class="line"><a name="l04392"></a><span class="lineno"> 4392</span>&#160;                    $desc[<span class="stringliteral">&#39;ItalicAngle&#39;</span>] -= 11;</div>
<div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;                    $desc[<span class="stringliteral">&#39;ItalicAngle&#39;</span>] = -11;</div>
<div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;                }</div>
<div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;                <span class="keywordflow">if</span> (isset($desc[<span class="stringliteral">&#39;Flags&#39;</span>])) {</div>
<div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;                    $desc[<span class="stringliteral">&#39;Flags&#39;</span>] |= 64; <span class="comment">//bit 7</span></div>
<div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;                    $desc[<span class="stringliteral">&#39;Flags&#39;</span>] = 64;</div>
<div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;                }</div>
<div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;            }</div>
<div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;        }</div>
<div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;        <span class="comment">// check if the array of characters bounding boxes is defined</span></div>
<div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;        <span class="keywordflow">if</span> (!isset($cbbox)) {</div>
<div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;            $cbbox = array();</div>
<div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;        }</div>
<div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;        <span class="comment">// initialize subsetchars</span></div>
<div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;        $subsetchars = array_fill(0, 255, <span class="keyword">true</span>);</div>
<div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa9eb763490acb3dfdf3f0cf445e83ca6">setFontBuffer</a>($fontkey, array(<span class="stringliteral">&#39;fontkey&#39;</span> =&gt; $fontkey, <span class="charliteral">&#39;i&#39;</span> =&gt; $this-&gt;numfonts, <span class="stringliteral">&#39;type&#39;</span> =&gt; $type, <span class="stringliteral">&#39;name&#39;</span> =&gt; $name, <span class="stringliteral">&#39;desc&#39;</span> =&gt; $desc, <span class="stringliteral">&#39;up&#39;</span> =&gt; $up, <span class="stringliteral">&#39;ut&#39;</span> =&gt; $ut, <span class="stringliteral">&#39;cw&#39;</span> =&gt; $cw, <span class="stringliteral">&#39;cbbox&#39;</span> =&gt; $cbbox, <span class="stringliteral">&#39;dw&#39;</span> =&gt; $dw, <span class="stringliteral">&#39;enc&#39;</span> =&gt; $enc, <span class="stringliteral">&#39;cidinfo&#39;</span> =&gt; $cidinfo, <span class="stringliteral">&#39;file&#39;</span> =&gt; $file, <span class="stringliteral">&#39;ctg&#39;</span> =&gt; $ctg, <span class="stringliteral">&#39;subset&#39;</span> =&gt; $subset, <span class="stringliteral">&#39;subsetchars&#39;</span> =&gt; $subsetchars));</div>
<div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;inxobj) {</div>
<div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;            <span class="comment">// we are inside an XObject template</span></div>
<div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;            $this-&gt;xobjects[<a class="code" href="../../d4/d40/classTCPDF.html#abe4390b4e1939e10c9b61a986adfc117">$this-&gt;xobjid</a>][<span class="stringliteral">&#39;fonts&#39;</span>][$fontkey] = <a class="code" href="../../d4/d40/classTCPDF.html#abe8ea9785cede5c50969a8c2a37aae84">$this-&gt;numfonts</a>;</div>
<div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;        }</div>
<div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160;        <span class="keywordflow">if</span> (isset($diff) AND (!empty($diff))) {</div>
<div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160;            <span class="comment">//Search existing encodings</span></div>
<div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;            $d = 0;</div>
<div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;            $nb = count($this-&gt;diffs);</div>
<div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;            <span class="keywordflow">for</span> ($i=1; $i &lt;= $nb; ++$i) {</div>
<div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;diffs[$i] == $diff) {</div>
<div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;                    $d = $i;</div>
<div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160;                }</div>
<div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160;            }</div>
<div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;            <span class="keywordflow">if</span> ($d == 0) {</div>
<div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;                $d = $nb + 1;</div>
<div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160;                $this-&gt;diffs[$d] = $diff;</div>
<div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160;            }</div>
<div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac6009bf1f27a31ee208d9687cb4b91eb">setFontSubBuffer</a>($fontkey, <span class="stringliteral">&#39;diff&#39;</span>, $d);</div>
<div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;        }</div>
<div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160;        <span class="keywordflow">if</span> (!TCPDF_STATIC::empty_string($file)) {</div>
<div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;            <span class="keywordflow">if</span> (!isset($this-&gt;FontFiles[$file])) {</div>
<div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;                <span class="keywordflow">if</span> ((strcasecmp($type,<span class="stringliteral">&#39;TrueType&#39;</span>) == 0) OR (strcasecmp($type, <span class="stringliteral">&#39;TrueTypeUnicode&#39;</span>) == 0)) {</div>
<div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;                    $this-&gt;FontFiles[$file] = array(<span class="stringliteral">&#39;length1&#39;</span> =&gt; $originalsize, <span class="stringliteral">&#39;fontdir&#39;</span> =&gt; $fontdir, <span class="stringliteral">&#39;subset&#39;</span> =&gt; $subset, <span class="stringliteral">&#39;fontkeys&#39;</span> =&gt; array($fontkey));</div>
<div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;                } elseif ($type != <span class="stringliteral">&#39;core&#39;</span>) {</div>
<div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;                    $this-&gt;FontFiles[$file] = array(<span class="stringliteral">&#39;length1&#39;</span> =&gt; $size1, <span class="stringliteral">&#39;length2&#39;</span> =&gt; $size2, <span class="stringliteral">&#39;fontdir&#39;</span> =&gt; $fontdir, <span class="stringliteral">&#39;subset&#39;</span> =&gt; $subset, <span class="stringliteral">&#39;fontkeys&#39;</span> =&gt; array($fontkey));</div>
<div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;                }</div>
<div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;                <span class="comment">// update fontkeys that are sharing this font file</span></div>
<div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;                $this-&gt;FontFiles[$file][<span class="stringliteral">&#39;subset&#39;</span>] = ($this-&gt;FontFiles[$file][<span class="stringliteral">&#39;subset&#39;</span>] AND $subset);</div>
<div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;                <span class="keywordflow">if</span> (!in_array($fontkey, $this-&gt;FontFiles[$file][<span class="stringliteral">&#39;fontkeys&#39;</span>])) {</div>
<div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;                    $this-&gt;FontFiles[$file][<span class="stringliteral">&#39;fontkeys&#39;</span>][] = $fontkey;</div>
<div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;                }</div>
<div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;            }</div>
<div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;        }</div>
<div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;        <span class="keywordflow">return</span> $fontdata;</div>
<div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;    }</div>
<div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;</div>
<div class="line"><a name="l04465"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#afd56e360c43553830d543323e81bc045"> 4465</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#afd56e360c43553830d543323e81bc045">SetFont</a>($family, $style=<span class="stringliteral">&#39;&#39;</span>, $size=null, $fontfile=<span class="stringliteral">&#39;&#39;</span>, $subset=<span class="stringliteral">&#39;default&#39;</span>, $out=<span class="keyword">true</span>) {</div>
<div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;        <span class="comment">//Select a font; size given in points</span></div>
<div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;        <span class="keywordflow">if</span> ($size === null) {</div>
<div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;            $size = <a class="code" href="../../d4/d40/classTCPDF.html#a9a787786c9f1a04f54f1dec622869d4d">$this-&gt;FontSizePt</a>;</div>
<div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160;        }</div>
<div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;        <span class="keywordflow">if</span> ($size &lt; 0) {</div>
<div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;            $size = 0;</div>
<div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;        }</div>
<div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;        <span class="comment">// try to add font (if not already added)</span></div>
<div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160;        $fontdata = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a06cba4fc5e83b02bb37a947e56196776">AddFont</a>($family, $style, $fontfile, $subset);</div>
<div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;        $this-&gt;FontFamily = $fontdata[<span class="stringliteral">&#39;family&#39;</span>];</div>
<div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160;        $this-&gt;FontStyle = $fontdata[<span class="stringliteral">&#39;style&#39;</span>];</div>
<div class="line"><a name="l04477"></a><span class="lineno"> 4477</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;CurrentFont[<span class="stringliteral">&#39;fontkey&#39;</span>]) AND isset($this-&gt;CurrentFont[<span class="stringliteral">&#39;subsetchars&#39;</span>])) {</div>
<div class="line"><a name="l04478"></a><span class="lineno"> 4478</span>&#160;            <span class="comment">// save subset chars of the previous font</span></div>
<div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac6009bf1f27a31ee208d9687cb4b91eb">setFontSubBuffer</a>($this-&gt;CurrentFont[<span class="stringliteral">&#39;fontkey&#39;</span>], <span class="stringliteral">&#39;subsetchars&#39;</span>, $this-&gt;CurrentFont[<span class="stringliteral">&#39;subsetchars&#39;</span>]);</div>
<div class="line"><a name="l04480"></a><span class="lineno"> 4480</span>&#160;        }</div>
<div class="line"><a name="l04481"></a><span class="lineno"> 4481</span>&#160;        $this-&gt;CurrentFont = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac63fff093a17846764bbcc09af7c8640">getFontBuffer</a>($fontdata[<span class="stringliteral">&#39;fontkey&#39;</span>]);</div>
<div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a6df400b01d3ec1579e1e925b98c31d5f">SetFontSize</a>($size, $out);</div>
<div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160;    }</div>
<div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;</div>
<div class="line"><a name="l04493"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a6df400b01d3ec1579e1e925b98c31d5f"> 4493</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a6df400b01d3ec1579e1e925b98c31d5f">SetFontSize</a>($size, $out=<span class="keyword">true</span>) {</div>
<div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160;        <span class="comment">// font size in points</span></div>
<div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;        $this-&gt;FontSizePt = $size;</div>
<div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;        <span class="comment">// font size in user units</span></div>
<div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;        $this-&gt;FontSize = $size / <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>;</div>
<div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;        <span class="comment">// calculate some font metrics</span></div>
<div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;CurrentFont[<span class="stringliteral">&#39;desc&#39;</span>][<span class="stringliteral">&#39;FontBBox&#39;</span>])) {</div>
<div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;            $bbox = explode(<span class="charliteral">&#39; &#39;</span>, substr($this-&gt;CurrentFont[<span class="stringliteral">&#39;desc&#39;</span>][<span class="stringliteral">&#39;FontBBox&#39;</span>], 1, -1));</div>
<div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;            $font_height = ((intval($bbox[3]) - intval($bbox[1])) * $size / 1000);</div>
<div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160;            $font_height = $size * 1.219;</div>
<div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160;        }</div>
<div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;CurrentFont[<span class="stringliteral">&#39;desc&#39;</span>][<span class="stringliteral">&#39;Ascent&#39;</span>]) AND ($this-&gt;CurrentFont[<span class="stringliteral">&#39;desc&#39;</span>][<span class="stringliteral">&#39;Ascent&#39;</span>] &gt; 0)) {</div>
<div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160;            $font_ascent = ($this-&gt;CurrentFont[<span class="stringliteral">&#39;desc&#39;</span>][<span class="stringliteral">&#39;Ascent&#39;</span>] * $size / 1000);</div>
<div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160;        }</div>
<div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;CurrentFont[<span class="stringliteral">&#39;desc&#39;</span>][<span class="stringliteral">&#39;Descent&#39;</span>]) AND ($this-&gt;CurrentFont[<span class="stringliteral">&#39;desc&#39;</span>][<span class="stringliteral">&#39;Descent&#39;</span>] &lt;= 0)) {</div>
<div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;            $font_descent = (- $this-&gt;CurrentFont[<span class="stringliteral">&#39;desc&#39;</span>][<span class="stringliteral">&#39;Descent&#39;</span>] * $size / 1000);</div>
<div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;        }</div>
<div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160;        <span class="keywordflow">if</span> (!isset($font_ascent) AND !isset($font_descent)) {</div>
<div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;            <span class="comment">// core font</span></div>
<div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160;            $font_ascent = 0.76 * $font_height;</div>
<div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160;            $font_descent = $font_height - $font_ascent;</div>
<div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160;        } elseif (!isset($font_descent)) {</div>
<div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160;            $font_descent = $font_height - $font_ascent;</div>
<div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;        } elseif (!isset($font_ascent)) {</div>
<div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;            $font_ascent = $font_height - $font_descent;</div>
<div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160;        }</div>
<div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160;        $this-&gt;FontAscent = ($font_ascent / <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>);</div>
<div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160;        $this-&gt;FontDescent = ($font_descent / <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>);</div>
<div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160;        <span class="keywordflow">if</span> ($out AND ($this-&gt;page &gt; 0) AND (isset($this-&gt;CurrentFont[<span class="charliteral">&#39;i&#39;</span>])) AND ($this-&gt;state == 2)) {</div>
<div class="line"><a name="l04523"></a><span class="lineno"> 4523</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(sprintf(<span class="stringliteral">&#39;BT /F%d %F Tf ET&#39;</span>, $this-&gt;CurrentFont[<span class="charliteral">&#39;i&#39;</span>], $this-&gt;FontSizePt));</div>
<div class="line"><a name="l04524"></a><span class="lineno"> 4524</span>&#160;        }</div>
<div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160;    }</div>
<div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;</div>
<div class="line"><a name="l04533"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a0dba58ac6400cc0701127487b4e8dcf4"> 4533</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a0dba58ac6400cc0701127487b4e8dcf4">getFontBBox</a>() {</div>
<div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;        $fbbox = array();</div>
<div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;CurrentFont[<span class="stringliteral">&#39;desc&#39;</span>][<span class="stringliteral">&#39;FontBBox&#39;</span>])) {</div>
<div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;            $tmpbbox = explode(<span class="charliteral">&#39; &#39;</span>, substr($this-&gt;CurrentFont[<span class="stringliteral">&#39;desc&#39;</span>][<span class="stringliteral">&#39;FontBBox&#39;</span>], 1, -1));</div>
<div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;            $fbbox = array_map(array($this,<span class="stringliteral">&#39;getAbsFontMeasure&#39;</span>), $tmpbbox);</div>
<div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160;            <span class="comment">// Find max width</span></div>
<div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;            <span class="keywordflow">if</span> (isset($this-&gt;CurrentFont[<span class="stringliteral">&#39;desc&#39;</span>][<span class="stringliteral">&#39;MaxWidth&#39;</span>])) {</div>
<div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160;                $maxw = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a2ade1952794fe6eb23191314fd74550c">getAbsFontMeasure</a>(intval($this-&gt;CurrentFont[<span class="stringliteral">&#39;desc&#39;</span>][<span class="stringliteral">&#39;MaxWidth&#39;</span>]));</div>
<div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160;                $maxw = 0;</div>
<div class="line"><a name="l04544"></a><span class="lineno"> 4544</span>&#160;                <span class="keywordflow">if</span> (isset($this-&gt;CurrentFont[<span class="stringliteral">&#39;desc&#39;</span>][<span class="stringliteral">&#39;MissingWidth&#39;</span>])) {</div>
<div class="line"><a name="l04545"></a><span class="lineno"> 4545</span>&#160;                    $maxw = max($maxw, $this-&gt;CurrentFont[<span class="stringliteral">&#39;desc&#39;</span>][<span class="stringliteral">&#39;MissingWidth&#39;</span>]);</div>
<div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160;                }</div>
<div class="line"><a name="l04547"></a><span class="lineno"> 4547</span>&#160;                <span class="keywordflow">if</span> (isset($this-&gt;CurrentFont[<span class="stringliteral">&#39;desc&#39;</span>][<span class="stringliteral">&#39;AvgWidth&#39;</span>])) {</div>
<div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;                    $maxw = max($maxw, $this-&gt;CurrentFont[<span class="stringliteral">&#39;desc&#39;</span>][<span class="stringliteral">&#39;AvgWidth&#39;</span>]);</div>
<div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;                }</div>
<div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160;                <span class="keywordflow">if</span> (isset($this-&gt;CurrentFont[<span class="stringliteral">&#39;dw&#39;</span>])) {</div>
<div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;                    $maxw = max($maxw, $this-&gt;CurrentFont[<span class="stringliteral">&#39;dw&#39;</span>]);</div>
<div class="line"><a name="l04552"></a><span class="lineno"> 4552</span>&#160;                }</div>
<div class="line"><a name="l04553"></a><span class="lineno"> 4553</span>&#160;                <span class="keywordflow">foreach</span> ($this-&gt;CurrentFont[<span class="stringliteral">&#39;cw&#39;</span>] as $char =&gt; <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>) {</div>
<div class="line"><a name="l04554"></a><span class="lineno"> 4554</span>&#160;                    $maxw = max($maxw, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>);</div>
<div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160;                }</div>
<div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160;                <span class="keywordflow">if</span> ($maxw == 0) {</div>
<div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160;                    $maxw = 600;</div>
<div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;                }</div>
<div class="line"><a name="l04559"></a><span class="lineno"> 4559</span>&#160;                $maxw = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a2ade1952794fe6eb23191314fd74550c">getAbsFontMeasure</a>($maxw);</div>
<div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;            }</div>
<div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;            $fbbox = array(0, (0 - $this-&gt;FontDescent), $maxw, $this-&gt;FontAscent);</div>
<div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160;        }</div>
<div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;        <span class="keywordflow">return</span> $fbbox;</div>
<div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160;    }</div>
<div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;</div>
<div class="line"><a name="l04572"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a2ade1952794fe6eb23191314fd74550c"> 4572</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a2ade1952794fe6eb23191314fd74550c">getAbsFontMeasure</a>($s) {</div>
<div class="line"><a name="l04573"></a><span class="lineno"> 4573</span>&#160;        <span class="keywordflow">return</span> ($s * $this-&gt;FontSize / 1000);</div>
<div class="line"><a name="l04574"></a><span class="lineno"> 4574</span>&#160;    }</div>
<div class="line"><a name="l04575"></a><span class="lineno"> 4575</span>&#160;</div>
<div class="line"><a name="l04582"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#abc79f156bc4418c5446e81653519c632"> 4582</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#abc79f156bc4418c5446e81653519c632">getCharBBox</a>($char) {</div>
<div class="line"><a name="l04583"></a><span class="lineno"> 4583</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;CurrentFont[<span class="stringliteral">&#39;cbbox&#39;</span>][$char])) {</div>
<div class="line"><a name="l04584"></a><span class="lineno"> 4584</span>&#160;            <span class="keywordflow">return</span> array_map(array($this,<span class="stringliteral">&#39;getAbsFontMeasure&#39;</span>), $this-&gt;CurrentFont[<span class="stringliteral">&#39;cbbox&#39;</span>][intval($char)]);</div>
<div class="line"><a name="l04585"></a><span class="lineno"> 4585</span>&#160;        }</div>
<div class="line"><a name="l04586"></a><span class="lineno"> 4586</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04587"></a><span class="lineno"> 4587</span>&#160;    }</div>
<div class="line"><a name="l04588"></a><span class="lineno"> 4588</span>&#160;</div>
<div class="line"><a name="l04599"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a0c8374150dbc8ca092618ca430713f70"> 4599</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a0c8374150dbc8ca092618ca430713f70">getFontDescent</a>($font, $style=<span class="stringliteral">&#39;&#39;</span>, $size=0) {</div>
<div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160;        $fontdata = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a06cba4fc5e83b02bb37a947e56196776">AddFont</a>($font, $style);</div>
<div class="line"><a name="l04601"></a><span class="lineno"> 4601</span>&#160;        $fontinfo = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac63fff093a17846764bbcc09af7c8640">getFontBuffer</a>($fontdata[<span class="stringliteral">&#39;fontkey&#39;</span>]);</div>
<div class="line"><a name="l04602"></a><span class="lineno"> 4602</span>&#160;        <span class="keywordflow">if</span> (isset($fontinfo[<span class="stringliteral">&#39;desc&#39;</span>][<span class="stringliteral">&#39;Descent&#39;</span>]) AND ($fontinfo[<span class="stringliteral">&#39;desc&#39;</span>][<span class="stringliteral">&#39;Descent&#39;</span>] &lt;= 0)) {</div>
<div class="line"><a name="l04603"></a><span class="lineno"> 4603</span>&#160;            $descent = (- $fontinfo[<span class="stringliteral">&#39;desc&#39;</span>][<span class="stringliteral">&#39;Descent&#39;</span>] * $size / 1000);</div>
<div class="line"><a name="l04604"></a><span class="lineno"> 4604</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04605"></a><span class="lineno"> 4605</span>&#160;            $descent = (1.219 * 0.24 * $size);</div>
<div class="line"><a name="l04606"></a><span class="lineno"> 4606</span>&#160;        }</div>
<div class="line"><a name="l04607"></a><span class="lineno"> 4607</span>&#160;        <span class="keywordflow">return</span> ($descent / $this-&gt;k);</div>
<div class="line"><a name="l04608"></a><span class="lineno"> 4608</span>&#160;    }</div>
<div class="line"><a name="l04609"></a><span class="lineno"> 4609</span>&#160;</div>
<div class="line"><a name="l04620"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#acf41c6c04c29e1323bb270fdea6b5a9f"> 4620</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#acf41c6c04c29e1323bb270fdea6b5a9f">getFontAscent</a>($font, $style=<span class="stringliteral">&#39;&#39;</span>, $size=0) {</div>
<div class="line"><a name="l04621"></a><span class="lineno"> 4621</span>&#160;        $fontdata = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a06cba4fc5e83b02bb37a947e56196776">AddFont</a>($font, $style);</div>
<div class="line"><a name="l04622"></a><span class="lineno"> 4622</span>&#160;        $fontinfo = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac63fff093a17846764bbcc09af7c8640">getFontBuffer</a>($fontdata[<span class="stringliteral">&#39;fontkey&#39;</span>]);</div>
<div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160;        <span class="keywordflow">if</span> (isset($fontinfo[<span class="stringliteral">&#39;desc&#39;</span>][<span class="stringliteral">&#39;Ascent&#39;</span>]) AND ($fontinfo[<span class="stringliteral">&#39;desc&#39;</span>][<span class="stringliteral">&#39;Ascent&#39;</span>] &gt; 0)) {</div>
<div class="line"><a name="l04624"></a><span class="lineno"> 4624</span>&#160;            $ascent = ($fontinfo[<span class="stringliteral">&#39;desc&#39;</span>][<span class="stringliteral">&#39;Ascent&#39;</span>] * $size / 1000);</div>
<div class="line"><a name="l04625"></a><span class="lineno"> 4625</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04626"></a><span class="lineno"> 4626</span>&#160;            $ascent = 1.219 * 0.76 * $size;</div>
<div class="line"><a name="l04627"></a><span class="lineno"> 4627</span>&#160;        }</div>
<div class="line"><a name="l04628"></a><span class="lineno"> 4628</span>&#160;        <span class="keywordflow">return</span> ($ascent / $this-&gt;k);</div>
<div class="line"><a name="l04629"></a><span class="lineno"> 4629</span>&#160;    }</div>
<div class="line"><a name="l04630"></a><span class="lineno"> 4630</span>&#160;</div>
<div class="line"><a name="l04640"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a458536902daa1aaead2c627dcf71e66b"> 4640</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a458536902daa1aaead2c627dcf71e66b">isCharDefined</a>($char, $font=<span class="stringliteral">&#39;&#39;</span>, $style=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l04641"></a><span class="lineno"> 4641</span>&#160;        <span class="keywordflow">if</span> (is_string($char)) {</div>
<div class="line"><a name="l04642"></a><span class="lineno"> 4642</span>&#160;            <span class="comment">// get character code</span></div>
<div class="line"><a name="l04643"></a><span class="lineno"> 4643</span>&#160;            $char = TCPDF_FONTS::UTF8StringToArray($char, $this-&gt;isunicode, $this-&gt;CurrentFont);</div>
<div class="line"><a name="l04644"></a><span class="lineno"> 4644</span>&#160;            $char = $char[0];</div>
<div class="line"><a name="l04645"></a><span class="lineno"> 4645</span>&#160;        }</div>
<div class="line"><a name="l04646"></a><span class="lineno"> 4646</span>&#160;        <span class="keywordflow">if</span> (TCPDF_STATIC::empty_string($font)) {</div>
<div class="line"><a name="l04647"></a><span class="lineno"> 4647</span>&#160;            <span class="keywordflow">if</span> (TCPDF_STATIC::empty_string($style)) {</div>
<div class="line"><a name="l04648"></a><span class="lineno"> 4648</span>&#160;                <span class="keywordflow">return</span> (isset($this-&gt;CurrentFont[<span class="stringliteral">&#39;cw&#39;</span>][intval($char)]));</div>
<div class="line"><a name="l04649"></a><span class="lineno"> 4649</span>&#160;            }</div>
<div class="line"><a name="l04650"></a><span class="lineno"> 4650</span>&#160;            $font = <a class="code" href="../../d4/d40/classTCPDF.html#a642c62438ec9c983283a98d5099ba7ba">$this-&gt;FontFamily</a>;</div>
<div class="line"><a name="l04651"></a><span class="lineno"> 4651</span>&#160;        }</div>
<div class="line"><a name="l04652"></a><span class="lineno"> 4652</span>&#160;        $fontdata = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a06cba4fc5e83b02bb37a947e56196776">AddFont</a>($font, $style);</div>
<div class="line"><a name="l04653"></a><span class="lineno"> 4653</span>&#160;        $fontinfo = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac63fff093a17846764bbcc09af7c8640">getFontBuffer</a>($fontdata[<span class="stringliteral">&#39;fontkey&#39;</span>]);</div>
<div class="line"><a name="l04654"></a><span class="lineno"> 4654</span>&#160;        <span class="keywordflow">return</span> (isset($fontinfo[<span class="stringliteral">&#39;cw&#39;</span>][intval($char)]));</div>
<div class="line"><a name="l04655"></a><span class="lineno"> 4655</span>&#160;    }</div>
<div class="line"><a name="l04656"></a><span class="lineno"> 4656</span>&#160;</div>
<div class="line"><a name="l04667"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a54a81ac7f1da272429ed6262d0fdc9f5"> 4667</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a54a81ac7f1da272429ed6262d0fdc9f5">replaceMissingChars</a>($text, $font=<span class="stringliteral">&#39;&#39;</span>, $style=<span class="stringliteral">&#39;&#39;</span>, $subs=array()) {</div>
<div class="line"><a name="l04668"></a><span class="lineno"> 4668</span>&#160;        <span class="keywordflow">if</span> (empty($subs)) {</div>
<div class="line"><a name="l04669"></a><span class="lineno"> 4669</span>&#160;            <span class="keywordflow">return</span> $text;</div>
<div class="line"><a name="l04670"></a><span class="lineno"> 4670</span>&#160;        }</div>
<div class="line"><a name="l04671"></a><span class="lineno"> 4671</span>&#160;        <span class="keywordflow">if</span> (TCPDF_STATIC::empty_string($font)) {</div>
<div class="line"><a name="l04672"></a><span class="lineno"> 4672</span>&#160;            $font = <a class="code" href="../../d4/d40/classTCPDF.html#a642c62438ec9c983283a98d5099ba7ba">$this-&gt;FontFamily</a>;</div>
<div class="line"><a name="l04673"></a><span class="lineno"> 4673</span>&#160;        }</div>
<div class="line"><a name="l04674"></a><span class="lineno"> 4674</span>&#160;        $fontdata = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a06cba4fc5e83b02bb37a947e56196776">AddFont</a>($font, $style);</div>
<div class="line"><a name="l04675"></a><span class="lineno"> 4675</span>&#160;        $fontinfo = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac63fff093a17846764bbcc09af7c8640">getFontBuffer</a>($fontdata[<span class="stringliteral">&#39;fontkey&#39;</span>]);</div>
<div class="line"><a name="l04676"></a><span class="lineno"> 4676</span>&#160;        $uniarr = TCPDF_FONTS::UTF8StringToArray($text, $this-&gt;isunicode, $this-&gt;CurrentFont);</div>
<div class="line"><a name="l04677"></a><span class="lineno"> 4677</span>&#160;        <span class="keywordflow">foreach</span> ($uniarr as <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a> =&gt; $chr) {</div>
<div class="line"><a name="l04678"></a><span class="lineno"> 4678</span>&#160;            <span class="keywordflow">if</span> (!isset($fontinfo[<span class="stringliteral">&#39;cw&#39;</span>][$chr])) {</div>
<div class="line"><a name="l04679"></a><span class="lineno"> 4679</span>&#160;                <span class="comment">// this character is missing on the selected font</span></div>
<div class="line"><a name="l04680"></a><span class="lineno"> 4680</span>&#160;                <span class="keywordflow">if</span> (isset($subs[$chr])) {</div>
<div class="line"><a name="l04681"></a><span class="lineno"> 4681</span>&#160;                    <span class="comment">// we have available substitutions</span></div>
<div class="line"><a name="l04682"></a><span class="lineno"> 4682</span>&#160;                    <span class="keywordflow">if</span> (is_array($subs[$chr])) {</div>
<div class="line"><a name="l04683"></a><span class="lineno"> 4683</span>&#160;                        <span class="keywordflow">foreach</span>($subs[$chr] as $s) {</div>
<div class="line"><a name="l04684"></a><span class="lineno"> 4684</span>&#160;                            <span class="keywordflow">if</span> (isset($fontinfo[<span class="stringliteral">&#39;cw&#39;</span>][$s])) {</div>
<div class="line"><a name="l04685"></a><span class="lineno"> 4685</span>&#160;                                $uniarr[<a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a>] = $s;</div>
<div class="line"><a name="l04686"></a><span class="lineno"> 4686</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04687"></a><span class="lineno"> 4687</span>&#160;                            }</div>
<div class="line"><a name="l04688"></a><span class="lineno"> 4688</span>&#160;                        }</div>
<div class="line"><a name="l04689"></a><span class="lineno"> 4689</span>&#160;                    } elseif (isset($fontinfo[<span class="stringliteral">&#39;cw&#39;</span>][$subs[$chr]])) {</div>
<div class="line"><a name="l04690"></a><span class="lineno"> 4690</span>&#160;                        $uniarr[<a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a>] = $subs[$chr];</div>
<div class="line"><a name="l04691"></a><span class="lineno"> 4691</span>&#160;                    }</div>
<div class="line"><a name="l04692"></a><span class="lineno"> 4692</span>&#160;                }</div>
<div class="line"><a name="l04693"></a><span class="lineno"> 4693</span>&#160;            }</div>
<div class="line"><a name="l04694"></a><span class="lineno"> 4694</span>&#160;        }</div>
<div class="line"><a name="l04695"></a><span class="lineno"> 4695</span>&#160;        <span class="keywordflow">return</span> TCPDF_FONTS::UniArrSubString(TCPDF_FONTS::UTF8ArrayToUniArray($uniarr, $this-&gt;isunicode));</div>
<div class="line"><a name="l04696"></a><span class="lineno"> 4696</span>&#160;    }</div>
<div class="line"><a name="l04697"></a><span class="lineno"> 4697</span>&#160;</div>
<div class="line"><a name="l04704"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ae9b45d6f58118e2bc12c44cca8eed61b"> 4704</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ae9b45d6f58118e2bc12c44cca8eed61b">SetDefaultMonospacedFont</a>($font) {</div>
<div class="line"><a name="l04705"></a><span class="lineno"> 4705</span>&#160;        $this-&gt;default_monospaced_font = $font;</div>
<div class="line"><a name="l04706"></a><span class="lineno"> 4706</span>&#160;    }</div>
<div class="line"><a name="l04707"></a><span class="lineno"> 4707</span>&#160;</div>
<div class="line"><a name="l04715"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a749522038ed7786c3e1701435dcb891e"> 4715</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a749522038ed7786c3e1701435dcb891e">AddLink</a>() {</div>
<div class="line"><a name="l04716"></a><span class="lineno"> 4716</span>&#160;        <span class="comment">// create a new internal link</span></div>
<div class="line"><a name="l04717"></a><span class="lineno"> 4717</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a> = count($this-&gt;links) + 1;</div>
<div class="line"><a name="l04718"></a><span class="lineno"> 4718</span>&#160;        $this-&gt;links[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>] = array(<span class="charliteral">&#39;p&#39;</span> =&gt; 0, <span class="charliteral">&#39;y&#39;</span> =&gt; 0, <span class="charliteral">&#39;f&#39;</span> =&gt; <span class="keyword">false</span>);</div>
<div class="line"><a name="l04719"></a><span class="lineno"> 4719</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>;</div>
<div class="line"><a name="l04720"></a><span class="lineno"> 4720</span>&#160;    }</div>
<div class="line"><a name="l04721"></a><span class="lineno"> 4721</span>&#160;</div>
<div class="line"><a name="l04731"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ace5be60e7857953ea5e2b89cb90df0ae"> 4731</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ace5be60e7857953ea5e2b89cb90df0ae">SetLink</a>($link, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>=0, <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>=-1) {</div>
<div class="line"><a name="l04732"></a><span class="lineno"> 4732</span>&#160;        $fixed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04733"></a><span class="lineno"> 4733</span>&#160;        <span class="keywordflow">if</span> (!empty(<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>) AND (<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>[0] == <span class="charliteral">&#39;*&#39;</span>)) {</div>
<div class="line"><a name="l04734"></a><span class="lineno"> 4734</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a> = intval(substr(<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>, 1));</div>
<div class="line"><a name="l04735"></a><span class="lineno"> 4735</span>&#160;            <span class="comment">// this page number will not be changed when moving/add/deleting pages</span></div>
<div class="line"><a name="l04736"></a><span class="lineno"> 4736</span>&#160;            $fixed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04737"></a><span class="lineno"> 4737</span>&#160;        }</div>
<div class="line"><a name="l04738"></a><span class="lineno"> 4738</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a> &lt; 0) {</div>
<div class="line"><a name="l04739"></a><span class="lineno"> 4739</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a> = <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>;</div>
<div class="line"><a name="l04740"></a><span class="lineno"> 4740</span>&#160;        }</div>
<div class="line"><a name="l04741"></a><span class="lineno"> 4741</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> == -1) {</div>
<div class="line"><a name="l04742"></a><span class="lineno"> 4742</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l04743"></a><span class="lineno"> 4743</span>&#160;        }</div>
<div class="line"><a name="l04744"></a><span class="lineno"> 4744</span>&#160;        $this-&gt;links[$link] = array(<span class="charliteral">&#39;p&#39;</span> =&gt; <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>, <span class="charliteral">&#39;y&#39;</span> =&gt; <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <span class="charliteral">&#39;f&#39;</span> =&gt; $fixed);</div>
<div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160;    }</div>
<div class="line"><a name="l04746"></a><span class="lineno"> 4746</span>&#160;</div>
<div class="line"><a name="l04760"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ab87bf1826384fbfe30eb499d42f1d994"> 4760</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ab87bf1826384fbfe30eb499d42f1d994">Link</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $link, $spaces=0) {</div>
<div class="line"><a name="l04761"></a><span class="lineno"> 4761</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a6b05e14a0ff7b12eb78f884cabd69e9b">Annotation</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $link, array(<span class="stringliteral">&#39;Subtype&#39;</span>=&gt;<span class="stringliteral">&#39;Link&#39;</span>), $spaces);</div>
<div class="line"><a name="l04762"></a><span class="lineno"> 4762</span>&#160;    }</div>
<div class="line"><a name="l04763"></a><span class="lineno"> 4763</span>&#160;</div>
<div class="line"><a name="l04777"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a6b05e14a0ff7b12eb78f884cabd69e9b"> 4777</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a6b05e14a0ff7b12eb78f884cabd69e9b">Annotation</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $text, $opt=array(<span class="stringliteral">&#39;Subtype&#39;</span>=&gt;<span class="stringliteral">&#39;Text&#39;</span>), $spaces=0) {</div>
<div class="line"><a name="l04778"></a><span class="lineno"> 4778</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;inxobj) {</div>
<div class="line"><a name="l04779"></a><span class="lineno"> 4779</span>&#160;            <span class="comment">// store parameters for later use on template</span></div>
<div class="line"><a name="l04780"></a><span class="lineno"> 4780</span>&#160;            $this-&gt;xobjects[<a class="code" href="../../d4/d40/classTCPDF.html#abe4390b4e1939e10c9b61a986adfc117">$this-&gt;xobjid</a>][<span class="stringliteral">&#39;annotations&#39;</span>][] = array(<span class="charliteral">&#39;x&#39;</span> =&gt; <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <span class="charliteral">&#39;y&#39;</span> =&gt; <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <span class="charliteral">&#39;w&#39;</span> =&gt; <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <span class="charliteral">&#39;h&#39;</span> =&gt; <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, <span class="stringliteral">&#39;text&#39;</span> =&gt; $text, <span class="stringliteral">&#39;opt&#39;</span> =&gt; $opt, <span class="stringliteral">&#39;spaces&#39;</span> =&gt; $spaces);</div>
<div class="line"><a name="l04781"></a><span class="lineno"> 4781</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04782"></a><span class="lineno"> 4782</span>&#160;        }</div>
<div class="line"><a name="l04783"></a><span class="lineno"> 4783</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> === <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l04784"></a><span class="lineno"> 4784</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$this-&gt;x</a>;</div>
<div class="line"><a name="l04785"></a><span class="lineno"> 4785</span>&#160;        }</div>
<div class="line"><a name="l04786"></a><span class="lineno"> 4786</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> === <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l04787"></a><span class="lineno"> 4787</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l04788"></a><span class="lineno"> 4788</span>&#160;        }</div>
<div class="line"><a name="l04789"></a><span class="lineno"> 4789</span>&#160;        <span class="comment">// check page for no-write regions and adapt page margins if necessary</span></div>
<div class="line"><a name="l04790"></a><span class="lineno"> 4790</span>&#160;        list(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>) = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1d99e81697a90efb13a6734001427f40">checkPageRegions</a>(<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>);</div>
<div class="line"><a name="l04791"></a><span class="lineno"> 4791</span>&#160;        <span class="comment">// recalculate coordinates to account for graphic transformations</span></div>
<div class="line"><a name="l04792"></a><span class="lineno"> 4792</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;transfmatrix) AND !empty($this-&gt;transfmatrix)) {</div>
<div class="line"><a name="l04793"></a><span class="lineno"> 4793</span>&#160;            <span class="keywordflow">for</span> ($i=$this-&gt;transfmatrix_key; $i &gt; 0; --$i) {</div>
<div class="line"><a name="l04794"></a><span class="lineno"> 4794</span>&#160;                $maxid = count($this-&gt;transfmatrix[$i]) - 1;</div>
<div class="line"><a name="l04795"></a><span class="lineno"> 4795</span>&#160;                <span class="keywordflow">for</span> ($j=$maxid; $j &gt;= 0; --$j) {</div>
<div class="line"><a name="l04796"></a><span class="lineno"> 4796</span>&#160;                    $ctm = $this-&gt;transfmatrix[$i][$j];</div>
<div class="line"><a name="l04797"></a><span class="lineno"> 4797</span>&#160;                    <span class="keywordflow">if</span> (isset($ctm[<span class="charliteral">&#39;a&#39;</span>])) {</div>
<div class="line"><a name="l04798"></a><span class="lineno"> 4798</span>&#160;                        <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>;</div>
<div class="line"><a name="l04799"></a><span class="lineno"> 4799</span>&#160;                        <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> = ($this-&gt;h - <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>) * $this-&gt;k;</div>
<div class="line"><a name="l04800"></a><span class="lineno"> 4800</span>&#160;                        <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>;</div>
<div class="line"><a name="l04801"></a><span class="lineno"> 4801</span>&#160;                        <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> = <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>;</div>
<div class="line"><a name="l04802"></a><span class="lineno"> 4802</span>&#160;                        <span class="comment">// top left</span></div>
<div class="line"><a name="l04803"></a><span class="lineno"> 4803</span>&#160;                        $xt = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>;</div>
<div class="line"><a name="l04804"></a><span class="lineno"> 4804</span>&#160;                        $yt = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>;</div>
<div class="line"><a name="l04805"></a><span class="lineno"> 4805</span>&#160;                        $x1 = ($ctm[<span class="charliteral">&#39;a&#39;</span>] * $xt) + ($ctm[<span class="charliteral">&#39;c&#39;</span>] * $yt) + $ctm[<span class="charliteral">&#39;e&#39;</span>];</div>
<div class="line"><a name="l04806"></a><span class="lineno"> 4806</span>&#160;                        $y1 = ($ctm[<span class="charliteral">&#39;b&#39;</span>] * $xt) + ($ctm[<span class="charliteral">&#39;d&#39;</span>] * $yt) + $ctm[<span class="charliteral">&#39;f&#39;</span>];</div>
<div class="line"><a name="l04807"></a><span class="lineno"> 4807</span>&#160;                        <span class="comment">// top right</span></div>
<div class="line"><a name="l04808"></a><span class="lineno"> 4808</span>&#160;                        $xt = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> + <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>;</div>
<div class="line"><a name="l04809"></a><span class="lineno"> 4809</span>&#160;                        $yt = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>;</div>
<div class="line"><a name="l04810"></a><span class="lineno"> 4810</span>&#160;                        $x2 = ($ctm[<span class="charliteral">&#39;a&#39;</span>] * $xt) + ($ctm[<span class="charliteral">&#39;c&#39;</span>] * $yt) + $ctm[<span class="charliteral">&#39;e&#39;</span>];</div>
<div class="line"><a name="l04811"></a><span class="lineno"> 4811</span>&#160;                        $y2 = ($ctm[<span class="charliteral">&#39;b&#39;</span>] * $xt) + ($ctm[<span class="charliteral">&#39;d&#39;</span>] * $yt) + $ctm[<span class="charliteral">&#39;f&#39;</span>];</div>
<div class="line"><a name="l04812"></a><span class="lineno"> 4812</span>&#160;                        <span class="comment">// bottom left</span></div>
<div class="line"><a name="l04813"></a><span class="lineno"> 4813</span>&#160;                        $xt = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>;</div>
<div class="line"><a name="l04814"></a><span class="lineno"> 4814</span>&#160;                        $yt = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> - <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>;</div>
<div class="line"><a name="l04815"></a><span class="lineno"> 4815</span>&#160;                        $x3 = ($ctm[<span class="charliteral">&#39;a&#39;</span>] * $xt) + ($ctm[<span class="charliteral">&#39;c&#39;</span>] * $yt) + $ctm[<span class="charliteral">&#39;e&#39;</span>];</div>
<div class="line"><a name="l04816"></a><span class="lineno"> 4816</span>&#160;                        $y3 = ($ctm[<span class="charliteral">&#39;b&#39;</span>] * $xt) + ($ctm[<span class="charliteral">&#39;d&#39;</span>] * $yt) + $ctm[<span class="charliteral">&#39;f&#39;</span>];</div>
<div class="line"><a name="l04817"></a><span class="lineno"> 4817</span>&#160;                        <span class="comment">// bottom right</span></div>
<div class="line"><a name="l04818"></a><span class="lineno"> 4818</span>&#160;                        $xt = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> + <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>;</div>
<div class="line"><a name="l04819"></a><span class="lineno"> 4819</span>&#160;                        $yt = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> - <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>;</div>
<div class="line"><a name="l04820"></a><span class="lineno"> 4820</span>&#160;                        $x4 = ($ctm[<span class="charliteral">&#39;a&#39;</span>] * $xt) + ($ctm[<span class="charliteral">&#39;c&#39;</span>] * $yt) + $ctm[<span class="charliteral">&#39;e&#39;</span>];</div>
<div class="line"><a name="l04821"></a><span class="lineno"> 4821</span>&#160;                        $y4 = ($ctm[<span class="charliteral">&#39;b&#39;</span>] * $xt) + ($ctm[<span class="charliteral">&#39;d&#39;</span>] * $yt) + $ctm[<span class="charliteral">&#39;f&#39;</span>];</div>
<div class="line"><a name="l04822"></a><span class="lineno"> 4822</span>&#160;                        <span class="comment">// new coordinates (rectangle area)</span></div>
<div class="line"><a name="l04823"></a><span class="lineno"> 4823</span>&#160;                        <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> = min($x1, $x2, $x3, $x4);</div>
<div class="line"><a name="l04824"></a><span class="lineno"> 4824</span>&#160;                        <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> = max($y1, $y2, $y3, $y4);</div>
<div class="line"><a name="l04825"></a><span class="lineno"> 4825</span>&#160;                        $w = (max($x1, $x2, $x3, $x4) - <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>) / $this-&gt;k;</div>
<div class="line"><a name="l04826"></a><span class="lineno"> 4826</span>&#160;                        $h = (<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> - min($y1, $y2, $y3, $y4)) / $this-&gt;k;</div>
<div class="line"><a name="l04827"></a><span class="lineno"> 4827</span>&#160;                        <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> / <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>;</div>
<div class="line"><a name="l04828"></a><span class="lineno"> 4828</span>&#160;                        <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> = $this-&gt;h - (<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> / <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>);</div>
<div class="line"><a name="l04829"></a><span class="lineno"> 4829</span>&#160;                    }</div>
<div class="line"><a name="l04830"></a><span class="lineno"> 4830</span>&#160;                }</div>
<div class="line"><a name="l04831"></a><span class="lineno"> 4831</span>&#160;            }</div>
<div class="line"><a name="l04832"></a><span class="lineno"> 4832</span>&#160;        }</div>
<div class="line"><a name="l04833"></a><span class="lineno"> 4833</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;page &lt;= 0) {</div>
<div class="line"><a name="l04834"></a><span class="lineno"> 4834</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a> = 1;</div>
<div class="line"><a name="l04835"></a><span class="lineno"> 4835</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04836"></a><span class="lineno"> 4836</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a> = <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>;</div>
<div class="line"><a name="l04837"></a><span class="lineno"> 4837</span>&#160;        }</div>
<div class="line"><a name="l04838"></a><span class="lineno"> 4838</span>&#160;        <span class="keywordflow">if</span> (!isset($this-&gt;PageAnnots[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>])) {</div>
<div class="line"><a name="l04839"></a><span class="lineno"> 4839</span>&#160;            $this-&gt;PageAnnots[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>] = array();</div>
<div class="line"><a name="l04840"></a><span class="lineno"> 4840</span>&#160;        }</div>
<div class="line"><a name="l04841"></a><span class="lineno"> 4841</span>&#160;        $this-&gt;PageAnnots[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>][] = array(<span class="charliteral">&#39;n&#39;</span> =&gt; ++$this-&gt;n, <span class="charliteral">&#39;x&#39;</span> =&gt; <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <span class="charliteral">&#39;y&#39;</span> =&gt; <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <span class="charliteral">&#39;w&#39;</span> =&gt; <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <span class="charliteral">&#39;h&#39;</span> =&gt; <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, <span class="stringliteral">&#39;txt&#39;</span> =&gt; $text, <span class="stringliteral">&#39;opt&#39;</span> =&gt; $opt, <span class="stringliteral">&#39;numspaces&#39;</span> =&gt; $spaces);</div>
<div class="line"><a name="l04842"></a><span class="lineno"> 4842</span>&#160;        <span class="keywordflow">if</span> (!$this-&gt;pdfa_mode) {</div>
<div class="line"><a name="l04843"></a><span class="lineno"> 4843</span>&#160;            <span class="keywordflow">if</span> ((($opt[<span class="stringliteral">&#39;Subtype&#39;</span>] == <span class="stringliteral">&#39;FileAttachment&#39;</span>) OR ($opt[<span class="stringliteral">&#39;Subtype&#39;</span>] == <span class="stringliteral">&#39;Sound&#39;</span>)) AND (!TCPDF_STATIC::empty_string($opt[<span class="stringliteral">&#39;FS&#39;</span>]))</div>
<div class="line"><a name="l04844"></a><span class="lineno"> 4844</span>&#160;                AND (@file_exists($opt[<span class="stringliteral">&#39;FS&#39;</span>]) OR TCPDF_STATIC::isValidURL($opt[<span class="stringliteral">&#39;FS&#39;</span>]))</div>
<div class="line"><a name="l04845"></a><span class="lineno"> 4845</span>&#160;                AND (!isset($this-&gt;embeddedfiles[basename($opt[<span class="stringliteral">&#39;FS&#39;</span>])]))) {</div>
<div class="line"><a name="l04846"></a><span class="lineno"> 4846</span>&#160;                $this-&gt;embeddedfiles[basename($opt[<span class="stringliteral">&#39;FS&#39;</span>])] = array(<span class="charliteral">&#39;f&#39;</span> =&gt; ++$this-&gt;n, <span class="charliteral">&#39;n&#39;</span> =&gt; ++$this-&gt;n, <span class="stringliteral">&#39;file&#39;</span> =&gt; $opt[<span class="stringliteral">&#39;FS&#39;</span>]);</div>
<div class="line"><a name="l04847"></a><span class="lineno"> 4847</span>&#160;            }</div>
<div class="line"><a name="l04848"></a><span class="lineno"> 4848</span>&#160;        }</div>
<div class="line"><a name="l04849"></a><span class="lineno"> 4849</span>&#160;        <span class="comment">// Add widgets annotation&#39;s icons</span></div>
<div class="line"><a name="l04850"></a><span class="lineno"> 4850</span>&#160;        <span class="keywordflow">if</span> (isset($opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="charliteral">&#39;i&#39;</span>]) AND @file_exists($opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="charliteral">&#39;i&#39;</span>])) {</div>
<div class="line"><a name="l04851"></a><span class="lineno"> 4851</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a714c2bee7d6b39d4d6d304540c761352">Image</a>($opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="charliteral">&#39;i&#39;</span>], <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, 10, 10, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>, 300, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, 0, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l04852"></a><span class="lineno"> 4852</span>&#160;        }</div>
<div class="line"><a name="l04853"></a><span class="lineno"> 4853</span>&#160;        <span class="keywordflow">if</span> (isset($opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;ri&#39;</span>]) AND @file_exists($opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;ri&#39;</span>])) {</div>
<div class="line"><a name="l04854"></a><span class="lineno"> 4854</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a714c2bee7d6b39d4d6d304540c761352">Image</a>($opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;ri&#39;</span>], <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, 0, 0, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>, 300, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, 0, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l04855"></a><span class="lineno"> 4855</span>&#160;        }</div>
<div class="line"><a name="l04856"></a><span class="lineno"> 4856</span>&#160;        <span class="keywordflow">if</span> (isset($opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;ix&#39;</span>]) AND @file_exists($opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;ix&#39;</span>])) {</div>
<div class="line"><a name="l04857"></a><span class="lineno"> 4857</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a714c2bee7d6b39d4d6d304540c761352">Image</a>($opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;ix&#39;</span>], <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, 0, 0, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>, 300, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, 0, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l04858"></a><span class="lineno"> 4858</span>&#160;        }</div>
<div class="line"><a name="l04859"></a><span class="lineno"> 4859</span>&#160;    }</div>
<div class="line"><a name="l04860"></a><span class="lineno"> 4860</span>&#160;</div>
<div class="line"><a name="l04867"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ad3e9b80cfbd309301aa9a10d29282749"> 4867</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ad3e9b80cfbd309301aa9a10d29282749">_putEmbeddedFiles</a>() {</div>
<div class="line"><a name="l04868"></a><span class="lineno"> 4868</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;pdfa_mode) {</div>
<div class="line"><a name="l04869"></a><span class="lineno"> 4869</span>&#160;            <span class="comment">// embedded files are not allowed in PDF/A mode</span></div>
<div class="line"><a name="l04870"></a><span class="lineno"> 4870</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04871"></a><span class="lineno"> 4871</span>&#160;        }</div>
<div class="line"><a name="l04872"></a><span class="lineno"> 4872</span>&#160;        reset($this-&gt;embeddedfiles);</div>
<div class="line"><a name="l04873"></a><span class="lineno"> 4873</span>&#160;        <span class="keywordflow">foreach</span> ($this-&gt;embeddedfiles as $filename =&gt; $filedata) {</div>
<div class="line"><a name="l04874"></a><span class="lineno"> 4874</span>&#160;            $data = TCPDF_STATIC::fileGetContents($filedata[<span class="stringliteral">&#39;file&#39;</span>]);</div>
<div class="line"><a name="l04875"></a><span class="lineno"> 4875</span>&#160;            <span class="keywordflow">if</span> ($data !== FALSE) {</div>
<div class="line"><a name="l04876"></a><span class="lineno"> 4876</span>&#160;                $rawsize = strlen($data);</div>
<div class="line"><a name="l04877"></a><span class="lineno"> 4877</span>&#160;                <span class="keywordflow">if</span> ($rawsize &gt; 0) {</div>
<div class="line"><a name="l04878"></a><span class="lineno"> 4878</span>&#160;                    <span class="comment">// update name tree</span></div>
<div class="line"><a name="l04879"></a><span class="lineno"> 4879</span>&#160;                    $this-&gt;efnames[$filename] = $filedata[<span class="charliteral">&#39;f&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l04880"></a><span class="lineno"> 4880</span>&#160;                    <span class="comment">// embedded file specification object</span></div>
<div class="line"><a name="l04881"></a><span class="lineno"> 4881</span>&#160;                    $out = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1ef3c591556f7668c8a62b81e98da8a1">_getobj</a>($filedata[<span class="charliteral">&#39;f&#39;</span>]).<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l04882"></a><span class="lineno"> 4882</span>&#160;                    $out .= <span class="stringliteral">&#39;&lt;&lt;/Type /Filespec /F &#39;</span>.$this-&gt;_datastring($filename, $filedata[<span class="charliteral">&#39;f&#39;</span>]).<span class="stringliteral">&#39; /EF &lt;&lt;/F &#39;</span>.$filedata[<span class="charliteral">&#39;n&#39;</span>].<span class="stringliteral">&#39; 0 R&gt;&gt; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l04883"></a><span class="lineno"> 4883</span>&#160;                    $out .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l04884"></a><span class="lineno"> 4884</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($out);</div>
<div class="line"><a name="l04885"></a><span class="lineno"> 4885</span>&#160;                    <span class="comment">// embedded file object</span></div>
<div class="line"><a name="l04886"></a><span class="lineno"> 4886</span>&#160;                    $filter = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l04887"></a><span class="lineno"> 4887</span>&#160;                    <span class="keywordflow">if</span> ($this-&gt;compress) {</div>
<div class="line"><a name="l04888"></a><span class="lineno"> 4888</span>&#160;                        $data = gzcompress($data);</div>
<div class="line"><a name="l04889"></a><span class="lineno"> 4889</span>&#160;                        $filter = <span class="stringliteral">&#39; /Filter /FlateDecode&#39;</span>;</div>
<div class="line"><a name="l04890"></a><span class="lineno"> 4890</span>&#160;                    }</div>
<div class="line"><a name="l04891"></a><span class="lineno"> 4891</span>&#160;                    $stream = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a7c7c1beebd83fa777197a842f2ca73eb">_getrawstream</a>($data, $filedata[<span class="charliteral">&#39;n&#39;</span>]);</div>
<div class="line"><a name="l04892"></a><span class="lineno"> 4892</span>&#160;                    $out = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1ef3c591556f7668c8a62b81e98da8a1">_getobj</a>($filedata[<span class="charliteral">&#39;n&#39;</span>]).<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l04893"></a><span class="lineno"> 4893</span>&#160;                    $out .= <span class="stringliteral">&#39;&lt;&lt; /Type /EmbeddedFile&#39;</span>.$filter.<span class="stringliteral">&#39; /Length &#39;</span>.strlen($stream).<span class="stringliteral">&#39; /Params &lt;&lt;/Size &#39;</span>.$rawsize.<span class="stringliteral">&#39;&gt;&gt; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l04894"></a><span class="lineno"> 4894</span>&#160;                    $out .= <span class="stringliteral">&#39; stream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.$stream.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endstream&#39;</span>;</div>
<div class="line"><a name="l04895"></a><span class="lineno"> 4895</span>&#160;                    $out .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l04896"></a><span class="lineno"> 4896</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($out);</div>
<div class="line"><a name="l04897"></a><span class="lineno"> 4897</span>&#160;                }</div>
<div class="line"><a name="l04898"></a><span class="lineno"> 4898</span>&#160;            }</div>
<div class="line"><a name="l04899"></a><span class="lineno"> 4899</span>&#160;        }</div>
<div class="line"><a name="l04900"></a><span class="lineno"> 4900</span>&#160;    }</div>
<div class="line"><a name="l04901"></a><span class="lineno"> 4901</span>&#160;</div>
<div class="line"><a name="l04925"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#abf1daa47cbb1f2abe310d19124a1e35e"> 4925</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#abf1daa47cbb1f2abe310d19124a1e35e">Text</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, $txt, $fstroke=<span class="keyword">false</span>, $fclip=<span class="keyword">false</span>, $ffill=<span class="keyword">true</span>, $border=0, $ln=0, $align=<span class="stringliteral">&#39;&#39;</span>, $fill=<span class="keyword">false</span>, $link=<span class="stringliteral">&#39;&#39;</span>, $stretch=0, $ignore_min_height=<span class="keyword">false</span>, $calign=<span class="charliteral">&#39;T&#39;</span>, $valign=<span class="charliteral">&#39;M&#39;</span>, $rtloff=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l04926"></a><span class="lineno"> 4926</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#a45310f49168f541285b71f190645ff45">$textrendermode</a> = <a class="code" href="../../d4/d40/classTCPDF.html#a45310f49168f541285b71f190645ff45">$this-&gt;textrendermode</a>;</div>
<div class="line"><a name="l04927"></a><span class="lineno"> 4927</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#acef86c1b60f2b45323f27c4dc9620922">$textstrokewidth</a> = <a class="code" href="../../d4/d40/classTCPDF.html#acef86c1b60f2b45323f27c4dc9620922">$this-&gt;textstrokewidth</a>;</div>
<div class="line"><a name="l04928"></a><span class="lineno"> 4928</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa194abd22d0ba5e5f2c52c5e05f4e107">setTextRenderingMode</a>($fstroke, $ffill, $fclip);</div>
<div class="line"><a name="l04929"></a><span class="lineno"> 4929</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a00ec13928f57b17c21040acc881fe482">SetXY</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, $rtloff);</div>
<div class="line"><a name="l04930"></a><span class="lineno"> 4930</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a33b265e5eb3e4d1d4fedfe29f8166f31">Cell</a>(0, 0, $txt, $border, $ln, $align, $fill, $link, $stretch, $ignore_min_height, $calign, $valign);</div>
<div class="line"><a name="l04931"></a><span class="lineno"> 4931</span>&#160;        <span class="comment">// restore previous rendering mode</span></div>
<div class="line"><a name="l04932"></a><span class="lineno"> 4932</span>&#160;        $this-&gt;textrendermode = <a class="code" href="../../d4/d40/classTCPDF.html#a45310f49168f541285b71f190645ff45">$textrendermode</a>;</div>
<div class="line"><a name="l04933"></a><span class="lineno"> 4933</span>&#160;        $this-&gt;textstrokewidth = <a class="code" href="../../d4/d40/classTCPDF.html#acef86c1b60f2b45323f27c4dc9620922">$textstrokewidth</a>;</div>
<div class="line"><a name="l04934"></a><span class="lineno"> 4934</span>&#160;    }</div>
<div class="line"><a name="l04935"></a><span class="lineno"> 4935</span>&#160;</div>
<div class="line"><a name="l04945"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aa24046de2993933f62d60a2936a22970"> 4945</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#aa24046de2993933f62d60a2936a22970">AcceptPageBreak</a>() {</div>
<div class="line"><a name="l04946"></a><span class="lineno"> 4946</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;num_columns &gt; 1) {</div>
<div class="line"><a name="l04947"></a><span class="lineno"> 4947</span>&#160;            <span class="comment">// multi column mode</span></div>
<div class="line"><a name="l04948"></a><span class="lineno"> 4948</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;current_column &lt; ($this-&gt;num_columns - 1)) {</div>
<div class="line"><a name="l04949"></a><span class="lineno"> 4949</span>&#160;                <span class="comment">// go to next column</span></div>
<div class="line"><a name="l04950"></a><span class="lineno"> 4950</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4f11d769024fd07e1f663efd02d10517">selectColumn</a>($this-&gt;current_column + 1);</div>
<div class="line"><a name="l04951"></a><span class="lineno"> 4951</span>&#160;            } elseif ($this-&gt;AutoPageBreak) {</div>
<div class="line"><a name="l04952"></a><span class="lineno"> 4952</span>&#160;                <span class="comment">// add a new page</span></div>
<div class="line"><a name="l04953"></a><span class="lineno"> 4953</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a5171e20b366b74523709d84c349c1ced">AddPage</a>();</div>
<div class="line"><a name="l04954"></a><span class="lineno"> 4954</span>&#160;                <span class="comment">// set first column</span></div>
<div class="line"><a name="l04955"></a><span class="lineno"> 4955</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4f11d769024fd07e1f663efd02d10517">selectColumn</a>(0);</div>
<div class="line"><a name="l04956"></a><span class="lineno"> 4956</span>&#160;            }</div>
<div class="line"><a name="l04957"></a><span class="lineno"> 4957</span>&#160;            <span class="comment">// avoid page breaking from checkPageBreak()</span></div>
<div class="line"><a name="l04958"></a><span class="lineno"> 4958</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l04959"></a><span class="lineno"> 4959</span>&#160;        }</div>
<div class="line"><a name="l04960"></a><span class="lineno"> 4960</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#ad252eae91d3151b11d1dd15aebe9a4a4">$this-&gt;AutoPageBreak</a>;</div>
<div class="line"><a name="l04961"></a><span class="lineno"> 4961</span>&#160;    }</div>
<div class="line"><a name="l04962"></a><span class="lineno"> 4962</span>&#160;</div>
<div class="line"><a name="l04972"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a9e8e4b4d75485b8f1e3aa2133a811e50"> 4972</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a9e8e4b4d75485b8f1e3aa2133a811e50">checkPageBreak</a>(<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>=0, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>=<span class="stringliteral">&#39;&#39;</span>, $addpage=<span class="keyword">true</span>) {</div>
<div class="line"><a name="l04973"></a><span class="lineno"> 4973</span>&#160;        <span class="keywordflow">if</span> (TCPDF_STATIC::empty_string(<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>)) {</div>
<div class="line"><a name="l04974"></a><span class="lineno"> 4974</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l04975"></a><span class="lineno"> 4975</span>&#160;        }</div>
<div class="line"><a name="l04976"></a><span class="lineno"> 4976</span>&#160;        $current_page = <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>;</div>
<div class="line"><a name="l04977"></a><span class="lineno"> 4977</span>&#160;        <span class="keywordflow">if</span> (((<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> + <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>) &gt; $this-&gt;PageBreakTrigger) AND ($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a13f370f8e1553105eaa3553f52c3fc6c">inPageBody</a>()) AND ($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa24046de2993933f62d60a2936a22970">AcceptPageBreak</a>())) {</div>
<div class="line"><a name="l04978"></a><span class="lineno"> 4978</span>&#160;            <span class="keywordflow">if</span> ($addpage) {</div>
<div class="line"><a name="l04979"></a><span class="lineno"> 4979</span>&#160;                <span class="comment">//Automatic page break</span></div>
<div class="line"><a name="l04980"></a><span class="lineno"> 4980</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$this-&gt;x</a>;</div>
<div class="line"><a name="l04981"></a><span class="lineno"> 4981</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a5171e20b366b74523709d84c349c1ced">AddPage</a>($this-&gt;CurOrientation);</div>
<div class="line"><a name="l04982"></a><span class="lineno"> 4982</span>&#160;                $this-&gt;y = <a class="code" href="../../d4/d40/classTCPDF.html#ace8343242b398fd16a4acb1926b6efa7">$this-&gt;tMargin</a>;</div>
<div class="line"><a name="l04983"></a><span class="lineno"> 4983</span>&#160;                $oldpage = $this-&gt;page - 1;</div>
<div class="line"><a name="l04984"></a><span class="lineno"> 4984</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l04985"></a><span class="lineno"> 4985</span>&#160;                    <span class="keywordflow">if</span> ($this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;orm&#39;</span>] != $this-&gt;pagedim[$oldpage][<span class="stringliteral">&#39;orm&#39;</span>]) {</div>
<div class="line"><a name="l04986"></a><span class="lineno"> 4986</span>&#160;                        $this-&gt;x = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> - ($this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;orm&#39;</span>] - $this-&gt;pagedim[$oldpage][<span class="stringliteral">&#39;orm&#39;</span>]);</div>
<div class="line"><a name="l04987"></a><span class="lineno"> 4987</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04988"></a><span class="lineno"> 4988</span>&#160;                        $this-&gt;x = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>;</div>
<div class="line"><a name="l04989"></a><span class="lineno"> 4989</span>&#160;                    }</div>
<div class="line"><a name="l04990"></a><span class="lineno"> 4990</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04991"></a><span class="lineno"> 4991</span>&#160;                    <span class="keywordflow">if</span> ($this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;olm&#39;</span>] != $this-&gt;pagedim[$oldpage][<span class="stringliteral">&#39;olm&#39;</span>]) {</div>
<div class="line"><a name="l04992"></a><span class="lineno"> 4992</span>&#160;                        $this-&gt;x = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> + ($this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;olm&#39;</span>] - $this-&gt;pagedim[$oldpage][<span class="stringliteral">&#39;olm&#39;</span>]);</div>
<div class="line"><a name="l04993"></a><span class="lineno"> 4993</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l04994"></a><span class="lineno"> 4994</span>&#160;                        $this-&gt;x = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>;</div>
<div class="line"><a name="l04995"></a><span class="lineno"> 4995</span>&#160;                    }</div>
<div class="line"><a name="l04996"></a><span class="lineno"> 4996</span>&#160;                }</div>
<div class="line"><a name="l04997"></a><span class="lineno"> 4997</span>&#160;            }</div>
<div class="line"><a name="l04998"></a><span class="lineno"> 4998</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l04999"></a><span class="lineno"> 4999</span>&#160;        }</div>
<div class="line"><a name="l05000"></a><span class="lineno"> 5000</span>&#160;        <span class="keywordflow">if</span> ($current_page != $this-&gt;page) {</div>
<div class="line"><a name="l05001"></a><span class="lineno"> 5001</span>&#160;            <span class="comment">// account for columns mode</span></div>
<div class="line"><a name="l05002"></a><span class="lineno"> 5002</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l05003"></a><span class="lineno"> 5003</span>&#160;        }</div>
<div class="line"><a name="l05004"></a><span class="lineno"> 5004</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05005"></a><span class="lineno"> 5005</span>&#160;    }</div>
<div class="line"><a name="l05006"></a><span class="lineno"> 5006</span>&#160;</div>
<div class="line"><a name="l05026"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a33b265e5eb3e4d1d4fedfe29f8166f31"> 5026</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a33b265e5eb3e4d1d4fedfe29f8166f31">Cell</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>=0, $txt=<span class="stringliteral">&#39;&#39;</span>, $border=0, $ln=0, $align=<span class="stringliteral">&#39;&#39;</span>, $fill=<span class="keyword">false</span>, $link=<span class="stringliteral">&#39;&#39;</span>, $stretch=0, $ignore_min_height=<span class="keyword">false</span>, $calign=<span class="charliteral">&#39;T&#39;</span>, $valign=<span class="charliteral">&#39;M&#39;</span>) {</div>
<div class="line"><a name="l05027"></a><span class="lineno"> 5027</span>&#160;        $prev_cell_margin = <a class="code" href="../../d4/d40/classTCPDF.html#a6decef4569cfd79d75e47cab1315fa77">$this-&gt;cell_margin</a>;</div>
<div class="line"><a name="l05028"></a><span class="lineno"> 5028</span>&#160;        $prev_cell_padding = <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$this-&gt;cell_padding</a>;</div>
<div class="line"><a name="l05029"></a><span class="lineno"> 5029</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a574cf231b14aa43921ac83716b27b3e4">adjustCellPadding</a>($border);</div>
<div class="line"><a name="l05030"></a><span class="lineno"> 5030</span>&#160;        <span class="keywordflow">if</span> (!$ignore_min_height) {</div>
<div class="line"><a name="l05031"></a><span class="lineno"> 5031</span>&#160;            $min_cell_height = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a25c7f71b3fcb19024497ea620f885346">getCellHeight</a>($this-&gt;FontSize);</div>
<div class="line"><a name="l05032"></a><span class="lineno"> 5032</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> &lt; $min_cell_height) {</div>
<div class="line"><a name="l05033"></a><span class="lineno"> 5033</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> = $min_cell_height;</div>
<div class="line"><a name="l05034"></a><span class="lineno"> 5034</span>&#160;            }</div>
<div class="line"><a name="l05035"></a><span class="lineno"> 5035</span>&#160;        }</div>
<div class="line"><a name="l05036"></a><span class="lineno"> 5036</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a9e8e4b4d75485b8f1e3aa2133a811e50">checkPageBreak</a>(<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> + $this-&gt;cell_margin[<span class="charliteral">&#39;T&#39;</span>] + $this-&gt;cell_margin[<span class="charliteral">&#39;B&#39;</span>]);</div>
<div class="line"><a name="l05037"></a><span class="lineno"> 5037</span>&#160;        <span class="comment">// apply text shadow if enabled</span></div>
<div class="line"><a name="l05038"></a><span class="lineno"> 5038</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;txtshadow[<span class="stringliteral">&#39;enabled&#39;</span>]) {</div>
<div class="line"><a name="l05039"></a><span class="lineno"> 5039</span>&#160;            <span class="comment">// save data</span></div>
<div class="line"><a name="l05040"></a><span class="lineno"> 5040</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$this-&gt;x</a>;</div>
<div class="line"><a name="l05041"></a><span class="lineno"> 5041</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l05042"></a><span class="lineno"> 5042</span>&#160;            $bc = <a class="code" href="../../d4/d40/classTCPDF.html#ae46a35098766581d1ad9ba173b17da5f">$this-&gt;bgcolor</a>;</div>
<div class="line"><a name="l05043"></a><span class="lineno"> 5043</span>&#160;            $fc = <a class="code" href="../../d4/d40/classTCPDF.html#a98585a6dd732caf2ba4c0ae2d9aa9841">$this-&gt;fgcolor</a>;</div>
<div class="line"><a name="l05044"></a><span class="lineno"> 5044</span>&#160;            $sc = <a class="code" href="../../d4/d40/classTCPDF.html#aa24f8123d1e2d35446002d13a9715850">$this-&gt;strokecolor</a>;</div>
<div class="line"><a name="l05045"></a><span class="lineno"> 5045</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#ae4a86c2e1ba1b7026fbfb1eb43845f1a">$alpha</a> = <a class="code" href="../../d4/d40/classTCPDF.html#ae4a86c2e1ba1b7026fbfb1eb43845f1a">$this-&gt;alpha</a>;</div>
<div class="line"><a name="l05046"></a><span class="lineno"> 5046</span>&#160;            <span class="comment">// print shadow</span></div>
<div class="line"><a name="l05047"></a><span class="lineno"> 5047</span>&#160;            $this-&gt;x += $this-&gt;txtshadow[<span class="stringliteral">&#39;depth_w&#39;</span>];</div>
<div class="line"><a name="l05048"></a><span class="lineno"> 5048</span>&#160;            $this-&gt;y += $this-&gt;txtshadow[<span class="stringliteral">&#39;depth_h&#39;</span>];</div>
<div class="line"><a name="l05049"></a><span class="lineno"> 5049</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a850dd347f649c99548a193f2b84a502e">SetFillColorArray</a>($this-&gt;txtshadow[<span class="stringliteral">&#39;color&#39;</span>]);</div>
<div class="line"><a name="l05050"></a><span class="lineno"> 5050</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ae6e2854e4d5c71966ef5121934c24566">SetTextColorArray</a>($this-&gt;txtshadow[<span class="stringliteral">&#39;color&#39;</span>]);</div>
<div class="line"><a name="l05051"></a><span class="lineno"> 5051</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8f3481f3ce8a4fcd40ac1e1a6bd8960e">SetDrawColorArray</a>($this-&gt;txtshadow[<span class="stringliteral">&#39;color&#39;</span>]);</div>
<div class="line"><a name="l05052"></a><span class="lineno"> 5052</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;txtshadow[<span class="stringliteral">&#39;opacity&#39;</span>] != <a class="code" href="../../d4/d40/classTCPDF.html#ae4a86c2e1ba1b7026fbfb1eb43845f1a">$alpha</a>[<span class="stringliteral">&#39;CA&#39;</span>]) {</div>
<div class="line"><a name="l05053"></a><span class="lineno"> 5053</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4624d23bdfb5df6a8760b63602d8b203">setAlpha</a>($this-&gt;txtshadow[<span class="stringliteral">&#39;opacity&#39;</span>], $this-&gt;txtshadow[<span class="stringliteral">&#39;blend_mode&#39;</span>]);</div>
<div class="line"><a name="l05054"></a><span class="lineno"> 5054</span>&#160;            }</div>
<div class="line"><a name="l05055"></a><span class="lineno"> 5055</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;state == 2) {</div>
<div class="line"><a name="l05056"></a><span class="lineno"> 5056</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa064c22c3ff653664433fc4e05fa8efc">getCellCode</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $txt, $border, $ln, $align, $fill, $link, $stretch, <span class="keyword">true</span>, $calign, $valign));</div>
<div class="line"><a name="l05057"></a><span class="lineno"> 5057</span>&#160;            }</div>
<div class="line"><a name="l05058"></a><span class="lineno"> 5058</span>&#160;            <span class="comment">//restore data</span></div>
<div class="line"><a name="l05059"></a><span class="lineno"> 5059</span>&#160;            $this-&gt;x = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>;</div>
<div class="line"><a name="l05060"></a><span class="lineno"> 5060</span>&#160;            $this-&gt;y = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>;</div>
<div class="line"><a name="l05061"></a><span class="lineno"> 5061</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a850dd347f649c99548a193f2b84a502e">SetFillColorArray</a>($bc);</div>
<div class="line"><a name="l05062"></a><span class="lineno"> 5062</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ae6e2854e4d5c71966ef5121934c24566">SetTextColorArray</a>($fc);</div>
<div class="line"><a name="l05063"></a><span class="lineno"> 5063</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8f3481f3ce8a4fcd40ac1e1a6bd8960e">SetDrawColorArray</a>($sc);</div>
<div class="line"><a name="l05064"></a><span class="lineno"> 5064</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;txtshadow[<span class="stringliteral">&#39;opacity&#39;</span>] != <a class="code" href="../../d4/d40/classTCPDF.html#ae4a86c2e1ba1b7026fbfb1eb43845f1a">$alpha</a>[<span class="stringliteral">&#39;CA&#39;</span>]) {</div>
<div class="line"><a name="l05065"></a><span class="lineno"> 5065</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4624d23bdfb5df6a8760b63602d8b203">setAlpha</a>(<a class="code" href="../../d4/d40/classTCPDF.html#ae4a86c2e1ba1b7026fbfb1eb43845f1a">$alpha</a>[<span class="stringliteral">&#39;CA&#39;</span>], <a class="code" href="../../d4/d40/classTCPDF.html#ae4a86c2e1ba1b7026fbfb1eb43845f1a">$alpha</a>[<span class="stringliteral">&#39;BM&#39;</span>], <a class="code" href="../../d4/d40/classTCPDF.html#ae4a86c2e1ba1b7026fbfb1eb43845f1a">$alpha</a>[<span class="stringliteral">&#39;ca&#39;</span>], <a class="code" href="../../d4/d40/classTCPDF.html#ae4a86c2e1ba1b7026fbfb1eb43845f1a">$alpha</a>[<span class="stringliteral">&#39;AIS&#39;</span>]);</div>
<div class="line"><a name="l05066"></a><span class="lineno"> 5066</span>&#160;            }</div>
<div class="line"><a name="l05067"></a><span class="lineno"> 5067</span>&#160;        }</div>
<div class="line"><a name="l05068"></a><span class="lineno"> 5068</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;state == 2) {</div>
<div class="line"><a name="l05069"></a><span class="lineno"> 5069</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa064c22c3ff653664433fc4e05fa8efc">getCellCode</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $txt, $border, $ln, $align, $fill, $link, $stretch, <span class="keyword">true</span>, $calign, $valign));</div>
<div class="line"><a name="l05070"></a><span class="lineno"> 5070</span>&#160;        }</div>
<div class="line"><a name="l05071"></a><span class="lineno"> 5071</span>&#160;        $this-&gt;cell_padding = $prev_cell_padding;</div>
<div class="line"><a name="l05072"></a><span class="lineno"> 5072</span>&#160;        $this-&gt;cell_margin = $prev_cell_margin;</div>
<div class="line"><a name="l05073"></a><span class="lineno"> 5073</span>&#160;    }</div>
<div class="line"><a name="l05074"></a><span class="lineno"> 5074</span>&#160;</div>
<div class="line"><a name="l05095"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aa064c22c3ff653664433fc4e05fa8efc"> 5095</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#aa064c22c3ff653664433fc4e05fa8efc">getCellCode</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>=0, $txt=<span class="stringliteral">&#39;&#39;</span>, $border=0, $ln=0, $align=<span class="stringliteral">&#39;&#39;</span>, $fill=<span class="keyword">false</span>, $link=<span class="stringliteral">&#39;&#39;</span>, $stretch=0, $ignore_min_height=<span class="keyword">false</span>, $calign=<span class="charliteral">&#39;T&#39;</span>, $valign=<span class="charliteral">&#39;M&#39;</span>) {</div>
<div class="line"><a name="l05096"></a><span class="lineno"> 5096</span>&#160;        <span class="comment">// replace &#39;NO-BREAK SPACE&#39; (U+00A0) character with a simple space</span></div>
<div class="line"><a name="l05097"></a><span class="lineno"> 5097</span>&#160;        $txt = str_replace(TCPDF_FONTS::unichr(160, $this-&gt;isunicode), <span class="charliteral">&#39; &#39;</span>, $txt);</div>
<div class="line"><a name="l05098"></a><span class="lineno"> 5098</span>&#160;        $prev_cell_margin = <a class="code" href="../../d4/d40/classTCPDF.html#a6decef4569cfd79d75e47cab1315fa77">$this-&gt;cell_margin</a>;</div>
<div class="line"><a name="l05099"></a><span class="lineno"> 5099</span>&#160;        $prev_cell_padding = <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$this-&gt;cell_padding</a>;</div>
<div class="line"><a name="l05100"></a><span class="lineno"> 5100</span>&#160;        $txt = TCPDF_STATIC::removeSHY($txt, $this-&gt;isunicode);</div>
<div class="line"><a name="l05101"></a><span class="lineno"> 5101</span>&#160;        $rs = <span class="stringliteral">&#39;&#39;</span>; <span class="comment">//string to be returned</span></div>
<div class="line"><a name="l05102"></a><span class="lineno"> 5102</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a574cf231b14aa43921ac83716b27b3e4">adjustCellPadding</a>($border);</div>
<div class="line"><a name="l05103"></a><span class="lineno"> 5103</span>&#160;        <span class="keywordflow">if</span> (!$ignore_min_height) {</div>
<div class="line"><a name="l05104"></a><span class="lineno"> 5104</span>&#160;            $min_cell_height = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a25c7f71b3fcb19024497ea620f885346">getCellHeight</a>($this-&gt;FontSize);</div>
<div class="line"><a name="l05105"></a><span class="lineno"> 5105</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> &lt; $min_cell_height) {</div>
<div class="line"><a name="l05106"></a><span class="lineno"> 5106</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> = $min_cell_height;</div>
<div class="line"><a name="l05107"></a><span class="lineno"> 5107</span>&#160;            }</div>
<div class="line"><a name="l05108"></a><span class="lineno"> 5108</span>&#160;        }</div>
<div class="line"><a name="l05109"></a><span class="lineno"> 5109</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a> = <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>;</div>
<div class="line"><a name="l05110"></a><span class="lineno"> 5110</span>&#160;        <span class="comment">// check page for no-write regions and adapt page margins if necessary</span></div>
<div class="line"><a name="l05111"></a><span class="lineno"> 5111</span>&#160;        list($this-&gt;x, $this-&gt;y) = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1d99e81697a90efb13a6734001427f40">checkPageRegions</a>(<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $this-&gt;x, $this-&gt;y);</div>
<div class="line"><a name="l05112"></a><span class="lineno"> 5112</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l05113"></a><span class="lineno"> 5113</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> = $this-&gt;x - $this-&gt;cell_margin[<span class="charliteral">&#39;R&#39;</span>];</div>
<div class="line"><a name="l05114"></a><span class="lineno"> 5114</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05115"></a><span class="lineno"> 5115</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> = $this-&gt;x + $this-&gt;cell_margin[<span class="charliteral">&#39;L&#39;</span>];</div>
<div class="line"><a name="l05116"></a><span class="lineno"> 5116</span>&#160;        }</div>
<div class="line"><a name="l05117"></a><span class="lineno"> 5117</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> = $this-&gt;y + $this-&gt;cell_margin[<span class="charliteral">&#39;T&#39;</span>];</div>
<div class="line"><a name="l05118"></a><span class="lineno"> 5118</span>&#160;        $prev_font_stretching = <a class="code" href="../../d4/d40/classTCPDF.html#a420a1fac2969936a7d57f4cb9c99849b">$this-&gt;font_stretching</a>;</div>
<div class="line"><a name="l05119"></a><span class="lineno"> 5119</span>&#160;        $prev_font_spacing = <a class="code" href="../../d4/d40/classTCPDF.html#a3f4d91c3489a2c62b628c347551f7adf">$this-&gt;font_spacing</a>;</div>
<div class="line"><a name="l05120"></a><span class="lineno"> 5120</span>&#160;        <span class="comment">// cell vertical alignment</span></div>
<div class="line"><a name="l05121"></a><span class="lineno"> 5121</span>&#160;        <span class="keywordflow">switch</span> ($calign) {</div>
<div class="line"><a name="l05122"></a><span class="lineno"> 5122</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;A&#39;</span>: {</div>
<div class="line"><a name="l05123"></a><span class="lineno"> 5123</span>&#160;                <span class="comment">// font top</span></div>
<div class="line"><a name="l05124"></a><span class="lineno"> 5124</span>&#160;                <span class="keywordflow">switch</span> ($valign) {</div>
<div class="line"><a name="l05125"></a><span class="lineno"> 5125</span>&#160;                    <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>: {</div>
<div class="line"><a name="l05126"></a><span class="lineno"> 5126</span>&#160;                        <span class="comment">// top</span></div>
<div class="line"><a name="l05127"></a><span class="lineno"> 5127</span>&#160;                        <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> -= $this-&gt;cell_padding[<span class="charliteral">&#39;T&#39;</span>];</div>
<div class="line"><a name="l05128"></a><span class="lineno"> 5128</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05129"></a><span class="lineno"> 5129</span>&#160;                    }</div>
<div class="line"><a name="l05130"></a><span class="lineno"> 5130</span>&#160;                    <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>: {</div>
<div class="line"><a name="l05131"></a><span class="lineno"> 5131</span>&#160;                        <span class="comment">// bottom</span></div>
<div class="line"><a name="l05132"></a><span class="lineno"> 5132</span>&#160;                        <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> -= (<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> - $this-&gt;cell_padding[<span class="charliteral">&#39;B&#39;</span>] - $this-&gt;FontAscent - <a class="code" href="../../d4/d40/classTCPDF.html#a7f6ac3771776732243563ec438ab055f">$this-&gt;FontDescent</a>);</div>
<div class="line"><a name="l05133"></a><span class="lineno"> 5133</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05134"></a><span class="lineno"> 5134</span>&#160;                    }</div>
<div class="line"><a name="l05135"></a><span class="lineno"> 5135</span>&#160;                    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l05136"></a><span class="lineno"> 5136</span>&#160;                    <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>:</div>
<div class="line"><a name="l05137"></a><span class="lineno"> 5137</span>&#160;                    <span class="keywordflow">case</span> <span class="charliteral">&#39;M&#39;</span>: {</div>
<div class="line"><a name="l05138"></a><span class="lineno"> 5138</span>&#160;                        <span class="comment">// center</span></div>
<div class="line"><a name="l05139"></a><span class="lineno"> 5139</span>&#160;                        <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> -= ((<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> - $this-&gt;FontAscent - <a class="code" href="../../d4/d40/classTCPDF.html#a7f6ac3771776732243563ec438ab055f">$this-&gt;FontDescent</a>) / 2);</div>
<div class="line"><a name="l05140"></a><span class="lineno"> 5140</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05141"></a><span class="lineno"> 5141</span>&#160;                    }</div>
<div class="line"><a name="l05142"></a><span class="lineno"> 5142</span>&#160;                }</div>
<div class="line"><a name="l05143"></a><span class="lineno"> 5143</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05144"></a><span class="lineno"> 5144</span>&#160;            }</div>
<div class="line"><a name="l05145"></a><span class="lineno"> 5145</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;L&#39;</span>: {</div>
<div class="line"><a name="l05146"></a><span class="lineno"> 5146</span>&#160;                <span class="comment">// font baseline</span></div>
<div class="line"><a name="l05147"></a><span class="lineno"> 5147</span>&#160;                <span class="keywordflow">switch</span> ($valign) {</div>
<div class="line"><a name="l05148"></a><span class="lineno"> 5148</span>&#160;                    <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>: {</div>
<div class="line"><a name="l05149"></a><span class="lineno"> 5149</span>&#160;                        <span class="comment">// top</span></div>
<div class="line"><a name="l05150"></a><span class="lineno"> 5150</span>&#160;                        <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> -= ($this-&gt;cell_padding[<span class="charliteral">&#39;T&#39;</span>] + <a class="code" href="../../d4/d40/classTCPDF.html#a628e3e22a136173a0bac253ce9842c56">$this-&gt;FontAscent</a>);</div>
<div class="line"><a name="l05151"></a><span class="lineno"> 5151</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05152"></a><span class="lineno"> 5152</span>&#160;                    }</div>
<div class="line"><a name="l05153"></a><span class="lineno"> 5153</span>&#160;                    <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>: {</div>
<div class="line"><a name="l05154"></a><span class="lineno"> 5154</span>&#160;                        <span class="comment">// bottom</span></div>
<div class="line"><a name="l05155"></a><span class="lineno"> 5155</span>&#160;                        <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> -= (<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> - $this-&gt;cell_padding[<span class="charliteral">&#39;B&#39;</span>] - <a class="code" href="../../d4/d40/classTCPDF.html#a7f6ac3771776732243563ec438ab055f">$this-&gt;FontDescent</a>);</div>
<div class="line"><a name="l05156"></a><span class="lineno"> 5156</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05157"></a><span class="lineno"> 5157</span>&#160;                    }</div>
<div class="line"><a name="l05158"></a><span class="lineno"> 5158</span>&#160;                    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l05159"></a><span class="lineno"> 5159</span>&#160;                    <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>:</div>
<div class="line"><a name="l05160"></a><span class="lineno"> 5160</span>&#160;                    <span class="keywordflow">case</span> <span class="charliteral">&#39;M&#39;</span>: {</div>
<div class="line"><a name="l05161"></a><span class="lineno"> 5161</span>&#160;                        <span class="comment">// center</span></div>
<div class="line"><a name="l05162"></a><span class="lineno"> 5162</span>&#160;                        <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> -= ((<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> + $this-&gt;FontAscent - <a class="code" href="../../d4/d40/classTCPDF.html#a7f6ac3771776732243563ec438ab055f">$this-&gt;FontDescent</a>) / 2);</div>
<div class="line"><a name="l05163"></a><span class="lineno"> 5163</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05164"></a><span class="lineno"> 5164</span>&#160;                    }</div>
<div class="line"><a name="l05165"></a><span class="lineno"> 5165</span>&#160;                }</div>
<div class="line"><a name="l05166"></a><span class="lineno"> 5166</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05167"></a><span class="lineno"> 5167</span>&#160;            }</div>
<div class="line"><a name="l05168"></a><span class="lineno"> 5168</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;D&#39;</span>: {</div>
<div class="line"><a name="l05169"></a><span class="lineno"> 5169</span>&#160;                <span class="comment">// font bottom</span></div>
<div class="line"><a name="l05170"></a><span class="lineno"> 5170</span>&#160;                <span class="keywordflow">switch</span> ($valign) {</div>
<div class="line"><a name="l05171"></a><span class="lineno"> 5171</span>&#160;                    <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>: {</div>
<div class="line"><a name="l05172"></a><span class="lineno"> 5172</span>&#160;                        <span class="comment">// top</span></div>
<div class="line"><a name="l05173"></a><span class="lineno"> 5173</span>&#160;                        <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> -= ($this-&gt;cell_padding[<span class="charliteral">&#39;T&#39;</span>] + $this-&gt;FontAscent + <a class="code" href="../../d4/d40/classTCPDF.html#a7f6ac3771776732243563ec438ab055f">$this-&gt;FontDescent</a>);</div>
<div class="line"><a name="l05174"></a><span class="lineno"> 5174</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05175"></a><span class="lineno"> 5175</span>&#160;                    }</div>
<div class="line"><a name="l05176"></a><span class="lineno"> 5176</span>&#160;                    <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>: {</div>
<div class="line"><a name="l05177"></a><span class="lineno"> 5177</span>&#160;                        <span class="comment">// bottom</span></div>
<div class="line"><a name="l05178"></a><span class="lineno"> 5178</span>&#160;                        <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> -= (<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> - $this-&gt;cell_padding[<span class="charliteral">&#39;B&#39;</span>]);</div>
<div class="line"><a name="l05179"></a><span class="lineno"> 5179</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05180"></a><span class="lineno"> 5180</span>&#160;                    }</div>
<div class="line"><a name="l05181"></a><span class="lineno"> 5181</span>&#160;                    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l05182"></a><span class="lineno"> 5182</span>&#160;                    <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>:</div>
<div class="line"><a name="l05183"></a><span class="lineno"> 5183</span>&#160;                    <span class="keywordflow">case</span> <span class="charliteral">&#39;M&#39;</span>: {</div>
<div class="line"><a name="l05184"></a><span class="lineno"> 5184</span>&#160;                        <span class="comment">// center</span></div>
<div class="line"><a name="l05185"></a><span class="lineno"> 5185</span>&#160;                        <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> -= ((<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> + $this-&gt;FontAscent + <a class="code" href="../../d4/d40/classTCPDF.html#a7f6ac3771776732243563ec438ab055f">$this-&gt;FontDescent</a>) / 2);</div>
<div class="line"><a name="l05186"></a><span class="lineno"> 5186</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05187"></a><span class="lineno"> 5187</span>&#160;                    }</div>
<div class="line"><a name="l05188"></a><span class="lineno"> 5188</span>&#160;                }</div>
<div class="line"><a name="l05189"></a><span class="lineno"> 5189</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05190"></a><span class="lineno"> 5190</span>&#160;            }</div>
<div class="line"><a name="l05191"></a><span class="lineno"> 5191</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>: {</div>
<div class="line"><a name="l05192"></a><span class="lineno"> 5192</span>&#160;                <span class="comment">// cell bottom</span></div>
<div class="line"><a name="l05193"></a><span class="lineno"> 5193</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> -= <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>;</div>
<div class="line"><a name="l05194"></a><span class="lineno"> 5194</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05195"></a><span class="lineno"> 5195</span>&#160;            }</div>
<div class="line"><a name="l05196"></a><span class="lineno"> 5196</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>:</div>
<div class="line"><a name="l05197"></a><span class="lineno"> 5197</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;M&#39;</span>: {</div>
<div class="line"><a name="l05198"></a><span class="lineno"> 5198</span>&#160;                <span class="comment">// cell center</span></div>
<div class="line"><a name="l05199"></a><span class="lineno"> 5199</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> -= (<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> / 2);</div>
<div class="line"><a name="l05200"></a><span class="lineno"> 5200</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05201"></a><span class="lineno"> 5201</span>&#160;            }</div>
<div class="line"><a name="l05202"></a><span class="lineno"> 5202</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l05203"></a><span class="lineno"> 5203</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>: {</div>
<div class="line"><a name="l05204"></a><span class="lineno"> 5204</span>&#160;                <span class="comment">// cell top</span></div>
<div class="line"><a name="l05205"></a><span class="lineno"> 5205</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05206"></a><span class="lineno"> 5206</span>&#160;            }</div>
<div class="line"><a name="l05207"></a><span class="lineno"> 5207</span>&#160;        }</div>
<div class="line"><a name="l05208"></a><span class="lineno"> 5208</span>&#160;        <span class="comment">// text vertical alignment</span></div>
<div class="line"><a name="l05209"></a><span class="lineno"> 5209</span>&#160;        <span class="keywordflow">switch</span> ($valign) {</div>
<div class="line"><a name="l05210"></a><span class="lineno"> 5210</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>: {</div>
<div class="line"><a name="l05211"></a><span class="lineno"> 5211</span>&#160;                <span class="comment">// top</span></div>
<div class="line"><a name="l05212"></a><span class="lineno"> 5212</span>&#160;                $yt = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> + $this-&gt;cell_padding[<span class="charliteral">&#39;T&#39;</span>];</div>
<div class="line"><a name="l05213"></a><span class="lineno"> 5213</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05214"></a><span class="lineno"> 5214</span>&#160;            }</div>
<div class="line"><a name="l05215"></a><span class="lineno"> 5215</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>: {</div>
<div class="line"><a name="l05216"></a><span class="lineno"> 5216</span>&#160;                <span class="comment">// bottom</span></div>
<div class="line"><a name="l05217"></a><span class="lineno"> 5217</span>&#160;                $yt = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> + <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> - $this-&gt;cell_padding[<span class="charliteral">&#39;B&#39;</span>] - $this-&gt;FontAscent - <a class="code" href="../../d4/d40/classTCPDF.html#a7f6ac3771776732243563ec438ab055f">$this-&gt;FontDescent</a>;</div>
<div class="line"><a name="l05218"></a><span class="lineno"> 5218</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05219"></a><span class="lineno"> 5219</span>&#160;            }</div>
<div class="line"><a name="l05220"></a><span class="lineno"> 5220</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l05221"></a><span class="lineno"> 5221</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>:</div>
<div class="line"><a name="l05222"></a><span class="lineno"> 5222</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;M&#39;</span>: {</div>
<div class="line"><a name="l05223"></a><span class="lineno"> 5223</span>&#160;                <span class="comment">// center</span></div>
<div class="line"><a name="l05224"></a><span class="lineno"> 5224</span>&#160;                $yt = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> + ((<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> - $this-&gt;FontAscent - <a class="code" href="../../d4/d40/classTCPDF.html#a7f6ac3771776732243563ec438ab055f">$this-&gt;FontDescent</a>) / 2);</div>
<div class="line"><a name="l05225"></a><span class="lineno"> 5225</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05226"></a><span class="lineno"> 5226</span>&#160;            }</div>
<div class="line"><a name="l05227"></a><span class="lineno"> 5227</span>&#160;        }</div>
<div class="line"><a name="l05228"></a><span class="lineno"> 5228</span>&#160;        $basefonty = $yt + <a class="code" href="../../d4/d40/classTCPDF.html#a628e3e22a136173a0bac253ce9842c56">$this-&gt;FontAscent</a>;</div>
<div class="line"><a name="l05229"></a><span class="lineno"> 5229</span>&#160;        <span class="keywordflow">if</span> (TCPDF_STATIC::empty_string(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>) OR (<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> &lt;= 0)) {</div>
<div class="line"><a name="l05230"></a><span class="lineno"> 5230</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l05231"></a><span class="lineno"> 5231</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> - <a class="code" href="../../d4/d40/classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da">$this-&gt;lMargin</a>;</div>
<div class="line"><a name="l05232"></a><span class="lineno"> 5232</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05233"></a><span class="lineno"> 5233</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = $this-&gt;w - $this-&gt;rMargin - <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>;</div>
<div class="line"><a name="l05234"></a><span class="lineno"> 5234</span>&#160;            }</div>
<div class="line"><a name="l05235"></a><span class="lineno"> 5235</span>&#160;        }</div>
<div class="line"><a name="l05236"></a><span class="lineno"> 5236</span>&#160;        $s = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l05237"></a><span class="lineno"> 5237</span>&#160;        <span class="comment">// fill and borders</span></div>
<div class="line"><a name="l05238"></a><span class="lineno"> 5238</span>&#160;        <span class="keywordflow">if</span> (is_string($border) AND (strlen($border) == 4)) {</div>
<div class="line"><a name="l05239"></a><span class="lineno"> 5239</span>&#160;            <span class="comment">// full border</span></div>
<div class="line"><a name="l05240"></a><span class="lineno"> 5240</span>&#160;            $border = 1;</div>
<div class="line"><a name="l05241"></a><span class="lineno"> 5241</span>&#160;        }</div>
<div class="line"><a name="l05242"></a><span class="lineno"> 5242</span>&#160;        <span class="keywordflow">if</span> ($fill OR ($border == 1)) {</div>
<div class="line"><a name="l05243"></a><span class="lineno"> 5243</span>&#160;            <span class="keywordflow">if</span> ($fill) {</div>
<div class="line"><a name="l05244"></a><span class="lineno"> 5244</span>&#160;                $op = ($border == 1) ? <span class="charliteral">&#39;B&#39;</span> : <span class="charliteral">&#39;f&#39;</span>;</div>
<div class="line"><a name="l05245"></a><span class="lineno"> 5245</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05246"></a><span class="lineno"> 5246</span>&#160;                $op = <span class="charliteral">&#39;S&#39;</span>;</div>
<div class="line"><a name="l05247"></a><span class="lineno"> 5247</span>&#160;            }</div>
<div class="line"><a name="l05248"></a><span class="lineno"> 5248</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l05249"></a><span class="lineno"> 5249</span>&#160;                $xk = ((<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> - <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>) * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a>);</div>
<div class="line"><a name="l05250"></a><span class="lineno"> 5250</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05251"></a><span class="lineno"> 5251</span>&#160;                $xk = (<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a>);</div>
<div class="line"><a name="l05252"></a><span class="lineno"> 5252</span>&#160;            }</div>
<div class="line"><a name="l05253"></a><span class="lineno"> 5253</span>&#160;            $s .= sprintf(<span class="stringliteral">&#39;%F %F %F %F re %s &#39;</span>, $xk, (($this-&gt;h - <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>) * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a>), (<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> * $k), (-<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> * $k), $op);</div>
<div class="line"><a name="l05254"></a><span class="lineno"> 5254</span>&#160;        }</div>
<div class="line"><a name="l05255"></a><span class="lineno"> 5255</span>&#160;        <span class="comment">// draw borders</span></div>
<div class="line"><a name="l05256"></a><span class="lineno"> 5256</span>&#160;        $s .= $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a128e3d25eed996dbd78dd10be6f0c4c4">getCellBorder</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $border);</div>
<div class="line"><a name="l05257"></a><span class="lineno"> 5257</span>&#160;        <span class="keywordflow">if</span> ($txt != <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l05258"></a><span class="lineno"> 5258</span>&#160;            $txt2 = $txt;</div>
<div class="line"><a name="l05259"></a><span class="lineno"> 5259</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;isunicode) {</div>
<div class="line"><a name="l05260"></a><span class="lineno"> 5260</span>&#160;                <span class="keywordflow">if</span> (($this-&gt;CurrentFont[<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;core&#39;</span>) OR ($this-&gt;CurrentFont[<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;TrueType&#39;</span>) OR ($this-&gt;CurrentFont[<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;Type1&#39;</span>)) {</div>
<div class="line"><a name="l05261"></a><span class="lineno"> 5261</span>&#160;                    $txt2 = TCPDF_FONTS::UTF8ToLatin1($txt2, $this-&gt;isunicode, $this-&gt;CurrentFont);</div>
<div class="line"><a name="l05262"></a><span class="lineno"> 5262</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05263"></a><span class="lineno"> 5263</span>&#160;                    $unicode = TCPDF_FONTS::UTF8StringToArray($txt, $this-&gt;isunicode, $this-&gt;CurrentFont); <span class="comment">// array of UTF-8 unicode values</span></div>
<div class="line"><a name="l05264"></a><span class="lineno"> 5264</span>&#160;                    $unicode = TCPDF_FONTS::utf8Bidi($unicode, <span class="stringliteral">&#39;&#39;</span>, $this-&gt;tmprtl, $this-&gt;isunicode, $this-&gt;CurrentFont);</div>
<div class="line"><a name="l05265"></a><span class="lineno"> 5265</span>&#160;                    <span class="comment">// replace thai chars (if any)</span></div>
<div class="line"><a name="l05266"></a><span class="lineno"> 5266</span>&#160;                    <span class="keywordflow">if</span> (defined(<span class="stringliteral">&#39;K_THAI_TOPCHARS&#39;</span>) AND (<a class="code" href="../../d5/dc0/tcpdf__config_8php.html#a47cb3659c4650130ba258727ca17f510">K_THAI_TOPCHARS</a> == <span class="keyword">true</span>)) {</div>
<div class="line"><a name="l05267"></a><span class="lineno"> 5267</span>&#160;                        <span class="comment">// number of chars</span></div>
<div class="line"><a name="l05268"></a><span class="lineno"> 5268</span>&#160;                        $numchars = count($unicode);</div>
<div class="line"><a name="l05269"></a><span class="lineno"> 5269</span>&#160;                        <span class="comment">// po pla, for far, for fan</span></div>
<div class="line"><a name="l05270"></a><span class="lineno"> 5270</span>&#160;                        $longtail = array(0x0e1b, 0x0e1d, 0x0e1f);</div>
<div class="line"><a name="l05271"></a><span class="lineno"> 5271</span>&#160;                        <span class="comment">// do chada, to patak</span></div>
<div class="line"><a name="l05272"></a><span class="lineno"> 5272</span>&#160;                        $lowtail = array(0x0e0e, 0x0e0f);</div>
<div class="line"><a name="l05273"></a><span class="lineno"> 5273</span>&#160;                        <span class="comment">// mai hun arkad, sara i, sara ii, sara ue, sara uee</span></div>
<div class="line"><a name="l05274"></a><span class="lineno"> 5274</span>&#160;                        $upvowel = array(0x0e31, 0x0e34, 0x0e35, 0x0e36, 0x0e37);</div>
<div class="line"><a name="l05275"></a><span class="lineno"> 5275</span>&#160;                        <span class="comment">// mai ek, mai tho, mai tri, mai chattawa, karan</span></div>
<div class="line"><a name="l05276"></a><span class="lineno"> 5276</span>&#160;                        $tonemark = array(0x0e48, 0x0e49, 0x0e4a, 0x0e4b, 0x0e4c);</div>
<div class="line"><a name="l05277"></a><span class="lineno"> 5277</span>&#160;                        <span class="comment">// sara u, sara uu, pinthu</span></div>
<div class="line"><a name="l05278"></a><span class="lineno"> 5278</span>&#160;                        $lowvowel = array(0x0e38, 0x0e39, 0x0e3a);</div>
<div class="line"><a name="l05279"></a><span class="lineno"> 5279</span>&#160;                        $output = array();</div>
<div class="line"><a name="l05280"></a><span class="lineno"> 5280</span>&#160;                        <span class="keywordflow">for</span> ($i = 0; $i &lt; $numchars; $i++) {</div>
<div class="line"><a name="l05281"></a><span class="lineno"> 5281</span>&#160;                            <span class="keywordflow">if</span> (($unicode[$i] &gt;= 0x0e00) &amp;&amp; ($unicode[$i] &lt;= 0x0e5b)) {</div>
<div class="line"><a name="l05282"></a><span class="lineno"> 5282</span>&#160;                                $ch0 = $unicode[$i];</div>
<div class="line"><a name="l05283"></a><span class="lineno"> 5283</span>&#160;                                $ch1 = ($i &gt; 0) ? $unicode[($i - 1)] : 0;</div>
<div class="line"><a name="l05284"></a><span class="lineno"> 5284</span>&#160;                                $ch2 = ($i &gt; 1) ? $unicode[($i - 2)] : 0;</div>
<div class="line"><a name="l05285"></a><span class="lineno"> 5285</span>&#160;                                $chn = ($i &lt; ($numchars - 1)) ? $unicode[($i + 1)] : 0;</div>
<div class="line"><a name="l05286"></a><span class="lineno"> 5286</span>&#160;                                <span class="keywordflow">if</span> (in_array($ch0, $tonemark)) {</div>
<div class="line"><a name="l05287"></a><span class="lineno"> 5287</span>&#160;                                    <span class="keywordflow">if</span> ($chn == 0x0e33) {</div>
<div class="line"><a name="l05288"></a><span class="lineno"> 5288</span>&#160;                                        <span class="comment">// sara um</span></div>
<div class="line"><a name="l05289"></a><span class="lineno"> 5289</span>&#160;                                        <span class="keywordflow">if</span> (in_array($ch1, $longtail)) {</div>
<div class="line"><a name="l05290"></a><span class="lineno"> 5290</span>&#160;                                            <span class="comment">// tonemark at upper left</span></div>
<div class="line"><a name="l05291"></a><span class="lineno"> 5291</span>&#160;                                            $output[] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a968b07e5ebb6722f7c6a649e083fccd9">replaceChar</a>($ch0, (0xf713 + $ch0 - 0x0e48));</div>
<div class="line"><a name="l05292"></a><span class="lineno"> 5292</span>&#160;                                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05293"></a><span class="lineno"> 5293</span>&#160;                                            <span class="comment">// tonemark at upper right (normal position)</span></div>
<div class="line"><a name="l05294"></a><span class="lineno"> 5294</span>&#160;                                            $output[] = $ch0;</div>
<div class="line"><a name="l05295"></a><span class="lineno"> 5295</span>&#160;                                        }</div>
<div class="line"><a name="l05296"></a><span class="lineno"> 5296</span>&#160;                                    } elseif (in_array($ch1, $longtail) OR (in_array($ch2, $longtail) AND in_array($ch1, $lowvowel))) {</div>
<div class="line"><a name="l05297"></a><span class="lineno"> 5297</span>&#160;                                        <span class="comment">// tonemark at lower left</span></div>
<div class="line"><a name="l05298"></a><span class="lineno"> 5298</span>&#160;                                        $output[] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a968b07e5ebb6722f7c6a649e083fccd9">replaceChar</a>($ch0, (0xf705 + $ch0 - 0x0e48));</div>
<div class="line"><a name="l05299"></a><span class="lineno"> 5299</span>&#160;                                    } elseif (in_array($ch1, $upvowel)) {</div>
<div class="line"><a name="l05300"></a><span class="lineno"> 5300</span>&#160;                                        <span class="keywordflow">if</span> (in_array($ch2, $longtail)) {</div>
<div class="line"><a name="l05301"></a><span class="lineno"> 5301</span>&#160;                                            <span class="comment">// tonemark at upper left</span></div>
<div class="line"><a name="l05302"></a><span class="lineno"> 5302</span>&#160;                                            $output[] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a968b07e5ebb6722f7c6a649e083fccd9">replaceChar</a>($ch0, (0xf713 + $ch0 - 0x0e48));</div>
<div class="line"><a name="l05303"></a><span class="lineno"> 5303</span>&#160;                                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05304"></a><span class="lineno"> 5304</span>&#160;                                            <span class="comment">// tonemark at upper right (normal position)</span></div>
<div class="line"><a name="l05305"></a><span class="lineno"> 5305</span>&#160;                                            $output[] = $ch0;</div>
<div class="line"><a name="l05306"></a><span class="lineno"> 5306</span>&#160;                                        }</div>
<div class="line"><a name="l05307"></a><span class="lineno"> 5307</span>&#160;                                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05308"></a><span class="lineno"> 5308</span>&#160;                                        <span class="comment">// tonemark at lower right</span></div>
<div class="line"><a name="l05309"></a><span class="lineno"> 5309</span>&#160;                                        $output[] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a968b07e5ebb6722f7c6a649e083fccd9">replaceChar</a>($ch0, (0xf70a + $ch0 - 0x0e48));</div>
<div class="line"><a name="l05310"></a><span class="lineno"> 5310</span>&#160;                                    }</div>
<div class="line"><a name="l05311"></a><span class="lineno"> 5311</span>&#160;                                } elseif (($ch0 == 0x0e33) AND (in_array($ch1, $longtail) OR (in_array($ch2, $longtail) AND in_array($ch1, $tonemark)))) {</div>
<div class="line"><a name="l05312"></a><span class="lineno"> 5312</span>&#160;                                    <span class="comment">// add lower left nikhahit and sara aa</span></div>
<div class="line"><a name="l05313"></a><span class="lineno"> 5313</span>&#160;                                    <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a458536902daa1aaead2c627dcf71e66b">isCharDefined</a>(0xf711) AND $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a458536902daa1aaead2c627dcf71e66b">isCharDefined</a>(0x0e32)) {</div>
<div class="line"><a name="l05314"></a><span class="lineno"> 5314</span>&#160;                                        $output[] = 0xf711;</div>
<div class="line"><a name="l05315"></a><span class="lineno"> 5315</span>&#160;                                        $this-&gt;CurrentFont[<span class="stringliteral">&#39;subsetchars&#39;</span>][0xf711] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05316"></a><span class="lineno"> 5316</span>&#160;                                        $output[] = 0x0e32;</div>
<div class="line"><a name="l05317"></a><span class="lineno"> 5317</span>&#160;                                        $this-&gt;CurrentFont[<span class="stringliteral">&#39;subsetchars&#39;</span>][0x0e32] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05318"></a><span class="lineno"> 5318</span>&#160;                                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05319"></a><span class="lineno"> 5319</span>&#160;                                        $output[] = $ch0;</div>
<div class="line"><a name="l05320"></a><span class="lineno"> 5320</span>&#160;                                    }</div>
<div class="line"><a name="l05321"></a><span class="lineno"> 5321</span>&#160;                                } elseif (in_array($ch1, $longtail)) {</div>
<div class="line"><a name="l05322"></a><span class="lineno"> 5322</span>&#160;                                    <span class="keywordflow">if</span> ($ch0 == 0x0e31) {</div>
<div class="line"><a name="l05323"></a><span class="lineno"> 5323</span>&#160;                                        <span class="comment">// lower left mai hun arkad</span></div>
<div class="line"><a name="l05324"></a><span class="lineno"> 5324</span>&#160;                                        $output[] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a968b07e5ebb6722f7c6a649e083fccd9">replaceChar</a>($ch0, 0xf710);</div>
<div class="line"><a name="l05325"></a><span class="lineno"> 5325</span>&#160;                                    } elseif (in_array($ch0, $upvowel)) {</div>
<div class="line"><a name="l05326"></a><span class="lineno"> 5326</span>&#160;                                        <span class="comment">// lower left</span></div>
<div class="line"><a name="l05327"></a><span class="lineno"> 5327</span>&#160;                                        $output[] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a968b07e5ebb6722f7c6a649e083fccd9">replaceChar</a>($ch0, (0xf701 + $ch0 - 0x0e34));</div>
<div class="line"><a name="l05328"></a><span class="lineno"> 5328</span>&#160;                                    } elseif ($ch0 == 0x0e47) {</div>
<div class="line"><a name="l05329"></a><span class="lineno"> 5329</span>&#160;                                        <span class="comment">// lower left mai tai koo</span></div>
<div class="line"><a name="l05330"></a><span class="lineno"> 5330</span>&#160;                                        $output[] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a968b07e5ebb6722f7c6a649e083fccd9">replaceChar</a>($ch0, 0xf712);</div>
<div class="line"><a name="l05331"></a><span class="lineno"> 5331</span>&#160;                                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05332"></a><span class="lineno"> 5332</span>&#160;                                        <span class="comment">// normal character</span></div>
<div class="line"><a name="l05333"></a><span class="lineno"> 5333</span>&#160;                                        $output[] = $ch0;</div>
<div class="line"><a name="l05334"></a><span class="lineno"> 5334</span>&#160;                                    }</div>
<div class="line"><a name="l05335"></a><span class="lineno"> 5335</span>&#160;                                } elseif (in_array($ch1, $lowtail) AND in_array($ch0, $lowvowel)) {</div>
<div class="line"><a name="l05336"></a><span class="lineno"> 5336</span>&#160;                                    <span class="comment">// lower vowel</span></div>
<div class="line"><a name="l05337"></a><span class="lineno"> 5337</span>&#160;                                    $output[] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a968b07e5ebb6722f7c6a649e083fccd9">replaceChar</a>($ch0, (0xf718 + $ch0 - 0x0e38));</div>
<div class="line"><a name="l05338"></a><span class="lineno"> 5338</span>&#160;                                } elseif (($ch0 == 0x0e0d) AND in_array($chn, $lowvowel)) {</div>
<div class="line"><a name="l05339"></a><span class="lineno"> 5339</span>&#160;                                    <span class="comment">// yo ying without lower part</span></div>
<div class="line"><a name="l05340"></a><span class="lineno"> 5340</span>&#160;                                    $output[] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a968b07e5ebb6722f7c6a649e083fccd9">replaceChar</a>($ch0, 0xf70f);</div>
<div class="line"><a name="l05341"></a><span class="lineno"> 5341</span>&#160;                                } elseif (($ch0 == 0x0e10) AND in_array($chn, $lowvowel)) {</div>
<div class="line"><a name="l05342"></a><span class="lineno"> 5342</span>&#160;                                    <span class="comment">// tho santan without lower part</span></div>
<div class="line"><a name="l05343"></a><span class="lineno"> 5343</span>&#160;                                    $output[] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a968b07e5ebb6722f7c6a649e083fccd9">replaceChar</a>($ch0, 0xf700);</div>
<div class="line"><a name="l05344"></a><span class="lineno"> 5344</span>&#160;                                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05345"></a><span class="lineno"> 5345</span>&#160;                                    $output[] = $ch0;</div>
<div class="line"><a name="l05346"></a><span class="lineno"> 5346</span>&#160;                                }</div>
<div class="line"><a name="l05347"></a><span class="lineno"> 5347</span>&#160;                            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05348"></a><span class="lineno"> 5348</span>&#160;                                <span class="comment">// non-thai character</span></div>
<div class="line"><a name="l05349"></a><span class="lineno"> 5349</span>&#160;                                $output[] = $unicode[$i];</div>
<div class="line"><a name="l05350"></a><span class="lineno"> 5350</span>&#160;                            }</div>
<div class="line"><a name="l05351"></a><span class="lineno"> 5351</span>&#160;                        }</div>
<div class="line"><a name="l05352"></a><span class="lineno"> 5352</span>&#160;                        $unicode = $output;</div>
<div class="line"><a name="l05353"></a><span class="lineno"> 5353</span>&#160;                        <span class="comment">// update font subsetchars</span></div>
<div class="line"><a name="l05354"></a><span class="lineno"> 5354</span>&#160;                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac6009bf1f27a31ee208d9687cb4b91eb">setFontSubBuffer</a>($this-&gt;CurrentFont[<span class="stringliteral">&#39;fontkey&#39;</span>], <span class="stringliteral">&#39;subsetchars&#39;</span>, $this-&gt;CurrentFont[<span class="stringliteral">&#39;subsetchars&#39;</span>]);</div>
<div class="line"><a name="l05355"></a><span class="lineno"> 5355</span>&#160;                    } <span class="comment">// end of K_THAI_TOPCHARS</span></div>
<div class="line"><a name="l05356"></a><span class="lineno"> 5356</span>&#160;                    $txt2 = TCPDF_FONTS::arrUTF8ToUTF16BE($unicode, <span class="keyword">false</span>);</div>
<div class="line"><a name="l05357"></a><span class="lineno"> 5357</span>&#160;                }</div>
<div class="line"><a name="l05358"></a><span class="lineno"> 5358</span>&#160;            }</div>
<div class="line"><a name="l05359"></a><span class="lineno"> 5359</span>&#160;            $txt2 = TCPDF_STATIC::_escape($txt2);</div>
<div class="line"><a name="l05360"></a><span class="lineno"> 5360</span>&#160;            <span class="comment">// get current text width (considering general font stretching and spacing)</span></div>
<div class="line"><a name="l05361"></a><span class="lineno"> 5361</span>&#160;            $txwidth = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8075c1f04b6fbddc957cff786c4b16d9">GetStringWidth</a>($txt);</div>
<div class="line"><a name="l05362"></a><span class="lineno"> 5362</span>&#160;            $width = $txwidth;</div>
<div class="line"><a name="l05363"></a><span class="lineno"> 5363</span>&#160;            <span class="comment">// check for stretch mode</span></div>
<div class="line"><a name="l05364"></a><span class="lineno"> 5364</span>&#160;            <span class="keywordflow">if</span> ($stretch &gt; 0) {</div>
<div class="line"><a name="l05365"></a><span class="lineno"> 5365</span>&#160;                <span class="comment">// calculate ratio between cell width and text width</span></div>
<div class="line"><a name="l05366"></a><span class="lineno"> 5366</span>&#160;                <span class="keywordflow">if</span> ($width &lt;= 0) {</div>
<div class="line"><a name="l05367"></a><span class="lineno"> 5367</span>&#160;                    $ratio = 1;</div>
<div class="line"><a name="l05368"></a><span class="lineno"> 5368</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05369"></a><span class="lineno"> 5369</span>&#160;                    $ratio = ((<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> - $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>] - $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>]) / $width);</div>
<div class="line"><a name="l05370"></a><span class="lineno"> 5370</span>&#160;                }</div>
<div class="line"><a name="l05371"></a><span class="lineno"> 5371</span>&#160;                <span class="comment">// check if stretching is required</span></div>
<div class="line"><a name="l05372"></a><span class="lineno"> 5372</span>&#160;                <span class="keywordflow">if</span> (($ratio &lt; 1) OR (($ratio &gt; 1) AND (($stretch % 2) == 0))) {</div>
<div class="line"><a name="l05373"></a><span class="lineno"> 5373</span>&#160;                    <span class="comment">// the text will be stretched to fit cell width</span></div>
<div class="line"><a name="l05374"></a><span class="lineno"> 5374</span>&#160;                    <span class="keywordflow">if</span> ($stretch &gt; 2) {</div>
<div class="line"><a name="l05375"></a><span class="lineno"> 5375</span>&#160;                        <span class="comment">// set new character spacing</span></div>
<div class="line"><a name="l05376"></a><span class="lineno"> 5376</span>&#160;                        $this-&gt;font_spacing += (<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> - $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>] - $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>] - $width) / (max(($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac9dc6318fd217971aff282532ab91e43">GetNumChars</a>($txt) - 1), 1) * ($this-&gt;font_stretching / 100));</div>
<div class="line"><a name="l05377"></a><span class="lineno"> 5377</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05378"></a><span class="lineno"> 5378</span>&#160;                        <span class="comment">// set new horizontal stretching</span></div>
<div class="line"><a name="l05379"></a><span class="lineno"> 5379</span>&#160;                        $this-&gt;font_stretching *= $ratio;</div>
<div class="line"><a name="l05380"></a><span class="lineno"> 5380</span>&#160;                    }</div>
<div class="line"><a name="l05381"></a><span class="lineno"> 5381</span>&#160;                    <span class="comment">// recalculate text width (the text fills the entire cell)</span></div>
<div class="line"><a name="l05382"></a><span class="lineno"> 5382</span>&#160;                    $width = <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> - $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>] - $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>];</div>
<div class="line"><a name="l05383"></a><span class="lineno"> 5383</span>&#160;                    <span class="comment">// reset alignment</span></div>
<div class="line"><a name="l05384"></a><span class="lineno"> 5384</span>&#160;                    $align = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l05385"></a><span class="lineno"> 5385</span>&#160;                }</div>
<div class="line"><a name="l05386"></a><span class="lineno"> 5386</span>&#160;            }</div>
<div class="line"><a name="l05387"></a><span class="lineno"> 5387</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;font_stretching != 100) {</div>
<div class="line"><a name="l05388"></a><span class="lineno"> 5388</span>&#160;                <span class="comment">// apply font stretching</span></div>
<div class="line"><a name="l05389"></a><span class="lineno"> 5389</span>&#160;                $rs .= sprintf(<span class="stringliteral">&#39;BT %F Tz ET &#39;</span>, $this-&gt;font_stretching);</div>
<div class="line"><a name="l05390"></a><span class="lineno"> 5390</span>&#160;            }</div>
<div class="line"><a name="l05391"></a><span class="lineno"> 5391</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;font_spacing != 0) {</div>
<div class="line"><a name="l05392"></a><span class="lineno"> 5392</span>&#160;                <span class="comment">// increase/decrease font spacing</span></div>
<div class="line"><a name="l05393"></a><span class="lineno"> 5393</span>&#160;                $rs .= sprintf(<span class="stringliteral">&#39;BT %F Tc ET &#39;</span>, ($this-&gt;font_spacing * $this-&gt;k));</div>
<div class="line"><a name="l05394"></a><span class="lineno"> 5394</span>&#160;            }</div>
<div class="line"><a name="l05395"></a><span class="lineno"> 5395</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;ColorFlag AND ($this-&gt;textrendermode &lt; 4)) {</div>
<div class="line"><a name="l05396"></a><span class="lineno"> 5396</span>&#160;                $s .= <span class="stringliteral">&#39;q &#39;</span>.$this-&gt;TextColor.<span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l05397"></a><span class="lineno"> 5397</span>&#160;            }</div>
<div class="line"><a name="l05398"></a><span class="lineno"> 5398</span>&#160;            <span class="comment">// rendering mode</span></div>
<div class="line"><a name="l05399"></a><span class="lineno"> 5399</span>&#160;            $s .= sprintf(<span class="stringliteral">&#39;BT %d Tr %F w ET &#39;</span>, $this-&gt;textrendermode, ($this-&gt;textstrokewidth * $this-&gt;k));</div>
<div class="line"><a name="l05400"></a><span class="lineno"> 5400</span>&#160;            <span class="comment">// count number of spaces</span></div>
<div class="line"><a name="l05401"></a><span class="lineno"> 5401</span>&#160;            $ns = substr_count($txt, chr(32));</div>
<div class="line"><a name="l05402"></a><span class="lineno"> 5402</span>&#160;            <span class="comment">// Justification</span></div>
<div class="line"><a name="l05403"></a><span class="lineno"> 5403</span>&#160;            $spacewidth = 0;</div>
<div class="line"><a name="l05404"></a><span class="lineno"> 5404</span>&#160;            <span class="keywordflow">if</span> (($align == <span class="charliteral">&#39;J&#39;</span>) AND ($ns &gt; 0)) {</div>
<div class="line"><a name="l05405"></a><span class="lineno"> 5405</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a81c8257af5d6d6e40f1bb77d6b507b97">isUnicodeFont</a>()) {</div>
<div class="line"><a name="l05406"></a><span class="lineno"> 5406</span>&#160;                    <span class="comment">// get string width without spaces</span></div>
<div class="line"><a name="l05407"></a><span class="lineno"> 5407</span>&#160;                    $width = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8075c1f04b6fbddc957cff786c4b16d9">GetStringWidth</a>(str_replace(<span class="charliteral">&#39; &#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $txt));</div>
<div class="line"><a name="l05408"></a><span class="lineno"> 5408</span>&#160;                    <span class="comment">// calculate average space width</span></div>
<div class="line"><a name="l05409"></a><span class="lineno"> 5409</span>&#160;                    $spacewidth = -1000 * (<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> - $width - $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>] - $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>]) / ($ns?$ns:1) / ($this-&gt;FontSize?$this-&gt;FontSize:1);</div>
<div class="line"><a name="l05410"></a><span class="lineno"> 5410</span>&#160;                    <span class="keywordflow">if</span> ($this-&gt;font_stretching != 100) {</div>
<div class="line"><a name="l05411"></a><span class="lineno"> 5411</span>&#160;                        <span class="comment">// word spacing is affected by stretching</span></div>
<div class="line"><a name="l05412"></a><span class="lineno"> 5412</span>&#160;                        $spacewidth /= ($this-&gt;font_stretching / 100);</div>
<div class="line"><a name="l05413"></a><span class="lineno"> 5413</span>&#160;                    }</div>
<div class="line"><a name="l05414"></a><span class="lineno"> 5414</span>&#160;                    <span class="comment">// set word position to be used with TJ operator</span></div>
<div class="line"><a name="l05415"></a><span class="lineno"> 5415</span>&#160;                    $txt2 = str_replace(chr(0).chr(32), <span class="stringliteral">&#39;) &#39;</span>.sprintf(<span class="stringliteral">&#39;%F&#39;</span>, $spacewidth).<span class="stringliteral">&#39; (&#39;</span>, $txt2);</div>
<div class="line"><a name="l05416"></a><span class="lineno"> 5416</span>&#160;                    $unicode_justification = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05417"></a><span class="lineno"> 5417</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05418"></a><span class="lineno"> 5418</span>&#160;                    <span class="comment">// get string width</span></div>
<div class="line"><a name="l05419"></a><span class="lineno"> 5419</span>&#160;                    $width = $txwidth;</div>
<div class="line"><a name="l05420"></a><span class="lineno"> 5420</span>&#160;                    <span class="comment">// new space width</span></div>
<div class="line"><a name="l05421"></a><span class="lineno"> 5421</span>&#160;                    $spacewidth = ((<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> - $width - $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>] - $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>]) / ($ns?$ns:1)) * $this-&gt;k;</div>
<div class="line"><a name="l05422"></a><span class="lineno"> 5422</span>&#160;                    <span class="keywordflow">if</span> ($this-&gt;font_stretching != 100) {</div>
<div class="line"><a name="l05423"></a><span class="lineno"> 5423</span>&#160;                        <span class="comment">// word spacing (Tw) is affected by stretching</span></div>
<div class="line"><a name="l05424"></a><span class="lineno"> 5424</span>&#160;                        $spacewidth /= ($this-&gt;font_stretching / 100);</div>
<div class="line"><a name="l05425"></a><span class="lineno"> 5425</span>&#160;                    }</div>
<div class="line"><a name="l05426"></a><span class="lineno"> 5426</span>&#160;                    <span class="comment">// set word spacing</span></div>
<div class="line"><a name="l05427"></a><span class="lineno"> 5427</span>&#160;                    $rs .= sprintf(<span class="stringliteral">&#39;BT %F Tw ET &#39;</span>, $spacewidth);</div>
<div class="line"><a name="l05428"></a><span class="lineno"> 5428</span>&#160;                }</div>
<div class="line"><a name="l05429"></a><span class="lineno"> 5429</span>&#160;                $width = <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> - $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>] - $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>];</div>
<div class="line"><a name="l05430"></a><span class="lineno"> 5430</span>&#160;            }</div>
<div class="line"><a name="l05431"></a><span class="lineno"> 5431</span>&#160;            <span class="comment">// replace carriage return characters</span></div>
<div class="line"><a name="l05432"></a><span class="lineno"> 5432</span>&#160;            $txt2 = str_replace(<span class="stringliteral">&quot;\r&quot;</span>, <span class="charliteral">&#39; &#39;</span>, $txt2);</div>
<div class="line"><a name="l05433"></a><span class="lineno"> 5433</span>&#160;            <span class="keywordflow">switch</span> ($align) {</div>
<div class="line"><a name="l05434"></a><span class="lineno"> 5434</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>: {</div>
<div class="line"><a name="l05435"></a><span class="lineno"> 5435</span>&#160;                    $dx = (<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> - $width) / 2;</div>
<div class="line"><a name="l05436"></a><span class="lineno"> 5436</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05437"></a><span class="lineno"> 5437</span>&#160;                }</div>
<div class="line"><a name="l05438"></a><span class="lineno"> 5438</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;R&#39;</span>: {</div>
<div class="line"><a name="l05439"></a><span class="lineno"> 5439</span>&#160;                    <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l05440"></a><span class="lineno"> 5440</span>&#160;                        $dx = $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>];</div>
<div class="line"><a name="l05441"></a><span class="lineno"> 5441</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05442"></a><span class="lineno"> 5442</span>&#160;                        $dx = <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> - $width - $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>];</div>
<div class="line"><a name="l05443"></a><span class="lineno"> 5443</span>&#160;                    }</div>
<div class="line"><a name="l05444"></a><span class="lineno"> 5444</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05445"></a><span class="lineno"> 5445</span>&#160;                }</div>
<div class="line"><a name="l05446"></a><span class="lineno"> 5446</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;L&#39;</span>: {</div>
<div class="line"><a name="l05447"></a><span class="lineno"> 5447</span>&#160;                    <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l05448"></a><span class="lineno"> 5448</span>&#160;                        $dx = <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> - $width - $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>];</div>
<div class="line"><a name="l05449"></a><span class="lineno"> 5449</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05450"></a><span class="lineno"> 5450</span>&#160;                        $dx = $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>];</div>
<div class="line"><a name="l05451"></a><span class="lineno"> 5451</span>&#160;                    }</div>
<div class="line"><a name="l05452"></a><span class="lineno"> 5452</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05453"></a><span class="lineno"> 5453</span>&#160;                }</div>
<div class="line"><a name="l05454"></a><span class="lineno"> 5454</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;J&#39;</span>:</div>
<div class="line"><a name="l05455"></a><span class="lineno"> 5455</span>&#160;                <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l05456"></a><span class="lineno"> 5456</span>&#160;                    <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l05457"></a><span class="lineno"> 5457</span>&#160;                        $dx = $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>];</div>
<div class="line"><a name="l05458"></a><span class="lineno"> 5458</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05459"></a><span class="lineno"> 5459</span>&#160;                        $dx = $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>];</div>
<div class="line"><a name="l05460"></a><span class="lineno"> 5460</span>&#160;                    }</div>
<div class="line"><a name="l05461"></a><span class="lineno"> 5461</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05462"></a><span class="lineno"> 5462</span>&#160;                }</div>
<div class="line"><a name="l05463"></a><span class="lineno"> 5463</span>&#160;            }</div>
<div class="line"><a name="l05464"></a><span class="lineno"> 5464</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l05465"></a><span class="lineno"> 5465</span>&#160;                $xdx = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> - $dx - $width;</div>
<div class="line"><a name="l05466"></a><span class="lineno"> 5466</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05467"></a><span class="lineno"> 5467</span>&#160;                $xdx = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> + $dx;</div>
<div class="line"><a name="l05468"></a><span class="lineno"> 5468</span>&#160;            }</div>
<div class="line"><a name="l05469"></a><span class="lineno"> 5469</span>&#160;            $xdk = $xdx * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a>;</div>
<div class="line"><a name="l05470"></a><span class="lineno"> 5470</span>&#160;            <span class="comment">// print text</span></div>
<div class="line"><a name="l05471"></a><span class="lineno"> 5471</span>&#160;            $s .= sprintf(<span class="stringliteral">&#39;BT %F %F Td [(%s)] TJ ET&#39;</span>, $xdk, (($this-&gt;h - $basefonty) * $k), $txt2);</div>
<div class="line"><a name="l05472"></a><span class="lineno"> 5472</span>&#160;            <span class="keywordflow">if</span> (isset($uniblock)) {</div>
<div class="line"><a name="l05473"></a><span class="lineno"> 5473</span>&#160;                <span class="comment">// print overlapping characters as separate string</span></div>
<div class="line"><a name="l05474"></a><span class="lineno"> 5474</span>&#160;                $xshift = 0; <span class="comment">// horizontal shift</span></div>
<div class="line"><a name="l05475"></a><span class="lineno"> 5475</span>&#160;                $ty = (($this-&gt;h - $basefonty + (0.2 * <a class="code" href="../../d4/d40/classTCPDF.html#aa4460c72a6e45784dff4dad7708c372c">$this-&gt;FontSize</a>)) * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a>);</div>
<div class="line"><a name="l05476"></a><span class="lineno"> 5476</span>&#160;                $spw = ((<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> - $txwidth - $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>] - $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>]) / ($ns?$ns:1));</div>
<div class="line"><a name="l05477"></a><span class="lineno"> 5477</span>&#160;                <span class="keywordflow">foreach</span> ($uniblock as $uk =&gt; $uniarr) {</div>
<div class="line"><a name="l05478"></a><span class="lineno"> 5478</span>&#160;                    <span class="keywordflow">if</span> (($uk % 2) == 0) {</div>
<div class="line"><a name="l05479"></a><span class="lineno"> 5479</span>&#160;                        <span class="comment">// x space to skip</span></div>
<div class="line"><a name="l05480"></a><span class="lineno"> 5480</span>&#160;                        <span class="keywordflow">if</span> ($spacewidth != 0) {</div>
<div class="line"><a name="l05481"></a><span class="lineno"> 5481</span>&#160;                            <span class="comment">// justification shift</span></div>
<div class="line"><a name="l05482"></a><span class="lineno"> 5482</span>&#160;                            $xshift += (count(array_keys($uniarr, 32)) * $spw);</div>
<div class="line"><a name="l05483"></a><span class="lineno"> 5483</span>&#160;                        }</div>
<div class="line"><a name="l05484"></a><span class="lineno"> 5484</span>&#160;                        $xshift += $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#afe09291dfba7203e225a507e71e1d43e">GetArrStringWidth</a>($uniarr); <span class="comment">// + shift justification</span></div>
<div class="line"><a name="l05485"></a><span class="lineno"> 5485</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05486"></a><span class="lineno"> 5486</span>&#160;                        <span class="comment">// character to print</span></div>
<div class="line"><a name="l05487"></a><span class="lineno"> 5487</span>&#160;                        $topchr = TCPDF_FONTS::arrUTF8ToUTF16BE($uniarr, <span class="keyword">false</span>);</div>
<div class="line"><a name="l05488"></a><span class="lineno"> 5488</span>&#160;                        $topchr = TCPDF_STATIC::_escape($topchr);</div>
<div class="line"><a name="l05489"></a><span class="lineno"> 5489</span>&#160;                        $s .= sprintf(<span class="stringliteral">&#39; BT %F %F Td [(%s)] TJ ET&#39;</span>, ($xdk + ($xshift * $k)), $ty, $topchr);</div>
<div class="line"><a name="l05490"></a><span class="lineno"> 5490</span>&#160;                    }</div>
<div class="line"><a name="l05491"></a><span class="lineno"> 5491</span>&#160;                }</div>
<div class="line"><a name="l05492"></a><span class="lineno"> 5492</span>&#160;            }</div>
<div class="line"><a name="l05493"></a><span class="lineno"> 5493</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;underline) {</div>
<div class="line"><a name="l05494"></a><span class="lineno"> 5494</span>&#160;                $s .= <span class="charliteral">&#39; &#39;</span>.$this-&gt;_dounderlinew($xdx, $basefonty, $width);</div>
<div class="line"><a name="l05495"></a><span class="lineno"> 5495</span>&#160;            }</div>
<div class="line"><a name="l05496"></a><span class="lineno"> 5496</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;linethrough) {</div>
<div class="line"><a name="l05497"></a><span class="lineno"> 5497</span>&#160;                $s .= <span class="charliteral">&#39; &#39;</span>.$this-&gt;_dolinethroughw($xdx, $basefonty, $width);</div>
<div class="line"><a name="l05498"></a><span class="lineno"> 5498</span>&#160;            }</div>
<div class="line"><a name="l05499"></a><span class="lineno"> 5499</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;overline) {</div>
<div class="line"><a name="l05500"></a><span class="lineno"> 5500</span>&#160;                $s .= <span class="charliteral">&#39; &#39;</span>.$this-&gt;_dooverlinew($xdx, $basefonty, $width);</div>
<div class="line"><a name="l05501"></a><span class="lineno"> 5501</span>&#160;            }</div>
<div class="line"><a name="l05502"></a><span class="lineno"> 5502</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;ColorFlag AND ($this-&gt;textrendermode &lt; 4)) {</div>
<div class="line"><a name="l05503"></a><span class="lineno"> 5503</span>&#160;                $s .= <span class="stringliteral">&#39; Q&#39;</span>;</div>
<div class="line"><a name="l05504"></a><span class="lineno"> 5504</span>&#160;            }</div>
<div class="line"><a name="l05505"></a><span class="lineno"> 5505</span>&#160;            <span class="keywordflow">if</span> ($link) {</div>
<div class="line"><a name="l05506"></a><span class="lineno"> 5506</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ab87bf1826384fbfe30eb499d42f1d994">Link</a>($xdx, $yt, $width, ($this-&gt;FontAscent + $this-&gt;FontDescent), $link, $ns);</div>
<div class="line"><a name="l05507"></a><span class="lineno"> 5507</span>&#160;            }</div>
<div class="line"><a name="l05508"></a><span class="lineno"> 5508</span>&#160;        }</div>
<div class="line"><a name="l05509"></a><span class="lineno"> 5509</span>&#160;        <span class="comment">// output cell</span></div>
<div class="line"><a name="l05510"></a><span class="lineno"> 5510</span>&#160;        <span class="keywordflow">if</span> ($s) {</div>
<div class="line"><a name="l05511"></a><span class="lineno"> 5511</span>&#160;            <span class="comment">// output cell</span></div>
<div class="line"><a name="l05512"></a><span class="lineno"> 5512</span>&#160;            $rs .= $s;</div>
<div class="line"><a name="l05513"></a><span class="lineno"> 5513</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;font_spacing != 0) {</div>
<div class="line"><a name="l05514"></a><span class="lineno"> 5514</span>&#160;                <span class="comment">// reset font spacing mode</span></div>
<div class="line"><a name="l05515"></a><span class="lineno"> 5515</span>&#160;                $rs .= <span class="stringliteral">&#39; BT 0 Tc ET&#39;</span>;</div>
<div class="line"><a name="l05516"></a><span class="lineno"> 5516</span>&#160;            }</div>
<div class="line"><a name="l05517"></a><span class="lineno"> 5517</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;font_stretching != 100) {</div>
<div class="line"><a name="l05518"></a><span class="lineno"> 5518</span>&#160;                <span class="comment">// reset font stretching mode</span></div>
<div class="line"><a name="l05519"></a><span class="lineno"> 5519</span>&#160;                $rs .= <span class="stringliteral">&#39; BT 100 Tz ET&#39;</span>;</div>
<div class="line"><a name="l05520"></a><span class="lineno"> 5520</span>&#160;            }</div>
<div class="line"><a name="l05521"></a><span class="lineno"> 5521</span>&#160;        }</div>
<div class="line"><a name="l05522"></a><span class="lineno"> 5522</span>&#160;        <span class="comment">// reset word spacing</span></div>
<div class="line"><a name="l05523"></a><span class="lineno"> 5523</span>&#160;        <span class="keywordflow">if</span> (!$this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a81c8257af5d6d6e40f1bb77d6b507b97">isUnicodeFont</a>() AND ($align == <span class="charliteral">&#39;J&#39;</span>)) {</div>
<div class="line"><a name="l05524"></a><span class="lineno"> 5524</span>&#160;            $rs .= <span class="stringliteral">&#39; BT 0 Tw ET&#39;</span>;</div>
<div class="line"><a name="l05525"></a><span class="lineno"> 5525</span>&#160;        }</div>
<div class="line"><a name="l05526"></a><span class="lineno"> 5526</span>&#160;        <span class="comment">// reset stretching and spacing</span></div>
<div class="line"><a name="l05527"></a><span class="lineno"> 5527</span>&#160;        $this-&gt;font_stretching = $prev_font_stretching;</div>
<div class="line"><a name="l05528"></a><span class="lineno"> 5528</span>&#160;        $this-&gt;font_spacing = $prev_font_spacing;</div>
<div class="line"><a name="l05529"></a><span class="lineno"> 5529</span>&#160;        $this-&gt;lasth = <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>;</div>
<div class="line"><a name="l05530"></a><span class="lineno"> 5530</span>&#160;        <span class="keywordflow">if</span> ($ln &gt; 0) {</div>
<div class="line"><a name="l05531"></a><span class="lineno"> 5531</span>&#160;            <span class="comment">//Go to the beginning of the next line</span></div>
<div class="line"><a name="l05532"></a><span class="lineno"> 5532</span>&#160;            $this-&gt;y = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> + <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> + $this-&gt;cell_margin[<span class="charliteral">&#39;B&#39;</span>];</div>
<div class="line"><a name="l05533"></a><span class="lineno"> 5533</span>&#160;            <span class="keywordflow">if</span> ($ln == 1) {</div>
<div class="line"><a name="l05534"></a><span class="lineno"> 5534</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l05535"></a><span class="lineno"> 5535</span>&#160;                    $this-&gt;x = $this-&gt;w - <a class="code" href="../../d4/d40/classTCPDF.html#a44fb75b85bea40ced25fdea9d89dc8e9">$this-&gt;rMargin</a>;</div>
<div class="line"><a name="l05536"></a><span class="lineno"> 5536</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05537"></a><span class="lineno"> 5537</span>&#160;                    $this-&gt;x = <a class="code" href="../../d4/d40/classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da">$this-&gt;lMargin</a>;</div>
<div class="line"><a name="l05538"></a><span class="lineno"> 5538</span>&#160;                }</div>
<div class="line"><a name="l05539"></a><span class="lineno"> 5539</span>&#160;            }</div>
<div class="line"><a name="l05540"></a><span class="lineno"> 5540</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05541"></a><span class="lineno"> 5541</span>&#160;            <span class="comment">// go left or right by case</span></div>
<div class="line"><a name="l05542"></a><span class="lineno"> 5542</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l05543"></a><span class="lineno"> 5543</span>&#160;                $this-&gt;x = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> - <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> - $this-&gt;cell_margin[<span class="charliteral">&#39;L&#39;</span>];</div>
<div class="line"><a name="l05544"></a><span class="lineno"> 5544</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05545"></a><span class="lineno"> 5545</span>&#160;                $this-&gt;x = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> + <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> + $this-&gt;cell_margin[<span class="charliteral">&#39;R&#39;</span>];</div>
<div class="line"><a name="l05546"></a><span class="lineno"> 5546</span>&#160;            }</div>
<div class="line"><a name="l05547"></a><span class="lineno"> 5547</span>&#160;        }</div>
<div class="line"><a name="l05548"></a><span class="lineno"> 5548</span>&#160;        $gstyles = <span class="stringliteral">&#39;&#39;</span>.$this-&gt;linestyleWidth.<span class="charliteral">&#39; &#39;</span>.$this-&gt;linestyleCap.<span class="charliteral">&#39; &#39;</span>.$this-&gt;linestyleJoin.<span class="charliteral">&#39; &#39;</span>.$this-&gt;linestyleDash.<span class="charliteral">&#39; &#39;</span>.$this-&gt;DrawColor.<span class="charliteral">&#39; &#39;</span>.$this-&gt;FillColor.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l05549"></a><span class="lineno"> 5549</span>&#160;        $rs = $gstyles.$rs;</div>
<div class="line"><a name="l05550"></a><span class="lineno"> 5550</span>&#160;        $this-&gt;cell_padding = $prev_cell_padding;</div>
<div class="line"><a name="l05551"></a><span class="lineno"> 5551</span>&#160;        $this-&gt;cell_margin = $prev_cell_margin;</div>
<div class="line"><a name="l05552"></a><span class="lineno"> 5552</span>&#160;        <span class="keywordflow">return</span> $rs;</div>
<div class="line"><a name="l05553"></a><span class="lineno"> 5553</span>&#160;    }</div>
<div class="line"><a name="l05554"></a><span class="lineno"> 5554</span>&#160;</div>
<div class="line"><a name="l05563"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a968b07e5ebb6722f7c6a649e083fccd9"> 5563</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a968b07e5ebb6722f7c6a649e083fccd9">replaceChar</a>($oldchar, $newchar) {</div>
<div class="line"><a name="l05564"></a><span class="lineno"> 5564</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a458536902daa1aaead2c627dcf71e66b">isCharDefined</a>($newchar)) {</div>
<div class="line"><a name="l05565"></a><span class="lineno"> 5565</span>&#160;            <span class="comment">// add the new char on the subset list</span></div>
<div class="line"><a name="l05566"></a><span class="lineno"> 5566</span>&#160;            $this-&gt;CurrentFont[<span class="stringliteral">&#39;subsetchars&#39;</span>][$newchar] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05567"></a><span class="lineno"> 5567</span>&#160;            <span class="comment">// return the new character</span></div>
<div class="line"><a name="l05568"></a><span class="lineno"> 5568</span>&#160;            <span class="keywordflow">return</span> $newchar;</div>
<div class="line"><a name="l05569"></a><span class="lineno"> 5569</span>&#160;        }</div>
<div class="line"><a name="l05570"></a><span class="lineno"> 5570</span>&#160;        <span class="comment">// return the old char</span></div>
<div class="line"><a name="l05571"></a><span class="lineno"> 5571</span>&#160;        <span class="keywordflow">return</span> $oldchar;</div>
<div class="line"><a name="l05572"></a><span class="lineno"> 5572</span>&#160;    }</div>
<div class="line"><a name="l05573"></a><span class="lineno"> 5573</span>&#160;</div>
<div class="line"><a name="l05586"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a128e3d25eed996dbd78dd10be6f0c4c4"> 5586</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a128e3d25eed996dbd78dd10be6f0c4c4">getCellBorder</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $brd) {</div>
<div class="line"><a name="l05587"></a><span class="lineno"> 5587</span>&#160;        $s = <span class="stringliteral">&#39;&#39;</span>; <span class="comment">// string to be returned</span></div>
<div class="line"><a name="l05588"></a><span class="lineno"> 5588</span>&#160;        <span class="keywordflow">if</span> (empty($brd)) {</div>
<div class="line"><a name="l05589"></a><span class="lineno"> 5589</span>&#160;            <span class="keywordflow">return</span> $s;</div>
<div class="line"><a name="l05590"></a><span class="lineno"> 5590</span>&#160;        }</div>
<div class="line"><a name="l05591"></a><span class="lineno"> 5591</span>&#160;        <span class="keywordflow">if</span> ($brd == 1) {</div>
<div class="line"><a name="l05592"></a><span class="lineno"> 5592</span>&#160;            $brd = array(<span class="stringliteral">&#39;LRTB&#39;</span> =&gt; <span class="keyword">true</span>);</div>
<div class="line"><a name="l05593"></a><span class="lineno"> 5593</span>&#160;        }</div>
<div class="line"><a name="l05594"></a><span class="lineno"> 5594</span>&#160;        <span class="comment">// calculate coordinates for border</span></div>
<div class="line"><a name="l05595"></a><span class="lineno"> 5595</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a> = <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>;</div>
<div class="line"><a name="l05596"></a><span class="lineno"> 5596</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l05597"></a><span class="lineno"> 5597</span>&#160;            $xeL = (<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> - <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>) * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a>;</div>
<div class="line"><a name="l05598"></a><span class="lineno"> 5598</span>&#160;            $xeR = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a>;</div>
<div class="line"><a name="l05599"></a><span class="lineno"> 5599</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05600"></a><span class="lineno"> 5600</span>&#160;            $xeL = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a>;</div>
<div class="line"><a name="l05601"></a><span class="lineno"> 5601</span>&#160;            $xeR = (<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> + <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>) * $k;</div>
<div class="line"><a name="l05602"></a><span class="lineno"> 5602</span>&#160;        }</div>
<div class="line"><a name="l05603"></a><span class="lineno"> 5603</span>&#160;        $yeL = (($this-&gt;h - (<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> + <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>)) * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a>);</div>
<div class="line"><a name="l05604"></a><span class="lineno"> 5604</span>&#160;        $yeT = (($this-&gt;h - <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>) * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a>);</div>
<div class="line"><a name="l05605"></a><span class="lineno"> 5605</span>&#160;        $xeT = $xeL;</div>
<div class="line"><a name="l05606"></a><span class="lineno"> 5606</span>&#160;        $xeB = $xeR;</div>
<div class="line"><a name="l05607"></a><span class="lineno"> 5607</span>&#160;        $yeR = $yeT;</div>
<div class="line"><a name="l05608"></a><span class="lineno"> 5608</span>&#160;        $yeB = $yeL;</div>
<div class="line"><a name="l05609"></a><span class="lineno"> 5609</span>&#160;        <span class="keywordflow">if</span> (is_string($brd)) {</div>
<div class="line"><a name="l05610"></a><span class="lineno"> 5610</span>&#160;            <span class="comment">// convert string to array</span></div>
<div class="line"><a name="l05611"></a><span class="lineno"> 5611</span>&#160;            $slen = strlen($brd);</div>
<div class="line"><a name="l05612"></a><span class="lineno"> 5612</span>&#160;            $newbrd = array();</div>
<div class="line"><a name="l05613"></a><span class="lineno"> 5613</span>&#160;            <span class="keywordflow">for</span> ($i = 0; $i &lt; $slen; ++$i) {</div>
<div class="line"><a name="l05614"></a><span class="lineno"> 5614</span>&#160;                $newbrd[$brd[$i]] = array(<span class="stringliteral">&#39;cap&#39;</span> =&gt; <span class="stringliteral">&#39;square&#39;</span>, <span class="stringliteral">&#39;join&#39;</span> =&gt; <span class="stringliteral">&#39;miter&#39;</span>);</div>
<div class="line"><a name="l05615"></a><span class="lineno"> 5615</span>&#160;            }</div>
<div class="line"><a name="l05616"></a><span class="lineno"> 5616</span>&#160;            $brd = $newbrd;</div>
<div class="line"><a name="l05617"></a><span class="lineno"> 5617</span>&#160;        }</div>
<div class="line"><a name="l05618"></a><span class="lineno"> 5618</span>&#160;        <span class="keywordflow">if</span> (isset($brd[<span class="stringliteral">&#39;mode&#39;</span>])) {</div>
<div class="line"><a name="l05619"></a><span class="lineno"> 5619</span>&#160;            $mode = $brd[<span class="stringliteral">&#39;mode&#39;</span>];</div>
<div class="line"><a name="l05620"></a><span class="lineno"> 5620</span>&#160;            unset($brd[<span class="stringliteral">&#39;mode&#39;</span>]);</div>
<div class="line"><a name="l05621"></a><span class="lineno"> 5621</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05622"></a><span class="lineno"> 5622</span>&#160;            $mode = <span class="stringliteral">&#39;normal&#39;</span>;</div>
<div class="line"><a name="l05623"></a><span class="lineno"> 5623</span>&#160;        }</div>
<div class="line"><a name="l05624"></a><span class="lineno"> 5624</span>&#160;        <span class="keywordflow">foreach</span> ($brd as $border =&gt; $style) {</div>
<div class="line"><a name="l05625"></a><span class="lineno"> 5625</span>&#160;            <span class="keywordflow">if</span> (is_array($style) AND !empty($style)) {</div>
<div class="line"><a name="l05626"></a><span class="lineno"> 5626</span>&#160;                <span class="comment">// apply border style</span></div>
<div class="line"><a name="l05627"></a><span class="lineno"> 5627</span>&#160;                $prev_style = $this-&gt;linestyleWidth.<span class="charliteral">&#39; &#39;</span>.$this-&gt;linestyleCap.<span class="charliteral">&#39; &#39;</span>.$this-&gt;linestyleJoin.<span class="charliteral">&#39; &#39;</span>.$this-&gt;linestyleDash.<span class="charliteral">&#39; &#39;</span>.$this-&gt;DrawColor.<span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l05628"></a><span class="lineno"> 5628</span>&#160;                $s .= $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a3d9b3717cd9ad8db31642155c832d148">SetLineStyle</a>($style, <span class="keyword">true</span>).<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l05629"></a><span class="lineno"> 5629</span>&#160;            }</div>
<div class="line"><a name="l05630"></a><span class="lineno"> 5630</span>&#160;            <span class="keywordflow">switch</span> ($mode) {</div>
<div class="line"><a name="l05631"></a><span class="lineno"> 5631</span>&#160;                <span class="keywordflow">case</span> <span class="stringliteral">&#39;ext&#39;</span>: {</div>
<div class="line"><a name="l05632"></a><span class="lineno"> 5632</span>&#160;                    $off = (($this-&gt;LineWidth / 2) * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a>);</div>
<div class="line"><a name="l05633"></a><span class="lineno"> 5633</span>&#160;                    $xL = $xeL - $off;</div>
<div class="line"><a name="l05634"></a><span class="lineno"> 5634</span>&#160;                    $xR = $xeR + $off;</div>
<div class="line"><a name="l05635"></a><span class="lineno"> 5635</span>&#160;                    $yT = $yeT + $off;</div>
<div class="line"><a name="l05636"></a><span class="lineno"> 5636</span>&#160;                    $yL = $yeL - $off;</div>
<div class="line"><a name="l05637"></a><span class="lineno"> 5637</span>&#160;                    $xT = $xL;</div>
<div class="line"><a name="l05638"></a><span class="lineno"> 5638</span>&#160;                    $xB = $xR;</div>
<div class="line"><a name="l05639"></a><span class="lineno"> 5639</span>&#160;                    $yR = $yT;</div>
<div class="line"><a name="l05640"></a><span class="lineno"> 5640</span>&#160;                    $yB = $yL;</div>
<div class="line"><a name="l05641"></a><span class="lineno"> 5641</span>&#160;                    <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> += <a class="code" href="../../d4/d40/classTCPDF.html#a5971d565157974939d3edf96baeb0eeb">$this-&gt;LineWidth</a>;</div>
<div class="line"><a name="l05642"></a><span class="lineno"> 5642</span>&#160;                    <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> += <a class="code" href="../../d4/d40/classTCPDF.html#a5971d565157974939d3edf96baeb0eeb">$this-&gt;LineWidth</a>;</div>
<div class="line"><a name="l05643"></a><span class="lineno"> 5643</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05644"></a><span class="lineno"> 5644</span>&#160;                }</div>
<div class="line"><a name="l05645"></a><span class="lineno"> 5645</span>&#160;                <span class="keywordflow">case</span> <span class="stringliteral">&#39;int&#39;</span>: {</div>
<div class="line"><a name="l05646"></a><span class="lineno"> 5646</span>&#160;                    $off = ($this-&gt;LineWidth / 2) * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a>;</div>
<div class="line"><a name="l05647"></a><span class="lineno"> 5647</span>&#160;                    $xL = $xeL + $off;</div>
<div class="line"><a name="l05648"></a><span class="lineno"> 5648</span>&#160;                    $xR = $xeR - $off;</div>
<div class="line"><a name="l05649"></a><span class="lineno"> 5649</span>&#160;                    $yT = $yeT - $off;</div>
<div class="line"><a name="l05650"></a><span class="lineno"> 5650</span>&#160;                    $yL = $yeL + $off;</div>
<div class="line"><a name="l05651"></a><span class="lineno"> 5651</span>&#160;                    $xT = $xL;</div>
<div class="line"><a name="l05652"></a><span class="lineno"> 5652</span>&#160;                    $xB = $xR;</div>
<div class="line"><a name="l05653"></a><span class="lineno"> 5653</span>&#160;                    $yR = $yT;</div>
<div class="line"><a name="l05654"></a><span class="lineno"> 5654</span>&#160;                    $yB = $yL;</div>
<div class="line"><a name="l05655"></a><span class="lineno"> 5655</span>&#160;                    <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> -= <a class="code" href="../../d4/d40/classTCPDF.html#a5971d565157974939d3edf96baeb0eeb">$this-&gt;LineWidth</a>;</div>
<div class="line"><a name="l05656"></a><span class="lineno"> 5656</span>&#160;                    <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> -= <a class="code" href="../../d4/d40/classTCPDF.html#a5971d565157974939d3edf96baeb0eeb">$this-&gt;LineWidth</a>;</div>
<div class="line"><a name="l05657"></a><span class="lineno"> 5657</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05658"></a><span class="lineno"> 5658</span>&#160;                }</div>
<div class="line"><a name="l05659"></a><span class="lineno"> 5659</span>&#160;                <span class="keywordflow">case</span> <span class="stringliteral">&#39;normal&#39;</span>:</div>
<div class="line"><a name="l05660"></a><span class="lineno"> 5660</span>&#160;                <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l05661"></a><span class="lineno"> 5661</span>&#160;                    $xL = $xeL;</div>
<div class="line"><a name="l05662"></a><span class="lineno"> 5662</span>&#160;                    $xT = $xeT;</div>
<div class="line"><a name="l05663"></a><span class="lineno"> 5663</span>&#160;                    $xB = $xeB;</div>
<div class="line"><a name="l05664"></a><span class="lineno"> 5664</span>&#160;                    $xR = $xeR;</div>
<div class="line"><a name="l05665"></a><span class="lineno"> 5665</span>&#160;                    $yL = $yeL;</div>
<div class="line"><a name="l05666"></a><span class="lineno"> 5666</span>&#160;                    $yT = $yeT;</div>
<div class="line"><a name="l05667"></a><span class="lineno"> 5667</span>&#160;                    $yB = $yeB;</div>
<div class="line"><a name="l05668"></a><span class="lineno"> 5668</span>&#160;                    $yR = $yeR;</div>
<div class="line"><a name="l05669"></a><span class="lineno"> 5669</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05670"></a><span class="lineno"> 5670</span>&#160;                }</div>
<div class="line"><a name="l05671"></a><span class="lineno"> 5671</span>&#160;            }</div>
<div class="line"><a name="l05672"></a><span class="lineno"> 5672</span>&#160;            <span class="comment">// draw borders by case</span></div>
<div class="line"><a name="l05673"></a><span class="lineno"> 5673</span>&#160;            <span class="keywordflow">if</span> (strlen($border) == 4) {</div>
<div class="line"><a name="l05674"></a><span class="lineno"> 5674</span>&#160;                $s .= sprintf(<span class="stringliteral">&#39;%F %F %F %F re S &#39;</span>, $xT, $yT, (<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a>), (-<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> * $k));</div>
<div class="line"><a name="l05675"></a><span class="lineno"> 5675</span>&#160;            } elseif (strlen($border) == 3) {</div>
<div class="line"><a name="l05676"></a><span class="lineno"> 5676</span>&#160;                <span class="keywordflow">if</span> (strpos($border,<span class="charliteral">&#39;B&#39;</span>) === <span class="keyword">false</span>) { <span class="comment">// LTR</span></div>
<div class="line"><a name="l05677"></a><span class="lineno"> 5677</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F m &#39;</span>, $xL, $yL);</div>
<div class="line"><a name="l05678"></a><span class="lineno"> 5678</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F l &#39;</span>, $xT, $yT);</div>
<div class="line"><a name="l05679"></a><span class="lineno"> 5679</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F l &#39;</span>, $xR, $yR);</div>
<div class="line"><a name="l05680"></a><span class="lineno"> 5680</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F l &#39;</span>, $xB, $yB);</div>
<div class="line"><a name="l05681"></a><span class="lineno"> 5681</span>&#160;                    $s .= <span class="stringliteral">&#39;S &#39;</span>;</div>
<div class="line"><a name="l05682"></a><span class="lineno"> 5682</span>&#160;                } elseif (strpos($border,<span class="charliteral">&#39;L&#39;</span>) === <span class="keyword">false</span>) { <span class="comment">// TRB</span></div>
<div class="line"><a name="l05683"></a><span class="lineno"> 5683</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F m &#39;</span>, $xT, $yT);</div>
<div class="line"><a name="l05684"></a><span class="lineno"> 5684</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F l &#39;</span>, $xR, $yR);</div>
<div class="line"><a name="l05685"></a><span class="lineno"> 5685</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F l &#39;</span>, $xB, $yB);</div>
<div class="line"><a name="l05686"></a><span class="lineno"> 5686</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F l &#39;</span>, $xL, $yL);</div>
<div class="line"><a name="l05687"></a><span class="lineno"> 5687</span>&#160;                    $s .= <span class="stringliteral">&#39;S &#39;</span>;</div>
<div class="line"><a name="l05688"></a><span class="lineno"> 5688</span>&#160;                } elseif (strpos($border,<span class="charliteral">&#39;T&#39;</span>) === <span class="keyword">false</span>) { <span class="comment">// RBL</span></div>
<div class="line"><a name="l05689"></a><span class="lineno"> 5689</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F m &#39;</span>, $xR, $yR);</div>
<div class="line"><a name="l05690"></a><span class="lineno"> 5690</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F l &#39;</span>, $xB, $yB);</div>
<div class="line"><a name="l05691"></a><span class="lineno"> 5691</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F l &#39;</span>, $xL, $yL);</div>
<div class="line"><a name="l05692"></a><span class="lineno"> 5692</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F l &#39;</span>, $xT, $yT);</div>
<div class="line"><a name="l05693"></a><span class="lineno"> 5693</span>&#160;                    $s .= <span class="stringliteral">&#39;S &#39;</span>;</div>
<div class="line"><a name="l05694"></a><span class="lineno"> 5694</span>&#160;                } elseif (strpos($border,<span class="charliteral">&#39;R&#39;</span>) === <span class="keyword">false</span>) { <span class="comment">// BLT</span></div>
<div class="line"><a name="l05695"></a><span class="lineno"> 5695</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F m &#39;</span>, $xB, $yB);</div>
<div class="line"><a name="l05696"></a><span class="lineno"> 5696</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F l &#39;</span>, $xL, $yL);</div>
<div class="line"><a name="l05697"></a><span class="lineno"> 5697</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F l &#39;</span>, $xT, $yT);</div>
<div class="line"><a name="l05698"></a><span class="lineno"> 5698</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F l &#39;</span>, $xR, $yR);</div>
<div class="line"><a name="l05699"></a><span class="lineno"> 5699</span>&#160;                    $s .= <span class="stringliteral">&#39;S &#39;</span>;</div>
<div class="line"><a name="l05700"></a><span class="lineno"> 5700</span>&#160;                }</div>
<div class="line"><a name="l05701"></a><span class="lineno"> 5701</span>&#160;            } elseif (strlen($border) == 2) {</div>
<div class="line"><a name="l05702"></a><span class="lineno"> 5702</span>&#160;                <span class="keywordflow">if</span> ((strpos($border,<span class="charliteral">&#39;L&#39;</span>) !== <span class="keyword">false</span>) AND (strpos($border,<span class="charliteral">&#39;T&#39;</span>) !== <span class="keyword">false</span>)) { <span class="comment">// LT</span></div>
<div class="line"><a name="l05703"></a><span class="lineno"> 5703</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F m &#39;</span>, $xL, $yL);</div>
<div class="line"><a name="l05704"></a><span class="lineno"> 5704</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F l &#39;</span>, $xT, $yT);</div>
<div class="line"><a name="l05705"></a><span class="lineno"> 5705</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F l &#39;</span>, $xR, $yR);</div>
<div class="line"><a name="l05706"></a><span class="lineno"> 5706</span>&#160;                    $s .= <span class="stringliteral">&#39;S &#39;</span>;</div>
<div class="line"><a name="l05707"></a><span class="lineno"> 5707</span>&#160;                } elseif ((strpos($border,<span class="charliteral">&#39;T&#39;</span>) !== <span class="keyword">false</span>) AND (strpos($border,<span class="charliteral">&#39;R&#39;</span>) !== <span class="keyword">false</span>)) { <span class="comment">// TR</span></div>
<div class="line"><a name="l05708"></a><span class="lineno"> 5708</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F m &#39;</span>, $xT, $yT);</div>
<div class="line"><a name="l05709"></a><span class="lineno"> 5709</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F l &#39;</span>, $xR, $yR);</div>
<div class="line"><a name="l05710"></a><span class="lineno"> 5710</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F l &#39;</span>, $xB, $yB);</div>
<div class="line"><a name="l05711"></a><span class="lineno"> 5711</span>&#160;                    $s .= <span class="stringliteral">&#39;S &#39;</span>;</div>
<div class="line"><a name="l05712"></a><span class="lineno"> 5712</span>&#160;                } elseif ((strpos($border,<span class="charliteral">&#39;R&#39;</span>) !== <span class="keyword">false</span>) AND (strpos($border,<span class="charliteral">&#39;B&#39;</span>) !== <span class="keyword">false</span>)) { <span class="comment">// RB</span></div>
<div class="line"><a name="l05713"></a><span class="lineno"> 5713</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F m &#39;</span>, $xR, $yR);</div>
<div class="line"><a name="l05714"></a><span class="lineno"> 5714</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F l &#39;</span>, $xB, $yB);</div>
<div class="line"><a name="l05715"></a><span class="lineno"> 5715</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F l &#39;</span>, $xL, $yL);</div>
<div class="line"><a name="l05716"></a><span class="lineno"> 5716</span>&#160;                    $s .= <span class="stringliteral">&#39;S &#39;</span>;</div>
<div class="line"><a name="l05717"></a><span class="lineno"> 5717</span>&#160;                } elseif ((strpos($border,<span class="charliteral">&#39;B&#39;</span>) !== <span class="keyword">false</span>) AND (strpos($border,<span class="charliteral">&#39;L&#39;</span>) !== <span class="keyword">false</span>)) { <span class="comment">// BL</span></div>
<div class="line"><a name="l05718"></a><span class="lineno"> 5718</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F m &#39;</span>, $xB, $yB);</div>
<div class="line"><a name="l05719"></a><span class="lineno"> 5719</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F l &#39;</span>, $xL, $yL);</div>
<div class="line"><a name="l05720"></a><span class="lineno"> 5720</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F l &#39;</span>, $xT, $yT);</div>
<div class="line"><a name="l05721"></a><span class="lineno"> 5721</span>&#160;                    $s .= <span class="stringliteral">&#39;S &#39;</span>;</div>
<div class="line"><a name="l05722"></a><span class="lineno"> 5722</span>&#160;                } elseif ((strpos($border,<span class="charliteral">&#39;L&#39;</span>) !== <span class="keyword">false</span>) AND (strpos($border,<span class="charliteral">&#39;R&#39;</span>) !== <span class="keyword">false</span>)) { <span class="comment">// LR</span></div>
<div class="line"><a name="l05723"></a><span class="lineno"> 5723</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F m &#39;</span>, $xL, $yL);</div>
<div class="line"><a name="l05724"></a><span class="lineno"> 5724</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F l &#39;</span>, $xT, $yT);</div>
<div class="line"><a name="l05725"></a><span class="lineno"> 5725</span>&#160;                    $s .= <span class="stringliteral">&#39;S &#39;</span>;</div>
<div class="line"><a name="l05726"></a><span class="lineno"> 5726</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F m &#39;</span>, $xR, $yR);</div>
<div class="line"><a name="l05727"></a><span class="lineno"> 5727</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F l &#39;</span>, $xB, $yB);</div>
<div class="line"><a name="l05728"></a><span class="lineno"> 5728</span>&#160;                    $s .= <span class="stringliteral">&#39;S &#39;</span>;</div>
<div class="line"><a name="l05729"></a><span class="lineno"> 5729</span>&#160;                } elseif ((strpos($border,<span class="charliteral">&#39;T&#39;</span>) !== <span class="keyword">false</span>) AND (strpos($border,<span class="charliteral">&#39;B&#39;</span>) !== <span class="keyword">false</span>)) { <span class="comment">// TB</span></div>
<div class="line"><a name="l05730"></a><span class="lineno"> 5730</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F m &#39;</span>, $xT, $yT);</div>
<div class="line"><a name="l05731"></a><span class="lineno"> 5731</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F l &#39;</span>, $xR, $yR);</div>
<div class="line"><a name="l05732"></a><span class="lineno"> 5732</span>&#160;                    $s .= <span class="stringliteral">&#39;S &#39;</span>;</div>
<div class="line"><a name="l05733"></a><span class="lineno"> 5733</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F m &#39;</span>, $xB, $yB);</div>
<div class="line"><a name="l05734"></a><span class="lineno"> 5734</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F l &#39;</span>, $xL, $yL);</div>
<div class="line"><a name="l05735"></a><span class="lineno"> 5735</span>&#160;                    $s .= <span class="stringliteral">&#39;S &#39;</span>;</div>
<div class="line"><a name="l05736"></a><span class="lineno"> 5736</span>&#160;                }</div>
<div class="line"><a name="l05737"></a><span class="lineno"> 5737</span>&#160;            } <span class="keywordflow">else</span> { <span class="comment">// strlen($border) == 1</span></div>
<div class="line"><a name="l05738"></a><span class="lineno"> 5738</span>&#160;                <span class="keywordflow">if</span> (strpos($border,<span class="charliteral">&#39;L&#39;</span>) !== <span class="keyword">false</span>) { <span class="comment">// L</span></div>
<div class="line"><a name="l05739"></a><span class="lineno"> 5739</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F m &#39;</span>, $xL, $yL);</div>
<div class="line"><a name="l05740"></a><span class="lineno"> 5740</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F l &#39;</span>, $xT, $yT);</div>
<div class="line"><a name="l05741"></a><span class="lineno"> 5741</span>&#160;                    $s .= <span class="stringliteral">&#39;S &#39;</span>;</div>
<div class="line"><a name="l05742"></a><span class="lineno"> 5742</span>&#160;                } elseif (strpos($border,<span class="charliteral">&#39;T&#39;</span>) !== <span class="keyword">false</span>) { <span class="comment">// T</span></div>
<div class="line"><a name="l05743"></a><span class="lineno"> 5743</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F m &#39;</span>, $xT, $yT);</div>
<div class="line"><a name="l05744"></a><span class="lineno"> 5744</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F l &#39;</span>, $xR, $yR);</div>
<div class="line"><a name="l05745"></a><span class="lineno"> 5745</span>&#160;                    $s .= <span class="stringliteral">&#39;S &#39;</span>;</div>
<div class="line"><a name="l05746"></a><span class="lineno"> 5746</span>&#160;                } elseif (strpos($border,<span class="charliteral">&#39;R&#39;</span>) !== <span class="keyword">false</span>) { <span class="comment">// R</span></div>
<div class="line"><a name="l05747"></a><span class="lineno"> 5747</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F m &#39;</span>, $xR, $yR);</div>
<div class="line"><a name="l05748"></a><span class="lineno"> 5748</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F l &#39;</span>, $xB, $yB);</div>
<div class="line"><a name="l05749"></a><span class="lineno"> 5749</span>&#160;                    $s .= <span class="stringliteral">&#39;S &#39;</span>;</div>
<div class="line"><a name="l05750"></a><span class="lineno"> 5750</span>&#160;                } elseif (strpos($border,<span class="charliteral">&#39;B&#39;</span>) !== <span class="keyword">false</span>) { <span class="comment">// B</span></div>
<div class="line"><a name="l05751"></a><span class="lineno"> 5751</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F m &#39;</span>, $xB, $yB);</div>
<div class="line"><a name="l05752"></a><span class="lineno"> 5752</span>&#160;                    $s .= sprintf(<span class="stringliteral">&#39;%F %F l &#39;</span>, $xL, $yL);</div>
<div class="line"><a name="l05753"></a><span class="lineno"> 5753</span>&#160;                    $s .= <span class="stringliteral">&#39;S &#39;</span>;</div>
<div class="line"><a name="l05754"></a><span class="lineno"> 5754</span>&#160;                }</div>
<div class="line"><a name="l05755"></a><span class="lineno"> 5755</span>&#160;            }</div>
<div class="line"><a name="l05756"></a><span class="lineno"> 5756</span>&#160;            <span class="keywordflow">if</span> (is_array($style) AND !empty($style)) {</div>
<div class="line"><a name="l05757"></a><span class="lineno"> 5757</span>&#160;                <span class="comment">// reset border style to previous value</span></div>
<div class="line"><a name="l05758"></a><span class="lineno"> 5758</span>&#160;                $s .= <span class="stringliteral">&quot;\n&quot;</span>.$this-&gt;linestyleWidth.<span class="charliteral">&#39; &#39;</span>.$this-&gt;linestyleCap.<span class="charliteral">&#39; &#39;</span>.$this-&gt;linestyleJoin.<span class="charliteral">&#39; &#39;</span>.$this-&gt;linestyleDash.<span class="charliteral">&#39; &#39;</span>.$this-&gt;DrawColor.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l05759"></a><span class="lineno"> 5759</span>&#160;            }</div>
<div class="line"><a name="l05760"></a><span class="lineno"> 5760</span>&#160;        }</div>
<div class="line"><a name="l05761"></a><span class="lineno"> 5761</span>&#160;        <span class="keywordflow">return</span> $s;</div>
<div class="line"><a name="l05762"></a><span class="lineno"> 5762</span>&#160;    }</div>
<div class="line"><a name="l05763"></a><span class="lineno"> 5763</span>&#160;</div>
<div class="line"><a name="l05789"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aa81d4b585de305c054760ec983ed3ece"> 5789</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#aa81d4b585de305c054760ec983ed3ece">MultiCell</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $txt, $border=0, $align=<span class="charliteral">&#39;J&#39;</span>, $fill=<span class="keyword">false</span>, $ln=1, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>=<span class="stringliteral">&#39;&#39;</span>, $reseth=<span class="keyword">true</span>, $stretch=0, $ishtml=<span class="keyword">false</span>, $autopadding=<span class="keyword">true</span>, $maxh=0, $valign=<span class="charliteral">&#39;T&#39;</span>, $fitcell=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l05790"></a><span class="lineno"> 5790</span>&#160;        $prev_cell_margin = <a class="code" href="../../d4/d40/classTCPDF.html#a6decef4569cfd79d75e47cab1315fa77">$this-&gt;cell_margin</a>;</div>
<div class="line"><a name="l05791"></a><span class="lineno"> 5791</span>&#160;        $prev_cell_padding = <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$this-&gt;cell_padding</a>;</div>
<div class="line"><a name="l05792"></a><span class="lineno"> 5792</span>&#160;        <span class="comment">// adjust internal padding</span></div>
<div class="line"><a name="l05793"></a><span class="lineno"> 5793</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a574cf231b14aa43921ac83716b27b3e4">adjustCellPadding</a>($border);</div>
<div class="line"><a name="l05794"></a><span class="lineno"> 5794</span>&#160;        $mc_padding = <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$this-&gt;cell_padding</a>;</div>
<div class="line"><a name="l05795"></a><span class="lineno"> 5795</span>&#160;        $mc_margin = <a class="code" href="../../d4/d40/classTCPDF.html#a6decef4569cfd79d75e47cab1315fa77">$this-&gt;cell_margin</a>;</div>
<div class="line"><a name="l05796"></a><span class="lineno"> 5796</span>&#160;        $this-&gt;cell_padding[<span class="charliteral">&#39;T&#39;</span>] = 0;</div>
<div class="line"><a name="l05797"></a><span class="lineno"> 5797</span>&#160;        $this-&gt;cell_padding[<span class="charliteral">&#39;B&#39;</span>] = 0;</div>
<div class="line"><a name="l05798"></a><span class="lineno"> 5798</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a80e96cb97ad08e7feb952d2e5e8dc36d">setCellMargins</a>(0, 0, 0, 0);</div>
<div class="line"><a name="l05799"></a><span class="lineno"> 5799</span>&#160;        <span class="keywordflow">if</span> (TCPDF_STATIC::empty_string($this-&gt;lasth) OR $reseth) {</div>
<div class="line"><a name="l05800"></a><span class="lineno"> 5800</span>&#160;            <span class="comment">// reset row height</span></div>
<div class="line"><a name="l05801"></a><span class="lineno"> 5801</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a10215105777b306528a827f3669e936e">resetLastH</a>();</div>
<div class="line"><a name="l05802"></a><span class="lineno"> 5802</span>&#160;        }</div>
<div class="line"><a name="l05803"></a><span class="lineno"> 5803</span>&#160;        <span class="keywordflow">if</span> (!TCPDF_STATIC::empty_string(<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>)) {</div>
<div class="line"><a name="l05804"></a><span class="lineno"> 5804</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ad3439990de56253b039bca6a09305758">SetY</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>);</div>
<div class="line"><a name="l05805"></a><span class="lineno"> 5805</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05806"></a><span class="lineno"> 5806</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ae3b6169ba729309f289a5ac9680dd799">GetY</a>();</div>
<div class="line"><a name="l05807"></a><span class="lineno"> 5807</span>&#160;        }</div>
<div class="line"><a name="l05808"></a><span class="lineno"> 5808</span>&#160;        $resth = 0;</div>
<div class="line"><a name="l05809"></a><span class="lineno"> 5809</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> &gt; 0) AND $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a13f370f8e1553105eaa3553f52c3fc6c">inPageBody</a>() AND ((<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> + <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> + $mc_margin[<span class="charliteral">&#39;T&#39;</span>] + $mc_margin[<span class="charliteral">&#39;B&#39;</span>]) &gt; $this-&gt;PageBreakTrigger)) {</div>
<div class="line"><a name="l05810"></a><span class="lineno"> 5810</span>&#160;            <span class="comment">// spit cell in more pages/columns</span></div>
<div class="line"><a name="l05811"></a><span class="lineno"> 5811</span>&#160;            $newh = ($this-&gt;PageBreakTrigger - <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>);</div>
<div class="line"><a name="l05812"></a><span class="lineno"> 5812</span>&#160;            $resth = (<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> - $newh); <span class="comment">// cell to be printed on the next page/column</span></div>
<div class="line"><a name="l05813"></a><span class="lineno"> 5813</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> = $newh;</div>
<div class="line"><a name="l05814"></a><span class="lineno"> 5814</span>&#160;        }</div>
<div class="line"><a name="l05815"></a><span class="lineno"> 5815</span>&#160;        <span class="comment">// get current page number</span></div>
<div class="line"><a name="l05816"></a><span class="lineno"> 5816</span>&#160;        $startpage = <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>;</div>
<div class="line"><a name="l05817"></a><span class="lineno"> 5817</span>&#160;        <span class="comment">// get current column</span></div>
<div class="line"><a name="l05818"></a><span class="lineno"> 5818</span>&#160;        $startcolumn = <a class="code" href="../../d4/d40/classTCPDF.html#aab81c25eefaf486adf004eb20bc22881">$this-&gt;current_column</a>;</div>
<div class="line"><a name="l05819"></a><span class="lineno"> 5819</span>&#160;        <span class="keywordflow">if</span> (!TCPDF_STATIC::empty_string(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>)) {</div>
<div class="line"><a name="l05820"></a><span class="lineno"> 5820</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8d831d202e6420fe8fa6aeae7d3a2e8e">SetX</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>);</div>
<div class="line"><a name="l05821"></a><span class="lineno"> 5821</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05822"></a><span class="lineno"> 5822</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a415a80a301208fa77552048b27d2e0ce">GetX</a>();</div>
<div class="line"><a name="l05823"></a><span class="lineno"> 5823</span>&#160;        }</div>
<div class="line"><a name="l05824"></a><span class="lineno"> 5824</span>&#160;        <span class="comment">// check page for no-write regions and adapt page margins if necessary</span></div>
<div class="line"><a name="l05825"></a><span class="lineno"> 5825</span>&#160;        list(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>) = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1d99e81697a90efb13a6734001427f40">checkPageRegions</a>(0, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>);</div>
<div class="line"><a name="l05826"></a><span class="lineno"> 5826</span>&#160;        <span class="comment">// apply margins</span></div>
<div class="line"><a name="l05827"></a><span class="lineno"> 5827</span>&#160;        $oy = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> + $mc_margin[<span class="charliteral">&#39;T&#39;</span>];</div>
<div class="line"><a name="l05828"></a><span class="lineno"> 5828</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l05829"></a><span class="lineno"> 5829</span>&#160;            $ox = ($this-&gt;w - <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> - $mc_margin[<span class="charliteral">&#39;R&#39;</span>]);</div>
<div class="line"><a name="l05830"></a><span class="lineno"> 5830</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05831"></a><span class="lineno"> 5831</span>&#160;            $ox = (<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> + $mc_margin[<span class="charliteral">&#39;L&#39;</span>]);</div>
<div class="line"><a name="l05832"></a><span class="lineno"> 5832</span>&#160;        }</div>
<div class="line"><a name="l05833"></a><span class="lineno"> 5833</span>&#160;        $this-&gt;x = $ox;</div>
<div class="line"><a name="l05834"></a><span class="lineno"> 5834</span>&#160;        $this-&gt;y = $oy;</div>
<div class="line"><a name="l05835"></a><span class="lineno"> 5835</span>&#160;        <span class="comment">// set width</span></div>
<div class="line"><a name="l05836"></a><span class="lineno"> 5836</span>&#160;        <span class="keywordflow">if</span> (TCPDF_STATIC::empty_string(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>) OR (<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> &lt;= 0)) {</div>
<div class="line"><a name="l05837"></a><span class="lineno"> 5837</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l05838"></a><span class="lineno"> 5838</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = ($this-&gt;x - $this-&gt;lMargin - $mc_margin[<span class="charliteral">&#39;L&#39;</span>]);</div>
<div class="line"><a name="l05839"></a><span class="lineno"> 5839</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05840"></a><span class="lineno"> 5840</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = ($this-&gt;w - $this-&gt;x - $this-&gt;rMargin - $mc_margin[<span class="charliteral">&#39;R&#39;</span>]);</div>
<div class="line"><a name="l05841"></a><span class="lineno"> 5841</span>&#160;            }</div>
<div class="line"><a name="l05842"></a><span class="lineno"> 5842</span>&#160;        }</div>
<div class="line"><a name="l05843"></a><span class="lineno"> 5843</span>&#160;        <span class="comment">// store original margin values</span></div>
<div class="line"><a name="l05844"></a><span class="lineno"> 5844</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da">$lMargin</a> = <a class="code" href="../../d4/d40/classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da">$this-&gt;lMargin</a>;</div>
<div class="line"><a name="l05845"></a><span class="lineno"> 5845</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#a44fb75b85bea40ced25fdea9d89dc8e9">$rMargin</a> = <a class="code" href="../../d4/d40/classTCPDF.html#a44fb75b85bea40ced25fdea9d89dc8e9">$this-&gt;rMargin</a>;</div>
<div class="line"><a name="l05846"></a><span class="lineno"> 5846</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l05847"></a><span class="lineno"> 5847</span>&#160;            $this-&gt;rMargin = ($this-&gt;w - <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$this-&gt;x</a>);</div>
<div class="line"><a name="l05848"></a><span class="lineno"> 5848</span>&#160;            $this-&gt;lMargin = ($this-&gt;x - <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>);</div>
<div class="line"><a name="l05849"></a><span class="lineno"> 5849</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05850"></a><span class="lineno"> 5850</span>&#160;            $this-&gt;lMargin = (<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$this-&gt;x</a>);</div>
<div class="line"><a name="l05851"></a><span class="lineno"> 5851</span>&#160;            $this-&gt;rMargin = ($this-&gt;w - $this-&gt;x - <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>);</div>
<div class="line"><a name="l05852"></a><span class="lineno"> 5852</span>&#160;        }</div>
<div class="line"><a name="l05853"></a><span class="lineno"> 5853</span>&#160;        $this-&gt;clMargin = <a class="code" href="../../d4/d40/classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da">$this-&gt;lMargin</a>;</div>
<div class="line"><a name="l05854"></a><span class="lineno"> 5854</span>&#160;        $this-&gt;crMargin = <a class="code" href="../../d4/d40/classTCPDF.html#a44fb75b85bea40ced25fdea9d89dc8e9">$this-&gt;rMargin</a>;</div>
<div class="line"><a name="l05855"></a><span class="lineno"> 5855</span>&#160;        <span class="keywordflow">if</span> ($autopadding) {</div>
<div class="line"><a name="l05856"></a><span class="lineno"> 5856</span>&#160;            <span class="comment">// add top padding</span></div>
<div class="line"><a name="l05857"></a><span class="lineno"> 5857</span>&#160;            $this-&gt;y += $mc_padding[<span class="charliteral">&#39;T&#39;</span>];</div>
<div class="line"><a name="l05858"></a><span class="lineno"> 5858</span>&#160;        }</div>
<div class="line"><a name="l05859"></a><span class="lineno"> 5859</span>&#160;        <span class="keywordflow">if</span> ($ishtml) { <span class="comment">// ******* Write HTML text</span></div>
<div class="line"><a name="l05860"></a><span class="lineno"> 5860</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac3fdf25fcd36f1dce04f92187c621407">writeHTML</a>($txt, <span class="keyword">true</span>, <span class="keyword">false</span>, $reseth, <span class="keyword">true</span>, $align);</div>
<div class="line"><a name="l05861"></a><span class="lineno"> 5861</span>&#160;            $nl = 1;</div>
<div class="line"><a name="l05862"></a><span class="lineno"> 5862</span>&#160;        } <span class="keywordflow">else</span> { <span class="comment">// ******* Write simple text</span></div>
<div class="line"><a name="l05863"></a><span class="lineno"> 5863</span>&#160;            $prev_FontSizePt = <a class="code" href="../../d4/d40/classTCPDF.html#a9a787786c9f1a04f54f1dec622869d4d">$this-&gt;FontSizePt</a>;</div>
<div class="line"><a name="l05864"></a><span class="lineno"> 5864</span>&#160;            <span class="keywordflow">if</span> ($fitcell) {</div>
<div class="line"><a name="l05865"></a><span class="lineno"> 5865</span>&#160;                <span class="comment">// ajust height values</span></div>
<div class="line"><a name="l05866"></a><span class="lineno"> 5866</span>&#160;                $tobottom = ($this-&gt;h - $this-&gt;y - $this-&gt;bMargin - $this-&gt;cell_padding[<span class="charliteral">&#39;T&#39;</span>] - $this-&gt;cell_padding[<span class="charliteral">&#39;B&#39;</span>]);</div>
<div class="line"><a name="l05867"></a><span class="lineno"> 5867</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> = $maxh = max(min(<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $tobottom), min($maxh, $tobottom));</div>
<div class="line"><a name="l05868"></a><span class="lineno"> 5868</span>&#160;            }</div>
<div class="line"><a name="l05869"></a><span class="lineno"> 5869</span>&#160;            <span class="comment">// vertical alignment</span></div>
<div class="line"><a name="l05870"></a><span class="lineno"> 5870</span>&#160;            <span class="keywordflow">if</span> ($maxh &gt; 0) {</div>
<div class="line"><a name="l05871"></a><span class="lineno"> 5871</span>&#160;                <span class="comment">// get text height</span></div>
<div class="line"><a name="l05872"></a><span class="lineno"> 5872</span>&#160;                $text_height = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ad68e86a862fe437a8ac1728cecaaa2e9">getStringHeight</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, $txt, $reseth, $autopadding, $mc_padding, $border);</div>
<div class="line"><a name="l05873"></a><span class="lineno"> 5873</span>&#160;                <span class="keywordflow">if</span> ($fitcell AND ($text_height &gt; $maxh) AND ($this-&gt;FontSizePt &gt; 1)) {</div>
<div class="line"><a name="l05874"></a><span class="lineno"> 5874</span>&#160;                    <span class="comment">// try to reduce font size to fit text on cell (use a quick search algorithm)</span></div>
<div class="line"><a name="l05875"></a><span class="lineno"> 5875</span>&#160;                    $fmin = 1;</div>
<div class="line"><a name="l05876"></a><span class="lineno"> 5876</span>&#160;                    $fmax = <a class="code" href="../../d4/d40/classTCPDF.html#a9a787786c9f1a04f54f1dec622869d4d">$this-&gt;FontSizePt</a>;</div>
<div class="line"><a name="l05877"></a><span class="lineno"> 5877</span>&#160;                    $diff_epsilon = (1 / <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>); <span class="comment">// one point (min resolution)</span></div>
<div class="line"><a name="l05878"></a><span class="lineno"> 5878</span>&#160;                    $maxit = (2 * min(100, max(10, intval($fmax)))); <span class="comment">// max number of iterations</span></div>
<div class="line"><a name="l05879"></a><span class="lineno"> 5879</span>&#160;                    <span class="keywordflow">while</span> ($maxit &gt;= 0) {</div>
<div class="line"><a name="l05880"></a><span class="lineno"> 5880</span>&#160;                        $fmid = (($fmax + $fmin) / 2);</div>
<div class="line"><a name="l05881"></a><span class="lineno"> 5881</span>&#160;                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a6df400b01d3ec1579e1e925b98c31d5f">SetFontSize</a>($fmid, <span class="keyword">false</span>);</div>
<div class="line"><a name="l05882"></a><span class="lineno"> 5882</span>&#160;                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a10215105777b306528a827f3669e936e">resetLastH</a>();</div>
<div class="line"><a name="l05883"></a><span class="lineno"> 5883</span>&#160;                        $text_height = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ad68e86a862fe437a8ac1728cecaaa2e9">getStringHeight</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, $txt, $reseth, $autopadding, $mc_padding, $border);</div>
<div class="line"><a name="l05884"></a><span class="lineno"> 5884</span>&#160;                        $diff = ($maxh - $text_height);</div>
<div class="line"><a name="l05885"></a><span class="lineno"> 5885</span>&#160;                        <span class="keywordflow">if</span> ($diff &gt;= 0) {</div>
<div class="line"><a name="l05886"></a><span class="lineno"> 5886</span>&#160;                            <span class="keywordflow">if</span> ($diff &lt;= $diff_epsilon) {</div>
<div class="line"><a name="l05887"></a><span class="lineno"> 5887</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05888"></a><span class="lineno"> 5888</span>&#160;                            }</div>
<div class="line"><a name="l05889"></a><span class="lineno"> 5889</span>&#160;                            $fmin = $fmid;</div>
<div class="line"><a name="l05890"></a><span class="lineno"> 5890</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05891"></a><span class="lineno"> 5891</span>&#160;                            $fmax = $fmid;</div>
<div class="line"><a name="l05892"></a><span class="lineno"> 5892</span>&#160;                        }</div>
<div class="line"><a name="l05893"></a><span class="lineno"> 5893</span>&#160;                        --$maxit;</div>
<div class="line"><a name="l05894"></a><span class="lineno"> 5894</span>&#160;                    }</div>
<div class="line"><a name="l05895"></a><span class="lineno"> 5895</span>&#160;                    <span class="keywordflow">if</span> ($maxit &lt; 0) {</div>
<div class="line"><a name="l05896"></a><span class="lineno"> 5896</span>&#160;                        <span class="comment">// premature exit, we get the minimum font value to fit the cell</span></div>
<div class="line"><a name="l05897"></a><span class="lineno"> 5897</span>&#160;                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a6df400b01d3ec1579e1e925b98c31d5f">SetFontSize</a>($fmin);</div>
<div class="line"><a name="l05898"></a><span class="lineno"> 5898</span>&#160;                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a10215105777b306528a827f3669e936e">resetLastH</a>();</div>
<div class="line"><a name="l05899"></a><span class="lineno"> 5899</span>&#160;                        $text_height = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ad68e86a862fe437a8ac1728cecaaa2e9">getStringHeight</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, $txt, $reseth, $autopadding, $mc_padding, $border);</div>
<div class="line"><a name="l05900"></a><span class="lineno"> 5900</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05901"></a><span class="lineno"> 5901</span>&#160;                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a6df400b01d3ec1579e1e925b98c31d5f">SetFontSize</a>($fmid);</div>
<div class="line"><a name="l05902"></a><span class="lineno"> 5902</span>&#160;                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a10215105777b306528a827f3669e936e">resetLastH</a>();</div>
<div class="line"><a name="l05903"></a><span class="lineno"> 5903</span>&#160;                    }</div>
<div class="line"><a name="l05904"></a><span class="lineno"> 5904</span>&#160;                }</div>
<div class="line"><a name="l05905"></a><span class="lineno"> 5905</span>&#160;                <span class="keywordflow">if</span> ($text_height &lt; $maxh) {</div>
<div class="line"><a name="l05906"></a><span class="lineno"> 5906</span>&#160;                    <span class="keywordflow">if</span> ($valign == <span class="charliteral">&#39;M&#39;</span>) {</div>
<div class="line"><a name="l05907"></a><span class="lineno"> 5907</span>&#160;                        <span class="comment">// text vertically centered</span></div>
<div class="line"><a name="l05908"></a><span class="lineno"> 5908</span>&#160;                        $this-&gt;y += (($maxh - $text_height) / 2);</div>
<div class="line"><a name="l05909"></a><span class="lineno"> 5909</span>&#160;                    } elseif ($valign == <span class="charliteral">&#39;B&#39;</span>) {</div>
<div class="line"><a name="l05910"></a><span class="lineno"> 5910</span>&#160;                        <span class="comment">// text vertically aligned on bottom</span></div>
<div class="line"><a name="l05911"></a><span class="lineno"> 5911</span>&#160;                        $this-&gt;y += ($maxh - $text_height);</div>
<div class="line"><a name="l05912"></a><span class="lineno"> 5912</span>&#160;                    }</div>
<div class="line"><a name="l05913"></a><span class="lineno"> 5913</span>&#160;                }</div>
<div class="line"><a name="l05914"></a><span class="lineno"> 5914</span>&#160;            }</div>
<div class="line"><a name="l05915"></a><span class="lineno"> 5915</span>&#160;            $nl = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a6669ae88090963e9487d0388c7577dc9">Write</a>($this-&gt;lasth, $txt, <span class="stringliteral">&#39;&#39;</span>, 0, $align, <span class="keyword">true</span>, $stretch, <span class="keyword">false</span>, <span class="keyword">true</span>, $maxh, 0, $mc_margin);</div>
<div class="line"><a name="l05916"></a><span class="lineno"> 5916</span>&#160;            <span class="keywordflow">if</span> ($fitcell) {</div>
<div class="line"><a name="l05917"></a><span class="lineno"> 5917</span>&#160;                <span class="comment">// restore font size</span></div>
<div class="line"><a name="l05918"></a><span class="lineno"> 5918</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a6df400b01d3ec1579e1e925b98c31d5f">SetFontSize</a>($prev_FontSizePt);</div>
<div class="line"><a name="l05919"></a><span class="lineno"> 5919</span>&#160;            }</div>
<div class="line"><a name="l05920"></a><span class="lineno"> 5920</span>&#160;        }</div>
<div class="line"><a name="l05921"></a><span class="lineno"> 5921</span>&#160;        <span class="keywordflow">if</span> ($autopadding) {</div>
<div class="line"><a name="l05922"></a><span class="lineno"> 5922</span>&#160;            <span class="comment">// add bottom padding</span></div>
<div class="line"><a name="l05923"></a><span class="lineno"> 5923</span>&#160;            $this-&gt;y += $mc_padding[<span class="charliteral">&#39;B&#39;</span>];</div>
<div class="line"><a name="l05924"></a><span class="lineno"> 5924</span>&#160;        }</div>
<div class="line"><a name="l05925"></a><span class="lineno"> 5925</span>&#160;        <span class="comment">// Get end-of-text Y position</span></div>
<div class="line"><a name="l05926"></a><span class="lineno"> 5926</span>&#160;        $currentY = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l05927"></a><span class="lineno"> 5927</span>&#160;        <span class="comment">// get latest page number</span></div>
<div class="line"><a name="l05928"></a><span class="lineno"> 5928</span>&#160;        $endpage = <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>;</div>
<div class="line"><a name="l05929"></a><span class="lineno"> 5929</span>&#160;        <span class="keywordflow">if</span> ($resth &gt; 0) {</div>
<div class="line"><a name="l05930"></a><span class="lineno"> 5930</span>&#160;            $skip = ($endpage - $startpage);</div>
<div class="line"><a name="l05931"></a><span class="lineno"> 5931</span>&#160;            $tmpresth = $resth;</div>
<div class="line"><a name="l05932"></a><span class="lineno"> 5932</span>&#160;            <span class="keywordflow">while</span> ($tmpresth &gt; 0) {</div>
<div class="line"><a name="l05933"></a><span class="lineno"> 5933</span>&#160;                <span class="keywordflow">if</span> ($skip &lt;= 0) {</div>
<div class="line"><a name="l05934"></a><span class="lineno"> 5934</span>&#160;                    <span class="comment">// add a page (or trig AcceptPageBreak() for multicolumn mode)</span></div>
<div class="line"><a name="l05935"></a><span class="lineno"> 5935</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a9e8e4b4d75485b8f1e3aa2133a811e50">checkPageBreak</a>($this-&gt;PageBreakTrigger + 1);</div>
<div class="line"><a name="l05936"></a><span class="lineno"> 5936</span>&#160;                }</div>
<div class="line"><a name="l05937"></a><span class="lineno"> 5937</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;num_columns &gt; 1) {</div>
<div class="line"><a name="l05938"></a><span class="lineno"> 5938</span>&#160;                    $tmpresth -= ($this-&gt;h - $this-&gt;y - <a class="code" href="../../d4/d40/classTCPDF.html#acfe6c98519acb01dd53aa153c12bf79b">$this-&gt;bMargin</a>);</div>
<div class="line"><a name="l05939"></a><span class="lineno"> 5939</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05940"></a><span class="lineno"> 5940</span>&#160;                    $tmpresth -= ($this-&gt;h - $this-&gt;tMargin - <a class="code" href="../../d4/d40/classTCPDF.html#acfe6c98519acb01dd53aa153c12bf79b">$this-&gt;bMargin</a>);</div>
<div class="line"><a name="l05941"></a><span class="lineno"> 5941</span>&#160;                }</div>
<div class="line"><a name="l05942"></a><span class="lineno"> 5942</span>&#160;                --$skip;</div>
<div class="line"><a name="l05943"></a><span class="lineno"> 5943</span>&#160;            }</div>
<div class="line"><a name="l05944"></a><span class="lineno"> 5944</span>&#160;            $currentY = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l05945"></a><span class="lineno"> 5945</span>&#160;            $endpage = <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>;</div>
<div class="line"><a name="l05946"></a><span class="lineno"> 5946</span>&#160;        }</div>
<div class="line"><a name="l05947"></a><span class="lineno"> 5947</span>&#160;        <span class="comment">// get latest column</span></div>
<div class="line"><a name="l05948"></a><span class="lineno"> 5948</span>&#160;        $endcolumn = <a class="code" href="../../d4/d40/classTCPDF.html#aab81c25eefaf486adf004eb20bc22881">$this-&gt;current_column</a>;</div>
<div class="line"><a name="l05949"></a><span class="lineno"> 5949</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;num_columns == 0) {</div>
<div class="line"><a name="l05950"></a><span class="lineno"> 5950</span>&#160;            $this-&gt;num_columns = 1;</div>
<div class="line"><a name="l05951"></a><span class="lineno"> 5951</span>&#160;        }</div>
<div class="line"><a name="l05952"></a><span class="lineno"> 5952</span>&#160;        <span class="comment">// disable page regions check</span></div>
<div class="line"><a name="l05953"></a><span class="lineno"> 5953</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#aa0c76ae0aa3fb88a2adbecbdd39a3736">$check_page_regions</a> = <a class="code" href="../../d4/d40/classTCPDF.html#aa0c76ae0aa3fb88a2adbecbdd39a3736">$this-&gt;check_page_regions</a>;</div>
<div class="line"><a name="l05954"></a><span class="lineno"> 5954</span>&#160;        $this-&gt;check_page_regions = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05955"></a><span class="lineno"> 5955</span>&#160;        <span class="comment">// get border modes</span></div>
<div class="line"><a name="l05956"></a><span class="lineno"> 5956</span>&#160;        $border_start = TCPDF_STATIC::getBorderMode($border, $position=<span class="stringliteral">&#39;start&#39;</span>, $this-&gt;opencell);</div>
<div class="line"><a name="l05957"></a><span class="lineno"> 5957</span>&#160;        $border_end = TCPDF_STATIC::getBorderMode($border, $position=<span class="stringliteral">&#39;end&#39;</span>, $this-&gt;opencell);</div>
<div class="line"><a name="l05958"></a><span class="lineno"> 5958</span>&#160;        $border_middle = TCPDF_STATIC::getBorderMode($border, $position=<span class="stringliteral">&#39;middle&#39;</span>, $this-&gt;opencell);</div>
<div class="line"><a name="l05959"></a><span class="lineno"> 5959</span>&#160;        <span class="comment">// design borders around HTML cells.</span></div>
<div class="line"><a name="l05960"></a><span class="lineno"> 5960</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a> = $startpage; <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a> &lt;= $endpage; ++<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>) { <span class="comment">// for each page</span></div>
<div class="line"><a name="l05961"></a><span class="lineno"> 5961</span>&#160;            $ccode = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l05962"></a><span class="lineno"> 5962</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a99075a970e4fec86e1b31e8ecc923e00">setPage</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>);</div>
<div class="line"><a name="l05963"></a><span class="lineno"> 5963</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;num_columns &lt; 2) {</div>
<div class="line"><a name="l05964"></a><span class="lineno"> 5964</span>&#160;                <span class="comment">// single-column mode</span></div>
<div class="line"><a name="l05965"></a><span class="lineno"> 5965</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8d831d202e6420fe8fa6aeae7d3a2e8e">SetX</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>);</div>
<div class="line"><a name="l05966"></a><span class="lineno"> 5966</span>&#160;                $this-&gt;y = <a class="code" href="../../d4/d40/classTCPDF.html#ace8343242b398fd16a4acb1926b6efa7">$this-&gt;tMargin</a>;</div>
<div class="line"><a name="l05967"></a><span class="lineno"> 5967</span>&#160;            }</div>
<div class="line"><a name="l05968"></a><span class="lineno"> 5968</span>&#160;            <span class="comment">// account for margin changes</span></div>
<div class="line"><a name="l05969"></a><span class="lineno"> 5969</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a> &gt; $startpage) {</div>
<div class="line"><a name="l05970"></a><span class="lineno"> 5970</span>&#160;                <span class="keywordflow">if</span> (($this-&gt;rtl) AND ($this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>][<span class="stringliteral">&#39;orm&#39;</span>] != $this-&gt;pagedim[$startpage][<span class="stringliteral">&#39;orm&#39;</span>])) {</div>
<div class="line"><a name="l05971"></a><span class="lineno"> 5971</span>&#160;                    $this-&gt;x -= ($this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>][<span class="stringliteral">&#39;orm&#39;</span>] - $this-&gt;pagedim[$startpage][<span class="stringliteral">&#39;orm&#39;</span>]);</div>
<div class="line"><a name="l05972"></a><span class="lineno"> 5972</span>&#160;                } elseif ((!$this-&gt;rtl) AND ($this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>][<span class="stringliteral">&#39;olm&#39;</span>] != $this-&gt;pagedim[$startpage][<span class="stringliteral">&#39;olm&#39;</span>])) {</div>
<div class="line"><a name="l05973"></a><span class="lineno"> 5973</span>&#160;                    $this-&gt;x += ($this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>][<span class="stringliteral">&#39;olm&#39;</span>] - $this-&gt;pagedim[$startpage][<span class="stringliteral">&#39;olm&#39;</span>]);</div>
<div class="line"><a name="l05974"></a><span class="lineno"> 5974</span>&#160;                }</div>
<div class="line"><a name="l05975"></a><span class="lineno"> 5975</span>&#160;            }</div>
<div class="line"><a name="l05976"></a><span class="lineno"> 5976</span>&#160;            <span class="keywordflow">if</span> ($startpage == $endpage) {</div>
<div class="line"><a name="l05977"></a><span class="lineno"> 5977</span>&#160;                <span class="comment">// single page</span></div>
<div class="line"><a name="l05978"></a><span class="lineno"> 5978</span>&#160;                <span class="keywordflow">for</span> ($column = $startcolumn; $column &lt;= $endcolumn; ++$column) { <span class="comment">// for each column</span></div>
<div class="line"><a name="l05979"></a><span class="lineno"> 5979</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4f11d769024fd07e1f663efd02d10517">selectColumn</a>($column);</div>
<div class="line"><a name="l05980"></a><span class="lineno"> 5980</span>&#160;                    <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l05981"></a><span class="lineno"> 5981</span>&#160;                        $this-&gt;x -= $mc_margin[<span class="charliteral">&#39;R&#39;</span>];</div>
<div class="line"><a name="l05982"></a><span class="lineno"> 5982</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l05983"></a><span class="lineno"> 5983</span>&#160;                        $this-&gt;x += $mc_margin[<span class="charliteral">&#39;L&#39;</span>];</div>
<div class="line"><a name="l05984"></a><span class="lineno"> 5984</span>&#160;                    }</div>
<div class="line"><a name="l05985"></a><span class="lineno"> 5985</span>&#160;                    <span class="keywordflow">if</span> ($startcolumn == $endcolumn) { <span class="comment">// single column</span></div>
<div class="line"><a name="l05986"></a><span class="lineno"> 5986</span>&#160;                        $cborder = $border;</div>
<div class="line"><a name="l05987"></a><span class="lineno"> 5987</span>&#160;                        <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> = max(<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, ($currentY - $oy));</div>
<div class="line"><a name="l05988"></a><span class="lineno"> 5988</span>&#160;                        $this-&gt;y = $oy;</div>
<div class="line"><a name="l05989"></a><span class="lineno"> 5989</span>&#160;                    } elseif ($column == $startcolumn) { <span class="comment">// first column</span></div>
<div class="line"><a name="l05990"></a><span class="lineno"> 5990</span>&#160;                        $cborder = $border_start;</div>
<div class="line"><a name="l05991"></a><span class="lineno"> 5991</span>&#160;                        $this-&gt;y = $oy;</div>
<div class="line"><a name="l05992"></a><span class="lineno"> 5992</span>&#160;                        <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> = $this-&gt;h - $this-&gt;y - <a class="code" href="../../d4/d40/classTCPDF.html#acfe6c98519acb01dd53aa153c12bf79b">$this-&gt;bMargin</a>;</div>
<div class="line"><a name="l05993"></a><span class="lineno"> 5993</span>&#160;                    } elseif ($column == $endcolumn) { <span class="comment">// end column</span></div>
<div class="line"><a name="l05994"></a><span class="lineno"> 5994</span>&#160;                        $cborder = $border_end;</div>
<div class="line"><a name="l05995"></a><span class="lineno"> 5995</span>&#160;                        <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> = $currentY - <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l05996"></a><span class="lineno"> 5996</span>&#160;                        <span class="keywordflow">if</span> ($resth &gt; <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>) {</div>
<div class="line"><a name="l05997"></a><span class="lineno"> 5997</span>&#160;                            <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> = $resth;</div>
<div class="line"><a name="l05998"></a><span class="lineno"> 5998</span>&#160;                        }</div>
<div class="line"><a name="l05999"></a><span class="lineno"> 5999</span>&#160;                    } <span class="keywordflow">else</span> { <span class="comment">// middle column</span></div>
<div class="line"><a name="l06000"></a><span class="lineno"> 6000</span>&#160;                        $cborder = $border_middle;</div>
<div class="line"><a name="l06001"></a><span class="lineno"> 6001</span>&#160;                        <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> = $this-&gt;h - $this-&gt;y - <a class="code" href="../../d4/d40/classTCPDF.html#acfe6c98519acb01dd53aa153c12bf79b">$this-&gt;bMargin</a>;</div>
<div class="line"><a name="l06002"></a><span class="lineno"> 6002</span>&#160;                        $resth -= <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>;</div>
<div class="line"><a name="l06003"></a><span class="lineno"> 6003</span>&#160;                    }</div>
<div class="line"><a name="l06004"></a><span class="lineno"> 6004</span>&#160;                    $ccode .= $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa064c22c3ff653664433fc4e05fa8efc">getCellCode</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, <span class="stringliteral">&#39;&#39;</span>, $cborder, 1, <span class="stringliteral">&#39;&#39;</span>, $fill, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="keyword">true</span>).<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l06005"></a><span class="lineno"> 6005</span>&#160;                } <span class="comment">// end for each column</span></div>
<div class="line"><a name="l06006"></a><span class="lineno"> 6006</span>&#160;            } elseif (<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a> == $startpage) { <span class="comment">// first page</span></div>
<div class="line"><a name="l06007"></a><span class="lineno"> 6007</span>&#160;                <span class="keywordflow">for</span> ($column = $startcolumn; $column &lt; <a class="code" href="../../d4/d40/classTCPDF.html#aea769a906ed606706e862bd7576e9a34">$this-&gt;num_columns</a>; ++$column) { <span class="comment">// for each column</span></div>
<div class="line"><a name="l06008"></a><span class="lineno"> 6008</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4f11d769024fd07e1f663efd02d10517">selectColumn</a>($column);</div>
<div class="line"><a name="l06009"></a><span class="lineno"> 6009</span>&#160;                    <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l06010"></a><span class="lineno"> 6010</span>&#160;                        $this-&gt;x -= $mc_margin[<span class="charliteral">&#39;R&#39;</span>];</div>
<div class="line"><a name="l06011"></a><span class="lineno"> 6011</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06012"></a><span class="lineno"> 6012</span>&#160;                        $this-&gt;x += $mc_margin[<span class="charliteral">&#39;L&#39;</span>];</div>
<div class="line"><a name="l06013"></a><span class="lineno"> 6013</span>&#160;                    }</div>
<div class="line"><a name="l06014"></a><span class="lineno"> 6014</span>&#160;                    <span class="keywordflow">if</span> ($column == $startcolumn) { <span class="comment">// first column</span></div>
<div class="line"><a name="l06015"></a><span class="lineno"> 6015</span>&#160;                        $cborder = $border_start;</div>
<div class="line"><a name="l06016"></a><span class="lineno"> 6016</span>&#160;                        $this-&gt;y = $oy;</div>
<div class="line"><a name="l06017"></a><span class="lineno"> 6017</span>&#160;                        <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> = $this-&gt;h - $this-&gt;y - <a class="code" href="../../d4/d40/classTCPDF.html#acfe6c98519acb01dd53aa153c12bf79b">$this-&gt;bMargin</a>;</div>
<div class="line"><a name="l06018"></a><span class="lineno"> 6018</span>&#160;                    } <span class="keywordflow">else</span> { <span class="comment">// middle column</span></div>
<div class="line"><a name="l06019"></a><span class="lineno"> 6019</span>&#160;                        $cborder = $border_middle;</div>
<div class="line"><a name="l06020"></a><span class="lineno"> 6020</span>&#160;                        <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> = $this-&gt;h - $this-&gt;y - <a class="code" href="../../d4/d40/classTCPDF.html#acfe6c98519acb01dd53aa153c12bf79b">$this-&gt;bMargin</a>;</div>
<div class="line"><a name="l06021"></a><span class="lineno"> 6021</span>&#160;                        $resth -= <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>;</div>
<div class="line"><a name="l06022"></a><span class="lineno"> 6022</span>&#160;                    }</div>
<div class="line"><a name="l06023"></a><span class="lineno"> 6023</span>&#160;                    $ccode .= $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa064c22c3ff653664433fc4e05fa8efc">getCellCode</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, <span class="stringliteral">&#39;&#39;</span>, $cborder, 1, <span class="stringliteral">&#39;&#39;</span>, $fill, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="keyword">true</span>).<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l06024"></a><span class="lineno"> 6024</span>&#160;                } <span class="comment">// end for each column</span></div>
<div class="line"><a name="l06025"></a><span class="lineno"> 6025</span>&#160;            } elseif (<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a> == $endpage) { <span class="comment">// last page</span></div>
<div class="line"><a name="l06026"></a><span class="lineno"> 6026</span>&#160;                <span class="keywordflow">for</span> ($column = 0; $column &lt;= $endcolumn; ++$column) { <span class="comment">// for each column</span></div>
<div class="line"><a name="l06027"></a><span class="lineno"> 6027</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4f11d769024fd07e1f663efd02d10517">selectColumn</a>($column);</div>
<div class="line"><a name="l06028"></a><span class="lineno"> 6028</span>&#160;                    <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l06029"></a><span class="lineno"> 6029</span>&#160;                        $this-&gt;x -= $mc_margin[<span class="charliteral">&#39;R&#39;</span>];</div>
<div class="line"><a name="l06030"></a><span class="lineno"> 6030</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06031"></a><span class="lineno"> 6031</span>&#160;                        $this-&gt;x += $mc_margin[<span class="charliteral">&#39;L&#39;</span>];</div>
<div class="line"><a name="l06032"></a><span class="lineno"> 6032</span>&#160;                    }</div>
<div class="line"><a name="l06033"></a><span class="lineno"> 6033</span>&#160;                    <span class="keywordflow">if</span> ($column == $endcolumn) {</div>
<div class="line"><a name="l06034"></a><span class="lineno"> 6034</span>&#160;                        <span class="comment">// end column</span></div>
<div class="line"><a name="l06035"></a><span class="lineno"> 6035</span>&#160;                        $cborder = $border_end;</div>
<div class="line"><a name="l06036"></a><span class="lineno"> 6036</span>&#160;                        <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> = $currentY - <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l06037"></a><span class="lineno"> 6037</span>&#160;                        <span class="keywordflow">if</span> ($resth &gt; <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>) {</div>
<div class="line"><a name="l06038"></a><span class="lineno"> 6038</span>&#160;                            <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> = $resth;</div>
<div class="line"><a name="l06039"></a><span class="lineno"> 6039</span>&#160;                        }</div>
<div class="line"><a name="l06040"></a><span class="lineno"> 6040</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06041"></a><span class="lineno"> 6041</span>&#160;                        <span class="comment">// middle column</span></div>
<div class="line"><a name="l06042"></a><span class="lineno"> 6042</span>&#160;                        $cborder = $border_middle;</div>
<div class="line"><a name="l06043"></a><span class="lineno"> 6043</span>&#160;                        <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> = $this-&gt;h - $this-&gt;y - <a class="code" href="../../d4/d40/classTCPDF.html#acfe6c98519acb01dd53aa153c12bf79b">$this-&gt;bMargin</a>;</div>
<div class="line"><a name="l06044"></a><span class="lineno"> 6044</span>&#160;                        $resth -= <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>;</div>
<div class="line"><a name="l06045"></a><span class="lineno"> 6045</span>&#160;                    }</div>
<div class="line"><a name="l06046"></a><span class="lineno"> 6046</span>&#160;                    $ccode .= $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa064c22c3ff653664433fc4e05fa8efc">getCellCode</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, <span class="stringliteral">&#39;&#39;</span>, $cborder, 1, <span class="stringliteral">&#39;&#39;</span>, $fill, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="keyword">true</span>).<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l06047"></a><span class="lineno"> 6047</span>&#160;                } <span class="comment">// end for each column</span></div>
<div class="line"><a name="l06048"></a><span class="lineno"> 6048</span>&#160;            } <span class="keywordflow">else</span> { <span class="comment">// middle page</span></div>
<div class="line"><a name="l06049"></a><span class="lineno"> 6049</span>&#160;                <span class="keywordflow">for</span> ($column = 0; $column &lt; <a class="code" href="../../d4/d40/classTCPDF.html#aea769a906ed606706e862bd7576e9a34">$this-&gt;num_columns</a>; ++$column) { <span class="comment">// for each column</span></div>
<div class="line"><a name="l06050"></a><span class="lineno"> 6050</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4f11d769024fd07e1f663efd02d10517">selectColumn</a>($column);</div>
<div class="line"><a name="l06051"></a><span class="lineno"> 6051</span>&#160;                    <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l06052"></a><span class="lineno"> 6052</span>&#160;                        $this-&gt;x -= $mc_margin[<span class="charliteral">&#39;R&#39;</span>];</div>
<div class="line"><a name="l06053"></a><span class="lineno"> 6053</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06054"></a><span class="lineno"> 6054</span>&#160;                        $this-&gt;x += $mc_margin[<span class="charliteral">&#39;L&#39;</span>];</div>
<div class="line"><a name="l06055"></a><span class="lineno"> 6055</span>&#160;                    }</div>
<div class="line"><a name="l06056"></a><span class="lineno"> 6056</span>&#160;                    $cborder = $border_middle;</div>
<div class="line"><a name="l06057"></a><span class="lineno"> 6057</span>&#160;                    <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> = $this-&gt;h - $this-&gt;y - <a class="code" href="../../d4/d40/classTCPDF.html#acfe6c98519acb01dd53aa153c12bf79b">$this-&gt;bMargin</a>;</div>
<div class="line"><a name="l06058"></a><span class="lineno"> 6058</span>&#160;                    $resth -= <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>;</div>
<div class="line"><a name="l06059"></a><span class="lineno"> 6059</span>&#160;                    $ccode .= $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa064c22c3ff653664433fc4e05fa8efc">getCellCode</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, <span class="stringliteral">&#39;&#39;</span>, $cborder, 1, <span class="stringliteral">&#39;&#39;</span>, $fill, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="keyword">true</span>).<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l06060"></a><span class="lineno"> 6060</span>&#160;                } <span class="comment">// end for each column</span></div>
<div class="line"><a name="l06061"></a><span class="lineno"> 6061</span>&#160;            }</div>
<div class="line"><a name="l06062"></a><span class="lineno"> 6062</span>&#160;            <span class="keywordflow">if</span> ($cborder OR $fill) {</div>
<div class="line"><a name="l06063"></a><span class="lineno"> 6063</span>&#160;                $offsetlen = strlen($ccode);</div>
<div class="line"><a name="l06064"></a><span class="lineno"> 6064</span>&#160;                <span class="comment">// draw border and fill</span></div>
<div class="line"><a name="l06065"></a><span class="lineno"> 6065</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;inxobj) {</div>
<div class="line"><a name="l06066"></a><span class="lineno"> 6066</span>&#160;                    <span class="comment">// we are inside an XObject template</span></div>
<div class="line"><a name="l06067"></a><span class="lineno"> 6067</span>&#160;                    <span class="keywordflow">if</span> (end($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;transfmrk&#39;</span>]) !== <span class="keyword">false</span>) {</div>
<div class="line"><a name="l06068"></a><span class="lineno"> 6068</span>&#160;                        $pagemarkkey = key($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;transfmrk&#39;</span>]);</div>
<div class="line"><a name="l06069"></a><span class="lineno"> 6069</span>&#160;                        $pagemark = $this-&gt;xobjects[<a class="code" href="../../d4/d40/classTCPDF.html#abe4390b4e1939e10c9b61a986adfc117">$this-&gt;xobjid</a>][<span class="stringliteral">&#39;transfmrk&#39;</span>][$pagemarkkey];</div>
<div class="line"><a name="l06070"></a><span class="lineno"> 6070</span>&#160;                        $this-&gt;xobjects[<a class="code" href="../../d4/d40/classTCPDF.html#abe4390b4e1939e10c9b61a986adfc117">$this-&gt;xobjid</a>][<span class="stringliteral">&#39;transfmrk&#39;</span>][$pagemarkkey] += $offsetlen;</div>
<div class="line"><a name="l06071"></a><span class="lineno"> 6071</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06072"></a><span class="lineno"> 6072</span>&#160;                        $pagemark = $this-&gt;xobjects[<a class="code" href="../../d4/d40/classTCPDF.html#abe4390b4e1939e10c9b61a986adfc117">$this-&gt;xobjid</a>][<span class="stringliteral">&#39;intmrk&#39;</span>];</div>
<div class="line"><a name="l06073"></a><span class="lineno"> 6073</span>&#160;                        $this-&gt;xobjects[<a class="code" href="../../d4/d40/classTCPDF.html#abe4390b4e1939e10c9b61a986adfc117">$this-&gt;xobjid</a>][<span class="stringliteral">&#39;intmrk&#39;</span>] += $offsetlen;</div>
<div class="line"><a name="l06074"></a><span class="lineno"> 6074</span>&#160;                    }</div>
<div class="line"><a name="l06075"></a><span class="lineno"> 6075</span>&#160;                    $pagebuff = $this-&gt;xobjects[<a class="code" href="../../d4/d40/classTCPDF.html#abe4390b4e1939e10c9b61a986adfc117">$this-&gt;xobjid</a>][<span class="stringliteral">&#39;outdata&#39;</span>];</div>
<div class="line"><a name="l06076"></a><span class="lineno"> 6076</span>&#160;                    $pstart = substr($pagebuff, 0, $pagemark);</div>
<div class="line"><a name="l06077"></a><span class="lineno"> 6077</span>&#160;                    $pend = substr($pagebuff, $pagemark);</div>
<div class="line"><a name="l06078"></a><span class="lineno"> 6078</span>&#160;                    $this-&gt;xobjects[<a class="code" href="../../d4/d40/classTCPDF.html#abe4390b4e1939e10c9b61a986adfc117">$this-&gt;xobjid</a>][<span class="stringliteral">&#39;outdata&#39;</span>] = $pstart.$ccode.$pend;</div>
<div class="line"><a name="l06079"></a><span class="lineno"> 6079</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06080"></a><span class="lineno"> 6080</span>&#160;                    <span class="keywordflow">if</span> (end($this-&gt;transfmrk[$this-&gt;page]) !== <span class="keyword">false</span>) {</div>
<div class="line"><a name="l06081"></a><span class="lineno"> 6081</span>&#160;                        $pagemarkkey = key($this-&gt;transfmrk[$this-&gt;page]);</div>
<div class="line"><a name="l06082"></a><span class="lineno"> 6082</span>&#160;                        $pagemark = $this-&gt;transfmrk[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][$pagemarkkey];</div>
<div class="line"><a name="l06083"></a><span class="lineno"> 6083</span>&#160;                        $this-&gt;transfmrk[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][$pagemarkkey] += $offsetlen;</div>
<div class="line"><a name="l06084"></a><span class="lineno"> 6084</span>&#160;                    } elseif ($this-&gt;InFooter) {</div>
<div class="line"><a name="l06085"></a><span class="lineno"> 6085</span>&#160;                        $pagemark = $this-&gt;footerpos[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>];</div>
<div class="line"><a name="l06086"></a><span class="lineno"> 6086</span>&#160;                        $this-&gt;footerpos[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>] += $offsetlen;</div>
<div class="line"><a name="l06087"></a><span class="lineno"> 6087</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06088"></a><span class="lineno"> 6088</span>&#160;                        $pagemark = $this-&gt;intmrk[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>];</div>
<div class="line"><a name="l06089"></a><span class="lineno"> 6089</span>&#160;                        $this-&gt;intmrk[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>] += $offsetlen;</div>
<div class="line"><a name="l06090"></a><span class="lineno"> 6090</span>&#160;                    }</div>
<div class="line"><a name="l06091"></a><span class="lineno"> 6091</span>&#160;                    $pagebuff = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d67b0a8681222f71fa9f9f6e65e0c56">getPageBuffer</a>($this-&gt;page);</div>
<div class="line"><a name="l06092"></a><span class="lineno"> 6092</span>&#160;                    $pstart = substr($pagebuff, 0, $pagemark);</div>
<div class="line"><a name="l06093"></a><span class="lineno"> 6093</span>&#160;                    $pend = substr($pagebuff, $pagemark);</div>
<div class="line"><a name="l06094"></a><span class="lineno"> 6094</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a2b85f6395de14dd40cab8839b3ce25a8">setPageBuffer</a>($this-&gt;page, $pstart.$ccode.$pend);</div>
<div class="line"><a name="l06095"></a><span class="lineno"> 6095</span>&#160;                }</div>
<div class="line"><a name="l06096"></a><span class="lineno"> 6096</span>&#160;            }</div>
<div class="line"><a name="l06097"></a><span class="lineno"> 6097</span>&#160;        } <span class="comment">// end for each page</span></div>
<div class="line"><a name="l06098"></a><span class="lineno"> 6098</span>&#160;        <span class="comment">// restore page regions check</span></div>
<div class="line"><a name="l06099"></a><span class="lineno"> 6099</span>&#160;        $this-&gt;check_page_regions = <a class="code" href="../../d4/d40/classTCPDF.html#aa0c76ae0aa3fb88a2adbecbdd39a3736">$check_page_regions</a>;</div>
<div class="line"><a name="l06100"></a><span class="lineno"> 6100</span>&#160;        <span class="comment">// Get end-of-cell Y position</span></div>
<div class="line"><a name="l06101"></a><span class="lineno"> 6101</span>&#160;        $currentY = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ae3b6169ba729309f289a5ac9680dd799">GetY</a>();</div>
<div class="line"><a name="l06102"></a><span class="lineno"> 6102</span>&#160;        <span class="comment">// restore previous values</span></div>
<div class="line"><a name="l06103"></a><span class="lineno"> 6103</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;num_columns &gt; 1) {</div>
<div class="line"><a name="l06104"></a><span class="lineno"> 6104</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4f11d769024fd07e1f663efd02d10517">selectColumn</a>();</div>
<div class="line"><a name="l06105"></a><span class="lineno"> 6105</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06106"></a><span class="lineno"> 6106</span>&#160;            <span class="comment">// restore original margins</span></div>
<div class="line"><a name="l06107"></a><span class="lineno"> 6107</span>&#160;            $this-&gt;lMargin = <a class="code" href="../../d4/d40/classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da">$lMargin</a>;</div>
<div class="line"><a name="l06108"></a><span class="lineno"> 6108</span>&#160;            $this-&gt;rMargin = <a class="code" href="../../d4/d40/classTCPDF.html#a44fb75b85bea40ced25fdea9d89dc8e9">$rMargin</a>;</div>
<div class="line"><a name="l06109"></a><span class="lineno"> 6109</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;page &gt; $startpage) {</div>
<div class="line"><a name="l06110"></a><span class="lineno"> 6110</span>&#160;                <span class="comment">// check for margin variations between pages (i.e. booklet mode)</span></div>
<div class="line"><a name="l06111"></a><span class="lineno"> 6111</span>&#160;                $dl = ($this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;olm&#39;</span>] - $this-&gt;pagedim[$startpage][<span class="stringliteral">&#39;olm&#39;</span>]);</div>
<div class="line"><a name="l06112"></a><span class="lineno"> 6112</span>&#160;                $dr = ($this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;orm&#39;</span>] - $this-&gt;pagedim[$startpage][<span class="stringliteral">&#39;orm&#39;</span>]);</div>
<div class="line"><a name="l06113"></a><span class="lineno"> 6113</span>&#160;                <span class="keywordflow">if</span> (($dl != 0) OR ($dr != 0)) {</div>
<div class="line"><a name="l06114"></a><span class="lineno"> 6114</span>&#160;                    $this-&gt;lMargin += $dl;</div>
<div class="line"><a name="l06115"></a><span class="lineno"> 6115</span>&#160;                    $this-&gt;rMargin += $dr;</div>
<div class="line"><a name="l06116"></a><span class="lineno"> 6116</span>&#160;                }</div>
<div class="line"><a name="l06117"></a><span class="lineno"> 6117</span>&#160;            }</div>
<div class="line"><a name="l06118"></a><span class="lineno"> 6118</span>&#160;        }</div>
<div class="line"><a name="l06119"></a><span class="lineno"> 6119</span>&#160;        <span class="keywordflow">if</span> ($ln &gt; 0) {</div>
<div class="line"><a name="l06120"></a><span class="lineno"> 6120</span>&#160;            <span class="comment">//Go to the beginning of the next line</span></div>
<div class="line"><a name="l06121"></a><span class="lineno"> 6121</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ad3439990de56253b039bca6a09305758">SetY</a>($currentY + $mc_margin[<span class="charliteral">&#39;B&#39;</span>]);</div>
<div class="line"><a name="l06122"></a><span class="lineno"> 6122</span>&#160;            <span class="keywordflow">if</span> ($ln == 2) {</div>
<div class="line"><a name="l06123"></a><span class="lineno"> 6123</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8d831d202e6420fe8fa6aeae7d3a2e8e">SetX</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> + <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> + $mc_margin[<span class="charliteral">&#39;L&#39;</span>] + $mc_margin[<span class="charliteral">&#39;R&#39;</span>]);</div>
<div class="line"><a name="l06124"></a><span class="lineno"> 6124</span>&#160;            }</div>
<div class="line"><a name="l06125"></a><span class="lineno"> 6125</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06126"></a><span class="lineno"> 6126</span>&#160;            <span class="comment">// go left or right by case</span></div>
<div class="line"><a name="l06127"></a><span class="lineno"> 6127</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a99075a970e4fec86e1b31e8ecc923e00">setPage</a>($startpage);</div>
<div class="line"><a name="l06128"></a><span class="lineno"> 6128</span>&#160;            $this-&gt;y = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>;</div>
<div class="line"><a name="l06129"></a><span class="lineno"> 6129</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8d831d202e6420fe8fa6aeae7d3a2e8e">SetX</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> + <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> + $mc_margin[<span class="charliteral">&#39;L&#39;</span>] + $mc_margin[<span class="charliteral">&#39;R&#39;</span>]);</div>
<div class="line"><a name="l06130"></a><span class="lineno"> 6130</span>&#160;        }</div>
<div class="line"><a name="l06131"></a><span class="lineno"> 6131</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a278cba1881265c0b47036a629a67863f">setContentMark</a>();</div>
<div class="line"><a name="l06132"></a><span class="lineno"> 6132</span>&#160;        $this-&gt;cell_padding = $prev_cell_padding;</div>
<div class="line"><a name="l06133"></a><span class="lineno"> 6133</span>&#160;        $this-&gt;cell_margin = $prev_cell_margin;</div>
<div class="line"><a name="l06134"></a><span class="lineno"> 6134</span>&#160;        $this-&gt;clMargin = <a class="code" href="../../d4/d40/classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da">$this-&gt;lMargin</a>;</div>
<div class="line"><a name="l06135"></a><span class="lineno"> 6135</span>&#160;        $this-&gt;crMargin = <a class="code" href="../../d4/d40/classTCPDF.html#a44fb75b85bea40ced25fdea9d89dc8e9">$this-&gt;rMargin</a>;</div>
<div class="line"><a name="l06136"></a><span class="lineno"> 6136</span>&#160;        <span class="keywordflow">return</span> $nl;</div>
<div class="line"><a name="l06137"></a><span class="lineno"> 6137</span>&#160;    }</div>
<div class="line"><a name="l06138"></a><span class="lineno"> 6138</span>&#160;</div>
<div class="line"><a name="l06152"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#af5cab8b0e1e29a3ee19a14007e37bd99"> 6152</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#af5cab8b0e1e29a3ee19a14007e37bd99">getNumLines</a>($txt, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>=0, $reseth=<span class="keyword">false</span>, $autopadding=<span class="keyword">true</span>, $cellpadding=<span class="stringliteral">&#39;&#39;</span>, $border=0) {</div>
<div class="line"><a name="l06153"></a><span class="lineno"> 6153</span>&#160;        <span class="keywordflow">if</span> ($txt === NULL) {</div>
<div class="line"><a name="l06154"></a><span class="lineno"> 6154</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l06155"></a><span class="lineno"> 6155</span>&#160;        }</div>
<div class="line"><a name="l06156"></a><span class="lineno"> 6156</span>&#160;        <span class="keywordflow">if</span> ($txt === <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l06157"></a><span class="lineno"> 6157</span>&#160;            <span class="comment">// empty string</span></div>
<div class="line"><a name="l06158"></a><span class="lineno"> 6158</span>&#160;            <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l06159"></a><span class="lineno"> 6159</span>&#160;        }</div>
<div class="line"><a name="l06160"></a><span class="lineno"> 6160</span>&#160;        <span class="comment">// adjust internal padding</span></div>
<div class="line"><a name="l06161"></a><span class="lineno"> 6161</span>&#160;        $prev_cell_padding = <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$this-&gt;cell_padding</a>;</div>
<div class="line"><a name="l06162"></a><span class="lineno"> 6162</span>&#160;        $prev_lasth = <a class="code" href="../../d4/d40/classTCPDF.html#a41e87b05a84dd56c2c824af49470e295">$this-&gt;lasth</a>;</div>
<div class="line"><a name="l06163"></a><span class="lineno"> 6163</span>&#160;        <span class="keywordflow">if</span> (is_array($cellpadding)) {</div>
<div class="line"><a name="l06164"></a><span class="lineno"> 6164</span>&#160;            $this-&gt;cell_padding = $cellpadding;</div>
<div class="line"><a name="l06165"></a><span class="lineno"> 6165</span>&#160;        }</div>
<div class="line"><a name="l06166"></a><span class="lineno"> 6166</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a574cf231b14aa43921ac83716b27b3e4">adjustCellPadding</a>($border);</div>
<div class="line"><a name="l06167"></a><span class="lineno"> 6167</span>&#160;        <span class="keywordflow">if</span> (TCPDF_STATIC::empty_string(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>) OR (<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> &lt;= 0)) {</div>
<div class="line"><a name="l06168"></a><span class="lineno"> 6168</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l06169"></a><span class="lineno"> 6169</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = $this-&gt;x - <a class="code" href="../../d4/d40/classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da">$this-&gt;lMargin</a>;</div>
<div class="line"><a name="l06170"></a><span class="lineno"> 6170</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06171"></a><span class="lineno"> 6171</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = $this-&gt;w - $this-&gt;rMargin - <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$this-&gt;x</a>;</div>
<div class="line"><a name="l06172"></a><span class="lineno"> 6172</span>&#160;            }</div>
<div class="line"><a name="l06173"></a><span class="lineno"> 6173</span>&#160;        }</div>
<div class="line"><a name="l06174"></a><span class="lineno"> 6174</span>&#160;        $wmax = <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> - $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>] - $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>];</div>
<div class="line"><a name="l06175"></a><span class="lineno"> 6175</span>&#160;        <span class="keywordflow">if</span> ($reseth) {</div>
<div class="line"><a name="l06176"></a><span class="lineno"> 6176</span>&#160;            <span class="comment">// reset row height</span></div>
<div class="line"><a name="l06177"></a><span class="lineno"> 6177</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a10215105777b306528a827f3669e936e">resetLastH</a>();</div>
<div class="line"><a name="l06178"></a><span class="lineno"> 6178</span>&#160;        }</div>
<div class="line"><a name="l06179"></a><span class="lineno"> 6179</span>&#160;        $lines = 1;</div>
<div class="line"><a name="l06180"></a><span class="lineno"> 6180</span>&#160;        $sum = 0;</div>
<div class="line"><a name="l06181"></a><span class="lineno"> 6181</span>&#160;        $chars = TCPDF_FONTS::utf8Bidi(TCPDF_FONTS::UTF8StringToArray($txt, $this-&gt;isunicode, $this-&gt;CurrentFont), $txt, $this-&gt;tmprtl, $this-&gt;isunicode, $this-&gt;CurrentFont);</div>
<div class="line"><a name="l06182"></a><span class="lineno"> 6182</span>&#160;        $charsWidth = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#afe09291dfba7203e225a507e71e1d43e">GetArrStringWidth</a>($chars, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="keyword">true</span>);</div>
<div class="line"><a name="l06183"></a><span class="lineno"> 6183</span>&#160;        $length = count($chars);</div>
<div class="line"><a name="l06184"></a><span class="lineno"> 6184</span>&#160;        $lastSeparator = -1;</div>
<div class="line"><a name="l06185"></a><span class="lineno"> 6185</span>&#160;        <span class="keywordflow">for</span> ($i = 0; $i &lt; $length; ++$i) {</div>
<div class="line"><a name="l06186"></a><span class="lineno"> 6186</span>&#160;            $c = $chars[$i];</div>
<div class="line"><a name="l06187"></a><span class="lineno"> 6187</span>&#160;            $charWidth = $charsWidth[$i];</div>
<div class="line"><a name="l06188"></a><span class="lineno"> 6188</span>&#160;            <span class="keywordflow">if</span> (($c != 160)</div>
<div class="line"><a name="l06189"></a><span class="lineno"> 6189</span>&#160;                    AND (($c == 173)</div>
<div class="line"><a name="l06190"></a><span class="lineno"> 6190</span>&#160;                        OR preg_match($this-&gt;re_spaces, TCPDF_FONTS::unichr($c, $this-&gt;isunicode))</div>
<div class="line"><a name="l06191"></a><span class="lineno"> 6191</span>&#160;                        OR (($c == 45)</div>
<div class="line"><a name="l06192"></a><span class="lineno"> 6192</span>&#160;                            AND ($i &gt; 0) AND ($i &lt; ($length - 1))</div>
<div class="line"><a name="l06193"></a><span class="lineno"> 6193</span>&#160;                            AND @preg_match(<span class="stringliteral">&#39;/[\p{L}]/&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;m&#39;</span>], TCPDF_FONTS::unichr($chars[($i - 1)], $this-&gt;isunicode))</div>
<div class="line"><a name="l06194"></a><span class="lineno"> 6194</span>&#160;                            AND @preg_match(<span class="stringliteral">&#39;/[\p{L}]/&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;m&#39;</span>], TCPDF_FONTS::unichr($chars[($i + 1)], $this-&gt;isunicode))</div>
<div class="line"><a name="l06195"></a><span class="lineno"> 6195</span>&#160;                        )</div>
<div class="line"><a name="l06196"></a><span class="lineno"> 6196</span>&#160;                    )</div>
<div class="line"><a name="l06197"></a><span class="lineno"> 6197</span>&#160;                ) {</div>
<div class="line"><a name="l06198"></a><span class="lineno"> 6198</span>&#160;                $lastSeparator = $i;</div>
<div class="line"><a name="l06199"></a><span class="lineno"> 6199</span>&#160;            }</div>
<div class="line"><a name="l06200"></a><span class="lineno"> 6200</span>&#160;            <span class="keywordflow">if</span> ((($sum + $charWidth) &gt; $wmax) OR ($c == 10)) {</div>
<div class="line"><a name="l06201"></a><span class="lineno"> 6201</span>&#160;                ++$lines;</div>
<div class="line"><a name="l06202"></a><span class="lineno"> 6202</span>&#160;                <span class="keywordflow">if</span> ($c == 10) {</div>
<div class="line"><a name="l06203"></a><span class="lineno"> 6203</span>&#160;                    $lastSeparator = -1;</div>
<div class="line"><a name="l06204"></a><span class="lineno"> 6204</span>&#160;                    $sum = 0;</div>
<div class="line"><a name="l06205"></a><span class="lineno"> 6205</span>&#160;                } elseif ($lastSeparator != -1) {</div>
<div class="line"><a name="l06206"></a><span class="lineno"> 6206</span>&#160;                    $i = $lastSeparator;</div>
<div class="line"><a name="l06207"></a><span class="lineno"> 6207</span>&#160;                    $lastSeparator = -1;</div>
<div class="line"><a name="l06208"></a><span class="lineno"> 6208</span>&#160;                    $sum = 0;</div>
<div class="line"><a name="l06209"></a><span class="lineno"> 6209</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06210"></a><span class="lineno"> 6210</span>&#160;                    $sum = $charWidth;</div>
<div class="line"><a name="l06211"></a><span class="lineno"> 6211</span>&#160;                }</div>
<div class="line"><a name="l06212"></a><span class="lineno"> 6212</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06213"></a><span class="lineno"> 6213</span>&#160;                $sum += $charWidth;</div>
<div class="line"><a name="l06214"></a><span class="lineno"> 6214</span>&#160;            }</div>
<div class="line"><a name="l06215"></a><span class="lineno"> 6215</span>&#160;        }</div>
<div class="line"><a name="l06216"></a><span class="lineno"> 6216</span>&#160;        <span class="keywordflow">if</span> ($chars[($length - 1)] == 10) {</div>
<div class="line"><a name="l06217"></a><span class="lineno"> 6217</span>&#160;            --$lines;</div>
<div class="line"><a name="l06218"></a><span class="lineno"> 6218</span>&#160;        }</div>
<div class="line"><a name="l06219"></a><span class="lineno"> 6219</span>&#160;        $this-&gt;cell_padding = $prev_cell_padding;</div>
<div class="line"><a name="l06220"></a><span class="lineno"> 6220</span>&#160;        $this-&gt;lasth = $prev_lasth;</div>
<div class="line"><a name="l06221"></a><span class="lineno"> 6221</span>&#160;        <span class="keywordflow">return</span> $lines;</div>
<div class="line"><a name="l06222"></a><span class="lineno"> 6222</span>&#160;    }</div>
<div class="line"><a name="l06223"></a><span class="lineno"> 6223</span>&#160;</div>
<div class="line"><a name="l06271"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ad68e86a862fe437a8ac1728cecaaa2e9"> 6271</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ad68e86a862fe437a8ac1728cecaaa2e9">getStringHeight</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, $txt, $reseth=<span class="keyword">false</span>, $autopadding=<span class="keyword">true</span>, $cellpadding=<span class="stringliteral">&#39;&#39;</span>, $border=0) {</div>
<div class="line"><a name="l06272"></a><span class="lineno"> 6272</span>&#160;        <span class="comment">// adjust internal padding</span></div>
<div class="line"><a name="l06273"></a><span class="lineno"> 6273</span>&#160;        $prev_cell_padding = <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$this-&gt;cell_padding</a>;</div>
<div class="line"><a name="l06274"></a><span class="lineno"> 6274</span>&#160;        $prev_lasth = <a class="code" href="../../d4/d40/classTCPDF.html#a41e87b05a84dd56c2c824af49470e295">$this-&gt;lasth</a>;</div>
<div class="line"><a name="l06275"></a><span class="lineno"> 6275</span>&#160;        <span class="keywordflow">if</span> (is_array($cellpadding)) {</div>
<div class="line"><a name="l06276"></a><span class="lineno"> 6276</span>&#160;            $this-&gt;cell_padding = $cellpadding;</div>
<div class="line"><a name="l06277"></a><span class="lineno"> 6277</span>&#160;        }</div>
<div class="line"><a name="l06278"></a><span class="lineno"> 6278</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a574cf231b14aa43921ac83716b27b3e4">adjustCellPadding</a>($border);</div>
<div class="line"><a name="l06279"></a><span class="lineno"> 6279</span>&#160;        $lines = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af5cab8b0e1e29a3ee19a14007e37bd99">getNumLines</a>($txt, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, $reseth, $autopadding, $cellpadding, $border);</div>
<div class="line"><a name="l06280"></a><span class="lineno"> 6280</span>&#160;        $height = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a25c7f71b3fcb19024497ea620f885346">getCellHeight</a>(($lines * $this-&gt;FontSize), $autopadding);</div>
<div class="line"><a name="l06281"></a><span class="lineno"> 6281</span>&#160;        $this-&gt;cell_padding = $prev_cell_padding;</div>
<div class="line"><a name="l06282"></a><span class="lineno"> 6282</span>&#160;        $this-&gt;lasth = $prev_lasth;</div>
<div class="line"><a name="l06283"></a><span class="lineno"> 6283</span>&#160;        <span class="keywordflow">return</span> $height;</div>
<div class="line"><a name="l06284"></a><span class="lineno"> 6284</span>&#160;    }</div>
<div class="line"><a name="l06285"></a><span class="lineno"> 6285</span>&#160;</div>
<div class="line"><a name="l06304"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a6669ae88090963e9487d0388c7577dc9"> 6304</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a6669ae88090963e9487d0388c7577dc9">Write</a>(<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $txt, $link=<span class="stringliteral">&#39;&#39;</span>, $fill=<span class="keyword">false</span>, $align=<span class="stringliteral">&#39;&#39;</span>, $ln=<span class="keyword">false</span>, $stretch=0, $firstline=<span class="keyword">false</span>, $firstblock=<span class="keyword">false</span>, $maxh=0, $wadj=0, $margin=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l06305"></a><span class="lineno"> 6305</span>&#160;        <span class="comment">// check page for no-write regions and adapt page margins if necessary</span></div>
<div class="line"><a name="l06306"></a><span class="lineno"> 6306</span>&#160;        list($this-&gt;x, $this-&gt;y) = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1d99e81697a90efb13a6734001427f40">checkPageRegions</a>(<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $this-&gt;x, $this-&gt;y);</div>
<div class="line"><a name="l06307"></a><span class="lineno"> 6307</span>&#160;        <span class="keywordflow">if</span> (strlen($txt) == 0) {</div>
<div class="line"><a name="l06308"></a><span class="lineno"> 6308</span>&#160;            <span class="comment">// fix empty text</span></div>
<div class="line"><a name="l06309"></a><span class="lineno"> 6309</span>&#160;            $txt = <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l06310"></a><span class="lineno"> 6310</span>&#160;        }</div>
<div class="line"><a name="l06311"></a><span class="lineno"> 6311</span>&#160;        <span class="keywordflow">if</span> ($margin === <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l06312"></a><span class="lineno"> 6312</span>&#160;            <span class="comment">// set default margins</span></div>
<div class="line"><a name="l06313"></a><span class="lineno"> 6313</span>&#160;            $margin = <a class="code" href="../../d4/d40/classTCPDF.html#a6decef4569cfd79d75e47cab1315fa77">$this-&gt;cell_margin</a>;</div>
<div class="line"><a name="l06314"></a><span class="lineno"> 6314</span>&#160;        }</div>
<div class="line"><a name="l06315"></a><span class="lineno"> 6315</span>&#160;        <span class="comment">// remove carriage returns</span></div>
<div class="line"><a name="l06316"></a><span class="lineno"> 6316</span>&#160;        $s = str_replace(<span class="stringliteral">&quot;\r&quot;</span>, <span class="stringliteral">&#39;&#39;</span>, $txt);</div>
<div class="line"><a name="l06317"></a><span class="lineno"> 6317</span>&#160;        <span class="comment">// check if string contains arabic text</span></div>
<div class="line"><a name="l06318"></a><span class="lineno"> 6318</span>&#160;        <span class="keywordflow">if</span> (preg_match(TCPDF_FONT_DATA::$uni_RE_PATTERN_ARABIC, $s)) {</div>
<div class="line"><a name="l06319"></a><span class="lineno"> 6319</span>&#160;            $arabic = <span class="keyword">true</span>;</div>
<div class="line"><a name="l06320"></a><span class="lineno"> 6320</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06321"></a><span class="lineno"> 6321</span>&#160;            $arabic = <span class="keyword">false</span>;</div>
<div class="line"><a name="l06322"></a><span class="lineno"> 6322</span>&#160;        }</div>
<div class="line"><a name="l06323"></a><span class="lineno"> 6323</span>&#160;        <span class="comment">// check if string contains RTL text</span></div>
<div class="line"><a name="l06324"></a><span class="lineno"> 6324</span>&#160;        <span class="keywordflow">if</span> ($arabic OR ($this-&gt;tmprtl == <span class="charliteral">&#39;R&#39;</span>) OR preg_match(TCPDF_FONT_DATA::$uni_RE_PATTERN_RTL, $s)) {</div>
<div class="line"><a name="l06325"></a><span class="lineno"> 6325</span>&#160;            $rtlmode = <span class="keyword">true</span>;</div>
<div class="line"><a name="l06326"></a><span class="lineno"> 6326</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06327"></a><span class="lineno"> 6327</span>&#160;            $rtlmode = <span class="keyword">false</span>;</div>
<div class="line"><a name="l06328"></a><span class="lineno"> 6328</span>&#160;        }</div>
<div class="line"><a name="l06329"></a><span class="lineno"> 6329</span>&#160;        <span class="comment">// get a char width</span></div>
<div class="line"><a name="l06330"></a><span class="lineno"> 6330</span>&#160;        $chrwidth = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a281f922889bd1ae2dc96e421042ad8e4">GetCharWidth</a>(46); <span class="comment">// dot character</span></div>
<div class="line"><a name="l06331"></a><span class="lineno"> 6331</span>&#160;        <span class="comment">// get array of unicode values</span></div>
<div class="line"><a name="l06332"></a><span class="lineno"> 6332</span>&#160;        $chars = TCPDF_FONTS::UTF8StringToArray($s, $this-&gt;isunicode, $this-&gt;CurrentFont);</div>
<div class="line"><a name="l06333"></a><span class="lineno"> 6333</span>&#160;        <span class="comment">// calculate maximum width for a single character on string</span></div>
<div class="line"><a name="l06334"></a><span class="lineno"> 6334</span>&#160;        $chrw = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#afe09291dfba7203e225a507e71e1d43e">GetArrStringWidth</a>($chars, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="keyword">true</span>);</div>
<div class="line"><a name="l06335"></a><span class="lineno"> 6335</span>&#160;        array_walk($chrw, array($this, <span class="stringliteral">&#39;getRawCharWidth&#39;</span>));</div>
<div class="line"><a name="l06336"></a><span class="lineno"> 6336</span>&#160;        $maxchwidth = max($chrw);</div>
<div class="line"><a name="l06337"></a><span class="lineno"> 6337</span>&#160;        <span class="comment">// get array of chars</span></div>
<div class="line"><a name="l06338"></a><span class="lineno"> 6338</span>&#160;        $uchars = TCPDF_FONTS::UTF8ArrayToUniArray($chars, $this-&gt;isunicode);</div>
<div class="line"><a name="l06339"></a><span class="lineno"> 6339</span>&#160;        <span class="comment">// get the number of characters</span></div>
<div class="line"><a name="l06340"></a><span class="lineno"> 6340</span>&#160;        $nb = count($chars);</div>
<div class="line"><a name="l06341"></a><span class="lineno"> 6341</span>&#160;        <span class="comment">// replacement for SHY character (minus symbol)</span></div>
<div class="line"><a name="l06342"></a><span class="lineno"> 6342</span>&#160;        $shy_replacement = 45;</div>
<div class="line"><a name="l06343"></a><span class="lineno"> 6343</span>&#160;        $shy_replacement_char = TCPDF_FONTS::unichr($shy_replacement, $this-&gt;isunicode);</div>
<div class="line"><a name="l06344"></a><span class="lineno"> 6344</span>&#160;        <span class="comment">// widht for SHY replacement</span></div>
<div class="line"><a name="l06345"></a><span class="lineno"> 6345</span>&#160;        $shy_replacement_width = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a281f922889bd1ae2dc96e421042ad8e4">GetCharWidth</a>($shy_replacement);</div>
<div class="line"><a name="l06346"></a><span class="lineno"> 6346</span>&#160;        <span class="comment">// page width</span></div>
<div class="line"><a name="l06347"></a><span class="lineno"> 6347</span>&#160;        $pw = <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = $this-&gt;w - $this-&gt;lMargin - <a class="code" href="../../d4/d40/classTCPDF.html#a44fb75b85bea40ced25fdea9d89dc8e9">$this-&gt;rMargin</a>;</div>
<div class="line"><a name="l06348"></a><span class="lineno"> 6348</span>&#160;        <span class="comment">// calculate remaining line width ($w)</span></div>
<div class="line"><a name="l06349"></a><span class="lineno"> 6349</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l06350"></a><span class="lineno"> 6350</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = $this-&gt;x - <a class="code" href="../../d4/d40/classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da">$this-&gt;lMargin</a>;</div>
<div class="line"><a name="l06351"></a><span class="lineno"> 6351</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06352"></a><span class="lineno"> 6352</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = $this-&gt;w - $this-&gt;rMargin - <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$this-&gt;x</a>;</div>
<div class="line"><a name="l06353"></a><span class="lineno"> 6353</span>&#160;        }</div>
<div class="line"><a name="l06354"></a><span class="lineno"> 6354</span>&#160;        <span class="comment">// max column width</span></div>
<div class="line"><a name="l06355"></a><span class="lineno"> 6355</span>&#160;        $wmax = (<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> - $wadj);</div>
<div class="line"><a name="l06356"></a><span class="lineno"> 6356</span>&#160;        <span class="keywordflow">if</span> (!$firstline) {</div>
<div class="line"><a name="l06357"></a><span class="lineno"> 6357</span>&#160;            $wmax -= ($this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>] + $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>]);</div>
<div class="line"><a name="l06358"></a><span class="lineno"> 6358</span>&#160;        }</div>
<div class="line"><a name="l06359"></a><span class="lineno"> 6359</span>&#160;        <span class="keywordflow">if</span> ((!$firstline) AND (($chrwidth &gt; $wmax) OR ($maxchwidth &gt; $wmax))) {</div>
<div class="line"><a name="l06360"></a><span class="lineno"> 6360</span>&#160;            <span class="comment">// the maximum width character do not fit on column</span></div>
<div class="line"><a name="l06361"></a><span class="lineno"> 6361</span>&#160;            <span class="keywordflow">return</span> <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l06362"></a><span class="lineno"> 6362</span>&#160;        }</div>
<div class="line"><a name="l06363"></a><span class="lineno"> 6363</span>&#160;        <span class="comment">// minimum row height</span></div>
<div class="line"><a name="l06364"></a><span class="lineno"> 6364</span>&#160;        $row_height = max(<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a25c7f71b3fcb19024497ea620f885346">getCellHeight</a>($this-&gt;FontSize));</div>
<div class="line"><a name="l06365"></a><span class="lineno"> 6365</span>&#160;        <span class="comment">// max Y</span></div>
<div class="line"><a name="l06366"></a><span class="lineno"> 6366</span>&#160;        $maxy = $this-&gt;y + $maxh - max($row_height, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>);</div>
<div class="line"><a name="l06367"></a><span class="lineno"> 6367</span>&#160;        $start_page = <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>;</div>
<div class="line"><a name="l06368"></a><span class="lineno"> 6368</span>&#160;        $i = 0; <span class="comment">// character position</span></div>
<div class="line"><a name="l06369"></a><span class="lineno"> 6369</span>&#160;        $j = 0; <span class="comment">// current starting position</span></div>
<div class="line"><a name="l06370"></a><span class="lineno"> 6370</span>&#160;        $sep = -1; <span class="comment">// position of the last blank space</span></div>
<div class="line"><a name="l06371"></a><span class="lineno"> 6371</span>&#160;        $prevsep = $sep; <span class="comment">// previous separator</span></div>
<div class="line"><a name="l06372"></a><span class="lineno"> 6372</span>&#160;        $shy = <span class="keyword">false</span>; <span class="comment">// true if the last blank is a soft hypen (SHY)</span></div>
<div class="line"><a name="l06373"></a><span class="lineno"> 6373</span>&#160;        $prevshy = $shy; <span class="comment">// previous shy mode</span></div>
<div class="line"><a name="l06374"></a><span class="lineno"> 6374</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f">$l</a> = 0; <span class="comment">// current string length</span></div>
<div class="line"><a name="l06375"></a><span class="lineno"> 6375</span>&#160;        $nl = 0; <span class="comment">//number of lines</span></div>
<div class="line"><a name="l06376"></a><span class="lineno"> 6376</span>&#160;        $linebreak = <span class="keyword">false</span>;</div>
<div class="line"><a name="l06377"></a><span class="lineno"> 6377</span>&#160;        $pc = 0; <span class="comment">// previous character</span></div>
<div class="line"><a name="l06378"></a><span class="lineno"> 6378</span>&#160;        <span class="comment">// for each character</span></div>
<div class="line"><a name="l06379"></a><span class="lineno"> 6379</span>&#160;        <span class="keywordflow">while</span> ($i &lt; $nb) {</div>
<div class="line"><a name="l06380"></a><span class="lineno"> 6380</span>&#160;            <span class="keywordflow">if</span> (($maxh &gt; 0) AND ($this-&gt;y &gt; $maxy) ) {</div>
<div class="line"><a name="l06381"></a><span class="lineno"> 6381</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06382"></a><span class="lineno"> 6382</span>&#160;            }</div>
<div class="line"><a name="l06383"></a><span class="lineno"> 6383</span>&#160;            <span class="comment">//Get the current character</span></div>
<div class="line"><a name="l06384"></a><span class="lineno"> 6384</span>&#160;            $c = $chars[$i];</div>
<div class="line"><a name="l06385"></a><span class="lineno"> 6385</span>&#160;            <span class="keywordflow">if</span> ($c == 10) { <span class="comment">// 10 = &quot;\n&quot; = new line</span></div>
<div class="line"><a name="l06386"></a><span class="lineno"> 6386</span>&#160;                <span class="comment">//Explicit line break</span></div>
<div class="line"><a name="l06387"></a><span class="lineno"> 6387</span>&#160;                <span class="keywordflow">if</span> ($align == <span class="charliteral">&#39;J&#39;</span>) {</div>
<div class="line"><a name="l06388"></a><span class="lineno"> 6388</span>&#160;                    <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l06389"></a><span class="lineno"> 6389</span>&#160;                        $talign = <span class="charliteral">&#39;R&#39;</span>;</div>
<div class="line"><a name="l06390"></a><span class="lineno"> 6390</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06391"></a><span class="lineno"> 6391</span>&#160;                        $talign = <span class="charliteral">&#39;L&#39;</span>;</div>
<div class="line"><a name="l06392"></a><span class="lineno"> 6392</span>&#160;                    }</div>
<div class="line"><a name="l06393"></a><span class="lineno"> 6393</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06394"></a><span class="lineno"> 6394</span>&#160;                    $talign = $align;</div>
<div class="line"><a name="l06395"></a><span class="lineno"> 6395</span>&#160;                }</div>
<div class="line"><a name="l06396"></a><span class="lineno"> 6396</span>&#160;                $tmpstr = TCPDF_FONTS::UniArrSubString($uchars, $j, $i);</div>
<div class="line"><a name="l06397"></a><span class="lineno"> 6397</span>&#160;                <span class="keywordflow">if</span> ($firstline) {</div>
<div class="line"><a name="l06398"></a><span class="lineno"> 6398</span>&#160;                    $startx = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$this-&gt;x</a>;</div>
<div class="line"><a name="l06399"></a><span class="lineno"> 6399</span>&#160;                    $tmparr = array_slice($chars, $j, ($i - $j));</div>
<div class="line"><a name="l06400"></a><span class="lineno"> 6400</span>&#160;                    <span class="keywordflow">if</span> ($rtlmode) {</div>
<div class="line"><a name="l06401"></a><span class="lineno"> 6401</span>&#160;                        $tmparr = TCPDF_FONTS::utf8Bidi($tmparr, $tmpstr, $this-&gt;tmprtl, $this-&gt;isunicode, $this-&gt;CurrentFont);</div>
<div class="line"><a name="l06402"></a><span class="lineno"> 6402</span>&#160;                    }</div>
<div class="line"><a name="l06403"></a><span class="lineno"> 6403</span>&#160;                    $linew = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#afe09291dfba7203e225a507e71e1d43e">GetArrStringWidth</a>($tmparr);</div>
<div class="line"><a name="l06404"></a><span class="lineno"> 6404</span>&#160;                    unset($tmparr);</div>
<div class="line"><a name="l06405"></a><span class="lineno"> 6405</span>&#160;                    <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l06406"></a><span class="lineno"> 6406</span>&#160;                        $this-&gt;endlinex = $startx - $linew;</div>
<div class="line"><a name="l06407"></a><span class="lineno"> 6407</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06408"></a><span class="lineno"> 6408</span>&#160;                        $this-&gt;endlinex = $startx + $linew;</div>
<div class="line"><a name="l06409"></a><span class="lineno"> 6409</span>&#160;                    }</div>
<div class="line"><a name="l06410"></a><span class="lineno"> 6410</span>&#160;                    <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = $linew;</div>
<div class="line"><a name="l06411"></a><span class="lineno"> 6411</span>&#160;                    $tmpcellpadding = <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$this-&gt;cell_padding</a>;</div>
<div class="line"><a name="l06412"></a><span class="lineno"> 6412</span>&#160;                    <span class="keywordflow">if</span> ($maxh == 0) {</div>
<div class="line"><a name="l06413"></a><span class="lineno"> 6413</span>&#160;                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a374b24751bf76e4ca5ba7694f87ec2c1">SetCellPadding</a>(0);</div>
<div class="line"><a name="l06414"></a><span class="lineno"> 6414</span>&#160;                    }</div>
<div class="line"><a name="l06415"></a><span class="lineno"> 6415</span>&#160;                }</div>
<div class="line"><a name="l06416"></a><span class="lineno"> 6416</span>&#160;                <span class="keywordflow">if</span> ($firstblock AND $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#accba6f1471acb211de74e6b34107041d">isRTLTextDir</a>()) {</div>
<div class="line"><a name="l06417"></a><span class="lineno"> 6417</span>&#160;                    $tmpstr = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa198175b5bdc3ed8663efa6b5286a74a">stringRightTrim</a>($tmpstr);</div>
<div class="line"><a name="l06418"></a><span class="lineno"> 6418</span>&#160;                }</div>
<div class="line"><a name="l06419"></a><span class="lineno"> 6419</span>&#160;                <span class="comment">// Skip newlines at the begining of a page or column</span></div>
<div class="line"><a name="l06420"></a><span class="lineno"> 6420</span>&#160;                <span class="keywordflow">if</span> (!empty($tmpstr) OR ($this-&gt;y &lt; ($this-&gt;PageBreakTrigger - $row_height))) {</div>
<div class="line"><a name="l06421"></a><span class="lineno"> 6421</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a33b265e5eb3e4d1d4fedfe29f8166f31">Cell</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $tmpstr, 0, 1, $talign, $fill, $link, $stretch);</div>
<div class="line"><a name="l06422"></a><span class="lineno"> 6422</span>&#160;                }</div>
<div class="line"><a name="l06423"></a><span class="lineno"> 6423</span>&#160;                unset($tmpstr);</div>
<div class="line"><a name="l06424"></a><span class="lineno"> 6424</span>&#160;                <span class="keywordflow">if</span> ($firstline) {</div>
<div class="line"><a name="l06425"></a><span class="lineno"> 6425</span>&#160;                    $this-&gt;cell_padding = $tmpcellpadding;</div>
<div class="line"><a name="l06426"></a><span class="lineno"> 6426</span>&#160;                    <span class="keywordflow">return</span> (TCPDF_FONTS::UniArrSubString($uchars, $i));</div>
<div class="line"><a name="l06427"></a><span class="lineno"> 6427</span>&#160;                }</div>
<div class="line"><a name="l06428"></a><span class="lineno"> 6428</span>&#160;                ++$nl;</div>
<div class="line"><a name="l06429"></a><span class="lineno"> 6429</span>&#160;                $j = $i + 1;</div>
<div class="line"><a name="l06430"></a><span class="lineno"> 6430</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f">$l</a> = 0;</div>
<div class="line"><a name="l06431"></a><span class="lineno"> 6431</span>&#160;                $sep = -1;</div>
<div class="line"><a name="l06432"></a><span class="lineno"> 6432</span>&#160;                $prevsep = $sep;</div>
<div class="line"><a name="l06433"></a><span class="lineno"> 6433</span>&#160;                $shy = <span class="keyword">false</span>;</div>
<div class="line"><a name="l06434"></a><span class="lineno"> 6434</span>&#160;                <span class="comment">// account for margin changes</span></div>
<div class="line"><a name="l06435"></a><span class="lineno"> 6435</span>&#160;                <span class="keywordflow">if</span> ((($this-&gt;y + $this-&gt;lasth) &gt; $this-&gt;PageBreakTrigger) AND ($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a13f370f8e1553105eaa3553f52c3fc6c">inPageBody</a>())) {</div>
<div class="line"><a name="l06436"></a><span class="lineno"> 6436</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa24046de2993933f62d60a2936a22970">AcceptPageBreak</a>();</div>
<div class="line"><a name="l06437"></a><span class="lineno"> 6437</span>&#160;                    <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l06438"></a><span class="lineno"> 6438</span>&#160;                        $this-&gt;x -= $margin[<span class="charliteral">&#39;R&#39;</span>];</div>
<div class="line"><a name="l06439"></a><span class="lineno"> 6439</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06440"></a><span class="lineno"> 6440</span>&#160;                        $this-&gt;x += $margin[<span class="charliteral">&#39;L&#39;</span>];</div>
<div class="line"><a name="l06441"></a><span class="lineno"> 6441</span>&#160;                    }</div>
<div class="line"><a name="l06442"></a><span class="lineno"> 6442</span>&#160;                    $this-&gt;lMargin += $margin[<span class="charliteral">&#39;L&#39;</span>];</div>
<div class="line"><a name="l06443"></a><span class="lineno"> 6443</span>&#160;                    $this-&gt;rMargin += $margin[<span class="charliteral">&#39;R&#39;</span>];</div>
<div class="line"><a name="l06444"></a><span class="lineno"> 6444</span>&#160;                }</div>
<div class="line"><a name="l06445"></a><span class="lineno"> 6445</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a56507b79d0b3c74332aaacc32dab873a">getRemainingWidth</a>();</div>
<div class="line"><a name="l06446"></a><span class="lineno"> 6446</span>&#160;                $wmax = (<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> - $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>] - $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>]);</div>
<div class="line"><a name="l06447"></a><span class="lineno"> 6447</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06448"></a><span class="lineno"> 6448</span>&#160;                <span class="comment">// 160 is the non-breaking space.</span></div>
<div class="line"><a name="l06449"></a><span class="lineno"> 6449</span>&#160;                <span class="comment">// 173 is SHY (Soft Hypen).</span></div>
<div class="line"><a name="l06450"></a><span class="lineno"> 6450</span>&#160;                <span class="comment">// \p{Z} or \p{Separator}: any kind of Unicode whitespace or invisible separator.</span></div>
<div class="line"><a name="l06451"></a><span class="lineno"> 6451</span>&#160;                <span class="comment">// \p{Lo} or \p{Other_Letter}: a Unicode letter or ideograph that does not have lowercase and uppercase variants.</span></div>
<div class="line"><a name="l06452"></a><span class="lineno"> 6452</span>&#160;                <span class="comment">// \p{Lo} is needed because Chinese characters are packed next to each other without spaces in between.</span></div>
<div class="line"><a name="l06453"></a><span class="lineno"> 6453</span>&#160;                <span class="keywordflow">if</span> (($c != 160)</div>
<div class="line"><a name="l06454"></a><span class="lineno"> 6454</span>&#160;                    AND (($c == 173)</div>
<div class="line"><a name="l06455"></a><span class="lineno"> 6455</span>&#160;                        OR preg_match($this-&gt;re_spaces, TCPDF_FONTS::unichr($c, $this-&gt;isunicode))</div>
<div class="line"><a name="l06456"></a><span class="lineno"> 6456</span>&#160;                        OR (($c == 45)</div>
<div class="line"><a name="l06457"></a><span class="lineno"> 6457</span>&#160;                            AND ($i &lt; ($nb - 1))</div>
<div class="line"><a name="l06458"></a><span class="lineno"> 6458</span>&#160;                            AND @preg_match(<span class="stringliteral">&#39;/[\p{L}]/&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;m&#39;</span>], TCPDF_FONTS::unichr($pc, $this-&gt;isunicode))</div>
<div class="line"><a name="l06459"></a><span class="lineno"> 6459</span>&#160;                            AND @preg_match(<span class="stringliteral">&#39;/[\p{L}]/&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;m&#39;</span>], TCPDF_FONTS::unichr($chars[($i + 1)], $this-&gt;isunicode))</div>
<div class="line"><a name="l06460"></a><span class="lineno"> 6460</span>&#160;                        )</div>
<div class="line"><a name="l06461"></a><span class="lineno"> 6461</span>&#160;                    )</div>
<div class="line"><a name="l06462"></a><span class="lineno"> 6462</span>&#160;                ) {</div>
<div class="line"><a name="l06463"></a><span class="lineno"> 6463</span>&#160;                    <span class="comment">// update last blank space position</span></div>
<div class="line"><a name="l06464"></a><span class="lineno"> 6464</span>&#160;                    $prevsep = $sep;</div>
<div class="line"><a name="l06465"></a><span class="lineno"> 6465</span>&#160;                    $sep = $i;</div>
<div class="line"><a name="l06466"></a><span class="lineno"> 6466</span>&#160;                    <span class="comment">// check if is a SHY</span></div>
<div class="line"><a name="l06467"></a><span class="lineno"> 6467</span>&#160;                    <span class="keywordflow">if</span> (($c == 173) OR ($c == 45)) {</div>
<div class="line"><a name="l06468"></a><span class="lineno"> 6468</span>&#160;                        $prevshy = $shy;</div>
<div class="line"><a name="l06469"></a><span class="lineno"> 6469</span>&#160;                        $shy = <span class="keyword">true</span>;</div>
<div class="line"><a name="l06470"></a><span class="lineno"> 6470</span>&#160;                        <span class="keywordflow">if</span> ($pc == 45) {</div>
<div class="line"><a name="l06471"></a><span class="lineno"> 6471</span>&#160;                            $tmp_shy_replacement_width = 0;</div>
<div class="line"><a name="l06472"></a><span class="lineno"> 6472</span>&#160;                            $tmp_shy_replacement_char = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l06473"></a><span class="lineno"> 6473</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06474"></a><span class="lineno"> 6474</span>&#160;                            $tmp_shy_replacement_width = $shy_replacement_width;</div>
<div class="line"><a name="l06475"></a><span class="lineno"> 6475</span>&#160;                            $tmp_shy_replacement_char = $shy_replacement_char;</div>
<div class="line"><a name="l06476"></a><span class="lineno"> 6476</span>&#160;                        }</div>
<div class="line"><a name="l06477"></a><span class="lineno"> 6477</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06478"></a><span class="lineno"> 6478</span>&#160;                        $shy = <span class="keyword">false</span>;</div>
<div class="line"><a name="l06479"></a><span class="lineno"> 6479</span>&#160;                    }</div>
<div class="line"><a name="l06480"></a><span class="lineno"> 6480</span>&#160;                }</div>
<div class="line"><a name="l06481"></a><span class="lineno"> 6481</span>&#160;                <span class="comment">// update string length</span></div>
<div class="line"><a name="l06482"></a><span class="lineno"> 6482</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a81c8257af5d6d6e40f1bb77d6b507b97">isUnicodeFont</a>() AND ($arabic)) {</div>
<div class="line"><a name="l06483"></a><span class="lineno"> 6483</span>&#160;                    <span class="comment">// with bidirectional algorithm some chars may be changed affecting the line length</span></div>
<div class="line"><a name="l06484"></a><span class="lineno"> 6484</span>&#160;                    <span class="comment">// *** very slow ***</span></div>
<div class="line"><a name="l06485"></a><span class="lineno"> 6485</span>&#160;                    <a class="code" href="../../d4/d40/classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f">$l</a> = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#afe09291dfba7203e225a507e71e1d43e">GetArrStringWidth</a>(TCPDF_FONTS::utf8Bidi(array_slice($chars, $j, ($i - $j)), <span class="stringliteral">&#39;&#39;</span>, $this-&gt;tmprtl, $this-&gt;isunicode, $this-&gt;CurrentFont));</div>
<div class="line"><a name="l06486"></a><span class="lineno"> 6486</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06487"></a><span class="lineno"> 6487</span>&#160;                    <a class="code" href="../../d4/d40/classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f">$l</a> += $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a281f922889bd1ae2dc96e421042ad8e4">GetCharWidth</a>($c);</div>
<div class="line"><a name="l06488"></a><span class="lineno"> 6488</span>&#160;                }</div>
<div class="line"><a name="l06489"></a><span class="lineno"> 6489</span>&#160;                <span class="keywordflow">if</span> ((<a class="code" href="../../d4/d40/classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f">$l</a> &gt; $wmax) OR (($c == 173) AND ((<a class="code" href="../../d4/d40/classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f">$l</a> + $tmp_shy_replacement_width) &gt;= $wmax))) {</div>
<div class="line"><a name="l06490"></a><span class="lineno"> 6490</span>&#160;                    <span class="keywordflow">if</span> (($c == 173) AND ((<a class="code" href="../../d4/d40/classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f">$l</a> + $tmp_shy_replacement_width) &gt; $wmax)) {</div>
<div class="line"><a name="l06491"></a><span class="lineno"> 6491</span>&#160;                        $sep = $prevsep;</div>
<div class="line"><a name="l06492"></a><span class="lineno"> 6492</span>&#160;                        $shy = $prevshy;</div>
<div class="line"><a name="l06493"></a><span class="lineno"> 6493</span>&#160;                    }</div>
<div class="line"><a name="l06494"></a><span class="lineno"> 6494</span>&#160;                    <span class="comment">// we have reached the end of column</span></div>
<div class="line"><a name="l06495"></a><span class="lineno"> 6495</span>&#160;                    <span class="keywordflow">if</span> ($sep == -1) {</div>
<div class="line"><a name="l06496"></a><span class="lineno"> 6496</span>&#160;                        <span class="comment">// check if the line was already started</span></div>
<div class="line"><a name="l06497"></a><span class="lineno"> 6497</span>&#160;                        <span class="keywordflow">if</span> (($this-&gt;rtl AND ($this-&gt;x &lt;= ($this-&gt;w - $this-&gt;rMargin - $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>] - $margin[<span class="charliteral">&#39;R&#39;</span>] - $chrwidth)))</div>
<div class="line"><a name="l06498"></a><span class="lineno"> 6498</span>&#160;                            OR ((!$this-&gt;rtl) AND ($this-&gt;x &gt;= ($this-&gt;lMargin + $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>] + $margin[<span class="charliteral">&#39;L&#39;</span>] + $chrwidth)))) {</div>
<div class="line"><a name="l06499"></a><span class="lineno"> 6499</span>&#160;                            <span class="comment">// print a void cell and go to next line</span></div>
<div class="line"><a name="l06500"></a><span class="lineno"> 6500</span>&#160;                            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a33b265e5eb3e4d1d4fedfe29f8166f31">Cell</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, <span class="stringliteral">&#39;&#39;</span>, 0, 1);</div>
<div class="line"><a name="l06501"></a><span class="lineno"> 6501</span>&#160;                            $linebreak = <span class="keyword">true</span>;</div>
<div class="line"><a name="l06502"></a><span class="lineno"> 6502</span>&#160;                            <span class="keywordflow">if</span> ($firstline) {</div>
<div class="line"><a name="l06503"></a><span class="lineno"> 6503</span>&#160;                                <span class="keywordflow">return</span> (TCPDF_FONTS::UniArrSubString($uchars, $j));</div>
<div class="line"><a name="l06504"></a><span class="lineno"> 6504</span>&#160;                            }</div>
<div class="line"><a name="l06505"></a><span class="lineno"> 6505</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06506"></a><span class="lineno"> 6506</span>&#160;                            <span class="comment">// truncate the word because do not fit on column</span></div>
<div class="line"><a name="l06507"></a><span class="lineno"> 6507</span>&#160;                            $tmpstr = TCPDF_FONTS::UniArrSubString($uchars, $j, $i);</div>
<div class="line"><a name="l06508"></a><span class="lineno"> 6508</span>&#160;                            <span class="keywordflow">if</span> ($firstline) {</div>
<div class="line"><a name="l06509"></a><span class="lineno"> 6509</span>&#160;                                $startx = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$this-&gt;x</a>;</div>
<div class="line"><a name="l06510"></a><span class="lineno"> 6510</span>&#160;                                $tmparr = array_slice($chars, $j, ($i - $j));</div>
<div class="line"><a name="l06511"></a><span class="lineno"> 6511</span>&#160;                                <span class="keywordflow">if</span> ($rtlmode) {</div>
<div class="line"><a name="l06512"></a><span class="lineno"> 6512</span>&#160;                                    $tmparr = TCPDF_FONTS::utf8Bidi($tmparr, $tmpstr, $this-&gt;tmprtl, $this-&gt;isunicode, $this-&gt;CurrentFont);</div>
<div class="line"><a name="l06513"></a><span class="lineno"> 6513</span>&#160;                                }</div>
<div class="line"><a name="l06514"></a><span class="lineno"> 6514</span>&#160;                                $linew = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#afe09291dfba7203e225a507e71e1d43e">GetArrStringWidth</a>($tmparr);</div>
<div class="line"><a name="l06515"></a><span class="lineno"> 6515</span>&#160;                                unset($tmparr);</div>
<div class="line"><a name="l06516"></a><span class="lineno"> 6516</span>&#160;                                <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l06517"></a><span class="lineno"> 6517</span>&#160;                                    $this-&gt;endlinex = $startx - $linew;</div>
<div class="line"><a name="l06518"></a><span class="lineno"> 6518</span>&#160;                                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06519"></a><span class="lineno"> 6519</span>&#160;                                    $this-&gt;endlinex = $startx + $linew;</div>
<div class="line"><a name="l06520"></a><span class="lineno"> 6520</span>&#160;                                }</div>
<div class="line"><a name="l06521"></a><span class="lineno"> 6521</span>&#160;                                <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = $linew;</div>
<div class="line"><a name="l06522"></a><span class="lineno"> 6522</span>&#160;                                $tmpcellpadding = <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$this-&gt;cell_padding</a>;</div>
<div class="line"><a name="l06523"></a><span class="lineno"> 6523</span>&#160;                                <span class="keywordflow">if</span> ($maxh == 0) {</div>
<div class="line"><a name="l06524"></a><span class="lineno"> 6524</span>&#160;                                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a374b24751bf76e4ca5ba7694f87ec2c1">SetCellPadding</a>(0);</div>
<div class="line"><a name="l06525"></a><span class="lineno"> 6525</span>&#160;                                }</div>
<div class="line"><a name="l06526"></a><span class="lineno"> 6526</span>&#160;                            }</div>
<div class="line"><a name="l06527"></a><span class="lineno"> 6527</span>&#160;                            <span class="keywordflow">if</span> ($firstblock AND $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#accba6f1471acb211de74e6b34107041d">isRTLTextDir</a>()) {</div>
<div class="line"><a name="l06528"></a><span class="lineno"> 6528</span>&#160;                                $tmpstr = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa198175b5bdc3ed8663efa6b5286a74a">stringRightTrim</a>($tmpstr);</div>
<div class="line"><a name="l06529"></a><span class="lineno"> 6529</span>&#160;                            }</div>
<div class="line"><a name="l06530"></a><span class="lineno"> 6530</span>&#160;                            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a33b265e5eb3e4d1d4fedfe29f8166f31">Cell</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $tmpstr, 0, 1, $align, $fill, $link, $stretch);</div>
<div class="line"><a name="l06531"></a><span class="lineno"> 6531</span>&#160;                            unset($tmpstr);</div>
<div class="line"><a name="l06532"></a><span class="lineno"> 6532</span>&#160;                            <span class="keywordflow">if</span> ($firstline) {</div>
<div class="line"><a name="l06533"></a><span class="lineno"> 6533</span>&#160;                                $this-&gt;cell_padding = $tmpcellpadding;</div>
<div class="line"><a name="l06534"></a><span class="lineno"> 6534</span>&#160;                                <span class="keywordflow">return</span> (TCPDF_FONTS::UniArrSubString($uchars, $i));</div>
<div class="line"><a name="l06535"></a><span class="lineno"> 6535</span>&#160;                            }</div>
<div class="line"><a name="l06536"></a><span class="lineno"> 6536</span>&#160;                            $j = $i;</div>
<div class="line"><a name="l06537"></a><span class="lineno"> 6537</span>&#160;                            --$i;</div>
<div class="line"><a name="l06538"></a><span class="lineno"> 6538</span>&#160;                        }</div>
<div class="line"><a name="l06539"></a><span class="lineno"> 6539</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06540"></a><span class="lineno"> 6540</span>&#160;                        <span class="comment">// word wrapping</span></div>
<div class="line"><a name="l06541"></a><span class="lineno"> 6541</span>&#160;                        <span class="keywordflow">if</span> ($this-&gt;rtl AND (!$firstblock) AND ($sep &lt; $i)) {</div>
<div class="line"><a name="l06542"></a><span class="lineno"> 6542</span>&#160;                            $endspace = 1;</div>
<div class="line"><a name="l06543"></a><span class="lineno"> 6543</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06544"></a><span class="lineno"> 6544</span>&#160;                            $endspace = 0;</div>
<div class="line"><a name="l06545"></a><span class="lineno"> 6545</span>&#160;                        }</div>
<div class="line"><a name="l06546"></a><span class="lineno"> 6546</span>&#160;                        <span class="comment">// check the length of the next string</span></div>
<div class="line"><a name="l06547"></a><span class="lineno"> 6547</span>&#160;                        $strrest = TCPDF_FONTS::UniArrSubString($uchars, ($sep + $endspace));</div>
<div class="line"><a name="l06548"></a><span class="lineno"> 6548</span>&#160;                        $nextstr = TCPDF_STATIC::pregSplit(<span class="charliteral">&#39;/&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;p&#39;</span>].<span class="charliteral">&#39;/&#39;</span>, $this-&gt;re_space[<span class="charliteral">&#39;m&#39;</span>], $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#abdc6aa462bc81023df2ec043742bcb4b">stringTrim</a>($strrest));</div>
<div class="line"><a name="l06549"></a><span class="lineno"> 6549</span>&#160;                        <span class="keywordflow">if</span> (isset($nextstr[0]) AND ($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8075c1f04b6fbddc957cff786c4b16d9">GetStringWidth</a>($nextstr[0]) &gt; $pw)) {</div>
<div class="line"><a name="l06550"></a><span class="lineno"> 6550</span>&#160;                            <span class="comment">// truncate the word because do not fit on a full page width</span></div>
<div class="line"><a name="l06551"></a><span class="lineno"> 6551</span>&#160;                            $tmpstr = TCPDF_FONTS::UniArrSubString($uchars, $j, $i);</div>
<div class="line"><a name="l06552"></a><span class="lineno"> 6552</span>&#160;                            <span class="keywordflow">if</span> ($firstline) {</div>
<div class="line"><a name="l06553"></a><span class="lineno"> 6553</span>&#160;                                $startx = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$this-&gt;x</a>;</div>
<div class="line"><a name="l06554"></a><span class="lineno"> 6554</span>&#160;                                $tmparr = array_slice($chars, $j, ($i - $j));</div>
<div class="line"><a name="l06555"></a><span class="lineno"> 6555</span>&#160;                                <span class="keywordflow">if</span> ($rtlmode) {</div>
<div class="line"><a name="l06556"></a><span class="lineno"> 6556</span>&#160;                                    $tmparr = TCPDF_FONTS::utf8Bidi($tmparr, $tmpstr, $this-&gt;tmprtl, $this-&gt;isunicode, $this-&gt;CurrentFont);</div>
<div class="line"><a name="l06557"></a><span class="lineno"> 6557</span>&#160;                                }</div>
<div class="line"><a name="l06558"></a><span class="lineno"> 6558</span>&#160;                                $linew = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#afe09291dfba7203e225a507e71e1d43e">GetArrStringWidth</a>($tmparr);</div>
<div class="line"><a name="l06559"></a><span class="lineno"> 6559</span>&#160;                                unset($tmparr);</div>
<div class="line"><a name="l06560"></a><span class="lineno"> 6560</span>&#160;                                <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l06561"></a><span class="lineno"> 6561</span>&#160;                                    $this-&gt;endlinex = ($startx - $linew);</div>
<div class="line"><a name="l06562"></a><span class="lineno"> 6562</span>&#160;                                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06563"></a><span class="lineno"> 6563</span>&#160;                                    $this-&gt;endlinex = ($startx + $linew);</div>
<div class="line"><a name="l06564"></a><span class="lineno"> 6564</span>&#160;                                }</div>
<div class="line"><a name="l06565"></a><span class="lineno"> 6565</span>&#160;                                <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = $linew;</div>
<div class="line"><a name="l06566"></a><span class="lineno"> 6566</span>&#160;                                $tmpcellpadding = <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$this-&gt;cell_padding</a>;</div>
<div class="line"><a name="l06567"></a><span class="lineno"> 6567</span>&#160;                                <span class="keywordflow">if</span> ($maxh == 0) {</div>
<div class="line"><a name="l06568"></a><span class="lineno"> 6568</span>&#160;                                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a374b24751bf76e4ca5ba7694f87ec2c1">SetCellPadding</a>(0);</div>
<div class="line"><a name="l06569"></a><span class="lineno"> 6569</span>&#160;                                }</div>
<div class="line"><a name="l06570"></a><span class="lineno"> 6570</span>&#160;                            }</div>
<div class="line"><a name="l06571"></a><span class="lineno"> 6571</span>&#160;                            <span class="keywordflow">if</span> ($firstblock AND $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#accba6f1471acb211de74e6b34107041d">isRTLTextDir</a>()) {</div>
<div class="line"><a name="l06572"></a><span class="lineno"> 6572</span>&#160;                                $tmpstr = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa198175b5bdc3ed8663efa6b5286a74a">stringRightTrim</a>($tmpstr);</div>
<div class="line"><a name="l06573"></a><span class="lineno"> 6573</span>&#160;                            }</div>
<div class="line"><a name="l06574"></a><span class="lineno"> 6574</span>&#160;                            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a33b265e5eb3e4d1d4fedfe29f8166f31">Cell</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $tmpstr, 0, 1, $align, $fill, $link, $stretch);</div>
<div class="line"><a name="l06575"></a><span class="lineno"> 6575</span>&#160;                            unset($tmpstr);</div>
<div class="line"><a name="l06576"></a><span class="lineno"> 6576</span>&#160;                            <span class="keywordflow">if</span> ($firstline) {</div>
<div class="line"><a name="l06577"></a><span class="lineno"> 6577</span>&#160;                                $this-&gt;cell_padding = $tmpcellpadding;</div>
<div class="line"><a name="l06578"></a><span class="lineno"> 6578</span>&#160;                                <span class="keywordflow">return</span> (TCPDF_FONTS::UniArrSubString($uchars, $i));</div>
<div class="line"><a name="l06579"></a><span class="lineno"> 6579</span>&#160;                            }</div>
<div class="line"><a name="l06580"></a><span class="lineno"> 6580</span>&#160;                            $j = $i;</div>
<div class="line"><a name="l06581"></a><span class="lineno"> 6581</span>&#160;                            --$i;</div>
<div class="line"><a name="l06582"></a><span class="lineno"> 6582</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06583"></a><span class="lineno"> 6583</span>&#160;                            <span class="comment">// word wrapping</span></div>
<div class="line"><a name="l06584"></a><span class="lineno"> 6584</span>&#160;                            <span class="keywordflow">if</span> ($shy) {</div>
<div class="line"><a name="l06585"></a><span class="lineno"> 6585</span>&#160;                                <span class="comment">// add hypen (minus symbol) at the end of the line</span></div>
<div class="line"><a name="l06586"></a><span class="lineno"> 6586</span>&#160;                                $shy_width = $tmp_shy_replacement_width;</div>
<div class="line"><a name="l06587"></a><span class="lineno"> 6587</span>&#160;                                <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l06588"></a><span class="lineno"> 6588</span>&#160;                                    $shy_char_left = $tmp_shy_replacement_char;</div>
<div class="line"><a name="l06589"></a><span class="lineno"> 6589</span>&#160;                                    $shy_char_right = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l06590"></a><span class="lineno"> 6590</span>&#160;                                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06591"></a><span class="lineno"> 6591</span>&#160;                                    $shy_char_left = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l06592"></a><span class="lineno"> 6592</span>&#160;                                    $shy_char_right = $tmp_shy_replacement_char;</div>
<div class="line"><a name="l06593"></a><span class="lineno"> 6593</span>&#160;                                }</div>
<div class="line"><a name="l06594"></a><span class="lineno"> 6594</span>&#160;                            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06595"></a><span class="lineno"> 6595</span>&#160;                                $shy_width = 0;</div>
<div class="line"><a name="l06596"></a><span class="lineno"> 6596</span>&#160;                                $shy_char_left = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l06597"></a><span class="lineno"> 6597</span>&#160;                                $shy_char_right = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l06598"></a><span class="lineno"> 6598</span>&#160;                            }</div>
<div class="line"><a name="l06599"></a><span class="lineno"> 6599</span>&#160;                            $tmpstr = TCPDF_FONTS::UniArrSubString($uchars, $j, ($sep + $endspace));</div>
<div class="line"><a name="l06600"></a><span class="lineno"> 6600</span>&#160;                            <span class="keywordflow">if</span> ($firstline) {</div>
<div class="line"><a name="l06601"></a><span class="lineno"> 6601</span>&#160;                                $startx = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$this-&gt;x</a>;</div>
<div class="line"><a name="l06602"></a><span class="lineno"> 6602</span>&#160;                                $tmparr = array_slice($chars, $j, (($sep + $endspace) - $j));</div>
<div class="line"><a name="l06603"></a><span class="lineno"> 6603</span>&#160;                                <span class="keywordflow">if</span> ($rtlmode) {</div>
<div class="line"><a name="l06604"></a><span class="lineno"> 6604</span>&#160;                                    $tmparr = TCPDF_FONTS::utf8Bidi($tmparr, $tmpstr, $this-&gt;tmprtl, $this-&gt;isunicode, $this-&gt;CurrentFont);</div>
<div class="line"><a name="l06605"></a><span class="lineno"> 6605</span>&#160;                                }</div>
<div class="line"><a name="l06606"></a><span class="lineno"> 6606</span>&#160;                                $linew = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#afe09291dfba7203e225a507e71e1d43e">GetArrStringWidth</a>($tmparr);</div>
<div class="line"><a name="l06607"></a><span class="lineno"> 6607</span>&#160;                                unset($tmparr);</div>
<div class="line"><a name="l06608"></a><span class="lineno"> 6608</span>&#160;                                <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l06609"></a><span class="lineno"> 6609</span>&#160;                                    $this-&gt;endlinex = $startx - $linew - $shy_width;</div>
<div class="line"><a name="l06610"></a><span class="lineno"> 6610</span>&#160;                                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06611"></a><span class="lineno"> 6611</span>&#160;                                    $this-&gt;endlinex = $startx + $linew + $shy_width;</div>
<div class="line"><a name="l06612"></a><span class="lineno"> 6612</span>&#160;                                }</div>
<div class="line"><a name="l06613"></a><span class="lineno"> 6613</span>&#160;                                <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = $linew;</div>
<div class="line"><a name="l06614"></a><span class="lineno"> 6614</span>&#160;                                $tmpcellpadding = <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$this-&gt;cell_padding</a>;</div>
<div class="line"><a name="l06615"></a><span class="lineno"> 6615</span>&#160;                                <span class="keywordflow">if</span> ($maxh == 0) {</div>
<div class="line"><a name="l06616"></a><span class="lineno"> 6616</span>&#160;                                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a374b24751bf76e4ca5ba7694f87ec2c1">SetCellPadding</a>(0);</div>
<div class="line"><a name="l06617"></a><span class="lineno"> 6617</span>&#160;                                }</div>
<div class="line"><a name="l06618"></a><span class="lineno"> 6618</span>&#160;                            }</div>
<div class="line"><a name="l06619"></a><span class="lineno"> 6619</span>&#160;                            <span class="comment">// print the line</span></div>
<div class="line"><a name="l06620"></a><span class="lineno"> 6620</span>&#160;                            <span class="keywordflow">if</span> ($firstblock AND $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#accba6f1471acb211de74e6b34107041d">isRTLTextDir</a>()) {</div>
<div class="line"><a name="l06621"></a><span class="lineno"> 6621</span>&#160;                                $tmpstr = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa198175b5bdc3ed8663efa6b5286a74a">stringRightTrim</a>($tmpstr);</div>
<div class="line"><a name="l06622"></a><span class="lineno"> 6622</span>&#160;                            }</div>
<div class="line"><a name="l06623"></a><span class="lineno"> 6623</span>&#160;                            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a33b265e5eb3e4d1d4fedfe29f8166f31">Cell</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $shy_char_left.$tmpstr.$shy_char_right, 0, 1, $align, $fill, $link, $stretch);</div>
<div class="line"><a name="l06624"></a><span class="lineno"> 6624</span>&#160;                            unset($tmpstr);</div>
<div class="line"><a name="l06625"></a><span class="lineno"> 6625</span>&#160;                            <span class="keywordflow">if</span> ($firstline) {</div>
<div class="line"><a name="l06626"></a><span class="lineno"> 6626</span>&#160;                                <span class="keywordflow">if</span> ($chars[$sep] == 45) {</div>
<div class="line"><a name="l06627"></a><span class="lineno"> 6627</span>&#160;                                    $endspace += 1;</div>
<div class="line"><a name="l06628"></a><span class="lineno"> 6628</span>&#160;                                }</div>
<div class="line"><a name="l06629"></a><span class="lineno"> 6629</span>&#160;                                <span class="comment">// return the remaining text</span></div>
<div class="line"><a name="l06630"></a><span class="lineno"> 6630</span>&#160;                                $this-&gt;cell_padding = $tmpcellpadding;</div>
<div class="line"><a name="l06631"></a><span class="lineno"> 6631</span>&#160;                                <span class="keywordflow">return</span> (TCPDF_FONTS::UniArrSubString($uchars, ($sep + $endspace)));</div>
<div class="line"><a name="l06632"></a><span class="lineno"> 6632</span>&#160;                            }</div>
<div class="line"><a name="l06633"></a><span class="lineno"> 6633</span>&#160;                            $i = $sep;</div>
<div class="line"><a name="l06634"></a><span class="lineno"> 6634</span>&#160;                            $sep = -1;</div>
<div class="line"><a name="l06635"></a><span class="lineno"> 6635</span>&#160;                            $shy = <span class="keyword">false</span>;</div>
<div class="line"><a name="l06636"></a><span class="lineno"> 6636</span>&#160;                            $j = ($i + 1);</div>
<div class="line"><a name="l06637"></a><span class="lineno"> 6637</span>&#160;                        }</div>
<div class="line"><a name="l06638"></a><span class="lineno"> 6638</span>&#160;                    }</div>
<div class="line"><a name="l06639"></a><span class="lineno"> 6639</span>&#160;                    <span class="comment">// account for margin changes</span></div>
<div class="line"><a name="l06640"></a><span class="lineno"> 6640</span>&#160;                    <span class="keywordflow">if</span> ((($this-&gt;y + $this-&gt;lasth) &gt; $this-&gt;PageBreakTrigger) AND ($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a13f370f8e1553105eaa3553f52c3fc6c">inPageBody</a>())) {</div>
<div class="line"><a name="l06641"></a><span class="lineno"> 6641</span>&#160;                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa24046de2993933f62d60a2936a22970">AcceptPageBreak</a>();</div>
<div class="line"><a name="l06642"></a><span class="lineno"> 6642</span>&#160;                        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l06643"></a><span class="lineno"> 6643</span>&#160;                            $this-&gt;x -= $margin[<span class="charliteral">&#39;R&#39;</span>];</div>
<div class="line"><a name="l06644"></a><span class="lineno"> 6644</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06645"></a><span class="lineno"> 6645</span>&#160;                            $this-&gt;x += $margin[<span class="charliteral">&#39;L&#39;</span>];</div>
<div class="line"><a name="l06646"></a><span class="lineno"> 6646</span>&#160;                        }</div>
<div class="line"><a name="l06647"></a><span class="lineno"> 6647</span>&#160;                        $this-&gt;lMargin += $margin[<span class="charliteral">&#39;L&#39;</span>];</div>
<div class="line"><a name="l06648"></a><span class="lineno"> 6648</span>&#160;                        $this-&gt;rMargin += $margin[<span class="charliteral">&#39;R&#39;</span>];</div>
<div class="line"><a name="l06649"></a><span class="lineno"> 6649</span>&#160;                    }</div>
<div class="line"><a name="l06650"></a><span class="lineno"> 6650</span>&#160;                    <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a56507b79d0b3c74332aaacc32dab873a">getRemainingWidth</a>();</div>
<div class="line"><a name="l06651"></a><span class="lineno"> 6651</span>&#160;                    $wmax = <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> - $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>] - $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>];</div>
<div class="line"><a name="l06652"></a><span class="lineno"> 6652</span>&#160;                    <span class="keywordflow">if</span> ($linebreak) {</div>
<div class="line"><a name="l06653"></a><span class="lineno"> 6653</span>&#160;                        $linebreak = <span class="keyword">false</span>;</div>
<div class="line"><a name="l06654"></a><span class="lineno"> 6654</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06655"></a><span class="lineno"> 6655</span>&#160;                        ++$nl;</div>
<div class="line"><a name="l06656"></a><span class="lineno"> 6656</span>&#160;                        <a class="code" href="../../d4/d40/classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f">$l</a> = 0;</div>
<div class="line"><a name="l06657"></a><span class="lineno"> 6657</span>&#160;                    }</div>
<div class="line"><a name="l06658"></a><span class="lineno"> 6658</span>&#160;                }</div>
<div class="line"><a name="l06659"></a><span class="lineno"> 6659</span>&#160;            }</div>
<div class="line"><a name="l06660"></a><span class="lineno"> 6660</span>&#160;            <span class="comment">// save last character</span></div>
<div class="line"><a name="l06661"></a><span class="lineno"> 6661</span>&#160;            $pc = $c;</div>
<div class="line"><a name="l06662"></a><span class="lineno"> 6662</span>&#160;            ++$i;</div>
<div class="line"><a name="l06663"></a><span class="lineno"> 6663</span>&#160;        } <span class="comment">// end while i &lt; nb</span></div>
<div class="line"><a name="l06664"></a><span class="lineno"> 6664</span>&#160;        <span class="comment">// print last substring (if any)</span></div>
<div class="line"><a name="l06665"></a><span class="lineno"> 6665</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f">$l</a> &gt; 0) {</div>
<div class="line"><a name="l06666"></a><span class="lineno"> 6666</span>&#160;            <span class="keywordflow">switch</span> ($align) {</div>
<div class="line"><a name="l06667"></a><span class="lineno"> 6667</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;J&#39;</span>:</div>
<div class="line"><a name="l06668"></a><span class="lineno"> 6668</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>: {</div>
<div class="line"><a name="l06669"></a><span class="lineno"> 6669</span>&#160;                    <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>;</div>
<div class="line"><a name="l06670"></a><span class="lineno"> 6670</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06671"></a><span class="lineno"> 6671</span>&#160;                }</div>
<div class="line"><a name="l06672"></a><span class="lineno"> 6672</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;L&#39;</span>: {</div>
<div class="line"><a name="l06673"></a><span class="lineno"> 6673</span>&#160;                    <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l06674"></a><span class="lineno"> 6674</span>&#160;                        <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>;</div>
<div class="line"><a name="l06675"></a><span class="lineno"> 6675</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06676"></a><span class="lineno"> 6676</span>&#160;                        <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = <a class="code" href="../../d4/d40/classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f">$l</a>;</div>
<div class="line"><a name="l06677"></a><span class="lineno"> 6677</span>&#160;                    }</div>
<div class="line"><a name="l06678"></a><span class="lineno"> 6678</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06679"></a><span class="lineno"> 6679</span>&#160;                }</div>
<div class="line"><a name="l06680"></a><span class="lineno"> 6680</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;R&#39;</span>: {</div>
<div class="line"><a name="l06681"></a><span class="lineno"> 6681</span>&#160;                    <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l06682"></a><span class="lineno"> 6682</span>&#160;                        <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = <a class="code" href="../../d4/d40/classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f">$l</a>;</div>
<div class="line"><a name="l06683"></a><span class="lineno"> 6683</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06684"></a><span class="lineno"> 6684</span>&#160;                        <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>;</div>
<div class="line"><a name="l06685"></a><span class="lineno"> 6685</span>&#160;                    }</div>
<div class="line"><a name="l06686"></a><span class="lineno"> 6686</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06687"></a><span class="lineno"> 6687</span>&#160;                }</div>
<div class="line"><a name="l06688"></a><span class="lineno"> 6688</span>&#160;                <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l06689"></a><span class="lineno"> 6689</span>&#160;                    <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = <a class="code" href="../../d4/d40/classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f">$l</a>;</div>
<div class="line"><a name="l06690"></a><span class="lineno"> 6690</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06691"></a><span class="lineno"> 6691</span>&#160;                }</div>
<div class="line"><a name="l06692"></a><span class="lineno"> 6692</span>&#160;            }</div>
<div class="line"><a name="l06693"></a><span class="lineno"> 6693</span>&#160;            $tmpstr = TCPDF_FONTS::UniArrSubString($uchars, $j, $nb);</div>
<div class="line"><a name="l06694"></a><span class="lineno"> 6694</span>&#160;            <span class="keywordflow">if</span> ($firstline) {</div>
<div class="line"><a name="l06695"></a><span class="lineno"> 6695</span>&#160;                $startx = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$this-&gt;x</a>;</div>
<div class="line"><a name="l06696"></a><span class="lineno"> 6696</span>&#160;                $tmparr = array_slice($chars, $j, ($nb - $j));</div>
<div class="line"><a name="l06697"></a><span class="lineno"> 6697</span>&#160;                <span class="keywordflow">if</span> ($rtlmode) {</div>
<div class="line"><a name="l06698"></a><span class="lineno"> 6698</span>&#160;                    $tmparr = TCPDF_FONTS::utf8Bidi($tmparr, $tmpstr, $this-&gt;tmprtl, $this-&gt;isunicode, $this-&gt;CurrentFont);</div>
<div class="line"><a name="l06699"></a><span class="lineno"> 6699</span>&#160;                }</div>
<div class="line"><a name="l06700"></a><span class="lineno"> 6700</span>&#160;                $linew = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#afe09291dfba7203e225a507e71e1d43e">GetArrStringWidth</a>($tmparr);</div>
<div class="line"><a name="l06701"></a><span class="lineno"> 6701</span>&#160;                unset($tmparr);</div>
<div class="line"><a name="l06702"></a><span class="lineno"> 6702</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l06703"></a><span class="lineno"> 6703</span>&#160;                    $this-&gt;endlinex = $startx - $linew;</div>
<div class="line"><a name="l06704"></a><span class="lineno"> 6704</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06705"></a><span class="lineno"> 6705</span>&#160;                    $this-&gt;endlinex = $startx + $linew;</div>
<div class="line"><a name="l06706"></a><span class="lineno"> 6706</span>&#160;                }</div>
<div class="line"><a name="l06707"></a><span class="lineno"> 6707</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = $linew;</div>
<div class="line"><a name="l06708"></a><span class="lineno"> 6708</span>&#160;                $tmpcellpadding = <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$this-&gt;cell_padding</a>;</div>
<div class="line"><a name="l06709"></a><span class="lineno"> 6709</span>&#160;                <span class="keywordflow">if</span> ($maxh == 0) {</div>
<div class="line"><a name="l06710"></a><span class="lineno"> 6710</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a374b24751bf76e4ca5ba7694f87ec2c1">SetCellPadding</a>(0);</div>
<div class="line"><a name="l06711"></a><span class="lineno"> 6711</span>&#160;                }</div>
<div class="line"><a name="l06712"></a><span class="lineno"> 6712</span>&#160;            }</div>
<div class="line"><a name="l06713"></a><span class="lineno"> 6713</span>&#160;            <span class="keywordflow">if</span> ($firstblock AND $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#accba6f1471acb211de74e6b34107041d">isRTLTextDir</a>()) {</div>
<div class="line"><a name="l06714"></a><span class="lineno"> 6714</span>&#160;                $tmpstr = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa198175b5bdc3ed8663efa6b5286a74a">stringRightTrim</a>($tmpstr);</div>
<div class="line"><a name="l06715"></a><span class="lineno"> 6715</span>&#160;            }</div>
<div class="line"><a name="l06716"></a><span class="lineno"> 6716</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a33b265e5eb3e4d1d4fedfe29f8166f31">Cell</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $tmpstr, 0, $ln, $align, $fill, $link, $stretch);</div>
<div class="line"><a name="l06717"></a><span class="lineno"> 6717</span>&#160;            unset($tmpstr);</div>
<div class="line"><a name="l06718"></a><span class="lineno"> 6718</span>&#160;            <span class="keywordflow">if</span> ($firstline) {</div>
<div class="line"><a name="l06719"></a><span class="lineno"> 6719</span>&#160;                $this-&gt;cell_padding = $tmpcellpadding;</div>
<div class="line"><a name="l06720"></a><span class="lineno"> 6720</span>&#160;                <span class="keywordflow">return</span> (TCPDF_FONTS::UniArrSubString($uchars, $nb));</div>
<div class="line"><a name="l06721"></a><span class="lineno"> 6721</span>&#160;            }</div>
<div class="line"><a name="l06722"></a><span class="lineno"> 6722</span>&#160;            ++$nl;</div>
<div class="line"><a name="l06723"></a><span class="lineno"> 6723</span>&#160;        }</div>
<div class="line"><a name="l06724"></a><span class="lineno"> 6724</span>&#160;        <span class="keywordflow">if</span> ($firstline) {</div>
<div class="line"><a name="l06725"></a><span class="lineno"> 6725</span>&#160;            <span class="keywordflow">return</span> <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l06726"></a><span class="lineno"> 6726</span>&#160;        }</div>
<div class="line"><a name="l06727"></a><span class="lineno"> 6727</span>&#160;        <span class="keywordflow">return</span> $nl;</div>
<div class="line"><a name="l06728"></a><span class="lineno"> 6728</span>&#160;    }</div>
<div class="line"><a name="l06729"></a><span class="lineno"> 6729</span>&#160;</div>
<div class="line"><a name="l06735"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a56507b79d0b3c74332aaacc32dab873a"> 6735</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a56507b79d0b3c74332aaacc32dab873a">getRemainingWidth</a>() {</div>
<div class="line"><a name="l06736"></a><span class="lineno"> 6736</span>&#160;        list($this-&gt;x, $this-&gt;y) = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1d99e81697a90efb13a6734001427f40">checkPageRegions</a>(0, $this-&gt;x, $this-&gt;y);</div>
<div class="line"><a name="l06737"></a><span class="lineno"> 6737</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l06738"></a><span class="lineno"> 6738</span>&#160;            <span class="keywordflow">return</span> ($this-&gt;x - $this-&gt;lMargin);</div>
<div class="line"><a name="l06739"></a><span class="lineno"> 6739</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06740"></a><span class="lineno"> 6740</span>&#160;            <span class="keywordflow">return</span> ($this-&gt;w - $this-&gt;rMargin - $this-&gt;x);</div>
<div class="line"><a name="l06741"></a><span class="lineno"> 6741</span>&#160;        }</div>
<div class="line"><a name="l06742"></a><span class="lineno"> 6742</span>&#160;    }</div>
<div class="line"><a name="l06743"></a><span class="lineno"> 6743</span>&#160;</div>
<div class="line"><a name="l06755"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#af1db92d221fd87c76d7c607f32266d0a"> 6755</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#af1db92d221fd87c76d7c607f32266d0a">fitBlock</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, $fitonpage=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l06756"></a><span class="lineno"> 6756</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> &lt;= 0) {</div>
<div class="line"><a name="l06757"></a><span class="lineno"> 6757</span>&#160;            <span class="comment">// set maximum width</span></div>
<div class="line"><a name="l06758"></a><span class="lineno"> 6758</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = ($this-&gt;w - $this-&gt;lMargin - <a class="code" href="../../d4/d40/classTCPDF.html#a44fb75b85bea40ced25fdea9d89dc8e9">$this-&gt;rMargin</a>);</div>
<div class="line"><a name="l06759"></a><span class="lineno"> 6759</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> &lt;= 0) {</div>
<div class="line"><a name="l06760"></a><span class="lineno"> 6760</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = 1;</div>
<div class="line"><a name="l06761"></a><span class="lineno"> 6761</span>&#160;            }</div>
<div class="line"><a name="l06762"></a><span class="lineno"> 6762</span>&#160;        }</div>
<div class="line"><a name="l06763"></a><span class="lineno"> 6763</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> &lt;= 0) {</div>
<div class="line"><a name="l06764"></a><span class="lineno"> 6764</span>&#160;            <span class="comment">// set maximum height</span></div>
<div class="line"><a name="l06765"></a><span class="lineno"> 6765</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> = ($this-&gt;PageBreakTrigger - <a class="code" href="../../d4/d40/classTCPDF.html#ace8343242b398fd16a4acb1926b6efa7">$this-&gt;tMargin</a>);</div>
<div class="line"><a name="l06766"></a><span class="lineno"> 6766</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> &lt;= 0) {</div>
<div class="line"><a name="l06767"></a><span class="lineno"> 6767</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> = 1;</div>
<div class="line"><a name="l06768"></a><span class="lineno"> 6768</span>&#160;            }</div>
<div class="line"><a name="l06769"></a><span class="lineno"> 6769</span>&#160;        }</div>
<div class="line"><a name="l06770"></a><span class="lineno"> 6770</span>&#160;        <span class="comment">// resize the block to be vertically contained on a single page or single column</span></div>
<div class="line"><a name="l06771"></a><span class="lineno"> 6771</span>&#160;        <span class="keywordflow">if</span> ($fitonpage OR $this-&gt;AutoPageBreak) {</div>
<div class="line"><a name="l06772"></a><span class="lineno"> 6772</span>&#160;            $ratio_wh = (<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> / <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>);</div>
<div class="line"><a name="l06773"></a><span class="lineno"> 6773</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> &gt; ($this-&gt;PageBreakTrigger - $this-&gt;tMargin)) {</div>
<div class="line"><a name="l06774"></a><span class="lineno"> 6774</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> = $this-&gt;PageBreakTrigger - <a class="code" href="../../d4/d40/classTCPDF.html#ace8343242b398fd16a4acb1926b6efa7">$this-&gt;tMargin</a>;</div>
<div class="line"><a name="l06775"></a><span class="lineno"> 6775</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = (<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> * $ratio_wh);</div>
<div class="line"><a name="l06776"></a><span class="lineno"> 6776</span>&#160;            }</div>
<div class="line"><a name="l06777"></a><span class="lineno"> 6777</span>&#160;            <span class="comment">// resize the block to be horizontally contained on a single page or single column</span></div>
<div class="line"><a name="l06778"></a><span class="lineno"> 6778</span>&#160;            <span class="keywordflow">if</span> ($fitonpage) {</div>
<div class="line"><a name="l06779"></a><span class="lineno"> 6779</span>&#160;                $maxw = ($this-&gt;w - $this-&gt;lMargin - <a class="code" href="../../d4/d40/classTCPDF.html#a44fb75b85bea40ced25fdea9d89dc8e9">$this-&gt;rMargin</a>);</div>
<div class="line"><a name="l06780"></a><span class="lineno"> 6780</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> &gt; $maxw) {</div>
<div class="line"><a name="l06781"></a><span class="lineno"> 6781</span>&#160;                    <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = $maxw;</div>
<div class="line"><a name="l06782"></a><span class="lineno"> 6782</span>&#160;                    <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> = (<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> / $ratio_wh);</div>
<div class="line"><a name="l06783"></a><span class="lineno"> 6783</span>&#160;                }</div>
<div class="line"><a name="l06784"></a><span class="lineno"> 6784</span>&#160;            }</div>
<div class="line"><a name="l06785"></a><span class="lineno"> 6785</span>&#160;        }</div>
<div class="line"><a name="l06786"></a><span class="lineno"> 6786</span>&#160;        <span class="comment">// Check whether we need a new page or new column first as this does not fit</span></div>
<div class="line"><a name="l06787"></a><span class="lineno"> 6787</span>&#160;        $prev_x = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$this-&gt;x</a>;</div>
<div class="line"><a name="l06788"></a><span class="lineno"> 6788</span>&#160;        $prev_y = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l06789"></a><span class="lineno"> 6789</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a9e8e4b4d75485b8f1e3aa2133a811e50">checkPageBreak</a>(<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>) OR ($this-&gt;y &lt; $prev_y)) {</div>
<div class="line"><a name="l06790"></a><span class="lineno"> 6790</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l06791"></a><span class="lineno"> 6791</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l06792"></a><span class="lineno"> 6792</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> += ($prev_x - <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$this-&gt;x</a>);</div>
<div class="line"><a name="l06793"></a><span class="lineno"> 6793</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06794"></a><span class="lineno"> 6794</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> += ($this-&gt;x - $prev_x);</div>
<div class="line"><a name="l06795"></a><span class="lineno"> 6795</span>&#160;            }</div>
<div class="line"><a name="l06796"></a><span class="lineno"> 6796</span>&#160;            $this-&gt;newline = <span class="keyword">true</span>;</div>
<div class="line"><a name="l06797"></a><span class="lineno"> 6797</span>&#160;        }</div>
<div class="line"><a name="l06798"></a><span class="lineno"> 6798</span>&#160;        <span class="comment">// resize the block to be contained on the remaining available page or column space</span></div>
<div class="line"><a name="l06799"></a><span class="lineno"> 6799</span>&#160;        <span class="keywordflow">if</span> ($fitonpage) {</div>
<div class="line"><a name="l06800"></a><span class="lineno"> 6800</span>&#160;            $ratio_wh = (<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> / <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>);</div>
<div class="line"><a name="l06801"></a><span class="lineno"> 6801</span>&#160;            <span class="keywordflow">if</span> ((<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> + <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>) &gt; <a class="code" href="../../d4/d40/classTCPDF.html#ae8f57f5a0dc2a796269772b2cd490c5e">$this-&gt;PageBreakTrigger</a>) {</div>
<div class="line"><a name="l06802"></a><span class="lineno"> 6802</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> = $this-&gt;PageBreakTrigger - <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>;</div>
<div class="line"><a name="l06803"></a><span class="lineno"> 6803</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = (<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> * $ratio_wh);</div>
<div class="line"><a name="l06804"></a><span class="lineno"> 6804</span>&#160;            }</div>
<div class="line"><a name="l06805"></a><span class="lineno"> 6805</span>&#160;            <span class="keywordflow">if</span> ((!$this-&gt;rtl) AND ((<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> + <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>) &gt; ($this-&gt;w - $this-&gt;rMargin))) {</div>
<div class="line"><a name="l06806"></a><span class="lineno"> 6806</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = $this-&gt;w - $this-&gt;rMargin - <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>;</div>
<div class="line"><a name="l06807"></a><span class="lineno"> 6807</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> = (<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> / $ratio_wh);</div>
<div class="line"><a name="l06808"></a><span class="lineno"> 6808</span>&#160;            } elseif (($this-&gt;rtl) AND ((<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> - <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>) &lt; ($this-&gt;lMargin))) {</div>
<div class="line"><a name="l06809"></a><span class="lineno"> 6809</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> - <a class="code" href="../../d4/d40/classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da">$this-&gt;lMargin</a>;</div>
<div class="line"><a name="l06810"></a><span class="lineno"> 6810</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> = (<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> / $ratio_wh);</div>
<div class="line"><a name="l06811"></a><span class="lineno"> 6811</span>&#160;            }</div>
<div class="line"><a name="l06812"></a><span class="lineno"> 6812</span>&#160;        }</div>
<div class="line"><a name="l06813"></a><span class="lineno"> 6813</span>&#160;        <span class="keywordflow">return</span> array(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>);</div>
<div class="line"><a name="l06814"></a><span class="lineno"> 6814</span>&#160;    }</div>
<div class="line"><a name="l06815"></a><span class="lineno"> 6815</span>&#160;</div>
<div class="line"><a name="l06850"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a714c2bee7d6b39d4d6d304540c761352"> 6850</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a714c2bee7d6b39d4d6d304540c761352">Image</a>($file, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>=0, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>=0, $type=<span class="stringliteral">&#39;&#39;</span>, $link=<span class="stringliteral">&#39;&#39;</span>, $align=<span class="stringliteral">&#39;&#39;</span>, $resize=<span class="keyword">false</span>, <a class="code" href="../../d4/d40/classTCPDF.html#a22272525668774dab75d46dfd66ff2f2">$dpi</a>=300, $palign=<span class="stringliteral">&#39;&#39;</span>, $ismask=<span class="keyword">false</span>, $imgmask=<span class="keyword">false</span>, $border=0, $fitbox=<span class="keyword">false</span>, $hidden=<span class="keyword">false</span>, $fitonpage=<span class="keyword">false</span>, $alt=<span class="keyword">false</span>, $altimgs=array()) {</div>
<div class="line"><a name="l06851"></a><span class="lineno"> 6851</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;state != 2) {</div>
<div class="line"><a name="l06852"></a><span class="lineno"> 6852</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l06853"></a><span class="lineno"> 6853</span>&#160;        }</div>
<div class="line"><a name="l06854"></a><span class="lineno"> 6854</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> === <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l06855"></a><span class="lineno"> 6855</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$this-&gt;x</a>;</div>
<div class="line"><a name="l06856"></a><span class="lineno"> 6856</span>&#160;        }</div>
<div class="line"><a name="l06857"></a><span class="lineno"> 6857</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> === <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l06858"></a><span class="lineno"> 6858</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l06859"></a><span class="lineno"> 6859</span>&#160;        }</div>
<div class="line"><a name="l06860"></a><span class="lineno"> 6860</span>&#160;        <span class="comment">// check page for no-write regions and adapt page margins if necessary</span></div>
<div class="line"><a name="l06861"></a><span class="lineno"> 6861</span>&#160;        list(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>) = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1d99e81697a90efb13a6734001427f40">checkPageRegions</a>(<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>);</div>
<div class="line"><a name="l06862"></a><span class="lineno"> 6862</span>&#160;        $exurl = <span class="stringliteral">&#39;&#39;</span>; <span class="comment">// external streams</span></div>
<div class="line"><a name="l06863"></a><span class="lineno"> 6863</span>&#160;        $imsize = FALSE;</div>
<div class="line"><a name="l06864"></a><span class="lineno"> 6864</span>&#160;        <span class="comment">// check if we are passing an image as file or string</span></div>
<div class="line"><a name="l06865"></a><span class="lineno"> 6865</span>&#160;        <span class="keywordflow">if</span> ($file[0] === <span class="charliteral">&#39;@&#39;</span>) {</div>
<div class="line"><a name="l06866"></a><span class="lineno"> 6866</span>&#160;            <span class="comment">// image from string</span></div>
<div class="line"><a name="l06867"></a><span class="lineno"> 6867</span>&#160;            $imgdata = substr($file, 1);</div>
<div class="line"><a name="l06868"></a><span class="lineno"> 6868</span>&#160;        } <span class="keywordflow">else</span> { <span class="comment">// image file</span></div>
<div class="line"><a name="l06869"></a><span class="lineno"> 6869</span>&#160;            <span class="keywordflow">if</span> ($file[0] === <span class="charliteral">&#39;*&#39;</span>) {</div>
<div class="line"><a name="l06870"></a><span class="lineno"> 6870</span>&#160;                <span class="comment">// image as external stream</span></div>
<div class="line"><a name="l06871"></a><span class="lineno"> 6871</span>&#160;                $file = substr($file, 1);</div>
<div class="line"><a name="l06872"></a><span class="lineno"> 6872</span>&#160;                $exurl = $file;</div>
<div class="line"><a name="l06873"></a><span class="lineno"> 6873</span>&#160;            }</div>
<div class="line"><a name="l06874"></a><span class="lineno"> 6874</span>&#160;            <span class="comment">// check if is a local file</span></div>
<div class="line"><a name="l06875"></a><span class="lineno"> 6875</span>&#160;            <span class="keywordflow">if</span> (!@file_exists($file)) {</div>
<div class="line"><a name="l06876"></a><span class="lineno"> 6876</span>&#160;                <span class="comment">// try to encode spaces on filename</span></div>
<div class="line"><a name="l06877"></a><span class="lineno"> 6877</span>&#160;                $tfile = str_replace(<span class="charliteral">&#39; &#39;</span>, <span class="stringliteral">&#39;%20&#39;</span>, $file);</div>
<div class="line"><a name="l06878"></a><span class="lineno"> 6878</span>&#160;                <span class="keywordflow">if</span> (@file_exists($tfile)) {</div>
<div class="line"><a name="l06879"></a><span class="lineno"> 6879</span>&#160;                    $file = $tfile;</div>
<div class="line"><a name="l06880"></a><span class="lineno"> 6880</span>&#160;                }</div>
<div class="line"><a name="l06881"></a><span class="lineno"> 6881</span>&#160;            }</div>
<div class="line"><a name="l06882"></a><span class="lineno"> 6882</span>&#160;            <span class="keywordflow">if</span> (($imsize = @getimagesize($file)) === FALSE) {</div>
<div class="line"><a name="l06883"></a><span class="lineno"> 6883</span>&#160;                <span class="keywordflow">if</span> (in_array($file, $this-&gt;imagekeys)) {</div>
<div class="line"><a name="l06884"></a><span class="lineno"> 6884</span>&#160;                    <span class="comment">// get existing image data</span></div>
<div class="line"><a name="l06885"></a><span class="lineno"> 6885</span>&#160;                    $info = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1a003edf69be144993c85c07a220315c">getImageBuffer</a>($file);</div>
<div class="line"><a name="l06886"></a><span class="lineno"> 6886</span>&#160;                    $imsize = array($info[<span class="charliteral">&#39;w&#39;</span>], $info[<span class="charliteral">&#39;h&#39;</span>]);                </div>
<div class="line"><a name="l06887"></a><span class="lineno"> 6887</span>&#160;                } elseif (strpos($file, <span class="stringliteral">&#39;__tcpdf_img&#39;</span>) === FALSE) {</div>
<div class="line"><a name="l06888"></a><span class="lineno"> 6888</span>&#160;                    $imgdata = TCPDF_STATIC::fileGetContents($file);</div>
<div class="line"><a name="l06889"></a><span class="lineno"> 6889</span>&#160;                }</div>
<div class="line"><a name="l06890"></a><span class="lineno"> 6890</span>&#160;            }</div>
<div class="line"><a name="l06891"></a><span class="lineno"> 6891</span>&#160;        }</div>
<div class="line"><a name="l06892"></a><span class="lineno"> 6892</span>&#160;        <span class="keywordflow">if</span> (!empty($imgdata)) {</div>
<div class="line"><a name="l06893"></a><span class="lineno"> 6893</span>&#160;            <span class="comment">// copy image to cache</span></div>
<div class="line"><a name="l06894"></a><span class="lineno"> 6894</span>&#160;            $original_file = $file;</div>
<div class="line"><a name="l06895"></a><span class="lineno"> 6895</span>&#160;            $file = TCPDF_STATIC::getObjFilename(<span class="stringliteral">&#39;img&#39;</span>);</div>
<div class="line"><a name="l06896"></a><span class="lineno"> 6896</span>&#160;            $fp = fopen($file, <span class="charliteral">&#39;w&#39;</span>);</div>
<div class="line"><a name="l06897"></a><span class="lineno"> 6897</span>&#160;            <span class="keywordflow">if</span> (!$fp) {</div>
<div class="line"><a name="l06898"></a><span class="lineno"> 6898</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;Unable to write file: &#39;</span>.$file);</div>
<div class="line"><a name="l06899"></a><span class="lineno"> 6899</span>&#160;            }</div>
<div class="line"><a name="l06900"></a><span class="lineno"> 6900</span>&#160;            fwrite($fp, $imgdata);</div>
<div class="line"><a name="l06901"></a><span class="lineno"> 6901</span>&#160;            fclose($fp);</div>
<div class="line"><a name="l06902"></a><span class="lineno"> 6902</span>&#160;            unset($imgdata);</div>
<div class="line"><a name="l06903"></a><span class="lineno"> 6903</span>&#160;            $imsize = @getimagesize($file);</div>
<div class="line"><a name="l06904"></a><span class="lineno"> 6904</span>&#160;            <span class="keywordflow">if</span> ($imsize === FALSE) {</div>
<div class="line"><a name="l06905"></a><span class="lineno"> 6905</span>&#160;                unlink($file);</div>
<div class="line"><a name="l06906"></a><span class="lineno"> 6906</span>&#160;                $file = $original_file;</div>
<div class="line"><a name="l06907"></a><span class="lineno"> 6907</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06908"></a><span class="lineno"> 6908</span>&#160;                $this-&gt;cached_files[] = $file;</div>
<div class="line"><a name="l06909"></a><span class="lineno"> 6909</span>&#160;            }</div>
<div class="line"><a name="l06910"></a><span class="lineno"> 6910</span>&#160;        }</div>
<div class="line"><a name="l06911"></a><span class="lineno"> 6911</span>&#160;        <span class="keywordflow">if</span> ($imsize === FALSE) {</div>
<div class="line"><a name="l06912"></a><span class="lineno"> 6912</span>&#160;            <span class="keywordflow">if</span> ((<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> &gt; 0) AND (<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> &gt; 0)) {</div>
<div class="line"><a name="l06913"></a><span class="lineno"> 6913</span>&#160;                <span class="comment">// get measures from specified data</span></div>
<div class="line"><a name="l06914"></a><span class="lineno"> 6914</span>&#160;                $pw = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9">getHTMLUnitToUnits</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, 0, $this-&gt;pdfunit, <span class="keyword">true</span>) * $this-&gt;imgscale * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>;</div>
<div class="line"><a name="l06915"></a><span class="lineno"> 6915</span>&#160;                $ph = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9">getHTMLUnitToUnits</a>(<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, 0, $this-&gt;pdfunit, <span class="keyword">true</span>) * $this-&gt;imgscale * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>;</div>
<div class="line"><a name="l06916"></a><span class="lineno"> 6916</span>&#160;                $imsize = array($pw, $ph);</div>
<div class="line"><a name="l06917"></a><span class="lineno"> 6917</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06918"></a><span class="lineno"> 6918</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;[Image] Unable to get the size of the image: &#39;</span>.$file);</div>
<div class="line"><a name="l06919"></a><span class="lineno"> 6919</span>&#160;            }</div>
<div class="line"><a name="l06920"></a><span class="lineno"> 6920</span>&#160;        }</div>
<div class="line"><a name="l06921"></a><span class="lineno"> 6921</span>&#160;        <span class="comment">// file hash</span></div>
<div class="line"><a name="l06922"></a><span class="lineno"> 6922</span>&#160;        $filehash = md5($this-&gt;file_id.$file);</div>
<div class="line"><a name="l06923"></a><span class="lineno"> 6923</span>&#160;        <span class="comment">// get original image width and height in pixels</span></div>
<div class="line"><a name="l06924"></a><span class="lineno"> 6924</span>&#160;        list($pixw, $pixh) = $imsize;</div>
<div class="line"><a name="l06925"></a><span class="lineno"> 6925</span>&#160;        <span class="comment">// calculate image width and height on document</span></div>
<div class="line"><a name="l06926"></a><span class="lineno"> 6926</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> &lt;= 0) AND (<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> &lt;= 0)) {</div>
<div class="line"><a name="l06927"></a><span class="lineno"> 6927</span>&#160;            <span class="comment">// convert image size to document unit</span></div>
<div class="line"><a name="l06928"></a><span class="lineno"> 6928</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a9a0a09e2334f92e7a54cf1f550c3f921">pixelsToUnits</a>($pixw);</div>
<div class="line"><a name="l06929"></a><span class="lineno"> 6929</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a9a0a09e2334f92e7a54cf1f550c3f921">pixelsToUnits</a>($pixh);</div>
<div class="line"><a name="l06930"></a><span class="lineno"> 6930</span>&#160;        } elseif (<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> &lt;= 0) {</div>
<div class="line"><a name="l06931"></a><span class="lineno"> 6931</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> * $pixw / $pixh;</div>
<div class="line"><a name="l06932"></a><span class="lineno"> 6932</span>&#160;        } elseif (<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> &lt;= 0) {</div>
<div class="line"><a name="l06933"></a><span class="lineno"> 6933</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> = <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> * $pixh / $pixw;</div>
<div class="line"><a name="l06934"></a><span class="lineno"> 6934</span>&#160;        } elseif (($fitbox !== <span class="keyword">false</span>) AND (<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> &gt; 0) AND (<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> &gt; 0)) {</div>
<div class="line"><a name="l06935"></a><span class="lineno"> 6935</span>&#160;            <span class="keywordflow">if</span> (strlen($fitbox) !== 2) {</div>
<div class="line"><a name="l06936"></a><span class="lineno"> 6936</span>&#160;                <span class="comment">// set default alignment</span></div>
<div class="line"><a name="l06937"></a><span class="lineno"> 6937</span>&#160;                $fitbox = <span class="stringliteral">&#39;--&#39;</span>;</div>
<div class="line"><a name="l06938"></a><span class="lineno"> 6938</span>&#160;            }</div>
<div class="line"><a name="l06939"></a><span class="lineno"> 6939</span>&#160;            <span class="comment">// scale image dimensions proportionally to fit within the ($w, $h) box</span></div>
<div class="line"><a name="l06940"></a><span class="lineno"> 6940</span>&#160;            <span class="keywordflow">if</span> (((<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> * $pixh) / (<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> * $pixw)) &lt; 1) {</div>
<div class="line"><a name="l06941"></a><span class="lineno"> 6941</span>&#160;                <span class="comment">// store current height</span></div>
<div class="line"><a name="l06942"></a><span class="lineno"> 6942</span>&#160;                $oldh = <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>;</div>
<div class="line"><a name="l06943"></a><span class="lineno"> 6943</span>&#160;                <span class="comment">// calculate new height</span></div>
<div class="line"><a name="l06944"></a><span class="lineno"> 6944</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> = <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> * $pixh / $pixw;</div>
<div class="line"><a name="l06945"></a><span class="lineno"> 6945</span>&#160;                <span class="comment">// height difference</span></div>
<div class="line"><a name="l06946"></a><span class="lineno"> 6946</span>&#160;                $hdiff = ($oldh - <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>);</div>
<div class="line"><a name="l06947"></a><span class="lineno"> 6947</span>&#160;                <span class="comment">// vertical alignment</span></div>
<div class="line"><a name="l06948"></a><span class="lineno"> 6948</span>&#160;                <span class="keywordflow">switch</span> (strtoupper($fitbox[1])) {</div>
<div class="line"><a name="l06949"></a><span class="lineno"> 6949</span>&#160;                    <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>: {</div>
<div class="line"><a name="l06950"></a><span class="lineno"> 6950</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06951"></a><span class="lineno"> 6951</span>&#160;                    }</div>
<div class="line"><a name="l06952"></a><span class="lineno"> 6952</span>&#160;                    <span class="keywordflow">case</span> <span class="charliteral">&#39;M&#39;</span>: {</div>
<div class="line"><a name="l06953"></a><span class="lineno"> 6953</span>&#160;                        <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> += ($hdiff / 2);</div>
<div class="line"><a name="l06954"></a><span class="lineno"> 6954</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06955"></a><span class="lineno"> 6955</span>&#160;                    }</div>
<div class="line"><a name="l06956"></a><span class="lineno"> 6956</span>&#160;                    <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>: {</div>
<div class="line"><a name="l06957"></a><span class="lineno"> 6957</span>&#160;                        <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> += $hdiff;</div>
<div class="line"><a name="l06958"></a><span class="lineno"> 6958</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06959"></a><span class="lineno"> 6959</span>&#160;                    }</div>
<div class="line"><a name="l06960"></a><span class="lineno"> 6960</span>&#160;                }</div>
<div class="line"><a name="l06961"></a><span class="lineno"> 6961</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06962"></a><span class="lineno"> 6962</span>&#160;                <span class="comment">// store current width</span></div>
<div class="line"><a name="l06963"></a><span class="lineno"> 6963</span>&#160;                $oldw = <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>;</div>
<div class="line"><a name="l06964"></a><span class="lineno"> 6964</span>&#160;                <span class="comment">// calculate new width</span></div>
<div class="line"><a name="l06965"></a><span class="lineno"> 6965</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> * $pixw / $pixh;</div>
<div class="line"><a name="l06966"></a><span class="lineno"> 6966</span>&#160;                <span class="comment">// width difference</span></div>
<div class="line"><a name="l06967"></a><span class="lineno"> 6967</span>&#160;                $wdiff = ($oldw - <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>);</div>
<div class="line"><a name="l06968"></a><span class="lineno"> 6968</span>&#160;                <span class="comment">// horizontal alignment</span></div>
<div class="line"><a name="l06969"></a><span class="lineno"> 6969</span>&#160;                <span class="keywordflow">switch</span> (strtoupper($fitbox[0])) {</div>
<div class="line"><a name="l06970"></a><span class="lineno"> 6970</span>&#160;                    <span class="keywordflow">case</span> <span class="charliteral">&#39;L&#39;</span>: {</div>
<div class="line"><a name="l06971"></a><span class="lineno"> 6971</span>&#160;                        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l06972"></a><span class="lineno"> 6972</span>&#160;                            <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> -= $wdiff;</div>
<div class="line"><a name="l06973"></a><span class="lineno"> 6973</span>&#160;                        }</div>
<div class="line"><a name="l06974"></a><span class="lineno"> 6974</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06975"></a><span class="lineno"> 6975</span>&#160;                    }</div>
<div class="line"><a name="l06976"></a><span class="lineno"> 6976</span>&#160;                    <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>: {</div>
<div class="line"><a name="l06977"></a><span class="lineno"> 6977</span>&#160;                        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l06978"></a><span class="lineno"> 6978</span>&#160;                            <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> -= ($wdiff / 2);</div>
<div class="line"><a name="l06979"></a><span class="lineno"> 6979</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06980"></a><span class="lineno"> 6980</span>&#160;                            <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> += ($wdiff / 2);</div>
<div class="line"><a name="l06981"></a><span class="lineno"> 6981</span>&#160;                        }</div>
<div class="line"><a name="l06982"></a><span class="lineno"> 6982</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06983"></a><span class="lineno"> 6983</span>&#160;                    }</div>
<div class="line"><a name="l06984"></a><span class="lineno"> 6984</span>&#160;                    <span class="keywordflow">case</span> <span class="charliteral">&#39;R&#39;</span>: {</div>
<div class="line"><a name="l06985"></a><span class="lineno"> 6985</span>&#160;                        <span class="keywordflow">if</span> (!$this-&gt;rtl) {</div>
<div class="line"><a name="l06986"></a><span class="lineno"> 6986</span>&#160;                            <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> += $wdiff;</div>
<div class="line"><a name="l06987"></a><span class="lineno"> 6987</span>&#160;                        }</div>
<div class="line"><a name="l06988"></a><span class="lineno"> 6988</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06989"></a><span class="lineno"> 6989</span>&#160;                    }</div>
<div class="line"><a name="l06990"></a><span class="lineno"> 6990</span>&#160;                }</div>
<div class="line"><a name="l06991"></a><span class="lineno"> 6991</span>&#160;            }</div>
<div class="line"><a name="l06992"></a><span class="lineno"> 6992</span>&#160;        }</div>
<div class="line"><a name="l06993"></a><span class="lineno"> 6993</span>&#160;        <span class="comment">// fit the image on available space</span></div>
<div class="line"><a name="l06994"></a><span class="lineno"> 6994</span>&#160;        list(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>) = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af1db92d221fd87c76d7c607f32266d0a">fitBlock</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, $fitonpage);</div>
<div class="line"><a name="l06995"></a><span class="lineno"> 6995</span>&#160;        <span class="comment">// calculate new minimum dimensions in pixels</span></div>
<div class="line"><a name="l06996"></a><span class="lineno"> 6996</span>&#160;        $neww = round(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> * $this-&gt;k * <a class="code" href="../../d4/d40/classTCPDF.html#a22272525668774dab75d46dfd66ff2f2">$dpi</a> / $this-&gt;dpi);</div>
<div class="line"><a name="l06997"></a><span class="lineno"> 6997</span>&#160;        $newh = round(<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> * $this-&gt;k * <a class="code" href="../../d4/d40/classTCPDF.html#a22272525668774dab75d46dfd66ff2f2">$dpi</a> / $this-&gt;dpi);</div>
<div class="line"><a name="l06998"></a><span class="lineno"> 6998</span>&#160;        <span class="comment">// check if resize is necessary (resize is used only to reduce the image)</span></div>
<div class="line"><a name="l06999"></a><span class="lineno"> 6999</span>&#160;        $newsize = ($neww * $newh);</div>
<div class="line"><a name="l07000"></a><span class="lineno"> 7000</span>&#160;        $pixsize = ($pixw * $pixh);</div>
<div class="line"><a name="l07001"></a><span class="lineno"> 7001</span>&#160;        <span class="keywordflow">if</span> (intval($resize) == 2) {</div>
<div class="line"><a name="l07002"></a><span class="lineno"> 7002</span>&#160;            $resize = <span class="keyword">true</span>;</div>
<div class="line"><a name="l07003"></a><span class="lineno"> 7003</span>&#160;        } elseif ($newsize &gt;= $pixsize) {</div>
<div class="line"><a name="l07004"></a><span class="lineno"> 7004</span>&#160;            $resize = <span class="keyword">false</span>;</div>
<div class="line"><a name="l07005"></a><span class="lineno"> 7005</span>&#160;        }</div>
<div class="line"><a name="l07006"></a><span class="lineno"> 7006</span>&#160;        <span class="comment">// check if image has been already added on document</span></div>
<div class="line"><a name="l07007"></a><span class="lineno"> 7007</span>&#160;        $newimage = <span class="keyword">true</span>;</div>
<div class="line"><a name="l07008"></a><span class="lineno"> 7008</span>&#160;        <span class="keywordflow">if</span> (in_array($file, $this-&gt;imagekeys)) {</div>
<div class="line"><a name="l07009"></a><span class="lineno"> 7009</span>&#160;            $newimage = <span class="keyword">false</span>;</div>
<div class="line"><a name="l07010"></a><span class="lineno"> 7010</span>&#160;            <span class="comment">// get existing image data</span></div>
<div class="line"><a name="l07011"></a><span class="lineno"> 7011</span>&#160;            $info = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1a003edf69be144993c85c07a220315c">getImageBuffer</a>($file);</div>
<div class="line"><a name="l07012"></a><span class="lineno"> 7012</span>&#160;            <span class="keywordflow">if</span> (strpos($file, <span class="stringliteral">&#39;__tcpdf_imgmask_&#39;</span>) === FALSE) {</div>
<div class="line"><a name="l07013"></a><span class="lineno"> 7013</span>&#160;                <span class="comment">// check if the newer image is larger</span></div>
<div class="line"><a name="l07014"></a><span class="lineno"> 7014</span>&#160;                $oldsize = ($info[<span class="charliteral">&#39;w&#39;</span>] * $info[<span class="charliteral">&#39;h&#39;</span>]);</div>
<div class="line"><a name="l07015"></a><span class="lineno"> 7015</span>&#160;                <span class="keywordflow">if</span> ((($oldsize &lt; $newsize) AND ($resize)) OR (($oldsize &lt; $pixsize) AND (!$resize))) {</div>
<div class="line"><a name="l07016"></a><span class="lineno"> 7016</span>&#160;                    $newimage = <span class="keyword">true</span>;</div>
<div class="line"><a name="l07017"></a><span class="lineno"> 7017</span>&#160;                }</div>
<div class="line"><a name="l07018"></a><span class="lineno"> 7018</span>&#160;            }</div>
<div class="line"><a name="l07019"></a><span class="lineno"> 7019</span>&#160;        } elseif (($ismask === <span class="keyword">false</span>) AND ($imgmask === <span class="keyword">false</span>) AND (strpos($file, <span class="stringliteral">&#39;__tcpdf_imgmask_&#39;</span>) === FALSE)) {</div>
<div class="line"><a name="l07020"></a><span class="lineno"> 7020</span>&#160;            <span class="comment">// create temp image file (without alpha channel)</span></div>
<div class="line"><a name="l07021"></a><span class="lineno"> 7021</span>&#160;            $tempfile_plain = K_PATH_CACHE.<span class="stringliteral">&#39;__tcpdf_imgmask_plain_&#39;</span>.$filehash;</div>
<div class="line"><a name="l07022"></a><span class="lineno"> 7022</span>&#160;            <span class="comment">// create temp alpha file</span></div>
<div class="line"><a name="l07023"></a><span class="lineno"> 7023</span>&#160;            $tempfile_alpha = K_PATH_CACHE.<span class="stringliteral">&#39;__tcpdf_imgmask_alpha_&#39;</span>.$filehash;</div>
<div class="line"><a name="l07024"></a><span class="lineno"> 7024</span>&#160;            <span class="comment">// check for cached images</span></div>
<div class="line"><a name="l07025"></a><span class="lineno"> 7025</span>&#160;            <span class="keywordflow">if</span> (in_array($tempfile_plain, $this-&gt;imagekeys)) {</div>
<div class="line"><a name="l07026"></a><span class="lineno"> 7026</span>&#160;                <span class="comment">// get existing image data</span></div>
<div class="line"><a name="l07027"></a><span class="lineno"> 7027</span>&#160;                $info = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1a003edf69be144993c85c07a220315c">getImageBuffer</a>($tempfile_plain);</div>
<div class="line"><a name="l07028"></a><span class="lineno"> 7028</span>&#160;                <span class="comment">// check if the newer image is larger</span></div>
<div class="line"><a name="l07029"></a><span class="lineno"> 7029</span>&#160;                $oldsize = ($info[<span class="charliteral">&#39;w&#39;</span>] * $info[<span class="charliteral">&#39;h&#39;</span>]);</div>
<div class="line"><a name="l07030"></a><span class="lineno"> 7030</span>&#160;                <span class="keywordflow">if</span> ((($oldsize &lt; $newsize) AND ($resize)) OR (($oldsize &lt; $pixsize) AND (!$resize))) {</div>
<div class="line"><a name="l07031"></a><span class="lineno"> 7031</span>&#160;                    $newimage = <span class="keyword">true</span>;</div>
<div class="line"><a name="l07032"></a><span class="lineno"> 7032</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l07033"></a><span class="lineno"> 7033</span>&#160;                    $newimage = <span class="keyword">false</span>;</div>
<div class="line"><a name="l07034"></a><span class="lineno"> 7034</span>&#160;                    <span class="comment">// embed mask image</span></div>
<div class="line"><a name="l07035"></a><span class="lineno"> 7035</span>&#160;                    $imgmask = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a714c2bee7d6b39d4d6d304540c761352">Image</a>($tempfile_alpha, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, <span class="stringliteral">&#39;PNG&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $resize, <a class="code" href="../../d4/d40/classTCPDF.html#a22272525668774dab75d46dfd66ff2f2">$dpi</a>, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">true</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l07036"></a><span class="lineno"> 7036</span>&#160;                    <span class="comment">// embed image, masked with previously embedded mask</span></div>
<div class="line"><a name="l07037"></a><span class="lineno"> 7037</span>&#160;                    <span class="keywordflow">return</span> $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a714c2bee7d6b39d4d6d304540c761352">Image</a>($tempfile_plain, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $type, $link, $align, $resize, <a class="code" href="../../d4/d40/classTCPDF.html#a22272525668774dab75d46dfd66ff2f2">$dpi</a>, $palign, <span class="keyword">false</span>, $imgmask);</div>
<div class="line"><a name="l07038"></a><span class="lineno"> 7038</span>&#160;                }</div>
<div class="line"><a name="l07039"></a><span class="lineno"> 7039</span>&#160;            }</div>
<div class="line"><a name="l07040"></a><span class="lineno"> 7040</span>&#160;        }</div>
<div class="line"><a name="l07041"></a><span class="lineno"> 7041</span>&#160;        <span class="keywordflow">if</span> ($newimage) {</div>
<div class="line"><a name="l07042"></a><span class="lineno"> 7042</span>&#160;            <span class="comment">//First use of image, get info</span></div>
<div class="line"><a name="l07043"></a><span class="lineno"> 7043</span>&#160;            $type = strtolower($type);</div>
<div class="line"><a name="l07044"></a><span class="lineno"> 7044</span>&#160;            <span class="keywordflow">if</span> ($type == <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l07045"></a><span class="lineno"> 7045</span>&#160;                $type = TCPDF_IMAGES::getImageFileType($file, $imsize);</div>
<div class="line"><a name="l07046"></a><span class="lineno"> 7046</span>&#160;            } elseif ($type == <span class="stringliteral">&#39;jpg&#39;</span>) {</div>
<div class="line"><a name="l07047"></a><span class="lineno"> 7047</span>&#160;                $type = <span class="stringliteral">&#39;jpeg&#39;</span>;</div>
<div class="line"><a name="l07048"></a><span class="lineno"> 7048</span>&#160;            }</div>
<div class="line"><a name="l07049"></a><span class="lineno"> 7049</span>&#160;            $mqr = TCPDF_STATIC::get_mqr();</div>
<div class="line"><a name="l07050"></a><span class="lineno"> 7050</span>&#160;            TCPDF_STATIC::set_mqr(<span class="keyword">false</span>);</div>
<div class="line"><a name="l07051"></a><span class="lineno"> 7051</span>&#160;            <span class="comment">// Specific image handlers (defined on TCPDF_IMAGES CLASS)</span></div>
<div class="line"><a name="l07052"></a><span class="lineno"> 7052</span>&#160;            $mtd = <span class="stringliteral">&#39;_parse&#39;</span>.$type;</div>
<div class="line"><a name="l07053"></a><span class="lineno"> 7053</span>&#160;            <span class="comment">// GD image handler function</span></div>
<div class="line"><a name="l07054"></a><span class="lineno"> 7054</span>&#160;            $gdfunction = <span class="stringliteral">&#39;imagecreatefrom&#39;</span>.$type;</div>
<div class="line"><a name="l07055"></a><span class="lineno"> 7055</span>&#160;            $info = <span class="keyword">false</span>;</div>
<div class="line"><a name="l07056"></a><span class="lineno"> 7056</span>&#160;            <span class="keywordflow">if</span> ((method_exists(<span class="stringliteral">&#39;TCPDF_IMAGES&#39;</span>, $mtd)) AND (!($resize AND (function_exists($gdfunction) OR extension_loaded(<span class="stringliteral">&#39;imagick&#39;</span>))))) {</div>
<div class="line"><a name="l07057"></a><span class="lineno"> 7057</span>&#160;                <span class="comment">// TCPDF image functions</span></div>
<div class="line"><a name="l07058"></a><span class="lineno"> 7058</span>&#160;                $info = TCPDF_IMAGES::$mtd($file);</div>
<div class="line"><a name="l07059"></a><span class="lineno"> 7059</span>&#160;                <span class="keywordflow">if</span> (($ismask === <span class="keyword">false</span>) AND ($imgmask === <span class="keyword">false</span>) AND (strpos($file, <span class="stringliteral">&#39;__tcpdf_imgmask_&#39;</span>) === FALSE)</div>
<div class="line"><a name="l07060"></a><span class="lineno"> 7060</span>&#160;                    AND (($info === <span class="stringliteral">&#39;pngalpha&#39;</span>) OR (isset($info[<span class="stringliteral">&#39;trns&#39;</span>]) AND !empty($info[<span class="stringliteral">&#39;trns&#39;</span>])))) {</div>
<div class="line"><a name="l07061"></a><span class="lineno"> 7061</span>&#160;                    <span class="keywordflow">return</span> $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a63318e9e32a06621bb98c59cd660a835">ImagePngAlpha</a>($file, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, $pixw, $pixh, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, <span class="stringliteral">&#39;PNG&#39;</span>, $link, $align, $resize, <a class="code" href="../../d4/d40/classTCPDF.html#a22272525668774dab75d46dfd66ff2f2">$dpi</a>, $palign, $filehash);</div>
<div class="line"><a name="l07062"></a><span class="lineno"> 7062</span>&#160;                }</div>
<div class="line"><a name="l07063"></a><span class="lineno"> 7063</span>&#160;            }</div>
<div class="line"><a name="l07064"></a><span class="lineno"> 7064</span>&#160;            <span class="keywordflow">if</span> (($info === <span class="keyword">false</span>) AND function_exists($gdfunction)) {</div>
<div class="line"><a name="l07065"></a><span class="lineno"> 7065</span>&#160;                <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l07066"></a><span class="lineno"> 7066</span>&#160;                    <span class="comment">// GD library</span></div>
<div class="line"><a name="l07067"></a><span class="lineno"> 7067</span>&#160;                    $img = $gdfunction($file);</div>
<div class="line"><a name="l07068"></a><span class="lineno"> 7068</span>&#160;                    <span class="keywordflow">if</span> ($img !== <span class="keyword">false</span>) {</div>
<div class="line"><a name="l07069"></a><span class="lineno"> 7069</span>&#160;                        <span class="keywordflow">if</span> ($resize) {</div>
<div class="line"><a name="l07070"></a><span class="lineno"> 7070</span>&#160;                            $imgr = imagecreatetruecolor($neww, $newh);</div>
<div class="line"><a name="l07071"></a><span class="lineno"> 7071</span>&#160;                            <span class="keywordflow">if</span> (($type == <span class="stringliteral">&#39;gif&#39;</span>) OR ($type == <span class="stringliteral">&#39;png&#39;</span>)) {</div>
<div class="line"><a name="l07072"></a><span class="lineno"> 7072</span>&#160;                                $imgr = TCPDF_IMAGES::setGDImageTransparency($imgr, $img);</div>
<div class="line"><a name="l07073"></a><span class="lineno"> 7073</span>&#160;                            }</div>
<div class="line"><a name="l07074"></a><span class="lineno"> 7074</span>&#160;                            imagecopyresampled($imgr, $img, 0, 0, 0, 0, $neww, $newh, $pixw, $pixh);</div>
<div class="line"><a name="l07075"></a><span class="lineno"> 7075</span>&#160;                            $img = $imgr;</div>
<div class="line"><a name="l07076"></a><span class="lineno"> 7076</span>&#160;                        }</div>
<div class="line"><a name="l07077"></a><span class="lineno"> 7077</span>&#160;                        <span class="keywordflow">if</span> (($type == <span class="stringliteral">&#39;gif&#39;</span>) OR ($type == <span class="stringliteral">&#39;png&#39;</span>)) {</div>
<div class="line"><a name="l07078"></a><span class="lineno"> 7078</span>&#160;                            $info = TCPDF_IMAGES::_toPNG($img);</div>
<div class="line"><a name="l07079"></a><span class="lineno"> 7079</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l07080"></a><span class="lineno"> 7080</span>&#160;                            $info = TCPDF_IMAGES::_toJPEG($img, $this-&gt;jpeg_quality);</div>
<div class="line"><a name="l07081"></a><span class="lineno"> 7081</span>&#160;                        }</div>
<div class="line"><a name="l07082"></a><span class="lineno"> 7082</span>&#160;                    }</div>
<div class="line"><a name="l07083"></a><span class="lineno"> 7083</span>&#160;                } <span class="keywordflow">catch</span>(Exception $e) {</div>
<div class="line"><a name="l07084"></a><span class="lineno"> 7084</span>&#160;                    $info = <span class="keyword">false</span>;</div>
<div class="line"><a name="l07085"></a><span class="lineno"> 7085</span>&#160;                }</div>
<div class="line"><a name="l07086"></a><span class="lineno"> 7086</span>&#160;            }</div>
<div class="line"><a name="l07087"></a><span class="lineno"> 7087</span>&#160;            <span class="keywordflow">if</span> (($info === <span class="keyword">false</span>) AND extension_loaded(<span class="stringliteral">&#39;imagick&#39;</span>)) {</div>
<div class="line"><a name="l07088"></a><span class="lineno"> 7088</span>&#160;                <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l07089"></a><span class="lineno"> 7089</span>&#160;                    <span class="comment">// ImageMagick library</span></div>
<div class="line"><a name="l07090"></a><span class="lineno"> 7090</span>&#160;                    $img = <span class="keyword">new</span> Imagick();</div>
<div class="line"><a name="l07091"></a><span class="lineno"> 7091</span>&#160;                    <span class="keywordflow">if</span> ($type == <span class="stringliteral">&#39;svg&#39;</span>) {</div>
<div class="line"><a name="l07092"></a><span class="lineno"> 7092</span>&#160;                        <span class="keywordflow">if</span> ($file[0] === <span class="charliteral">&#39;@&#39;</span>) {</div>
<div class="line"><a name="l07093"></a><span class="lineno"> 7093</span>&#160;                            <span class="comment">// image from string</span></div>
<div class="line"><a name="l07094"></a><span class="lineno"> 7094</span>&#160;                            $svgimg = substr($file, 1);</div>
<div class="line"><a name="l07095"></a><span class="lineno"> 7095</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l07096"></a><span class="lineno"> 7096</span>&#160;                            <span class="comment">// get SVG file content</span></div>
<div class="line"><a name="l07097"></a><span class="lineno"> 7097</span>&#160;                            $svgimg = TCPDF_STATIC::fileGetContents($file);</div>
<div class="line"><a name="l07098"></a><span class="lineno"> 7098</span>&#160;                        }</div>
<div class="line"><a name="l07099"></a><span class="lineno"> 7099</span>&#160;                        <span class="keywordflow">if</span> ($svgimg !== FALSE) {</div>
<div class="line"><a name="l07100"></a><span class="lineno"> 7100</span>&#160;                            <span class="comment">// get width and height</span></div>
<div class="line"><a name="l07101"></a><span class="lineno"> 7101</span>&#160;                            $regs = array();</div>
<div class="line"><a name="l07102"></a><span class="lineno"> 7102</span>&#160;                            <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/&lt;svg([^&gt;]*)&gt;/si&#39;</span>, $svgimg, $regs)) {</div>
<div class="line"><a name="l07103"></a><span class="lineno"> 7103</span>&#160;                                $svgtag = $regs[1];</div>
<div class="line"><a name="l07104"></a><span class="lineno"> 7104</span>&#160;                                $tmp = array();</div>
<div class="line"><a name="l07105"></a><span class="lineno"> 7105</span>&#160;                                <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/[\s]+width[\s]*=[\s]*&quot;([^&quot;]*)&quot;/si&#39;</span>, $svgtag, $tmp)) {</div>
<div class="line"><a name="l07106"></a><span class="lineno"> 7106</span>&#160;                                    $ow = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9">getHTMLUnitToUnits</a>($tmp[1], 1, $this-&gt;svgunit, <span class="keyword">false</span>);</div>
<div class="line"><a name="l07107"></a><span class="lineno"> 7107</span>&#160;                                    $owu = sprintf(<span class="stringliteral">&#39;%F&#39;</span>, ($ow * <a class="code" href="../../d4/d40/classTCPDF.html#a22272525668774dab75d46dfd66ff2f2">$dpi</a> / 72)).$this-&gt;pdfunit;</div>
<div class="line"><a name="l07108"></a><span class="lineno"> 7108</span>&#160;                                    $svgtag = preg_replace(<span class="stringliteral">&#39;/[\s]+width[\s]*=[\s]*&quot;[^&quot;]*&quot;/si&#39;</span>, <span class="stringliteral">&#39; width=&quot;&#39;</span>.$owu.<span class="charliteral">&#39;&quot;&#39;</span>, $svgtag, 1);</div>
<div class="line"><a name="l07109"></a><span class="lineno"> 7109</span>&#160;                                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l07110"></a><span class="lineno"> 7110</span>&#160;                                    $ow = <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>;</div>
<div class="line"><a name="l07111"></a><span class="lineno"> 7111</span>&#160;                                }</div>
<div class="line"><a name="l07112"></a><span class="lineno"> 7112</span>&#160;                                $tmp = array();</div>
<div class="line"><a name="l07113"></a><span class="lineno"> 7113</span>&#160;                                <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/[\s]+height[\s]*=[\s]*&quot;([^&quot;]*)&quot;/si&#39;</span>, $svgtag, $tmp)) {</div>
<div class="line"><a name="l07114"></a><span class="lineno"> 7114</span>&#160;                                    $oh = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9">getHTMLUnitToUnits</a>($tmp[1], 1, $this-&gt;svgunit, <span class="keyword">false</span>);</div>
<div class="line"><a name="l07115"></a><span class="lineno"> 7115</span>&#160;                                    $ohu = sprintf(<span class="stringliteral">&#39;%F&#39;</span>, ($oh * <a class="code" href="../../d4/d40/classTCPDF.html#a22272525668774dab75d46dfd66ff2f2">$dpi</a> / 72)).$this-&gt;pdfunit;</div>
<div class="line"><a name="l07116"></a><span class="lineno"> 7116</span>&#160;                                    $svgtag = preg_replace(<span class="stringliteral">&#39;/[\s]+height[\s]*=[\s]*&quot;[^&quot;]*&quot;/si&#39;</span>, <span class="stringliteral">&#39; height=&quot;&#39;</span>.$ohu.<span class="charliteral">&#39;&quot;&#39;</span>, $svgtag, 1);</div>
<div class="line"><a name="l07117"></a><span class="lineno"> 7117</span>&#160;                                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l07118"></a><span class="lineno"> 7118</span>&#160;                                    $oh = <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>;</div>
<div class="line"><a name="l07119"></a><span class="lineno"> 7119</span>&#160;                                }</div>
<div class="line"><a name="l07120"></a><span class="lineno"> 7120</span>&#160;                                $tmp = array();</div>
<div class="line"><a name="l07121"></a><span class="lineno"> 7121</span>&#160;                                <span class="keywordflow">if</span> (!preg_match(<span class="stringliteral">&#39;/[\s]+viewBox[\s]*=[\s]*&quot;[\s]*([0-9\.]+)[\s]+([0-9\.]+)[\s]+([0-9\.]+)[\s]+([0-9\.]+)[\s]*&quot;/si&#39;</span>, $svgtag, $tmp)) {</div>
<div class="line"><a name="l07122"></a><span class="lineno"> 7122</span>&#160;                                    $vbw = ($ow * $this-&gt;imgscale * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>);</div>
<div class="line"><a name="l07123"></a><span class="lineno"> 7123</span>&#160;                                    $vbh = ($oh * $this-&gt;imgscale * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>);</div>
<div class="line"><a name="l07124"></a><span class="lineno"> 7124</span>&#160;                                    $vbox = sprintf(<span class="stringliteral">&#39; viewBox=&quot;0 0 %F %F&quot; &#39;</span>, $vbw, $vbh);</div>
<div class="line"><a name="l07125"></a><span class="lineno"> 7125</span>&#160;                                    $svgtag = $vbox.$svgtag;</div>
<div class="line"><a name="l07126"></a><span class="lineno"> 7126</span>&#160;                                }</div>
<div class="line"><a name="l07127"></a><span class="lineno"> 7127</span>&#160;                                $svgimg = preg_replace(<span class="stringliteral">&#39;/&lt;svg([^&gt;]*)&gt;/si&#39;</span>, <span class="stringliteral">&#39;&lt;svg&#39;</span>.$svgtag.<span class="charliteral">&#39;&gt;&#39;</span>, $svgimg, 1);</div>
<div class="line"><a name="l07128"></a><span class="lineno"> 7128</span>&#160;                            }</div>
<div class="line"><a name="l07129"></a><span class="lineno"> 7129</span>&#160;                            $img-&gt;readImageBlob($svgimg);</div>
<div class="line"><a name="l07130"></a><span class="lineno"> 7130</span>&#160;                        }</div>
<div class="line"><a name="l07131"></a><span class="lineno"> 7131</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l07132"></a><span class="lineno"> 7132</span>&#160;                        $img-&gt;readImage($file);</div>
<div class="line"><a name="l07133"></a><span class="lineno"> 7133</span>&#160;                    }</div>
<div class="line"><a name="l07134"></a><span class="lineno"> 7134</span>&#160;                    <span class="keywordflow">if</span> ($resize) {</div>
<div class="line"><a name="l07135"></a><span class="lineno"> 7135</span>&#160;                        $img-&gt;resizeImage($neww, $newh, 10, 1, <span class="keyword">false</span>);</div>
<div class="line"><a name="l07136"></a><span class="lineno"> 7136</span>&#160;                    }</div>
<div class="line"><a name="l07137"></a><span class="lineno"> 7137</span>&#160;                    $img-&gt;setCompressionQuality($this-&gt;jpeg_quality);</div>
<div class="line"><a name="l07138"></a><span class="lineno"> 7138</span>&#160;                    $img-&gt;setImageFormat(<span class="stringliteral">&#39;jpeg&#39;</span>);</div>
<div class="line"><a name="l07139"></a><span class="lineno"> 7139</span>&#160;                    $tempname = TCPDF_STATIC::getObjFilename(<span class="stringliteral">&#39;img&#39;</span>);</div>
<div class="line"><a name="l07140"></a><span class="lineno"> 7140</span>&#160;                    $img-&gt;writeImage($tempname);</div>
<div class="line"><a name="l07141"></a><span class="lineno"> 7141</span>&#160;                    $info = TCPDF_IMAGES::_parsejpeg($tempname);</div>
<div class="line"><a name="l07142"></a><span class="lineno"> 7142</span>&#160;                    unlink($tempname);</div>
<div class="line"><a name="l07143"></a><span class="lineno"> 7143</span>&#160;                    $img-&gt;destroy();</div>
<div class="line"><a name="l07144"></a><span class="lineno"> 7144</span>&#160;                } <span class="keywordflow">catch</span>(Exception $e) {</div>
<div class="line"><a name="l07145"></a><span class="lineno"> 7145</span>&#160;                    $info = <span class="keyword">false</span>;</div>
<div class="line"><a name="l07146"></a><span class="lineno"> 7146</span>&#160;                }</div>
<div class="line"><a name="l07147"></a><span class="lineno"> 7147</span>&#160;            }</div>
<div class="line"><a name="l07148"></a><span class="lineno"> 7148</span>&#160;            <span class="keywordflow">if</span> ($info === <span class="keyword">false</span>) {</div>
<div class="line"><a name="l07149"></a><span class="lineno"> 7149</span>&#160;                <span class="comment">// unable to process image</span></div>
<div class="line"><a name="l07150"></a><span class="lineno"> 7150</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l07151"></a><span class="lineno"> 7151</span>&#160;            }</div>
<div class="line"><a name="l07152"></a><span class="lineno"> 7152</span>&#160;            TCPDF_STATIC::set_mqr($mqr);</div>
<div class="line"><a name="l07153"></a><span class="lineno"> 7153</span>&#160;            <span class="keywordflow">if</span> ($ismask) {</div>
<div class="line"><a name="l07154"></a><span class="lineno"> 7154</span>&#160;                <span class="comment">// force grayscale</span></div>
<div class="line"><a name="l07155"></a><span class="lineno"> 7155</span>&#160;                $info[<span class="stringliteral">&#39;cs&#39;</span>] = <span class="stringliteral">&#39;DeviceGray&#39;</span>;</div>
<div class="line"><a name="l07156"></a><span class="lineno"> 7156</span>&#160;            }</div>
<div class="line"><a name="l07157"></a><span class="lineno"> 7157</span>&#160;            <span class="keywordflow">if</span> ($imgmask !== <span class="keyword">false</span>) {</div>
<div class="line"><a name="l07158"></a><span class="lineno"> 7158</span>&#160;                $info[<span class="stringliteral">&#39;masked&#39;</span>] = $imgmask;</div>
<div class="line"><a name="l07159"></a><span class="lineno"> 7159</span>&#160;            }</div>
<div class="line"><a name="l07160"></a><span class="lineno"> 7160</span>&#160;            <span class="keywordflow">if</span> (!empty($exurl)) {</div>
<div class="line"><a name="l07161"></a><span class="lineno"> 7161</span>&#160;                $info[<span class="stringliteral">&#39;exurl&#39;</span>] = $exurl;</div>
<div class="line"><a name="l07162"></a><span class="lineno"> 7162</span>&#160;            }</div>
<div class="line"><a name="l07163"></a><span class="lineno"> 7163</span>&#160;            <span class="comment">// array of alternative images</span></div>
<div class="line"><a name="l07164"></a><span class="lineno"> 7164</span>&#160;            $info[<span class="stringliteral">&#39;altimgs&#39;</span>] = $altimgs;</div>
<div class="line"><a name="l07165"></a><span class="lineno"> 7165</span>&#160;            <span class="comment">// add image to document</span></div>
<div class="line"><a name="l07166"></a><span class="lineno"> 7166</span>&#160;            $info[<span class="charliteral">&#39;i&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a68092d68b3e4947ea283efe0a990e7d9">setImageBuffer</a>($file, $info);</div>
<div class="line"><a name="l07167"></a><span class="lineno"> 7167</span>&#160;        }</div>
<div class="line"><a name="l07168"></a><span class="lineno"> 7168</span>&#160;        <span class="comment">// set alignment</span></div>
<div class="line"><a name="l07169"></a><span class="lineno"> 7169</span>&#160;        $this-&gt;img_rb_y = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> + <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>;</div>
<div class="line"><a name="l07170"></a><span class="lineno"> 7170</span>&#160;        <span class="comment">// set alignment</span></div>
<div class="line"><a name="l07171"></a><span class="lineno"> 7171</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l07172"></a><span class="lineno"> 7172</span>&#160;            <span class="keywordflow">if</span> ($palign == <span class="charliteral">&#39;L&#39;</span>) {</div>
<div class="line"><a name="l07173"></a><span class="lineno"> 7173</span>&#160;                $ximg = <a class="code" href="../../d4/d40/classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da">$this-&gt;lMargin</a>;</div>
<div class="line"><a name="l07174"></a><span class="lineno"> 7174</span>&#160;            } elseif ($palign == <span class="charliteral">&#39;C&#39;</span>) {</div>
<div class="line"><a name="l07175"></a><span class="lineno"> 7175</span>&#160;                $ximg = ($this-&gt;w + $this-&gt;lMargin - $this-&gt;rMargin - <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>) / 2;</div>
<div class="line"><a name="l07176"></a><span class="lineno"> 7176</span>&#160;            } elseif ($palign == <span class="charliteral">&#39;R&#39;</span>) {</div>
<div class="line"><a name="l07177"></a><span class="lineno"> 7177</span>&#160;                $ximg = $this-&gt;w - $this-&gt;rMargin - <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>;</div>
<div class="line"><a name="l07178"></a><span class="lineno"> 7178</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l07179"></a><span class="lineno"> 7179</span>&#160;                $ximg = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> - <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>;</div>
<div class="line"><a name="l07180"></a><span class="lineno"> 7180</span>&#160;            }</div>
<div class="line"><a name="l07181"></a><span class="lineno"> 7181</span>&#160;            $this-&gt;img_rb_x = $ximg;</div>
<div class="line"><a name="l07182"></a><span class="lineno"> 7182</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l07183"></a><span class="lineno"> 7183</span>&#160;            <span class="keywordflow">if</span> ($palign == <span class="charliteral">&#39;L&#39;</span>) {</div>
<div class="line"><a name="l07184"></a><span class="lineno"> 7184</span>&#160;                $ximg = <a class="code" href="../../d4/d40/classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da">$this-&gt;lMargin</a>;</div>
<div class="line"><a name="l07185"></a><span class="lineno"> 7185</span>&#160;            } elseif ($palign == <span class="charliteral">&#39;C&#39;</span>) {</div>
<div class="line"><a name="l07186"></a><span class="lineno"> 7186</span>&#160;                $ximg = ($this-&gt;w + $this-&gt;lMargin - $this-&gt;rMargin - <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>) / 2;</div>
<div class="line"><a name="l07187"></a><span class="lineno"> 7187</span>&#160;            } elseif ($palign == <span class="charliteral">&#39;R&#39;</span>) {</div>
<div class="line"><a name="l07188"></a><span class="lineno"> 7188</span>&#160;                $ximg = $this-&gt;w - $this-&gt;rMargin - <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>;</div>
<div class="line"><a name="l07189"></a><span class="lineno"> 7189</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l07190"></a><span class="lineno"> 7190</span>&#160;                $ximg = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>;</div>
<div class="line"><a name="l07191"></a><span class="lineno"> 7191</span>&#160;            }</div>
<div class="line"><a name="l07192"></a><span class="lineno"> 7192</span>&#160;            $this-&gt;img_rb_x = $ximg + <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>;</div>
<div class="line"><a name="l07193"></a><span class="lineno"> 7193</span>&#160;        }</div>
<div class="line"><a name="l07194"></a><span class="lineno"> 7194</span>&#160;        <span class="keywordflow">if</span> ($ismask OR $hidden) {</div>
<div class="line"><a name="l07195"></a><span class="lineno"> 7195</span>&#160;            <span class="comment">// image is not displayed</span></div>
<div class="line"><a name="l07196"></a><span class="lineno"> 7196</span>&#160;            <span class="keywordflow">return</span> $info[<span class="charliteral">&#39;i&#39;</span>];</div>
<div class="line"><a name="l07197"></a><span class="lineno"> 7197</span>&#160;        }</div>
<div class="line"><a name="l07198"></a><span class="lineno"> 7198</span>&#160;        $xkimg = $ximg * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>;</div>
<div class="line"><a name="l07199"></a><span class="lineno"> 7199</span>&#160;        <span class="keywordflow">if</span> (!$alt) {</div>
<div class="line"><a name="l07200"></a><span class="lineno"> 7200</span>&#160;            <span class="comment">// only non-alternative immages will be set</span></div>
<div class="line"><a name="l07201"></a><span class="lineno"> 7201</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(sprintf(<span class="stringliteral">&#39;q %F 0 0 %F %F %F cm /I%u Do Q&#39;</span>, (<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> * $this-&gt;k), ($h * $this-&gt;k), $xkimg, (($this-&gt;h - (<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> + $h)) * $this-&gt;k), $info[<span class="charliteral">&#39;i&#39;</span>]));</div>
<div class="line"><a name="l07202"></a><span class="lineno"> 7202</span>&#160;        }</div>
<div class="line"><a name="l07203"></a><span class="lineno"> 7203</span>&#160;        <span class="keywordflow">if</span> (!empty($border)) {</div>
<div class="line"><a name="l07204"></a><span class="lineno"> 7204</span>&#160;            $bx = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$this-&gt;x</a>;</div>
<div class="line"><a name="l07205"></a><span class="lineno"> 7205</span>&#160;            $by = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l07206"></a><span class="lineno"> 7206</span>&#160;            $this-&gt;x = $ximg;</div>
<div class="line"><a name="l07207"></a><span class="lineno"> 7207</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l07208"></a><span class="lineno"> 7208</span>&#160;                $this-&gt;x += <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>;</div>
<div class="line"><a name="l07209"></a><span class="lineno"> 7209</span>&#160;            }</div>
<div class="line"><a name="l07210"></a><span class="lineno"> 7210</span>&#160;            $this-&gt;y = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>;</div>
<div class="line"><a name="l07211"></a><span class="lineno"> 7211</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a33b265e5eb3e4d1d4fedfe29f8166f31">Cell</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, $h, <span class="stringliteral">&#39;&#39;</span>, $border, 0, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="keyword">true</span>);</div>
<div class="line"><a name="l07212"></a><span class="lineno"> 7212</span>&#160;            $this-&gt;x = $bx;</div>
<div class="line"><a name="l07213"></a><span class="lineno"> 7213</span>&#160;            $this-&gt;y = $by;</div>
<div class="line"><a name="l07214"></a><span class="lineno"> 7214</span>&#160;        }</div>
<div class="line"><a name="l07215"></a><span class="lineno"> 7215</span>&#160;        <span class="keywordflow">if</span> ($link) {</div>
<div class="line"><a name="l07216"></a><span class="lineno"> 7216</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ab87bf1826384fbfe30eb499d42f1d994">Link</a>($ximg, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, $h, $link, 0);</div>
<div class="line"><a name="l07217"></a><span class="lineno"> 7217</span>&#160;        }</div>
<div class="line"><a name="l07218"></a><span class="lineno"> 7218</span>&#160;        <span class="comment">// set pointer to align the next text/objects</span></div>
<div class="line"><a name="l07219"></a><span class="lineno"> 7219</span>&#160;        <span class="keywordflow">switch</span>($align) {</div>
<div class="line"><a name="l07220"></a><span class="lineno"> 7220</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>: {</div>
<div class="line"><a name="l07221"></a><span class="lineno"> 7221</span>&#160;                $this-&gt;y = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>;</div>
<div class="line"><a name="l07222"></a><span class="lineno"> 7222</span>&#160;                $this-&gt;x = <a class="code" href="../../d4/d40/classTCPDF.html#ace8e68000d6185a28a180bbe4531b428">$this-&gt;img_rb_x</a>;</div>
<div class="line"><a name="l07223"></a><span class="lineno"> 7223</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l07224"></a><span class="lineno"> 7224</span>&#160;            }</div>
<div class="line"><a name="l07225"></a><span class="lineno"> 7225</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;M&#39;</span>: {</div>
<div class="line"><a name="l07226"></a><span class="lineno"> 7226</span>&#160;                $this-&gt;y = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> + round($h/2);</div>
<div class="line"><a name="l07227"></a><span class="lineno"> 7227</span>&#160;                $this-&gt;x = <a class="code" href="../../d4/d40/classTCPDF.html#ace8e68000d6185a28a180bbe4531b428">$this-&gt;img_rb_x</a>;</div>
<div class="line"><a name="l07228"></a><span class="lineno"> 7228</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l07229"></a><span class="lineno"> 7229</span>&#160;            }</div>
<div class="line"><a name="l07230"></a><span class="lineno"> 7230</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>: {</div>
<div class="line"><a name="l07231"></a><span class="lineno"> 7231</span>&#160;                $this-&gt;y = <a class="code" href="../../d4/d40/classTCPDF.html#abc05496cf88772b492f67e87c53121d0">$this-&gt;img_rb_y</a>;</div>
<div class="line"><a name="l07232"></a><span class="lineno"> 7232</span>&#160;                $this-&gt;x = <a class="code" href="../../d4/d40/classTCPDF.html#ace8e68000d6185a28a180bbe4531b428">$this-&gt;img_rb_x</a>;</div>
<div class="line"><a name="l07233"></a><span class="lineno"> 7233</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l07234"></a><span class="lineno"> 7234</span>&#160;            }</div>
<div class="line"><a name="l07235"></a><span class="lineno"> 7235</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;N&#39;</span>: {</div>
<div class="line"><a name="l07236"></a><span class="lineno"> 7236</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ad3439990de56253b039bca6a09305758">SetY</a>($this-&gt;img_rb_y);</div>
<div class="line"><a name="l07237"></a><span class="lineno"> 7237</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l07238"></a><span class="lineno"> 7238</span>&#160;            }</div>
<div class="line"><a name="l07239"></a><span class="lineno"> 7239</span>&#160;            <span class="keywordflow">default</span>:{</div>
<div class="line"><a name="l07240"></a><span class="lineno"> 7240</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l07241"></a><span class="lineno"> 7241</span>&#160;            }</div>
<div class="line"><a name="l07242"></a><span class="lineno"> 7242</span>&#160;        }</div>
<div class="line"><a name="l07243"></a><span class="lineno"> 7243</span>&#160;        $this-&gt;endlinex = <a class="code" href="../../d4/d40/classTCPDF.html#ace8e68000d6185a28a180bbe4531b428">$this-&gt;img_rb_x</a>;</div>
<div class="line"><a name="l07244"></a><span class="lineno"> 7244</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;inxobj) {</div>
<div class="line"><a name="l07245"></a><span class="lineno"> 7245</span>&#160;            <span class="comment">// we are inside an XObject template</span></div>
<div class="line"><a name="l07246"></a><span class="lineno"> 7246</span>&#160;            $this-&gt;xobjects[<a class="code" href="../../d4/d40/classTCPDF.html#abe4390b4e1939e10c9b61a986adfc117">$this-&gt;xobjid</a>][<span class="stringliteral">&#39;images&#39;</span>][] = $info[<span class="charliteral">&#39;i&#39;</span>];</div>
<div class="line"><a name="l07247"></a><span class="lineno"> 7247</span>&#160;        }</div>
<div class="line"><a name="l07248"></a><span class="lineno"> 7248</span>&#160;        <span class="keywordflow">return</span> $info[<span class="charliteral">&#39;i&#39;</span>];</div>
<div class="line"><a name="l07249"></a><span class="lineno"> 7249</span>&#160;    }</div>
<div class="line"><a name="l07250"></a><span class="lineno"> 7250</span>&#160;</div>
<div class="line"><a name="l07272"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a63318e9e32a06621bb98c59cd660a835"> 7272</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a63318e9e32a06621bb98c59cd660a835">ImagePngAlpha</a>($file, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, $wpx, $hpx, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $type, $link, $align, $resize, <a class="code" href="../../d4/d40/classTCPDF.html#a22272525668774dab75d46dfd66ff2f2">$dpi</a>, $palign, $filehash=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l07273"></a><span class="lineno"> 7273</span>&#160;        <span class="comment">// create temp images</span></div>
<div class="line"><a name="l07274"></a><span class="lineno"> 7274</span>&#160;        <span class="keywordflow">if</span> (empty($filehash)) {</div>
<div class="line"><a name="l07275"></a><span class="lineno"> 7275</span>&#160;            $filehash = md5($this-&gt;file_id.$file);</div>
<div class="line"><a name="l07276"></a><span class="lineno"> 7276</span>&#160;        }</div>
<div class="line"><a name="l07277"></a><span class="lineno"> 7277</span>&#160;        <span class="comment">// create temp image file (without alpha channel)</span></div>
<div class="line"><a name="l07278"></a><span class="lineno"> 7278</span>&#160;        $tempfile_plain = K_PATH_CACHE.<span class="stringliteral">&#39;__tcpdf_imgmask_plain_&#39;</span>.$filehash;</div>
<div class="line"><a name="l07279"></a><span class="lineno"> 7279</span>&#160;        <span class="comment">// create temp alpha file</span></div>
<div class="line"><a name="l07280"></a><span class="lineno"> 7280</span>&#160;        $tempfile_alpha = K_PATH_CACHE.<span class="stringliteral">&#39;__tcpdf_imgmask_alpha_&#39;</span>.$filehash;</div>
<div class="line"><a name="l07281"></a><span class="lineno"> 7281</span>&#160;        $parsed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l07282"></a><span class="lineno"> 7282</span>&#160;        $parse_error = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l07283"></a><span class="lineno"> 7283</span>&#160;        <span class="comment">// ImageMagick extension</span></div>
<div class="line"><a name="l07284"></a><span class="lineno"> 7284</span>&#160;        <span class="keywordflow">if</span> (($parsed === <span class="keyword">false</span>) AND extension_loaded(<span class="stringliteral">&#39;imagick&#39;</span>)) {</div>
<div class="line"><a name="l07285"></a><span class="lineno"> 7285</span>&#160;            <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l07286"></a><span class="lineno"> 7286</span>&#160;                <span class="comment">// ImageMagick library</span></div>
<div class="line"><a name="l07287"></a><span class="lineno"> 7287</span>&#160;                $img = <span class="keyword">new</span> Imagick();</div>
<div class="line"><a name="l07288"></a><span class="lineno"> 7288</span>&#160;                $img-&gt;readImage($file);</div>
<div class="line"><a name="l07289"></a><span class="lineno"> 7289</span>&#160;                <span class="comment">// clone image object</span></div>
<div class="line"><a name="l07290"></a><span class="lineno"> 7290</span>&#160;                $imga = TCPDF_STATIC::objclone($img);</div>
<div class="line"><a name="l07291"></a><span class="lineno"> 7291</span>&#160;                <span class="comment">// extract alpha channel</span></div>
<div class="line"><a name="l07292"></a><span class="lineno"> 7292</span>&#160;                <span class="keywordflow">if</span> (method_exists($img, <span class="stringliteral">&#39;setImageAlphaChannel&#39;</span>) AND defined(<span class="stringliteral">&#39;Imagick::ALPHACHANNEL_EXTRACT&#39;</span>)) {</div>
<div class="line"><a name="l07293"></a><span class="lineno"> 7293</span>&#160;                    $img-&gt;setImageAlphaChannel(Imagick::ALPHACHANNEL_EXTRACT);</div>
<div class="line"><a name="l07294"></a><span class="lineno"> 7294</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l07295"></a><span class="lineno"> 7295</span>&#160;                    $img-&gt;separateImageChannel(8); <span class="comment">// 8 = (imagick::CHANNEL_ALPHA | imagick::CHANNEL_OPACITY | imagick::CHANNEL_MATTE);</span></div>
<div class="line"><a name="l07296"></a><span class="lineno"> 7296</span>&#160;                    $img-&gt;negateImage(<span class="keyword">true</span>);</div>
<div class="line"><a name="l07297"></a><span class="lineno"> 7297</span>&#160;                }</div>
<div class="line"><a name="l07298"></a><span class="lineno"> 7298</span>&#160;                $img-&gt;setImageFormat(<span class="stringliteral">&#39;png&#39;</span>);</div>
<div class="line"><a name="l07299"></a><span class="lineno"> 7299</span>&#160;                $img-&gt;writeImage($tempfile_alpha);</div>
<div class="line"><a name="l07300"></a><span class="lineno"> 7300</span>&#160;                <span class="comment">// remove alpha channel</span></div>
<div class="line"><a name="l07301"></a><span class="lineno"> 7301</span>&#160;                <span class="keywordflow">if</span> (method_exists($imga, <span class="stringliteral">&#39;setImageMatte&#39;</span>)) {</div>
<div class="line"><a name="l07302"></a><span class="lineno"> 7302</span>&#160;                    $imga-&gt;setImageMatte(<span class="keyword">false</span>);</div>
<div class="line"><a name="l07303"></a><span class="lineno"> 7303</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l07304"></a><span class="lineno"> 7304</span>&#160;                    $imga-&gt;separateImageChannel(39); <span class="comment">// 39 = (imagick::CHANNEL_ALL &amp; ~(imagick::CHANNEL_ALPHA | imagick::CHANNEL_OPACITY | imagick::CHANNEL_MATTE));</span></div>
<div class="line"><a name="l07305"></a><span class="lineno"> 7305</span>&#160;                }</div>
<div class="line"><a name="l07306"></a><span class="lineno"> 7306</span>&#160;                $imga-&gt;setImageFormat(<span class="stringliteral">&#39;png&#39;</span>);</div>
<div class="line"><a name="l07307"></a><span class="lineno"> 7307</span>&#160;                $imga-&gt;writeImage($tempfile_plain);</div>
<div class="line"><a name="l07308"></a><span class="lineno"> 7308</span>&#160;                $parsed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l07309"></a><span class="lineno"> 7309</span>&#160;            } <span class="keywordflow">catch</span> (Exception $e) {</div>
<div class="line"><a name="l07310"></a><span class="lineno"> 7310</span>&#160;                <span class="comment">// Imagemagick fails, try with GD</span></div>
<div class="line"><a name="l07311"></a><span class="lineno"> 7311</span>&#160;                $parse_error = <span class="stringliteral">&#39;Imagick library error: &#39;</span>.$e-&gt;getMessage();</div>
<div class="line"><a name="l07312"></a><span class="lineno"> 7312</span>&#160;            }</div>
<div class="line"><a name="l07313"></a><span class="lineno"> 7313</span>&#160;        }</div>
<div class="line"><a name="l07314"></a><span class="lineno"> 7314</span>&#160;        <span class="comment">// GD extension</span></div>
<div class="line"><a name="l07315"></a><span class="lineno"> 7315</span>&#160;        <span class="keywordflow">if</span> (($parsed === <span class="keyword">false</span>) AND function_exists(<span class="stringliteral">&#39;imagecreatefrompng&#39;</span>)) {</div>
<div class="line"><a name="l07316"></a><span class="lineno"> 7316</span>&#160;            <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l07317"></a><span class="lineno"> 7317</span>&#160;                <span class="comment">// generate images</span></div>
<div class="line"><a name="l07318"></a><span class="lineno"> 7318</span>&#160;                $img = imagecreatefrompng($file);</div>
<div class="line"><a name="l07319"></a><span class="lineno"> 7319</span>&#160;                $imgalpha = imagecreate($wpx, $hpx);</div>
<div class="line"><a name="l07320"></a><span class="lineno"> 7320</span>&#160;                <span class="comment">// generate gray scale palette (0 -&gt; 255)</span></div>
<div class="line"><a name="l07321"></a><span class="lineno"> 7321</span>&#160;                <span class="keywordflow">for</span> ($c = 0; $c &lt; 256; ++$c) {</div>
<div class="line"><a name="l07322"></a><span class="lineno"> 7322</span>&#160;                    ImageColorAllocate($imgalpha, $c, $c, $c);</div>
<div class="line"><a name="l07323"></a><span class="lineno"> 7323</span>&#160;                }</div>
<div class="line"><a name="l07324"></a><span class="lineno"> 7324</span>&#160;                <span class="comment">// extract alpha channel</span></div>
<div class="line"><a name="l07325"></a><span class="lineno"> 7325</span>&#160;                <span class="keywordflow">for</span> ($xpx = 0; $xpx &lt; $wpx; ++$xpx) {</div>
<div class="line"><a name="l07326"></a><span class="lineno"> 7326</span>&#160;                    <span class="keywordflow">for</span> ($ypx = 0; $ypx &lt; $hpx; ++$ypx) {</div>
<div class="line"><a name="l07327"></a><span class="lineno"> 7327</span>&#160;                        $color = imagecolorat($img, $xpx, $ypx);</div>
<div class="line"><a name="l07328"></a><span class="lineno"> 7328</span>&#160;                        <span class="comment">// get and correct gamma color</span></div>
<div class="line"><a name="l07329"></a><span class="lineno"> 7329</span>&#160;                        <a class="code" href="../../d4/d40/classTCPDF.html#ae4a86c2e1ba1b7026fbfb1eb43845f1a">$alpha</a> = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aff67c582d024c7d0ee6b61d479710635">getGDgamma</a>($img, $color);</div>
<div class="line"><a name="l07330"></a><span class="lineno"> 7330</span>&#160;                        imagesetpixel($imgalpha, $xpx, $ypx, <a class="code" href="../../d4/d40/classTCPDF.html#ae4a86c2e1ba1b7026fbfb1eb43845f1a">$alpha</a>);</div>
<div class="line"><a name="l07331"></a><span class="lineno"> 7331</span>&#160;                    }</div>
<div class="line"><a name="l07332"></a><span class="lineno"> 7332</span>&#160;                }</div>
<div class="line"><a name="l07333"></a><span class="lineno"> 7333</span>&#160;                imagepng($imgalpha, $tempfile_alpha);</div>
<div class="line"><a name="l07334"></a><span class="lineno"> 7334</span>&#160;                imagedestroy($imgalpha);</div>
<div class="line"><a name="l07335"></a><span class="lineno"> 7335</span>&#160;                <span class="comment">// extract image without alpha channel</span></div>
<div class="line"><a name="l07336"></a><span class="lineno"> 7336</span>&#160;                $imgplain = imagecreatetruecolor($wpx, $hpx);</div>
<div class="line"><a name="l07337"></a><span class="lineno"> 7337</span>&#160;                imagecopy($imgplain, $img, 0, 0, 0, 0, $wpx, $hpx);</div>
<div class="line"><a name="l07338"></a><span class="lineno"> 7338</span>&#160;                imagepng($imgplain, $tempfile_plain);</div>
<div class="line"><a name="l07339"></a><span class="lineno"> 7339</span>&#160;                imagedestroy($imgplain);</div>
<div class="line"><a name="l07340"></a><span class="lineno"> 7340</span>&#160;                $parsed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l07341"></a><span class="lineno"> 7341</span>&#160;            } <span class="keywordflow">catch</span> (Exception $e) {</div>
<div class="line"><a name="l07342"></a><span class="lineno"> 7342</span>&#160;                <span class="comment">// GD fails</span></div>
<div class="line"><a name="l07343"></a><span class="lineno"> 7343</span>&#160;                $parse_error = <span class="stringliteral">&#39;GD library error: &#39;</span>.$e-&gt;getMessage();</div>
<div class="line"><a name="l07344"></a><span class="lineno"> 7344</span>&#160;            }</div>
<div class="line"><a name="l07345"></a><span class="lineno"> 7345</span>&#160;        }</div>
<div class="line"><a name="l07346"></a><span class="lineno"> 7346</span>&#160;        <span class="keywordflow">if</span> ($parsed === <span class="keyword">false</span>) {</div>
<div class="line"><a name="l07347"></a><span class="lineno"> 7347</span>&#160;            <span class="keywordflow">if</span> (empty($parse_error)) {</div>
<div class="line"><a name="l07348"></a><span class="lineno"> 7348</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;TCPDF requires the Imagick or GD extension to handle PNG images with alpha channel.&#39;</span>);</div>
<div class="line"><a name="l07349"></a><span class="lineno"> 7349</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l07350"></a><span class="lineno"> 7350</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>($parse_error);</div>
<div class="line"><a name="l07351"></a><span class="lineno"> 7351</span>&#160;            }</div>
<div class="line"><a name="l07352"></a><span class="lineno"> 7352</span>&#160;        }</div>
<div class="line"><a name="l07353"></a><span class="lineno"> 7353</span>&#160;        <span class="comment">// embed mask image</span></div>
<div class="line"><a name="l07354"></a><span class="lineno"> 7354</span>&#160;        $imgmask = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a714c2bee7d6b39d4d6d304540c761352">Image</a>($tempfile_alpha, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, <span class="stringliteral">&#39;PNG&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $resize, <a class="code" href="../../d4/d40/classTCPDF.html#a22272525668774dab75d46dfd66ff2f2">$dpi</a>, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">true</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l07355"></a><span class="lineno"> 7355</span>&#160;        <span class="comment">// embed image, masked with previously embedded mask</span></div>
<div class="line"><a name="l07356"></a><span class="lineno"> 7356</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a714c2bee7d6b39d4d6d304540c761352">Image</a>($tempfile_plain, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $type, $link, $align, $resize, <a class="code" href="../../d4/d40/classTCPDF.html#a22272525668774dab75d46dfd66ff2f2">$dpi</a>, $palign, <span class="keyword">false</span>, $imgmask);</div>
<div class="line"><a name="l07357"></a><span class="lineno"> 7357</span>&#160;        <span class="comment">// remove temp files</span></div>
<div class="line"><a name="l07358"></a><span class="lineno"> 7358</span>&#160;        unlink($tempfile_alpha);</div>
<div class="line"><a name="l07359"></a><span class="lineno"> 7359</span>&#160;        unlink($tempfile_plain);</div>
<div class="line"><a name="l07360"></a><span class="lineno"> 7360</span>&#160;    }</div>
<div class="line"><a name="l07361"></a><span class="lineno"> 7361</span>&#160;</div>
<div class="line"><a name="l07369"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aff67c582d024c7d0ee6b61d479710635"> 7369</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#aff67c582d024c7d0ee6b61d479710635">getGDgamma</a>($img, $c) {</div>
<div class="line"><a name="l07370"></a><span class="lineno"> 7370</span>&#160;        <span class="keywordflow">if</span> (!isset($this-&gt;gdgammacache[<span class="charliteral">&#39;#&#39;</span>.$c])) {</div>
<div class="line"><a name="l07371"></a><span class="lineno"> 7371</span>&#160;            $colors = imagecolorsforindex($img, $c);</div>
<div class="line"><a name="l07372"></a><span class="lineno"> 7372</span>&#160;            <span class="comment">// GD alpha is only 7 bit (0 -&gt; 127)</span></div>
<div class="line"><a name="l07373"></a><span class="lineno"> 7373</span>&#160;            $this-&gt;gdgammacache[<span class="charliteral">&#39;#&#39;</span>.$c] = (((127 - $colors[<span class="stringliteral">&#39;alpha&#39;</span>]) / 127) * 255);</div>
<div class="line"><a name="l07374"></a><span class="lineno"> 7374</span>&#160;            <span class="comment">// correct gamma</span></div>
<div class="line"><a name="l07375"></a><span class="lineno"> 7375</span>&#160;            $this-&gt;gdgammacache[<span class="charliteral">&#39;#&#39;</span>.$c] = (pow(($this-&gt;gdgammacache[<span class="charliteral">&#39;#&#39;</span>.$c] / 255), 2.2) * 255);</div>
<div class="line"><a name="l07376"></a><span class="lineno"> 7376</span>&#160;            <span class="comment">// store the latest values on cache to improve performances</span></div>
<div class="line"><a name="l07377"></a><span class="lineno"> 7377</span>&#160;            <span class="keywordflow">if</span> (count($this-&gt;gdgammacache) &gt; 8) {</div>
<div class="line"><a name="l07378"></a><span class="lineno"> 7378</span>&#160;                <span class="comment">// remove one element from the cache array</span></div>
<div class="line"><a name="l07379"></a><span class="lineno"> 7379</span>&#160;                array_shift($this-&gt;gdgammacache);</div>
<div class="line"><a name="l07380"></a><span class="lineno"> 7380</span>&#160;            }</div>
<div class="line"><a name="l07381"></a><span class="lineno"> 7381</span>&#160;        }</div>
<div class="line"><a name="l07382"></a><span class="lineno"> 7382</span>&#160;        <span class="keywordflow">return</span> $this-&gt;gdgammacache[<span class="charliteral">&#39;#&#39;</span>.$c];</div>
<div class="line"><a name="l07383"></a><span class="lineno"> 7383</span>&#160;    }</div>
<div class="line"><a name="l07384"></a><span class="lineno"> 7384</span>&#160;</div>
<div class="line"><a name="l07394"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a00969cf629d72b3d29ee435f15906820"> 7394</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a00969cf629d72b3d29ee435f15906820">Ln</a>(<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>=<span class="stringliteral">&#39;&#39;</span>, $cell=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l07395"></a><span class="lineno"> 7395</span>&#160;        <span class="keywordflow">if</span> (($this-&gt;num_columns &gt; 1) AND ($this-&gt;y == $this-&gt;columns[$this-&gt;current_column][<span class="charliteral">&#39;y&#39;</span>]) AND isset($this-&gt;columns[$this-&gt;current_column][<span class="charliteral">&#39;x&#39;</span>]) AND ($this-&gt;x == $this-&gt;columns[$this-&gt;current_column][<span class="charliteral">&#39;x&#39;</span>])) {</div>
<div class="line"><a name="l07396"></a><span class="lineno"> 7396</span>&#160;            <span class="comment">// revove vertical space from the top of the column</span></div>
<div class="line"><a name="l07397"></a><span class="lineno"> 7397</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l07398"></a><span class="lineno"> 7398</span>&#160;        }</div>
<div class="line"><a name="l07399"></a><span class="lineno"> 7399</span>&#160;        <span class="keywordflow">if</span> ($cell) {</div>
<div class="line"><a name="l07400"></a><span class="lineno"> 7400</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l07401"></a><span class="lineno"> 7401</span>&#160;                $cellpadding = $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>];</div>
<div class="line"><a name="l07402"></a><span class="lineno"> 7402</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l07403"></a><span class="lineno"> 7403</span>&#160;                $cellpadding = $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>];</div>
<div class="line"><a name="l07404"></a><span class="lineno"> 7404</span>&#160;            }</div>
<div class="line"><a name="l07405"></a><span class="lineno"> 7405</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l07406"></a><span class="lineno"> 7406</span>&#160;            $cellpadding = 0;</div>
<div class="line"><a name="l07407"></a><span class="lineno"> 7407</span>&#160;        }</div>
<div class="line"><a name="l07408"></a><span class="lineno"> 7408</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l07409"></a><span class="lineno"> 7409</span>&#160;            $this-&gt;x = $this-&gt;w - $this-&gt;rMargin - $cellpadding;</div>
<div class="line"><a name="l07410"></a><span class="lineno"> 7410</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l07411"></a><span class="lineno"> 7411</span>&#160;            $this-&gt;x = $this-&gt;lMargin + $cellpadding;</div>
<div class="line"><a name="l07412"></a><span class="lineno"> 7412</span>&#160;        }</div>
<div class="line"><a name="l07413"></a><span class="lineno"> 7413</span>&#160;        <span class="keywordflow">if</span> (is_string(<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>)) {</div>
<div class="line"><a name="l07414"></a><span class="lineno"> 7414</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> = <a class="code" href="../../d4/d40/classTCPDF.html#a41e87b05a84dd56c2c824af49470e295">$this-&gt;lasth</a>;</div>
<div class="line"><a name="l07415"></a><span class="lineno"> 7415</span>&#160;        }</div>
<div class="line"><a name="l07416"></a><span class="lineno"> 7416</span>&#160;        $this-&gt;y += <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>;</div>
<div class="line"><a name="l07417"></a><span class="lineno"> 7417</span>&#160;        $this-&gt;newline = <span class="keyword">true</span>;</div>
<div class="line"><a name="l07418"></a><span class="lineno"> 7418</span>&#160;    }</div>
<div class="line"><a name="l07419"></a><span class="lineno"> 7419</span>&#160;</div>
<div class="line"><a name="l07428"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a415a80a301208fa77552048b27d2e0ce"> 7428</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a415a80a301208fa77552048b27d2e0ce">GetX</a>() {</div>
<div class="line"><a name="l07429"></a><span class="lineno"> 7429</span>&#160;        <span class="comment">//Get x position</span></div>
<div class="line"><a name="l07430"></a><span class="lineno"> 7430</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l07431"></a><span class="lineno"> 7431</span>&#160;            <span class="keywordflow">return</span> ($this-&gt;w - $this-&gt;x);</div>
<div class="line"><a name="l07432"></a><span class="lineno"> 7432</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l07433"></a><span class="lineno"> 7433</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$this-&gt;x</a>;</div>
<div class="line"><a name="l07434"></a><span class="lineno"> 7434</span>&#160;        }</div>
<div class="line"><a name="l07435"></a><span class="lineno"> 7435</span>&#160;    }</div>
<div class="line"><a name="l07436"></a><span class="lineno"> 7436</span>&#160;</div>
<div class="line"><a name="l07444"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a5c834acaa7ef363abc6bca4ab8545432"> 7444</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a5c834acaa7ef363abc6bca4ab8545432">GetAbsX</a>() {</div>
<div class="line"><a name="l07445"></a><span class="lineno"> 7445</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$this-&gt;x</a>;</div>
<div class="line"><a name="l07446"></a><span class="lineno"> 7446</span>&#160;    }</div>
<div class="line"><a name="l07447"></a><span class="lineno"> 7447</span>&#160;</div>
<div class="line"><a name="l07455"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ae3b6169ba729309f289a5ac9680dd799"> 7455</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ae3b6169ba729309f289a5ac9680dd799">GetY</a>() {</div>
<div class="line"><a name="l07456"></a><span class="lineno"> 7456</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l07457"></a><span class="lineno"> 7457</span>&#160;    }</div>
<div class="line"><a name="l07458"></a><span class="lineno"> 7458</span>&#160;</div>
<div class="line"><a name="l07468"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a8d831d202e6420fe8fa6aeae7d3a2e8e"> 7468</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a8d831d202e6420fe8fa6aeae7d3a2e8e">SetX</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, $rtloff=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l07469"></a><span class="lineno"> 7469</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> = floatval(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>);</div>
<div class="line"><a name="l07470"></a><span class="lineno"> 7470</span>&#160;        <span class="keywordflow">if</span> (!$rtloff AND $this-&gt;rtl) {</div>
<div class="line"><a name="l07471"></a><span class="lineno"> 7471</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> &gt;= 0) {</div>
<div class="line"><a name="l07472"></a><span class="lineno"> 7472</span>&#160;                $this-&gt;x = $this-&gt;w - <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>;</div>
<div class="line"><a name="l07473"></a><span class="lineno"> 7473</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l07474"></a><span class="lineno"> 7474</span>&#160;                $this-&gt;x = abs(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>);</div>
<div class="line"><a name="l07475"></a><span class="lineno"> 7475</span>&#160;            }</div>
<div class="line"><a name="l07476"></a><span class="lineno"> 7476</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l07477"></a><span class="lineno"> 7477</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> &gt;= 0) {</div>
<div class="line"><a name="l07478"></a><span class="lineno"> 7478</span>&#160;                $this-&gt;x = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>;</div>
<div class="line"><a name="l07479"></a><span class="lineno"> 7479</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l07480"></a><span class="lineno"> 7480</span>&#160;                $this-&gt;x = $this-&gt;w + <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>;</div>
<div class="line"><a name="l07481"></a><span class="lineno"> 7481</span>&#160;            }</div>
<div class="line"><a name="l07482"></a><span class="lineno"> 7482</span>&#160;        }</div>
<div class="line"><a name="l07483"></a><span class="lineno"> 7483</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;x &lt; 0) {</div>
<div class="line"><a name="l07484"></a><span class="lineno"> 7484</span>&#160;            $this-&gt;x = 0;</div>
<div class="line"><a name="l07485"></a><span class="lineno"> 7485</span>&#160;        }</div>
<div class="line"><a name="l07486"></a><span class="lineno"> 7486</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;x &gt; $this-&gt;w) {</div>
<div class="line"><a name="l07487"></a><span class="lineno"> 7487</span>&#160;            $this-&gt;x = <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$this-&gt;w</a>;</div>
<div class="line"><a name="l07488"></a><span class="lineno"> 7488</span>&#160;        }</div>
<div class="line"><a name="l07489"></a><span class="lineno"> 7489</span>&#160;    }</div>
<div class="line"><a name="l07490"></a><span class="lineno"> 7490</span>&#160;</div>
<div class="line"><a name="l07501"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ad3439990de56253b039bca6a09305758"> 7501</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ad3439990de56253b039bca6a09305758">SetY</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, $resetx=<span class="keyword">true</span>, $rtloff=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l07502"></a><span class="lineno"> 7502</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> = floatval(<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>);</div>
<div class="line"><a name="l07503"></a><span class="lineno"> 7503</span>&#160;        <span class="keywordflow">if</span> ($resetx) {</div>
<div class="line"><a name="l07504"></a><span class="lineno"> 7504</span>&#160;            <span class="comment">//reset x</span></div>
<div class="line"><a name="l07505"></a><span class="lineno"> 7505</span>&#160;            <span class="keywordflow">if</span> (!$rtloff AND $this-&gt;rtl) {</div>
<div class="line"><a name="l07506"></a><span class="lineno"> 7506</span>&#160;                $this-&gt;x = $this-&gt;w - <a class="code" href="../../d4/d40/classTCPDF.html#a44fb75b85bea40ced25fdea9d89dc8e9">$this-&gt;rMargin</a>;</div>
<div class="line"><a name="l07507"></a><span class="lineno"> 7507</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l07508"></a><span class="lineno"> 7508</span>&#160;                $this-&gt;x = <a class="code" href="../../d4/d40/classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da">$this-&gt;lMargin</a>;</div>
<div class="line"><a name="l07509"></a><span class="lineno"> 7509</span>&#160;            }</div>
<div class="line"><a name="l07510"></a><span class="lineno"> 7510</span>&#160;        }</div>
<div class="line"><a name="l07511"></a><span class="lineno"> 7511</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> &gt;= 0) {</div>
<div class="line"><a name="l07512"></a><span class="lineno"> 7512</span>&#160;            $this-&gt;y = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>;</div>
<div class="line"><a name="l07513"></a><span class="lineno"> 7513</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l07514"></a><span class="lineno"> 7514</span>&#160;            $this-&gt;y = $this-&gt;h + <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>;</div>
<div class="line"><a name="l07515"></a><span class="lineno"> 7515</span>&#160;        }</div>
<div class="line"><a name="l07516"></a><span class="lineno"> 7516</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;y &lt; 0) {</div>
<div class="line"><a name="l07517"></a><span class="lineno"> 7517</span>&#160;            $this-&gt;y = 0;</div>
<div class="line"><a name="l07518"></a><span class="lineno"> 7518</span>&#160;        }</div>
<div class="line"><a name="l07519"></a><span class="lineno"> 7519</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;y &gt; $this-&gt;h) {</div>
<div class="line"><a name="l07520"></a><span class="lineno"> 7520</span>&#160;            $this-&gt;y = <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$this-&gt;h</a>;</div>
<div class="line"><a name="l07521"></a><span class="lineno"> 7521</span>&#160;        }</div>
<div class="line"><a name="l07522"></a><span class="lineno"> 7522</span>&#160;    }</div>
<div class="line"><a name="l07523"></a><span class="lineno"> 7523</span>&#160;</div>
<div class="line"><a name="l07534"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a00ec13928f57b17c21040acc881fe482"> 7534</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a00ec13928f57b17c21040acc881fe482">SetXY</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, $rtloff=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l07535"></a><span class="lineno"> 7535</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ad3439990de56253b039bca6a09305758">SetY</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <span class="keyword">false</span>, $rtloff);</div>
<div class="line"><a name="l07536"></a><span class="lineno"> 7536</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8d831d202e6420fe8fa6aeae7d3a2e8e">SetX</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, $rtloff);</div>
<div class="line"><a name="l07537"></a><span class="lineno"> 7537</span>&#160;    }</div>
<div class="line"><a name="l07538"></a><span class="lineno"> 7538</span>&#160;</div>
<div class="line"><a name="l07546"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a2c5467db3b3e3b9261be1914b9ec1991"> 7546</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a2c5467db3b3e3b9261be1914b9ec1991">SetAbsX</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>) {</div>
<div class="line"><a name="l07547"></a><span class="lineno"> 7547</span>&#160;        $this-&gt;x = floatval(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>);</div>
<div class="line"><a name="l07548"></a><span class="lineno"> 7548</span>&#160;    }</div>
<div class="line"><a name="l07549"></a><span class="lineno"> 7549</span>&#160;</div>
<div class="line"><a name="l07557"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a841a13b219f66597674ebac87deb03bb"> 7557</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a841a13b219f66597674ebac87deb03bb">SetAbsY</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>) {</div>
<div class="line"><a name="l07558"></a><span class="lineno"> 7558</span>&#160;        $this-&gt;y = floatval(<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>);</div>
<div class="line"><a name="l07559"></a><span class="lineno"> 7559</span>&#160;    }</div>
<div class="line"><a name="l07560"></a><span class="lineno"> 7560</span>&#160;</div>
<div class="line"><a name="l07569"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aee936c5d712d93615fff662e6393316a"> 7569</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#aee936c5d712d93615fff662e6393316a">SetAbsXY</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>) {</div>
<div class="line"><a name="l07570"></a><span class="lineno"> 7570</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a2c5467db3b3e3b9261be1914b9ec1991">SetAbsX</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>);</div>
<div class="line"><a name="l07571"></a><span class="lineno"> 7571</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a841a13b219f66597674ebac87deb03bb">SetAbsY</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>);</div>
<div class="line"><a name="l07572"></a><span class="lineno"> 7572</span>&#160;    }</div>
<div class="line"><a name="l07573"></a><span class="lineno"> 7573</span>&#160;</div>
<div class="line"><a name="l07584"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a3d6dcb62298ec9d42e9125ee2f5b23a1"> 7584</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a3d6dcb62298ec9d42e9125ee2f5b23a1">Output</a>($name=<span class="stringliteral">&#39;doc.pdf&#39;</span>, $dest=<span class="charliteral">&#39;I&#39;</span>) {</div>
<div class="line"><a name="l07585"></a><span class="lineno"> 7585</span>&#160;        <span class="comment">//Output PDF to some destination</span></div>
<div class="line"><a name="l07586"></a><span class="lineno"> 7586</span>&#160;        <span class="comment">//Finish document if necessary</span></div>
<div class="line"><a name="l07587"></a><span class="lineno"> 7587</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;state &lt; 3) {</div>
<div class="line"><a name="l07588"></a><span class="lineno"> 7588</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a2ea842192062587293c25981098c820c">Close</a>();</div>
<div class="line"><a name="l07589"></a><span class="lineno"> 7589</span>&#160;        }</div>
<div class="line"><a name="l07590"></a><span class="lineno"> 7590</span>&#160;        <span class="comment">//Normalize parameters</span></div>
<div class="line"><a name="l07591"></a><span class="lineno"> 7591</span>&#160;        <span class="keywordflow">if</span> (is_bool($dest)) {</div>
<div class="line"><a name="l07592"></a><span class="lineno"> 7592</span>&#160;            $dest = $dest ? <span class="charliteral">&#39;D&#39;</span> : <span class="charliteral">&#39;F&#39;</span>;</div>
<div class="line"><a name="l07593"></a><span class="lineno"> 7593</span>&#160;        }</div>
<div class="line"><a name="l07594"></a><span class="lineno"> 7594</span>&#160;        $dest = strtoupper($dest);</div>
<div class="line"><a name="l07595"></a><span class="lineno"> 7595</span>&#160;        <span class="keywordflow">if</span> ($dest[0] != <span class="charliteral">&#39;F&#39;</span>) {</div>
<div class="line"><a name="l07596"></a><span class="lineno"> 7596</span>&#160;            $name = preg_replace(<span class="stringliteral">&#39;/[\s]+/&#39;</span>, <span class="charliteral">&#39;_&#39;</span>, $name);</div>
<div class="line"><a name="l07597"></a><span class="lineno"> 7597</span>&#160;            $name = preg_replace(<span class="stringliteral">&#39;/[^a-zA-Z0-9_\.-]/&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $name);</div>
<div class="line"><a name="l07598"></a><span class="lineno"> 7598</span>&#160;        }</div>
<div class="line"><a name="l07599"></a><span class="lineno"> 7599</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;sign) {</div>
<div class="line"><a name="l07600"></a><span class="lineno"> 7600</span>&#160;            <span class="comment">// *** apply digital signature to the document ***</span></div>
<div class="line"><a name="l07601"></a><span class="lineno"> 7601</span>&#160;            <span class="comment">// get the document content</span></div>
<div class="line"><a name="l07602"></a><span class="lineno"> 7602</span>&#160;            $pdfdoc = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a24b714e8e56b4f8672886180e5037cd7">getBuffer</a>();</div>
<div class="line"><a name="l07603"></a><span class="lineno"> 7603</span>&#160;            <span class="comment">// remove last newline</span></div>
<div class="line"><a name="l07604"></a><span class="lineno"> 7604</span>&#160;            $pdfdoc = substr($pdfdoc, 0, -1);</div>
<div class="line"><a name="l07605"></a><span class="lineno"> 7605</span>&#160;            <span class="comment">// Remove the original buffer</span></div>
<div class="line"><a name="l07606"></a><span class="lineno"> 7606</span>&#160;            <span class="keywordflow">if</span> (isset($this-&gt;diskcache) AND $this-&gt;diskcache) {</div>
<div class="line"><a name="l07607"></a><span class="lineno"> 7607</span>&#160;                <span class="comment">// remove buffer file from cache</span></div>
<div class="line"><a name="l07608"></a><span class="lineno"> 7608</span>&#160;                unlink($this-&gt;buffer);</div>
<div class="line"><a name="l07609"></a><span class="lineno"> 7609</span>&#160;            }</div>
<div class="line"><a name="l07610"></a><span class="lineno"> 7610</span>&#160;            unset($this-&gt;buffer);</div>
<div class="line"><a name="l07611"></a><span class="lineno"> 7611</span>&#160;            <span class="comment">// remove filler space</span></div>
<div class="line"><a name="l07612"></a><span class="lineno"> 7612</span>&#160;            $byterange_string_len = strlen(TCPDF_STATIC::$byterange_string);</div>
<div class="line"><a name="l07613"></a><span class="lineno"> 7613</span>&#160;            <span class="comment">// define the ByteRange</span></div>
<div class="line"><a name="l07614"></a><span class="lineno"> 7614</span>&#160;            $byte_range = array();</div>
<div class="line"><a name="l07615"></a><span class="lineno"> 7615</span>&#160;            $byte_range[0] = 0;</div>
<div class="line"><a name="l07616"></a><span class="lineno"> 7616</span>&#160;            $byte_range[1] = strpos($pdfdoc, TCPDF_STATIC::$byterange_string) + $byterange_string_len + 10;</div>
<div class="line"><a name="l07617"></a><span class="lineno"> 7617</span>&#160;            $byte_range[2] = $byte_range[1] + $this-&gt;signature_max_length + 2;</div>
<div class="line"><a name="l07618"></a><span class="lineno"> 7618</span>&#160;            $byte_range[3] = strlen($pdfdoc) - $byte_range[2];</div>
<div class="line"><a name="l07619"></a><span class="lineno"> 7619</span>&#160;            $pdfdoc = substr($pdfdoc, 0, $byte_range[1]).substr($pdfdoc, $byte_range[2]);</div>
<div class="line"><a name="l07620"></a><span class="lineno"> 7620</span>&#160;            <span class="comment">// replace the ByteRange</span></div>
<div class="line"><a name="l07621"></a><span class="lineno"> 7621</span>&#160;            $byterange = sprintf(<span class="stringliteral">&#39;/ByteRange[0 %u %u %u]&#39;</span>, $byte_range[1], $byte_range[2], $byte_range[3]);</div>
<div class="line"><a name="l07622"></a><span class="lineno"> 7622</span>&#160;            $byterange .= str_repeat(<span class="charliteral">&#39; &#39;</span>, ($byterange_string_len - strlen($byterange)));</div>
<div class="line"><a name="l07623"></a><span class="lineno"> 7623</span>&#160;            $pdfdoc = str_replace(TCPDF_STATIC::$byterange_string, $byterange, $pdfdoc);</div>
<div class="line"><a name="l07624"></a><span class="lineno"> 7624</span>&#160;            <span class="comment">// write the document to a temporary folder</span></div>
<div class="line"><a name="l07625"></a><span class="lineno"> 7625</span>&#160;            $tempdoc = TCPDF_STATIC::getObjFilename(<span class="stringliteral">&#39;doc&#39;</span>);</div>
<div class="line"><a name="l07626"></a><span class="lineno"> 7626</span>&#160;            $f = fopen($tempdoc, <span class="stringliteral">&#39;wb&#39;</span>);</div>
<div class="line"><a name="l07627"></a><span class="lineno"> 7627</span>&#160;            <span class="keywordflow">if</span> (!$f) {</div>
<div class="line"><a name="l07628"></a><span class="lineno"> 7628</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;Unable to create temporary file: &#39;</span>.$tempdoc);</div>
<div class="line"><a name="l07629"></a><span class="lineno"> 7629</span>&#160;            }</div>
<div class="line"><a name="l07630"></a><span class="lineno"> 7630</span>&#160;            $pdfdoc_length = strlen($pdfdoc);</div>
<div class="line"><a name="l07631"></a><span class="lineno"> 7631</span>&#160;            fwrite($f, $pdfdoc, $pdfdoc_length);</div>
<div class="line"><a name="l07632"></a><span class="lineno"> 7632</span>&#160;            fclose($f);</div>
<div class="line"><a name="l07633"></a><span class="lineno"> 7633</span>&#160;            <span class="comment">// get digital signature via openssl library</span></div>
<div class="line"><a name="l07634"></a><span class="lineno"> 7634</span>&#160;            $tempsign = TCPDF_STATIC::getObjFilename(<span class="stringliteral">&#39;sig&#39;</span>);</div>
<div class="line"><a name="l07635"></a><span class="lineno"> 7635</span>&#160;            <span class="keywordflow">if</span> (empty($this-&gt;signature_data[<span class="stringliteral">&#39;extracerts&#39;</span>])) {</div>
<div class="line"><a name="l07636"></a><span class="lineno"> 7636</span>&#160;                openssl_pkcs7_sign($tempdoc, $tempsign, $this-&gt;signature_data[<span class="stringliteral">&#39;signcert&#39;</span>], array($this-&gt;signature_data[<span class="stringliteral">&#39;privkey&#39;</span>], $this-&gt;signature_data[<span class="stringliteral">&#39;password&#39;</span>]), array(), PKCS7_BINARY | PKCS7_DETACHED);</div>
<div class="line"><a name="l07637"></a><span class="lineno"> 7637</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l07638"></a><span class="lineno"> 7638</span>&#160;                openssl_pkcs7_sign($tempdoc, $tempsign, $this-&gt;signature_data[<span class="stringliteral">&#39;signcert&#39;</span>], array($this-&gt;signature_data[<span class="stringliteral">&#39;privkey&#39;</span>], $this-&gt;signature_data[<span class="stringliteral">&#39;password&#39;</span>]), array(), PKCS7_BINARY | PKCS7_DETACHED, $this-&gt;signature_data[<span class="stringliteral">&#39;extracerts&#39;</span>]);</div>
<div class="line"><a name="l07639"></a><span class="lineno"> 7639</span>&#160;            }</div>
<div class="line"><a name="l07640"></a><span class="lineno"> 7640</span>&#160;            unlink($tempdoc);</div>
<div class="line"><a name="l07641"></a><span class="lineno"> 7641</span>&#160;            <span class="comment">// read signature</span></div>
<div class="line"><a name="l07642"></a><span class="lineno"> 7642</span>&#160;            $signature = file_get_contents($tempsign);</div>
<div class="line"><a name="l07643"></a><span class="lineno"> 7643</span>&#160;            unlink($tempsign);</div>
<div class="line"><a name="l07644"></a><span class="lineno"> 7644</span>&#160;            <span class="comment">// extract signature</span></div>
<div class="line"><a name="l07645"></a><span class="lineno"> 7645</span>&#160;            $signature = substr($signature, $pdfdoc_length);</div>
<div class="line"><a name="l07646"></a><span class="lineno"> 7646</span>&#160;            $signature = substr($signature, (strpos($signature, <span class="stringliteral">&quot;%%EOF\n\n------&quot;</span>) + 13));</div>
<div class="line"><a name="l07647"></a><span class="lineno"> 7647</span>&#160;            $tmparr = explode(<span class="stringliteral">&quot;\n\n&quot;</span>, $signature);</div>
<div class="line"><a name="l07648"></a><span class="lineno"> 7648</span>&#160;            $signature = $tmparr[1];</div>
<div class="line"><a name="l07649"></a><span class="lineno"> 7649</span>&#160;            unset($tmparr);</div>
<div class="line"><a name="l07650"></a><span class="lineno"> 7650</span>&#160;            <span class="comment">// decode signature</span></div>
<div class="line"><a name="l07651"></a><span class="lineno"> 7651</span>&#160;            $signature = base64_decode(trim($signature));</div>
<div class="line"><a name="l07652"></a><span class="lineno"> 7652</span>&#160;            <span class="comment">// add TSA timestamp to signature</span></div>
<div class="line"><a name="l07653"></a><span class="lineno"> 7653</span>&#160;            $signature = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aef2a1b2504a6605d63e5851c01839149">applyTSA</a>($signature);</div>
<div class="line"><a name="l07654"></a><span class="lineno"> 7654</span>&#160;            <span class="comment">// convert signature to hex</span></div>
<div class="line"><a name="l07655"></a><span class="lineno"> 7655</span>&#160;            $signature = current(unpack(<span class="stringliteral">&#39;H*&#39;</span>, $signature));</div>
<div class="line"><a name="l07656"></a><span class="lineno"> 7656</span>&#160;            $signature = str_pad($signature, $this-&gt;signature_max_length, <span class="charliteral">&#39;0&#39;</span>);</div>
<div class="line"><a name="l07657"></a><span class="lineno"> 7657</span>&#160;            <span class="comment">// disable disk caching</span></div>
<div class="line"><a name="l07658"></a><span class="lineno"> 7658</span>&#160;            $this-&gt;diskcache = <span class="keyword">false</span>;</div>
<div class="line"><a name="l07659"></a><span class="lineno"> 7659</span>&#160;            <span class="comment">// Add signature to the document</span></div>
<div class="line"><a name="l07660"></a><span class="lineno"> 7660</span>&#160;            $this-&gt;buffer = substr($pdfdoc, 0, $byte_range[1]).<span class="charliteral">&#39;&lt;&#39;</span>.$signature.<span class="charliteral">&#39;&gt;&#39;</span>.substr($pdfdoc, $byte_range[1]);</div>
<div class="line"><a name="l07661"></a><span class="lineno"> 7661</span>&#160;            $this-&gt;bufferlen = strlen($this-&gt;buffer);</div>
<div class="line"><a name="l07662"></a><span class="lineno"> 7662</span>&#160;        }</div>
<div class="line"><a name="l07663"></a><span class="lineno"> 7663</span>&#160;        <span class="keywordflow">switch</span>($dest) {</div>
<div class="line"><a name="l07664"></a><span class="lineno"> 7664</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;I&#39;</span>: {</div>
<div class="line"><a name="l07665"></a><span class="lineno"> 7665</span>&#160;                <span class="comment">// Send PDF to the standard output</span></div>
<div class="line"><a name="l07666"></a><span class="lineno"> 7666</span>&#160;                <span class="keywordflow">if</span> (ob_get_contents()) {</div>
<div class="line"><a name="l07667"></a><span class="lineno"> 7667</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;Some data has already been output, can\&#39;t send PDF file&#39;</span>);</div>
<div class="line"><a name="l07668"></a><span class="lineno"> 7668</span>&#160;                }</div>
<div class="line"><a name="l07669"></a><span class="lineno"> 7669</span>&#160;                <span class="keywordflow">if</span> (php_sapi_name() != <span class="stringliteral">&#39;cli&#39;</span>) {</div>
<div class="line"><a name="l07670"></a><span class="lineno"> 7670</span>&#160;                    <span class="comment">// send output to a browser</span></div>
<div class="line"><a name="l07671"></a><span class="lineno"> 7671</span>&#160;                    header(<span class="stringliteral">&#39;Content-Type: application/pdf&#39;</span>);</div>
<div class="line"><a name="l07672"></a><span class="lineno"> 7672</span>&#160;                    <span class="keywordflow">if</span> (headers_sent()) {</div>
<div class="line"><a name="l07673"></a><span class="lineno"> 7673</span>&#160;                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;Some data has already been output to browser, can\&#39;t send PDF file&#39;</span>);</div>
<div class="line"><a name="l07674"></a><span class="lineno"> 7674</span>&#160;                    }</div>
<div class="line"><a name="l07675"></a><span class="lineno"> 7675</span>&#160;                    header(<span class="stringliteral">&#39;Cache-Control: private, must-revalidate, post-check=0, pre-check=0, max-age=1&#39;</span>);</div>
<div class="line"><a name="l07676"></a><span class="lineno"> 7676</span>&#160;                    <span class="comment">//header(&#39;Cache-Control: public, must-revalidate, max-age=0&#39;); // HTTP/1.1</span></div>
<div class="line"><a name="l07677"></a><span class="lineno"> 7677</span>&#160;                    header(<span class="stringliteral">&#39;Pragma: public&#39;</span>);</div>
<div class="line"><a name="l07678"></a><span class="lineno"> 7678</span>&#160;                    header(<span class="stringliteral">&#39;Expires: Sat, 26 Jul 1997 05:00:00 GMT&#39;</span>); <span class="comment">// Date in the past</span></div>
<div class="line"><a name="l07679"></a><span class="lineno"> 7679</span>&#160;                    header(<span class="stringliteral">&#39;Last-Modified: &#39;</span>.gmdate(<span class="stringliteral">&#39;D, d M Y H:i:s&#39;</span>).<span class="stringliteral">&#39; GMT&#39;</span>);</div>
<div class="line"><a name="l07680"></a><span class="lineno"> 7680</span>&#160;                    header(<span class="stringliteral">&#39;Content-Disposition: inline; filename=&quot;&#39;</span>.basename($name).<span class="charliteral">&#39;&quot;&#39;</span>);</div>
<div class="line"><a name="l07681"></a><span class="lineno"> 7681</span>&#160;                    TCPDF_STATIC::sendOutputData($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a24b714e8e56b4f8672886180e5037cd7">getBuffer</a>(), $this-&gt;bufferlen);</div>
<div class="line"><a name="l07682"></a><span class="lineno"> 7682</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l07683"></a><span class="lineno"> 7683</span>&#160;                    echo $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a24b714e8e56b4f8672886180e5037cd7">getBuffer</a>();</div>
<div class="line"><a name="l07684"></a><span class="lineno"> 7684</span>&#160;                }</div>
<div class="line"><a name="l07685"></a><span class="lineno"> 7685</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l07686"></a><span class="lineno"> 7686</span>&#160;            }</div>
<div class="line"><a name="l07687"></a><span class="lineno"> 7687</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;D&#39;</span>: {</div>
<div class="line"><a name="l07688"></a><span class="lineno"> 7688</span>&#160;                <span class="comment">// download PDF as file</span></div>
<div class="line"><a name="l07689"></a><span class="lineno"> 7689</span>&#160;                <span class="keywordflow">if</span> (ob_get_contents()) {</div>
<div class="line"><a name="l07690"></a><span class="lineno"> 7690</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;Some data has already been output, can\&#39;t send PDF file&#39;</span>);</div>
<div class="line"><a name="l07691"></a><span class="lineno"> 7691</span>&#160;                }</div>
<div class="line"><a name="l07692"></a><span class="lineno"> 7692</span>&#160;                header(<span class="stringliteral">&#39;Content-Description: File Transfer&#39;</span>);</div>
<div class="line"><a name="l07693"></a><span class="lineno"> 7693</span>&#160;                <span class="keywordflow">if</span> (headers_sent()) {</div>
<div class="line"><a name="l07694"></a><span class="lineno"> 7694</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;Some data has already been output to browser, can\&#39;t send PDF file&#39;</span>);</div>
<div class="line"><a name="l07695"></a><span class="lineno"> 7695</span>&#160;                }</div>
<div class="line"><a name="l07696"></a><span class="lineno"> 7696</span>&#160;                header(<span class="stringliteral">&#39;Cache-Control: private, must-revalidate, post-check=0, pre-check=0, max-age=1&#39;</span>);</div>
<div class="line"><a name="l07697"></a><span class="lineno"> 7697</span>&#160;                <span class="comment">//header(&#39;Cache-Control: public, must-revalidate, max-age=0&#39;); // HTTP/1.1</span></div>
<div class="line"><a name="l07698"></a><span class="lineno"> 7698</span>&#160;                header(<span class="stringliteral">&#39;Pragma: public&#39;</span>);</div>
<div class="line"><a name="l07699"></a><span class="lineno"> 7699</span>&#160;                header(<span class="stringliteral">&#39;Expires: Sat, 26 Jul 1997 05:00:00 GMT&#39;</span>); <span class="comment">// Date in the past</span></div>
<div class="line"><a name="l07700"></a><span class="lineno"> 7700</span>&#160;                header(<span class="stringliteral">&#39;Last-Modified: &#39;</span>.gmdate(<span class="stringliteral">&#39;D, d M Y H:i:s&#39;</span>).<span class="stringliteral">&#39; GMT&#39;</span>);</div>
<div class="line"><a name="l07701"></a><span class="lineno"> 7701</span>&#160;                <span class="comment">// force download dialog</span></div>
<div class="line"><a name="l07702"></a><span class="lineno"> 7702</span>&#160;                <span class="keywordflow">if</span> (strpos(php_sapi_name(), <span class="stringliteral">&#39;cgi&#39;</span>) === <span class="keyword">false</span>) {</div>
<div class="line"><a name="l07703"></a><span class="lineno"> 7703</span>&#160;                    header(<span class="stringliteral">&#39;Content-Type: application/force-download&#39;</span>);</div>
<div class="line"><a name="l07704"></a><span class="lineno"> 7704</span>&#160;                    header(<span class="stringliteral">&#39;Content-Type: application/octet-stream&#39;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l07705"></a><span class="lineno"> 7705</span>&#160;                    header(<span class="stringliteral">&#39;Content-Type: application/download&#39;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l07706"></a><span class="lineno"> 7706</span>&#160;                    header(<span class="stringliteral">&#39;Content-Type: application/pdf&#39;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l07707"></a><span class="lineno"> 7707</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l07708"></a><span class="lineno"> 7708</span>&#160;                    header(<span class="stringliteral">&#39;Content-Type: application/pdf&#39;</span>);</div>
<div class="line"><a name="l07709"></a><span class="lineno"> 7709</span>&#160;                }</div>
<div class="line"><a name="l07710"></a><span class="lineno"> 7710</span>&#160;                <span class="comment">// use the Content-Disposition header to supply a recommended filename</span></div>
<div class="line"><a name="l07711"></a><span class="lineno"> 7711</span>&#160;                header(<span class="stringliteral">&#39;Content-Disposition: attachment; filename=&quot;&#39;</span>.basename($name).<span class="charliteral">&#39;&quot;&#39;</span>);</div>
<div class="line"><a name="l07712"></a><span class="lineno"> 7712</span>&#160;                header(<span class="stringliteral">&#39;Content-Transfer-Encoding: binary&#39;</span>);</div>
<div class="line"><a name="l07713"></a><span class="lineno"> 7713</span>&#160;                TCPDF_STATIC::sendOutputData($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a24b714e8e56b4f8672886180e5037cd7">getBuffer</a>(), $this-&gt;bufferlen);</div>
<div class="line"><a name="l07714"></a><span class="lineno"> 7714</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l07715"></a><span class="lineno"> 7715</span>&#160;            }</div>
<div class="line"><a name="l07716"></a><span class="lineno"> 7716</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;F&#39;</span>:</div>
<div class="line"><a name="l07717"></a><span class="lineno"> 7717</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;FI&#39;</span>:</div>
<div class="line"><a name="l07718"></a><span class="lineno"> 7718</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;FD&#39;</span>: {</div>
<div class="line"><a name="l07719"></a><span class="lineno"> 7719</span>&#160;                <span class="comment">// save PDF to a local file</span></div>
<div class="line"><a name="l07720"></a><span class="lineno"> 7720</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;diskcache) {</div>
<div class="line"><a name="l07721"></a><span class="lineno"> 7721</span>&#160;                    copy($this-&gt;buffer, $name);</div>
<div class="line"><a name="l07722"></a><span class="lineno"> 7722</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l07723"></a><span class="lineno"> 7723</span>&#160;                    $f = fopen($name, <span class="stringliteral">&#39;wb&#39;</span>);</div>
<div class="line"><a name="l07724"></a><span class="lineno"> 7724</span>&#160;                    <span class="keywordflow">if</span> (!$f) {</div>
<div class="line"><a name="l07725"></a><span class="lineno"> 7725</span>&#160;                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;Unable to create output file: &#39;</span>.$name);</div>
<div class="line"><a name="l07726"></a><span class="lineno"> 7726</span>&#160;                    }</div>
<div class="line"><a name="l07727"></a><span class="lineno"> 7727</span>&#160;                    fwrite($f, $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a24b714e8e56b4f8672886180e5037cd7">getBuffer</a>(), $this-&gt;bufferlen);</div>
<div class="line"><a name="l07728"></a><span class="lineno"> 7728</span>&#160;                    fclose($f);</div>
<div class="line"><a name="l07729"></a><span class="lineno"> 7729</span>&#160;                }</div>
<div class="line"><a name="l07730"></a><span class="lineno"> 7730</span>&#160;                <span class="keywordflow">if</span> ($dest == <span class="stringliteral">&#39;FI&#39;</span>) {</div>
<div class="line"><a name="l07731"></a><span class="lineno"> 7731</span>&#160;                    <span class="comment">// send headers to browser</span></div>
<div class="line"><a name="l07732"></a><span class="lineno"> 7732</span>&#160;                    header(<span class="stringliteral">&#39;Content-Type: application/pdf&#39;</span>);</div>
<div class="line"><a name="l07733"></a><span class="lineno"> 7733</span>&#160;                    header(<span class="stringliteral">&#39;Cache-Control: private, must-revalidate, post-check=0, pre-check=0, max-age=1&#39;</span>);</div>
<div class="line"><a name="l07734"></a><span class="lineno"> 7734</span>&#160;                    <span class="comment">//header(&#39;Cache-Control: public, must-revalidate, max-age=0&#39;); // HTTP/1.1</span></div>
<div class="line"><a name="l07735"></a><span class="lineno"> 7735</span>&#160;                    header(<span class="stringliteral">&#39;Pragma: public&#39;</span>);</div>
<div class="line"><a name="l07736"></a><span class="lineno"> 7736</span>&#160;                    header(<span class="stringliteral">&#39;Expires: Sat, 26 Jul 1997 05:00:00 GMT&#39;</span>); <span class="comment">// Date in the past</span></div>
<div class="line"><a name="l07737"></a><span class="lineno"> 7737</span>&#160;                    header(<span class="stringliteral">&#39;Last-Modified: &#39;</span>.gmdate(<span class="stringliteral">&#39;D, d M Y H:i:s&#39;</span>).<span class="stringliteral">&#39; GMT&#39;</span>);</div>
<div class="line"><a name="l07738"></a><span class="lineno"> 7738</span>&#160;                    header(<span class="stringliteral">&#39;Content-Disposition: inline; filename=&quot;&#39;</span>.basename($name).<span class="charliteral">&#39;&quot;&#39;</span>);</div>
<div class="line"><a name="l07739"></a><span class="lineno"> 7739</span>&#160;                    TCPDF_STATIC::sendOutputData(file_get_contents($name), filesize($name));</div>
<div class="line"><a name="l07740"></a><span class="lineno"> 7740</span>&#160;                } elseif ($dest == <span class="stringliteral">&#39;FD&#39;</span>) {</div>
<div class="line"><a name="l07741"></a><span class="lineno"> 7741</span>&#160;                    <span class="comment">// send headers to browser</span></div>
<div class="line"><a name="l07742"></a><span class="lineno"> 7742</span>&#160;                    <span class="keywordflow">if</span> (ob_get_contents()) {</div>
<div class="line"><a name="l07743"></a><span class="lineno"> 7743</span>&#160;                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;Some data has already been output, can\&#39;t send PDF file&#39;</span>);</div>
<div class="line"><a name="l07744"></a><span class="lineno"> 7744</span>&#160;                    }</div>
<div class="line"><a name="l07745"></a><span class="lineno"> 7745</span>&#160;                    header(<span class="stringliteral">&#39;Content-Description: File Transfer&#39;</span>);</div>
<div class="line"><a name="l07746"></a><span class="lineno"> 7746</span>&#160;                    <span class="keywordflow">if</span> (headers_sent()) {</div>
<div class="line"><a name="l07747"></a><span class="lineno"> 7747</span>&#160;                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;Some data has already been output to browser, can\&#39;t send PDF file&#39;</span>);</div>
<div class="line"><a name="l07748"></a><span class="lineno"> 7748</span>&#160;                    }</div>
<div class="line"><a name="l07749"></a><span class="lineno"> 7749</span>&#160;                    header(<span class="stringliteral">&#39;Cache-Control: private, must-revalidate, post-check=0, pre-check=0, max-age=1&#39;</span>);</div>
<div class="line"><a name="l07750"></a><span class="lineno"> 7750</span>&#160;                    header(<span class="stringliteral">&#39;Pragma: public&#39;</span>);</div>
<div class="line"><a name="l07751"></a><span class="lineno"> 7751</span>&#160;                    header(<span class="stringliteral">&#39;Expires: Sat, 26 Jul 1997 05:00:00 GMT&#39;</span>); <span class="comment">// Date in the past</span></div>
<div class="line"><a name="l07752"></a><span class="lineno"> 7752</span>&#160;                    header(<span class="stringliteral">&#39;Last-Modified: &#39;</span>.gmdate(<span class="stringliteral">&#39;D, d M Y H:i:s&#39;</span>).<span class="stringliteral">&#39; GMT&#39;</span>);</div>
<div class="line"><a name="l07753"></a><span class="lineno"> 7753</span>&#160;                    <span class="comment">// force download dialog</span></div>
<div class="line"><a name="l07754"></a><span class="lineno"> 7754</span>&#160;                    <span class="keywordflow">if</span> (strpos(php_sapi_name(), <span class="stringliteral">&#39;cgi&#39;</span>) === <span class="keyword">false</span>) {</div>
<div class="line"><a name="l07755"></a><span class="lineno"> 7755</span>&#160;                        header(<span class="stringliteral">&#39;Content-Type: application/force-download&#39;</span>);</div>
<div class="line"><a name="l07756"></a><span class="lineno"> 7756</span>&#160;                        header(<span class="stringliteral">&#39;Content-Type: application/octet-stream&#39;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l07757"></a><span class="lineno"> 7757</span>&#160;                        header(<span class="stringliteral">&#39;Content-Type: application/download&#39;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l07758"></a><span class="lineno"> 7758</span>&#160;                        header(<span class="stringliteral">&#39;Content-Type: application/pdf&#39;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l07759"></a><span class="lineno"> 7759</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l07760"></a><span class="lineno"> 7760</span>&#160;                        header(<span class="stringliteral">&#39;Content-Type: application/pdf&#39;</span>);</div>
<div class="line"><a name="l07761"></a><span class="lineno"> 7761</span>&#160;                    }</div>
<div class="line"><a name="l07762"></a><span class="lineno"> 7762</span>&#160;                    <span class="comment">// use the Content-Disposition header to supply a recommended filename</span></div>
<div class="line"><a name="l07763"></a><span class="lineno"> 7763</span>&#160;                    header(<span class="stringliteral">&#39;Content-Disposition: attachment; filename=&quot;&#39;</span>.basename($name).<span class="charliteral">&#39;&quot;&#39;</span>);</div>
<div class="line"><a name="l07764"></a><span class="lineno"> 7764</span>&#160;                    header(<span class="stringliteral">&#39;Content-Transfer-Encoding: binary&#39;</span>);</div>
<div class="line"><a name="l07765"></a><span class="lineno"> 7765</span>&#160;                    TCPDF_STATIC::sendOutputData(file_get_contents($name), filesize($name));</div>
<div class="line"><a name="l07766"></a><span class="lineno"> 7766</span>&#160;                }</div>
<div class="line"><a name="l07767"></a><span class="lineno"> 7767</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l07768"></a><span class="lineno"> 7768</span>&#160;            }</div>
<div class="line"><a name="l07769"></a><span class="lineno"> 7769</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;E&#39;</span>: {</div>
<div class="line"><a name="l07770"></a><span class="lineno"> 7770</span>&#160;                <span class="comment">// return PDF as base64 mime multi-part email attachment (RFC 2045)</span></div>
<div class="line"><a name="l07771"></a><span class="lineno"> 7771</span>&#160;                $retval = <span class="stringliteral">&#39;Content-Type: application/pdf;&#39;</span>.<span class="stringliteral">&quot;\r\n&quot;</span>;</div>
<div class="line"><a name="l07772"></a><span class="lineno"> 7772</span>&#160;                $retval .= <span class="stringliteral">&#39; name=&quot;&#39;</span>.$name.<span class="charliteral">&#39;&quot;&#39;</span>.<span class="stringliteral">&quot;\r\n&quot;</span>;</div>
<div class="line"><a name="l07773"></a><span class="lineno"> 7773</span>&#160;                $retval .= <span class="stringliteral">&#39;Content-Transfer-Encoding: base64&#39;</span>.<span class="stringliteral">&quot;\r\n&quot;</span>;</div>
<div class="line"><a name="l07774"></a><span class="lineno"> 7774</span>&#160;                $retval .= <span class="stringliteral">&#39;Content-Disposition: attachment;&#39;</span>.<span class="stringliteral">&quot;\r\n&quot;</span>;</div>
<div class="line"><a name="l07775"></a><span class="lineno"> 7775</span>&#160;                $retval .= <span class="stringliteral">&#39; filename=&quot;&#39;</span>.$name.<span class="charliteral">&#39;&quot;&#39;</span>.<span class="stringliteral">&quot;\r\n\r\n&quot;</span>;</div>
<div class="line"><a name="l07776"></a><span class="lineno"> 7776</span>&#160;                $retval .= chunk_split(base64_encode($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a24b714e8e56b4f8672886180e5037cd7">getBuffer</a>()), 76, <span class="stringliteral">&quot;\r\n&quot;</span>);</div>
<div class="line"><a name="l07777"></a><span class="lineno"> 7777</span>&#160;                <span class="keywordflow">return</span> $retval;</div>
<div class="line"><a name="l07778"></a><span class="lineno"> 7778</span>&#160;            }</div>
<div class="line"><a name="l07779"></a><span class="lineno"> 7779</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;S&#39;</span>: {</div>
<div class="line"><a name="l07780"></a><span class="lineno"> 7780</span>&#160;                <span class="comment">// returns PDF as a string</span></div>
<div class="line"><a name="l07781"></a><span class="lineno"> 7781</span>&#160;                <span class="keywordflow">return</span> $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a24b714e8e56b4f8672886180e5037cd7">getBuffer</a>();</div>
<div class="line"><a name="l07782"></a><span class="lineno"> 7782</span>&#160;            }</div>
<div class="line"><a name="l07783"></a><span class="lineno"> 7783</span>&#160;            <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l07784"></a><span class="lineno"> 7784</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;Incorrect output destination: &#39;</span>.$dest);</div>
<div class="line"><a name="l07785"></a><span class="lineno"> 7785</span>&#160;            }</div>
<div class="line"><a name="l07786"></a><span class="lineno"> 7786</span>&#160;        }</div>
<div class="line"><a name="l07787"></a><span class="lineno"> 7787</span>&#160;        <span class="keywordflow">return</span> <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l07788"></a><span class="lineno"> 7788</span>&#160;    }</div>
<div class="line"><a name="l07789"></a><span class="lineno"> 7789</span>&#160;</div>
<div class="line"><a name="l07797"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ae91c72441bff1164a3ab9d237a4e1faa"> 7797</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ae91c72441bff1164a3ab9d237a4e1faa">_destroy</a>($destroyall=<span class="keyword">false</span>, $preserve_objcopy=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l07798"></a><span class="lineno"> 7798</span>&#160;        <span class="keywordflow">if</span> ($destroyall AND isset($this-&gt;diskcache) AND $this-&gt;diskcache AND (!$preserve_objcopy) AND (!TCPDF_STATIC::empty_string($this-&gt;buffer))) {</div>
<div class="line"><a name="l07799"></a><span class="lineno"> 7799</span>&#160;            <span class="comment">// remove buffer file from cache</span></div>
<div class="line"><a name="l07800"></a><span class="lineno"> 7800</span>&#160;            unlink($this-&gt;buffer);</div>
<div class="line"><a name="l07801"></a><span class="lineno"> 7801</span>&#160;        }</div>
<div class="line"><a name="l07802"></a><span class="lineno"> 7802</span>&#160;        <span class="keywordflow">if</span> ($destroyall AND !empty($this-&gt;cached_files)) {</div>
<div class="line"><a name="l07803"></a><span class="lineno"> 7803</span>&#160;            <span class="comment">// remove cached files</span></div>
<div class="line"><a name="l07804"></a><span class="lineno"> 7804</span>&#160;            <span class="keywordflow">foreach</span> ($this-&gt;cached_files as $cachefile) {</div>
<div class="line"><a name="l07805"></a><span class="lineno"> 7805</span>&#160;                <span class="keywordflow">if</span> (is_file($cachefile)) {</div>
<div class="line"><a name="l07806"></a><span class="lineno"> 7806</span>&#160;                    unlink($cachefile);</div>
<div class="line"><a name="l07807"></a><span class="lineno"> 7807</span>&#160;                }</div>
<div class="line"><a name="l07808"></a><span class="lineno"> 7808</span>&#160;            }</div>
<div class="line"><a name="l07809"></a><span class="lineno"> 7809</span>&#160;            unset($this-&gt;cached_files);</div>
<div class="line"><a name="l07810"></a><span class="lineno"> 7810</span>&#160;        }</div>
<div class="line"><a name="l07811"></a><span class="lineno"> 7811</span>&#160;        $preserve = array(</div>
<div class="line"><a name="l07812"></a><span class="lineno"> 7812</span>&#160;            <span class="stringliteral">&#39;internal_encoding&#39;</span>,</div>
<div class="line"><a name="l07813"></a><span class="lineno"> 7813</span>&#160;            <span class="stringliteral">&#39;state&#39;</span>,</div>
<div class="line"><a name="l07814"></a><span class="lineno"> 7814</span>&#160;            <span class="stringliteral">&#39;bufferlen&#39;</span>,</div>
<div class="line"><a name="l07815"></a><span class="lineno"> 7815</span>&#160;            <span class="stringliteral">&#39;buffer&#39;</span>,</div>
<div class="line"><a name="l07816"></a><span class="lineno"> 7816</span>&#160;            <span class="stringliteral">&#39;diskcache&#39;</span>,</div>
<div class="line"><a name="l07817"></a><span class="lineno"> 7817</span>&#160;            <span class="stringliteral">&#39;cached_files&#39;</span>,</div>
<div class="line"><a name="l07818"></a><span class="lineno"> 7818</span>&#160;            <span class="stringliteral">&#39;sign&#39;</span>,</div>
<div class="line"><a name="l07819"></a><span class="lineno"> 7819</span>&#160;            <span class="stringliteral">&#39;signature_data&#39;</span>,</div>
<div class="line"><a name="l07820"></a><span class="lineno"> 7820</span>&#160;            <span class="stringliteral">&#39;signature_max_length&#39;</span>,</div>
<div class="line"><a name="l07821"></a><span class="lineno"> 7821</span>&#160;            <span class="stringliteral">&#39;byterange_string&#39;</span>,</div>
<div class="line"><a name="l07822"></a><span class="lineno"> 7822</span>&#160;            <span class="stringliteral">&#39;tsa_timestamp&#39;</span>,</div>
<div class="line"><a name="l07823"></a><span class="lineno"> 7823</span>&#160;            <span class="stringliteral">&#39;tsa_data&#39;</span></div>
<div class="line"><a name="l07824"></a><span class="lineno"> 7824</span>&#160;        );</div>
<div class="line"><a name="l07825"></a><span class="lineno"> 7825</span>&#160;        <span class="keywordflow">foreach</span> (array_keys(get_object_vars($this)) as $val) {</div>
<div class="line"><a name="l07826"></a><span class="lineno"> 7826</span>&#160;            <span class="keywordflow">if</span> ($destroyall OR !in_array($val, $preserve)) {</div>
<div class="line"><a name="l07827"></a><span class="lineno"> 7827</span>&#160;                <span class="keywordflow">if</span> ((!$preserve_objcopy OR ($val != <span class="stringliteral">&#39;objcopy&#39;</span>)) AND isset($this-&gt;$val)) {</div>
<div class="line"><a name="l07828"></a><span class="lineno"> 7828</span>&#160;                    unset($this-&gt;$val);</div>
<div class="line"><a name="l07829"></a><span class="lineno"> 7829</span>&#160;                }</div>
<div class="line"><a name="l07830"></a><span class="lineno"> 7830</span>&#160;            }</div>
<div class="line"><a name="l07831"></a><span class="lineno"> 7831</span>&#160;        }</div>
<div class="line"><a name="l07832"></a><span class="lineno"> 7832</span>&#160;    }</div>
<div class="line"><a name="l07833"></a><span class="lineno"> 7833</span>&#160;</div>
<div class="line"><a name="l07838"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a17346daa2c4848e475ad4f408376e2c2"> 7838</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a17346daa2c4848e475ad4f408376e2c2">_dochecks</a>() {</div>
<div class="line"><a name="l07839"></a><span class="lineno"> 7839</span>&#160;        <span class="comment">//Check for locale-related bug</span></div>
<div class="line"><a name="l07840"></a><span class="lineno"> 7840</span>&#160;        <span class="keywordflow">if</span> (1.1 == 1) {</div>
<div class="line"><a name="l07841"></a><span class="lineno"> 7841</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;Don\&#39;t alter the locale before including class file&#39;</span>);</div>
<div class="line"><a name="l07842"></a><span class="lineno"> 7842</span>&#160;        }</div>
<div class="line"><a name="l07843"></a><span class="lineno"> 7843</span>&#160;        <span class="comment">//Check for decimal separator</span></div>
<div class="line"><a name="l07844"></a><span class="lineno"> 7844</span>&#160;        <span class="keywordflow">if</span> (sprintf(<span class="stringliteral">&#39;%.1F&#39;</span>, 1.0) != <span class="stringliteral">&#39;1.0&#39;</span>) {</div>
<div class="line"><a name="l07845"></a><span class="lineno"> 7845</span>&#160;            setlocale(LC_NUMERIC, <span class="charliteral">&#39;C&#39;</span>);</div>
<div class="line"><a name="l07846"></a><span class="lineno"> 7846</span>&#160;        }</div>
<div class="line"><a name="l07847"></a><span class="lineno"> 7847</span>&#160;    }</div>
<div class="line"><a name="l07848"></a><span class="lineno"> 7848</span>&#160;</div>
<div class="line"><a name="l07855"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#adaef81b9b034e5d10c56b3f2fea83175"> 7855</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#adaef81b9b034e5d10c56b3f2fea83175">getInternalPageNumberAliases</a>($a= <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l07856"></a><span class="lineno"> 7856</span>&#160;        $alias = array();</div>
<div class="line"><a name="l07857"></a><span class="lineno"> 7857</span>&#160;        <span class="comment">// build array of Unicode + ASCII variants (the order is important)</span></div>
<div class="line"><a name="l07858"></a><span class="lineno"> 7858</span>&#160;        $alias = array(<span class="charliteral">&#39;u&#39;</span> =&gt; array(), <span class="charliteral">&#39;a&#39;</span> =&gt; array());</div>
<div class="line"><a name="l07859"></a><span class="lineno"> 7859</span>&#160;        $u = <span class="charliteral">&#39;{&#39;</span>.$a.<span class="charliteral">&#39;}&#39;</span>;</div>
<div class="line"><a name="l07860"></a><span class="lineno"> 7860</span>&#160;        $alias[<span class="charliteral">&#39;u&#39;</span>][] = TCPDF_STATIC::_escape($u);</div>
<div class="line"><a name="l07861"></a><span class="lineno"> 7861</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;isunicode) {</div>
<div class="line"><a name="l07862"></a><span class="lineno"> 7862</span>&#160;            $alias[<span class="charliteral">&#39;u&#39;</span>][] = TCPDF_STATIC::_escape(TCPDF_FONTS::UTF8ToLatin1($u, $this-&gt;isunicode, $this-&gt;CurrentFont));</div>
<div class="line"><a name="l07863"></a><span class="lineno"> 7863</span>&#160;            $alias[<span class="charliteral">&#39;u&#39;</span>][] = TCPDF_STATIC::_escape(TCPDF_FONTS::utf8StrRev($u, <span class="keyword">false</span>, $this-&gt;tmprtl, $this-&gt;isunicode, $this-&gt;CurrentFont));</div>
<div class="line"><a name="l07864"></a><span class="lineno"> 7864</span>&#160;            $alias[<span class="charliteral">&#39;a&#39;</span>][] = TCPDF_STATIC::_escape(TCPDF_FONTS::UTF8ToLatin1($a, $this-&gt;isunicode, $this-&gt;CurrentFont));</div>
<div class="line"><a name="l07865"></a><span class="lineno"> 7865</span>&#160;            $alias[<span class="charliteral">&#39;a&#39;</span>][] = TCPDF_STATIC::_escape(TCPDF_FONTS::utf8StrRev($a, <span class="keyword">false</span>, $this-&gt;tmprtl, $this-&gt;isunicode, $this-&gt;CurrentFont));</div>
<div class="line"><a name="l07866"></a><span class="lineno"> 7866</span>&#160;        }</div>
<div class="line"><a name="l07867"></a><span class="lineno"> 7867</span>&#160;        $alias[<span class="charliteral">&#39;a&#39;</span>][] = TCPDF_STATIC::_escape($a);</div>
<div class="line"><a name="l07868"></a><span class="lineno"> 7868</span>&#160;        <span class="keywordflow">return</span> $alias;</div>
<div class="line"><a name="l07869"></a><span class="lineno"> 7869</span>&#160;    }</div>
<div class="line"><a name="l07870"></a><span class="lineno"> 7870</span>&#160;</div>
<div class="line"><a name="l07876"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#af8fbad549f0384a7f76fa6db13193075"> 7876</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#af8fbad549f0384a7f76fa6db13193075">getAllInternalPageNumberAliases</a>() {</div>
<div class="line"><a name="l07877"></a><span class="lineno"> 7877</span>&#160;        $basic_alias = array(TCPDF_STATIC::$alias_tot_pages, TCPDF_STATIC::$alias_num_page, TCPDF_STATIC::$alias_group_tot_pages, TCPDF_STATIC::$alias_group_num_page, TCPDF_STATIC::$alias_right_shift);</div>
<div class="line"><a name="l07878"></a><span class="lineno"> 7878</span>&#160;        $pnalias = array();</div>
<div class="line"><a name="l07879"></a><span class="lineno"> 7879</span>&#160;        <span class="keywordflow">foreach</span>($basic_alias as <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a> =&gt; $a) {</div>
<div class="line"><a name="l07880"></a><span class="lineno"> 7880</span>&#160;            $pnalias[<a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#adaef81b9b034e5d10c56b3f2fea83175">getInternalPageNumberAliases</a>($a);</div>
<div class="line"><a name="l07881"></a><span class="lineno"> 7881</span>&#160;        }</div>
<div class="line"><a name="l07882"></a><span class="lineno"> 7882</span>&#160;        <span class="keywordflow">return</span> $pnalias;</div>
<div class="line"><a name="l07883"></a><span class="lineno"> 7883</span>&#160;    }</div>
<div class="line"><a name="l07884"></a><span class="lineno"> 7884</span>&#160;</div>
<div class="line"><a name="l07894"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#af3ca25bafc44372ca6d7fd7951dcad46"> 7894</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#af3ca25bafc44372ca6d7fd7951dcad46">replaceRightShiftPageNumAliases</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>, $aliases, $diff) {</div>
<div class="line"><a name="l07895"></a><span class="lineno"> 7895</span>&#160;        <span class="keywordflow">foreach</span> ($aliases as $type =&gt; $alias) {</div>
<div class="line"><a name="l07896"></a><span class="lineno"> 7896</span>&#160;            <span class="keywordflow">foreach</span> ($alias as $a) {</div>
<div class="line"><a name="l07897"></a><span class="lineno"> 7897</span>&#160;                <span class="comment">// find position of compensation factor</span></div>
<div class="line"><a name="l07898"></a><span class="lineno"> 7898</span>&#160;                $startnum = (strpos($a, <span class="charliteral">&#39;:&#39;</span>) + 1);</div>
<div class="line"><a name="l07899"></a><span class="lineno"> 7899</span>&#160;                $a = substr($a, 0, $startnum);</div>
<div class="line"><a name="l07900"></a><span class="lineno"> 7900</span>&#160;                <span class="keywordflow">if</span> (($pos = strpos(<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>, $a)) !== <span class="keyword">false</span>) {</div>
<div class="line"><a name="l07901"></a><span class="lineno"> 7901</span>&#160;                    <span class="comment">// end of alias</span></div>
<div class="line"><a name="l07902"></a><span class="lineno"> 7902</span>&#160;                    $endnum = strpos(<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>, <span class="charliteral">&#39;}&#39;</span>, $pos);</div>
<div class="line"><a name="l07903"></a><span class="lineno"> 7903</span>&#160;                    <span class="comment">// string to be replaced</span></div>
<div class="line"><a name="l07904"></a><span class="lineno"> 7904</span>&#160;                    $aa = substr(<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>, $pos, ($endnum - $pos + 1));</div>
<div class="line"><a name="l07905"></a><span class="lineno"> 7905</span>&#160;                    <span class="comment">// get compensation factor</span></div>
<div class="line"><a name="l07906"></a><span class="lineno"> 7906</span>&#160;                    $ratio = substr(<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>, ($pos + $startnum), ($endnum - $pos - $startnum));</div>
<div class="line"><a name="l07907"></a><span class="lineno"> 7907</span>&#160;                    $ratio = preg_replace(<span class="stringliteral">&#39;/[^0-9\.]/&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $ratio);</div>
<div class="line"><a name="l07908"></a><span class="lineno"> 7908</span>&#160;                    $ratio = floatval($ratio);</div>
<div class="line"><a name="l07909"></a><span class="lineno"> 7909</span>&#160;                    <span class="keywordflow">if</span> ($type == <span class="charliteral">&#39;u&#39;</span>) {</div>
<div class="line"><a name="l07910"></a><span class="lineno"> 7910</span>&#160;                        $chrdiff = floor(($diff + 12) * $ratio);</div>
<div class="line"><a name="l07911"></a><span class="lineno"> 7911</span>&#160;                        $shift = str_repeat(<span class="charliteral">&#39; &#39;</span>, $chrdiff);</div>
<div class="line"><a name="l07912"></a><span class="lineno"> 7912</span>&#160;                        $shift = TCPDF_FONTS::UTF8ToUTF16BE($shift, <span class="keyword">false</span>, $this-&gt;isunicode, $this-&gt;CurrentFont);</div>
<div class="line"><a name="l07913"></a><span class="lineno"> 7913</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l07914"></a><span class="lineno"> 7914</span>&#160;                        $chrdiff = floor(($diff + 11) * $ratio);</div>
<div class="line"><a name="l07915"></a><span class="lineno"> 7915</span>&#160;                        $shift = str_repeat(<span class="charliteral">&#39; &#39;</span>, $chrdiff);</div>
<div class="line"><a name="l07916"></a><span class="lineno"> 7916</span>&#160;                    }</div>
<div class="line"><a name="l07917"></a><span class="lineno"> 7917</span>&#160;                    <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a> = str_replace($aa, $shift, <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>);</div>
<div class="line"><a name="l07918"></a><span class="lineno"> 7918</span>&#160;                }</div>
<div class="line"><a name="l07919"></a><span class="lineno"> 7919</span>&#160;            }</div>
<div class="line"><a name="l07920"></a><span class="lineno"> 7920</span>&#160;        }</div>
<div class="line"><a name="l07921"></a><span class="lineno"> 7921</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>;</div>
<div class="line"><a name="l07922"></a><span class="lineno"> 7922</span>&#160;    }</div>
<div class="line"><a name="l07923"></a><span class="lineno"> 7923</span>&#160;</div>
<div class="line"><a name="l07929"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a84f86576ad997f0751c81ee45650ee6e"> 7929</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a84f86576ad997f0751c81ee45650ee6e">setPageBoxTypes</a>($boxes) {</div>
<div class="line"><a name="l07930"></a><span class="lineno"> 7930</span>&#160;        $this-&gt;page_boxes = array();</div>
<div class="line"><a name="l07931"></a><span class="lineno"> 7931</span>&#160;        <span class="keywordflow">foreach</span> ($boxes as $box) {</div>
<div class="line"><a name="l07932"></a><span class="lineno"> 7932</span>&#160;            <span class="keywordflow">if</span> (in_array($box, TCPDF_STATIC::$pageboxes)) {</div>
<div class="line"><a name="l07933"></a><span class="lineno"> 7933</span>&#160;                $this-&gt;page_boxes[] = $box;</div>
<div class="line"><a name="l07934"></a><span class="lineno"> 7934</span>&#160;            }</div>
<div class="line"><a name="l07935"></a><span class="lineno"> 7935</span>&#160;        }</div>
<div class="line"><a name="l07936"></a><span class="lineno"> 7936</span>&#160;    }</div>
<div class="line"><a name="l07937"></a><span class="lineno"> 7937</span>&#160;</div>
<div class="line"><a name="l07942"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a65bfa0bffc92dd5c359c114b837c81c0"> 7942</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a65bfa0bffc92dd5c359c114b837c81c0">_putpages</a>() {</div>
<div class="line"><a name="l07943"></a><span class="lineno"> 7943</span>&#160;        $filter = (<a class="code" href="../../d4/d40/classTCPDF.html#a9e5fbe1cabbea954c6b5d4f9837bc3b0">$this-&gt;compress</a>) ? <span class="stringliteral">&#39;/Filter /FlateDecode &#39;</span> : <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l07944"></a><span class="lineno"> 7944</span>&#160;        <span class="comment">// get internal aliases for page numbers</span></div>
<div class="line"><a name="l07945"></a><span class="lineno"> 7945</span>&#160;        $pnalias = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af8fbad549f0384a7f76fa6db13193075">getAllInternalPageNumberAliases</a>();</div>
<div class="line"><a name="l07946"></a><span class="lineno"> 7946</span>&#160;        $num_pages = <a class="code" href="../../d4/d40/classTCPDF.html#ae5dd5203ba48e26efcb24a6a6cabbb42">$this-&gt;numpages</a>;</div>
<div class="line"><a name="l07947"></a><span class="lineno"> 7947</span>&#160;        $ptpa = TCPDF_STATIC::formatPageNumber(($this-&gt;starting_page_number + $num_pages - 1));</div>
<div class="line"><a name="l07948"></a><span class="lineno"> 7948</span>&#160;        $ptpu = TCPDF_FONTS::UTF8ToUTF16BE($ptpa, <span class="keyword">false</span>, $this-&gt;isunicode, $this-&gt;CurrentFont);</div>
<div class="line"><a name="l07949"></a><span class="lineno"> 7949</span>&#160;        $ptp_num_chars = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac9dc6318fd217971aff282532ab91e43">GetNumChars</a>($ptpa);</div>
<div class="line"><a name="l07950"></a><span class="lineno"> 7950</span>&#160;        $pagegroupnum = 0;</div>
<div class="line"><a name="l07951"></a><span class="lineno"> 7951</span>&#160;        $groupnum = 0;</div>
<div class="line"><a name="l07952"></a><span class="lineno"> 7952</span>&#160;        $ptgu = 1;</div>
<div class="line"><a name="l07953"></a><span class="lineno"> 7953</span>&#160;        $ptga = 1;</div>
<div class="line"><a name="l07954"></a><span class="lineno"> 7954</span>&#160;        $ptg_num_chars = 1;</div>
<div class="line"><a name="l07955"></a><span class="lineno"> 7955</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a> = 1; <a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a> &lt;= $num_pages; ++<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>) {</div>
<div class="line"><a name="l07956"></a><span class="lineno"> 7956</span>&#160;            <span class="comment">// get current page</span></div>
<div class="line"><a name="l07957"></a><span class="lineno"> 7957</span>&#160;            $temppage = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d67b0a8681222f71fa9f9f6e65e0c56">getPageBuffer</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>);</div>
<div class="line"><a name="l07958"></a><span class="lineno"> 7958</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a2111c4472eae611423616d58c1e85430">$pagelen</a> = strlen($temppage);</div>
<div class="line"><a name="l07959"></a><span class="lineno"> 7959</span>&#160;            <span class="comment">// set replacements for total pages number</span></div>
<div class="line"><a name="l07960"></a><span class="lineno"> 7960</span>&#160;            $pnpa = TCPDF_STATIC::formatPageNumber(($this-&gt;starting_page_number + <a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a> - 1));</div>
<div class="line"><a name="l07961"></a><span class="lineno"> 7961</span>&#160;            $pnpu = TCPDF_FONTS::UTF8ToUTF16BE($pnpa, <span class="keyword">false</span>, $this-&gt;isunicode, $this-&gt;CurrentFont);</div>
<div class="line"><a name="l07962"></a><span class="lineno"> 7962</span>&#160;            $pnp_num_chars = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac9dc6318fd217971aff282532ab91e43">GetNumChars</a>($pnpa);</div>
<div class="line"><a name="l07963"></a><span class="lineno"> 7963</span>&#160;            $pdiff = 0; <span class="comment">// difference used for right shift alignment of page numbers</span></div>
<div class="line"><a name="l07964"></a><span class="lineno"> 7964</span>&#160;            $gdiff = 0; <span class="comment">// difference used for right shift alignment of page group numbers</span></div>
<div class="line"><a name="l07965"></a><span class="lineno"> 7965</span>&#160;            <span class="keywordflow">if</span> (!empty($this-&gt;pagegroups)) {</div>
<div class="line"><a name="l07966"></a><span class="lineno"> 7966</span>&#160;                <span class="keywordflow">if</span> (isset($this-&gt;newpagegroup[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>])) {</div>
<div class="line"><a name="l07967"></a><span class="lineno"> 7967</span>&#160;                    $pagegroupnum = 0;</div>
<div class="line"><a name="l07968"></a><span class="lineno"> 7968</span>&#160;                    ++$groupnum;</div>
<div class="line"><a name="l07969"></a><span class="lineno"> 7969</span>&#160;                    $ptga = TCPDF_STATIC::formatPageNumber($this-&gt;pagegroups[$groupnum]);</div>
<div class="line"><a name="l07970"></a><span class="lineno"> 7970</span>&#160;                    $ptgu = TCPDF_FONTS::UTF8ToUTF16BE($ptga, <span class="keyword">false</span>, $this-&gt;isunicode, $this-&gt;CurrentFont);</div>
<div class="line"><a name="l07971"></a><span class="lineno"> 7971</span>&#160;                    $ptg_num_chars = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac9dc6318fd217971aff282532ab91e43">GetNumChars</a>($ptga);</div>
<div class="line"><a name="l07972"></a><span class="lineno"> 7972</span>&#160;                }</div>
<div class="line"><a name="l07973"></a><span class="lineno"> 7973</span>&#160;                ++$pagegroupnum;</div>
<div class="line"><a name="l07974"></a><span class="lineno"> 7974</span>&#160;                $pnga = TCPDF_STATIC::formatPageNumber($pagegroupnum);</div>
<div class="line"><a name="l07975"></a><span class="lineno"> 7975</span>&#160;                $pngu = TCPDF_FONTS::UTF8ToUTF16BE($pnga, <span class="keyword">false</span>, $this-&gt;isunicode, $this-&gt;CurrentFont);</div>
<div class="line"><a name="l07976"></a><span class="lineno"> 7976</span>&#160;                $png_num_chars = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac9dc6318fd217971aff282532ab91e43">GetNumChars</a>($pnga);</div>
<div class="line"><a name="l07977"></a><span class="lineno"> 7977</span>&#160;                <span class="comment">// replace page numbers</span></div>
<div class="line"><a name="l07978"></a><span class="lineno"> 7978</span>&#160;                $replace = array();</div>
<div class="line"><a name="l07979"></a><span class="lineno"> 7979</span>&#160;                $replace[] = array($ptgu, $ptg_num_chars, 9, $pnalias[2][<span class="charliteral">&#39;u&#39;</span>]);</div>
<div class="line"><a name="l07980"></a><span class="lineno"> 7980</span>&#160;                $replace[] = array($ptga, $ptg_num_chars, 7, $pnalias[2][<span class="charliteral">&#39;a&#39;</span>]);</div>
<div class="line"><a name="l07981"></a><span class="lineno"> 7981</span>&#160;                $replace[] = array($pngu, $png_num_chars, 9, $pnalias[3][<span class="charliteral">&#39;u&#39;</span>]);</div>
<div class="line"><a name="l07982"></a><span class="lineno"> 7982</span>&#160;                $replace[] = array($pnga, $png_num_chars, 7, $pnalias[3][<span class="charliteral">&#39;a&#39;</span>]);</div>
<div class="line"><a name="l07983"></a><span class="lineno"> 7983</span>&#160;                list($temppage, $gdiff) = TCPDF_STATIC::replacePageNumAliases($temppage, $replace, $gdiff);</div>
<div class="line"><a name="l07984"></a><span class="lineno"> 7984</span>&#160;            }</div>
<div class="line"><a name="l07985"></a><span class="lineno"> 7985</span>&#160;            <span class="comment">// replace page numbers</span></div>
<div class="line"><a name="l07986"></a><span class="lineno"> 7986</span>&#160;            $replace = array();</div>
<div class="line"><a name="l07987"></a><span class="lineno"> 7987</span>&#160;            $replace[] = array($ptpu, $ptp_num_chars, 9, $pnalias[0][<span class="charliteral">&#39;u&#39;</span>]);</div>
<div class="line"><a name="l07988"></a><span class="lineno"> 7988</span>&#160;            $replace[] = array($ptpa, $ptp_num_chars, 7, $pnalias[0][<span class="charliteral">&#39;a&#39;</span>]);</div>
<div class="line"><a name="l07989"></a><span class="lineno"> 7989</span>&#160;            $replace[] = array($pnpu, $pnp_num_chars, 9, $pnalias[1][<span class="charliteral">&#39;u&#39;</span>]);</div>
<div class="line"><a name="l07990"></a><span class="lineno"> 7990</span>&#160;            $replace[] = array($pnpa, $pnp_num_chars, 7, $pnalias[1][<span class="charliteral">&#39;a&#39;</span>]);</div>
<div class="line"><a name="l07991"></a><span class="lineno"> 7991</span>&#160;            list($temppage, $pdiff) = TCPDF_STATIC::replacePageNumAliases($temppage, $replace, $pdiff);</div>
<div class="line"><a name="l07992"></a><span class="lineno"> 7992</span>&#160;            <span class="comment">// replace right shift alias</span></div>
<div class="line"><a name="l07993"></a><span class="lineno"> 7993</span>&#160;            $temppage = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af3ca25bafc44372ca6d7fd7951dcad46">replaceRightShiftPageNumAliases</a>($temppage, $pnalias[4], max($pdiff, $gdiff));</div>
<div class="line"><a name="l07994"></a><span class="lineno"> 7994</span>&#160;            <span class="comment">// replace EPS marker</span></div>
<div class="line"><a name="l07995"></a><span class="lineno"> 7995</span>&#160;            $temppage = str_replace($this-&gt;epsmarker, <span class="stringliteral">&#39;&#39;</span>, $temppage);</div>
<div class="line"><a name="l07996"></a><span class="lineno"> 7996</span>&#160;            <span class="comment">//Page</span></div>
<div class="line"><a name="l07997"></a><span class="lineno"> 7997</span>&#160;            $this-&gt;page_obj_id[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d">_newobj</a>();</div>
<div class="line"><a name="l07998"></a><span class="lineno"> 7998</span>&#160;            $out = <span class="stringliteral">&#39;&lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l07999"></a><span class="lineno"> 7999</span>&#160;            $out .= <span class="stringliteral">&#39; /Type /Page&#39;</span>;</div>
<div class="line"><a name="l08000"></a><span class="lineno"> 8000</span>&#160;            $out .= <span class="stringliteral">&#39; /Parent 1 0 R&#39;</span>;</div>
<div class="line"><a name="l08001"></a><span class="lineno"> 8001</span>&#160;            <span class="keywordflow">if</span> (empty($this-&gt;signature_data[<span class="stringliteral">&#39;approval&#39;</span>]) OR ($this-&gt;signature_data[<span class="stringliteral">&#39;approval&#39;</span>] != <span class="charliteral">&#39;A&#39;</span>)) {</div>
<div class="line"><a name="l08002"></a><span class="lineno"> 8002</span>&#160;                $out .= <span class="stringliteral">&#39; /LastModified &#39;</span>.$this-&gt;_datestring(0, $this-&gt;doc_modification_timestamp);</div>
<div class="line"><a name="l08003"></a><span class="lineno"> 8003</span>&#160;            }</div>
<div class="line"><a name="l08004"></a><span class="lineno"> 8004</span>&#160;            $out .= <span class="stringliteral">&#39; /Resources 2 0 R&#39;</span>;</div>
<div class="line"><a name="l08005"></a><span class="lineno"> 8005</span>&#160;            <span class="keywordflow">foreach</span> ($this-&gt;page_boxes as $box) {</div>
<div class="line"><a name="l08006"></a><span class="lineno"> 8006</span>&#160;                $out .= <span class="stringliteral">&#39; /&#39;</span>.$box;</div>
<div class="line"><a name="l08007"></a><span class="lineno"> 8007</span>&#160;                $out .= sprintf(<span class="stringliteral">&#39; [%F %F %F %F]&#39;</span>, $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][$box][<span class="stringliteral">&#39;llx&#39;</span>], $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][$box][<span class="stringliteral">&#39;lly&#39;</span>], $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][$box][<span class="stringliteral">&#39;urx&#39;</span>], $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][$box][<span class="stringliteral">&#39;ury&#39;</span>]);</div>
<div class="line"><a name="l08008"></a><span class="lineno"> 8008</span>&#160;            }</div>
<div class="line"><a name="l08009"></a><span class="lineno"> 8009</span>&#160;            <span class="keywordflow">if</span> (isset($this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;BoxColorInfo&#39;</span>]) AND !empty($this-&gt;pagedim[$n][<span class="stringliteral">&#39;BoxColorInfo&#39;</span>])) {</div>
<div class="line"><a name="l08010"></a><span class="lineno"> 8010</span>&#160;                $out .= <span class="stringliteral">&#39; /BoxColorInfo &lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l08011"></a><span class="lineno"> 8011</span>&#160;                <span class="keywordflow">foreach</span> ($this-&gt;page_boxes as $box) {</div>
<div class="line"><a name="l08012"></a><span class="lineno"> 8012</span>&#160;                    <span class="keywordflow">if</span> (isset($this-&gt;pagedim[$n][<span class="stringliteral">&#39;BoxColorInfo&#39;</span>][$box])) {</div>
<div class="line"><a name="l08013"></a><span class="lineno"> 8013</span>&#160;                        $out .= <span class="stringliteral">&#39; /&#39;</span>.$box.<span class="stringliteral">&#39; &lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l08014"></a><span class="lineno"> 8014</span>&#160;                        <span class="keywordflow">if</span> (isset($this-&gt;pagedim[$n][<span class="stringliteral">&#39;BoxColorInfo&#39;</span>][$box][<span class="charliteral">&#39;C&#39;</span>])) {</div>
<div class="line"><a name="l08015"></a><span class="lineno"> 8015</span>&#160;                            $color = $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;BoxColorInfo&#39;</span>][$box][<span class="charliteral">&#39;C&#39;</span>];</div>
<div class="line"><a name="l08016"></a><span class="lineno"> 8016</span>&#160;                            $out .= <span class="stringliteral">&#39; /C [&#39;</span>;</div>
<div class="line"><a name="l08017"></a><span class="lineno"> 8017</span>&#160;                            $out .= sprintf(<span class="stringliteral">&#39; %F %F %F&#39;</span>, ($color[0] / 255), ($color[1] / 255), ($color[2] / 255));</div>
<div class="line"><a name="l08018"></a><span class="lineno"> 8018</span>&#160;                            $out .= <span class="stringliteral">&#39; ]&#39;</span>;</div>
<div class="line"><a name="l08019"></a><span class="lineno"> 8019</span>&#160;                        }</div>
<div class="line"><a name="l08020"></a><span class="lineno"> 8020</span>&#160;                        <span class="keywordflow">if</span> (isset($this-&gt;pagedim[$n][<span class="stringliteral">&#39;BoxColorInfo&#39;</span>][$box][<span class="charliteral">&#39;W&#39;</span>])) {</div>
<div class="line"><a name="l08021"></a><span class="lineno"> 8021</span>&#160;                            $out .= <span class="stringliteral">&#39; /W &#39;</span>.($this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;BoxColorInfo&#39;</span>][$box][<span class="charliteral">&#39;W&#39;</span>] * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>);</div>
<div class="line"><a name="l08022"></a><span class="lineno"> 8022</span>&#160;                        }</div>
<div class="line"><a name="l08023"></a><span class="lineno"> 8023</span>&#160;                        <span class="keywordflow">if</span> (isset($this-&gt;pagedim[$n][<span class="stringliteral">&#39;BoxColorInfo&#39;</span>][$box][<span class="charliteral">&#39;S&#39;</span>])) {</div>
<div class="line"><a name="l08024"></a><span class="lineno"> 8024</span>&#160;                            $out .= <span class="stringliteral">&#39; /S /&#39;</span>.$this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;BoxColorInfo&#39;</span>][$box][<span class="charliteral">&#39;S&#39;</span>];</div>
<div class="line"><a name="l08025"></a><span class="lineno"> 8025</span>&#160;                        }</div>
<div class="line"><a name="l08026"></a><span class="lineno"> 8026</span>&#160;                        <span class="keywordflow">if</span> (isset($this-&gt;pagedim[$n][<span class="stringliteral">&#39;BoxColorInfo&#39;</span>][$box][<span class="charliteral">&#39;D&#39;</span>])) {</div>
<div class="line"><a name="l08027"></a><span class="lineno"> 8027</span>&#160;                            $dashes = $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;BoxColorInfo&#39;</span>][$box][<span class="charliteral">&#39;D&#39;</span>];</div>
<div class="line"><a name="l08028"></a><span class="lineno"> 8028</span>&#160;                            $out .= <span class="stringliteral">&#39; /D [&#39;</span>;</div>
<div class="line"><a name="l08029"></a><span class="lineno"> 8029</span>&#160;                            <span class="keywordflow">foreach</span> ($dashes as $dash) {</div>
<div class="line"><a name="l08030"></a><span class="lineno"> 8030</span>&#160;                                $out .= sprintf(<span class="stringliteral">&#39; %F&#39;</span>, ($dash * $this-&gt;k));</div>
<div class="line"><a name="l08031"></a><span class="lineno"> 8031</span>&#160;                            }</div>
<div class="line"><a name="l08032"></a><span class="lineno"> 8032</span>&#160;                            $out .= <span class="stringliteral">&#39; ]&#39;</span>;</div>
<div class="line"><a name="l08033"></a><span class="lineno"> 8033</span>&#160;                        }</div>
<div class="line"><a name="l08034"></a><span class="lineno"> 8034</span>&#160;                        $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l08035"></a><span class="lineno"> 8035</span>&#160;                    }</div>
<div class="line"><a name="l08036"></a><span class="lineno"> 8036</span>&#160;                }</div>
<div class="line"><a name="l08037"></a><span class="lineno"> 8037</span>&#160;                $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l08038"></a><span class="lineno"> 8038</span>&#160;            }</div>
<div class="line"><a name="l08039"></a><span class="lineno"> 8039</span>&#160;            $out .= <span class="stringliteral">&#39; /Contents &#39;</span>.($this-&gt;n + 1).<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l08040"></a><span class="lineno"> 8040</span>&#160;            $out .= <span class="stringliteral">&#39; /Rotate &#39;</span>.$this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;Rotate&#39;</span>];</div>
<div class="line"><a name="l08041"></a><span class="lineno"> 8041</span>&#160;            <span class="keywordflow">if</span> (!$this-&gt;pdfa_mode) {</div>
<div class="line"><a name="l08042"></a><span class="lineno"> 8042</span>&#160;                $out .= <span class="stringliteral">&#39; /Group &lt;&lt; /Type /Group /S /Transparency /CS /DeviceRGB &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l08043"></a><span class="lineno"> 8043</span>&#160;            }</div>
<div class="line"><a name="l08044"></a><span class="lineno"> 8044</span>&#160;            <span class="keywordflow">if</span> (isset($this-&gt;pagedim[$n][<span class="stringliteral">&#39;trans&#39;</span>]) AND !empty($this-&gt;pagedim[$n][<span class="stringliteral">&#39;trans&#39;</span>])) {</div>
<div class="line"><a name="l08045"></a><span class="lineno"> 8045</span>&#160;                <span class="comment">// page transitions</span></div>
<div class="line"><a name="l08046"></a><span class="lineno"> 8046</span>&#160;                <span class="keywordflow">if</span> (isset($this-&gt;pagedim[$n][<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;Dur&#39;</span>])) {</div>
<div class="line"><a name="l08047"></a><span class="lineno"> 8047</span>&#160;                    $out .= <span class="stringliteral">&#39; /Dur &#39;</span>.$this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;Dur&#39;</span>];</div>
<div class="line"><a name="l08048"></a><span class="lineno"> 8048</span>&#160;                }</div>
<div class="line"><a name="l08049"></a><span class="lineno"> 8049</span>&#160;                $out .= <span class="stringliteral">&#39; /Trans &lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l08050"></a><span class="lineno"> 8050</span>&#160;                $out .= <span class="stringliteral">&#39; /Type /Trans&#39;</span>;</div>
<div class="line"><a name="l08051"></a><span class="lineno"> 8051</span>&#160;                <span class="keywordflow">if</span> (isset($this-&gt;pagedim[$n][<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;S&#39;</span>])) {</div>
<div class="line"><a name="l08052"></a><span class="lineno"> 8052</span>&#160;                    $out .= <span class="stringliteral">&#39; /S /&#39;</span>.$this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;S&#39;</span>];</div>
<div class="line"><a name="l08053"></a><span class="lineno"> 8053</span>&#160;                }</div>
<div class="line"><a name="l08054"></a><span class="lineno"> 8054</span>&#160;                <span class="keywordflow">if</span> (isset($this-&gt;pagedim[$n][<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;D&#39;</span>])) {</div>
<div class="line"><a name="l08055"></a><span class="lineno"> 8055</span>&#160;                    $out .= <span class="stringliteral">&#39; /D &#39;</span>.$this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;D&#39;</span>];</div>
<div class="line"><a name="l08056"></a><span class="lineno"> 8056</span>&#160;                }</div>
<div class="line"><a name="l08057"></a><span class="lineno"> 8057</span>&#160;                <span class="keywordflow">if</span> (isset($this-&gt;pagedim[$n][<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;Dm&#39;</span>])) {</div>
<div class="line"><a name="l08058"></a><span class="lineno"> 8058</span>&#160;                    $out .= <span class="stringliteral">&#39; /Dm /&#39;</span>.$this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;Dm&#39;</span>];</div>
<div class="line"><a name="l08059"></a><span class="lineno"> 8059</span>&#160;                }</div>
<div class="line"><a name="l08060"></a><span class="lineno"> 8060</span>&#160;                <span class="keywordflow">if</span> (isset($this-&gt;pagedim[$n][<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;M&#39;</span>])) {</div>
<div class="line"><a name="l08061"></a><span class="lineno"> 8061</span>&#160;                    $out .= <span class="stringliteral">&#39; /M /&#39;</span>.$this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;M&#39;</span>];</div>
<div class="line"><a name="l08062"></a><span class="lineno"> 8062</span>&#160;                }</div>
<div class="line"><a name="l08063"></a><span class="lineno"> 8063</span>&#160;                <span class="keywordflow">if</span> (isset($this-&gt;pagedim[$n][<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;Di&#39;</span>])) {</div>
<div class="line"><a name="l08064"></a><span class="lineno"> 8064</span>&#160;                    $out .= <span class="stringliteral">&#39; /Di &#39;</span>.$this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;Di&#39;</span>];</div>
<div class="line"><a name="l08065"></a><span class="lineno"> 8065</span>&#160;                }</div>
<div class="line"><a name="l08066"></a><span class="lineno"> 8066</span>&#160;                <span class="keywordflow">if</span> (isset($this-&gt;pagedim[$n][<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;SS&#39;</span>])) {</div>
<div class="line"><a name="l08067"></a><span class="lineno"> 8067</span>&#160;                    $out .= <span class="stringliteral">&#39; /SS &#39;</span>.$this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;trans&#39;</span>][<span class="stringliteral">&#39;SS&#39;</span>];</div>
<div class="line"><a name="l08068"></a><span class="lineno"> 8068</span>&#160;                }</div>
<div class="line"><a name="l08069"></a><span class="lineno"> 8069</span>&#160;                <span class="keywordflow">if</span> (isset($this-&gt;pagedim[$n][<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;B&#39;</span>])) {</div>
<div class="line"><a name="l08070"></a><span class="lineno"> 8070</span>&#160;                    $out .= <span class="stringliteral">&#39; /B &#39;</span>.$this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;trans&#39;</span>][<span class="charliteral">&#39;B&#39;</span>];</div>
<div class="line"><a name="l08071"></a><span class="lineno"> 8071</span>&#160;                }</div>
<div class="line"><a name="l08072"></a><span class="lineno"> 8072</span>&#160;                $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l08073"></a><span class="lineno"> 8073</span>&#160;            }</div>
<div class="line"><a name="l08074"></a><span class="lineno"> 8074</span>&#160;            $out .= $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a42cfd0a9e84edfcaa1e46d3d7283ef73">_getannotsrefs</a>($n);</div>
<div class="line"><a name="l08075"></a><span class="lineno"> 8075</span>&#160;            $out .= <span class="stringliteral">&#39; /PZ &#39;</span>.$this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;PZ&#39;</span>];</div>
<div class="line"><a name="l08076"></a><span class="lineno"> 8076</span>&#160;            $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l08077"></a><span class="lineno"> 8077</span>&#160;            $out .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l08078"></a><span class="lineno"> 8078</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($out);</div>
<div class="line"><a name="l08079"></a><span class="lineno"> 8079</span>&#160;            <span class="comment">//Page content</span></div>
<div class="line"><a name="l08080"></a><span class="lineno"> 8080</span>&#160;            $p = (<a class="code" href="../../d4/d40/classTCPDF.html#a9e5fbe1cabbea954c6b5d4f9837bc3b0">$this-&gt;compress</a>) ? gzcompress($temppage) : $temppage;</div>
<div class="line"><a name="l08081"></a><span class="lineno"> 8081</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d">_newobj</a>();</div>
<div class="line"><a name="l08082"></a><span class="lineno"> 8082</span>&#160;            $p = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a7c7c1beebd83fa777197a842f2ca73eb">_getrawstream</a>($p);</div>
<div class="line"><a name="l08083"></a><span class="lineno"> 8083</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(<span class="stringliteral">&#39;&lt;&lt;&#39;</span>.$filter.<span class="stringliteral">&#39;/Length &#39;</span>.strlen($p).<span class="stringliteral">&#39;&gt;&gt; stream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.$p.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endstream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>);</div>
<div class="line"><a name="l08084"></a><span class="lineno"> 8084</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;diskcache) {</div>
<div class="line"><a name="l08085"></a><span class="lineno"> 8085</span>&#160;                <span class="comment">// remove temporary files</span></div>
<div class="line"><a name="l08086"></a><span class="lineno"> 8086</span>&#160;                unlink($this-&gt;pages[$n]);</div>
<div class="line"><a name="l08087"></a><span class="lineno"> 8087</span>&#160;            }</div>
<div class="line"><a name="l08088"></a><span class="lineno"> 8088</span>&#160;        }</div>
<div class="line"><a name="l08089"></a><span class="lineno"> 8089</span>&#160;        <span class="comment">//Pages root</span></div>
<div class="line"><a name="l08090"></a><span class="lineno"> 8090</span>&#160;        $out = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1ef3c591556f7668c8a62b81e98da8a1">_getobj</a>(1).<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l08091"></a><span class="lineno"> 8091</span>&#160;        $out .= <span class="stringliteral">&#39;&lt;&lt; /Type /Pages /Kids [&#39;</span>;</div>
<div class="line"><a name="l08092"></a><span class="lineno"> 8092</span>&#160;        <span class="keywordflow">foreach</span>($this-&gt;page_obj_id as $page_obj) {</div>
<div class="line"><a name="l08093"></a><span class="lineno"> 8093</span>&#160;            $out .= <span class="charliteral">&#39; &#39;</span>.$page_obj.<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l08094"></a><span class="lineno"> 8094</span>&#160;        }</div>
<div class="line"><a name="l08095"></a><span class="lineno"> 8095</span>&#160;        $out .= <span class="stringliteral">&#39; ] /Count &#39;</span>.$num_pages.<span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l08096"></a><span class="lineno"> 8096</span>&#160;        $out .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l08097"></a><span class="lineno"> 8097</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($out);</div>
<div class="line"><a name="l08098"></a><span class="lineno"> 8098</span>&#160;    }</div>
<div class="line"><a name="l08099"></a><span class="lineno"> 8099</span>&#160;</div>
<div class="line"><a name="l08108"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a7a19257fcbaa5c79ce4a5aa4319ec8af"> 8108</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a7a19257fcbaa5c79ce4a5aa4319ec8af">_putannotsrefs</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>) {</div>
<div class="line"><a name="l08109"></a><span class="lineno"> 8109</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a42cfd0a9e84edfcaa1e46d3d7283ef73">_getannotsrefs</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>));</div>
<div class="line"><a name="l08110"></a><span class="lineno"> 8110</span>&#160;    }</div>
<div class="line"><a name="l08111"></a><span class="lineno"> 8111</span>&#160;</div>
<div class="line"><a name="l08120"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a42cfd0a9e84edfcaa1e46d3d7283ef73"> 8120</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a42cfd0a9e84edfcaa1e46d3d7283ef73">_getannotsrefs</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>) {</div>
<div class="line"><a name="l08121"></a><span class="lineno"> 8121</span>&#160;        <span class="keywordflow">if</span> (!(isset($this-&gt;PageAnnots[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>]) OR ($this-&gt;sign AND isset($this-&gt;signature_data[<span class="stringliteral">&#39;cert_type&#39;</span>])))) {</div>
<div class="line"><a name="l08122"></a><span class="lineno"> 8122</span>&#160;            <span class="keywordflow">return</span> <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l08123"></a><span class="lineno"> 8123</span>&#160;        }</div>
<div class="line"><a name="l08124"></a><span class="lineno"> 8124</span>&#160;        $out = <span class="stringliteral">&#39; /Annots [&#39;</span>;</div>
<div class="line"><a name="l08125"></a><span class="lineno"> 8125</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;PageAnnots[$n])) {</div>
<div class="line"><a name="l08126"></a><span class="lineno"> 8126</span>&#160;            <span class="keywordflow">foreach</span> ($this-&gt;PageAnnots[$n] as $key =&gt; $val) {</div>
<div class="line"><a name="l08127"></a><span class="lineno"> 8127</span>&#160;                <span class="keywordflow">if</span> (!in_array($val[<span class="charliteral">&#39;n&#39;</span>], $this-&gt;radio_groups)) {</div>
<div class="line"><a name="l08128"></a><span class="lineno"> 8128</span>&#160;                    $out .= <span class="charliteral">&#39; &#39;</span>.$val[<span class="charliteral">&#39;n&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l08129"></a><span class="lineno"> 8129</span>&#160;                }</div>
<div class="line"><a name="l08130"></a><span class="lineno"> 8130</span>&#160;            }</div>
<div class="line"><a name="l08131"></a><span class="lineno"> 8131</span>&#160;            <span class="comment">// add radiobutton groups</span></div>
<div class="line"><a name="l08132"></a><span class="lineno"> 8132</span>&#160;            <span class="keywordflow">if</span> (isset($this-&gt;radiobutton_groups[$n])) {</div>
<div class="line"><a name="l08133"></a><span class="lineno"> 8133</span>&#160;                <span class="keywordflow">foreach</span> ($this-&gt;radiobutton_groups[$n] as $key =&gt; $data) {</div>
<div class="line"><a name="l08134"></a><span class="lineno"> 8134</span>&#160;                    <span class="keywordflow">if</span> (isset($data[<span class="charliteral">&#39;n&#39;</span>])) {</div>
<div class="line"><a name="l08135"></a><span class="lineno"> 8135</span>&#160;                        $out .= <span class="charliteral">&#39; &#39;</span>.$data[<span class="charliteral">&#39;n&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l08136"></a><span class="lineno"> 8136</span>&#160;                    }</div>
<div class="line"><a name="l08137"></a><span class="lineno"> 8137</span>&#160;                }</div>
<div class="line"><a name="l08138"></a><span class="lineno"> 8138</span>&#160;            }</div>
<div class="line"><a name="l08139"></a><span class="lineno"> 8139</span>&#160;        }</div>
<div class="line"><a name="l08140"></a><span class="lineno"> 8140</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;sign AND ($n == $this-&gt;signature_appearance[<span class="stringliteral">&#39;page&#39;</span>]) AND isset($this-&gt;signature_data[<span class="stringliteral">&#39;cert_type&#39;</span>])) {</div>
<div class="line"><a name="l08141"></a><span class="lineno"> 8141</span>&#160;            <span class="comment">// set reference for signature object</span></div>
<div class="line"><a name="l08142"></a><span class="lineno"> 8142</span>&#160;            $out .= <span class="charliteral">&#39; &#39;</span>.$this-&gt;sig_obj_id.<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l08143"></a><span class="lineno"> 8143</span>&#160;        }</div>
<div class="line"><a name="l08144"></a><span class="lineno"> 8144</span>&#160;        <span class="keywordflow">if</span> (!empty($this-&gt;empty_signature_appearance)) {</div>
<div class="line"><a name="l08145"></a><span class="lineno"> 8145</span>&#160;            <span class="keywordflow">foreach</span> ($this-&gt;empty_signature_appearance as $esa) {</div>
<div class="line"><a name="l08146"></a><span class="lineno"> 8146</span>&#160;                <span class="keywordflow">if</span> ($esa[<span class="stringliteral">&#39;page&#39;</span>] == $n) {</div>
<div class="line"><a name="l08147"></a><span class="lineno"> 8147</span>&#160;                    <span class="comment">// set reference for empty signature objects</span></div>
<div class="line"><a name="l08148"></a><span class="lineno"> 8148</span>&#160;                    $out .= <span class="charliteral">&#39; &#39;</span>.$esa[<span class="stringliteral">&#39;objid&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l08149"></a><span class="lineno"> 8149</span>&#160;                }</div>
<div class="line"><a name="l08150"></a><span class="lineno"> 8150</span>&#160;            }</div>
<div class="line"><a name="l08151"></a><span class="lineno"> 8151</span>&#160;        }</div>
<div class="line"><a name="l08152"></a><span class="lineno"> 8152</span>&#160;        $out .= <span class="stringliteral">&#39; ]&#39;</span>;</div>
<div class="line"><a name="l08153"></a><span class="lineno"> 8153</span>&#160;        <span class="keywordflow">return</span> $out;</div>
<div class="line"><a name="l08154"></a><span class="lineno"> 8154</span>&#160;    }</div>
<div class="line"><a name="l08155"></a><span class="lineno"> 8155</span>&#160;</div>
<div class="line"><a name="l08164"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a9dabd5e4c0295bd5caef55968375da9e"> 8164</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a9dabd5e4c0295bd5caef55968375da9e">_putannotsobjs</a>() {</div>
<div class="line"><a name="l08165"></a><span class="lineno"> 8165</span>&#160;        <span class="comment">// reset object counter</span></div>
<div class="line"><a name="l08166"></a><span class="lineno"> 8166</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>=1; <a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a> &lt;= <a class="code" href="../../d4/d40/classTCPDF.html#ae5dd5203ba48e26efcb24a6a6cabbb42">$this-&gt;numpages</a>; ++<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>) {</div>
<div class="line"><a name="l08167"></a><span class="lineno"> 8167</span>&#160;            <span class="keywordflow">if</span> (isset($this-&gt;PageAnnots[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>])) {</div>
<div class="line"><a name="l08168"></a><span class="lineno"> 8168</span>&#160;                <span class="comment">// set page annotations</span></div>
<div class="line"><a name="l08169"></a><span class="lineno"> 8169</span>&#160;                <span class="keywordflow">foreach</span> ($this-&gt;PageAnnots[$n] as $key =&gt; $pl) {</div>
<div class="line"><a name="l08170"></a><span class="lineno"> 8170</span>&#160;                    $annot_obj_id = $this-&gt;PageAnnots[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][$key][<span class="charliteral">&#39;n&#39;</span>];</div>
<div class="line"><a name="l08171"></a><span class="lineno"> 8171</span>&#160;                    <span class="comment">// create annotation object for grouping radiobuttons</span></div>
<div class="line"><a name="l08172"></a><span class="lineno"> 8172</span>&#160;                    <span class="keywordflow">if</span> (isset($this-&gt;radiobutton_groups[$n][$pl[<span class="stringliteral">&#39;txt&#39;</span>]]) AND is_array($this-&gt;radiobutton_groups[$n][$pl[<span class="stringliteral">&#39;txt&#39;</span>]])) {</div>
<div class="line"><a name="l08173"></a><span class="lineno"> 8173</span>&#160;                        $radio_button_obj_id = $this-&gt;radiobutton_groups[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][$pl[<span class="stringliteral">&#39;txt&#39;</span>]][<span class="charliteral">&#39;n&#39;</span>];</div>
<div class="line"><a name="l08174"></a><span class="lineno"> 8174</span>&#160;                        $annots = <span class="stringliteral">&#39;&lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l08175"></a><span class="lineno"> 8175</span>&#160;                        $annots .= <span class="stringliteral">&#39; /Type /Annot&#39;</span>;</div>
<div class="line"><a name="l08176"></a><span class="lineno"> 8176</span>&#160;                        $annots .= <span class="stringliteral">&#39; /Subtype /Widget&#39;</span>;</div>
<div class="line"><a name="l08177"></a><span class="lineno"> 8177</span>&#160;                        $annots .= <span class="stringliteral">&#39; /Rect [0 0 0 0]&#39;</span>;</div>
<div class="line"><a name="l08178"></a><span class="lineno"> 8178</span>&#160;                        <span class="keywordflow">if</span> ($this-&gt;radiobutton_groups[$n][$pl[<span class="stringliteral">&#39;txt&#39;</span>]][<span class="stringliteral">&#39;#readonly#&#39;</span>]) {</div>
<div class="line"><a name="l08179"></a><span class="lineno"> 8179</span>&#160;                            <span class="comment">// read only</span></div>
<div class="line"><a name="l08180"></a><span class="lineno"> 8180</span>&#160;                            $annots .= <span class="stringliteral">&#39; /F 68&#39;</span>;</div>
<div class="line"><a name="l08181"></a><span class="lineno"> 8181</span>&#160;                            $annots .= <span class="stringliteral">&#39; /Ff 49153&#39;</span>;</div>
<div class="line"><a name="l08182"></a><span class="lineno"> 8182</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l08183"></a><span class="lineno"> 8183</span>&#160;                            $annots .= <span class="stringliteral">&#39; /F 4&#39;</span>; <span class="comment">// default print for PDF/A</span></div>
<div class="line"><a name="l08184"></a><span class="lineno"> 8184</span>&#160;                            $annots .= <span class="stringliteral">&#39; /Ff 49152&#39;</span>;</div>
<div class="line"><a name="l08185"></a><span class="lineno"> 8185</span>&#160;                        }</div>
<div class="line"><a name="l08186"></a><span class="lineno"> 8186</span>&#160;                        $annots .= <span class="stringliteral">&#39; /T &#39;</span>.$this-&gt;_datastring($pl[<span class="stringliteral">&#39;txt&#39;</span>], $radio_button_obj_id);</div>
<div class="line"><a name="l08187"></a><span class="lineno"> 8187</span>&#160;                        <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;tu&#39;</span>]) AND is_string($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;tu&#39;</span>])) {</div>
<div class="line"><a name="l08188"></a><span class="lineno"> 8188</span>&#160;                            $annots .= <span class="stringliteral">&#39; /TU &#39;</span>.$this-&gt;_datastring($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;tu&#39;</span>], $radio_button_obj_id);</div>
<div class="line"><a name="l08189"></a><span class="lineno"> 8189</span>&#160;                        }</div>
<div class="line"><a name="l08190"></a><span class="lineno"> 8190</span>&#160;                        $annots .= <span class="stringliteral">&#39; /FT /Btn&#39;</span>;</div>
<div class="line"><a name="l08191"></a><span class="lineno"> 8191</span>&#160;                        $annots .= <span class="stringliteral">&#39; /Kids [&#39;</span>;</div>
<div class="line"><a name="l08192"></a><span class="lineno"> 8192</span>&#160;                        $defval = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l08193"></a><span class="lineno"> 8193</span>&#160;                        <span class="keywordflow">foreach</span> ($this-&gt;radiobutton_groups[$n][$pl[<span class="stringliteral">&#39;txt&#39;</span>]] as $key =&gt; $data) {</div>
<div class="line"><a name="l08194"></a><span class="lineno"> 8194</span>&#160;                            <span class="keywordflow">if</span> (isset($data[<span class="stringliteral">&#39;kid&#39;</span>])) {</div>
<div class="line"><a name="l08195"></a><span class="lineno"> 8195</span>&#160;                                $annots .= <span class="charliteral">&#39; &#39;</span>.$data[<span class="stringliteral">&#39;kid&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l08196"></a><span class="lineno"> 8196</span>&#160;                                <span class="keywordflow">if</span> ($data[<span class="stringliteral">&#39;def&#39;</span>] !== <span class="stringliteral">&#39;Off&#39;</span>) {</div>
<div class="line"><a name="l08197"></a><span class="lineno"> 8197</span>&#160;                                    $defval = $data[<span class="stringliteral">&#39;def&#39;</span>];</div>
<div class="line"><a name="l08198"></a><span class="lineno"> 8198</span>&#160;                                }</div>
<div class="line"><a name="l08199"></a><span class="lineno"> 8199</span>&#160;                            }</div>
<div class="line"><a name="l08200"></a><span class="lineno"> 8200</span>&#160;                        }</div>
<div class="line"><a name="l08201"></a><span class="lineno"> 8201</span>&#160;                        $annots .= <span class="stringliteral">&#39; ]&#39;</span>;</div>
<div class="line"><a name="l08202"></a><span class="lineno"> 8202</span>&#160;                        <span class="keywordflow">if</span> (!empty($defval)) {</div>
<div class="line"><a name="l08203"></a><span class="lineno"> 8203</span>&#160;                            $annots .= <span class="stringliteral">&#39; /V /&#39;</span>.$defval;</div>
<div class="line"><a name="l08204"></a><span class="lineno"> 8204</span>&#160;                        }</div>
<div class="line"><a name="l08205"></a><span class="lineno"> 8205</span>&#160;                        $annots .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l08206"></a><span class="lineno"> 8206</span>&#160;                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1ef3c591556f7668c8a62b81e98da8a1">_getobj</a>($radio_button_obj_id).<span class="stringliteral">&quot;\n&quot;</span>.$annots.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>);</div>
<div class="line"><a name="l08207"></a><span class="lineno"> 8207</span>&#160;                        $this-&gt;form_obj_id[] = $radio_button_obj_id;</div>
<div class="line"><a name="l08208"></a><span class="lineno"> 8208</span>&#160;                        <span class="comment">// store object id to be used on Parent entry of Kids</span></div>
<div class="line"><a name="l08209"></a><span class="lineno"> 8209</span>&#160;                        $this-&gt;radiobutton_groups[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][$pl[<span class="stringliteral">&#39;txt&#39;</span>]] = $radio_button_obj_id;</div>
<div class="line"><a name="l08210"></a><span class="lineno"> 8210</span>&#160;                    }</div>
<div class="line"><a name="l08211"></a><span class="lineno"> 8211</span>&#160;                    $formfield = <span class="keyword">false</span>;</div>
<div class="line"><a name="l08212"></a><span class="lineno"> 8212</span>&#160;                    $pl[<span class="stringliteral">&#39;opt&#39;</span>] = array_change_key_case($pl[<span class="stringliteral">&#39;opt&#39;</span>], CASE_LOWER);</div>
<div class="line"><a name="l08213"></a><span class="lineno"> 8213</span>&#160;                    $a = $pl[<span class="charliteral">&#39;x&#39;</span>] * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>;</div>
<div class="line"><a name="l08214"></a><span class="lineno"> 8214</span>&#160;                    $b = $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="charliteral">&#39;h&#39;</span>] - (($pl[<span class="charliteral">&#39;y&#39;</span>] + $pl[<span class="charliteral">&#39;h&#39;</span>]) * $this-&gt;k);</div>
<div class="line"><a name="l08215"></a><span class="lineno"> 8215</span>&#160;                    $c = $pl[<span class="charliteral">&#39;w&#39;</span>] * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>;</div>
<div class="line"><a name="l08216"></a><span class="lineno"> 8216</span>&#160;                    $d = $pl[<span class="charliteral">&#39;h&#39;</span>] * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>;</div>
<div class="line"><a name="l08217"></a><span class="lineno"> 8217</span>&#160;                    $rect = sprintf(<span class="stringliteral">&#39;%F %F %F %F&#39;</span>, $a, $b, $a+$c, $b+$d);</div>
<div class="line"><a name="l08218"></a><span class="lineno"> 8218</span>&#160;                    <span class="comment">// create new annotation object</span></div>
<div class="line"><a name="l08219"></a><span class="lineno"> 8219</span>&#160;                    $annots = <span class="stringliteral">&#39;&lt;&lt;/Type /Annot&#39;</span>;</div>
<div class="line"><a name="l08220"></a><span class="lineno"> 8220</span>&#160;                    $annots .= <span class="stringliteral">&#39; /Subtype /&#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;subtype&#39;</span>];</div>
<div class="line"><a name="l08221"></a><span class="lineno"> 8221</span>&#160;                    $annots .= <span class="stringliteral">&#39; /Rect [&#39;</span>.$rect.<span class="charliteral">&#39;]&#39;</span>;</div>
<div class="line"><a name="l08222"></a><span class="lineno"> 8222</span>&#160;                    $ft = array(<span class="stringliteral">&#39;Btn&#39;</span>, <span class="stringliteral">&#39;Tx&#39;</span>, <span class="stringliteral">&#39;Ch&#39;</span>, <span class="stringliteral">&#39;Sig&#39;</span>);</div>
<div class="line"><a name="l08223"></a><span class="lineno"> 8223</span>&#160;                    <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;ft&#39;</span>]) AND in_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;ft&#39;</span>], $ft)) {</div>
<div class="line"><a name="l08224"></a><span class="lineno"> 8224</span>&#160;                        $annots .= <span class="stringliteral">&#39; /FT /&#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;ft&#39;</span>];</div>
<div class="line"><a name="l08225"></a><span class="lineno"> 8225</span>&#160;                        $formfield = <span class="keyword">true</span>;</div>
<div class="line"><a name="l08226"></a><span class="lineno"> 8226</span>&#160;                    }</div>
<div class="line"><a name="l08227"></a><span class="lineno"> 8227</span>&#160;                    $annots .= <span class="stringliteral">&#39; /Contents &#39;</span>.$this-&gt;_textstring($pl[<span class="stringliteral">&#39;txt&#39;</span>], $annot_obj_id);</div>
<div class="line"><a name="l08228"></a><span class="lineno"> 8228</span>&#160;                    $annots .= <span class="stringliteral">&#39; /P &#39;</span>.$this-&gt;page_obj_id[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>].<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l08229"></a><span class="lineno"> 8229</span>&#160;                    $annots .= <span class="stringliteral">&#39; /NM &#39;</span>.$this-&gt;_datastring(sprintf(<span class="stringliteral">&#39;%04u-%04u&#39;</span>, $n, $key), $annot_obj_id);</div>
<div class="line"><a name="l08230"></a><span class="lineno"> 8230</span>&#160;                    $annots .= <span class="stringliteral">&#39; /M &#39;</span>.$this-&gt;_datestring($annot_obj_id, $this-&gt;doc_modification_timestamp);</div>
<div class="line"><a name="l08231"></a><span class="lineno"> 8231</span>&#160;                    <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;f&#39;</span>])) {</div>
<div class="line"><a name="l08232"></a><span class="lineno"> 8232</span>&#160;                        $fval = 0;</div>
<div class="line"><a name="l08233"></a><span class="lineno"> 8233</span>&#160;                        <span class="keywordflow">if</span> (is_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;f&#39;</span>])) {</div>
<div class="line"><a name="l08234"></a><span class="lineno"> 8234</span>&#160;                            <span class="keywordflow">foreach</span> ($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;f&#39;</span>] as $f) {</div>
<div class="line"><a name="l08235"></a><span class="lineno"> 8235</span>&#160;                                <span class="keywordflow">switch</span> (strtolower($f)) {</div>
<div class="line"><a name="l08236"></a><span class="lineno"> 8236</span>&#160;                                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;invisible&#39;</span>: {</div>
<div class="line"><a name="l08237"></a><span class="lineno"> 8237</span>&#160;                                        $fval += 1 &lt;&lt; 0;</div>
<div class="line"><a name="l08238"></a><span class="lineno"> 8238</span>&#160;                                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08239"></a><span class="lineno"> 8239</span>&#160;                                    }</div>
<div class="line"><a name="l08240"></a><span class="lineno"> 8240</span>&#160;                                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;hidden&#39;</span>: {</div>
<div class="line"><a name="l08241"></a><span class="lineno"> 8241</span>&#160;                                        $fval += 1 &lt;&lt; 1;</div>
<div class="line"><a name="l08242"></a><span class="lineno"> 8242</span>&#160;                                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08243"></a><span class="lineno"> 8243</span>&#160;                                    }</div>
<div class="line"><a name="l08244"></a><span class="lineno"> 8244</span>&#160;                                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;print&#39;</span>: {</div>
<div class="line"><a name="l08245"></a><span class="lineno"> 8245</span>&#160;                                        $fval += 1 &lt;&lt; 2;</div>
<div class="line"><a name="l08246"></a><span class="lineno"> 8246</span>&#160;                                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08247"></a><span class="lineno"> 8247</span>&#160;                                    }</div>
<div class="line"><a name="l08248"></a><span class="lineno"> 8248</span>&#160;                                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;nozoom&#39;</span>: {</div>
<div class="line"><a name="l08249"></a><span class="lineno"> 8249</span>&#160;                                        $fval += 1 &lt;&lt; 3;</div>
<div class="line"><a name="l08250"></a><span class="lineno"> 8250</span>&#160;                                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08251"></a><span class="lineno"> 8251</span>&#160;                                    }</div>
<div class="line"><a name="l08252"></a><span class="lineno"> 8252</span>&#160;                                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;norotate&#39;</span>: {</div>
<div class="line"><a name="l08253"></a><span class="lineno"> 8253</span>&#160;                                        $fval += 1 &lt;&lt; 4;</div>
<div class="line"><a name="l08254"></a><span class="lineno"> 8254</span>&#160;                                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08255"></a><span class="lineno"> 8255</span>&#160;                                    }</div>
<div class="line"><a name="l08256"></a><span class="lineno"> 8256</span>&#160;                                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;noview&#39;</span>: {</div>
<div class="line"><a name="l08257"></a><span class="lineno"> 8257</span>&#160;                                        $fval += 1 &lt;&lt; 5;</div>
<div class="line"><a name="l08258"></a><span class="lineno"> 8258</span>&#160;                                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08259"></a><span class="lineno"> 8259</span>&#160;                                    }</div>
<div class="line"><a name="l08260"></a><span class="lineno"> 8260</span>&#160;                                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;readonly&#39;</span>: {</div>
<div class="line"><a name="l08261"></a><span class="lineno"> 8261</span>&#160;                                        $fval += 1 &lt;&lt; 6;</div>
<div class="line"><a name="l08262"></a><span class="lineno"> 8262</span>&#160;                                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08263"></a><span class="lineno"> 8263</span>&#160;                                    }</div>
<div class="line"><a name="l08264"></a><span class="lineno"> 8264</span>&#160;                                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;locked&#39;</span>: {</div>
<div class="line"><a name="l08265"></a><span class="lineno"> 8265</span>&#160;                                        $fval += 1 &lt;&lt; 8;</div>
<div class="line"><a name="l08266"></a><span class="lineno"> 8266</span>&#160;                                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08267"></a><span class="lineno"> 8267</span>&#160;                                    }</div>
<div class="line"><a name="l08268"></a><span class="lineno"> 8268</span>&#160;                                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;togglenoview&#39;</span>: {</div>
<div class="line"><a name="l08269"></a><span class="lineno"> 8269</span>&#160;                                        $fval += 1 &lt;&lt; 9;</div>
<div class="line"><a name="l08270"></a><span class="lineno"> 8270</span>&#160;                                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08271"></a><span class="lineno"> 8271</span>&#160;                                    }</div>
<div class="line"><a name="l08272"></a><span class="lineno"> 8272</span>&#160;                                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;lockedcontents&#39;</span>: {</div>
<div class="line"><a name="l08273"></a><span class="lineno"> 8273</span>&#160;                                        $fval += 1 &lt;&lt; 10;</div>
<div class="line"><a name="l08274"></a><span class="lineno"> 8274</span>&#160;                                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08275"></a><span class="lineno"> 8275</span>&#160;                                    }</div>
<div class="line"><a name="l08276"></a><span class="lineno"> 8276</span>&#160;                                    <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l08277"></a><span class="lineno"> 8277</span>&#160;                                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08278"></a><span class="lineno"> 8278</span>&#160;                                    }</div>
<div class="line"><a name="l08279"></a><span class="lineno"> 8279</span>&#160;                                }</div>
<div class="line"><a name="l08280"></a><span class="lineno"> 8280</span>&#160;                            }</div>
<div class="line"><a name="l08281"></a><span class="lineno"> 8281</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l08282"></a><span class="lineno"> 8282</span>&#160;                            $fval = intval($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;f&#39;</span>]);</div>
<div class="line"><a name="l08283"></a><span class="lineno"> 8283</span>&#160;                        }</div>
<div class="line"><a name="l08284"></a><span class="lineno"> 8284</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l08285"></a><span class="lineno"> 8285</span>&#160;                        $fval = 4;</div>
<div class="line"><a name="l08286"></a><span class="lineno"> 8286</span>&#160;                    }</div>
<div class="line"><a name="l08287"></a><span class="lineno"> 8287</span>&#160;                    <span class="keywordflow">if</span> ($this-&gt;pdfa_mode) {</div>
<div class="line"><a name="l08288"></a><span class="lineno"> 8288</span>&#160;                        <span class="comment">// force print flag for PDF/A mode</span></div>
<div class="line"><a name="l08289"></a><span class="lineno"> 8289</span>&#160;                        $fval |= 4;</div>
<div class="line"><a name="l08290"></a><span class="lineno"> 8290</span>&#160;                    }</div>
<div class="line"><a name="l08291"></a><span class="lineno"> 8291</span>&#160;                    $annots .= <span class="stringliteral">&#39; /F &#39;</span>.intval($fval);</div>
<div class="line"><a name="l08292"></a><span class="lineno"> 8292</span>&#160;                    <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;as&#39;</span>]) AND is_string($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;as&#39;</span>])) {</div>
<div class="line"><a name="l08293"></a><span class="lineno"> 8293</span>&#160;                        $annots .= <span class="stringliteral">&#39; /AS /&#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;as&#39;</span>];</div>
<div class="line"><a name="l08294"></a><span class="lineno"> 8294</span>&#160;                    }</div>
<div class="line"><a name="l08295"></a><span class="lineno"> 8295</span>&#160;                    <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;ap&#39;</span>])) {</div>
<div class="line"><a name="l08296"></a><span class="lineno"> 8296</span>&#160;                        <span class="comment">// appearance stream</span></div>
<div class="line"><a name="l08297"></a><span class="lineno"> 8297</span>&#160;                        $annots .= <span class="stringliteral">&#39; /AP &lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l08298"></a><span class="lineno"> 8298</span>&#160;                        <span class="keywordflow">if</span> (is_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;ap&#39;</span>])) {</div>
<div class="line"><a name="l08299"></a><span class="lineno"> 8299</span>&#160;                            <span class="keywordflow">foreach</span> ($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;ap&#39;</span>] as $apmode =&gt; $apdef) {</div>
<div class="line"><a name="l08300"></a><span class="lineno"> 8300</span>&#160;                                <span class="comment">// $apmode can be: n = normal; r = rollover; d = down;</span></div>
<div class="line"><a name="l08301"></a><span class="lineno"> 8301</span>&#160;                                $annots .= <span class="stringliteral">&#39; /&#39;</span>.strtoupper($apmode);</div>
<div class="line"><a name="l08302"></a><span class="lineno"> 8302</span>&#160;                                <span class="keywordflow">if</span> (is_array($apdef)) {</div>
<div class="line"><a name="l08303"></a><span class="lineno"> 8303</span>&#160;                                    $annots .= <span class="stringliteral">&#39; &lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l08304"></a><span class="lineno"> 8304</span>&#160;                                    <span class="keywordflow">foreach</span> ($apdef as $apstate =&gt; $stream) {</div>
<div class="line"><a name="l08305"></a><span class="lineno"> 8305</span>&#160;                                        <span class="comment">// reference to XObject that define the appearance for this mode-state</span></div>
<div class="line"><a name="l08306"></a><span class="lineno"> 8306</span>&#160;                                        $apsobjid = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4235ea24726644eb13d82a2ebe8ee882">_putAPXObject</a>($c, $d, $stream);</div>
<div class="line"><a name="l08307"></a><span class="lineno"> 8307</span>&#160;                                        $annots .= <span class="stringliteral">&#39; /&#39;</span>.$apstate.<span class="charliteral">&#39; &#39;</span>.$apsobjid.<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l08308"></a><span class="lineno"> 8308</span>&#160;                                    }</div>
<div class="line"><a name="l08309"></a><span class="lineno"> 8309</span>&#160;                                    $annots .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l08310"></a><span class="lineno"> 8310</span>&#160;                                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l08311"></a><span class="lineno"> 8311</span>&#160;                                    <span class="comment">// reference to XObject that define the appearance for this mode</span></div>
<div class="line"><a name="l08312"></a><span class="lineno"> 8312</span>&#160;                                    $apsobjid = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4235ea24726644eb13d82a2ebe8ee882">_putAPXObject</a>($c, $d, $apdef);</div>
<div class="line"><a name="l08313"></a><span class="lineno"> 8313</span>&#160;                                    $annots .= <span class="charliteral">&#39; &#39;</span>.$apsobjid.<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l08314"></a><span class="lineno"> 8314</span>&#160;                                }</div>
<div class="line"><a name="l08315"></a><span class="lineno"> 8315</span>&#160;                            }</div>
<div class="line"><a name="l08316"></a><span class="lineno"> 8316</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l08317"></a><span class="lineno"> 8317</span>&#160;                            $annots .= $pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;ap&#39;</span>];</div>
<div class="line"><a name="l08318"></a><span class="lineno"> 8318</span>&#160;                        }</div>
<div class="line"><a name="l08319"></a><span class="lineno"> 8319</span>&#160;                        $annots .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l08320"></a><span class="lineno"> 8320</span>&#160;                    }</div>
<div class="line"><a name="l08321"></a><span class="lineno"> 8321</span>&#160;                    <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;bs&#39;</span>]) AND (is_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;bs&#39;</span>]))) {</div>
<div class="line"><a name="l08322"></a><span class="lineno"> 8322</span>&#160;                        $annots .= <span class="stringliteral">&#39; /BS &lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l08323"></a><span class="lineno"> 8323</span>&#160;                        $annots .= <span class="stringliteral">&#39; /Type /Border&#39;</span>;</div>
<div class="line"><a name="l08324"></a><span class="lineno"> 8324</span>&#160;                        <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;bs&#39;</span>][<span class="charliteral">&#39;w&#39;</span>])) {</div>
<div class="line"><a name="l08325"></a><span class="lineno"> 8325</span>&#160;                            $annots .= <span class="stringliteral">&#39; /W &#39;</span>.intval($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;bs&#39;</span>][<span class="charliteral">&#39;w&#39;</span>]);</div>
<div class="line"><a name="l08326"></a><span class="lineno"> 8326</span>&#160;                        }</div>
<div class="line"><a name="l08327"></a><span class="lineno"> 8327</span>&#160;                        $bstyles = array(<span class="charliteral">&#39;S&#39;</span>, <span class="charliteral">&#39;D&#39;</span>, <span class="charliteral">&#39;B&#39;</span>, <span class="charliteral">&#39;I&#39;</span>, <span class="charliteral">&#39;U&#39;</span>);</div>
<div class="line"><a name="l08328"></a><span class="lineno"> 8328</span>&#160;                        <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;bs&#39;</span>][<span class="charliteral">&#39;s&#39;</span>]) AND in_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;bs&#39;</span>][<span class="charliteral">&#39;s&#39;</span>], $bstyles)) {</div>
<div class="line"><a name="l08329"></a><span class="lineno"> 8329</span>&#160;                            $annots .= <span class="stringliteral">&#39; /S /&#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;bs&#39;</span>][<span class="charliteral">&#39;s&#39;</span>];</div>
<div class="line"><a name="l08330"></a><span class="lineno"> 8330</span>&#160;                        }</div>
<div class="line"><a name="l08331"></a><span class="lineno"> 8331</span>&#160;                        <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;bs&#39;</span>][<span class="charliteral">&#39;d&#39;</span>]) AND (is_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;bs&#39;</span>][<span class="charliteral">&#39;d&#39;</span>]))) {</div>
<div class="line"><a name="l08332"></a><span class="lineno"> 8332</span>&#160;                            $annots .= <span class="stringliteral">&#39; /D [&#39;</span>;</div>
<div class="line"><a name="l08333"></a><span class="lineno"> 8333</span>&#160;                            <span class="keywordflow">foreach</span> ($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;bs&#39;</span>][<span class="charliteral">&#39;d&#39;</span>] as $cord) {</div>
<div class="line"><a name="l08334"></a><span class="lineno"> 8334</span>&#160;                                $annots .= <span class="charliteral">&#39; &#39;</span>.intval($cord);</div>
<div class="line"><a name="l08335"></a><span class="lineno"> 8335</span>&#160;                            }</div>
<div class="line"><a name="l08336"></a><span class="lineno"> 8336</span>&#160;                            $annots .= <span class="charliteral">&#39;]&#39;</span>;</div>
<div class="line"><a name="l08337"></a><span class="lineno"> 8337</span>&#160;                        }</div>
<div class="line"><a name="l08338"></a><span class="lineno"> 8338</span>&#160;                        $annots .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l08339"></a><span class="lineno"> 8339</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l08340"></a><span class="lineno"> 8340</span>&#160;                        $annots .= <span class="stringliteral">&#39; /Border [&#39;</span>;</div>
<div class="line"><a name="l08341"></a><span class="lineno"> 8341</span>&#160;                        <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;border&#39;</span>]) AND (count($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;border&#39;</span>]) &gt;= 3)) {</div>
<div class="line"><a name="l08342"></a><span class="lineno"> 8342</span>&#160;                            $annots .= intval($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;border&#39;</span>][0]).<span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l08343"></a><span class="lineno"> 8343</span>&#160;                            $annots .= intval($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;border&#39;</span>][1]).<span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l08344"></a><span class="lineno"> 8344</span>&#160;                            $annots .= intval($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;border&#39;</span>][2]);</div>
<div class="line"><a name="l08345"></a><span class="lineno"> 8345</span>&#160;                            <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;border&#39;</span>][3]) AND is_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;border&#39;</span>][3])) {</div>
<div class="line"><a name="l08346"></a><span class="lineno"> 8346</span>&#160;                                $annots .= <span class="stringliteral">&#39; [&#39;</span>;</div>
<div class="line"><a name="l08347"></a><span class="lineno"> 8347</span>&#160;                                <span class="keywordflow">foreach</span> ($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;border&#39;</span>][3] as $dash) {</div>
<div class="line"><a name="l08348"></a><span class="lineno"> 8348</span>&#160;                                    $annots .= intval($dash).<span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l08349"></a><span class="lineno"> 8349</span>&#160;                                }</div>
<div class="line"><a name="l08350"></a><span class="lineno"> 8350</span>&#160;                                $annots .= <span class="charliteral">&#39;]&#39;</span>;</div>
<div class="line"><a name="l08351"></a><span class="lineno"> 8351</span>&#160;                            }</div>
<div class="line"><a name="l08352"></a><span class="lineno"> 8352</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l08353"></a><span class="lineno"> 8353</span>&#160;                            $annots .= <span class="stringliteral">&#39;0 0 0&#39;</span>;</div>
<div class="line"><a name="l08354"></a><span class="lineno"> 8354</span>&#160;                        }</div>
<div class="line"><a name="l08355"></a><span class="lineno"> 8355</span>&#160;                        $annots .= <span class="charliteral">&#39;]&#39;</span>;</div>
<div class="line"><a name="l08356"></a><span class="lineno"> 8356</span>&#160;                    }</div>
<div class="line"><a name="l08357"></a><span class="lineno"> 8357</span>&#160;                    <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;be&#39;</span>]) AND (is_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;be&#39;</span>]))) {</div>
<div class="line"><a name="l08358"></a><span class="lineno"> 8358</span>&#160;                        $annots .= <span class="stringliteral">&#39; /BE &lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l08359"></a><span class="lineno"> 8359</span>&#160;                        $bstyles = array(<span class="charliteral">&#39;S&#39;</span>, <span class="charliteral">&#39;C&#39;</span>);</div>
<div class="line"><a name="l08360"></a><span class="lineno"> 8360</span>&#160;                        <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;be&#39;</span>][<span class="charliteral">&#39;s&#39;</span>]) AND in_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;be&#39;</span>][<span class="charliteral">&#39;s&#39;</span>], $bstyles)) {</div>
<div class="line"><a name="l08361"></a><span class="lineno"> 8361</span>&#160;                            $annots .= <span class="stringliteral">&#39; /S /&#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;bs&#39;</span>][<span class="charliteral">&#39;s&#39;</span>];</div>
<div class="line"><a name="l08362"></a><span class="lineno"> 8362</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l08363"></a><span class="lineno"> 8363</span>&#160;                            $annots .= <span class="stringliteral">&#39; /S /S&#39;</span>;</div>
<div class="line"><a name="l08364"></a><span class="lineno"> 8364</span>&#160;                        }</div>
<div class="line"><a name="l08365"></a><span class="lineno"> 8365</span>&#160;                        <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;be&#39;</span>][<span class="charliteral">&#39;i&#39;</span>]) AND ($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;be&#39;</span>][<span class="charliteral">&#39;i&#39;</span>] &gt;= 0) AND ($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;be&#39;</span>][<span class="charliteral">&#39;i&#39;</span>] &lt;= 2)) {</div>
<div class="line"><a name="l08366"></a><span class="lineno"> 8366</span>&#160;                            $annots .= <span class="stringliteral">&#39; /I &#39;</span>.sprintf(<span class="stringliteral">&#39; %F&#39;</span>, $pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;be&#39;</span>][<span class="charliteral">&#39;i&#39;</span>]);</div>
<div class="line"><a name="l08367"></a><span class="lineno"> 8367</span>&#160;                        }</div>
<div class="line"><a name="l08368"></a><span class="lineno"> 8368</span>&#160;                        $annots .= <span class="stringliteral">&#39;&gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l08369"></a><span class="lineno"> 8369</span>&#160;                    }</div>
<div class="line"><a name="l08370"></a><span class="lineno"> 8370</span>&#160;                    <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;c&#39;</span>]) AND (is_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;c&#39;</span>])) AND !empty($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;c&#39;</span>])) {</div>
<div class="line"><a name="l08371"></a><span class="lineno"> 8371</span>&#160;                        $annots .= <span class="stringliteral">&#39; /C &#39;</span>.TCPDF_COLORS::getColorStringFromArray($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;c&#39;</span>]);</div>
<div class="line"><a name="l08372"></a><span class="lineno"> 8372</span>&#160;                    }</div>
<div class="line"><a name="l08373"></a><span class="lineno"> 8373</span>&#160;                    <span class="comment">//$annots .= &#39; /StructParent &#39;;</span></div>
<div class="line"><a name="l08374"></a><span class="lineno"> 8374</span>&#160;                    <span class="comment">//$annots .= &#39; /OC &#39;;</span></div>
<div class="line"><a name="l08375"></a><span class="lineno"> 8375</span>&#160;                    $markups = array(<span class="stringliteral">&#39;text&#39;</span>, <span class="stringliteral">&#39;freetext&#39;</span>, <span class="stringliteral">&#39;line&#39;</span>, <span class="stringliteral">&#39;square&#39;</span>, <span class="stringliteral">&#39;circle&#39;</span>, <span class="stringliteral">&#39;polygon&#39;</span>, <span class="stringliteral">&#39;polyline&#39;</span>, <span class="stringliteral">&#39;highlight&#39;</span>, <span class="stringliteral">&#39;underline&#39;</span>, <span class="stringliteral">&#39;squiggly&#39;</span>, <span class="stringliteral">&#39;strikeout&#39;</span>, <span class="stringliteral">&#39;stamp&#39;</span>, <span class="stringliteral">&#39;caret&#39;</span>, <span class="stringliteral">&#39;ink&#39;</span>, <span class="stringliteral">&#39;fileattachment&#39;</span>, <span class="stringliteral">&#39;sound&#39;</span>);</div>
<div class="line"><a name="l08376"></a><span class="lineno"> 8376</span>&#160;                    <span class="keywordflow">if</span> (in_array(strtolower($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;subtype&#39;</span>]), $markups)) {</div>
<div class="line"><a name="l08377"></a><span class="lineno"> 8377</span>&#160;                        <span class="comment">// this is a markup type</span></div>
<div class="line"><a name="l08378"></a><span class="lineno"> 8378</span>&#160;                        <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;t&#39;</span>]) AND is_string($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;t&#39;</span>])) {</div>
<div class="line"><a name="l08379"></a><span class="lineno"> 8379</span>&#160;                            $annots .= <span class="stringliteral">&#39; /T &#39;</span>.$this-&gt;_textstring($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;t&#39;</span>], $annot_obj_id);</div>
<div class="line"><a name="l08380"></a><span class="lineno"> 8380</span>&#160;                        }</div>
<div class="line"><a name="l08381"></a><span class="lineno"> 8381</span>&#160;                        <span class="comment">//$annots .= &#39; /Popup &#39;;</span></div>
<div class="line"><a name="l08382"></a><span class="lineno"> 8382</span>&#160;                        <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;ca&#39;</span>])) {</div>
<div class="line"><a name="l08383"></a><span class="lineno"> 8383</span>&#160;                            $annots .= <span class="stringliteral">&#39; /CA &#39;</span>.sprintf(<span class="stringliteral">&#39;%F&#39;</span>, floatval($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;ca&#39;</span>]));</div>
<div class="line"><a name="l08384"></a><span class="lineno"> 8384</span>&#160;                        }</div>
<div class="line"><a name="l08385"></a><span class="lineno"> 8385</span>&#160;                        <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;rc&#39;</span>])) {</div>
<div class="line"><a name="l08386"></a><span class="lineno"> 8386</span>&#160;                            $annots .= <span class="stringliteral">&#39; /RC &#39;</span>.$this-&gt;_textstring($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;rc&#39;</span>], $annot_obj_id);</div>
<div class="line"><a name="l08387"></a><span class="lineno"> 8387</span>&#160;                        }</div>
<div class="line"><a name="l08388"></a><span class="lineno"> 8388</span>&#160;                        $annots .= <span class="stringliteral">&#39; /CreationDate &#39;</span>.$this-&gt;_datestring($annot_obj_id, $this-&gt;doc_creation_timestamp);</div>
<div class="line"><a name="l08389"></a><span class="lineno"> 8389</span>&#160;                        <span class="comment">//$annots .= &#39; /IRT &#39;;</span></div>
<div class="line"><a name="l08390"></a><span class="lineno"> 8390</span>&#160;                        <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;subj&#39;</span>])) {</div>
<div class="line"><a name="l08391"></a><span class="lineno"> 8391</span>&#160;                            $annots .= <span class="stringliteral">&#39; /Subj &#39;</span>.$this-&gt;_textstring($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;subj&#39;</span>], $annot_obj_id);</div>
<div class="line"><a name="l08392"></a><span class="lineno"> 8392</span>&#160;                        }</div>
<div class="line"><a name="l08393"></a><span class="lineno"> 8393</span>&#160;                        <span class="comment">//$annots .= &#39; /RT &#39;;</span></div>
<div class="line"><a name="l08394"></a><span class="lineno"> 8394</span>&#160;                        <span class="comment">//$annots .= &#39; /IT &#39;;</span></div>
<div class="line"><a name="l08395"></a><span class="lineno"> 8395</span>&#160;                        <span class="comment">//$annots .= &#39; /ExData &#39;;</span></div>
<div class="line"><a name="l08396"></a><span class="lineno"> 8396</span>&#160;                    }</div>
<div class="line"><a name="l08397"></a><span class="lineno"> 8397</span>&#160;                    $lineendings = array(<span class="stringliteral">&#39;Square&#39;</span>, <span class="stringliteral">&#39;Circle&#39;</span>, <span class="stringliteral">&#39;Diamond&#39;</span>, <span class="stringliteral">&#39;OpenArrow&#39;</span>, <span class="stringliteral">&#39;ClosedArrow&#39;</span>, <span class="stringliteral">&#39;None&#39;</span>, <span class="stringliteral">&#39;Butt&#39;</span>, <span class="stringliteral">&#39;ROpenArrow&#39;</span>, <span class="stringliteral">&#39;RClosedArrow&#39;</span>, <span class="stringliteral">&#39;Slash&#39;</span>);</div>
<div class="line"><a name="l08398"></a><span class="lineno"> 8398</span>&#160;                    <span class="comment">// Annotation types</span></div>
<div class="line"><a name="l08399"></a><span class="lineno"> 8399</span>&#160;                    <span class="keywordflow">switch</span> (strtolower($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;subtype&#39;</span>])) {</div>
<div class="line"><a name="l08400"></a><span class="lineno"> 8400</span>&#160;                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;text&#39;</span>: {</div>
<div class="line"><a name="l08401"></a><span class="lineno"> 8401</span>&#160;                            <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;open&#39;</span>])) {</div>
<div class="line"><a name="l08402"></a><span class="lineno"> 8402</span>&#160;                                $annots .= <span class="stringliteral">&#39; /Open &#39;</span>. (strtolower($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;open&#39;</span>]) == <span class="stringliteral">&#39;true&#39;</span> ? <span class="stringliteral">&#39;true&#39;</span> : <span class="stringliteral">&#39;false&#39;</span>);</div>
<div class="line"><a name="l08403"></a><span class="lineno"> 8403</span>&#160;                            }</div>
<div class="line"><a name="l08404"></a><span class="lineno"> 8404</span>&#160;                            $iconsapp = array(<span class="stringliteral">&#39;Comment&#39;</span>, <span class="stringliteral">&#39;Help&#39;</span>, <span class="stringliteral">&#39;Insert&#39;</span>, <span class="stringliteral">&#39;Key&#39;</span>, <span class="stringliteral">&#39;NewParagraph&#39;</span>, <span class="stringliteral">&#39;Note&#39;</span>, <span class="stringliteral">&#39;Paragraph&#39;</span>);</div>
<div class="line"><a name="l08405"></a><span class="lineno"> 8405</span>&#160;                            <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;name&#39;</span>]) AND in_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;name&#39;</span>], $iconsapp)) {</div>
<div class="line"><a name="l08406"></a><span class="lineno"> 8406</span>&#160;                                $annots .= <span class="stringliteral">&#39; /Name /&#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;name&#39;</span>];</div>
<div class="line"><a name="l08407"></a><span class="lineno"> 8407</span>&#160;                            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l08408"></a><span class="lineno"> 8408</span>&#160;                                $annots .= <span class="stringliteral">&#39; /Name /Note&#39;</span>;</div>
<div class="line"><a name="l08409"></a><span class="lineno"> 8409</span>&#160;                            }</div>
<div class="line"><a name="l08410"></a><span class="lineno"> 8410</span>&#160;                            $statemodels = array(<span class="stringliteral">&#39;Marked&#39;</span>, <span class="stringliteral">&#39;Review&#39;</span>);</div>
<div class="line"><a name="l08411"></a><span class="lineno"> 8411</span>&#160;                            <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;statemodel&#39;</span>]) AND in_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;statemodel&#39;</span>], $statemodels)) {</div>
<div class="line"><a name="l08412"></a><span class="lineno"> 8412</span>&#160;                                $annots .= <span class="stringliteral">&#39; /StateModel /&#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;statemodel&#39;</span>];</div>
<div class="line"><a name="l08413"></a><span class="lineno"> 8413</span>&#160;                            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l08414"></a><span class="lineno"> 8414</span>&#160;                                $pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;statemodel&#39;</span>] = <span class="stringliteral">&#39;Marked&#39;</span>;</div>
<div class="line"><a name="l08415"></a><span class="lineno"> 8415</span>&#160;                                $annots .= <span class="stringliteral">&#39; /StateModel /&#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;statemodel&#39;</span>];</div>
<div class="line"><a name="l08416"></a><span class="lineno"> 8416</span>&#160;                            }</div>
<div class="line"><a name="l08417"></a><span class="lineno"> 8417</span>&#160;                            <span class="keywordflow">if</span> ($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;statemodel&#39;</span>] == <span class="stringliteral">&#39;Marked&#39;</span>) {</div>
<div class="line"><a name="l08418"></a><span class="lineno"> 8418</span>&#160;                                $states = array(<span class="stringliteral">&#39;Accepted&#39;</span>, <span class="stringliteral">&#39;Unmarked&#39;</span>);</div>
<div class="line"><a name="l08419"></a><span class="lineno"> 8419</span>&#160;                            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l08420"></a><span class="lineno"> 8420</span>&#160;                                $states = array(<span class="stringliteral">&#39;Accepted&#39;</span>, <span class="stringliteral">&#39;Rejected&#39;</span>, <span class="stringliteral">&#39;Cancelled&#39;</span>, <span class="stringliteral">&#39;Completed&#39;</span>, <span class="stringliteral">&#39;None&#39;</span>);</div>
<div class="line"><a name="l08421"></a><span class="lineno"> 8421</span>&#160;                            }</div>
<div class="line"><a name="l08422"></a><span class="lineno"> 8422</span>&#160;                            <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;state&#39;</span>]) AND in_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;state&#39;</span>], $states)) {</div>
<div class="line"><a name="l08423"></a><span class="lineno"> 8423</span>&#160;                                $annots .= <span class="stringliteral">&#39; /State /&#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;state&#39;</span>];</div>
<div class="line"><a name="l08424"></a><span class="lineno"> 8424</span>&#160;                            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l08425"></a><span class="lineno"> 8425</span>&#160;                                <span class="keywordflow">if</span> ($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;statemodel&#39;</span>] == <span class="stringliteral">&#39;Marked&#39;</span>) {</div>
<div class="line"><a name="l08426"></a><span class="lineno"> 8426</span>&#160;                                    $annots .= <span class="stringliteral">&#39; /State /Unmarked&#39;</span>;</div>
<div class="line"><a name="l08427"></a><span class="lineno"> 8427</span>&#160;                                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l08428"></a><span class="lineno"> 8428</span>&#160;                                    $annots .= <span class="stringliteral">&#39; /State /None&#39;</span>;</div>
<div class="line"><a name="l08429"></a><span class="lineno"> 8429</span>&#160;                                }</div>
<div class="line"><a name="l08430"></a><span class="lineno"> 8430</span>&#160;                            }</div>
<div class="line"><a name="l08431"></a><span class="lineno"> 8431</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08432"></a><span class="lineno"> 8432</span>&#160;                        }</div>
<div class="line"><a name="l08433"></a><span class="lineno"> 8433</span>&#160;                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;link&#39;</span>: {</div>
<div class="line"><a name="l08434"></a><span class="lineno"> 8434</span>&#160;                            <span class="keywordflow">if</span> (is_string($pl[<span class="stringliteral">&#39;txt&#39;</span>])) {</div>
<div class="line"><a name="l08435"></a><span class="lineno"> 8435</span>&#160;                                <span class="keywordflow">if</span> ($pl[<span class="stringliteral">&#39;txt&#39;</span>][0] == <span class="charliteral">&#39;#&#39;</span>) {</div>
<div class="line"><a name="l08436"></a><span class="lineno"> 8436</span>&#160;                                    <span class="comment">// internal destination</span></div>
<div class="line"><a name="l08437"></a><span class="lineno"> 8437</span>&#160;                                    $annots .= <span class="stringliteral">&#39; /Dest /&#39;</span>.TCPDF_STATIC::encodeNameObject(substr($pl[<span class="stringliteral">&#39;txt&#39;</span>], 1));</div>
<div class="line"><a name="l08438"></a><span class="lineno"> 8438</span>&#160;                                } elseif ($pl[<span class="stringliteral">&#39;txt&#39;</span>][0] == <span class="charliteral">&#39;%&#39;</span>) {</div>
<div class="line"><a name="l08439"></a><span class="lineno"> 8439</span>&#160;                                    <span class="comment">// embedded PDF file</span></div>
<div class="line"><a name="l08440"></a><span class="lineno"> 8440</span>&#160;                                    $filename = basename(substr($pl[<span class="stringliteral">&#39;txt&#39;</span>], 1));</div>
<div class="line"><a name="l08441"></a><span class="lineno"> 8441</span>&#160;                                    $annots .= <span class="stringliteral">&#39; /A &lt;&lt; /S /GoToE /D [0 /Fit] /NewWindow true /T &lt;&lt; /R /C /P &#39;</span>.($n - 1).<span class="stringliteral">&#39; /A &#39;</span>.$this-&gt;embeddedfiles[$filename][<span class="charliteral">&#39;a&#39;</span>].<span class="stringliteral">&#39; &gt;&gt; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l08442"></a><span class="lineno"> 8442</span>&#160;                                } elseif ($pl[<span class="stringliteral">&#39;txt&#39;</span>][0] == <span class="charliteral">&#39;*&#39;</span>) {</div>
<div class="line"><a name="l08443"></a><span class="lineno"> 8443</span>&#160;                                    <span class="comment">// embedded generic file</span></div>
<div class="line"><a name="l08444"></a><span class="lineno"> 8444</span>&#160;                                    $filename = basename(substr($pl[<span class="stringliteral">&#39;txt&#39;</span>], 1));</div>
<div class="line"><a name="l08445"></a><span class="lineno"> 8445</span>&#160;                                    $jsa = <span class="stringliteral">&#39;var D=event.target.doc;var MyData=D.dataObjects;for (var i in MyData) if (MyData[i].path==&quot;&#39;</span>.$filename.<span class="stringliteral">&#39;&quot;) D.exportDataObject( { cName : MyData[i].name, nLaunch : 2});&#39;</span>;</div>
<div class="line"><a name="l08446"></a><span class="lineno"> 8446</span>&#160;                                    $annots .= <span class="stringliteral">&#39; /A &lt;&lt; /S /JavaScript /JS &#39;</span>.$this-&gt;_textstring($jsa, $annot_obj_id).<span class="stringliteral">&#39;&gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l08447"></a><span class="lineno"> 8447</span>&#160;                                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l08448"></a><span class="lineno"> 8448</span>&#160;                                    $parsedUrl = parse_url($pl[<span class="stringliteral">&#39;txt&#39;</span>]);</div>
<div class="line"><a name="l08449"></a><span class="lineno"> 8449</span>&#160;                                    <span class="keywordflow">if</span> (empty($parsedUrl[<span class="stringliteral">&#39;scheme&#39;</span>]) AND (strtolower(substr($parsedUrl[<span class="stringliteral">&#39;path&#39;</span>], -4)) == <span class="stringliteral">&#39;.pdf&#39;</span>)) {</div>
<div class="line"><a name="l08450"></a><span class="lineno"> 8450</span>&#160;                                        <span class="comment">// relative link to a PDF file</span></div>
<div class="line"><a name="l08451"></a><span class="lineno"> 8451</span>&#160;                                        $dest = <span class="stringliteral">&#39;[0 /Fit]&#39;</span>; <span class="comment">// default page 0</span></div>
<div class="line"><a name="l08452"></a><span class="lineno"> 8452</span>&#160;                                        <span class="keywordflow">if</span> (!empty($parsedUrl[<span class="stringliteral">&#39;fragment&#39;</span>])) {</div>
<div class="line"><a name="l08453"></a><span class="lineno"> 8453</span>&#160;                                            <span class="comment">// check for named destination</span></div>
<div class="line"><a name="l08454"></a><span class="lineno"> 8454</span>&#160;                                            $tmp = explode(<span class="charliteral">&#39;=&#39;</span>, $parsedUrl[<span class="stringliteral">&#39;fragment&#39;</span>]);</div>
<div class="line"><a name="l08455"></a><span class="lineno"> 8455</span>&#160;                                            $dest = <span class="charliteral">&#39;(&#39;</span>.((count($tmp) == 2) ? $tmp[1] : $tmp[0]).<span class="charliteral">&#39;)&#39;</span>;</div>
<div class="line"><a name="l08456"></a><span class="lineno"> 8456</span>&#160;                                        }</div>
<div class="line"><a name="l08457"></a><span class="lineno"> 8457</span>&#160;                                        $annots .= <span class="stringliteral">&#39; /A &lt;&lt;/S /GoToR /D &#39;</span>.$dest.<span class="stringliteral">&#39; /F &#39;</span>.$this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ad4357fbfe88ee671132009ca8bb199ef">_datastring</a>($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ae4bdb1a4c29d0a0d707caad308dcd320">unhtmlentities</a>($parsedUrl[<span class="stringliteral">&#39;path&#39;</span>]), $annot_obj_id).<span class="stringliteral">&#39; /NewWindow true&gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l08458"></a><span class="lineno"> 8458</span>&#160;                                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l08459"></a><span class="lineno"> 8459</span>&#160;                                        <span class="comment">// external URI link</span></div>
<div class="line"><a name="l08460"></a><span class="lineno"> 8460</span>&#160;                                        $annots .= <span class="stringliteral">&#39; /A &lt;&lt;/S /URI /URI &#39;</span>.$this-&gt;_datastring($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ae4bdb1a4c29d0a0d707caad308dcd320">unhtmlentities</a>($pl[<span class="stringliteral">&#39;txt&#39;</span>]), $annot_obj_id).<span class="stringliteral">&#39;&gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l08461"></a><span class="lineno"> 8461</span>&#160;                                    }</div>
<div class="line"><a name="l08462"></a><span class="lineno"> 8462</span>&#160;                                }</div>
<div class="line"><a name="l08463"></a><span class="lineno"> 8463</span>&#160;                            } elseif (isset($this-&gt;links[$pl[<span class="stringliteral">&#39;txt&#39;</span>]])) {</div>
<div class="line"><a name="l08464"></a><span class="lineno"> 8464</span>&#160;                                <span class="comment">// internal link ID</span></div>
<div class="line"><a name="l08465"></a><span class="lineno"> 8465</span>&#160;                                <a class="code" href="../../d4/d40/classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f">$l</a> = $this-&gt;links[$pl[<span class="stringliteral">&#39;txt&#39;</span>]];</div>
<div class="line"><a name="l08466"></a><span class="lineno"> 8466</span>&#160;                                <span class="keywordflow">if</span> (isset($this-&gt;page_obj_id[(<a class="code" href="../../d4/d40/classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f">$l</a>[<span class="charliteral">&#39;p&#39;</span>])])) {</div>
<div class="line"><a name="l08467"></a><span class="lineno"> 8467</span>&#160;                                    $annots .= sprintf(<span class="stringliteral">&#39; /Dest [%u 0 R /XYZ 0 %F null]&#39;</span>, $this-&gt;page_obj_id[(<a class="code" href="../../d4/d40/classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f">$l</a>[<span class="charliteral">&#39;p&#39;</span>])], ($this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f">$l</a>[<span class="charliteral">&#39;p&#39;</span>]][<span class="charliteral">&#39;h&#39;</span>] - (<a class="code" href="../../d4/d40/classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f">$l</a>[<span class="charliteral">&#39;y&#39;</span>] * $this-&gt;k)));</div>
<div class="line"><a name="l08468"></a><span class="lineno"> 8468</span>&#160;                                }</div>
<div class="line"><a name="l08469"></a><span class="lineno"> 8469</span>&#160;                            }</div>
<div class="line"><a name="l08470"></a><span class="lineno"> 8470</span>&#160;                            $hmodes = array(<span class="charliteral">&#39;N&#39;</span>, <span class="charliteral">&#39;I&#39;</span>, <span class="charliteral">&#39;O&#39;</span>, <span class="charliteral">&#39;P&#39;</span>);</div>
<div class="line"><a name="l08471"></a><span class="lineno"> 8471</span>&#160;                            <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;h&#39;</span>]) AND in_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;h&#39;</span>], $hmodes)) {</div>
<div class="line"><a name="l08472"></a><span class="lineno"> 8472</span>&#160;                                $annots .= <span class="stringliteral">&#39; /H /&#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;h&#39;</span>];</div>
<div class="line"><a name="l08473"></a><span class="lineno"> 8473</span>&#160;                            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l08474"></a><span class="lineno"> 8474</span>&#160;                                $annots .= <span class="stringliteral">&#39; /H /I&#39;</span>;</div>
<div class="line"><a name="l08475"></a><span class="lineno"> 8475</span>&#160;                            }</div>
<div class="line"><a name="l08476"></a><span class="lineno"> 8476</span>&#160;                            <span class="comment">//$annots .= &#39; /PA &#39;;</span></div>
<div class="line"><a name="l08477"></a><span class="lineno"> 8477</span>&#160;                            <span class="comment">//$annots .= &#39; /Quadpoints &#39;;</span></div>
<div class="line"><a name="l08478"></a><span class="lineno"> 8478</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08479"></a><span class="lineno"> 8479</span>&#160;                        }</div>
<div class="line"><a name="l08480"></a><span class="lineno"> 8480</span>&#160;                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;freetext&#39;</span>: {</div>
<div class="line"><a name="l08481"></a><span class="lineno"> 8481</span>&#160;                            <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;da&#39;</span>]) AND !empty($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;da&#39;</span>])) {</div>
<div class="line"><a name="l08482"></a><span class="lineno"> 8482</span>&#160;                                $annots .= <span class="stringliteral">&#39; /DA (&#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;da&#39;</span>].<span class="charliteral">&#39;)&#39;</span>;</div>
<div class="line"><a name="l08483"></a><span class="lineno"> 8483</span>&#160;                            }</div>
<div class="line"><a name="l08484"></a><span class="lineno"> 8484</span>&#160;                            <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;q&#39;</span>]) AND ($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;q&#39;</span>] &gt;= 0) AND ($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;q&#39;</span>] &lt;= 2)) {</div>
<div class="line"><a name="l08485"></a><span class="lineno"> 8485</span>&#160;                                $annots .= <span class="stringliteral">&#39; /Q &#39;</span>.intval($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;q&#39;</span>]);</div>
<div class="line"><a name="l08486"></a><span class="lineno"> 8486</span>&#160;                            }</div>
<div class="line"><a name="l08487"></a><span class="lineno"> 8487</span>&#160;                            <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;rc&#39;</span>])) {</div>
<div class="line"><a name="l08488"></a><span class="lineno"> 8488</span>&#160;                                $annots .= <span class="stringliteral">&#39; /RC &#39;</span>.$this-&gt;_textstring($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;rc&#39;</span>], $annot_obj_id);</div>
<div class="line"><a name="l08489"></a><span class="lineno"> 8489</span>&#160;                            }</div>
<div class="line"><a name="l08490"></a><span class="lineno"> 8490</span>&#160;                            <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;ds&#39;</span>])) {</div>
<div class="line"><a name="l08491"></a><span class="lineno"> 8491</span>&#160;                                $annots .= <span class="stringliteral">&#39; /DS &#39;</span>.$this-&gt;_textstring($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;ds&#39;</span>], $annot_obj_id);</div>
<div class="line"><a name="l08492"></a><span class="lineno"> 8492</span>&#160;                            }</div>
<div class="line"><a name="l08493"></a><span class="lineno"> 8493</span>&#160;                            <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;cl&#39;</span>]) AND is_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;cl&#39;</span>])) {</div>
<div class="line"><a name="l08494"></a><span class="lineno"> 8494</span>&#160;                                $annots .= <span class="stringliteral">&#39; /CL [&#39;</span>;</div>
<div class="line"><a name="l08495"></a><span class="lineno"> 8495</span>&#160;                                <span class="keywordflow">foreach</span> ($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;cl&#39;</span>] as $cl) {</div>
<div class="line"><a name="l08496"></a><span class="lineno"> 8496</span>&#160;                                    $annots .= sprintf(<span class="stringliteral">&#39;%F &#39;</span>, $cl * $this-&gt;k);</div>
<div class="line"><a name="l08497"></a><span class="lineno"> 8497</span>&#160;                                }</div>
<div class="line"><a name="l08498"></a><span class="lineno"> 8498</span>&#160;                                $annots .= <span class="charliteral">&#39;]&#39;</span>;</div>
<div class="line"><a name="l08499"></a><span class="lineno"> 8499</span>&#160;                            }</div>
<div class="line"><a name="l08500"></a><span class="lineno"> 8500</span>&#160;                            $tfit = array(<span class="stringliteral">&#39;FreeText&#39;</span>, <span class="stringliteral">&#39;FreeTextCallout&#39;</span>, <span class="stringliteral">&#39;FreeTextTypeWriter&#39;</span>);</div>
<div class="line"><a name="l08501"></a><span class="lineno"> 8501</span>&#160;                            <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;it&#39;</span>]) AND in_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;it&#39;</span>], $tfit)) {</div>
<div class="line"><a name="l08502"></a><span class="lineno"> 8502</span>&#160;                                $annots .= <span class="stringliteral">&#39; /IT /&#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;it&#39;</span>];</div>
<div class="line"><a name="l08503"></a><span class="lineno"> 8503</span>&#160;                            }</div>
<div class="line"><a name="l08504"></a><span class="lineno"> 8504</span>&#160;                            <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;rd&#39;</span>]) AND is_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;rd&#39;</span>])) {</div>
<div class="line"><a name="l08505"></a><span class="lineno"> 8505</span>&#160;                                <a class="code" href="../../d4/d40/classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f">$l</a> = $pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;rd&#39;</span>][0] * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>;</div>
<div class="line"><a name="l08506"></a><span class="lineno"> 8506</span>&#160;                                $r = $pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;rd&#39;</span>][1] * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>;</div>
<div class="line"><a name="l08507"></a><span class="lineno"> 8507</span>&#160;                                $t = $pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;rd&#39;</span>][2] * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>;</div>
<div class="line"><a name="l08508"></a><span class="lineno"> 8508</span>&#160;                                $b = $pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;rd&#39;</span>][3] * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>;</div>
<div class="line"><a name="l08509"></a><span class="lineno"> 8509</span>&#160;                                $annots .= <span class="stringliteral">&#39; /RD [&#39;</span>.sprintf(<span class="stringliteral">&#39;%F %F %F %F&#39;</span>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f">$l</a>, $r, $t, $b).<span class="charliteral">&#39;]&#39;</span>;</div>
<div class="line"><a name="l08510"></a><span class="lineno"> 8510</span>&#160;                            }</div>
<div class="line"><a name="l08511"></a><span class="lineno"> 8511</span>&#160;                            <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;le&#39;</span>]) AND in_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;le&#39;</span>], $lineendings)) {</div>
<div class="line"><a name="l08512"></a><span class="lineno"> 8512</span>&#160;                                $annots .= <span class="stringliteral">&#39; /LE /&#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;le&#39;</span>];</div>
<div class="line"><a name="l08513"></a><span class="lineno"> 8513</span>&#160;                            }</div>
<div class="line"><a name="l08514"></a><span class="lineno"> 8514</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08515"></a><span class="lineno"> 8515</span>&#160;                        }</div>
<div class="line"><a name="l08516"></a><span class="lineno"> 8516</span>&#160;                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;line&#39;</span>: {</div>
<div class="line"><a name="l08517"></a><span class="lineno"> 8517</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08518"></a><span class="lineno"> 8518</span>&#160;                        }</div>
<div class="line"><a name="l08519"></a><span class="lineno"> 8519</span>&#160;                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;square&#39;</span>: {</div>
<div class="line"><a name="l08520"></a><span class="lineno"> 8520</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08521"></a><span class="lineno"> 8521</span>&#160;                        }</div>
<div class="line"><a name="l08522"></a><span class="lineno"> 8522</span>&#160;                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;circle&#39;</span>: {</div>
<div class="line"><a name="l08523"></a><span class="lineno"> 8523</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08524"></a><span class="lineno"> 8524</span>&#160;                        }</div>
<div class="line"><a name="l08525"></a><span class="lineno"> 8525</span>&#160;                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;polygon&#39;</span>: {</div>
<div class="line"><a name="l08526"></a><span class="lineno"> 8526</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08527"></a><span class="lineno"> 8527</span>&#160;                        }</div>
<div class="line"><a name="l08528"></a><span class="lineno"> 8528</span>&#160;                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;polyline&#39;</span>: {</div>
<div class="line"><a name="l08529"></a><span class="lineno"> 8529</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08530"></a><span class="lineno"> 8530</span>&#160;                        }</div>
<div class="line"><a name="l08531"></a><span class="lineno"> 8531</span>&#160;                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;highlight&#39;</span>: {</div>
<div class="line"><a name="l08532"></a><span class="lineno"> 8532</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08533"></a><span class="lineno"> 8533</span>&#160;                        }</div>
<div class="line"><a name="l08534"></a><span class="lineno"> 8534</span>&#160;                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;underline&#39;</span>: {</div>
<div class="line"><a name="l08535"></a><span class="lineno"> 8535</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08536"></a><span class="lineno"> 8536</span>&#160;                        }</div>
<div class="line"><a name="l08537"></a><span class="lineno"> 8537</span>&#160;                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;squiggly&#39;</span>: {</div>
<div class="line"><a name="l08538"></a><span class="lineno"> 8538</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08539"></a><span class="lineno"> 8539</span>&#160;                        }</div>
<div class="line"><a name="l08540"></a><span class="lineno"> 8540</span>&#160;                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;strikeout&#39;</span>: {</div>
<div class="line"><a name="l08541"></a><span class="lineno"> 8541</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08542"></a><span class="lineno"> 8542</span>&#160;                        }</div>
<div class="line"><a name="l08543"></a><span class="lineno"> 8543</span>&#160;                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;stamp&#39;</span>: {</div>
<div class="line"><a name="l08544"></a><span class="lineno"> 8544</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08545"></a><span class="lineno"> 8545</span>&#160;                        }</div>
<div class="line"><a name="l08546"></a><span class="lineno"> 8546</span>&#160;                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;caret&#39;</span>: {</div>
<div class="line"><a name="l08547"></a><span class="lineno"> 8547</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08548"></a><span class="lineno"> 8548</span>&#160;                        }</div>
<div class="line"><a name="l08549"></a><span class="lineno"> 8549</span>&#160;                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;ink&#39;</span>: {</div>
<div class="line"><a name="l08550"></a><span class="lineno"> 8550</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08551"></a><span class="lineno"> 8551</span>&#160;                        }</div>
<div class="line"><a name="l08552"></a><span class="lineno"> 8552</span>&#160;                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;popup&#39;</span>: {</div>
<div class="line"><a name="l08553"></a><span class="lineno"> 8553</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08554"></a><span class="lineno"> 8554</span>&#160;                        }</div>
<div class="line"><a name="l08555"></a><span class="lineno"> 8555</span>&#160;                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;fileattachment&#39;</span>: {</div>
<div class="line"><a name="l08556"></a><span class="lineno"> 8556</span>&#160;                            <span class="keywordflow">if</span> ($this-&gt;pdfa_mode) {</div>
<div class="line"><a name="l08557"></a><span class="lineno"> 8557</span>&#160;                                <span class="comment">// embedded files are not allowed in PDF/A mode</span></div>
<div class="line"><a name="l08558"></a><span class="lineno"> 8558</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08559"></a><span class="lineno"> 8559</span>&#160;                            }</div>
<div class="line"><a name="l08560"></a><span class="lineno"> 8560</span>&#160;                            <span class="keywordflow">if</span> (!isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;fs&#39;</span>])) {</div>
<div class="line"><a name="l08561"></a><span class="lineno"> 8561</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08562"></a><span class="lineno"> 8562</span>&#160;                            }</div>
<div class="line"><a name="l08563"></a><span class="lineno"> 8563</span>&#160;                            $filename = basename($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;fs&#39;</span>]);</div>
<div class="line"><a name="l08564"></a><span class="lineno"> 8564</span>&#160;                            <span class="keywordflow">if</span> (isset($this-&gt;embeddedfiles[$filename][<span class="charliteral">&#39;f&#39;</span>])) {</div>
<div class="line"><a name="l08565"></a><span class="lineno"> 8565</span>&#160;                                $annots .= <span class="stringliteral">&#39; /FS &#39;</span>.$this-&gt;embeddedfiles[$filename][<span class="charliteral">&#39;f&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l08566"></a><span class="lineno"> 8566</span>&#160;                                $iconsapp = array(<span class="stringliteral">&#39;Graph&#39;</span>, <span class="stringliteral">&#39;Paperclip&#39;</span>, <span class="stringliteral">&#39;PushPin&#39;</span>, <span class="stringliteral">&#39;Tag&#39;</span>);</div>
<div class="line"><a name="l08567"></a><span class="lineno"> 8567</span>&#160;                                <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;name&#39;</span>]) AND in_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;name&#39;</span>], $iconsapp)) {</div>
<div class="line"><a name="l08568"></a><span class="lineno"> 8568</span>&#160;                                    $annots .= <span class="stringliteral">&#39; /Name /&#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;name&#39;</span>];</div>
<div class="line"><a name="l08569"></a><span class="lineno"> 8569</span>&#160;                                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l08570"></a><span class="lineno"> 8570</span>&#160;                                    $annots .= <span class="stringliteral">&#39; /Name /PushPin&#39;</span>;</div>
<div class="line"><a name="l08571"></a><span class="lineno"> 8571</span>&#160;                                }</div>
<div class="line"><a name="l08572"></a><span class="lineno"> 8572</span>&#160;                                <span class="comment">// index (zero-based) of the annotation in the Annots array of this page</span></div>
<div class="line"><a name="l08573"></a><span class="lineno"> 8573</span>&#160;                                $this-&gt;embeddedfiles[$filename][<span class="charliteral">&#39;a&#39;</span>] = $key;</div>
<div class="line"><a name="l08574"></a><span class="lineno"> 8574</span>&#160;                            }</div>
<div class="line"><a name="l08575"></a><span class="lineno"> 8575</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08576"></a><span class="lineno"> 8576</span>&#160;                        }</div>
<div class="line"><a name="l08577"></a><span class="lineno"> 8577</span>&#160;                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;sound&#39;</span>: {</div>
<div class="line"><a name="l08578"></a><span class="lineno"> 8578</span>&#160;                            <span class="keywordflow">if</span> (!isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;fs&#39;</span>])) {</div>
<div class="line"><a name="l08579"></a><span class="lineno"> 8579</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08580"></a><span class="lineno"> 8580</span>&#160;                            }</div>
<div class="line"><a name="l08581"></a><span class="lineno"> 8581</span>&#160;                            $filename = basename($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;fs&#39;</span>]);</div>
<div class="line"><a name="l08582"></a><span class="lineno"> 8582</span>&#160;                            <span class="keywordflow">if</span> (isset($this-&gt;embeddedfiles[$filename][<span class="charliteral">&#39;f&#39;</span>])) {</div>
<div class="line"><a name="l08583"></a><span class="lineno"> 8583</span>&#160;                                <span class="comment">// ... TO BE COMPLETED ...</span></div>
<div class="line"><a name="l08584"></a><span class="lineno"> 8584</span>&#160;                                <span class="comment">// /R /C /B /E /CO /CP</span></div>
<div class="line"><a name="l08585"></a><span class="lineno"> 8585</span>&#160;                                $annots .= <span class="stringliteral">&#39; /Sound &#39;</span>.$this-&gt;embeddedfiles[$filename][<span class="charliteral">&#39;f&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l08586"></a><span class="lineno"> 8586</span>&#160;                                $iconsapp = array(<span class="stringliteral">&#39;Speaker&#39;</span>, <span class="stringliteral">&#39;Mic&#39;</span>);</div>
<div class="line"><a name="l08587"></a><span class="lineno"> 8587</span>&#160;                                <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;name&#39;</span>]) AND in_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;name&#39;</span>], $iconsapp)) {</div>
<div class="line"><a name="l08588"></a><span class="lineno"> 8588</span>&#160;                                    $annots .= <span class="stringliteral">&#39; /Name /&#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;name&#39;</span>];</div>
<div class="line"><a name="l08589"></a><span class="lineno"> 8589</span>&#160;                                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l08590"></a><span class="lineno"> 8590</span>&#160;                                    $annots .= <span class="stringliteral">&#39; /Name /Speaker&#39;</span>;</div>
<div class="line"><a name="l08591"></a><span class="lineno"> 8591</span>&#160;                                }</div>
<div class="line"><a name="l08592"></a><span class="lineno"> 8592</span>&#160;                            }</div>
<div class="line"><a name="l08593"></a><span class="lineno"> 8593</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08594"></a><span class="lineno"> 8594</span>&#160;                        }</div>
<div class="line"><a name="l08595"></a><span class="lineno"> 8595</span>&#160;                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;movie&#39;</span>: {</div>
<div class="line"><a name="l08596"></a><span class="lineno"> 8596</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08597"></a><span class="lineno"> 8597</span>&#160;                        }</div>
<div class="line"><a name="l08598"></a><span class="lineno"> 8598</span>&#160;                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;widget&#39;</span>: {</div>
<div class="line"><a name="l08599"></a><span class="lineno"> 8599</span>&#160;                            $hmode = array(<span class="charliteral">&#39;N&#39;</span>, <span class="charliteral">&#39;I&#39;</span>, <span class="charliteral">&#39;O&#39;</span>, <span class="charliteral">&#39;P&#39;</span>, <span class="charliteral">&#39;T&#39;</span>);</div>
<div class="line"><a name="l08600"></a><span class="lineno"> 8600</span>&#160;                            <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;h&#39;</span>]) AND in_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;h&#39;</span>], $hmode)) {</div>
<div class="line"><a name="l08601"></a><span class="lineno"> 8601</span>&#160;                                $annots .= <span class="stringliteral">&#39; /H /&#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;h&#39;</span>];</div>
<div class="line"><a name="l08602"></a><span class="lineno"> 8602</span>&#160;                            }</div>
<div class="line"><a name="l08603"></a><span class="lineno"> 8603</span>&#160;                            <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>]) AND (is_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>])) AND !empty($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>])) {</div>
<div class="line"><a name="l08604"></a><span class="lineno"> 8604</span>&#160;                                $annots .= <span class="stringliteral">&#39; /MK &lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l08605"></a><span class="lineno"> 8605</span>&#160;                                <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="charliteral">&#39;r&#39;</span>])) {</div>
<div class="line"><a name="l08606"></a><span class="lineno"> 8606</span>&#160;                                    $annots .= <span class="stringliteral">&#39; /R &#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="charliteral">&#39;r&#39;</span>];</div>
<div class="line"><a name="l08607"></a><span class="lineno"> 8607</span>&#160;                                }</div>
<div class="line"><a name="l08608"></a><span class="lineno"> 8608</span>&#160;                                <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;bc&#39;</span>]) AND (is_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;bc&#39;</span>]))) {</div>
<div class="line"><a name="l08609"></a><span class="lineno"> 8609</span>&#160;                                    $annots .= <span class="stringliteral">&#39; /BC &#39;</span>.TCPDF_COLORS::getColorStringFromArray($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;bc&#39;</span>]);</div>
<div class="line"><a name="l08610"></a><span class="lineno"> 8610</span>&#160;                                }</div>
<div class="line"><a name="l08611"></a><span class="lineno"> 8611</span>&#160;                                <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;bg&#39;</span>]) AND (is_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;bg&#39;</span>]))) {</div>
<div class="line"><a name="l08612"></a><span class="lineno"> 8612</span>&#160;                                    $annots .= <span class="stringliteral">&#39; /BG &#39;</span>.TCPDF_COLORS::getColorStringFromArray($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;bg&#39;</span>]);</div>
<div class="line"><a name="l08613"></a><span class="lineno"> 8613</span>&#160;                                }</div>
<div class="line"><a name="l08614"></a><span class="lineno"> 8614</span>&#160;                                <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;ca&#39;</span>])) {</div>
<div class="line"><a name="l08615"></a><span class="lineno"> 8615</span>&#160;                                    $annots .= <span class="stringliteral">&#39; /CA &#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;ca&#39;</span>];</div>
<div class="line"><a name="l08616"></a><span class="lineno"> 8616</span>&#160;                                }</div>
<div class="line"><a name="l08617"></a><span class="lineno"> 8617</span>&#160;                                <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;rc&#39;</span>])) {</div>
<div class="line"><a name="l08618"></a><span class="lineno"> 8618</span>&#160;                                    $annots .= <span class="stringliteral">&#39; /RC &#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;rc&#39;</span>];</div>
<div class="line"><a name="l08619"></a><span class="lineno"> 8619</span>&#160;                                }</div>
<div class="line"><a name="l08620"></a><span class="lineno"> 8620</span>&#160;                                <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;ac&#39;</span>])) {</div>
<div class="line"><a name="l08621"></a><span class="lineno"> 8621</span>&#160;                                    $annots .= <span class="stringliteral">&#39; /AC &#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;ac&#39;</span>];</div>
<div class="line"><a name="l08622"></a><span class="lineno"> 8622</span>&#160;                                }</div>
<div class="line"><a name="l08623"></a><span class="lineno"> 8623</span>&#160;                                <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="charliteral">&#39;i&#39;</span>])) {</div>
<div class="line"><a name="l08624"></a><span class="lineno"> 8624</span>&#160;                                    $info = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1a003edf69be144993c85c07a220315c">getImageBuffer</a>($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="charliteral">&#39;i&#39;</span>]);</div>
<div class="line"><a name="l08625"></a><span class="lineno"> 8625</span>&#160;                                    <span class="keywordflow">if</span> ($info !== <span class="keyword">false</span>) {</div>
<div class="line"><a name="l08626"></a><span class="lineno"> 8626</span>&#160;                                        $annots .= <span class="stringliteral">&#39; /I &#39;</span>.$info[<span class="charliteral">&#39;n&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l08627"></a><span class="lineno"> 8627</span>&#160;                                    }</div>
<div class="line"><a name="l08628"></a><span class="lineno"> 8628</span>&#160;                                }</div>
<div class="line"><a name="l08629"></a><span class="lineno"> 8629</span>&#160;                                <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;ri&#39;</span>])) {</div>
<div class="line"><a name="l08630"></a><span class="lineno"> 8630</span>&#160;                                    $info = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1a003edf69be144993c85c07a220315c">getImageBuffer</a>($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;ri&#39;</span>]);</div>
<div class="line"><a name="l08631"></a><span class="lineno"> 8631</span>&#160;                                    <span class="keywordflow">if</span> ($info !== <span class="keyword">false</span>) {</div>
<div class="line"><a name="l08632"></a><span class="lineno"> 8632</span>&#160;                                        $annots .= <span class="stringliteral">&#39; /RI &#39;</span>.$info[<span class="charliteral">&#39;n&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l08633"></a><span class="lineno"> 8633</span>&#160;                                    }</div>
<div class="line"><a name="l08634"></a><span class="lineno"> 8634</span>&#160;                                }</div>
<div class="line"><a name="l08635"></a><span class="lineno"> 8635</span>&#160;                                <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;ix&#39;</span>])) {</div>
<div class="line"><a name="l08636"></a><span class="lineno"> 8636</span>&#160;                                    $info = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1a003edf69be144993c85c07a220315c">getImageBuffer</a>($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;ix&#39;</span>]);</div>
<div class="line"><a name="l08637"></a><span class="lineno"> 8637</span>&#160;                                    <span class="keywordflow">if</span> ($info !== <span class="keyword">false</span>) {</div>
<div class="line"><a name="l08638"></a><span class="lineno"> 8638</span>&#160;                                        $annots .= <span class="stringliteral">&#39; /IX &#39;</span>.$info[<span class="charliteral">&#39;n&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l08639"></a><span class="lineno"> 8639</span>&#160;                                    }</div>
<div class="line"><a name="l08640"></a><span class="lineno"> 8640</span>&#160;                                }</div>
<div class="line"><a name="l08641"></a><span class="lineno"> 8641</span>&#160;                                <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>]) AND (is_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>])) AND !empty($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>])) {</div>
<div class="line"><a name="l08642"></a><span class="lineno"> 8642</span>&#160;                                    $annots .= <span class="stringliteral">&#39; /IF &lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l08643"></a><span class="lineno"> 8643</span>&#160;                                    $if_sw = array(<span class="charliteral">&#39;A&#39;</span>, <span class="charliteral">&#39;B&#39;</span>, <span class="charliteral">&#39;S&#39;</span>, <span class="charliteral">&#39;N&#39;</span>);</div>
<div class="line"><a name="l08644"></a><span class="lineno"> 8644</span>&#160;                                    <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>][<span class="stringliteral">&#39;sw&#39;</span>]) AND in_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>][<span class="stringliteral">&#39;sw&#39;</span>], $if_sw)) {</div>
<div class="line"><a name="l08645"></a><span class="lineno"> 8645</span>&#160;                                        $annots .= <span class="stringliteral">&#39; /SW /&#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>][<span class="stringliteral">&#39;sw&#39;</span>];</div>
<div class="line"><a name="l08646"></a><span class="lineno"> 8646</span>&#160;                                    }</div>
<div class="line"><a name="l08647"></a><span class="lineno"> 8647</span>&#160;                                    $if_s = array(<span class="charliteral">&#39;A&#39;</span>, <span class="charliteral">&#39;P&#39;</span>);</div>
<div class="line"><a name="l08648"></a><span class="lineno"> 8648</span>&#160;                                    <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>][<span class="charliteral">&#39;s&#39;</span>]) AND in_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>][<span class="charliteral">&#39;s&#39;</span>], $if_s)) {</div>
<div class="line"><a name="l08649"></a><span class="lineno"> 8649</span>&#160;                                        $annots .= <span class="stringliteral">&#39; /S /&#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>][<span class="charliteral">&#39;s&#39;</span>];</div>
<div class="line"><a name="l08650"></a><span class="lineno"> 8650</span>&#160;                                    }</div>
<div class="line"><a name="l08651"></a><span class="lineno"> 8651</span>&#160;                                    <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>][<span class="charliteral">&#39;a&#39;</span>]) AND (is_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>][<span class="charliteral">&#39;a&#39;</span>])) AND !empty($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>][<span class="charliteral">&#39;a&#39;</span>])) {</div>
<div class="line"><a name="l08652"></a><span class="lineno"> 8652</span>&#160;                                        $annots .= sprintf(<span class="stringliteral">&#39; /A [%F %F]&#39;</span>, $pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>][<span class="charliteral">&#39;a&#39;</span>][0], $pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>][<span class="charliteral">&#39;a&#39;</span>][1]);</div>
<div class="line"><a name="l08653"></a><span class="lineno"> 8653</span>&#160;                                    }</div>
<div class="line"><a name="l08654"></a><span class="lineno"> 8654</span>&#160;                                    <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>][<span class="stringliteral">&#39;fb&#39;</span>]) AND ($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>][<span class="stringliteral">&#39;fb&#39;</span>])) {</div>
<div class="line"><a name="l08655"></a><span class="lineno"> 8655</span>&#160;                                        $annots .= <span class="stringliteral">&#39; /FB true&#39;</span>;</div>
<div class="line"><a name="l08656"></a><span class="lineno"> 8656</span>&#160;                                    }</div>
<div class="line"><a name="l08657"></a><span class="lineno"> 8657</span>&#160;                                    $annots .= <span class="stringliteral">&#39;&gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l08658"></a><span class="lineno"> 8658</span>&#160;                                }</div>
<div class="line"><a name="l08659"></a><span class="lineno"> 8659</span>&#160;                                <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;tp&#39;</span>]) AND ($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;tp&#39;</span>] &gt;= 0) AND ($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;tp&#39;</span>] &lt;= 6)) {</div>
<div class="line"><a name="l08660"></a><span class="lineno"> 8660</span>&#160;                                    $annots .= <span class="stringliteral">&#39; /TP &#39;</span>.intval($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;tp&#39;</span>]);</div>
<div class="line"><a name="l08661"></a><span class="lineno"> 8661</span>&#160;                                }</div>
<div class="line"><a name="l08662"></a><span class="lineno"> 8662</span>&#160;                                $annots .= <span class="stringliteral">&#39;&gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l08663"></a><span class="lineno"> 8663</span>&#160;                            } <span class="comment">// end MK</span></div>
<div class="line"><a name="l08664"></a><span class="lineno"> 8664</span>&#160;                            <span class="comment">// --- Entries for field dictionaries ---</span></div>
<div class="line"><a name="l08665"></a><span class="lineno"> 8665</span>&#160;                            <span class="keywordflow">if</span> (isset($this-&gt;radiobutton_groups[$n][$pl[<span class="stringliteral">&#39;txt&#39;</span>]])) {</div>
<div class="line"><a name="l08666"></a><span class="lineno"> 8666</span>&#160;                                <span class="comment">// set parent</span></div>
<div class="line"><a name="l08667"></a><span class="lineno"> 8667</span>&#160;                                $annots .= <span class="stringliteral">&#39; /Parent &#39;</span>.$this-&gt;radiobutton_groups[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][$pl[<span class="stringliteral">&#39;txt&#39;</span>]].<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l08668"></a><span class="lineno"> 8668</span>&#160;                            }</div>
<div class="line"><a name="l08669"></a><span class="lineno"> 8669</span>&#160;                            <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;t&#39;</span>]) AND is_string($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;t&#39;</span>])) {</div>
<div class="line"><a name="l08670"></a><span class="lineno"> 8670</span>&#160;                                $annots .= <span class="stringliteral">&#39; /T &#39;</span>.$this-&gt;_datastring($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;t&#39;</span>], $annot_obj_id);</div>
<div class="line"><a name="l08671"></a><span class="lineno"> 8671</span>&#160;                            }</div>
<div class="line"><a name="l08672"></a><span class="lineno"> 8672</span>&#160;                            <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;tu&#39;</span>]) AND is_string($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;tu&#39;</span>])) {</div>
<div class="line"><a name="l08673"></a><span class="lineno"> 8673</span>&#160;                                $annots .= <span class="stringliteral">&#39; /TU &#39;</span>.$this-&gt;_datastring($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;tu&#39;</span>], $annot_obj_id);</div>
<div class="line"><a name="l08674"></a><span class="lineno"> 8674</span>&#160;                            }</div>
<div class="line"><a name="l08675"></a><span class="lineno"> 8675</span>&#160;                            <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;tm&#39;</span>]) AND is_string($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;tm&#39;</span>])) {</div>
<div class="line"><a name="l08676"></a><span class="lineno"> 8676</span>&#160;                                $annots .= <span class="stringliteral">&#39; /TM &#39;</span>.$this-&gt;_datastring($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;tm&#39;</span>], $annot_obj_id);</div>
<div class="line"><a name="l08677"></a><span class="lineno"> 8677</span>&#160;                            }</div>
<div class="line"><a name="l08678"></a><span class="lineno"> 8678</span>&#160;                            <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;ff&#39;</span>])) {</div>
<div class="line"><a name="l08679"></a><span class="lineno"> 8679</span>&#160;                                <span class="keywordflow">if</span> (is_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;ff&#39;</span>])) {</div>
<div class="line"><a name="l08680"></a><span class="lineno"> 8680</span>&#160;                                    <span class="comment">// array of bit settings</span></div>
<div class="line"><a name="l08681"></a><span class="lineno"> 8681</span>&#160;                                    $flag = 0;</div>
<div class="line"><a name="l08682"></a><span class="lineno"> 8682</span>&#160;                                    <span class="keywordflow">foreach</span>($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;ff&#39;</span>] as $val) {</div>
<div class="line"><a name="l08683"></a><span class="lineno"> 8683</span>&#160;                                        $flag += 1 &lt;&lt; ($val - 1);</div>
<div class="line"><a name="l08684"></a><span class="lineno"> 8684</span>&#160;                                    }</div>
<div class="line"><a name="l08685"></a><span class="lineno"> 8685</span>&#160;                                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l08686"></a><span class="lineno"> 8686</span>&#160;                                    $flag = intval($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;ff&#39;</span>]);</div>
<div class="line"><a name="l08687"></a><span class="lineno"> 8687</span>&#160;                                }</div>
<div class="line"><a name="l08688"></a><span class="lineno"> 8688</span>&#160;                                $annots .= <span class="stringliteral">&#39; /Ff &#39;</span>.$flag;</div>
<div class="line"><a name="l08689"></a><span class="lineno"> 8689</span>&#160;                            }</div>
<div class="line"><a name="l08690"></a><span class="lineno"> 8690</span>&#160;                            <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;maxlen&#39;</span>])) {</div>
<div class="line"><a name="l08691"></a><span class="lineno"> 8691</span>&#160;                                $annots .= <span class="stringliteral">&#39; /MaxLen &#39;</span>.intval($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;maxlen&#39;</span>]);</div>
<div class="line"><a name="l08692"></a><span class="lineno"> 8692</span>&#160;                            }</div>
<div class="line"><a name="l08693"></a><span class="lineno"> 8693</span>&#160;                            <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;v&#39;</span>])) {</div>
<div class="line"><a name="l08694"></a><span class="lineno"> 8694</span>&#160;                                $annots .= <span class="stringliteral">&#39; /V&#39;</span>;</div>
<div class="line"><a name="l08695"></a><span class="lineno"> 8695</span>&#160;                                <span class="keywordflow">if</span> (is_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;v&#39;</span>])) {</div>
<div class="line"><a name="l08696"></a><span class="lineno"> 8696</span>&#160;                                    <span class="keywordflow">foreach</span> ($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;v&#39;</span>] AS $optval) {</div>
<div class="line"><a name="l08697"></a><span class="lineno"> 8697</span>&#160;                                        <span class="keywordflow">if</span> (is_float($optval)) {</div>
<div class="line"><a name="l08698"></a><span class="lineno"> 8698</span>&#160;                                            $optval = sprintf(<span class="stringliteral">&#39;%F&#39;</span>, $optval);</div>
<div class="line"><a name="l08699"></a><span class="lineno"> 8699</span>&#160;                                        }</div>
<div class="line"><a name="l08700"></a><span class="lineno"> 8700</span>&#160;                                        $annots .= <span class="charliteral">&#39; &#39;</span>.$optval;</div>
<div class="line"><a name="l08701"></a><span class="lineno"> 8701</span>&#160;                                    }</div>
<div class="line"><a name="l08702"></a><span class="lineno"> 8702</span>&#160;                                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l08703"></a><span class="lineno"> 8703</span>&#160;                                    $annots .= <span class="charliteral">&#39; &#39;</span>.$this-&gt;_textstring($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;v&#39;</span>], $annot_obj_id);</div>
<div class="line"><a name="l08704"></a><span class="lineno"> 8704</span>&#160;                                }</div>
<div class="line"><a name="l08705"></a><span class="lineno"> 8705</span>&#160;                            }</div>
<div class="line"><a name="l08706"></a><span class="lineno"> 8706</span>&#160;                            <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;dv&#39;</span>])) {</div>
<div class="line"><a name="l08707"></a><span class="lineno"> 8707</span>&#160;                                $annots .= <span class="stringliteral">&#39; /DV&#39;</span>;</div>
<div class="line"><a name="l08708"></a><span class="lineno"> 8708</span>&#160;                                <span class="keywordflow">if</span> (is_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;dv&#39;</span>])) {</div>
<div class="line"><a name="l08709"></a><span class="lineno"> 8709</span>&#160;                                    <span class="keywordflow">foreach</span> ($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;dv&#39;</span>] AS $optval) {</div>
<div class="line"><a name="l08710"></a><span class="lineno"> 8710</span>&#160;                                        <span class="keywordflow">if</span> (is_float($optval)) {</div>
<div class="line"><a name="l08711"></a><span class="lineno"> 8711</span>&#160;                                            $optval = sprintf(<span class="stringliteral">&#39;%F&#39;</span>, $optval);</div>
<div class="line"><a name="l08712"></a><span class="lineno"> 8712</span>&#160;                                        }</div>
<div class="line"><a name="l08713"></a><span class="lineno"> 8713</span>&#160;                                        $annots .= <span class="charliteral">&#39; &#39;</span>.$optval;</div>
<div class="line"><a name="l08714"></a><span class="lineno"> 8714</span>&#160;                                    }</div>
<div class="line"><a name="l08715"></a><span class="lineno"> 8715</span>&#160;                                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l08716"></a><span class="lineno"> 8716</span>&#160;                                    $annots .= <span class="charliteral">&#39; &#39;</span>.$this-&gt;_textstring($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;dv&#39;</span>], $annot_obj_id);</div>
<div class="line"><a name="l08717"></a><span class="lineno"> 8717</span>&#160;                                }</div>
<div class="line"><a name="l08718"></a><span class="lineno"> 8718</span>&#160;                            }</div>
<div class="line"><a name="l08719"></a><span class="lineno"> 8719</span>&#160;                            <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;rv&#39;</span>])) {</div>
<div class="line"><a name="l08720"></a><span class="lineno"> 8720</span>&#160;                                $annots .= <span class="stringliteral">&#39; /RV&#39;</span>;</div>
<div class="line"><a name="l08721"></a><span class="lineno"> 8721</span>&#160;                                <span class="keywordflow">if</span> (is_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;rv&#39;</span>])) {</div>
<div class="line"><a name="l08722"></a><span class="lineno"> 8722</span>&#160;                                    <span class="keywordflow">foreach</span> ($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;rv&#39;</span>] AS $optval) {</div>
<div class="line"><a name="l08723"></a><span class="lineno"> 8723</span>&#160;                                        <span class="keywordflow">if</span> (is_float($optval)) {</div>
<div class="line"><a name="l08724"></a><span class="lineno"> 8724</span>&#160;                                            $optval = sprintf(<span class="stringliteral">&#39;%F&#39;</span>, $optval);</div>
<div class="line"><a name="l08725"></a><span class="lineno"> 8725</span>&#160;                                        }</div>
<div class="line"><a name="l08726"></a><span class="lineno"> 8726</span>&#160;                                        $annots .= <span class="charliteral">&#39; &#39;</span>.$optval;</div>
<div class="line"><a name="l08727"></a><span class="lineno"> 8727</span>&#160;                                    }</div>
<div class="line"><a name="l08728"></a><span class="lineno"> 8728</span>&#160;                                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l08729"></a><span class="lineno"> 8729</span>&#160;                                    $annots .= <span class="charliteral">&#39; &#39;</span>.$this-&gt;_textstring($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;rv&#39;</span>], $annot_obj_id);</div>
<div class="line"><a name="l08730"></a><span class="lineno"> 8730</span>&#160;                                }</div>
<div class="line"><a name="l08731"></a><span class="lineno"> 8731</span>&#160;                            }</div>
<div class="line"><a name="l08732"></a><span class="lineno"> 8732</span>&#160;                            <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;a&#39;</span>]) AND !empty($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;a&#39;</span>])) {</div>
<div class="line"><a name="l08733"></a><span class="lineno"> 8733</span>&#160;                                $annots .= <span class="stringliteral">&#39; /A &lt;&lt; &#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;a&#39;</span>].<span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l08734"></a><span class="lineno"> 8734</span>&#160;                            }</div>
<div class="line"><a name="l08735"></a><span class="lineno"> 8735</span>&#160;                            <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;aa&#39;</span>]) AND !empty($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;aa&#39;</span>])) {</div>
<div class="line"><a name="l08736"></a><span class="lineno"> 8736</span>&#160;                                $annots .= <span class="stringliteral">&#39; /AA &lt;&lt; &#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;aa&#39;</span>].<span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l08737"></a><span class="lineno"> 8737</span>&#160;                            }</div>
<div class="line"><a name="l08738"></a><span class="lineno"> 8738</span>&#160;                            <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;da&#39;</span>]) AND !empty($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;da&#39;</span>])) {</div>
<div class="line"><a name="l08739"></a><span class="lineno"> 8739</span>&#160;                                $annots .= <span class="stringliteral">&#39; /DA (&#39;</span>.$pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;da&#39;</span>].<span class="charliteral">&#39;)&#39;</span>;</div>
<div class="line"><a name="l08740"></a><span class="lineno"> 8740</span>&#160;                            }</div>
<div class="line"><a name="l08741"></a><span class="lineno"> 8741</span>&#160;                            <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;q&#39;</span>]) AND ($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;q&#39;</span>] &gt;= 0) AND ($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;q&#39;</span>] &lt;= 2)) {</div>
<div class="line"><a name="l08742"></a><span class="lineno"> 8742</span>&#160;                                $annots .= <span class="stringliteral">&#39; /Q &#39;</span>.intval($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;q&#39;</span>]);</div>
<div class="line"><a name="l08743"></a><span class="lineno"> 8743</span>&#160;                            }</div>
<div class="line"><a name="l08744"></a><span class="lineno"> 8744</span>&#160;                            <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;opt&#39;</span>]) AND (is_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;opt&#39;</span>])) AND !empty($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;opt&#39;</span>])) {</div>
<div class="line"><a name="l08745"></a><span class="lineno"> 8745</span>&#160;                                $annots .= <span class="stringliteral">&#39; /Opt [&#39;</span>;</div>
<div class="line"><a name="l08746"></a><span class="lineno"> 8746</span>&#160;                                <span class="keywordflow">foreach</span>($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;opt&#39;</span>] AS $copt) {</div>
<div class="line"><a name="l08747"></a><span class="lineno"> 8747</span>&#160;                                    <span class="keywordflow">if</span> (is_array($copt)) {</div>
<div class="line"><a name="l08748"></a><span class="lineno"> 8748</span>&#160;                                        $annots .= <span class="stringliteral">&#39; [&#39;</span>.$this-&gt;_textstring($copt[0], $annot_obj_id).<span class="charliteral">&#39; &#39;</span>.$this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac7082d1545bb2ee22c4713ab57879d81">_textstring</a>($copt[1], $annot_obj_id).<span class="charliteral">&#39;]&#39;</span>;</div>
<div class="line"><a name="l08749"></a><span class="lineno"> 8749</span>&#160;                                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l08750"></a><span class="lineno"> 8750</span>&#160;                                        $annots .= <span class="charliteral">&#39; &#39;</span>.$this-&gt;_textstring($copt, $annot_obj_id);</div>
<div class="line"><a name="l08751"></a><span class="lineno"> 8751</span>&#160;                                    }</div>
<div class="line"><a name="l08752"></a><span class="lineno"> 8752</span>&#160;                                }</div>
<div class="line"><a name="l08753"></a><span class="lineno"> 8753</span>&#160;                                $annots .= <span class="charliteral">&#39;]&#39;</span>;</div>
<div class="line"><a name="l08754"></a><span class="lineno"> 8754</span>&#160;                            }</div>
<div class="line"><a name="l08755"></a><span class="lineno"> 8755</span>&#160;                            <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;ti&#39;</span>])) {</div>
<div class="line"><a name="l08756"></a><span class="lineno"> 8756</span>&#160;                                $annots .= <span class="stringliteral">&#39; /TI &#39;</span>.intval($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="stringliteral">&#39;ti&#39;</span>]);</div>
<div class="line"><a name="l08757"></a><span class="lineno"> 8757</span>&#160;                            }</div>
<div class="line"><a name="l08758"></a><span class="lineno"> 8758</span>&#160;                            <span class="keywordflow">if</span> (isset($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;i&#39;</span>]) AND (is_array($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;i&#39;</span>])) AND !empty($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;i&#39;</span>])) {</div>
<div class="line"><a name="l08759"></a><span class="lineno"> 8759</span>&#160;                                $annots .= <span class="stringliteral">&#39; /I [&#39;</span>;</div>
<div class="line"><a name="l08760"></a><span class="lineno"> 8760</span>&#160;                                <span class="keywordflow">foreach</span>($pl[<span class="stringliteral">&#39;opt&#39;</span>][<span class="charliteral">&#39;i&#39;</span>] AS $copt) {</div>
<div class="line"><a name="l08761"></a><span class="lineno"> 8761</span>&#160;                                    $annots .= intval($copt).<span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l08762"></a><span class="lineno"> 8762</span>&#160;                                }</div>
<div class="line"><a name="l08763"></a><span class="lineno"> 8763</span>&#160;                                $annots .= <span class="charliteral">&#39;]&#39;</span>;</div>
<div class="line"><a name="l08764"></a><span class="lineno"> 8764</span>&#160;                            }</div>
<div class="line"><a name="l08765"></a><span class="lineno"> 8765</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08766"></a><span class="lineno"> 8766</span>&#160;                        }</div>
<div class="line"><a name="l08767"></a><span class="lineno"> 8767</span>&#160;                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;screen&#39;</span>: {</div>
<div class="line"><a name="l08768"></a><span class="lineno"> 8768</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08769"></a><span class="lineno"> 8769</span>&#160;                        }</div>
<div class="line"><a name="l08770"></a><span class="lineno"> 8770</span>&#160;                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;printermark&#39;</span>: {</div>
<div class="line"><a name="l08771"></a><span class="lineno"> 8771</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08772"></a><span class="lineno"> 8772</span>&#160;                        }</div>
<div class="line"><a name="l08773"></a><span class="lineno"> 8773</span>&#160;                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;trapnet&#39;</span>: {</div>
<div class="line"><a name="l08774"></a><span class="lineno"> 8774</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08775"></a><span class="lineno"> 8775</span>&#160;                        }</div>
<div class="line"><a name="l08776"></a><span class="lineno"> 8776</span>&#160;                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;watermark&#39;</span>: {</div>
<div class="line"><a name="l08777"></a><span class="lineno"> 8777</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08778"></a><span class="lineno"> 8778</span>&#160;                        }</div>
<div class="line"><a name="l08779"></a><span class="lineno"> 8779</span>&#160;                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;3d&#39;</span>: {</div>
<div class="line"><a name="l08780"></a><span class="lineno"> 8780</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08781"></a><span class="lineno"> 8781</span>&#160;                        }</div>
<div class="line"><a name="l08782"></a><span class="lineno"> 8782</span>&#160;                        <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l08783"></a><span class="lineno"> 8783</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08784"></a><span class="lineno"> 8784</span>&#160;                        }</div>
<div class="line"><a name="l08785"></a><span class="lineno"> 8785</span>&#160;                    }</div>
<div class="line"><a name="l08786"></a><span class="lineno"> 8786</span>&#160;                    $annots .= <span class="stringliteral">&#39;&gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l08787"></a><span class="lineno"> 8787</span>&#160;                    <span class="comment">// create new annotation object</span></div>
<div class="line"><a name="l08788"></a><span class="lineno"> 8788</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1ef3c591556f7668c8a62b81e98da8a1">_getobj</a>($annot_obj_id).<span class="stringliteral">&quot;\n&quot;</span>.$annots.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>);</div>
<div class="line"><a name="l08789"></a><span class="lineno"> 8789</span>&#160;                    <span class="keywordflow">if</span> ($formfield AND !isset($this-&gt;radiobutton_groups[$n][$pl[<span class="stringliteral">&#39;txt&#39;</span>]])) {</div>
<div class="line"><a name="l08790"></a><span class="lineno"> 8790</span>&#160;                        <span class="comment">// store reference of form object</span></div>
<div class="line"><a name="l08791"></a><span class="lineno"> 8791</span>&#160;                        $this-&gt;form_obj_id[] = $annot_obj_id;</div>
<div class="line"><a name="l08792"></a><span class="lineno"> 8792</span>&#160;                    }</div>
<div class="line"><a name="l08793"></a><span class="lineno"> 8793</span>&#160;                }</div>
<div class="line"><a name="l08794"></a><span class="lineno"> 8794</span>&#160;            }</div>
<div class="line"><a name="l08795"></a><span class="lineno"> 8795</span>&#160;        } <span class="comment">// end for each page</span></div>
<div class="line"><a name="l08796"></a><span class="lineno"> 8796</span>&#160;    }</div>
<div class="line"><a name="l08797"></a><span class="lineno"> 8797</span>&#160;</div>
<div class="line"><a name="l08807"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a4235ea24726644eb13d82a2ebe8ee882"> 8807</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a4235ea24726644eb13d82a2ebe8ee882">_putAPXObject</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>=0, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>=0, $stream=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l08808"></a><span class="lineno"> 8808</span>&#160;        $stream = trim($stream);</div>
<div class="line"><a name="l08809"></a><span class="lineno"> 8809</span>&#160;        $out = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1ef3c591556f7668c8a62b81e98da8a1">_getobj</a>().<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l08810"></a><span class="lineno"> 8810</span>&#160;        $this-&gt;xobjects[<span class="stringliteral">&#39;AX&#39;</span>.$this-&gt;n] = array(<span class="charliteral">&#39;n&#39;</span> =&gt; $this-&gt;n);</div>
<div class="line"><a name="l08811"></a><span class="lineno"> 8811</span>&#160;        $out .= <span class="stringliteral">&#39;&lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l08812"></a><span class="lineno"> 8812</span>&#160;        $out .= <span class="stringliteral">&#39; /Type /XObject&#39;</span>;</div>
<div class="line"><a name="l08813"></a><span class="lineno"> 8813</span>&#160;        $out .= <span class="stringliteral">&#39; /Subtype /Form&#39;</span>;</div>
<div class="line"><a name="l08814"></a><span class="lineno"> 8814</span>&#160;        $out .= <span class="stringliteral">&#39; /FormType 1&#39;</span>;</div>
<div class="line"><a name="l08815"></a><span class="lineno"> 8815</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;compress) {</div>
<div class="line"><a name="l08816"></a><span class="lineno"> 8816</span>&#160;            $stream = gzcompress($stream);</div>
<div class="line"><a name="l08817"></a><span class="lineno"> 8817</span>&#160;            $out .= <span class="stringliteral">&#39; /Filter /FlateDecode&#39;</span>;</div>
<div class="line"><a name="l08818"></a><span class="lineno"> 8818</span>&#160;        }</div>
<div class="line"><a name="l08819"></a><span class="lineno"> 8819</span>&#160;        $rect = sprintf(<span class="stringliteral">&#39;%F %F&#39;</span>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>);</div>
<div class="line"><a name="l08820"></a><span class="lineno"> 8820</span>&#160;        $out .= <span class="stringliteral">&#39; /BBox [0 0 &#39;</span>.$rect.<span class="charliteral">&#39;]&#39;</span>;</div>
<div class="line"><a name="l08821"></a><span class="lineno"> 8821</span>&#160;        $out .= <span class="stringliteral">&#39; /Matrix [1 0 0 1 0 0]&#39;</span>;</div>
<div class="line"><a name="l08822"></a><span class="lineno"> 8822</span>&#160;        $out .= <span class="stringliteral">&#39; /Resources 2 0 R&#39;</span>;</div>
<div class="line"><a name="l08823"></a><span class="lineno"> 8823</span>&#160;        $stream = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a7c7c1beebd83fa777197a842f2ca73eb">_getrawstream</a>($stream);</div>
<div class="line"><a name="l08824"></a><span class="lineno"> 8824</span>&#160;        $out .= <span class="stringliteral">&#39; /Length &#39;</span>.strlen($stream);</div>
<div class="line"><a name="l08825"></a><span class="lineno"> 8825</span>&#160;        $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l08826"></a><span class="lineno"> 8826</span>&#160;        $out .= <span class="stringliteral">&#39; stream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.$stream.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endstream&#39;</span>;</div>
<div class="line"><a name="l08827"></a><span class="lineno"> 8827</span>&#160;        $out .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l08828"></a><span class="lineno"> 8828</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($out);</div>
<div class="line"><a name="l08829"></a><span class="lineno"> 8829</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$this-&gt;n</a>;</div>
<div class="line"><a name="l08830"></a><span class="lineno"> 8830</span>&#160;    }</div>
<div class="line"><a name="l08831"></a><span class="lineno"> 8831</span>&#160;</div>
<div class="line"><a name="l08837"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a20314c160153895145ce7e8a91e75ffc"> 8837</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a20314c160153895145ce7e8a91e75ffc">_putfonts</a>() {</div>
<div class="line"><a name="l08838"></a><span class="lineno"> 8838</span>&#160;        $nf = <a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$this-&gt;n</a>;</div>
<div class="line"><a name="l08839"></a><span class="lineno"> 8839</span>&#160;        <span class="keywordflow">foreach</span> ($this-&gt;diffs as $diff) {</div>
<div class="line"><a name="l08840"></a><span class="lineno"> 8840</span>&#160;            <span class="comment">//Encodings</span></div>
<div class="line"><a name="l08841"></a><span class="lineno"> 8841</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d">_newobj</a>();</div>
<div class="line"><a name="l08842"></a><span class="lineno"> 8842</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(<span class="stringliteral">&#39;&lt;&lt; /Type /Encoding /BaseEncoding /WinAnsiEncoding /Differences [&#39;</span>.$diff.<span class="stringliteral">&#39;] &gt;&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>);</div>
<div class="line"><a name="l08843"></a><span class="lineno"> 8843</span>&#160;        }</div>
<div class="line"><a name="l08844"></a><span class="lineno"> 8844</span>&#160;        $mqr = TCPDF_STATIC::get_mqr();</div>
<div class="line"><a name="l08845"></a><span class="lineno"> 8845</span>&#160;        TCPDF_STATIC::set_mqr(<span class="keyword">false</span>);</div>
<div class="line"><a name="l08846"></a><span class="lineno"> 8846</span>&#160;        <span class="keywordflow">foreach</span> ($this-&gt;FontFiles as $file =&gt; $info) {</div>
<div class="line"><a name="l08847"></a><span class="lineno"> 8847</span>&#160;            <span class="comment">// search and get font file to embedd</span></div>
<div class="line"><a name="l08848"></a><span class="lineno"> 8848</span>&#160;            $fontfile = TCPDF_FONTS::getFontFullPath($file, $info[<span class="stringliteral">&#39;fontdir&#39;</span>]);</div>
<div class="line"><a name="l08849"></a><span class="lineno"> 8849</span>&#160;            <span class="keywordflow">if</span> (!TCPDF_STATIC::empty_string($fontfile)) {</div>
<div class="line"><a name="l08850"></a><span class="lineno"> 8850</span>&#160;                $font = file_get_contents($fontfile);</div>
<div class="line"><a name="l08851"></a><span class="lineno"> 8851</span>&#160;                $compressed = (substr($file, -2) == <span class="stringliteral">&#39;.z&#39;</span>);</div>
<div class="line"><a name="l08852"></a><span class="lineno"> 8852</span>&#160;                <span class="keywordflow">if</span> ((!$compressed) AND (isset($info[<span class="stringliteral">&#39;length2&#39;</span>]))) {</div>
<div class="line"><a name="l08853"></a><span class="lineno"> 8853</span>&#160;                    $header = (ord($font[0]) == 128);</div>
<div class="line"><a name="l08854"></a><span class="lineno"> 8854</span>&#160;                    <span class="keywordflow">if</span> ($header) {</div>
<div class="line"><a name="l08855"></a><span class="lineno"> 8855</span>&#160;                        <span class="comment">// strip first binary header</span></div>
<div class="line"><a name="l08856"></a><span class="lineno"> 8856</span>&#160;                        $font = substr($font, 6);</div>
<div class="line"><a name="l08857"></a><span class="lineno"> 8857</span>&#160;                    }</div>
<div class="line"><a name="l08858"></a><span class="lineno"> 8858</span>&#160;                    <span class="keywordflow">if</span> ($header AND (ord($font[$info[<span class="stringliteral">&#39;length1&#39;</span>]]) == 128)) {</div>
<div class="line"><a name="l08859"></a><span class="lineno"> 8859</span>&#160;                        <span class="comment">// strip second binary header</span></div>
<div class="line"><a name="l08860"></a><span class="lineno"> 8860</span>&#160;                        $font = substr($font, 0, $info[<span class="stringliteral">&#39;length1&#39;</span>]).substr($font, ($info[<span class="stringliteral">&#39;length1&#39;</span>] + 6));</div>
<div class="line"><a name="l08861"></a><span class="lineno"> 8861</span>&#160;                    }</div>
<div class="line"><a name="l08862"></a><span class="lineno"> 8862</span>&#160;                } elseif ($info[<span class="stringliteral">&#39;subset&#39;</span>] AND ((!$compressed) OR ($compressed AND function_exists(<span class="stringliteral">&#39;gzcompress&#39;</span>)))) {</div>
<div class="line"><a name="l08863"></a><span class="lineno"> 8863</span>&#160;                    <span class="keywordflow">if</span> ($compressed) {</div>
<div class="line"><a name="l08864"></a><span class="lineno"> 8864</span>&#160;                        <span class="comment">// uncompress font</span></div>
<div class="line"><a name="l08865"></a><span class="lineno"> 8865</span>&#160;                        $font = gzuncompress($font);</div>
<div class="line"><a name="l08866"></a><span class="lineno"> 8866</span>&#160;                    }</div>
<div class="line"><a name="l08867"></a><span class="lineno"> 8867</span>&#160;                    <span class="comment">// merge subset characters</span></div>
<div class="line"><a name="l08868"></a><span class="lineno"> 8868</span>&#160;                    $subsetchars = array(); <span class="comment">// used chars</span></div>
<div class="line"><a name="l08869"></a><span class="lineno"> 8869</span>&#160;                    <span class="keywordflow">foreach</span> ($info[<span class="stringliteral">&#39;fontkeys&#39;</span>] as $fontkey) {</div>
<div class="line"><a name="l08870"></a><span class="lineno"> 8870</span>&#160;                        $fontinfo = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac63fff093a17846764bbcc09af7c8640">getFontBuffer</a>($fontkey);</div>
<div class="line"><a name="l08871"></a><span class="lineno"> 8871</span>&#160;                        $subsetchars += $fontinfo[<span class="stringliteral">&#39;subsetchars&#39;</span>];</div>
<div class="line"><a name="l08872"></a><span class="lineno"> 8872</span>&#160;                    }</div>
<div class="line"><a name="l08873"></a><span class="lineno"> 8873</span>&#160;                    <span class="comment">// rebuild a font subset</span></div>
<div class="line"><a name="l08874"></a><span class="lineno"> 8874</span>&#160;                    $font = TCPDF_FONTS::_getTrueTypeFontSubset($font, $subsetchars);</div>
<div class="line"><a name="l08875"></a><span class="lineno"> 8875</span>&#160;                    <span class="comment">// calculate new font length</span></div>
<div class="line"><a name="l08876"></a><span class="lineno"> 8876</span>&#160;                    $info[<span class="stringliteral">&#39;length1&#39;</span>] = strlen($font);</div>
<div class="line"><a name="l08877"></a><span class="lineno"> 8877</span>&#160;                    <span class="keywordflow">if</span> ($compressed) {</div>
<div class="line"><a name="l08878"></a><span class="lineno"> 8878</span>&#160;                        <span class="comment">// recompress font</span></div>
<div class="line"><a name="l08879"></a><span class="lineno"> 8879</span>&#160;                        $font = gzcompress($font);</div>
<div class="line"><a name="l08880"></a><span class="lineno"> 8880</span>&#160;                    }</div>
<div class="line"><a name="l08881"></a><span class="lineno"> 8881</span>&#160;                }</div>
<div class="line"><a name="l08882"></a><span class="lineno"> 8882</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d">_newobj</a>();</div>
<div class="line"><a name="l08883"></a><span class="lineno"> 8883</span>&#160;                $this-&gt;FontFiles[$file][<span class="charliteral">&#39;n&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$this-&gt;n</a>;</div>
<div class="line"><a name="l08884"></a><span class="lineno"> 8884</span>&#160;                $stream = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a7c7c1beebd83fa777197a842f2ca73eb">_getrawstream</a>($font);</div>
<div class="line"><a name="l08885"></a><span class="lineno"> 8885</span>&#160;                $out = <span class="stringliteral">&#39;&lt;&lt; /Length &#39;</span>.strlen($stream);</div>
<div class="line"><a name="l08886"></a><span class="lineno"> 8886</span>&#160;                <span class="keywordflow">if</span> ($compressed) {</div>
<div class="line"><a name="l08887"></a><span class="lineno"> 8887</span>&#160;                    $out .= <span class="stringliteral">&#39; /Filter /FlateDecode&#39;</span>;</div>
<div class="line"><a name="l08888"></a><span class="lineno"> 8888</span>&#160;                }</div>
<div class="line"><a name="l08889"></a><span class="lineno"> 8889</span>&#160;                $out .= <span class="stringliteral">&#39; /Length1 &#39;</span>.$info[<span class="stringliteral">&#39;length1&#39;</span>];</div>
<div class="line"><a name="l08890"></a><span class="lineno"> 8890</span>&#160;                <span class="keywordflow">if</span> (isset($info[<span class="stringliteral">&#39;length2&#39;</span>])) {</div>
<div class="line"><a name="l08891"></a><span class="lineno"> 8891</span>&#160;                    $out .= <span class="stringliteral">&#39; /Length2 &#39;</span>.$info[<span class="stringliteral">&#39;length2&#39;</span>].<span class="stringliteral">&#39; /Length3 0&#39;</span>;</div>
<div class="line"><a name="l08892"></a><span class="lineno"> 8892</span>&#160;                }</div>
<div class="line"><a name="l08893"></a><span class="lineno"> 8893</span>&#160;                $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l08894"></a><span class="lineno"> 8894</span>&#160;                $out .= <span class="stringliteral">&#39; stream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.$stream.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endstream&#39;</span>;</div>
<div class="line"><a name="l08895"></a><span class="lineno"> 8895</span>&#160;                $out .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l08896"></a><span class="lineno"> 8896</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($out);</div>
<div class="line"><a name="l08897"></a><span class="lineno"> 8897</span>&#160;            }</div>
<div class="line"><a name="l08898"></a><span class="lineno"> 8898</span>&#160;        }</div>
<div class="line"><a name="l08899"></a><span class="lineno"> 8899</span>&#160;        TCPDF_STATIC::set_mqr($mqr);</div>
<div class="line"><a name="l08900"></a><span class="lineno"> 8900</span>&#160;        <span class="keywordflow">foreach</span> ($this-&gt;fontkeys as <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a>) {</div>
<div class="line"><a name="l08901"></a><span class="lineno"> 8901</span>&#160;            <span class="comment">//Font objects</span></div>
<div class="line"><a name="l08902"></a><span class="lineno"> 8902</span>&#160;            $font = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac63fff093a17846764bbcc09af7c8640">getFontBuffer</a>($k);</div>
<div class="line"><a name="l08903"></a><span class="lineno"> 8903</span>&#160;            $type = $font[<span class="stringliteral">&#39;type&#39;</span>];</div>
<div class="line"><a name="l08904"></a><span class="lineno"> 8904</span>&#160;            $name = $font[<span class="stringliteral">&#39;name&#39;</span>];</div>
<div class="line"><a name="l08905"></a><span class="lineno"> 8905</span>&#160;            <span class="keywordflow">if</span> ($type == <span class="stringliteral">&#39;core&#39;</span>) {</div>
<div class="line"><a name="l08906"></a><span class="lineno"> 8906</span>&#160;                <span class="comment">// standard core font</span></div>
<div class="line"><a name="l08907"></a><span class="lineno"> 8907</span>&#160;                $out = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1ef3c591556f7668c8a62b81e98da8a1">_getobj</a>($this-&gt;font_obj_ids[$k]).<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l08908"></a><span class="lineno"> 8908</span>&#160;                $out .= <span class="stringliteral">&#39;&lt;&lt;/Type /Font&#39;</span>;</div>
<div class="line"><a name="l08909"></a><span class="lineno"> 8909</span>&#160;                $out .= <span class="stringliteral">&#39; /Subtype /Type1&#39;</span>;</div>
<div class="line"><a name="l08910"></a><span class="lineno"> 8910</span>&#160;                $out .= <span class="stringliteral">&#39; /BaseFont /&#39;</span>.$name;</div>
<div class="line"><a name="l08911"></a><span class="lineno"> 8911</span>&#160;                $out .= <span class="stringliteral">&#39; /Name /F&#39;</span>.$font[<span class="charliteral">&#39;i&#39;</span>];</div>
<div class="line"><a name="l08912"></a><span class="lineno"> 8912</span>&#160;                <span class="keywordflow">if</span> ((strtolower($name) != <span class="stringliteral">&#39;symbol&#39;</span>) AND (strtolower($name) != <span class="stringliteral">&#39;zapfdingbats&#39;</span>)) {</div>
<div class="line"><a name="l08913"></a><span class="lineno"> 8913</span>&#160;                    $out .= <span class="stringliteral">&#39; /Encoding /WinAnsiEncoding&#39;</span>;</div>
<div class="line"><a name="l08914"></a><span class="lineno"> 8914</span>&#160;                }</div>
<div class="line"><a name="l08915"></a><span class="lineno"> 8915</span>&#160;                <span class="keywordflow">if</span> ($k == <span class="stringliteral">&#39;helvetica&#39;</span>) {</div>
<div class="line"><a name="l08916"></a><span class="lineno"> 8916</span>&#160;                    <span class="comment">// add default font for annotations</span></div>
<div class="line"><a name="l08917"></a><span class="lineno"> 8917</span>&#160;                    $this-&gt;annotation_fonts[<a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a>] = $font[<span class="charliteral">&#39;i&#39;</span>];</div>
<div class="line"><a name="l08918"></a><span class="lineno"> 8918</span>&#160;                }</div>
<div class="line"><a name="l08919"></a><span class="lineno"> 8919</span>&#160;                $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l08920"></a><span class="lineno"> 8920</span>&#160;                $out .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l08921"></a><span class="lineno"> 8921</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($out);</div>
<div class="line"><a name="l08922"></a><span class="lineno"> 8922</span>&#160;            } elseif (($type == <span class="stringliteral">&#39;Type1&#39;</span>) OR ($type == <span class="stringliteral">&#39;TrueType&#39;</span>)) {</div>
<div class="line"><a name="l08923"></a><span class="lineno"> 8923</span>&#160;                <span class="comment">// additional Type1 or TrueType font</span></div>
<div class="line"><a name="l08924"></a><span class="lineno"> 8924</span>&#160;                $out = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1ef3c591556f7668c8a62b81e98da8a1">_getobj</a>($this-&gt;font_obj_ids[$k]).<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l08925"></a><span class="lineno"> 8925</span>&#160;                $out .= <span class="stringliteral">&#39;&lt;&lt;/Type /Font&#39;</span>;</div>
<div class="line"><a name="l08926"></a><span class="lineno"> 8926</span>&#160;                $out .= <span class="stringliteral">&#39; /Subtype /&#39;</span>.$type;</div>
<div class="line"><a name="l08927"></a><span class="lineno"> 8927</span>&#160;                $out .= <span class="stringliteral">&#39; /BaseFont /&#39;</span>.$name;</div>
<div class="line"><a name="l08928"></a><span class="lineno"> 8928</span>&#160;                $out .= <span class="stringliteral">&#39; /Name /F&#39;</span>.$font[<span class="charliteral">&#39;i&#39;</span>];</div>
<div class="line"><a name="l08929"></a><span class="lineno"> 8929</span>&#160;                $out .= <span class="stringliteral">&#39; /FirstChar 32 /LastChar 255&#39;</span>;</div>
<div class="line"><a name="l08930"></a><span class="lineno"> 8930</span>&#160;                $out .= <span class="stringliteral">&#39; /Widths &#39;</span>.($this-&gt;n + 1).<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l08931"></a><span class="lineno"> 8931</span>&#160;                $out .= <span class="stringliteral">&#39; /FontDescriptor &#39;</span>.($this-&gt;n + 2).<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l08932"></a><span class="lineno"> 8932</span>&#160;                <span class="keywordflow">if</span> ($font[<span class="stringliteral">&#39;enc&#39;</span>]) {</div>
<div class="line"><a name="l08933"></a><span class="lineno"> 8933</span>&#160;                    <span class="keywordflow">if</span> (isset($font[<span class="stringliteral">&#39;diff&#39;</span>])) {</div>
<div class="line"><a name="l08934"></a><span class="lineno"> 8934</span>&#160;                        $out .= <span class="stringliteral">&#39; /Encoding &#39;</span>.($nf + $font[<span class="stringliteral">&#39;diff&#39;</span>]).<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l08935"></a><span class="lineno"> 8935</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l08936"></a><span class="lineno"> 8936</span>&#160;                        $out .= <span class="stringliteral">&#39; /Encoding /WinAnsiEncoding&#39;</span>;</div>
<div class="line"><a name="l08937"></a><span class="lineno"> 8937</span>&#160;                    }</div>
<div class="line"><a name="l08938"></a><span class="lineno"> 8938</span>&#160;                }</div>
<div class="line"><a name="l08939"></a><span class="lineno"> 8939</span>&#160;                $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l08940"></a><span class="lineno"> 8940</span>&#160;                $out .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l08941"></a><span class="lineno"> 8941</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($out);</div>
<div class="line"><a name="l08942"></a><span class="lineno"> 8942</span>&#160;                <span class="comment">// Widths</span></div>
<div class="line"><a name="l08943"></a><span class="lineno"> 8943</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d">_newobj</a>();</div>
<div class="line"><a name="l08944"></a><span class="lineno"> 8944</span>&#160;                $s = <span class="charliteral">&#39;[&#39;</span>;</div>
<div class="line"><a name="l08945"></a><span class="lineno"> 8945</span>&#160;                <span class="keywordflow">for</span> ($i = 32; $i &lt; 256; ++$i) {</div>
<div class="line"><a name="l08946"></a><span class="lineno"> 8946</span>&#160;                    <span class="keywordflow">if</span> (isset($font[<span class="stringliteral">&#39;cw&#39;</span>][$i])) {</div>
<div class="line"><a name="l08947"></a><span class="lineno"> 8947</span>&#160;                        $s .= $font[<span class="stringliteral">&#39;cw&#39;</span>][$i].<span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l08948"></a><span class="lineno"> 8948</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l08949"></a><span class="lineno"> 8949</span>&#160;                        $s .= $font[<span class="stringliteral">&#39;dw&#39;</span>].<span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l08950"></a><span class="lineno"> 8950</span>&#160;                    }</div>
<div class="line"><a name="l08951"></a><span class="lineno"> 8951</span>&#160;                }</div>
<div class="line"><a name="l08952"></a><span class="lineno"> 8952</span>&#160;                $s .= <span class="charliteral">&#39;]&#39;</span>;</div>
<div class="line"><a name="l08953"></a><span class="lineno"> 8953</span>&#160;                $s .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l08954"></a><span class="lineno"> 8954</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($s);</div>
<div class="line"><a name="l08955"></a><span class="lineno"> 8955</span>&#160;                <span class="comment">//Descriptor</span></div>
<div class="line"><a name="l08956"></a><span class="lineno"> 8956</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d">_newobj</a>();</div>
<div class="line"><a name="l08957"></a><span class="lineno"> 8957</span>&#160;                $s = <span class="stringliteral">&#39;&lt;&lt;/Type /FontDescriptor /FontName /&#39;</span>.$name;</div>
<div class="line"><a name="l08958"></a><span class="lineno"> 8958</span>&#160;                <span class="keywordflow">foreach</span> ($font[<span class="stringliteral">&#39;desc&#39;</span>] as $fdk =&gt; $fdv) {</div>
<div class="line"><a name="l08959"></a><span class="lineno"> 8959</span>&#160;                    <span class="keywordflow">if</span> (is_float($fdv)) {</div>
<div class="line"><a name="l08960"></a><span class="lineno"> 8960</span>&#160;                        $fdv = sprintf(<span class="stringliteral">&#39;%F&#39;</span>, $fdv);</div>
<div class="line"><a name="l08961"></a><span class="lineno"> 8961</span>&#160;                    }</div>
<div class="line"><a name="l08962"></a><span class="lineno"> 8962</span>&#160;                    $s .= <span class="stringliteral">&#39; /&#39;</span>.$fdk.<span class="charliteral">&#39; &#39;</span>.$fdv.<span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l08963"></a><span class="lineno"> 8963</span>&#160;                }</div>
<div class="line"><a name="l08964"></a><span class="lineno"> 8964</span>&#160;                <span class="keywordflow">if</span> (!TCPDF_STATIC::empty_string($font[<span class="stringliteral">&#39;file&#39;</span>])) {</div>
<div class="line"><a name="l08965"></a><span class="lineno"> 8965</span>&#160;                    $s .= <span class="stringliteral">&#39; /FontFile&#39;</span>.($type == <span class="stringliteral">&#39;Type1&#39;</span> ? <span class="stringliteral">&#39;&#39;</span> : <span class="charliteral">&#39;2&#39;</span>).<span class="charliteral">&#39; &#39;</span>.$this-&gt;FontFiles[$font[<span class="stringliteral">&#39;file&#39;</span>]][<span class="charliteral">&#39;n&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l08966"></a><span class="lineno"> 8966</span>&#160;                }</div>
<div class="line"><a name="l08967"></a><span class="lineno"> 8967</span>&#160;                $s .= <span class="stringliteral">&#39;&gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l08968"></a><span class="lineno"> 8968</span>&#160;                $s .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l08969"></a><span class="lineno"> 8969</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($s);</div>
<div class="line"><a name="l08970"></a><span class="lineno"> 8970</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l08971"></a><span class="lineno"> 8971</span>&#160;                <span class="comment">// additional types</span></div>
<div class="line"><a name="l08972"></a><span class="lineno"> 8972</span>&#160;                $mtd = <span class="stringliteral">&#39;_put&#39;</span>.strtolower($type);</div>
<div class="line"><a name="l08973"></a><span class="lineno"> 8973</span>&#160;                <span class="keywordflow">if</span> (!method_exists($this, $mtd)) {</div>
<div class="line"><a name="l08974"></a><span class="lineno"> 8974</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;Unsupported font type: &#39;</span>.$type);</div>
<div class="line"><a name="l08975"></a><span class="lineno"> 8975</span>&#160;                }</div>
<div class="line"><a name="l08976"></a><span class="lineno"> 8976</span>&#160;                $this-&gt;$mtd($font);</div>
<div class="line"><a name="l08977"></a><span class="lineno"> 8977</span>&#160;            }</div>
<div class="line"><a name="l08978"></a><span class="lineno"> 8978</span>&#160;        }</div>
<div class="line"><a name="l08979"></a><span class="lineno"> 8979</span>&#160;    }</div>
<div class="line"><a name="l08980"></a><span class="lineno"> 8980</span>&#160;</div>
<div class="line"><a name="l08989"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ab7edf9bb8be446509d03a9c70eba3ca3"> 8989</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ab7edf9bb8be446509d03a9c70eba3ca3">_puttruetypeunicode</a>($font) {</div>
<div class="line"><a name="l08990"></a><span class="lineno"> 8990</span>&#160;        $fontname = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l08991"></a><span class="lineno"> 8991</span>&#160;        <span class="keywordflow">if</span> ($font[<span class="stringliteral">&#39;subset&#39;</span>]) {</div>
<div class="line"><a name="l08992"></a><span class="lineno"> 8992</span>&#160;            <span class="comment">// change name for font subsetting</span></div>
<div class="line"><a name="l08993"></a><span class="lineno"> 8993</span>&#160;            $subtag = sprintf(<span class="stringliteral">&#39;%06u&#39;</span>, $font[<span class="charliteral">&#39;i&#39;</span>]);</div>
<div class="line"><a name="l08994"></a><span class="lineno"> 8994</span>&#160;            $subtag = strtr($subtag, <span class="stringliteral">&#39;0123456789&#39;</span>, <span class="stringliteral">&#39;ABCDEFGHIJ&#39;</span>);</div>
<div class="line"><a name="l08995"></a><span class="lineno"> 8995</span>&#160;            $fontname .= $subtag.<span class="charliteral">&#39;+&#39;</span>;</div>
<div class="line"><a name="l08996"></a><span class="lineno"> 8996</span>&#160;        }</div>
<div class="line"><a name="l08997"></a><span class="lineno"> 8997</span>&#160;        $fontname .= $font[<span class="stringliteral">&#39;name&#39;</span>];</div>
<div class="line"><a name="l08998"></a><span class="lineno"> 8998</span>&#160;        <span class="comment">// Type0 Font</span></div>
<div class="line"><a name="l08999"></a><span class="lineno"> 8999</span>&#160;        <span class="comment">// A composite font composed of other fonts, organized hierarchically</span></div>
<div class="line"><a name="l09000"></a><span class="lineno"> 9000</span>&#160;        $out = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1ef3c591556f7668c8a62b81e98da8a1">_getobj</a>($this-&gt;font_obj_ids[$font[<span class="stringliteral">&#39;fontkey&#39;</span>]]).<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09001"></a><span class="lineno"> 9001</span>&#160;        $out .= <span class="stringliteral">&#39;&lt;&lt; /Type /Font&#39;</span>;</div>
<div class="line"><a name="l09002"></a><span class="lineno"> 9002</span>&#160;        $out .= <span class="stringliteral">&#39; /Subtype /Type0&#39;</span>;</div>
<div class="line"><a name="l09003"></a><span class="lineno"> 9003</span>&#160;        $out .= <span class="stringliteral">&#39; /BaseFont /&#39;</span>.$fontname;</div>
<div class="line"><a name="l09004"></a><span class="lineno"> 9004</span>&#160;        $out .= <span class="stringliteral">&#39; /Name /F&#39;</span>.$font[<span class="charliteral">&#39;i&#39;</span>];</div>
<div class="line"><a name="l09005"></a><span class="lineno"> 9005</span>&#160;        $out .= <span class="stringliteral">&#39; /Encoding /&#39;</span>.$font[<span class="stringliteral">&#39;enc&#39;</span>];</div>
<div class="line"><a name="l09006"></a><span class="lineno"> 9006</span>&#160;        $out .= <span class="stringliteral">&#39; /ToUnicode &#39;</span>.($this-&gt;n + 1).<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l09007"></a><span class="lineno"> 9007</span>&#160;        $out .= <span class="stringliteral">&#39; /DescendantFonts [&#39;</span>.($this-&gt;n + 2).<span class="stringliteral">&#39; 0 R]&#39;</span>;</div>
<div class="line"><a name="l09008"></a><span class="lineno"> 9008</span>&#160;        $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l09009"></a><span class="lineno"> 9009</span>&#160;        $out .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l09010"></a><span class="lineno"> 9010</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($out);</div>
<div class="line"><a name="l09011"></a><span class="lineno"> 9011</span>&#160;        <span class="comment">// ToUnicode map for Identity-H</span></div>
<div class="line"><a name="l09012"></a><span class="lineno"> 9012</span>&#160;        $stream = TCPDF_FONT_DATA::$uni_identity_h;</div>
<div class="line"><a name="l09013"></a><span class="lineno"> 9013</span>&#160;        <span class="comment">// ToUnicode Object</span></div>
<div class="line"><a name="l09014"></a><span class="lineno"> 9014</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d">_newobj</a>();</div>
<div class="line"><a name="l09015"></a><span class="lineno"> 9015</span>&#160;        $stream = (<a class="code" href="../../d4/d40/classTCPDF.html#a9e5fbe1cabbea954c6b5d4f9837bc3b0">$this-&gt;compress</a>) ? gzcompress($stream) : $stream;</div>
<div class="line"><a name="l09016"></a><span class="lineno"> 9016</span>&#160;        $filter = (<a class="code" href="../../d4/d40/classTCPDF.html#a9e5fbe1cabbea954c6b5d4f9837bc3b0">$this-&gt;compress</a>) ? <span class="stringliteral">&#39;/Filter /FlateDecode &#39;</span> : <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l09017"></a><span class="lineno"> 9017</span>&#160;        $stream = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a7c7c1beebd83fa777197a842f2ca73eb">_getrawstream</a>($stream);</div>
<div class="line"><a name="l09018"></a><span class="lineno"> 9018</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(<span class="stringliteral">&#39;&lt;&lt;&#39;</span>.$filter.<span class="stringliteral">&#39;/Length &#39;</span>.strlen($stream).<span class="stringliteral">&#39;&gt;&gt; stream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.$stream.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endstream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>);</div>
<div class="line"><a name="l09019"></a><span class="lineno"> 9019</span>&#160;        <span class="comment">// CIDFontType2</span></div>
<div class="line"><a name="l09020"></a><span class="lineno"> 9020</span>&#160;        <span class="comment">// A CIDFont whose glyph descriptions are based on TrueType font technology</span></div>
<div class="line"><a name="l09021"></a><span class="lineno"> 9021</span>&#160;        $oid = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d">_newobj</a>();</div>
<div class="line"><a name="l09022"></a><span class="lineno"> 9022</span>&#160;        $out = <span class="stringliteral">&#39;&lt;&lt; /Type /Font&#39;</span>;</div>
<div class="line"><a name="l09023"></a><span class="lineno"> 9023</span>&#160;        $out .= <span class="stringliteral">&#39; /Subtype /CIDFontType2&#39;</span>;</div>
<div class="line"><a name="l09024"></a><span class="lineno"> 9024</span>&#160;        $out .= <span class="stringliteral">&#39; /BaseFont /&#39;</span>.$fontname;</div>
<div class="line"><a name="l09025"></a><span class="lineno"> 9025</span>&#160;        <span class="comment">// A dictionary containing entries that define the character collection of the CIDFont.</span></div>
<div class="line"><a name="l09026"></a><span class="lineno"> 9026</span>&#160;        $cidinfo = <span class="stringliteral">&#39;/Registry &#39;</span>.$this-&gt;_datastring($font[<span class="stringliteral">&#39;cidinfo&#39;</span>][<span class="stringliteral">&#39;Registry&#39;</span>], $oid);</div>
<div class="line"><a name="l09027"></a><span class="lineno"> 9027</span>&#160;        $cidinfo .= <span class="stringliteral">&#39; /Ordering &#39;</span>.$this-&gt;_datastring($font[<span class="stringliteral">&#39;cidinfo&#39;</span>][<span class="stringliteral">&#39;Ordering&#39;</span>], $oid);</div>
<div class="line"><a name="l09028"></a><span class="lineno"> 9028</span>&#160;        $cidinfo .= <span class="stringliteral">&#39; /Supplement &#39;</span>.$font[<span class="stringliteral">&#39;cidinfo&#39;</span>][<span class="stringliteral">&#39;Supplement&#39;</span>];</div>
<div class="line"><a name="l09029"></a><span class="lineno"> 9029</span>&#160;        $out .= <span class="stringliteral">&#39; /CIDSystemInfo &lt;&lt; &#39;</span>.$cidinfo.<span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l09030"></a><span class="lineno"> 9030</span>&#160;        $out .= <span class="stringliteral">&#39; /FontDescriptor &#39;</span>.($this-&gt;n + 1).<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l09031"></a><span class="lineno"> 9031</span>&#160;        $out .= <span class="stringliteral">&#39; /DW &#39;</span>.$font[<span class="stringliteral">&#39;dw&#39;</span>]; <span class="comment">// default width</span></div>
<div class="line"><a name="l09032"></a><span class="lineno"> 9032</span>&#160;        $out .= <span class="stringliteral">&quot;\n&quot;</span>.TCPDF_FONTS::_putfontwidths($font, 0);</div>
<div class="line"><a name="l09033"></a><span class="lineno"> 9033</span>&#160;        <span class="keywordflow">if</span> (isset($font[<span class="stringliteral">&#39;ctg&#39;</span>]) AND (!TCPDF_STATIC::empty_string($font[<span class="stringliteral">&#39;ctg&#39;</span>]))) {</div>
<div class="line"><a name="l09034"></a><span class="lineno"> 9034</span>&#160;            $out .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;/CIDToGIDMap &#39;</span>.($this-&gt;n + 2).<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l09035"></a><span class="lineno"> 9035</span>&#160;        }</div>
<div class="line"><a name="l09036"></a><span class="lineno"> 9036</span>&#160;        $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l09037"></a><span class="lineno"> 9037</span>&#160;        $out .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l09038"></a><span class="lineno"> 9038</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($out);</div>
<div class="line"><a name="l09039"></a><span class="lineno"> 9039</span>&#160;        <span class="comment">// Font descriptor</span></div>
<div class="line"><a name="l09040"></a><span class="lineno"> 9040</span>&#160;        <span class="comment">// A font descriptor describing the CIDFont default metrics other than its glyph widths</span></div>
<div class="line"><a name="l09041"></a><span class="lineno"> 9041</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d">_newobj</a>();</div>
<div class="line"><a name="l09042"></a><span class="lineno"> 9042</span>&#160;        $out = <span class="stringliteral">&#39;&lt;&lt; /Type /FontDescriptor&#39;</span>;</div>
<div class="line"><a name="l09043"></a><span class="lineno"> 9043</span>&#160;        $out .= <span class="stringliteral">&#39; /FontName /&#39;</span>.$fontname;</div>
<div class="line"><a name="l09044"></a><span class="lineno"> 9044</span>&#160;        <span class="keywordflow">foreach</span> ($font[<span class="stringliteral">&#39;desc&#39;</span>] as $key =&gt; $value) {</div>
<div class="line"><a name="l09045"></a><span class="lineno"> 9045</span>&#160;            <span class="keywordflow">if</span> (is_float($value)) {</div>
<div class="line"><a name="l09046"></a><span class="lineno"> 9046</span>&#160;                $value = sprintf(<span class="stringliteral">&#39;%F&#39;</span>, $value);</div>
<div class="line"><a name="l09047"></a><span class="lineno"> 9047</span>&#160;            }</div>
<div class="line"><a name="l09048"></a><span class="lineno"> 9048</span>&#160;            $out .= <span class="stringliteral">&#39; /&#39;</span>.$key.<span class="charliteral">&#39; &#39;</span>.$value;</div>
<div class="line"><a name="l09049"></a><span class="lineno"> 9049</span>&#160;        }</div>
<div class="line"><a name="l09050"></a><span class="lineno"> 9050</span>&#160;        $fontdir = <span class="keyword">false</span>;</div>
<div class="line"><a name="l09051"></a><span class="lineno"> 9051</span>&#160;        <span class="keywordflow">if</span> (!TCPDF_STATIC::empty_string($font[<span class="stringliteral">&#39;file&#39;</span>])) {</div>
<div class="line"><a name="l09052"></a><span class="lineno"> 9052</span>&#160;            <span class="comment">// A stream containing a TrueType font</span></div>
<div class="line"><a name="l09053"></a><span class="lineno"> 9053</span>&#160;            $out .= <span class="stringliteral">&#39; /FontFile2 &#39;</span>.$this-&gt;FontFiles[$font[<span class="stringliteral">&#39;file&#39;</span>]][<span class="charliteral">&#39;n&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l09054"></a><span class="lineno"> 9054</span>&#160;            $fontdir = $this-&gt;FontFiles[$font[<span class="stringliteral">&#39;file&#39;</span>]][<span class="stringliteral">&#39;fontdir&#39;</span>];</div>
<div class="line"><a name="l09055"></a><span class="lineno"> 9055</span>&#160;        }</div>
<div class="line"><a name="l09056"></a><span class="lineno"> 9056</span>&#160;        $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l09057"></a><span class="lineno"> 9057</span>&#160;        $out .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l09058"></a><span class="lineno"> 9058</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($out);</div>
<div class="line"><a name="l09059"></a><span class="lineno"> 9059</span>&#160;        <span class="keywordflow">if</span> (isset($font[<span class="stringliteral">&#39;ctg&#39;</span>]) AND (!TCPDF_STATIC::empty_string($font[<span class="stringliteral">&#39;ctg&#39;</span>]))) {</div>
<div class="line"><a name="l09060"></a><span class="lineno"> 9060</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d">_newobj</a>();</div>
<div class="line"><a name="l09061"></a><span class="lineno"> 9061</span>&#160;            <span class="comment">// Embed CIDToGIDMap</span></div>
<div class="line"><a name="l09062"></a><span class="lineno"> 9062</span>&#160;            <span class="comment">// A specification of the mapping from CIDs to glyph indices</span></div>
<div class="line"><a name="l09063"></a><span class="lineno"> 9063</span>&#160;            <span class="comment">// search and get CTG font file to embedd</span></div>
<div class="line"><a name="l09064"></a><span class="lineno"> 9064</span>&#160;            $ctgfile = strtolower($font[<span class="stringliteral">&#39;ctg&#39;</span>]);</div>
<div class="line"><a name="l09065"></a><span class="lineno"> 9065</span>&#160;            <span class="comment">// search and get ctg font file to embedd</span></div>
<div class="line"><a name="l09066"></a><span class="lineno"> 9066</span>&#160;            $fontfile = TCPDF_FONTS::getFontFullPath($ctgfile, $fontdir);</div>
<div class="line"><a name="l09067"></a><span class="lineno"> 9067</span>&#160;            <span class="keywordflow">if</span> (TCPDF_STATIC::empty_string($fontfile)) {</div>
<div class="line"><a name="l09068"></a><span class="lineno"> 9068</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;Font file not found: &#39;</span>.$ctgfile);</div>
<div class="line"><a name="l09069"></a><span class="lineno"> 9069</span>&#160;            }</div>
<div class="line"><a name="l09070"></a><span class="lineno"> 9070</span>&#160;            $stream = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a7c7c1beebd83fa777197a842f2ca73eb">_getrawstream</a>(file_get_contents($fontfile));</div>
<div class="line"><a name="l09071"></a><span class="lineno"> 9071</span>&#160;            $out = <span class="stringliteral">&#39;&lt;&lt; /Length &#39;</span>.strlen($stream).<span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l09072"></a><span class="lineno"> 9072</span>&#160;            <span class="keywordflow">if</span> (substr($fontfile, -2) == <span class="stringliteral">&#39;.z&#39;</span>) { <span class="comment">// check file extension</span></div>
<div class="line"><a name="l09073"></a><span class="lineno"> 9073</span>&#160;                <span class="comment">// Decompresses data encoded using the public-domain</span></div>
<div class="line"><a name="l09074"></a><span class="lineno"> 9074</span>&#160;                <span class="comment">// zlib/deflate compression method, reproducing the</span></div>
<div class="line"><a name="l09075"></a><span class="lineno"> 9075</span>&#160;                <span class="comment">// original text or binary data</span></div>
<div class="line"><a name="l09076"></a><span class="lineno"> 9076</span>&#160;                $out .= <span class="stringliteral">&#39; /Filter /FlateDecode&#39;</span>;</div>
<div class="line"><a name="l09077"></a><span class="lineno"> 9077</span>&#160;            }</div>
<div class="line"><a name="l09078"></a><span class="lineno"> 9078</span>&#160;            $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l09079"></a><span class="lineno"> 9079</span>&#160;            $out .= <span class="stringliteral">&#39; stream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.$stream.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endstream&#39;</span>;</div>
<div class="line"><a name="l09080"></a><span class="lineno"> 9080</span>&#160;            $out .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l09081"></a><span class="lineno"> 9081</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($out);</div>
<div class="line"><a name="l09082"></a><span class="lineno"> 9082</span>&#160;        }</div>
<div class="line"><a name="l09083"></a><span class="lineno"> 9083</span>&#160;    }</div>
<div class="line"><a name="l09084"></a><span class="lineno"> 9084</span>&#160;</div>
<div class="line"><a name="l09093"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a5b0c0782a3d4238495cb23e4e17ed13d"> 9093</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a5b0c0782a3d4238495cb23e4e17ed13d">_putcidfont0</a>($font) {</div>
<div class="line"><a name="l09094"></a><span class="lineno"> 9094</span>&#160;        $cidoffset = 0;</div>
<div class="line"><a name="l09095"></a><span class="lineno"> 9095</span>&#160;        <span class="keywordflow">if</span> (!isset($font[<span class="stringliteral">&#39;cw&#39;</span>][1])) {</div>
<div class="line"><a name="l09096"></a><span class="lineno"> 9096</span>&#160;            $cidoffset = 31;</div>
<div class="line"><a name="l09097"></a><span class="lineno"> 9097</span>&#160;        }</div>
<div class="line"><a name="l09098"></a><span class="lineno"> 9098</span>&#160;        <span class="keywordflow">if</span> (isset($font[<span class="stringliteral">&#39;cidinfo&#39;</span>][<span class="stringliteral">&#39;uni2cid&#39;</span>])) {</div>
<div class="line"><a name="l09099"></a><span class="lineno"> 9099</span>&#160;            <span class="comment">// convert unicode to cid.</span></div>
<div class="line"><a name="l09100"></a><span class="lineno"> 9100</span>&#160;            $uni2cid = $font[<span class="stringliteral">&#39;cidinfo&#39;</span>][<span class="stringliteral">&#39;uni2cid&#39;</span>];</div>
<div class="line"><a name="l09101"></a><span class="lineno"> 9101</span>&#160;            $cw = array();</div>
<div class="line"><a name="l09102"></a><span class="lineno"> 9102</span>&#160;            <span class="keywordflow">foreach</span> ($font[<span class="stringliteral">&#39;cw&#39;</span>] as $uni =&gt; $width) {</div>
<div class="line"><a name="l09103"></a><span class="lineno"> 9103</span>&#160;                <span class="keywordflow">if</span> (isset($uni2cid[$uni])) {</div>
<div class="line"><a name="l09104"></a><span class="lineno"> 9104</span>&#160;                    $cw[($uni2cid[$uni] + $cidoffset)] = $width;</div>
<div class="line"><a name="l09105"></a><span class="lineno"> 9105</span>&#160;                } elseif ($uni &lt; 256) {</div>
<div class="line"><a name="l09106"></a><span class="lineno"> 9106</span>&#160;                    $cw[$uni] = $width;</div>
<div class="line"><a name="l09107"></a><span class="lineno"> 9107</span>&#160;                } <span class="comment">// else unknown character</span></div>
<div class="line"><a name="l09108"></a><span class="lineno"> 9108</span>&#160;            }</div>
<div class="line"><a name="l09109"></a><span class="lineno"> 9109</span>&#160;            $font = array_merge($font, array(<span class="stringliteral">&#39;cw&#39;</span> =&gt; $cw));</div>
<div class="line"><a name="l09110"></a><span class="lineno"> 9110</span>&#160;        }</div>
<div class="line"><a name="l09111"></a><span class="lineno"> 9111</span>&#160;        $name = $font[<span class="stringliteral">&#39;name&#39;</span>];</div>
<div class="line"><a name="l09112"></a><span class="lineno"> 9112</span>&#160;        $enc = $font[<span class="stringliteral">&#39;enc&#39;</span>];</div>
<div class="line"><a name="l09113"></a><span class="lineno"> 9113</span>&#160;        <span class="keywordflow">if</span> ($enc) {</div>
<div class="line"><a name="l09114"></a><span class="lineno"> 9114</span>&#160;            $longname = $name.<span class="charliteral">&#39;-&#39;</span>.$enc;</div>
<div class="line"><a name="l09115"></a><span class="lineno"> 9115</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l09116"></a><span class="lineno"> 9116</span>&#160;            $longname = $name;</div>
<div class="line"><a name="l09117"></a><span class="lineno"> 9117</span>&#160;        }</div>
<div class="line"><a name="l09118"></a><span class="lineno"> 9118</span>&#160;        $out = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1ef3c591556f7668c8a62b81e98da8a1">_getobj</a>($this-&gt;font_obj_ids[$font[<span class="stringliteral">&#39;fontkey&#39;</span>]]).<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09119"></a><span class="lineno"> 9119</span>&#160;        $out .= <span class="stringliteral">&#39;&lt;&lt;/Type /Font&#39;</span>;</div>
<div class="line"><a name="l09120"></a><span class="lineno"> 9120</span>&#160;        $out .= <span class="stringliteral">&#39; /Subtype /Type0&#39;</span>;</div>
<div class="line"><a name="l09121"></a><span class="lineno"> 9121</span>&#160;        $out .= <span class="stringliteral">&#39; /BaseFont /&#39;</span>.$longname;</div>
<div class="line"><a name="l09122"></a><span class="lineno"> 9122</span>&#160;        $out .= <span class="stringliteral">&#39; /Name /F&#39;</span>.$font[<span class="charliteral">&#39;i&#39;</span>];</div>
<div class="line"><a name="l09123"></a><span class="lineno"> 9123</span>&#160;        <span class="keywordflow">if</span> ($enc) {</div>
<div class="line"><a name="l09124"></a><span class="lineno"> 9124</span>&#160;            $out .= <span class="stringliteral">&#39; /Encoding /&#39;</span>.$enc;</div>
<div class="line"><a name="l09125"></a><span class="lineno"> 9125</span>&#160;        }</div>
<div class="line"><a name="l09126"></a><span class="lineno"> 9126</span>&#160;        $out .= <span class="stringliteral">&#39; /DescendantFonts [&#39;</span>.($this-&gt;n + 1).<span class="stringliteral">&#39; 0 R]&#39;</span>;</div>
<div class="line"><a name="l09127"></a><span class="lineno"> 9127</span>&#160;        $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l09128"></a><span class="lineno"> 9128</span>&#160;        $out .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l09129"></a><span class="lineno"> 9129</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($out);</div>
<div class="line"><a name="l09130"></a><span class="lineno"> 9130</span>&#160;        $oid = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d">_newobj</a>();</div>
<div class="line"><a name="l09131"></a><span class="lineno"> 9131</span>&#160;        $out = <span class="stringliteral">&#39;&lt;&lt;/Type /Font&#39;</span>;</div>
<div class="line"><a name="l09132"></a><span class="lineno"> 9132</span>&#160;        $out .= <span class="stringliteral">&#39; /Subtype /CIDFontType0&#39;</span>;</div>
<div class="line"><a name="l09133"></a><span class="lineno"> 9133</span>&#160;        $out .= <span class="stringliteral">&#39; /BaseFont /&#39;</span>.$name;</div>
<div class="line"><a name="l09134"></a><span class="lineno"> 9134</span>&#160;        $cidinfo = <span class="stringliteral">&#39;/Registry &#39;</span>.$this-&gt;_datastring($font[<span class="stringliteral">&#39;cidinfo&#39;</span>][<span class="stringliteral">&#39;Registry&#39;</span>], $oid);</div>
<div class="line"><a name="l09135"></a><span class="lineno"> 9135</span>&#160;        $cidinfo .= <span class="stringliteral">&#39; /Ordering &#39;</span>.$this-&gt;_datastring($font[<span class="stringliteral">&#39;cidinfo&#39;</span>][<span class="stringliteral">&#39;Ordering&#39;</span>], $oid);</div>
<div class="line"><a name="l09136"></a><span class="lineno"> 9136</span>&#160;        $cidinfo .= <span class="stringliteral">&#39; /Supplement &#39;</span>.$font[<span class="stringliteral">&#39;cidinfo&#39;</span>][<span class="stringliteral">&#39;Supplement&#39;</span>];</div>
<div class="line"><a name="l09137"></a><span class="lineno"> 9137</span>&#160;        $out .= <span class="stringliteral">&#39; /CIDSystemInfo &lt;&lt;&#39;</span>.$cidinfo.<span class="stringliteral">&#39;&gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l09138"></a><span class="lineno"> 9138</span>&#160;        $out .= <span class="stringliteral">&#39; /FontDescriptor &#39;</span>.($this-&gt;n + 1).<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l09139"></a><span class="lineno"> 9139</span>&#160;        $out .= <span class="stringliteral">&#39; /DW &#39;</span>.$font[<span class="stringliteral">&#39;dw&#39;</span>];</div>
<div class="line"><a name="l09140"></a><span class="lineno"> 9140</span>&#160;        $out .= <span class="stringliteral">&quot;\n&quot;</span>.TCPDF_FONTS::_putfontwidths($font, $cidoffset);</div>
<div class="line"><a name="l09141"></a><span class="lineno"> 9141</span>&#160;        $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l09142"></a><span class="lineno"> 9142</span>&#160;        $out .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l09143"></a><span class="lineno"> 9143</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($out);</div>
<div class="line"><a name="l09144"></a><span class="lineno"> 9144</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d">_newobj</a>();</div>
<div class="line"><a name="l09145"></a><span class="lineno"> 9145</span>&#160;        $s = <span class="stringliteral">&#39;&lt;&lt;/Type /FontDescriptor /FontName /&#39;</span>.$name;</div>
<div class="line"><a name="l09146"></a><span class="lineno"> 9146</span>&#160;        <span class="keywordflow">foreach</span> ($font[<span class="stringliteral">&#39;desc&#39;</span>] as <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a> =&gt; $v) {</div>
<div class="line"><a name="l09147"></a><span class="lineno"> 9147</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a> != <span class="stringliteral">&#39;Style&#39;</span>) {</div>
<div class="line"><a name="l09148"></a><span class="lineno"> 9148</span>&#160;                <span class="keywordflow">if</span> (is_float($v)) {</div>
<div class="line"><a name="l09149"></a><span class="lineno"> 9149</span>&#160;                    $v = sprintf(<span class="stringliteral">&#39;%F&#39;</span>, $v);</div>
<div class="line"><a name="l09150"></a><span class="lineno"> 9150</span>&#160;                }</div>
<div class="line"><a name="l09151"></a><span class="lineno"> 9151</span>&#160;                $s .= <span class="stringliteral">&#39; /&#39;</span>.$k.<span class="charliteral">&#39; &#39;</span>.$v.<span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l09152"></a><span class="lineno"> 9152</span>&#160;            }</div>
<div class="line"><a name="l09153"></a><span class="lineno"> 9153</span>&#160;        }</div>
<div class="line"><a name="l09154"></a><span class="lineno"> 9154</span>&#160;        $s .= <span class="stringliteral">&#39;&gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l09155"></a><span class="lineno"> 9155</span>&#160;        $s .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l09156"></a><span class="lineno"> 9156</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($s);</div>
<div class="line"><a name="l09157"></a><span class="lineno"> 9157</span>&#160;    }</div>
<div class="line"><a name="l09158"></a><span class="lineno"> 9158</span>&#160;</div>
<div class="line"><a name="l09163"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a07ca3ed85ede02b10c0c6e55a63c762b"> 9163</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a07ca3ed85ede02b10c0c6e55a63c762b">_putimages</a>() {</div>
<div class="line"><a name="l09164"></a><span class="lineno"> 9164</span>&#160;        $filter = (<a class="code" href="../../d4/d40/classTCPDF.html#a9e5fbe1cabbea954c6b5d4f9837bc3b0">$this-&gt;compress</a>) ? <span class="stringliteral">&#39;/Filter /FlateDecode &#39;</span> : <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l09165"></a><span class="lineno"> 9165</span>&#160;        <span class="keywordflow">foreach</span> ($this-&gt;imagekeys as $file) {</div>
<div class="line"><a name="l09166"></a><span class="lineno"> 9166</span>&#160;            $info = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1a003edf69be144993c85c07a220315c">getImageBuffer</a>($file);</div>
<div class="line"><a name="l09167"></a><span class="lineno"> 9167</span>&#160;            <span class="comment">// set object for alternate images array</span></div>
<div class="line"><a name="l09168"></a><span class="lineno"> 9168</span>&#160;            <span class="keywordflow">if</span> ((!$this-&gt;pdfa_mode) AND isset($info[<span class="stringliteral">&#39;altimgs&#39;</span>]) AND !empty($info[<span class="stringliteral">&#39;altimgs&#39;</span>])) {</div>
<div class="line"><a name="l09169"></a><span class="lineno"> 9169</span>&#160;                $altoid = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d">_newobj</a>();</div>
<div class="line"><a name="l09170"></a><span class="lineno"> 9170</span>&#160;                $out = <span class="charliteral">&#39;[&#39;</span>;</div>
<div class="line"><a name="l09171"></a><span class="lineno"> 9171</span>&#160;                <span class="keywordflow">foreach</span> ($info[<span class="stringliteral">&#39;altimgs&#39;</span>] as $altimage) {</div>
<div class="line"><a name="l09172"></a><span class="lineno"> 9172</span>&#160;                    <span class="keywordflow">if</span> (isset($this-&gt;xobjects[<span class="charliteral">&#39;I&#39;</span>.$altimage[0]][<span class="charliteral">&#39;n&#39;</span>])) {</div>
<div class="line"><a name="l09173"></a><span class="lineno"> 9173</span>&#160;                        $out .= <span class="stringliteral">&#39; &lt;&lt; /Image &#39;</span>.$this-&gt;xobjects[<span class="charliteral">&#39;I&#39;</span>.$altimage[0]][<span class="charliteral">&#39;n&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l09174"></a><span class="lineno"> 9174</span>&#160;                        $out .= <span class="stringliteral">&#39; /DefaultForPrinting&#39;</span>;</div>
<div class="line"><a name="l09175"></a><span class="lineno"> 9175</span>&#160;                        <span class="keywordflow">if</span> ($altimage[1] === <span class="keyword">true</span>) {</div>
<div class="line"><a name="l09176"></a><span class="lineno"> 9176</span>&#160;                            $out .= <span class="stringliteral">&#39; true&#39;</span>;</div>
<div class="line"><a name="l09177"></a><span class="lineno"> 9177</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l09178"></a><span class="lineno"> 9178</span>&#160;                            $out .= <span class="stringliteral">&#39; false&#39;</span>;</div>
<div class="line"><a name="l09179"></a><span class="lineno"> 9179</span>&#160;                        }</div>
<div class="line"><a name="l09180"></a><span class="lineno"> 9180</span>&#160;                        $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l09181"></a><span class="lineno"> 9181</span>&#160;                    }</div>
<div class="line"><a name="l09182"></a><span class="lineno"> 9182</span>&#160;                }</div>
<div class="line"><a name="l09183"></a><span class="lineno"> 9183</span>&#160;                $out .= <span class="stringliteral">&#39; ]&#39;</span>;</div>
<div class="line"><a name="l09184"></a><span class="lineno"> 9184</span>&#160;                $out .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l09185"></a><span class="lineno"> 9185</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($out);</div>
<div class="line"><a name="l09186"></a><span class="lineno"> 9186</span>&#160;            }</div>
<div class="line"><a name="l09187"></a><span class="lineno"> 9187</span>&#160;            <span class="comment">// set image object</span></div>
<div class="line"><a name="l09188"></a><span class="lineno"> 9188</span>&#160;            $oid = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d">_newobj</a>();</div>
<div class="line"><a name="l09189"></a><span class="lineno"> 9189</span>&#160;            $this-&gt;xobjects[<span class="charliteral">&#39;I&#39;</span>.$info[<span class="charliteral">&#39;i&#39;</span>]] = array(<span class="charliteral">&#39;n&#39;</span> =&gt; $oid);</div>
<div class="line"><a name="l09190"></a><span class="lineno"> 9190</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a7f6c277af6ed456e709c6b397cf34c51">setImageSubBuffer</a>($file, <span class="charliteral">&#39;n&#39;</span>, $this-&gt;n);</div>
<div class="line"><a name="l09191"></a><span class="lineno"> 9191</span>&#160;            $out = <span class="stringliteral">&#39;&lt;&lt;/Type /XObject&#39;</span>;</div>
<div class="line"><a name="l09192"></a><span class="lineno"> 9192</span>&#160;            $out .= <span class="stringliteral">&#39; /Subtype /Image&#39;</span>;</div>
<div class="line"><a name="l09193"></a><span class="lineno"> 9193</span>&#160;            $out .= <span class="stringliteral">&#39; /Width &#39;</span>.$info[<span class="charliteral">&#39;w&#39;</span>];</div>
<div class="line"><a name="l09194"></a><span class="lineno"> 9194</span>&#160;            $out .= <span class="stringliteral">&#39; /Height &#39;</span>.$info[<span class="charliteral">&#39;h&#39;</span>];</div>
<div class="line"><a name="l09195"></a><span class="lineno"> 9195</span>&#160;            <span class="keywordflow">if</span> (array_key_exists(<span class="stringliteral">&#39;masked&#39;</span>, $info)) {</div>
<div class="line"><a name="l09196"></a><span class="lineno"> 9196</span>&#160;                $out .= <span class="stringliteral">&#39; /SMask &#39;</span>.($this-&gt;n - 1).<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l09197"></a><span class="lineno"> 9197</span>&#160;            }</div>
<div class="line"><a name="l09198"></a><span class="lineno"> 9198</span>&#160;            <span class="comment">// set color space</span></div>
<div class="line"><a name="l09199"></a><span class="lineno"> 9199</span>&#160;            $icc = <span class="keyword">false</span>;</div>
<div class="line"><a name="l09200"></a><span class="lineno"> 9200</span>&#160;            <span class="keywordflow">if</span> (isset($info[<span class="stringliteral">&#39;icc&#39;</span>]) AND ($info[<span class="stringliteral">&#39;icc&#39;</span>] !== <span class="keyword">false</span>)) {</div>
<div class="line"><a name="l09201"></a><span class="lineno"> 9201</span>&#160;                <span class="comment">// ICC Colour Space</span></div>
<div class="line"><a name="l09202"></a><span class="lineno"> 9202</span>&#160;                $icc = <span class="keyword">true</span>;</div>
<div class="line"><a name="l09203"></a><span class="lineno"> 9203</span>&#160;                $out .= <span class="stringliteral">&#39; /ColorSpace [/ICCBased &#39;</span>.($this-&gt;n + 1).<span class="stringliteral">&#39; 0 R]&#39;</span>;</div>
<div class="line"><a name="l09204"></a><span class="lineno"> 9204</span>&#160;            } elseif ($info[<span class="stringliteral">&#39;cs&#39;</span>] == <span class="stringliteral">&#39;Indexed&#39;</span>) {</div>
<div class="line"><a name="l09205"></a><span class="lineno"> 9205</span>&#160;                <span class="comment">// Indexed Colour Space</span></div>
<div class="line"><a name="l09206"></a><span class="lineno"> 9206</span>&#160;                $out .= <span class="stringliteral">&#39; /ColorSpace [/Indexed /DeviceRGB &#39;</span>.((strlen($info[<span class="stringliteral">&#39;pal&#39;</span>]) / 3) - 1).<span class="charliteral">&#39; &#39;</span>.($this-&gt;n + 1).<span class="stringliteral">&#39; 0 R]&#39;</span>;</div>
<div class="line"><a name="l09207"></a><span class="lineno"> 9207</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l09208"></a><span class="lineno"> 9208</span>&#160;                <span class="comment">// Device Colour Space</span></div>
<div class="line"><a name="l09209"></a><span class="lineno"> 9209</span>&#160;                $out .= <span class="stringliteral">&#39; /ColorSpace /&#39;</span>.$info[<span class="stringliteral">&#39;cs&#39;</span>];</div>
<div class="line"><a name="l09210"></a><span class="lineno"> 9210</span>&#160;            }</div>
<div class="line"><a name="l09211"></a><span class="lineno"> 9211</span>&#160;            <span class="keywordflow">if</span> ($info[<span class="stringliteral">&#39;cs&#39;</span>] == <span class="stringliteral">&#39;DeviceCMYK&#39;</span>) {</div>
<div class="line"><a name="l09212"></a><span class="lineno"> 9212</span>&#160;                $out .= <span class="stringliteral">&#39; /Decode [1 0 1 0 1 0 1 0]&#39;</span>;</div>
<div class="line"><a name="l09213"></a><span class="lineno"> 9213</span>&#160;            }</div>
<div class="line"><a name="l09214"></a><span class="lineno"> 9214</span>&#160;            $out .= <span class="stringliteral">&#39; /BitsPerComponent &#39;</span>.$info[<span class="stringliteral">&#39;bpc&#39;</span>];</div>
<div class="line"><a name="l09215"></a><span class="lineno"> 9215</span>&#160;            <span class="keywordflow">if</span> (isset($altoid) AND ($altoid &gt; 0)) {</div>
<div class="line"><a name="l09216"></a><span class="lineno"> 9216</span>&#160;                <span class="comment">// reference to alternate images dictionary</span></div>
<div class="line"><a name="l09217"></a><span class="lineno"> 9217</span>&#160;                $out .= <span class="stringliteral">&#39; /Alternates &#39;</span>.$altoid.<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l09218"></a><span class="lineno"> 9218</span>&#160;            }</div>
<div class="line"><a name="l09219"></a><span class="lineno"> 9219</span>&#160;            <span class="keywordflow">if</span> (isset($info[<span class="stringliteral">&#39;exurl&#39;</span>]) AND !empty($info[<span class="stringliteral">&#39;exurl&#39;</span>])) {</div>
<div class="line"><a name="l09220"></a><span class="lineno"> 9220</span>&#160;                <span class="comment">// external stream</span></div>
<div class="line"><a name="l09221"></a><span class="lineno"> 9221</span>&#160;                $out .= <span class="stringliteral">&#39; /Length 0&#39;</span>;</div>
<div class="line"><a name="l09222"></a><span class="lineno"> 9222</span>&#160;                $out .= <span class="stringliteral">&#39; /F &lt;&lt; /FS /URL /F &#39;</span>.$this-&gt;_datastring($info[<span class="stringliteral">&#39;exurl&#39;</span>], $oid).<span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l09223"></a><span class="lineno"> 9223</span>&#160;                <span class="keywordflow">if</span> (isset($info[<span class="charliteral">&#39;f&#39;</span>])) {</div>
<div class="line"><a name="l09224"></a><span class="lineno"> 9224</span>&#160;                    $out .= <span class="stringliteral">&#39; /FFilter /&#39;</span>.$info[<span class="charliteral">&#39;f&#39;</span>];</div>
<div class="line"><a name="l09225"></a><span class="lineno"> 9225</span>&#160;                }</div>
<div class="line"><a name="l09226"></a><span class="lineno"> 9226</span>&#160;                $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l09227"></a><span class="lineno"> 9227</span>&#160;                $out .= <span class="stringliteral">&#39; stream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endstream&#39;</span>;</div>
<div class="line"><a name="l09228"></a><span class="lineno"> 9228</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l09229"></a><span class="lineno"> 9229</span>&#160;                <span class="keywordflow">if</span> (isset($info[<span class="charliteral">&#39;f&#39;</span>])) {</div>
<div class="line"><a name="l09230"></a><span class="lineno"> 9230</span>&#160;                    $out .= <span class="stringliteral">&#39; /Filter /&#39;</span>.$info[<span class="charliteral">&#39;f&#39;</span>];</div>
<div class="line"><a name="l09231"></a><span class="lineno"> 9231</span>&#160;                }</div>
<div class="line"><a name="l09232"></a><span class="lineno"> 9232</span>&#160;                <span class="keywordflow">if</span> (isset($info[<span class="stringliteral">&#39;parms&#39;</span>])) {</div>
<div class="line"><a name="l09233"></a><span class="lineno"> 9233</span>&#160;                    $out .= <span class="charliteral">&#39; &#39;</span>.$info[<span class="stringliteral">&#39;parms&#39;</span>];</div>
<div class="line"><a name="l09234"></a><span class="lineno"> 9234</span>&#160;                }</div>
<div class="line"><a name="l09235"></a><span class="lineno"> 9235</span>&#160;                <span class="keywordflow">if</span> (isset($info[<span class="stringliteral">&#39;trns&#39;</span>]) AND is_array($info[<span class="stringliteral">&#39;trns&#39;</span>])) {</div>
<div class="line"><a name="l09236"></a><span class="lineno"> 9236</span>&#160;                    $trns = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l09237"></a><span class="lineno"> 9237</span>&#160;                    $count_info = count($info[<span class="stringliteral">&#39;trns&#39;</span>]);</div>
<div class="line"><a name="l09238"></a><span class="lineno"> 9238</span>&#160;                    <span class="keywordflow">if</span> ($info[<span class="stringliteral">&#39;cs&#39;</span>] == <span class="stringliteral">&#39;Indexed&#39;</span>) {</div>
<div class="line"><a name="l09239"></a><span class="lineno"> 9239</span>&#160;                        $maxval =(pow(2, $info[<span class="stringliteral">&#39;bpc&#39;</span>]) - 1);</div>
<div class="line"><a name="l09240"></a><span class="lineno"> 9240</span>&#160;                        <span class="keywordflow">for</span> ($i = 0; $i &lt; $count_info; ++$i) {</div>
<div class="line"><a name="l09241"></a><span class="lineno"> 9241</span>&#160;                            <span class="keywordflow">if</span> (($info[<span class="stringliteral">&#39;trns&#39;</span>][$i] != 0) AND ($info[<span class="stringliteral">&#39;trns&#39;</span>][$i] != $maxval)) {</div>
<div class="line"><a name="l09242"></a><span class="lineno"> 9242</span>&#160;                                <span class="comment">// this is not a binary type mask @TODO: create a SMask</span></div>
<div class="line"><a name="l09243"></a><span class="lineno"> 9243</span>&#160;                                $trns = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l09244"></a><span class="lineno"> 9244</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09245"></a><span class="lineno"> 9245</span>&#160;                            } elseif (empty($trns) AND ($info[<span class="stringliteral">&#39;trns&#39;</span>][$i] == 0)) {</div>
<div class="line"><a name="l09246"></a><span class="lineno"> 9246</span>&#160;                                <span class="comment">// store the first fully transparent value</span></div>
<div class="line"><a name="l09247"></a><span class="lineno"> 9247</span>&#160;                                $trns .= $i.<span class="charliteral">&#39; &#39;</span>.$i.<span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l09248"></a><span class="lineno"> 9248</span>&#160;                            }</div>
<div class="line"><a name="l09249"></a><span class="lineno"> 9249</span>&#160;                        }</div>
<div class="line"><a name="l09250"></a><span class="lineno"> 9250</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l09251"></a><span class="lineno"> 9251</span>&#160;                        <span class="comment">// grayscale or RGB</span></div>
<div class="line"><a name="l09252"></a><span class="lineno"> 9252</span>&#160;                        <span class="keywordflow">for</span> ($i = 0; $i &lt; $count_info; ++$i) {</div>
<div class="line"><a name="l09253"></a><span class="lineno"> 9253</span>&#160;                            <span class="keywordflow">if</span> ($info[<span class="stringliteral">&#39;trns&#39;</span>][$i] == 0) {</div>
<div class="line"><a name="l09254"></a><span class="lineno"> 9254</span>&#160;                                $trns .= $info[<span class="stringliteral">&#39;trns&#39;</span>][$i].<span class="charliteral">&#39; &#39;</span>.$info[<span class="stringliteral">&#39;trns&#39;</span>][$i].<span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l09255"></a><span class="lineno"> 9255</span>&#160;                            }</div>
<div class="line"><a name="l09256"></a><span class="lineno"> 9256</span>&#160;                        }</div>
<div class="line"><a name="l09257"></a><span class="lineno"> 9257</span>&#160;                    }</div>
<div class="line"><a name="l09258"></a><span class="lineno"> 9258</span>&#160;                    <span class="comment">// Colour Key Masking</span></div>
<div class="line"><a name="l09259"></a><span class="lineno"> 9259</span>&#160;                    <span class="keywordflow">if</span> (!empty($trns)) {</div>
<div class="line"><a name="l09260"></a><span class="lineno"> 9260</span>&#160;                        $out .= <span class="stringliteral">&#39; /Mask [&#39;</span>.$trns.<span class="charliteral">&#39;]&#39;</span>;</div>
<div class="line"><a name="l09261"></a><span class="lineno"> 9261</span>&#160;                    }</div>
<div class="line"><a name="l09262"></a><span class="lineno"> 9262</span>&#160;                }</div>
<div class="line"><a name="l09263"></a><span class="lineno"> 9263</span>&#160;                $stream = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a7c7c1beebd83fa777197a842f2ca73eb">_getrawstream</a>($info[<span class="stringliteral">&#39;data&#39;</span>]);</div>
<div class="line"><a name="l09264"></a><span class="lineno"> 9264</span>&#160;                $out .= <span class="stringliteral">&#39; /Length &#39;</span>.strlen($stream).<span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l09265"></a><span class="lineno"> 9265</span>&#160;                $out .= <span class="stringliteral">&#39; stream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.$stream.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endstream&#39;</span>;</div>
<div class="line"><a name="l09266"></a><span class="lineno"> 9266</span>&#160;            }</div>
<div class="line"><a name="l09267"></a><span class="lineno"> 9267</span>&#160;            $out .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l09268"></a><span class="lineno"> 9268</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($out);</div>
<div class="line"><a name="l09269"></a><span class="lineno"> 9269</span>&#160;            <span class="keywordflow">if</span> ($icc) {</div>
<div class="line"><a name="l09270"></a><span class="lineno"> 9270</span>&#160;                <span class="comment">// ICC colour profile</span></div>
<div class="line"><a name="l09271"></a><span class="lineno"> 9271</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d">_newobj</a>();</div>
<div class="line"><a name="l09272"></a><span class="lineno"> 9272</span>&#160;                $icc = (<a class="code" href="../../d4/d40/classTCPDF.html#a9e5fbe1cabbea954c6b5d4f9837bc3b0">$this-&gt;compress</a>) ? gzcompress($info[<span class="stringliteral">&#39;icc&#39;</span>]) : $info[<span class="stringliteral">&#39;icc&#39;</span>];</div>
<div class="line"><a name="l09273"></a><span class="lineno"> 9273</span>&#160;                $icc = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a7c7c1beebd83fa777197a842f2ca73eb">_getrawstream</a>($icc);</div>
<div class="line"><a name="l09274"></a><span class="lineno"> 9274</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(<span class="stringliteral">&#39;&lt;&lt;/N &#39;</span>.$info[<span class="stringliteral">&#39;ch&#39;</span>].<span class="stringliteral">&#39; /Alternate /&#39;</span>.$info[<span class="stringliteral">&#39;cs&#39;</span>].<span class="charliteral">&#39; &#39;</span>.$filter.<span class="stringliteral">&#39;/Length &#39;</span>.strlen($icc).<span class="stringliteral">&#39;&gt;&gt; stream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.$icc.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endstream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>);</div>
<div class="line"><a name="l09275"></a><span class="lineno"> 9275</span>&#160;            } elseif ($info[<span class="stringliteral">&#39;cs&#39;</span>] == <span class="stringliteral">&#39;Indexed&#39;</span>) {</div>
<div class="line"><a name="l09276"></a><span class="lineno"> 9276</span>&#160;                <span class="comment">// colour palette</span></div>
<div class="line"><a name="l09277"></a><span class="lineno"> 9277</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d">_newobj</a>();</div>
<div class="line"><a name="l09278"></a><span class="lineno"> 9278</span>&#160;                $pal = (<a class="code" href="../../d4/d40/classTCPDF.html#a9e5fbe1cabbea954c6b5d4f9837bc3b0">$this-&gt;compress</a>) ? gzcompress($info[<span class="stringliteral">&#39;pal&#39;</span>]) : $info[<span class="stringliteral">&#39;pal&#39;</span>];</div>
<div class="line"><a name="l09279"></a><span class="lineno"> 9279</span>&#160;                $pal = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a7c7c1beebd83fa777197a842f2ca73eb">_getrawstream</a>($pal);</div>
<div class="line"><a name="l09280"></a><span class="lineno"> 9280</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(<span class="stringliteral">&#39;&lt;&lt;&#39;</span>.$filter.<span class="stringliteral">&#39;/Length &#39;</span>.strlen($pal).<span class="stringliteral">&#39;&gt;&gt; stream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.$pal.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endstream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>);</div>
<div class="line"><a name="l09281"></a><span class="lineno"> 9281</span>&#160;            }</div>
<div class="line"><a name="l09282"></a><span class="lineno"> 9282</span>&#160;        }</div>
<div class="line"><a name="l09283"></a><span class="lineno"> 9283</span>&#160;    }</div>
<div class="line"><a name="l09284"></a><span class="lineno"> 9284</span>&#160;</div>
<div class="line"><a name="l09292"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ac80fd149e908cb48ea0c796f5bc7961b"> 9292</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ac80fd149e908cb48ea0c796f5bc7961b">_putxobjects</a>() {</div>
<div class="line"><a name="l09293"></a><span class="lineno"> 9293</span>&#160;        <span class="keywordflow">foreach</span> ($this-&gt;xobjects as $key =&gt; $data) {</div>
<div class="line"><a name="l09294"></a><span class="lineno"> 9294</span>&#160;            <span class="keywordflow">if</span> (isset($data[<span class="stringliteral">&#39;outdata&#39;</span>])) {</div>
<div class="line"><a name="l09295"></a><span class="lineno"> 9295</span>&#160;                $stream = str_replace($this-&gt;epsmarker, <span class="stringliteral">&#39;&#39;</span>, trim($data[<span class="stringliteral">&#39;outdata&#39;</span>]));</div>
<div class="line"><a name="l09296"></a><span class="lineno"> 9296</span>&#160;                $out = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1ef3c591556f7668c8a62b81e98da8a1">_getobj</a>($data[<span class="charliteral">&#39;n&#39;</span>]).<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09297"></a><span class="lineno"> 9297</span>&#160;                $out .= <span class="stringliteral">&#39;&lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l09298"></a><span class="lineno"> 9298</span>&#160;                $out .= <span class="stringliteral">&#39; /Type /XObject&#39;</span>;</div>
<div class="line"><a name="l09299"></a><span class="lineno"> 9299</span>&#160;                $out .= <span class="stringliteral">&#39; /Subtype /Form&#39;</span>;</div>
<div class="line"><a name="l09300"></a><span class="lineno"> 9300</span>&#160;                $out .= <span class="stringliteral">&#39; /FormType 1&#39;</span>;</div>
<div class="line"><a name="l09301"></a><span class="lineno"> 9301</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;compress) {</div>
<div class="line"><a name="l09302"></a><span class="lineno"> 9302</span>&#160;                    $stream = gzcompress($stream);</div>
<div class="line"><a name="l09303"></a><span class="lineno"> 9303</span>&#160;                    $out .= <span class="stringliteral">&#39; /Filter /FlateDecode&#39;</span>;</div>
<div class="line"><a name="l09304"></a><span class="lineno"> 9304</span>&#160;                }</div>
<div class="line"><a name="l09305"></a><span class="lineno"> 9305</span>&#160;                $out .= sprintf(<span class="stringliteral">&#39; /BBox [%F %F %F %F]&#39;</span>, ($data[<span class="charliteral">&#39;x&#39;</span>] * $this-&gt;k), (-$data[<span class="charliteral">&#39;y&#39;</span>] * $this-&gt;k), (($data[<span class="charliteral">&#39;w&#39;</span>] + $data[<span class="charliteral">&#39;x&#39;</span>]) * $this-&gt;k), (($data[<span class="charliteral">&#39;h&#39;</span>] - $data[<span class="charliteral">&#39;y&#39;</span>]) * $this-&gt;k));</div>
<div class="line"><a name="l09306"></a><span class="lineno"> 9306</span>&#160;                $out .= <span class="stringliteral">&#39; /Matrix [1 0 0 1 0 0]&#39;</span>;</div>
<div class="line"><a name="l09307"></a><span class="lineno"> 9307</span>&#160;                $out .= <span class="stringliteral">&#39; /Resources &lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l09308"></a><span class="lineno"> 9308</span>&#160;                $out .= <span class="stringliteral">&#39; /ProcSet [/PDF /Text /ImageB /ImageC /ImageI]&#39;</span>;</div>
<div class="line"><a name="l09309"></a><span class="lineno"> 9309</span>&#160;                <span class="keywordflow">if</span> (!$this-&gt;pdfa_mode) {</div>
<div class="line"><a name="l09310"></a><span class="lineno"> 9310</span>&#160;                    <span class="comment">// transparency</span></div>
<div class="line"><a name="l09311"></a><span class="lineno"> 9311</span>&#160;                    <span class="keywordflow">if</span> (isset($data[<span class="stringliteral">&#39;extgstates&#39;</span>]) AND !empty($data[<span class="stringliteral">&#39;extgstates&#39;</span>])) {</div>
<div class="line"><a name="l09312"></a><span class="lineno"> 9312</span>&#160;                        $out .= <span class="stringliteral">&#39; /ExtGState &lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l09313"></a><span class="lineno"> 9313</span>&#160;                        <span class="keywordflow">foreach</span> ($data[<span class="stringliteral">&#39;extgstates&#39;</span>] as <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a> =&gt; $extgstate) {</div>
<div class="line"><a name="l09314"></a><span class="lineno"> 9314</span>&#160;                            <span class="keywordflow">if</span> (isset($this-&gt;extgstates[<a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a>][<span class="stringliteral">&#39;name&#39;</span>])) {</div>
<div class="line"><a name="l09315"></a><span class="lineno"> 9315</span>&#160;                                $out .= <span class="stringliteral">&#39; /&#39;</span>.$this-&gt;extgstates[<a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a>][<span class="stringliteral">&#39;name&#39;</span>];</div>
<div class="line"><a name="l09316"></a><span class="lineno"> 9316</span>&#160;                            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l09317"></a><span class="lineno"> 9317</span>&#160;                                $out .= <span class="stringliteral">&#39; /GS&#39;</span>.$k;</div>
<div class="line"><a name="l09318"></a><span class="lineno"> 9318</span>&#160;                            }</div>
<div class="line"><a name="l09319"></a><span class="lineno"> 9319</span>&#160;                            $out .= <span class="charliteral">&#39; &#39;</span>.$this-&gt;extgstates[<a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a>][<span class="charliteral">&#39;n&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l09320"></a><span class="lineno"> 9320</span>&#160;                        }</div>
<div class="line"><a name="l09321"></a><span class="lineno"> 9321</span>&#160;                        $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l09322"></a><span class="lineno"> 9322</span>&#160;                    }</div>
<div class="line"><a name="l09323"></a><span class="lineno"> 9323</span>&#160;                    <span class="keywordflow">if</span> (isset($data[<span class="stringliteral">&#39;gradients&#39;</span>]) AND !empty($data[<span class="stringliteral">&#39;gradients&#39;</span>])) {</div>
<div class="line"><a name="l09324"></a><span class="lineno"> 9324</span>&#160;                        $gp = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l09325"></a><span class="lineno"> 9325</span>&#160;                        $gs = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l09326"></a><span class="lineno"> 9326</span>&#160;                        <span class="keywordflow">foreach</span> ($data[<span class="stringliteral">&#39;gradients&#39;</span>] as $id =&gt; $grad) {</div>
<div class="line"><a name="l09327"></a><span class="lineno"> 9327</span>&#160;                            <span class="comment">// gradient patterns</span></div>
<div class="line"><a name="l09328"></a><span class="lineno"> 9328</span>&#160;                            $gp .= <span class="stringliteral">&#39; /p&#39;</span>.$id.<span class="charliteral">&#39; &#39;</span>.$this-&gt;gradients[$id][<span class="stringliteral">&#39;pattern&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l09329"></a><span class="lineno"> 9329</span>&#160;                            <span class="comment">// gradient shadings</span></div>
<div class="line"><a name="l09330"></a><span class="lineno"> 9330</span>&#160;                            $gs .= <span class="stringliteral">&#39; /Sh&#39;</span>.$id.<span class="charliteral">&#39; &#39;</span>.$this-&gt;gradients[$id][<span class="stringliteral">&#39;id&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l09331"></a><span class="lineno"> 9331</span>&#160;                        }</div>
<div class="line"><a name="l09332"></a><span class="lineno"> 9332</span>&#160;                        $out .= <span class="stringliteral">&#39; /Pattern &lt;&lt;&#39;</span>.$gp.<span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l09333"></a><span class="lineno"> 9333</span>&#160;                        $out .= <span class="stringliteral">&#39; /Shading &lt;&lt;&#39;</span>.$gs.<span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l09334"></a><span class="lineno"> 9334</span>&#160;                    }</div>
<div class="line"><a name="l09335"></a><span class="lineno"> 9335</span>&#160;                }</div>
<div class="line"><a name="l09336"></a><span class="lineno"> 9336</span>&#160;                <span class="comment">// spot colors</span></div>
<div class="line"><a name="l09337"></a><span class="lineno"> 9337</span>&#160;                <span class="keywordflow">if</span> (isset($data[<span class="stringliteral">&#39;spot_colors&#39;</span>]) AND !empty($data[<span class="stringliteral">&#39;spot_colors&#39;</span>])) {</div>
<div class="line"><a name="l09338"></a><span class="lineno"> 9338</span>&#160;                    $out .= <span class="stringliteral">&#39; /ColorSpace &lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l09339"></a><span class="lineno"> 9339</span>&#160;                    <span class="keywordflow">foreach</span> ($data[<span class="stringliteral">&#39;spot_colors&#39;</span>] as $name =&gt; $color) {</div>
<div class="line"><a name="l09340"></a><span class="lineno"> 9340</span>&#160;                        $out .= <span class="stringliteral">&#39; /CS&#39;</span>.$color[<span class="charliteral">&#39;i&#39;</span>].<span class="charliteral">&#39; &#39;</span>.$this-&gt;spot_colors[$name][<span class="charliteral">&#39;n&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l09341"></a><span class="lineno"> 9341</span>&#160;                    }</div>
<div class="line"><a name="l09342"></a><span class="lineno"> 9342</span>&#160;                    $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l09343"></a><span class="lineno"> 9343</span>&#160;                }</div>
<div class="line"><a name="l09344"></a><span class="lineno"> 9344</span>&#160;                <span class="comment">// fonts</span></div>
<div class="line"><a name="l09345"></a><span class="lineno"> 9345</span>&#160;                <span class="keywordflow">if</span> (!empty($data[<span class="stringliteral">&#39;fonts&#39;</span>])) {</div>
<div class="line"><a name="l09346"></a><span class="lineno"> 9346</span>&#160;                    $out .= <span class="stringliteral">&#39; /Font &lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l09347"></a><span class="lineno"> 9347</span>&#160;                    <span class="keywordflow">foreach</span> ($data[<span class="stringliteral">&#39;fonts&#39;</span>] as $fontkey =&gt; $fontid) {</div>
<div class="line"><a name="l09348"></a><span class="lineno"> 9348</span>&#160;                        $out .= <span class="stringliteral">&#39; /F&#39;</span>.$fontid.<span class="charliteral">&#39; &#39;</span>.$this-&gt;font_obj_ids[$fontkey].<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l09349"></a><span class="lineno"> 9349</span>&#160;                    }</div>
<div class="line"><a name="l09350"></a><span class="lineno"> 9350</span>&#160;                    $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l09351"></a><span class="lineno"> 9351</span>&#160;                }</div>
<div class="line"><a name="l09352"></a><span class="lineno"> 9352</span>&#160;                <span class="comment">// images or nested xobjects</span></div>
<div class="line"><a name="l09353"></a><span class="lineno"> 9353</span>&#160;                <span class="keywordflow">if</span> (!empty($data[<span class="stringliteral">&#39;images&#39;</span>]) OR !empty($data[<span class="stringliteral">&#39;xobjects&#39;</span>])) {</div>
<div class="line"><a name="l09354"></a><span class="lineno"> 9354</span>&#160;                    $out .= <span class="stringliteral">&#39; /XObject &lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l09355"></a><span class="lineno"> 9355</span>&#160;                    <span class="keywordflow">foreach</span> ($data[<span class="stringliteral">&#39;images&#39;</span>] as $imgid) {</div>
<div class="line"><a name="l09356"></a><span class="lineno"> 9356</span>&#160;                        $out .= <span class="stringliteral">&#39; /I&#39;</span>.$imgid.<span class="charliteral">&#39; &#39;</span>.$this-&gt;xobjects[<span class="charliteral">&#39;I&#39;</span>.$imgid][<span class="charliteral">&#39;n&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l09357"></a><span class="lineno"> 9357</span>&#160;                    }</div>
<div class="line"><a name="l09358"></a><span class="lineno"> 9358</span>&#160;                    <span class="keywordflow">foreach</span> ($data[<span class="stringliteral">&#39;xobjects&#39;</span>] as $sub_id =&gt; $sub_objid) {</div>
<div class="line"><a name="l09359"></a><span class="lineno"> 9359</span>&#160;                        $out .= <span class="stringliteral">&#39; /&#39;</span>.$sub_id.<span class="charliteral">&#39; &#39;</span>.$sub_objid[<span class="charliteral">&#39;n&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l09360"></a><span class="lineno"> 9360</span>&#160;                    }</div>
<div class="line"><a name="l09361"></a><span class="lineno"> 9361</span>&#160;                    $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l09362"></a><span class="lineno"> 9362</span>&#160;                }</div>
<div class="line"><a name="l09363"></a><span class="lineno"> 9363</span>&#160;                $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>; <span class="comment">//end resources</span></div>
<div class="line"><a name="l09364"></a><span class="lineno"> 9364</span>&#160;                <span class="keywordflow">if</span> (isset($data[<span class="stringliteral">&#39;group&#39;</span>]) AND ($data[<span class="stringliteral">&#39;group&#39;</span>] !== <span class="keyword">false</span>)) {</div>
<div class="line"><a name="l09365"></a><span class="lineno"> 9365</span>&#160;                    <span class="comment">// set transparency group</span></div>
<div class="line"><a name="l09366"></a><span class="lineno"> 9366</span>&#160;                    $out .= <span class="stringliteral">&#39; /Group &lt;&lt; /Type /Group /S /Transparency&#39;</span>;</div>
<div class="line"><a name="l09367"></a><span class="lineno"> 9367</span>&#160;                    <span class="keywordflow">if</span> (is_array($data[<span class="stringliteral">&#39;group&#39;</span>])) {</div>
<div class="line"><a name="l09368"></a><span class="lineno"> 9368</span>&#160;                        <span class="keywordflow">if</span> (isset($data[<span class="stringliteral">&#39;group&#39;</span>][<span class="stringliteral">&#39;CS&#39;</span>]) AND !empty($data[<span class="stringliteral">&#39;group&#39;</span>][<span class="stringliteral">&#39;CS&#39;</span>])) {</div>
<div class="line"><a name="l09369"></a><span class="lineno"> 9369</span>&#160;                            $out .= <span class="stringliteral">&#39; /CS /&#39;</span>.$data[<span class="stringliteral">&#39;group&#39;</span>][<span class="stringliteral">&#39;CS&#39;</span>];</div>
<div class="line"><a name="l09370"></a><span class="lineno"> 9370</span>&#160;                        }</div>
<div class="line"><a name="l09371"></a><span class="lineno"> 9371</span>&#160;                        <span class="keywordflow">if</span> (isset($data[<span class="stringliteral">&#39;group&#39;</span>][<span class="charliteral">&#39;I&#39;</span>])) {</div>
<div class="line"><a name="l09372"></a><span class="lineno"> 9372</span>&#160;                            $out .= <span class="stringliteral">&#39; /I /&#39;</span>.($data[<span class="stringliteral">&#39;group&#39;</span>][<span class="charliteral">&#39;I&#39;</span>]===<span class="keyword">true</span>?<span class="stringliteral">&#39;true&#39;</span>:<span class="stringliteral">&#39;false&#39;</span>);</div>
<div class="line"><a name="l09373"></a><span class="lineno"> 9373</span>&#160;                        }</div>
<div class="line"><a name="l09374"></a><span class="lineno"> 9374</span>&#160;                        <span class="keywordflow">if</span> (isset($data[<span class="stringliteral">&#39;group&#39;</span>][<span class="charliteral">&#39;K&#39;</span>])) {</div>
<div class="line"><a name="l09375"></a><span class="lineno"> 9375</span>&#160;                            $out .= <span class="stringliteral">&#39; /K /&#39;</span>.($data[<span class="stringliteral">&#39;group&#39;</span>][<span class="charliteral">&#39;K&#39;</span>]===<span class="keyword">true</span>?<span class="stringliteral">&#39;true&#39;</span>:<span class="stringliteral">&#39;false&#39;</span>);</div>
<div class="line"><a name="l09376"></a><span class="lineno"> 9376</span>&#160;                        }</div>
<div class="line"><a name="l09377"></a><span class="lineno"> 9377</span>&#160;                    }</div>
<div class="line"><a name="l09378"></a><span class="lineno"> 9378</span>&#160;                    $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l09379"></a><span class="lineno"> 9379</span>&#160;                }</div>
<div class="line"><a name="l09380"></a><span class="lineno"> 9380</span>&#160;                $stream = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a7c7c1beebd83fa777197a842f2ca73eb">_getrawstream</a>($stream, $data[<span class="charliteral">&#39;n&#39;</span>]);</div>
<div class="line"><a name="l09381"></a><span class="lineno"> 9381</span>&#160;                $out .= <span class="stringliteral">&#39; /Length &#39;</span>.strlen($stream);</div>
<div class="line"><a name="l09382"></a><span class="lineno"> 9382</span>&#160;                $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l09383"></a><span class="lineno"> 9383</span>&#160;                $out .= <span class="stringliteral">&#39; stream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.$stream.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endstream&#39;</span>;</div>
<div class="line"><a name="l09384"></a><span class="lineno"> 9384</span>&#160;                $out .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l09385"></a><span class="lineno"> 9385</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($out);</div>
<div class="line"><a name="l09386"></a><span class="lineno"> 9386</span>&#160;            }</div>
<div class="line"><a name="l09387"></a><span class="lineno"> 9387</span>&#160;        }</div>
<div class="line"><a name="l09388"></a><span class="lineno"> 9388</span>&#160;    }</div>
<div class="line"><a name="l09389"></a><span class="lineno"> 9389</span>&#160;</div>
<div class="line"><a name="l09395"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a1fe3c9e300219815332728c0f2216856"> 9395</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a1fe3c9e300219815332728c0f2216856">_putspotcolors</a>() {</div>
<div class="line"><a name="l09396"></a><span class="lineno"> 9396</span>&#160;        <span class="keywordflow">foreach</span> ($this-&gt;spot_colors as $name =&gt; $color) {</div>
<div class="line"><a name="l09397"></a><span class="lineno"> 9397</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d">_newobj</a>();</div>
<div class="line"><a name="l09398"></a><span class="lineno"> 9398</span>&#160;            $this-&gt;spot_colors[$name][<span class="charliteral">&#39;n&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$this-&gt;n</a>;</div>
<div class="line"><a name="l09399"></a><span class="lineno"> 9399</span>&#160;            $out = <span class="stringliteral">&#39;[/Separation /&#39;</span>.str_replace(<span class="charliteral">&#39; &#39;</span>, <span class="stringliteral">&#39;#20&#39;</span>, $name);</div>
<div class="line"><a name="l09400"></a><span class="lineno"> 9400</span>&#160;            $out .= <span class="stringliteral">&#39; /DeviceCMYK &lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l09401"></a><span class="lineno"> 9401</span>&#160;            $out .= <span class="stringliteral">&#39; /Range [0 1 0 1 0 1 0 1] /C0 [0 0 0 0]&#39;</span>;</div>
<div class="line"><a name="l09402"></a><span class="lineno"> 9402</span>&#160;            $out .= <span class="charliteral">&#39; &#39;</span>.sprintf(<span class="stringliteral">&#39;/C1 [%F %F %F %F] &#39;</span>, ($color[<span class="charliteral">&#39;C&#39;</span>] / 100), ($color[<span class="charliteral">&#39;M&#39;</span>] / 100), ($color[<span class="charliteral">&#39;Y&#39;</span>] / 100), ($color[<span class="charliteral">&#39;K&#39;</span>] / 100));</div>
<div class="line"><a name="l09403"></a><span class="lineno"> 9403</span>&#160;            $out .= <span class="stringliteral">&#39; /FunctionType 2 /Domain [0 1] /N 1&gt;&gt;]&#39;</span>;</div>
<div class="line"><a name="l09404"></a><span class="lineno"> 9404</span>&#160;            $out .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l09405"></a><span class="lineno"> 9405</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($out);</div>
<div class="line"><a name="l09406"></a><span class="lineno"> 9406</span>&#160;        }</div>
<div class="line"><a name="l09407"></a><span class="lineno"> 9407</span>&#160;    }</div>
<div class="line"><a name="l09408"></a><span class="lineno"> 9408</span>&#160;</div>
<div class="line"><a name="l09415"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a7355db3de3a948cc20f408c42542962c"> 9415</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a7355db3de3a948cc20f408c42542962c">_getxobjectdict</a>() {</div>
<div class="line"><a name="l09416"></a><span class="lineno"> 9416</span>&#160;        $out = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l09417"></a><span class="lineno"> 9417</span>&#160;        <span class="keywordflow">foreach</span> ($this-&gt;xobjects as $id =&gt; $objid) {</div>
<div class="line"><a name="l09418"></a><span class="lineno"> 9418</span>&#160;            $out .= <span class="stringliteral">&#39; /&#39;</span>.$id.<span class="charliteral">&#39; &#39;</span>.$objid[<span class="charliteral">&#39;n&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l09419"></a><span class="lineno"> 9419</span>&#160;        }</div>
<div class="line"><a name="l09420"></a><span class="lineno"> 9420</span>&#160;        <span class="keywordflow">return</span> $out;</div>
<div class="line"><a name="l09421"></a><span class="lineno"> 9421</span>&#160;    }</div>
<div class="line"><a name="l09422"></a><span class="lineno"> 9422</span>&#160;</div>
<div class="line"><a name="l09427"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aef5168b3e7714914541a1632f5eeb01b"> 9427</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#aef5168b3e7714914541a1632f5eeb01b">_putresourcedict</a>() {</div>
<div class="line"><a name="l09428"></a><span class="lineno"> 9428</span>&#160;        $out = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1ef3c591556f7668c8a62b81e98da8a1">_getobj</a>(2).<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09429"></a><span class="lineno"> 9429</span>&#160;        $out .= <span class="stringliteral">&#39;&lt;&lt; /ProcSet [/PDF /Text /ImageB /ImageC /ImageI]&#39;</span>;</div>
<div class="line"><a name="l09430"></a><span class="lineno"> 9430</span>&#160;        $out .= <span class="stringliteral">&#39; /Font &lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l09431"></a><span class="lineno"> 9431</span>&#160;        <span class="keywordflow">foreach</span> ($this-&gt;fontkeys as $fontkey) {</div>
<div class="line"><a name="l09432"></a><span class="lineno"> 9432</span>&#160;            $font = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac63fff093a17846764bbcc09af7c8640">getFontBuffer</a>($fontkey);</div>
<div class="line"><a name="l09433"></a><span class="lineno"> 9433</span>&#160;            $out .= <span class="stringliteral">&#39; /F&#39;</span>.$font[<span class="charliteral">&#39;i&#39;</span>].<span class="charliteral">&#39; &#39;</span>.$font[<span class="charliteral">&#39;n&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l09434"></a><span class="lineno"> 9434</span>&#160;        }</div>
<div class="line"><a name="l09435"></a><span class="lineno"> 9435</span>&#160;        $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l09436"></a><span class="lineno"> 9436</span>&#160;        $out .= <span class="stringliteral">&#39; /XObject &lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l09437"></a><span class="lineno"> 9437</span>&#160;        $out .= $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a7355db3de3a948cc20f408c42542962c">_getxobjectdict</a>();</div>
<div class="line"><a name="l09438"></a><span class="lineno"> 9438</span>&#160;        $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l09439"></a><span class="lineno"> 9439</span>&#160;        <span class="comment">// layers</span></div>
<div class="line"><a name="l09440"></a><span class="lineno"> 9440</span>&#160;        <span class="keywordflow">if</span> (!empty($this-&gt;pdflayers)) {</div>
<div class="line"><a name="l09441"></a><span class="lineno"> 9441</span>&#160;            $out .= <span class="stringliteral">&#39; /Properties &lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l09442"></a><span class="lineno"> 9442</span>&#160;            <span class="keywordflow">foreach</span> ($this-&gt;pdflayers as $layer) {</div>
<div class="line"><a name="l09443"></a><span class="lineno"> 9443</span>&#160;                $out .= <span class="stringliteral">&#39; /&#39;</span>.$layer[<span class="stringliteral">&#39;layer&#39;</span>].<span class="charliteral">&#39; &#39;</span>.$layer[<span class="stringliteral">&#39;objid&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l09444"></a><span class="lineno"> 9444</span>&#160;            }</div>
<div class="line"><a name="l09445"></a><span class="lineno"> 9445</span>&#160;            $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l09446"></a><span class="lineno"> 9446</span>&#160;        }</div>
<div class="line"><a name="l09447"></a><span class="lineno"> 9447</span>&#160;        <span class="keywordflow">if</span> (!$this-&gt;pdfa_mode) {</div>
<div class="line"><a name="l09448"></a><span class="lineno"> 9448</span>&#160;            <span class="comment">// transparency</span></div>
<div class="line"><a name="l09449"></a><span class="lineno"> 9449</span>&#160;            <span class="keywordflow">if</span> (isset($this-&gt;extgstates) AND !empty($this-&gt;extgstates)) {</div>
<div class="line"><a name="l09450"></a><span class="lineno"> 9450</span>&#160;                $out .= <span class="stringliteral">&#39; /ExtGState &lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l09451"></a><span class="lineno"> 9451</span>&#160;                <span class="keywordflow">foreach</span> ($this-&gt;extgstates as <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a> =&gt; $extgstate) {</div>
<div class="line"><a name="l09452"></a><span class="lineno"> 9452</span>&#160;                    <span class="keywordflow">if</span> (isset($extgstate[<span class="stringliteral">&#39;name&#39;</span>])) {</div>
<div class="line"><a name="l09453"></a><span class="lineno"> 9453</span>&#160;                        $out .= <span class="stringliteral">&#39; /&#39;</span>.$extgstate[<span class="stringliteral">&#39;name&#39;</span>];</div>
<div class="line"><a name="l09454"></a><span class="lineno"> 9454</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l09455"></a><span class="lineno"> 9455</span>&#160;                        $out .= <span class="stringliteral">&#39; /GS&#39;</span>.$k;</div>
<div class="line"><a name="l09456"></a><span class="lineno"> 9456</span>&#160;                    }</div>
<div class="line"><a name="l09457"></a><span class="lineno"> 9457</span>&#160;                    $out .= <span class="charliteral">&#39; &#39;</span>.$extgstate[<span class="charliteral">&#39;n&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l09458"></a><span class="lineno"> 9458</span>&#160;                }</div>
<div class="line"><a name="l09459"></a><span class="lineno"> 9459</span>&#160;                $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l09460"></a><span class="lineno"> 9460</span>&#160;            }</div>
<div class="line"><a name="l09461"></a><span class="lineno"> 9461</span>&#160;            <span class="keywordflow">if</span> (isset($this-&gt;gradients) AND !empty($this-&gt;gradients)) {</div>
<div class="line"><a name="l09462"></a><span class="lineno"> 9462</span>&#160;                $gp = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l09463"></a><span class="lineno"> 9463</span>&#160;                $gs = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l09464"></a><span class="lineno"> 9464</span>&#160;                <span class="keywordflow">foreach</span> ($this-&gt;gradients as $id =&gt; $grad) {</div>
<div class="line"><a name="l09465"></a><span class="lineno"> 9465</span>&#160;                    <span class="comment">// gradient patterns</span></div>
<div class="line"><a name="l09466"></a><span class="lineno"> 9466</span>&#160;                    $gp .= <span class="stringliteral">&#39; /p&#39;</span>.$id.<span class="charliteral">&#39; &#39;</span>.$grad[<span class="stringliteral">&#39;pattern&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l09467"></a><span class="lineno"> 9467</span>&#160;                    <span class="comment">// gradient shadings</span></div>
<div class="line"><a name="l09468"></a><span class="lineno"> 9468</span>&#160;                    $gs .= <span class="stringliteral">&#39; /Sh&#39;</span>.$id.<span class="charliteral">&#39; &#39;</span>.$grad[<span class="stringliteral">&#39;id&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l09469"></a><span class="lineno"> 9469</span>&#160;                }</div>
<div class="line"><a name="l09470"></a><span class="lineno"> 9470</span>&#160;                $out .= <span class="stringliteral">&#39; /Pattern &lt;&lt;&#39;</span>.$gp.<span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l09471"></a><span class="lineno"> 9471</span>&#160;                $out .= <span class="stringliteral">&#39; /Shading &lt;&lt;&#39;</span>.$gs.<span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l09472"></a><span class="lineno"> 9472</span>&#160;            }</div>
<div class="line"><a name="l09473"></a><span class="lineno"> 9473</span>&#160;        }</div>
<div class="line"><a name="l09474"></a><span class="lineno"> 9474</span>&#160;        <span class="comment">// spot colors</span></div>
<div class="line"><a name="l09475"></a><span class="lineno"> 9475</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;spot_colors) AND !empty($this-&gt;spot_colors)) {</div>
<div class="line"><a name="l09476"></a><span class="lineno"> 9476</span>&#160;            $out .= <span class="stringliteral">&#39; /ColorSpace &lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l09477"></a><span class="lineno"> 9477</span>&#160;            <span class="keywordflow">foreach</span> ($this-&gt;spot_colors as $color) {</div>
<div class="line"><a name="l09478"></a><span class="lineno"> 9478</span>&#160;                $out .= <span class="stringliteral">&#39; /CS&#39;</span>.$color[<span class="charliteral">&#39;i&#39;</span>].<span class="charliteral">&#39; &#39;</span>.$color[<span class="charliteral">&#39;n&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l09479"></a><span class="lineno"> 9479</span>&#160;            }</div>
<div class="line"><a name="l09480"></a><span class="lineno"> 9480</span>&#160;            $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l09481"></a><span class="lineno"> 9481</span>&#160;        }</div>
<div class="line"><a name="l09482"></a><span class="lineno"> 9482</span>&#160;        $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l09483"></a><span class="lineno"> 9483</span>&#160;        $out .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l09484"></a><span class="lineno"> 9484</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($out);</div>
<div class="line"><a name="l09485"></a><span class="lineno"> 9485</span>&#160;    }</div>
<div class="line"><a name="l09486"></a><span class="lineno"> 9486</span>&#160;</div>
<div class="line"><a name="l09491"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a3f31f18974b7e7626d8fc99dbbe51d90"> 9491</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a3f31f18974b7e7626d8fc99dbbe51d90">_putresources</a>() {</div>
<div class="line"><a name="l09492"></a><span class="lineno"> 9492</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a5bbbb689c42b3173b755c08cf9c0b58d">_putextgstates</a>();</div>
<div class="line"><a name="l09493"></a><span class="lineno"> 9493</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1de30d6f895d9fb9722f4440d9ae82d7">_putocg</a>();</div>
<div class="line"><a name="l09494"></a><span class="lineno"> 9494</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a20314c160153895145ce7e8a91e75ffc">_putfonts</a>();</div>
<div class="line"><a name="l09495"></a><span class="lineno"> 9495</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a07ca3ed85ede02b10c0c6e55a63c762b">_putimages</a>();</div>
<div class="line"><a name="l09496"></a><span class="lineno"> 9496</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1fe3c9e300219815332728c0f2216856">_putspotcolors</a>();</div>
<div class="line"><a name="l09497"></a><span class="lineno"> 9497</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac4f7fe7f2836e624fb0317f75a74236b">_putshaders</a>();</div>
<div class="line"><a name="l09498"></a><span class="lineno"> 9498</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac80fd149e908cb48ea0c796f5bc7961b">_putxobjects</a>();</div>
<div class="line"><a name="l09499"></a><span class="lineno"> 9499</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aef5168b3e7714914541a1632f5eeb01b">_putresourcedict</a>();</div>
<div class="line"><a name="l09500"></a><span class="lineno"> 9500</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#abc3ef1743fa889f0190b61d80490a770">_putdests</a>();</div>
<div class="line"><a name="l09501"></a><span class="lineno"> 9501</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ad3e9b80cfbd309301aa9a10d29282749">_putEmbeddedFiles</a>();</div>
<div class="line"><a name="l09502"></a><span class="lineno"> 9502</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a9dabd5e4c0295bd5caef55968375da9e">_putannotsobjs</a>();</div>
<div class="line"><a name="l09503"></a><span class="lineno"> 9503</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a3ddff5ab94a793cf535b06de3e773826">_putjavascript</a>();</div>
<div class="line"><a name="l09504"></a><span class="lineno"> 9504</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a42a44895af6f9c61714d178ec0260267">_putbookmarks</a>();</div>
<div class="line"><a name="l09505"></a><span class="lineno"> 9505</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ab5ed9ad2bde4d072fbd2facb96599e95">_putencryption</a>();</div>
<div class="line"><a name="l09506"></a><span class="lineno"> 9506</span>&#160;    }</div>
<div class="line"><a name="l09507"></a><span class="lineno"> 9507</span>&#160;</div>
<div class="line"><a name="l09514"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a7381d7ff2d161c30e0ee5156c956c638"> 9514</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a7381d7ff2d161c30e0ee5156c956c638">_putinfo</a>() {</div>
<div class="line"><a name="l09515"></a><span class="lineno"> 9515</span>&#160;        $oid = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d">_newobj</a>();</div>
<div class="line"><a name="l09516"></a><span class="lineno"> 9516</span>&#160;        $out = <span class="stringliteral">&#39;&lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l09517"></a><span class="lineno"> 9517</span>&#160;        <span class="comment">// store current isunicode value</span></div>
<div class="line"><a name="l09518"></a><span class="lineno"> 9518</span>&#160;        $prev_isunicode = <a class="code" href="../../d4/d40/classTCPDF.html#a148f0ae58c3b0f5644f8ab158b17c2ed">$this-&gt;isunicode</a>;</div>
<div class="line"><a name="l09519"></a><span class="lineno"> 9519</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;docinfounicode) {</div>
<div class="line"><a name="l09520"></a><span class="lineno"> 9520</span>&#160;            $this-&gt;isunicode = <span class="keyword">true</span>;</div>
<div class="line"><a name="l09521"></a><span class="lineno"> 9521</span>&#160;        }</div>
<div class="line"><a name="l09522"></a><span class="lineno"> 9522</span>&#160;        <span class="keywordflow">if</span> (!TCPDF_STATIC::empty_string($this-&gt;title)) {</div>
<div class="line"><a name="l09523"></a><span class="lineno"> 9523</span>&#160;            <span class="comment">// The document&#39;s title.</span></div>
<div class="line"><a name="l09524"></a><span class="lineno"> 9524</span>&#160;            $out .= <span class="stringliteral">&#39; /Title &#39;</span>.$this-&gt;_textstring($this-&gt;title, $oid);</div>
<div class="line"><a name="l09525"></a><span class="lineno"> 9525</span>&#160;        }</div>
<div class="line"><a name="l09526"></a><span class="lineno"> 9526</span>&#160;        <span class="keywordflow">if</span> (!TCPDF_STATIC::empty_string($this-&gt;author)) {</div>
<div class="line"><a name="l09527"></a><span class="lineno"> 9527</span>&#160;            <span class="comment">// The name of the person who created the document.</span></div>
<div class="line"><a name="l09528"></a><span class="lineno"> 9528</span>&#160;            $out .= <span class="stringliteral">&#39; /Author &#39;</span>.$this-&gt;_textstring($this-&gt;author, $oid);</div>
<div class="line"><a name="l09529"></a><span class="lineno"> 9529</span>&#160;        }</div>
<div class="line"><a name="l09530"></a><span class="lineno"> 9530</span>&#160;        <span class="keywordflow">if</span> (!TCPDF_STATIC::empty_string($this-&gt;subject)) {</div>
<div class="line"><a name="l09531"></a><span class="lineno"> 9531</span>&#160;            <span class="comment">// The subject of the document.</span></div>
<div class="line"><a name="l09532"></a><span class="lineno"> 9532</span>&#160;            $out .= <span class="stringliteral">&#39; /Subject &#39;</span>.$this-&gt;_textstring($this-&gt;subject, $oid);</div>
<div class="line"><a name="l09533"></a><span class="lineno"> 9533</span>&#160;        }</div>
<div class="line"><a name="l09534"></a><span class="lineno"> 9534</span>&#160;        <span class="keywordflow">if</span> (!TCPDF_STATIC::empty_string($this-&gt;keywords)) {</div>
<div class="line"><a name="l09535"></a><span class="lineno"> 9535</span>&#160;            <span class="comment">// Keywords associated with the document.</span></div>
<div class="line"><a name="l09536"></a><span class="lineno"> 9536</span>&#160;            $out .= <span class="stringliteral">&#39; /Keywords &#39;</span>.$this-&gt;_textstring($this-&gt;keywords, $oid);</div>
<div class="line"><a name="l09537"></a><span class="lineno"> 9537</span>&#160;        }</div>
<div class="line"><a name="l09538"></a><span class="lineno"> 9538</span>&#160;        <span class="keywordflow">if</span> (!TCPDF_STATIC::empty_string($this-&gt;creator)) {</div>
<div class="line"><a name="l09539"></a><span class="lineno"> 9539</span>&#160;            <span class="comment">// If the document was converted to PDF from another format, the name of the conforming product that created the original document from which it was converted.</span></div>
<div class="line"><a name="l09540"></a><span class="lineno"> 9540</span>&#160;            $out .= <span class="stringliteral">&#39; /Creator &#39;</span>.$this-&gt;_textstring($this-&gt;creator, $oid);</div>
<div class="line"><a name="l09541"></a><span class="lineno"> 9541</span>&#160;        }</div>
<div class="line"><a name="l09542"></a><span class="lineno"> 9542</span>&#160;        <span class="comment">// restore previous isunicode value</span></div>
<div class="line"><a name="l09543"></a><span class="lineno"> 9543</span>&#160;        $this-&gt;isunicode = $prev_isunicode;</div>
<div class="line"><a name="l09544"></a><span class="lineno"> 9544</span>&#160;        <span class="comment">// default producer</span></div>
<div class="line"><a name="l09545"></a><span class="lineno"> 9545</span>&#160;        $out .= <span class="stringliteral">&#39; /Producer &#39;</span>.$this-&gt;_textstring(TCPDF_STATIC::getTCPDFProducer(), $oid);</div>
<div class="line"><a name="l09546"></a><span class="lineno"> 9546</span>&#160;        <span class="comment">// The date and time the document was created, in human-readable form</span></div>
<div class="line"><a name="l09547"></a><span class="lineno"> 9547</span>&#160;        $out .= <span class="stringliteral">&#39; /CreationDate &#39;</span>.$this-&gt;_datestring(0, $this-&gt;doc_creation_timestamp);</div>
<div class="line"><a name="l09548"></a><span class="lineno"> 9548</span>&#160;        <span class="comment">// The date and time the document was most recently modified, in human-readable form</span></div>
<div class="line"><a name="l09549"></a><span class="lineno"> 9549</span>&#160;        $out .= <span class="stringliteral">&#39; /ModDate &#39;</span>.$this-&gt;_datestring(0, $this-&gt;doc_modification_timestamp);</div>
<div class="line"><a name="l09550"></a><span class="lineno"> 9550</span>&#160;        <span class="comment">// A name object indicating whether the document has been modified to include trapping information</span></div>
<div class="line"><a name="l09551"></a><span class="lineno"> 9551</span>&#160;        $out .= <span class="stringliteral">&#39; /Trapped /False&#39;</span>;</div>
<div class="line"><a name="l09552"></a><span class="lineno"> 9552</span>&#160;        $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l09553"></a><span class="lineno"> 9553</span>&#160;        $out .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l09554"></a><span class="lineno"> 9554</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($out);</div>
<div class="line"><a name="l09555"></a><span class="lineno"> 9555</span>&#160;        <span class="keywordflow">return</span> $oid;</div>
<div class="line"><a name="l09556"></a><span class="lineno"> 9556</span>&#160;    }</div>
<div class="line"><a name="l09557"></a><span class="lineno"> 9557</span>&#160;</div>
<div class="line"><a name="l09565"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a951ded3fd87dba651b96586dc39bf1a8"> 9565</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a951ded3fd87dba651b96586dc39bf1a8">setExtraXMP</a>($xmp) {</div>
<div class="line"><a name="l09566"></a><span class="lineno"> 9566</span>&#160;        $this-&gt;custom_xmp = $xmp;</div>
<div class="line"><a name="l09567"></a><span class="lineno"> 9567</span>&#160;    }</div>
<div class="line"><a name="l09568"></a><span class="lineno"> 9568</span>&#160;</div>
<div class="line"><a name="l09575"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a570325299ecf78f328faa53e8758a015"> 9575</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a570325299ecf78f328faa53e8758a015">_putXMP</a>() {</div>
<div class="line"><a name="l09576"></a><span class="lineno"> 9576</span>&#160;        $oid = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d">_newobj</a>();</div>
<div class="line"><a name="l09577"></a><span class="lineno"> 9577</span>&#160;        <span class="comment">// store current isunicode value</span></div>
<div class="line"><a name="l09578"></a><span class="lineno"> 9578</span>&#160;        $prev_isunicode = <a class="code" href="../../d4/d40/classTCPDF.html#a148f0ae58c3b0f5644f8ab158b17c2ed">$this-&gt;isunicode</a>;</div>
<div class="line"><a name="l09579"></a><span class="lineno"> 9579</span>&#160;        $this-&gt;isunicode = <span class="keyword">true</span>;</div>
<div class="line"><a name="l09580"></a><span class="lineno"> 9580</span>&#160;        $prev_encrypted = <a class="code" href="../../d4/d40/classTCPDF.html#affd380e0adfc726dbc519860de0b175c">$this-&gt;encrypted</a>;</div>
<div class="line"><a name="l09581"></a><span class="lineno"> 9581</span>&#160;        $this-&gt;encrypted = <span class="keyword">false</span>;</div>
<div class="line"><a name="l09582"></a><span class="lineno"> 9582</span>&#160;        <span class="comment">// set XMP data</span></div>
<div class="line"><a name="l09583"></a><span class="lineno"> 9583</span>&#160;        $xmp = <span class="stringliteral">&#39;&lt;?xpacket begin=&quot;&#39;</span>.TCPDF_FONTS::unichr(0xfeff, $this-&gt;isunicode).<span class="stringliteral">&#39;&quot; id=&quot;W5M0MpCehiHzreSzNTczkc9d&quot;?&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09584"></a><span class="lineno"> 9584</span>&#160;        $xmp .= <span class="stringliteral">&#39;&lt;x:xmpmeta xmlns:x=&quot;adobe:ns:meta/&quot; x:xmptk=&quot;Adobe XMP Core 4.2.1-c043 52.372728, 2009/01/18-15:08:04&quot;&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09585"></a><span class="lineno"> 9585</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:RDF xmlns:rdf=&quot;http://www.w3.org/1999/02/22-rdf-syntax-ns#&quot;&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09586"></a><span class="lineno"> 9586</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:Description rdf:about=&quot;&quot; xmlns:dc=&quot;http://purl.org/dc/elements/1.1/&quot;&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09587"></a><span class="lineno"> 9587</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;dc:format&gt;application/pdf&lt;/dc:format&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09588"></a><span class="lineno"> 9588</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;dc:title&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09589"></a><span class="lineno"> 9589</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:Alt&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09590"></a><span class="lineno"> 9590</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:li xml:lang=&quot;x-default&quot;&gt;&#39;</span>.TCPDF_STATIC::_escapeXML($this-&gt;title).<span class="stringliteral">&#39;&lt;/rdf:li&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09591"></a><span class="lineno"> 9591</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/rdf:Alt&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09592"></a><span class="lineno"> 9592</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/dc:title&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09593"></a><span class="lineno"> 9593</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;dc:creator&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09594"></a><span class="lineno"> 9594</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:Seq&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09595"></a><span class="lineno"> 9595</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:li&gt;&#39;</span>.TCPDF_STATIC::_escapeXML($this-&gt;author).<span class="stringliteral">&#39;&lt;/rdf:li&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09596"></a><span class="lineno"> 9596</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/rdf:Seq&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09597"></a><span class="lineno"> 9597</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/dc:creator&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09598"></a><span class="lineno"> 9598</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;dc:description&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09599"></a><span class="lineno"> 9599</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:Alt&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09600"></a><span class="lineno"> 9600</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:li xml:lang=&quot;x-default&quot;&gt;&#39;</span>.TCPDF_STATIC::_escapeXML($this-&gt;subject).<span class="stringliteral">&#39;&lt;/rdf:li&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09601"></a><span class="lineno"> 9601</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/rdf:Alt&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09602"></a><span class="lineno"> 9602</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/dc:description&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09603"></a><span class="lineno"> 9603</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;dc:subject&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09604"></a><span class="lineno"> 9604</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:Bag&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09605"></a><span class="lineno"> 9605</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:li&gt;&#39;</span>.TCPDF_STATIC::_escapeXML($this-&gt;keywords).<span class="stringliteral">&#39;&lt;/rdf:li&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09606"></a><span class="lineno"> 9606</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/rdf:Bag&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09607"></a><span class="lineno"> 9607</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/dc:subject&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09608"></a><span class="lineno"> 9608</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/rdf:Description&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09609"></a><span class="lineno"> 9609</span>&#160;        <span class="comment">// convert doc creation date format</span></div>
<div class="line"><a name="l09610"></a><span class="lineno"> 9610</span>&#160;        $dcdate = TCPDF_STATIC::getFormattedDate($this-&gt;doc_creation_timestamp);</div>
<div class="line"><a name="l09611"></a><span class="lineno"> 9611</span>&#160;        $doccreationdate = substr($dcdate, 0, 4).<span class="charliteral">&#39;-&#39;</span>.substr($dcdate, 4, 2).<span class="charliteral">&#39;-&#39;</span>.substr($dcdate, 6, 2);</div>
<div class="line"><a name="l09612"></a><span class="lineno"> 9612</span>&#160;        $doccreationdate .= <span class="charliteral">&#39;T&#39;</span>.substr($dcdate, 8, 2).<span class="charliteral">&#39;:&#39;</span>.substr($dcdate, 10, 2).<span class="charliteral">&#39;:&#39;</span>.substr($dcdate, 12, 2);</div>
<div class="line"><a name="l09613"></a><span class="lineno"> 9613</span>&#160;        $doccreationdate .= <span class="charliteral">&#39;+&#39;</span>.substr($dcdate, 15, 2).<span class="charliteral">&#39;:&#39;</span>.substr($dcdate, 18, 2);</div>
<div class="line"><a name="l09614"></a><span class="lineno"> 9614</span>&#160;        $doccreationdate = TCPDF_STATIC::_escapeXML($doccreationdate);</div>
<div class="line"><a name="l09615"></a><span class="lineno"> 9615</span>&#160;        <span class="comment">// convert doc modification date format</span></div>
<div class="line"><a name="l09616"></a><span class="lineno"> 9616</span>&#160;        $dmdate = TCPDF_STATIC::getFormattedDate($this-&gt;doc_modification_timestamp);</div>
<div class="line"><a name="l09617"></a><span class="lineno"> 9617</span>&#160;        $docmoddate = substr($dmdate, 0, 4).<span class="charliteral">&#39;-&#39;</span>.substr($dmdate, 4, 2).<span class="charliteral">&#39;-&#39;</span>.substr($dmdate, 6, 2);</div>
<div class="line"><a name="l09618"></a><span class="lineno"> 9618</span>&#160;        $docmoddate .= <span class="charliteral">&#39;T&#39;</span>.substr($dmdate, 8, 2).<span class="charliteral">&#39;:&#39;</span>.substr($dmdate, 10, 2).<span class="charliteral">&#39;:&#39;</span>.substr($dmdate, 12, 2);</div>
<div class="line"><a name="l09619"></a><span class="lineno"> 9619</span>&#160;        $docmoddate .= <span class="charliteral">&#39;+&#39;</span>.substr($dmdate, 15, 2).<span class="charliteral">&#39;:&#39;</span>.substr($dmdate, 18, 2);</div>
<div class="line"><a name="l09620"></a><span class="lineno"> 9620</span>&#160;        $docmoddate = TCPDF_STATIC::_escapeXML($docmoddate);</div>
<div class="line"><a name="l09621"></a><span class="lineno"> 9621</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:Description rdf:about=&quot;&quot; xmlns:xmp=&quot;http://ns.adobe.com/xap/1.0/&quot;&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09622"></a><span class="lineno"> 9622</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;xmp:CreateDate&gt;&#39;</span>.$doccreationdate.<span class="stringliteral">&#39;&lt;/xmp:CreateDate&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09623"></a><span class="lineno"> 9623</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;xmp:CreatorTool&gt;&#39;</span>.$this-&gt;creator.<span class="stringliteral">&#39;&lt;/xmp:CreatorTool&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09624"></a><span class="lineno"> 9624</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;xmp:ModifyDate&gt;&#39;</span>.$docmoddate.<span class="stringliteral">&#39;&lt;/xmp:ModifyDate&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09625"></a><span class="lineno"> 9625</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;xmp:MetadataDate&gt;&#39;</span>.$doccreationdate.<span class="stringliteral">&#39;&lt;/xmp:MetadataDate&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09626"></a><span class="lineno"> 9626</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/rdf:Description&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09627"></a><span class="lineno"> 9627</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:Description rdf:about=&quot;&quot; xmlns:pdf=&quot;http://ns.adobe.com/pdf/1.3/&quot;&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09628"></a><span class="lineno"> 9628</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdf:Keywords&gt;&#39;</span>.TCPDF_STATIC::_escapeXML($this-&gt;keywords).<span class="stringliteral">&#39;&lt;/pdf:Keywords&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09629"></a><span class="lineno"> 9629</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdf:Producer&gt;&#39;</span>.TCPDF_STATIC::_escapeXML(TCPDF_STATIC::getTCPDFProducer()).<span class="stringliteral">&#39;&lt;/pdf:Producer&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09630"></a><span class="lineno"> 9630</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/rdf:Description&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09631"></a><span class="lineno"> 9631</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:Description rdf:about=&quot;&quot; xmlns:xmpMM=&quot;http://ns.adobe.com/xap/1.0/mm/&quot;&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09632"></a><span class="lineno"> 9632</span>&#160;        $uuid = <span class="stringliteral">&#39;uuid:&#39;</span>.substr($this-&gt;file_id, 0, 8).<span class="charliteral">&#39;-&#39;</span>.substr($this-&gt;file_id, 8, 4).<span class="charliteral">&#39;-&#39;</span>.substr($this-&gt;file_id, 12, 4).<span class="charliteral">&#39;-&#39;</span>.substr($this-&gt;file_id, 16, 4).<span class="charliteral">&#39;-&#39;</span>.substr($this-&gt;file_id, 20, 12);</div>
<div class="line"><a name="l09633"></a><span class="lineno"> 9633</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;xmpMM:DocumentID&gt;&#39;</span>.$uuid.<span class="stringliteral">&#39;&lt;/xmpMM:DocumentID&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09634"></a><span class="lineno"> 9634</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;xmpMM:InstanceID&gt;&#39;</span>.$uuid.<span class="stringliteral">&#39;&lt;/xmpMM:InstanceID&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09635"></a><span class="lineno"> 9635</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/rdf:Description&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09636"></a><span class="lineno"> 9636</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;pdfa_mode) {</div>
<div class="line"><a name="l09637"></a><span class="lineno"> 9637</span>&#160;            $xmp .= <span class="stringliteral">&quot;\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:Description rdf:about=&quot;&quot; xmlns:pdfaid=&quot;http://www.aiim.org/pdfa/ns/id/&quot;&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09638"></a><span class="lineno"> 9638</span>&#160;            $xmp .= <span class="stringliteral">&quot;\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaid:part&gt;1&lt;/pdfaid:part&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09639"></a><span class="lineno"> 9639</span>&#160;            $xmp .= <span class="stringliteral">&quot;\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaid:conformance&gt;B&lt;/pdfaid:conformance&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09640"></a><span class="lineno"> 9640</span>&#160;            $xmp .= <span class="stringliteral">&quot;\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/rdf:Description&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09641"></a><span class="lineno"> 9641</span>&#160;        }</div>
<div class="line"><a name="l09642"></a><span class="lineno"> 9642</span>&#160;        <span class="comment">// XMP extension schemas</span></div>
<div class="line"><a name="l09643"></a><span class="lineno"> 9643</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:Description rdf:about=&quot;&quot; xmlns:pdfaExtension=&quot;http://www.aiim.org/pdfa/ns/extension/&quot; xmlns:pdfaSchema=&quot;http://www.aiim.org/pdfa/ns/schema#&quot; xmlns:pdfaProperty=&quot;http://www.aiim.org/pdfa/ns/property#&quot;&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09644"></a><span class="lineno"> 9644</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaExtension:schemas&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09645"></a><span class="lineno"> 9645</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:Bag&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09646"></a><span class="lineno"> 9646</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:li rdf:parseType=&quot;Resource&quot;&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09647"></a><span class="lineno"> 9647</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaSchema:namespaceURI&gt;http://ns.adobe.com/pdf/1.3/&lt;/pdfaSchema:namespaceURI&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09648"></a><span class="lineno"> 9648</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaSchema:prefix&gt;pdf&lt;/pdfaSchema:prefix&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09649"></a><span class="lineno"> 9649</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaSchema:schema&gt;Adobe PDF Schema&lt;/pdfaSchema:schema&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09650"></a><span class="lineno"> 9650</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/rdf:li&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09651"></a><span class="lineno"> 9651</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:li rdf:parseType=&quot;Resource&quot;&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09652"></a><span class="lineno"> 9652</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaSchema:namespaceURI&gt;http://ns.adobe.com/xap/1.0/mm/&lt;/pdfaSchema:namespaceURI&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09653"></a><span class="lineno"> 9653</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaSchema:prefix&gt;xmpMM&lt;/pdfaSchema:prefix&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09654"></a><span class="lineno"> 9654</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaSchema:schema&gt;XMP Media Management Schema&lt;/pdfaSchema:schema&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09655"></a><span class="lineno"> 9655</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaSchema:property&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09656"></a><span class="lineno"> 9656</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:Seq&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09657"></a><span class="lineno"> 9657</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:li rdf:parseType=&quot;Resource&quot;&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09658"></a><span class="lineno"> 9658</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaProperty:category&gt;internal&lt;/pdfaProperty:category&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09659"></a><span class="lineno"> 9659</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaProperty:description&gt;UUID based identifier for specific incarnation of a document&lt;/pdfaProperty:description&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09660"></a><span class="lineno"> 9660</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaProperty:name&gt;InstanceID&lt;/pdfaProperty:name&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09661"></a><span class="lineno"> 9661</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaProperty:valueType&gt;URI&lt;/pdfaProperty:valueType&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09662"></a><span class="lineno"> 9662</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/rdf:li&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09663"></a><span class="lineno"> 9663</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/rdf:Seq&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09664"></a><span class="lineno"> 9664</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/pdfaSchema:property&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09665"></a><span class="lineno"> 9665</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/rdf:li&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09666"></a><span class="lineno"> 9666</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:li rdf:parseType=&quot;Resource&quot;&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09667"></a><span class="lineno"> 9667</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaSchema:namespaceURI&gt;http://www.aiim.org/pdfa/ns/id/&lt;/pdfaSchema:namespaceURI&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09668"></a><span class="lineno"> 9668</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaSchema:prefix&gt;pdfaid&lt;/pdfaSchema:prefix&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09669"></a><span class="lineno"> 9669</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaSchema:schema&gt;PDF/A ID Schema&lt;/pdfaSchema:schema&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09670"></a><span class="lineno"> 9670</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaSchema:property&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09671"></a><span class="lineno"> 9671</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:Seq&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09672"></a><span class="lineno"> 9672</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:li rdf:parseType=&quot;Resource&quot;&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09673"></a><span class="lineno"> 9673</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaProperty:category&gt;internal&lt;/pdfaProperty:category&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09674"></a><span class="lineno"> 9674</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaProperty:description&gt;Part of PDF/A standard&lt;/pdfaProperty:description&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09675"></a><span class="lineno"> 9675</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaProperty:name&gt;part&lt;/pdfaProperty:name&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09676"></a><span class="lineno"> 9676</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaProperty:valueType&gt;Integer&lt;/pdfaProperty:valueType&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09677"></a><span class="lineno"> 9677</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/rdf:li&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09678"></a><span class="lineno"> 9678</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:li rdf:parseType=&quot;Resource&quot;&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09679"></a><span class="lineno"> 9679</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaProperty:category&gt;internal&lt;/pdfaProperty:category&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09680"></a><span class="lineno"> 9680</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaProperty:description&gt;Amendment of PDF/A standard&lt;/pdfaProperty:description&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09681"></a><span class="lineno"> 9681</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaProperty:name&gt;amd&lt;/pdfaProperty:name&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09682"></a><span class="lineno"> 9682</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaProperty:valueType&gt;Text&lt;/pdfaProperty:valueType&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09683"></a><span class="lineno"> 9683</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/rdf:li&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09684"></a><span class="lineno"> 9684</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;rdf:li rdf:parseType=&quot;Resource&quot;&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09685"></a><span class="lineno"> 9685</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaProperty:category&gt;internal&lt;/pdfaProperty:category&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09686"></a><span class="lineno"> 9686</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaProperty:description&gt;Conformance level of PDF/A standard&lt;/pdfaProperty:description&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09687"></a><span class="lineno"> 9687</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaProperty:name&gt;conformance&lt;/pdfaProperty:name&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09688"></a><span class="lineno"> 9688</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;pdfaProperty:valueType&gt;Text&lt;/pdfaProperty:valueType&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09689"></a><span class="lineno"> 9689</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/rdf:li&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09690"></a><span class="lineno"> 9690</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/rdf:Seq&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09691"></a><span class="lineno"> 9691</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/pdfaSchema:property&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09692"></a><span class="lineno"> 9692</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/rdf:li&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09693"></a><span class="lineno"> 9693</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/rdf:Bag&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09694"></a><span class="lineno"> 9694</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/pdfaExtension:schemas&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09695"></a><span class="lineno"> 9695</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t\t&quot;</span>.<span class="stringliteral">&#39;&lt;/rdf:Description&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09696"></a><span class="lineno"> 9696</span>&#160;        $xmp .= <span class="stringliteral">&quot;\t&quot;</span>.<span class="stringliteral">&#39;&lt;/rdf:RDF&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09697"></a><span class="lineno"> 9697</span>&#160;        $xmp .= <a class="code" href="../../d4/d40/classTCPDF.html#a08e9cd78d75c94166e9e4f629b4daa8c">$this-&gt;custom_xmp</a>;</div>
<div class="line"><a name="l09698"></a><span class="lineno"> 9698</span>&#160;        $xmp .= <span class="stringliteral">&#39;&lt;/x:xmpmeta&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09699"></a><span class="lineno"> 9699</span>&#160;        $xmp .= <span class="stringliteral">&#39;&lt;?xpacket end=&quot;w&quot;?&gt;&#39;</span>;</div>
<div class="line"><a name="l09700"></a><span class="lineno"> 9700</span>&#160;        $out = <span class="stringliteral">&#39;&lt;&lt; /Type /Metadata /Subtype /XML /Length &#39;</span>.strlen($xmp).<span class="stringliteral">&#39; &gt;&gt; stream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.$xmp.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endstream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l09701"></a><span class="lineno"> 9701</span>&#160;        <span class="comment">// restore previous isunicode value</span></div>
<div class="line"><a name="l09702"></a><span class="lineno"> 9702</span>&#160;        $this-&gt;isunicode = $prev_isunicode;</div>
<div class="line"><a name="l09703"></a><span class="lineno"> 9703</span>&#160;        $this-&gt;encrypted = $prev_encrypted;</div>
<div class="line"><a name="l09704"></a><span class="lineno"> 9704</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($out);</div>
<div class="line"><a name="l09705"></a><span class="lineno"> 9705</span>&#160;        <span class="keywordflow">return</span> $oid;</div>
<div class="line"><a name="l09706"></a><span class="lineno"> 9706</span>&#160;    }</div>
<div class="line"><a name="l09707"></a><span class="lineno"> 9707</span>&#160;</div>
<div class="line"><a name="l09713"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a795063487ebbe283e4b5e74f66ee6e23"> 9713</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a795063487ebbe283e4b5e74f66ee6e23">_putcatalog</a>() {</div>
<div class="line"><a name="l09714"></a><span class="lineno"> 9714</span>&#160;        <span class="comment">// put XMP</span></div>
<div class="line"><a name="l09715"></a><span class="lineno"> 9715</span>&#160;        $xmpobj = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a570325299ecf78f328faa53e8758a015">_putXMP</a>();</div>
<div class="line"><a name="l09716"></a><span class="lineno"> 9716</span>&#160;        <span class="comment">// if required, add standard sRGB_IEC61966-2.1 blackscaled ICC colour profile</span></div>
<div class="line"><a name="l09717"></a><span class="lineno"> 9717</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;pdfa_mode OR $this-&gt;force_srgb) {</div>
<div class="line"><a name="l09718"></a><span class="lineno"> 9718</span>&#160;            $iccobj = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d">_newobj</a>();</div>
<div class="line"><a name="l09719"></a><span class="lineno"> 9719</span>&#160;            $icc = file_get_contents(dirname(__FILE__).<span class="stringliteral">&#39;/include/sRGB.icc&#39;</span>);</div>
<div class="line"><a name="l09720"></a><span class="lineno"> 9720</span>&#160;            $filter = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l09721"></a><span class="lineno"> 9721</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;compress) {</div>
<div class="line"><a name="l09722"></a><span class="lineno"> 9722</span>&#160;                $filter = <span class="stringliteral">&#39; /Filter /FlateDecode&#39;</span>;</div>
<div class="line"><a name="l09723"></a><span class="lineno"> 9723</span>&#160;                $icc = gzcompress($icc);</div>
<div class="line"><a name="l09724"></a><span class="lineno"> 9724</span>&#160;            }</div>
<div class="line"><a name="l09725"></a><span class="lineno"> 9725</span>&#160;            $icc = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a7c7c1beebd83fa777197a842f2ca73eb">_getrawstream</a>($icc);</div>
<div class="line"><a name="l09726"></a><span class="lineno"> 9726</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(<span class="stringliteral">&#39;&lt;&lt;/N 3 &#39;</span>.$filter.<span class="stringliteral">&#39;/Length &#39;</span>.strlen($icc).<span class="stringliteral">&#39;&gt;&gt; stream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.$icc.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endstream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>);</div>
<div class="line"><a name="l09727"></a><span class="lineno"> 9727</span>&#160;        }</div>
<div class="line"><a name="l09728"></a><span class="lineno"> 9728</span>&#160;        <span class="comment">// start catalog</span></div>
<div class="line"><a name="l09729"></a><span class="lineno"> 9729</span>&#160;        $oid = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d">_newobj</a>();</div>
<div class="line"><a name="l09730"></a><span class="lineno"> 9730</span>&#160;        $out = <span class="stringliteral">&#39;&lt;&lt; /Type /Catalog&#39;</span>;</div>
<div class="line"><a name="l09731"></a><span class="lineno"> 9731</span>&#160;        $out .= <span class="stringliteral">&#39; /Version /&#39;</span>.$this-&gt;PDFVersion;</div>
<div class="line"><a name="l09732"></a><span class="lineno"> 9732</span>&#160;        <span class="comment">//$out .= &#39; /Extensions &lt;&lt;&gt;&gt;&#39;;</span></div>
<div class="line"><a name="l09733"></a><span class="lineno"> 9733</span>&#160;        $out .= <span class="stringliteral">&#39; /Pages 1 0 R&#39;</span>;</div>
<div class="line"><a name="l09734"></a><span class="lineno"> 9734</span>&#160;        <span class="comment">//$out .= &#39; /PageLabels &#39; //...;</span></div>
<div class="line"><a name="l09735"></a><span class="lineno"> 9735</span>&#160;        $out .= <span class="stringliteral">&#39; /Names &lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l09736"></a><span class="lineno"> 9736</span>&#160;        <span class="keywordflow">if</span> ((!$this-&gt;pdfa_mode) AND !empty($this-&gt;n_js)) {</div>
<div class="line"><a name="l09737"></a><span class="lineno"> 9737</span>&#160;            $out .= <span class="stringliteral">&#39; /JavaScript &#39;</span>.$this-&gt;n_js;</div>
<div class="line"><a name="l09738"></a><span class="lineno"> 9738</span>&#160;        }</div>
<div class="line"><a name="l09739"></a><span class="lineno"> 9739</span>&#160;        <span class="keywordflow">if</span> (!empty($this-&gt;efnames)) {</div>
<div class="line"><a name="l09740"></a><span class="lineno"> 9740</span>&#160;            $out .= <span class="stringliteral">&#39; /EmbeddedFiles &lt;&lt;/Names [&#39;</span>;</div>
<div class="line"><a name="l09741"></a><span class="lineno"> 9741</span>&#160;            <span class="keywordflow">foreach</span> ($this-&gt;efnames AS $fn =&gt; $fref) {</div>
<div class="line"><a name="l09742"></a><span class="lineno"> 9742</span>&#160;                $out .= <span class="charliteral">&#39; &#39;</span>.$this-&gt;_datastring($fn).<span class="charliteral">&#39; &#39;</span>.$fref;</div>
<div class="line"><a name="l09743"></a><span class="lineno"> 9743</span>&#160;            }</div>
<div class="line"><a name="l09744"></a><span class="lineno"> 9744</span>&#160;            $out .= <span class="stringliteral">&#39; ]&gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l09745"></a><span class="lineno"> 9745</span>&#160;        }</div>
<div class="line"><a name="l09746"></a><span class="lineno"> 9746</span>&#160;        $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l09747"></a><span class="lineno"> 9747</span>&#160;        <span class="keywordflow">if</span> (!empty($this-&gt;dests)) {</div>
<div class="line"><a name="l09748"></a><span class="lineno"> 9748</span>&#160;            $out .= <span class="stringliteral">&#39; /Dests &#39;</span>.($this-&gt;n_dests).<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l09749"></a><span class="lineno"> 9749</span>&#160;        }</div>
<div class="line"><a name="l09750"></a><span class="lineno"> 9750</span>&#160;        $out .= $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1651570142db46f184f83373fbd72a04">_putviewerpreferences</a>();</div>
<div class="line"><a name="l09751"></a><span class="lineno"> 9751</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;LayoutMode) AND (!TCPDF_STATIC::empty_string($this-&gt;LayoutMode))) {</div>
<div class="line"><a name="l09752"></a><span class="lineno"> 9752</span>&#160;            $out .= <span class="stringliteral">&#39; /PageLayout /&#39;</span>.$this-&gt;LayoutMode;</div>
<div class="line"><a name="l09753"></a><span class="lineno"> 9753</span>&#160;        }</div>
<div class="line"><a name="l09754"></a><span class="lineno"> 9754</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;PageMode) AND (!TCPDF_STATIC::empty_string($this-&gt;PageMode))) {</div>
<div class="line"><a name="l09755"></a><span class="lineno"> 9755</span>&#160;            $out .= <span class="stringliteral">&#39; /PageMode /&#39;</span>.$this-&gt;PageMode;</div>
<div class="line"><a name="l09756"></a><span class="lineno"> 9756</span>&#160;        }</div>
<div class="line"><a name="l09757"></a><span class="lineno"> 9757</span>&#160;        <span class="keywordflow">if</span> (count($this-&gt;outlines) &gt; 0) {</div>
<div class="line"><a name="l09758"></a><span class="lineno"> 9758</span>&#160;            $out .= <span class="stringliteral">&#39; /Outlines &#39;</span>.$this-&gt;OutlineRoot.<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l09759"></a><span class="lineno"> 9759</span>&#160;            $out .= <span class="stringliteral">&#39; /PageMode /UseOutlines&#39;</span>;</div>
<div class="line"><a name="l09760"></a><span class="lineno"> 9760</span>&#160;        }</div>
<div class="line"><a name="l09761"></a><span class="lineno"> 9761</span>&#160;        <span class="comment">//$out .= &#39; /Threads []&#39;;</span></div>
<div class="line"><a name="l09762"></a><span class="lineno"> 9762</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;ZoomMode == <span class="stringliteral">&#39;fullpage&#39;</span>) {</div>
<div class="line"><a name="l09763"></a><span class="lineno"> 9763</span>&#160;            $out .= <span class="stringliteral">&#39; /OpenAction [&#39;</span>.$this-&gt;page_obj_id[1].<span class="stringliteral">&#39; 0 R /Fit]&#39;</span>;</div>
<div class="line"><a name="l09764"></a><span class="lineno"> 9764</span>&#160;        } elseif ($this-&gt;ZoomMode == <span class="stringliteral">&#39;fullwidth&#39;</span>) {</div>
<div class="line"><a name="l09765"></a><span class="lineno"> 9765</span>&#160;            $out .= <span class="stringliteral">&#39; /OpenAction [&#39;</span>.$this-&gt;page_obj_id[1].<span class="stringliteral">&#39; 0 R /FitH null]&#39;</span>;</div>
<div class="line"><a name="l09766"></a><span class="lineno"> 9766</span>&#160;        } elseif ($this-&gt;ZoomMode == <span class="stringliteral">&#39;real&#39;</span>) {</div>
<div class="line"><a name="l09767"></a><span class="lineno"> 9767</span>&#160;            $out .= <span class="stringliteral">&#39; /OpenAction [&#39;</span>.$this-&gt;page_obj_id[1].<span class="stringliteral">&#39; 0 R /XYZ null null 1]&#39;</span>;</div>
<div class="line"><a name="l09768"></a><span class="lineno"> 9768</span>&#160;        } elseif (!is_string($this-&gt;ZoomMode)) {</div>
<div class="line"><a name="l09769"></a><span class="lineno"> 9769</span>&#160;            $out .= sprintf(<span class="stringliteral">&#39; /OpenAction [&#39;</span>.$this-&gt;page_obj_id[1].<span class="stringliteral">&#39; 0 R /XYZ null null %F]&#39;</span>, ($this-&gt;ZoomMode / 100));</div>
<div class="line"><a name="l09770"></a><span class="lineno"> 9770</span>&#160;        }</div>
<div class="line"><a name="l09771"></a><span class="lineno"> 9771</span>&#160;        <span class="comment">//$out .= &#39; /AA &lt;&lt;&gt;&gt;&#39;;</span></div>
<div class="line"><a name="l09772"></a><span class="lineno"> 9772</span>&#160;        <span class="comment">//$out .= &#39; /URI &lt;&lt;&gt;&gt;&#39;;</span></div>
<div class="line"><a name="l09773"></a><span class="lineno"> 9773</span>&#160;        $out .= <span class="stringliteral">&#39; /Metadata &#39;</span>.$xmpobj.<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l09774"></a><span class="lineno"> 9774</span>&#160;        <span class="comment">//$out .= &#39; /StructTreeRoot &lt;&lt;&gt;&gt;&#39;;</span></div>
<div class="line"><a name="l09775"></a><span class="lineno"> 9775</span>&#160;        <span class="comment">//$out .= &#39; /MarkInfo &lt;&lt;&gt;&gt;&#39;;</span></div>
<div class="line"><a name="l09776"></a><span class="lineno"> 9776</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;l[<span class="stringliteral">&#39;a_meta_language&#39;</span>])) {</div>
<div class="line"><a name="l09777"></a><span class="lineno"> 9777</span>&#160;            $out .= <span class="stringliteral">&#39; /Lang &#39;</span>.$this-&gt;_textstring($this-&gt;l[<span class="stringliteral">&#39;a_meta_language&#39;</span>], $oid);</div>
<div class="line"><a name="l09778"></a><span class="lineno"> 9778</span>&#160;        }</div>
<div class="line"><a name="l09779"></a><span class="lineno"> 9779</span>&#160;        <span class="comment">//$out .= &#39; /SpiderInfo &lt;&lt;&gt;&gt;&#39;;</span></div>
<div class="line"><a name="l09780"></a><span class="lineno"> 9780</span>&#160;        <span class="comment">// set OutputIntent to sRGB IEC61966-2.1 if required</span></div>
<div class="line"><a name="l09781"></a><span class="lineno"> 9781</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;pdfa_mode OR $this-&gt;force_srgb) {</div>
<div class="line"><a name="l09782"></a><span class="lineno"> 9782</span>&#160;            $out .= <span class="stringliteral">&#39; /OutputIntents [&lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l09783"></a><span class="lineno"> 9783</span>&#160;            $out .= <span class="stringliteral">&#39; /Type /OutputIntent&#39;</span>;</div>
<div class="line"><a name="l09784"></a><span class="lineno"> 9784</span>&#160;            $out .= <span class="stringliteral">&#39; /S /GTS_PDFA1&#39;</span>;</div>
<div class="line"><a name="l09785"></a><span class="lineno"> 9785</span>&#160;            $out .= <span class="stringliteral">&#39; /OutputCondition &#39;</span>.$this-&gt;_textstring(<span class="stringliteral">&#39;sRGB IEC61966-2.1&#39;</span>, $oid);</div>
<div class="line"><a name="l09786"></a><span class="lineno"> 9786</span>&#160;            $out .= <span class="stringliteral">&#39; /OutputConditionIdentifier &#39;</span>.$this-&gt;_textstring(<span class="stringliteral">&#39;sRGB IEC61966-2.1&#39;</span>, $oid);</div>
<div class="line"><a name="l09787"></a><span class="lineno"> 9787</span>&#160;            $out .= <span class="stringliteral">&#39; /RegistryName &#39;</span>.$this-&gt;_textstring(<span class="stringliteral">&#39;http://www.color.org&#39;</span>, $oid);</div>
<div class="line"><a name="l09788"></a><span class="lineno"> 9788</span>&#160;            $out .= <span class="stringliteral">&#39; /Info &#39;</span>.$this-&gt;_textstring(<span class="stringliteral">&#39;sRGB IEC61966-2.1&#39;</span>, $oid);</div>
<div class="line"><a name="l09789"></a><span class="lineno"> 9789</span>&#160;            $out .= <span class="stringliteral">&#39; /DestOutputProfile &#39;</span>.$iccobj.<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l09790"></a><span class="lineno"> 9790</span>&#160;            $out .= <span class="stringliteral">&#39; &gt;&gt;]&#39;</span>;</div>
<div class="line"><a name="l09791"></a><span class="lineno"> 9791</span>&#160;        }</div>
<div class="line"><a name="l09792"></a><span class="lineno"> 9792</span>&#160;        <span class="comment">//$out .= &#39; /PieceInfo &lt;&lt;&gt;&gt;&#39;;</span></div>
<div class="line"><a name="l09793"></a><span class="lineno"> 9793</span>&#160;        <span class="keywordflow">if</span> (!empty($this-&gt;pdflayers)) {</div>
<div class="line"><a name="l09794"></a><span class="lineno"> 9794</span>&#160;            $lyrobjs = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l09795"></a><span class="lineno"> 9795</span>&#160;            $lyrobjs_off = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l09796"></a><span class="lineno"> 9796</span>&#160;            $lyrobjs_lock = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l09797"></a><span class="lineno"> 9797</span>&#160;            <span class="keywordflow">foreach</span> ($this-&gt;pdflayers as $layer) {</div>
<div class="line"><a name="l09798"></a><span class="lineno"> 9798</span>&#160;                $layer_obj_ref = <span class="charliteral">&#39; &#39;</span>.$layer[<span class="stringliteral">&#39;objid&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l09799"></a><span class="lineno"> 9799</span>&#160;                $lyrobjs .= $layer_obj_ref;</div>
<div class="line"><a name="l09800"></a><span class="lineno"> 9800</span>&#160;                <span class="keywordflow">if</span> ($layer[<span class="stringliteral">&#39;view&#39;</span>] === <span class="keyword">false</span>) {</div>
<div class="line"><a name="l09801"></a><span class="lineno"> 9801</span>&#160;                    $lyrobjs_off .= $layer_obj_ref;</div>
<div class="line"><a name="l09802"></a><span class="lineno"> 9802</span>&#160;                }</div>
<div class="line"><a name="l09803"></a><span class="lineno"> 9803</span>&#160;                <span class="keywordflow">if</span> ($layer[<span class="stringliteral">&#39;lock&#39;</span>]) {</div>
<div class="line"><a name="l09804"></a><span class="lineno"> 9804</span>&#160;                    $lyrobjs_lock .= $layer_obj_ref;</div>
<div class="line"><a name="l09805"></a><span class="lineno"> 9805</span>&#160;                }</div>
<div class="line"><a name="l09806"></a><span class="lineno"> 9806</span>&#160;            }</div>
<div class="line"><a name="l09807"></a><span class="lineno"> 9807</span>&#160;            $out .= <span class="stringliteral">&#39; /OCProperties &lt;&lt; /OCGs [&#39;</span>.$lyrobjs.<span class="charliteral">&#39;]&#39;</span>;</div>
<div class="line"><a name="l09808"></a><span class="lineno"> 9808</span>&#160;            $out .= <span class="stringliteral">&#39; /D &lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l09809"></a><span class="lineno"> 9809</span>&#160;            $out .= <span class="stringliteral">&#39; /Name &#39;</span>.$this-&gt;_textstring(<span class="stringliteral">&#39;Layers&#39;</span>, $oid);</div>
<div class="line"><a name="l09810"></a><span class="lineno"> 9810</span>&#160;            $out .= <span class="stringliteral">&#39; /Creator &#39;</span>.$this-&gt;_textstring(<span class="stringliteral">&#39;TCPDF&#39;</span>, $oid);</div>
<div class="line"><a name="l09811"></a><span class="lineno"> 9811</span>&#160;            $out .= <span class="stringliteral">&#39; /BaseState /ON&#39;</span>;</div>
<div class="line"><a name="l09812"></a><span class="lineno"> 9812</span>&#160;            $out .= <span class="stringliteral">&#39; /OFF [&#39;</span>.$lyrobjs_off.<span class="charliteral">&#39;]&#39;</span>;</div>
<div class="line"><a name="l09813"></a><span class="lineno"> 9813</span>&#160;            $out .= <span class="stringliteral">&#39; /Locked [&#39;</span>.$lyrobjs_lock.<span class="charliteral">&#39;]&#39;</span>;</div>
<div class="line"><a name="l09814"></a><span class="lineno"> 9814</span>&#160;            $out .= <span class="stringliteral">&#39; /Intent /View&#39;</span>;</div>
<div class="line"><a name="l09815"></a><span class="lineno"> 9815</span>&#160;            $out .= <span class="stringliteral">&#39; /AS [&#39;</span>;</div>
<div class="line"><a name="l09816"></a><span class="lineno"> 9816</span>&#160;            $out .= <span class="stringliteral">&#39; &lt;&lt; /Event /Print /OCGs [&#39;</span>.$lyrobjs.<span class="stringliteral">&#39;] /Category [/Print] &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l09817"></a><span class="lineno"> 9817</span>&#160;            $out .= <span class="stringliteral">&#39; &lt;&lt; /Event /View /OCGs [&#39;</span>.$lyrobjs.<span class="stringliteral">&#39;] /Category [/View] &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l09818"></a><span class="lineno"> 9818</span>&#160;            $out .= <span class="stringliteral">&#39; ]&#39;</span>;</div>
<div class="line"><a name="l09819"></a><span class="lineno"> 9819</span>&#160;            $out .= <span class="stringliteral">&#39; /Order [&#39;</span>.$lyrobjs.<span class="charliteral">&#39;]&#39;</span>;</div>
<div class="line"><a name="l09820"></a><span class="lineno"> 9820</span>&#160;            $out .= <span class="stringliteral">&#39; /ListMode /AllPages&#39;</span>;</div>
<div class="line"><a name="l09821"></a><span class="lineno"> 9821</span>&#160;            <span class="comment">//$out .= &#39; /RBGroups [&#39;..&#39;]&#39;;</span></div>
<div class="line"><a name="l09822"></a><span class="lineno"> 9822</span>&#160;            <span class="comment">//$out .= &#39; /Locked [&#39;..&#39;]&#39;;</span></div>
<div class="line"><a name="l09823"></a><span class="lineno"> 9823</span>&#160;            $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l09824"></a><span class="lineno"> 9824</span>&#160;            $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l09825"></a><span class="lineno"> 9825</span>&#160;        }</div>
<div class="line"><a name="l09826"></a><span class="lineno"> 9826</span>&#160;        <span class="comment">// AcroForm</span></div>
<div class="line"><a name="l09827"></a><span class="lineno"> 9827</span>&#160;        <span class="keywordflow">if</span> (!empty($this-&gt;form_obj_id)</div>
<div class="line"><a name="l09828"></a><span class="lineno"> 9828</span>&#160;            OR ($this-&gt;sign AND isset($this-&gt;signature_data[<span class="stringliteral">&#39;cert_type&#39;</span>]))</div>
<div class="line"><a name="l09829"></a><span class="lineno"> 9829</span>&#160;            OR !empty($this-&gt;empty_signature_appearance)) {</div>
<div class="line"><a name="l09830"></a><span class="lineno"> 9830</span>&#160;            $out .= <span class="stringliteral">&#39; /AcroForm &lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l09831"></a><span class="lineno"> 9831</span>&#160;            $objrefs = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l09832"></a><span class="lineno"> 9832</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;sign AND isset($this-&gt;signature_data[<span class="stringliteral">&#39;cert_type&#39;</span>])) {</div>
<div class="line"><a name="l09833"></a><span class="lineno"> 9833</span>&#160;                <span class="comment">// set reference for signature object</span></div>
<div class="line"><a name="l09834"></a><span class="lineno"> 9834</span>&#160;                $objrefs .= $this-&gt;sig_obj_id.<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l09835"></a><span class="lineno"> 9835</span>&#160;            }</div>
<div class="line"><a name="l09836"></a><span class="lineno"> 9836</span>&#160;            <span class="keywordflow">if</span> (!empty($this-&gt;empty_signature_appearance)) {</div>
<div class="line"><a name="l09837"></a><span class="lineno"> 9837</span>&#160;                <span class="keywordflow">foreach</span> ($this-&gt;empty_signature_appearance as $esa) {</div>
<div class="line"><a name="l09838"></a><span class="lineno"> 9838</span>&#160;                    <span class="comment">// set reference for empty signature objects</span></div>
<div class="line"><a name="l09839"></a><span class="lineno"> 9839</span>&#160;                    $objrefs .= <span class="charliteral">&#39; &#39;</span>.$esa[<span class="stringliteral">&#39;objid&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l09840"></a><span class="lineno"> 9840</span>&#160;                }</div>
<div class="line"><a name="l09841"></a><span class="lineno"> 9841</span>&#160;            }</div>
<div class="line"><a name="l09842"></a><span class="lineno"> 9842</span>&#160;            <span class="keywordflow">if</span> (!empty($this-&gt;form_obj_id)) {</div>
<div class="line"><a name="l09843"></a><span class="lineno"> 9843</span>&#160;                <span class="keywordflow">foreach</span>($this-&gt;form_obj_id as $objid) {</div>
<div class="line"><a name="l09844"></a><span class="lineno"> 9844</span>&#160;                    $objrefs .= <span class="charliteral">&#39; &#39;</span>.$objid.<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l09845"></a><span class="lineno"> 9845</span>&#160;                }</div>
<div class="line"><a name="l09846"></a><span class="lineno"> 9846</span>&#160;            }</div>
<div class="line"><a name="l09847"></a><span class="lineno"> 9847</span>&#160;            $out .= <span class="stringliteral">&#39; /Fields [&#39;</span>.$objrefs.<span class="charliteral">&#39;]&#39;</span>;</div>
<div class="line"><a name="l09848"></a><span class="lineno"> 9848</span>&#160;            <span class="comment">// It&#39;s better to turn off this value and set the appearance stream for each annotation (/AP) to avoid conflicts with signature fields.</span></div>
<div class="line"><a name="l09849"></a><span class="lineno"> 9849</span>&#160;            <span class="keywordflow">if</span> (empty($this-&gt;signature_data[<span class="stringliteral">&#39;approval&#39;</span>]) OR ($this-&gt;signature_data[<span class="stringliteral">&#39;approval&#39;</span>] != <span class="charliteral">&#39;A&#39;</span>)) {</div>
<div class="line"><a name="l09850"></a><span class="lineno"> 9850</span>&#160;                $out .= <span class="stringliteral">&#39; /NeedAppearances false&#39;</span>;</div>
<div class="line"><a name="l09851"></a><span class="lineno"> 9851</span>&#160;            }</div>
<div class="line"><a name="l09852"></a><span class="lineno"> 9852</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;sign AND isset($this-&gt;signature_data[<span class="stringliteral">&#39;cert_type&#39;</span>])) {</div>
<div class="line"><a name="l09853"></a><span class="lineno"> 9853</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;signature_data[<span class="stringliteral">&#39;cert_type&#39;</span>] &gt; 0) {</div>
<div class="line"><a name="l09854"></a><span class="lineno"> 9854</span>&#160;                    $out .= <span class="stringliteral">&#39; /SigFlags 3&#39;</span>;</div>
<div class="line"><a name="l09855"></a><span class="lineno"> 9855</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l09856"></a><span class="lineno"> 9856</span>&#160;                    $out .= <span class="stringliteral">&#39; /SigFlags 1&#39;</span>;</div>
<div class="line"><a name="l09857"></a><span class="lineno"> 9857</span>&#160;                }</div>
<div class="line"><a name="l09858"></a><span class="lineno"> 9858</span>&#160;            }</div>
<div class="line"><a name="l09859"></a><span class="lineno"> 9859</span>&#160;            <span class="comment">//$out .= &#39; /CO &#39;;</span></div>
<div class="line"><a name="l09860"></a><span class="lineno"> 9860</span>&#160;            <span class="keywordflow">if</span> (isset($this-&gt;annotation_fonts) AND !empty($this-&gt;annotation_fonts)) {</div>
<div class="line"><a name="l09861"></a><span class="lineno"> 9861</span>&#160;                $out .= <span class="stringliteral">&#39; /DR &lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l09862"></a><span class="lineno"> 9862</span>&#160;                $out .= <span class="stringliteral">&#39; /Font &lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l09863"></a><span class="lineno"> 9863</span>&#160;                <span class="keywordflow">foreach</span> ($this-&gt;annotation_fonts as $fontkey =&gt; $fontid) {</div>
<div class="line"><a name="l09864"></a><span class="lineno"> 9864</span>&#160;                    $out .= <span class="stringliteral">&#39; /F&#39;</span>.$fontid.<span class="charliteral">&#39; &#39;</span>.$this-&gt;font_obj_ids[$fontkey].<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l09865"></a><span class="lineno"> 9865</span>&#160;                }</div>
<div class="line"><a name="l09866"></a><span class="lineno"> 9866</span>&#160;                $out .= <span class="stringliteral">&#39; &gt;&gt; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l09867"></a><span class="lineno"> 9867</span>&#160;            }</div>
<div class="line"><a name="l09868"></a><span class="lineno"> 9868</span>&#160;            $font = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac63fff093a17846764bbcc09af7c8640">getFontBuffer</a>(<span class="stringliteral">&#39;helvetica&#39;</span>);</div>
<div class="line"><a name="l09869"></a><span class="lineno"> 9869</span>&#160;            $out .= <span class="stringliteral">&#39; /DA (/F&#39;</span>.$font[<span class="charliteral">&#39;i&#39;</span>].<span class="stringliteral">&#39; 0 Tf 0 g)&#39;</span>;</div>
<div class="line"><a name="l09870"></a><span class="lineno"> 9870</span>&#160;            $out .= <span class="stringliteral">&#39; /Q &#39;</span>.(($this-&gt;rtl)?<span class="charliteral">&#39;2&#39;</span>:<span class="charliteral">&#39;0&#39;</span>);</div>
<div class="line"><a name="l09871"></a><span class="lineno"> 9871</span>&#160;            <span class="comment">//$out .= &#39; /XFA &#39;;</span></div>
<div class="line"><a name="l09872"></a><span class="lineno"> 9872</span>&#160;            $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l09873"></a><span class="lineno"> 9873</span>&#160;            <span class="comment">// signatures</span></div>
<div class="line"><a name="l09874"></a><span class="lineno"> 9874</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;sign AND isset($this-&gt;signature_data[<span class="stringliteral">&#39;cert_type&#39;</span>]) </div>
<div class="line"><a name="l09875"></a><span class="lineno"> 9875</span>&#160;                AND (empty($this-&gt;signature_data[<span class="stringliteral">&#39;approval&#39;</span>]) OR ($this-&gt;signature_data[<span class="stringliteral">&#39;approval&#39;</span>] != <span class="charliteral">&#39;A&#39;</span>))) {</div>
<div class="line"><a name="l09876"></a><span class="lineno"> 9876</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;signature_data[<span class="stringliteral">&#39;cert_type&#39;</span>] &gt; 0) {</div>
<div class="line"><a name="l09877"></a><span class="lineno"> 9877</span>&#160;                    $out .= <span class="stringliteral">&#39; /Perms &lt;&lt; /DocMDP &#39;</span>.($this-&gt;sig_obj_id + 1).<span class="stringliteral">&#39; 0 R &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l09878"></a><span class="lineno"> 9878</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l09879"></a><span class="lineno"> 9879</span>&#160;                    $out .= <span class="stringliteral">&#39; /Perms &lt;&lt; /UR3 &#39;</span>.($this-&gt;sig_obj_id + 1).<span class="stringliteral">&#39; 0 R &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l09880"></a><span class="lineno"> 9880</span>&#160;                }</div>
<div class="line"><a name="l09881"></a><span class="lineno"> 9881</span>&#160;            }</div>
<div class="line"><a name="l09882"></a><span class="lineno"> 9882</span>&#160;        }</div>
<div class="line"><a name="l09883"></a><span class="lineno"> 9883</span>&#160;        <span class="comment">//$out .= &#39; /Legal &lt;&lt;&gt;&gt;&#39;;</span></div>
<div class="line"><a name="l09884"></a><span class="lineno"> 9884</span>&#160;        <span class="comment">//$out .= &#39; /Requirements []&#39;;</span></div>
<div class="line"><a name="l09885"></a><span class="lineno"> 9885</span>&#160;        <span class="comment">//$out .= &#39; /Collection &lt;&lt;&gt;&gt;&#39;;</span></div>
<div class="line"><a name="l09886"></a><span class="lineno"> 9886</span>&#160;        <span class="comment">//$out .= &#39; /NeedsRendering true&#39;;</span></div>
<div class="line"><a name="l09887"></a><span class="lineno"> 9887</span>&#160;        $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l09888"></a><span class="lineno"> 9888</span>&#160;        $out .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l09889"></a><span class="lineno"> 9889</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($out);</div>
<div class="line"><a name="l09890"></a><span class="lineno"> 9890</span>&#160;        <span class="keywordflow">return</span> $oid;</div>
<div class="line"><a name="l09891"></a><span class="lineno"> 9891</span>&#160;    }</div>
<div class="line"><a name="l09892"></a><span class="lineno"> 9892</span>&#160;</div>
<div class="line"><a name="l09900"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a1651570142db46f184f83373fbd72a04"> 9900</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a1651570142db46f184f83373fbd72a04">_putviewerpreferences</a>() {</div>
<div class="line"><a name="l09901"></a><span class="lineno"> 9901</span>&#160;        $vp = <a class="code" href="../../d4/d40/classTCPDF.html#acb8e8249a228d343d4c5254f8cd6c75a">$this-&gt;viewer_preferences</a>;</div>
<div class="line"><a name="l09902"></a><span class="lineno"> 9902</span>&#160;        $out = <span class="stringliteral">&#39; /ViewerPreferences &lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l09903"></a><span class="lineno"> 9903</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l09904"></a><span class="lineno"> 9904</span>&#160;            $out .= <span class="stringliteral">&#39; /Direction /R2L&#39;</span>;</div>
<div class="line"><a name="l09905"></a><span class="lineno"> 9905</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l09906"></a><span class="lineno"> 9906</span>&#160;            $out .= <span class="stringliteral">&#39; /Direction /L2R&#39;</span>;</div>
<div class="line"><a name="l09907"></a><span class="lineno"> 9907</span>&#160;        }</div>
<div class="line"><a name="l09908"></a><span class="lineno"> 9908</span>&#160;        <span class="keywordflow">if</span> (isset($vp[<span class="stringliteral">&#39;HideToolbar&#39;</span>]) AND ($vp[<span class="stringliteral">&#39;HideToolbar&#39;</span>])) {</div>
<div class="line"><a name="l09909"></a><span class="lineno"> 9909</span>&#160;            $out .= <span class="stringliteral">&#39; /HideToolbar true&#39;</span>;</div>
<div class="line"><a name="l09910"></a><span class="lineno"> 9910</span>&#160;        }</div>
<div class="line"><a name="l09911"></a><span class="lineno"> 9911</span>&#160;        <span class="keywordflow">if</span> (isset($vp[<span class="stringliteral">&#39;HideMenubar&#39;</span>]) AND ($vp[<span class="stringliteral">&#39;HideMenubar&#39;</span>])) {</div>
<div class="line"><a name="l09912"></a><span class="lineno"> 9912</span>&#160;            $out .= <span class="stringliteral">&#39; /HideMenubar true&#39;</span>;</div>
<div class="line"><a name="l09913"></a><span class="lineno"> 9913</span>&#160;        }</div>
<div class="line"><a name="l09914"></a><span class="lineno"> 9914</span>&#160;        <span class="keywordflow">if</span> (isset($vp[<span class="stringliteral">&#39;HideWindowUI&#39;</span>]) AND ($vp[<span class="stringliteral">&#39;HideWindowUI&#39;</span>])) {</div>
<div class="line"><a name="l09915"></a><span class="lineno"> 9915</span>&#160;            $out .= <span class="stringliteral">&#39; /HideWindowUI true&#39;</span>;</div>
<div class="line"><a name="l09916"></a><span class="lineno"> 9916</span>&#160;        }</div>
<div class="line"><a name="l09917"></a><span class="lineno"> 9917</span>&#160;        <span class="keywordflow">if</span> (isset($vp[<span class="stringliteral">&#39;FitWindow&#39;</span>]) AND ($vp[<span class="stringliteral">&#39;FitWindow&#39;</span>])) {</div>
<div class="line"><a name="l09918"></a><span class="lineno"> 9918</span>&#160;            $out .= <span class="stringliteral">&#39; /FitWindow true&#39;</span>;</div>
<div class="line"><a name="l09919"></a><span class="lineno"> 9919</span>&#160;        }</div>
<div class="line"><a name="l09920"></a><span class="lineno"> 9920</span>&#160;        <span class="keywordflow">if</span> (isset($vp[<span class="stringliteral">&#39;CenterWindow&#39;</span>]) AND ($vp[<span class="stringliteral">&#39;CenterWindow&#39;</span>])) {</div>
<div class="line"><a name="l09921"></a><span class="lineno"> 9921</span>&#160;            $out .= <span class="stringliteral">&#39; /CenterWindow true&#39;</span>;</div>
<div class="line"><a name="l09922"></a><span class="lineno"> 9922</span>&#160;        }</div>
<div class="line"><a name="l09923"></a><span class="lineno"> 9923</span>&#160;        <span class="keywordflow">if</span> (isset($vp[<span class="stringliteral">&#39;DisplayDocTitle&#39;</span>]) AND ($vp[<span class="stringliteral">&#39;DisplayDocTitle&#39;</span>])) {</div>
<div class="line"><a name="l09924"></a><span class="lineno"> 9924</span>&#160;            $out .= <span class="stringliteral">&#39; /DisplayDocTitle true&#39;</span>;</div>
<div class="line"><a name="l09925"></a><span class="lineno"> 9925</span>&#160;        }</div>
<div class="line"><a name="l09926"></a><span class="lineno"> 9926</span>&#160;        <span class="keywordflow">if</span> (isset($vp[<span class="stringliteral">&#39;NonFullScreenPageMode&#39;</span>])) {</div>
<div class="line"><a name="l09927"></a><span class="lineno"> 9927</span>&#160;            $out .= <span class="stringliteral">&#39; /NonFullScreenPageMode /&#39;</span>.$vp[<span class="stringliteral">&#39;NonFullScreenPageMode&#39;</span>];</div>
<div class="line"><a name="l09928"></a><span class="lineno"> 9928</span>&#160;        }</div>
<div class="line"><a name="l09929"></a><span class="lineno"> 9929</span>&#160;        <span class="keywordflow">if</span> (isset($vp[<span class="stringliteral">&#39;ViewArea&#39;</span>])) {</div>
<div class="line"><a name="l09930"></a><span class="lineno"> 9930</span>&#160;            $out .= <span class="stringliteral">&#39; /ViewArea /&#39;</span>.$vp[<span class="stringliteral">&#39;ViewArea&#39;</span>];</div>
<div class="line"><a name="l09931"></a><span class="lineno"> 9931</span>&#160;        }</div>
<div class="line"><a name="l09932"></a><span class="lineno"> 9932</span>&#160;        <span class="keywordflow">if</span> (isset($vp[<span class="stringliteral">&#39;ViewClip&#39;</span>])) {</div>
<div class="line"><a name="l09933"></a><span class="lineno"> 9933</span>&#160;            $out .= <span class="stringliteral">&#39; /ViewClip /&#39;</span>.$vp[<span class="stringliteral">&#39;ViewClip&#39;</span>];</div>
<div class="line"><a name="l09934"></a><span class="lineno"> 9934</span>&#160;        }</div>
<div class="line"><a name="l09935"></a><span class="lineno"> 9935</span>&#160;        <span class="keywordflow">if</span> (isset($vp[<span class="stringliteral">&#39;PrintArea&#39;</span>])) {</div>
<div class="line"><a name="l09936"></a><span class="lineno"> 9936</span>&#160;            $out .= <span class="stringliteral">&#39; /PrintArea /&#39;</span>.$vp[<span class="stringliteral">&#39;PrintArea&#39;</span>];</div>
<div class="line"><a name="l09937"></a><span class="lineno"> 9937</span>&#160;        }</div>
<div class="line"><a name="l09938"></a><span class="lineno"> 9938</span>&#160;        <span class="keywordflow">if</span> (isset($vp[<span class="stringliteral">&#39;PrintClip&#39;</span>])) {</div>
<div class="line"><a name="l09939"></a><span class="lineno"> 9939</span>&#160;            $out .= <span class="stringliteral">&#39; /PrintClip /&#39;</span>.$vp[<span class="stringliteral">&#39;PrintClip&#39;</span>];</div>
<div class="line"><a name="l09940"></a><span class="lineno"> 9940</span>&#160;        }</div>
<div class="line"><a name="l09941"></a><span class="lineno"> 9941</span>&#160;        <span class="keywordflow">if</span> (isset($vp[<span class="stringliteral">&#39;PrintScaling&#39;</span>])) {</div>
<div class="line"><a name="l09942"></a><span class="lineno"> 9942</span>&#160;            $out .= <span class="stringliteral">&#39; /PrintScaling /&#39;</span>.$vp[<span class="stringliteral">&#39;PrintScaling&#39;</span>];</div>
<div class="line"><a name="l09943"></a><span class="lineno"> 9943</span>&#160;        }</div>
<div class="line"><a name="l09944"></a><span class="lineno"> 9944</span>&#160;        <span class="keywordflow">if</span> (isset($vp[<span class="stringliteral">&#39;Duplex&#39;</span>]) AND (!TCPDF_STATIC::empty_string($vp[<span class="stringliteral">&#39;Duplex&#39;</span>]))) {</div>
<div class="line"><a name="l09945"></a><span class="lineno"> 9945</span>&#160;            $out .= <span class="stringliteral">&#39; /Duplex /&#39;</span>.$vp[<span class="stringliteral">&#39;Duplex&#39;</span>];</div>
<div class="line"><a name="l09946"></a><span class="lineno"> 9946</span>&#160;        }</div>
<div class="line"><a name="l09947"></a><span class="lineno"> 9947</span>&#160;        <span class="keywordflow">if</span> (isset($vp[<span class="stringliteral">&#39;PickTrayByPDFSize&#39;</span>])) {</div>
<div class="line"><a name="l09948"></a><span class="lineno"> 9948</span>&#160;            <span class="keywordflow">if</span> ($vp[<span class="stringliteral">&#39;PickTrayByPDFSize&#39;</span>]) {</div>
<div class="line"><a name="l09949"></a><span class="lineno"> 9949</span>&#160;                $out .= <span class="stringliteral">&#39; /PickTrayByPDFSize true&#39;</span>;</div>
<div class="line"><a name="l09950"></a><span class="lineno"> 9950</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l09951"></a><span class="lineno"> 9951</span>&#160;                $out .= <span class="stringliteral">&#39; /PickTrayByPDFSize false&#39;</span>;</div>
<div class="line"><a name="l09952"></a><span class="lineno"> 9952</span>&#160;            }</div>
<div class="line"><a name="l09953"></a><span class="lineno"> 9953</span>&#160;        }</div>
<div class="line"><a name="l09954"></a><span class="lineno"> 9954</span>&#160;        <span class="keywordflow">if</span> (isset($vp[<span class="stringliteral">&#39;PrintPageRange&#39;</span>])) {</div>
<div class="line"><a name="l09955"></a><span class="lineno"> 9955</span>&#160;            $PrintPageRangeNum = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l09956"></a><span class="lineno"> 9956</span>&#160;            <span class="keywordflow">foreach</span> ($vp[<span class="stringliteral">&#39;PrintPageRange&#39;</span>] as <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a> =&gt; $v) {</div>
<div class="line"><a name="l09957"></a><span class="lineno"> 9957</span>&#160;                $PrintPageRangeNum .= <span class="charliteral">&#39; &#39;</span>.($v - 1).<span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l09958"></a><span class="lineno"> 9958</span>&#160;            }</div>
<div class="line"><a name="l09959"></a><span class="lineno"> 9959</span>&#160;            $out .= <span class="stringliteral">&#39; /PrintPageRange [&#39;</span>.substr($PrintPageRangeNum,1).<span class="charliteral">&#39;]&#39;</span>;</div>
<div class="line"><a name="l09960"></a><span class="lineno"> 9960</span>&#160;        }</div>
<div class="line"><a name="l09961"></a><span class="lineno"> 9961</span>&#160;        <span class="keywordflow">if</span> (isset($vp[<span class="stringliteral">&#39;NumCopies&#39;</span>])) {</div>
<div class="line"><a name="l09962"></a><span class="lineno"> 9962</span>&#160;            $out .= <span class="stringliteral">&#39; /NumCopies &#39;</span>.intval($vp[<span class="stringliteral">&#39;NumCopies&#39;</span>]);</div>
<div class="line"><a name="l09963"></a><span class="lineno"> 9963</span>&#160;        }</div>
<div class="line"><a name="l09964"></a><span class="lineno"> 9964</span>&#160;        $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l09965"></a><span class="lineno"> 9965</span>&#160;        <span class="keywordflow">return</span> $out;</div>
<div class="line"><a name="l09966"></a><span class="lineno"> 9966</span>&#160;    }</div>
<div class="line"><a name="l09967"></a><span class="lineno"> 9967</span>&#160;</div>
<div class="line"><a name="l09972"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a9e27c6426fd6cce5613f9ecd2ceecee4"> 9972</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a9e27c6426fd6cce5613f9ecd2ceecee4">_putheader</a>() {</div>
<div class="line"><a name="l09973"></a><span class="lineno"> 9973</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(<span class="stringliteral">&#39;%PDF-&#39;</span>.$this-&gt;PDFVersion);</div>
<div class="line"><a name="l09974"></a><span class="lineno"> 9974</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(<span class="charliteral">&#39;%&#39;</span>.chr(0xe2).chr(0xe3).chr(0xcf).chr(0xd3));</div>
<div class="line"><a name="l09975"></a><span class="lineno"> 9975</span>&#160;    }</div>
<div class="line"><a name="l09976"></a><span class="lineno"> 9976</span>&#160;</div>
<div class="line"><a name="l09981"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a55c3dfafc6dd5b278d0bc7298e829d77"> 9981</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a55c3dfafc6dd5b278d0bc7298e829d77">_enddoc</a>() {</div>
<div class="line"><a name="l09982"></a><span class="lineno"> 9982</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;CurrentFont[<span class="stringliteral">&#39;fontkey&#39;</span>]) AND isset($this-&gt;CurrentFont[<span class="stringliteral">&#39;subsetchars&#39;</span>])) {</div>
<div class="line"><a name="l09983"></a><span class="lineno"> 9983</span>&#160;            <span class="comment">// save subset chars of the previous font</span></div>
<div class="line"><a name="l09984"></a><span class="lineno"> 9984</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac6009bf1f27a31ee208d9687cb4b91eb">setFontSubBuffer</a>($this-&gt;CurrentFont[<span class="stringliteral">&#39;fontkey&#39;</span>], <span class="stringliteral">&#39;subsetchars&#39;</span>, $this-&gt;CurrentFont[<span class="stringliteral">&#39;subsetchars&#39;</span>]);</div>
<div class="line"><a name="l09985"></a><span class="lineno"> 9985</span>&#160;        }</div>
<div class="line"><a name="l09986"></a><span class="lineno"> 9986</span>&#160;        $this-&gt;state = 1;</div>
<div class="line"><a name="l09987"></a><span class="lineno"> 9987</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a9e27c6426fd6cce5613f9ecd2ceecee4">_putheader</a>();</div>
<div class="line"><a name="l09988"></a><span class="lineno"> 9988</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a65bfa0bffc92dd5c359c114b837c81c0">_putpages</a>();</div>
<div class="line"><a name="l09989"></a><span class="lineno"> 9989</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a3f31f18974b7e7626d8fc99dbbe51d90">_putresources</a>();</div>
<div class="line"><a name="l09990"></a><span class="lineno"> 9990</span>&#160;        <span class="comment">// empty signature fields</span></div>
<div class="line"><a name="l09991"></a><span class="lineno"> 9991</span>&#160;        <span class="keywordflow">if</span> (!empty($this-&gt;empty_signature_appearance)) {</div>
<div class="line"><a name="l09992"></a><span class="lineno"> 9992</span>&#160;            <span class="keywordflow">foreach</span> ($this-&gt;empty_signature_appearance as $key =&gt; $esa) {</div>
<div class="line"><a name="l09993"></a><span class="lineno"> 9993</span>&#160;                <span class="comment">// widget annotation for empty signature</span></div>
<div class="line"><a name="l09994"></a><span class="lineno"> 9994</span>&#160;                $out = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1ef3c591556f7668c8a62b81e98da8a1">_getobj</a>($esa[<span class="stringliteral">&#39;objid&#39;</span>]).<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l09995"></a><span class="lineno"> 9995</span>&#160;                $out .= <span class="stringliteral">&#39;&lt;&lt; /Type /Annot&#39;</span>;</div>
<div class="line"><a name="l09996"></a><span class="lineno"> 9996</span>&#160;                $out .= <span class="stringliteral">&#39; /Subtype /Widget&#39;</span>;</div>
<div class="line"><a name="l09997"></a><span class="lineno"> 9997</span>&#160;                $out .= <span class="stringliteral">&#39; /Rect [&#39;</span>.$esa[<span class="stringliteral">&#39;rect&#39;</span>].<span class="charliteral">&#39;]&#39;</span>;</div>
<div class="line"><a name="l09998"></a><span class="lineno"> 9998</span>&#160;                $out .= <span class="stringliteral">&#39; /P &#39;</span>.$this-&gt;page_obj_id[($esa[<span class="stringliteral">&#39;page&#39;</span>])].<span class="stringliteral">&#39; 0 R&#39;</span>; <span class="comment">// link to signature appearance page</span></div>
<div class="line"><a name="l09999"></a><span class="lineno"> 9999</span>&#160;                $out .= <span class="stringliteral">&#39; /F 4&#39;</span>;</div>
<div class="line"><a name="l10000"></a><span class="lineno">10000</span>&#160;                $out .= <span class="stringliteral">&#39; /FT /Sig&#39;</span>;</div>
<div class="line"><a name="l10001"></a><span class="lineno">10001</span>&#160;                $signame = $esa[<span class="stringliteral">&#39;name&#39;</span>].sprintf(<span class="stringliteral">&#39; [%03d]&#39;</span>, ($key + 1));</div>
<div class="line"><a name="l10002"></a><span class="lineno">10002</span>&#160;                $out .= <span class="stringliteral">&#39; /T &#39;</span>.$this-&gt;_textstring($signame, $esa[<span class="stringliteral">&#39;objid&#39;</span>]);</div>
<div class="line"><a name="l10003"></a><span class="lineno">10003</span>&#160;                $out .= <span class="stringliteral">&#39; /Ff 0&#39;</span>;</div>
<div class="line"><a name="l10004"></a><span class="lineno">10004</span>&#160;                $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l10005"></a><span class="lineno">10005</span>&#160;                $out .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l10006"></a><span class="lineno">10006</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($out);</div>
<div class="line"><a name="l10007"></a><span class="lineno">10007</span>&#160;            }</div>
<div class="line"><a name="l10008"></a><span class="lineno">10008</span>&#160;        }</div>
<div class="line"><a name="l10009"></a><span class="lineno">10009</span>&#160;        <span class="comment">// Signature</span></div>
<div class="line"><a name="l10010"></a><span class="lineno">10010</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;sign AND isset($this-&gt;signature_data[<span class="stringliteral">&#39;cert_type&#39;</span>])) {</div>
<div class="line"><a name="l10011"></a><span class="lineno">10011</span>&#160;            <span class="comment">// widget annotation for signature</span></div>
<div class="line"><a name="l10012"></a><span class="lineno">10012</span>&#160;            $out = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1ef3c591556f7668c8a62b81e98da8a1">_getobj</a>($this-&gt;sig_obj_id).<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l10013"></a><span class="lineno">10013</span>&#160;            $out .= <span class="stringliteral">&#39;&lt;&lt; /Type /Annot&#39;</span>;</div>
<div class="line"><a name="l10014"></a><span class="lineno">10014</span>&#160;            $out .= <span class="stringliteral">&#39; /Subtype /Widget&#39;</span>;</div>
<div class="line"><a name="l10015"></a><span class="lineno">10015</span>&#160;            $out .= <span class="stringliteral">&#39; /Rect [&#39;</span>.$this-&gt;signature_appearance[<span class="stringliteral">&#39;rect&#39;</span>].<span class="charliteral">&#39;]&#39;</span>;</div>
<div class="line"><a name="l10016"></a><span class="lineno">10016</span>&#160;            $out .= <span class="stringliteral">&#39; /P &#39;</span>.$this-&gt;page_obj_id[($this-&gt;signature_appearance[<span class="stringliteral">&#39;page&#39;</span>])].<span class="stringliteral">&#39; 0 R&#39;</span>; <span class="comment">// link to signature appearance page</span></div>
<div class="line"><a name="l10017"></a><span class="lineno">10017</span>&#160;            $out .= <span class="stringliteral">&#39; /F 4&#39;</span>;</div>
<div class="line"><a name="l10018"></a><span class="lineno">10018</span>&#160;            $out .= <span class="stringliteral">&#39; /FT /Sig&#39;</span>;</div>
<div class="line"><a name="l10019"></a><span class="lineno">10019</span>&#160;            $out .= <span class="stringliteral">&#39; /T &#39;</span>.$this-&gt;_textstring($this-&gt;signature_appearance[<span class="stringliteral">&#39;name&#39;</span>], $this-&gt;sig_obj_id);</div>
<div class="line"><a name="l10020"></a><span class="lineno">10020</span>&#160;            $out .= <span class="stringliteral">&#39; /Ff 0&#39;</span>;</div>
<div class="line"><a name="l10021"></a><span class="lineno">10021</span>&#160;            $out .= <span class="stringliteral">&#39; /V &#39;</span>.($this-&gt;sig_obj_id + 1).<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l10022"></a><span class="lineno">10022</span>&#160;            $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l10023"></a><span class="lineno">10023</span>&#160;            $out .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l10024"></a><span class="lineno">10024</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($out);</div>
<div class="line"><a name="l10025"></a><span class="lineno">10025</span>&#160;            <span class="comment">// signature</span></div>
<div class="line"><a name="l10026"></a><span class="lineno">10026</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a0ade674cd5fe2d8901c056e689b6ab52">_putsignature</a>();</div>
<div class="line"><a name="l10027"></a><span class="lineno">10027</span>&#160;        }</div>
<div class="line"><a name="l10028"></a><span class="lineno">10028</span>&#160;        <span class="comment">// Info</span></div>
<div class="line"><a name="l10029"></a><span class="lineno">10029</span>&#160;        $objid_info = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a7381d7ff2d161c30e0ee5156c956c638">_putinfo</a>();</div>
<div class="line"><a name="l10030"></a><span class="lineno">10030</span>&#160;        <span class="comment">// Catalog</span></div>
<div class="line"><a name="l10031"></a><span class="lineno">10031</span>&#160;        $objid_catalog = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a795063487ebbe283e4b5e74f66ee6e23">_putcatalog</a>();</div>
<div class="line"><a name="l10032"></a><span class="lineno">10032</span>&#160;        <span class="comment">// Cross-ref</span></div>
<div class="line"><a name="l10033"></a><span class="lineno">10033</span>&#160;        $o = <a class="code" href="../../d4/d40/classTCPDF.html#ab2369921b0e2075fb797dc03f701f205">$this-&gt;bufferlen</a>;</div>
<div class="line"><a name="l10034"></a><span class="lineno">10034</span>&#160;        <span class="comment">// XREF section</span></div>
<div class="line"><a name="l10035"></a><span class="lineno">10035</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(<span class="stringliteral">&#39;xref&#39;</span>);</div>
<div class="line"><a name="l10036"></a><span class="lineno">10036</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(<span class="stringliteral">&#39;0 &#39;</span>.($this-&gt;n + 1));</div>
<div class="line"><a name="l10037"></a><span class="lineno">10037</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(<span class="stringliteral">&#39;0000000000 65535 f &#39;</span>);</div>
<div class="line"><a name="l10038"></a><span class="lineno">10038</span>&#160;        $freegen = ($this-&gt;n + 2);</div>
<div class="line"><a name="l10039"></a><span class="lineno">10039</span>&#160;        <span class="keywordflow">for</span> ($i=1; $i &lt;= <a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$this-&gt;n</a>; ++$i) {</div>
<div class="line"><a name="l10040"></a><span class="lineno">10040</span>&#160;            <span class="keywordflow">if</span> (!isset($this-&gt;offsets[$i]) AND ($i &gt; 1)) {</div>
<div class="line"><a name="l10041"></a><span class="lineno">10041</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(sprintf(<span class="stringliteral">&#39;0000000000 %05d f &#39;</span>, $freegen));</div>
<div class="line"><a name="l10042"></a><span class="lineno">10042</span>&#160;                ++$freegen;</div>
<div class="line"><a name="l10043"></a><span class="lineno">10043</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l10044"></a><span class="lineno">10044</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(sprintf(<span class="stringliteral">&#39;%010d 00000 n &#39;</span>, $this-&gt;offsets[$i]));</div>
<div class="line"><a name="l10045"></a><span class="lineno">10045</span>&#160;            }</div>
<div class="line"><a name="l10046"></a><span class="lineno">10046</span>&#160;        }</div>
<div class="line"><a name="l10047"></a><span class="lineno">10047</span>&#160;        <span class="comment">// TRAILER</span></div>
<div class="line"><a name="l10048"></a><span class="lineno">10048</span>&#160;        $out = <span class="stringliteral">&#39;trailer&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l10049"></a><span class="lineno">10049</span>&#160;        $out .= <span class="stringliteral">&#39;&lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l10050"></a><span class="lineno">10050</span>&#160;        $out .= <span class="stringliteral">&#39; /Size &#39;</span>.($this-&gt;n + 1);</div>
<div class="line"><a name="l10051"></a><span class="lineno">10051</span>&#160;        $out .= <span class="stringliteral">&#39; /Root &#39;</span>.$objid_catalog.<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l10052"></a><span class="lineno">10052</span>&#160;        $out .= <span class="stringliteral">&#39; /Info &#39;</span>.$objid_info.<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l10053"></a><span class="lineno">10053</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;encrypted) {</div>
<div class="line"><a name="l10054"></a><span class="lineno">10054</span>&#160;            $out .= <span class="stringliteral">&#39; /Encrypt &#39;</span>.$this-&gt;encryptdata[<span class="stringliteral">&#39;objid&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l10055"></a><span class="lineno">10055</span>&#160;        }</div>
<div class="line"><a name="l10056"></a><span class="lineno">10056</span>&#160;        $out .= <span class="stringliteral">&#39; /ID [ &lt;&#39;</span>.$this-&gt;file_id.<span class="stringliteral">&#39;&gt; &lt;&#39;</span>.$this-&gt;file_id.<span class="stringliteral">&#39;&gt; ]&#39;</span>;</div>
<div class="line"><a name="l10057"></a><span class="lineno">10057</span>&#160;        $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l10058"></a><span class="lineno">10058</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($out);</div>
<div class="line"><a name="l10059"></a><span class="lineno">10059</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(<span class="stringliteral">&#39;startxref&#39;</span>);</div>
<div class="line"><a name="l10060"></a><span class="lineno">10060</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($o);</div>
<div class="line"><a name="l10061"></a><span class="lineno">10061</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(<span class="stringliteral">&#39;%%EOF&#39;</span>);</div>
<div class="line"><a name="l10062"></a><span class="lineno">10062</span>&#160;        $this-&gt;state = 3; <span class="comment">// end-of-doc</span></div>
<div class="line"><a name="l10063"></a><span class="lineno">10063</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;diskcache) {</div>
<div class="line"><a name="l10064"></a><span class="lineno">10064</span>&#160;            <span class="comment">// remove temporary files used for images</span></div>
<div class="line"><a name="l10065"></a><span class="lineno">10065</span>&#160;            <span class="keywordflow">foreach</span> ($this-&gt;imagekeys as $key) {</div>
<div class="line"><a name="l10066"></a><span class="lineno">10066</span>&#160;                <span class="comment">// remove temporary files</span></div>
<div class="line"><a name="l10067"></a><span class="lineno">10067</span>&#160;                unlink($this-&gt;images[$key]);</div>
<div class="line"><a name="l10068"></a><span class="lineno">10068</span>&#160;            }</div>
<div class="line"><a name="l10069"></a><span class="lineno">10069</span>&#160;            <span class="keywordflow">foreach</span> ($this-&gt;fontkeys as $key) {</div>
<div class="line"><a name="l10070"></a><span class="lineno">10070</span>&#160;                <span class="comment">// remove temporary files</span></div>
<div class="line"><a name="l10071"></a><span class="lineno">10071</span>&#160;                unlink($this-&gt;fonts[$key]);</div>
<div class="line"><a name="l10072"></a><span class="lineno">10072</span>&#160;            }</div>
<div class="line"><a name="l10073"></a><span class="lineno">10073</span>&#160;        }</div>
<div class="line"><a name="l10074"></a><span class="lineno">10074</span>&#160;    }</div>
<div class="line"><a name="l10075"></a><span class="lineno">10075</span>&#160;</div>
<div class="line"><a name="l10083"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aeba2b911ed732e58cb99c0b9b29ed05f">10083</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#aeba2b911ed732e58cb99c0b9b29ed05f">_beginpage</a>($orientation=<span class="stringliteral">&#39;&#39;</span>, $format=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l10084"></a><span class="lineno">10084</span>&#160;        ++<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>;</div>
<div class="line"><a name="l10085"></a><span class="lineno">10085</span>&#160;        $this-&gt;pageobjects[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>] = array();</div>
<div class="line"><a name="l10086"></a><span class="lineno">10086</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a2b85f6395de14dd40cab8839b3ce25a8">setPageBuffer</a>($this-&gt;page, <span class="stringliteral">&#39;&#39;</span>);</div>
<div class="line"><a name="l10087"></a><span class="lineno">10087</span>&#160;        <span class="comment">// initialize array for graphics tranformation positions inside a page buffer</span></div>
<div class="line"><a name="l10088"></a><span class="lineno">10088</span>&#160;        $this-&gt;transfmrk[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>] = array();</div>
<div class="line"><a name="l10089"></a><span class="lineno">10089</span>&#160;        $this-&gt;state = 2;</div>
<div class="line"><a name="l10090"></a><span class="lineno">10090</span>&#160;        <span class="keywordflow">if</span> (TCPDF_STATIC::empty_string($orientation)) {</div>
<div class="line"><a name="l10091"></a><span class="lineno">10091</span>&#160;            <span class="keywordflow">if</span> (isset($this-&gt;CurOrientation)) {</div>
<div class="line"><a name="l10092"></a><span class="lineno">10092</span>&#160;                $orientation = <a class="code" href="../../d4/d40/classTCPDF.html#abdf07c1c5b4fb70b3ed325031d187257">$this-&gt;CurOrientation</a>;</div>
<div class="line"><a name="l10093"></a><span class="lineno">10093</span>&#160;            } elseif ($this-&gt;fwPt &gt; $this-&gt;fhPt) {</div>
<div class="line"><a name="l10094"></a><span class="lineno">10094</span>&#160;                <span class="comment">// landscape</span></div>
<div class="line"><a name="l10095"></a><span class="lineno">10095</span>&#160;                $orientation = <span class="charliteral">&#39;L&#39;</span>;</div>
<div class="line"><a name="l10096"></a><span class="lineno">10096</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l10097"></a><span class="lineno">10097</span>&#160;                <span class="comment">// portrait</span></div>
<div class="line"><a name="l10098"></a><span class="lineno">10098</span>&#160;                $orientation = <span class="charliteral">&#39;P&#39;</span>;</div>
<div class="line"><a name="l10099"></a><span class="lineno">10099</span>&#160;            }</div>
<div class="line"><a name="l10100"></a><span class="lineno">10100</span>&#160;        }</div>
<div class="line"><a name="l10101"></a><span class="lineno">10101</span>&#160;        <span class="keywordflow">if</span> (TCPDF_STATIC::empty_string($format)) {</div>
<div class="line"><a name="l10102"></a><span class="lineno">10102</span>&#160;            $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>] = $this-&gt;pagedim[($this-&gt;page - 1)];</div>
<div class="line"><a name="l10103"></a><span class="lineno">10103</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ad6a3575405b61049ff85ce019df5451d">setPageOrientation</a>($orientation);</div>
<div class="line"><a name="l10104"></a><span class="lineno">10104</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l10105"></a><span class="lineno">10105</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa389d4419c77510dc3998f0af78d8a00">setPageFormat</a>($format, $orientation);</div>
<div class="line"><a name="l10106"></a><span class="lineno">10106</span>&#160;        }</div>
<div class="line"><a name="l10107"></a><span class="lineno">10107</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l10108"></a><span class="lineno">10108</span>&#160;            $this-&gt;x = $this-&gt;w - <a class="code" href="../../d4/d40/classTCPDF.html#a44fb75b85bea40ced25fdea9d89dc8e9">$this-&gt;rMargin</a>;</div>
<div class="line"><a name="l10109"></a><span class="lineno">10109</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l10110"></a><span class="lineno">10110</span>&#160;            $this-&gt;x = <a class="code" href="../../d4/d40/classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da">$this-&gt;lMargin</a>;</div>
<div class="line"><a name="l10111"></a><span class="lineno">10111</span>&#160;        }</div>
<div class="line"><a name="l10112"></a><span class="lineno">10112</span>&#160;        $this-&gt;y = <a class="code" href="../../d4/d40/classTCPDF.html#ace8343242b398fd16a4acb1926b6efa7">$this-&gt;tMargin</a>;</div>
<div class="line"><a name="l10113"></a><span class="lineno">10113</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;newpagegroup[$this-&gt;page])) {</div>
<div class="line"><a name="l10114"></a><span class="lineno">10114</span>&#160;            <span class="comment">// start a new group</span></div>
<div class="line"><a name="l10115"></a><span class="lineno">10115</span>&#160;            $this-&gt;currpagegroup = $this-&gt;newpagegroup[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>];</div>
<div class="line"><a name="l10116"></a><span class="lineno">10116</span>&#160;            $this-&gt;pagegroups[<a class="code" href="../../d4/d40/classTCPDF.html#ac78410b152f371b7239405ba246cee92">$this-&gt;currpagegroup</a>] = 1;</div>
<div class="line"><a name="l10117"></a><span class="lineno">10117</span>&#160;        } elseif (isset($this-&gt;currpagegroup) AND ($this-&gt;currpagegroup &gt; 0)) {</div>
<div class="line"><a name="l10118"></a><span class="lineno">10118</span>&#160;            ++$this-&gt;pagegroups[<a class="code" href="../../d4/d40/classTCPDF.html#ac78410b152f371b7239405ba246cee92">$this-&gt;currpagegroup</a>];</div>
<div class="line"><a name="l10119"></a><span class="lineno">10119</span>&#160;        }</div>
<div class="line"><a name="l10120"></a><span class="lineno">10120</span>&#160;    }</div>
<div class="line"><a name="l10121"></a><span class="lineno">10121</span>&#160;</div>
<div class="line"><a name="l10126"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#af037a681d72f4eeaecd641680257a16f">10126</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#af037a681d72f4eeaecd641680257a16f">_endpage</a>() {</div>
<div class="line"><a name="l10127"></a><span class="lineno">10127</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ab0f6ca38653854c80ef47a1909685030">setVisibility</a>(<span class="stringliteral">&#39;all&#39;</span>);</div>
<div class="line"><a name="l10128"></a><span class="lineno">10128</span>&#160;        $this-&gt;state = 1;</div>
<div class="line"><a name="l10129"></a><span class="lineno">10129</span>&#160;    }</div>
<div class="line"><a name="l10130"></a><span class="lineno">10130</span>&#160;</div>
<div class="line"><a name="l10136"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d">10136</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d">_newobj</a>() {</div>
<div class="line"><a name="l10137"></a><span class="lineno">10137</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1ef3c591556f7668c8a62b81e98da8a1">_getobj</a>());</div>
<div class="line"><a name="l10138"></a><span class="lineno">10138</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$this-&gt;n</a>;</div>
<div class="line"><a name="l10139"></a><span class="lineno">10139</span>&#160;    }</div>
<div class="line"><a name="l10140"></a><span class="lineno">10140</span>&#160;</div>
<div class="line"><a name="l10148"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a1ef3c591556f7668c8a62b81e98da8a1">10148</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a1ef3c591556f7668c8a62b81e98da8a1">_getobj</a>($objid=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l10149"></a><span class="lineno">10149</span>&#160;        <span class="keywordflow">if</span> ($objid === <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l10150"></a><span class="lineno">10150</span>&#160;            ++<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$this-&gt;n</a>;</div>
<div class="line"><a name="l10151"></a><span class="lineno">10151</span>&#160;            $objid = <a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$this-&gt;n</a>;</div>
<div class="line"><a name="l10152"></a><span class="lineno">10152</span>&#160;        }</div>
<div class="line"><a name="l10153"></a><span class="lineno">10153</span>&#160;        $this-&gt;offsets[$objid] = <a class="code" href="../../d4/d40/classTCPDF.html#ab2369921b0e2075fb797dc03f701f205">$this-&gt;bufferlen</a>;</div>
<div class="line"><a name="l10154"></a><span class="lineno">10154</span>&#160;        $this-&gt;pageobjects[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][] = $objid;</div>
<div class="line"><a name="l10155"></a><span class="lineno">10155</span>&#160;        <span class="keywordflow">return</span> $objid.<span class="stringliteral">&#39; 0 obj&#39;</span>;</div>
<div class="line"><a name="l10156"></a><span class="lineno">10156</span>&#160;    }</div>
<div class="line"><a name="l10157"></a><span class="lineno">10157</span>&#160;</div>
<div class="line"><a name="l10165"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a877cd98eb569f30730b86a09b61825aa">10165</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a877cd98eb569f30730b86a09b61825aa">_dounderline</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, $txt) {</div>
<div class="line"><a name="l10166"></a><span class="lineno">10166</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8075c1f04b6fbddc957cff786c4b16d9">GetStringWidth</a>($txt);</div>
<div class="line"><a name="l10167"></a><span class="lineno">10167</span>&#160;        <span class="keywordflow">return</span> $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a42fd9a6c1fdd354da7e199c730f1c0f7">_dounderlinew</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>);</div>
<div class="line"><a name="l10168"></a><span class="lineno">10168</span>&#160;    }</div>
<div class="line"><a name="l10169"></a><span class="lineno">10169</span>&#160;</div>
<div class="line"><a name="l10178"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a42fd9a6c1fdd354da7e199c730f1c0f7">10178</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a42fd9a6c1fdd354da7e199c730f1c0f7">_dounderlinew</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>) {</div>
<div class="line"><a name="l10179"></a><span class="lineno">10179</span>&#160;        $linew = - $this-&gt;CurrentFont[<span class="stringliteral">&#39;ut&#39;</span>] / 1000 * <a class="code" href="../../d4/d40/classTCPDF.html#a9a787786c9f1a04f54f1dec622869d4d">$this-&gt;FontSizePt</a>;</div>
<div class="line"><a name="l10180"></a><span class="lineno">10180</span>&#160;        <span class="keywordflow">return</span> sprintf(<span class="stringliteral">&#39;%F %F %F %F re f&#39;</span>, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> * $this-&gt;k, ((($this-&gt;h - <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>) * $this-&gt;k) + $linew), <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> * $this-&gt;k, $linew);</div>
<div class="line"><a name="l10181"></a><span class="lineno">10181</span>&#160;    }</div>
<div class="line"><a name="l10182"></a><span class="lineno">10182</span>&#160;</div>
<div class="line"><a name="l10190"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a8a0828e6deefbe232d94e55cdb816fa1">10190</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a8a0828e6deefbe232d94e55cdb816fa1">_dolinethrough</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, $txt) {</div>
<div class="line"><a name="l10191"></a><span class="lineno">10191</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8075c1f04b6fbddc957cff786c4b16d9">GetStringWidth</a>($txt);</div>
<div class="line"><a name="l10192"></a><span class="lineno">10192</span>&#160;        <span class="keywordflow">return</span> $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af2999e4e50aa693faf0d7c0009dfa43c">_dolinethroughw</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>);</div>
<div class="line"><a name="l10193"></a><span class="lineno">10193</span>&#160;    }</div>
<div class="line"><a name="l10194"></a><span class="lineno">10194</span>&#160;</div>
<div class="line"><a name="l10203"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#af2999e4e50aa693faf0d7c0009dfa43c">10203</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#af2999e4e50aa693faf0d7c0009dfa43c">_dolinethroughw</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>) {</div>
<div class="line"><a name="l10204"></a><span class="lineno">10204</span>&#160;        $linew = - $this-&gt;CurrentFont[<span class="stringliteral">&#39;ut&#39;</span>] / 1000 * <a class="code" href="../../d4/d40/classTCPDF.html#a9a787786c9f1a04f54f1dec622869d4d">$this-&gt;FontSizePt</a>;</div>
<div class="line"><a name="l10205"></a><span class="lineno">10205</span>&#160;        <span class="keywordflow">return</span> sprintf(<span class="stringliteral">&#39;%F %F %F %F re f&#39;</span>, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> * $this-&gt;k, ((($this-&gt;h - <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>) * $this-&gt;k) + $linew + ($this-&gt;FontSizePt / 3)), <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> * $this-&gt;k, $linew);</div>
<div class="line"><a name="l10206"></a><span class="lineno">10206</span>&#160;    }</div>
<div class="line"><a name="l10207"></a><span class="lineno">10207</span>&#160;</div>
<div class="line"><a name="l10216"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a803fd6fac1ef9574bdd67dac9583edf7">10216</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a803fd6fac1ef9574bdd67dac9583edf7">_dooverline</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, $txt) {</div>
<div class="line"><a name="l10217"></a><span class="lineno">10217</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8075c1f04b6fbddc957cff786c4b16d9">GetStringWidth</a>($txt);</div>
<div class="line"><a name="l10218"></a><span class="lineno">10218</span>&#160;        <span class="keywordflow">return</span> $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a161ff5500c93e6a3af01b87df1ee7877">_dooverlinew</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>);</div>
<div class="line"><a name="l10219"></a><span class="lineno">10219</span>&#160;    }</div>
<div class="line"><a name="l10220"></a><span class="lineno">10220</span>&#160;</div>
<div class="line"><a name="l10229"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a161ff5500c93e6a3af01b87df1ee7877">10229</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a161ff5500c93e6a3af01b87df1ee7877">_dooverlinew</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>) {</div>
<div class="line"><a name="l10230"></a><span class="lineno">10230</span>&#160;        $linew = - $this-&gt;CurrentFont[<span class="stringliteral">&#39;ut&#39;</span>] / 1000 * <a class="code" href="../../d4/d40/classTCPDF.html#a9a787786c9f1a04f54f1dec622869d4d">$this-&gt;FontSizePt</a>;</div>
<div class="line"><a name="l10231"></a><span class="lineno">10231</span>&#160;        <span class="keywordflow">return</span> sprintf(<span class="stringliteral">&#39;%F %F %F %F re f&#39;</span>, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> * $this-&gt;k, (($this-&gt;h - <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> + $this-&gt;FontAscent) * $this-&gt;k) - $linew, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> * $this-&gt;k, $linew);</div>
<div class="line"><a name="l10232"></a><span class="lineno">10232</span>&#160;</div>
<div class="line"><a name="l10233"></a><span class="lineno">10233</span>&#160;    }</div>
<div class="line"><a name="l10234"></a><span class="lineno">10234</span>&#160;</div>
<div class="line"><a name="l10242"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ad4357fbfe88ee671132009ca8bb199ef">10242</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ad4357fbfe88ee671132009ca8bb199ef">_datastring</a>($s, <a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>=0) {</div>
<div class="line"><a name="l10243"></a><span class="lineno">10243</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a> == 0) {</div>
<div class="line"><a name="l10244"></a><span class="lineno">10244</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a> = <a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$this-&gt;n</a>;</div>
<div class="line"><a name="l10245"></a><span class="lineno">10245</span>&#160;        }</div>
<div class="line"><a name="l10246"></a><span class="lineno">10246</span>&#160;        $s = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa152b05eedf7152d8163ab4f5083de1c">_encrypt_data</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>, $s);</div>
<div class="line"><a name="l10247"></a><span class="lineno">10247</span>&#160;        <span class="keywordflow">return</span> <span class="charliteral">&#39;(&#39;</span>. TCPDF_STATIC::_escape($s).<span class="charliteral">&#39;)&#39;</span>;</div>
<div class="line"><a name="l10248"></a><span class="lineno">10248</span>&#160;    }</div>
<div class="line"><a name="l10249"></a><span class="lineno">10249</span>&#160;</div>
<div class="line"><a name="l10256"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aa3332213fe963b311077498a19d05cbe">10256</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#aa3332213fe963b311077498a19d05cbe">setDocCreationTimestamp</a>($time) {</div>
<div class="line"><a name="l10257"></a><span class="lineno">10257</span>&#160;        <span class="keywordflow">if</span> (is_string($time)) {</div>
<div class="line"><a name="l10258"></a><span class="lineno">10258</span>&#160;            $time = TCPDF_STATIC::getTimestamp($time);</div>
<div class="line"><a name="l10259"></a><span class="lineno">10259</span>&#160;        }</div>
<div class="line"><a name="l10260"></a><span class="lineno">10260</span>&#160;        $this-&gt;doc_creation_timestamp = intval($time);</div>
<div class="line"><a name="l10261"></a><span class="lineno">10261</span>&#160;    }</div>
<div class="line"><a name="l10262"></a><span class="lineno">10262</span>&#160;</div>
<div class="line"><a name="l10269"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ad46aa89be17efef08753845fb01fa901">10269</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ad46aa89be17efef08753845fb01fa901">setDocModificationTimestamp</a>($time) {</div>
<div class="line"><a name="l10270"></a><span class="lineno">10270</span>&#160;        <span class="keywordflow">if</span> (is_string($time)) {</div>
<div class="line"><a name="l10271"></a><span class="lineno">10271</span>&#160;            $time = TCPDF_STATIC::getTimestamp($time);</div>
<div class="line"><a name="l10272"></a><span class="lineno">10272</span>&#160;        }</div>
<div class="line"><a name="l10273"></a><span class="lineno">10273</span>&#160;        $this-&gt;doc_modification_timestamp = intval($time);</div>
<div class="line"><a name="l10274"></a><span class="lineno">10274</span>&#160;    }</div>
<div class="line"><a name="l10275"></a><span class="lineno">10275</span>&#160;</div>
<div class="line"><a name="l10282"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ac93ed171cb920eca2d52c3afcedff82e">10282</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ac93ed171cb920eca2d52c3afcedff82e">getDocCreationTimestamp</a>() {</div>
<div class="line"><a name="l10283"></a><span class="lineno">10283</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#af37c03f21372a70598f00034b7e41c0a">$this-&gt;doc_creation_timestamp</a>;</div>
<div class="line"><a name="l10284"></a><span class="lineno">10284</span>&#160;    }</div>
<div class="line"><a name="l10285"></a><span class="lineno">10285</span>&#160;</div>
<div class="line"><a name="l10292"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a5df552585bd6e930184e5e6e5bae19cd">10292</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a5df552585bd6e930184e5e6e5bae19cd">getDocModificationTimestamp</a>() {</div>
<div class="line"><a name="l10293"></a><span class="lineno">10293</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#a04519421e767c221f2f3bfbe51574896">$this-&gt;doc_modification_timestamp</a>;</div>
<div class="line"><a name="l10294"></a><span class="lineno">10294</span>&#160;    }</div>
<div class="line"><a name="l10295"></a><span class="lineno">10295</span>&#160;</div>
<div class="line"><a name="l10304"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a7dc662e76aa078c76ef4f6c19afa7d98">10304</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a7dc662e76aa078c76ef4f6c19afa7d98">_datestring</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>=0, $timestamp=0) {</div>
<div class="line"><a name="l10305"></a><span class="lineno">10305</span>&#160;        <span class="keywordflow">if</span> ((empty($timestamp)) OR ($timestamp &lt; 0)) {</div>
<div class="line"><a name="l10306"></a><span class="lineno">10306</span>&#160;            $timestamp = <a class="code" href="../../d4/d40/classTCPDF.html#af37c03f21372a70598f00034b7e41c0a">$this-&gt;doc_creation_timestamp</a>;</div>
<div class="line"><a name="l10307"></a><span class="lineno">10307</span>&#160;        }</div>
<div class="line"><a name="l10308"></a><span class="lineno">10308</span>&#160;        <span class="keywordflow">return</span> $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ad4357fbfe88ee671132009ca8bb199ef">_datastring</a>(<span class="stringliteral">&#39;D:&#39;</span>.TCPDF_STATIC::getFormattedDate($timestamp), <a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>);</div>
<div class="line"><a name="l10309"></a><span class="lineno">10309</span>&#160;    }</div>
<div class="line"><a name="l10310"></a><span class="lineno">10310</span>&#160;</div>
<div class="line"><a name="l10318"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ac7082d1545bb2ee22c4713ab57879d81">10318</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ac7082d1545bb2ee22c4713ab57879d81">_textstring</a>($s, <a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>=0) {</div>
<div class="line"><a name="l10319"></a><span class="lineno">10319</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;isunicode) {</div>
<div class="line"><a name="l10320"></a><span class="lineno">10320</span>&#160;            <span class="comment">//Convert string to UTF-16BE</span></div>
<div class="line"><a name="l10321"></a><span class="lineno">10321</span>&#160;            $s = TCPDF_FONTS::UTF8ToUTF16BE($s, <span class="keyword">true</span>, $this-&gt;isunicode, $this-&gt;CurrentFont);</div>
<div class="line"><a name="l10322"></a><span class="lineno">10322</span>&#160;        }</div>
<div class="line"><a name="l10323"></a><span class="lineno">10323</span>&#160;        <span class="keywordflow">return</span> $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ad4357fbfe88ee671132009ca8bb199ef">_datastring</a>($s, <a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>);</div>
<div class="line"><a name="l10324"></a><span class="lineno">10324</span>&#160;    }</div>
<div class="line"><a name="l10325"></a><span class="lineno">10325</span>&#160;</div>
<div class="line"><a name="l10334"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ae19b61fda7662a88bda031589ae95e32">10334</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ae19b61fda7662a88bda031589ae95e32">_escapetext</a>($s) {</div>
<div class="line"><a name="l10335"></a><span class="lineno">10335</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;isunicode) {</div>
<div class="line"><a name="l10336"></a><span class="lineno">10336</span>&#160;            <span class="keywordflow">if</span> (($this-&gt;CurrentFont[<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;core&#39;</span>) OR ($this-&gt;CurrentFont[<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;TrueType&#39;</span>) OR ($this-&gt;CurrentFont[<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;Type1&#39;</span>)) {</div>
<div class="line"><a name="l10337"></a><span class="lineno">10337</span>&#160;                $s = TCPDF_FONTS::UTF8ToLatin1($s, $this-&gt;isunicode, $this-&gt;CurrentFont);</div>
<div class="line"><a name="l10338"></a><span class="lineno">10338</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l10339"></a><span class="lineno">10339</span>&#160;                <span class="comment">//Convert string to UTF-16BE and reverse RTL language</span></div>
<div class="line"><a name="l10340"></a><span class="lineno">10340</span>&#160;                $s = TCPDF_FONTS::utf8StrRev($s, <span class="keyword">false</span>, $this-&gt;tmprtl, $this-&gt;isunicode, $this-&gt;CurrentFont);</div>
<div class="line"><a name="l10341"></a><span class="lineno">10341</span>&#160;            }</div>
<div class="line"><a name="l10342"></a><span class="lineno">10342</span>&#160;        }</div>
<div class="line"><a name="l10343"></a><span class="lineno">10343</span>&#160;        <span class="keywordflow">return</span> TCPDF_STATIC::_escape($s);</div>
<div class="line"><a name="l10344"></a><span class="lineno">10344</span>&#160;    }</div>
<div class="line"><a name="l10345"></a><span class="lineno">10345</span>&#160;</div>
<div class="line"><a name="l10354"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a7c7c1beebd83fa777197a842f2ca73eb">10354</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a7c7c1beebd83fa777197a842f2ca73eb">_getrawstream</a>($s, <a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>=0) {</div>
<div class="line"><a name="l10355"></a><span class="lineno">10355</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a> &lt;= 0) {</div>
<div class="line"><a name="l10356"></a><span class="lineno">10356</span>&#160;            <span class="comment">// default to current object</span></div>
<div class="line"><a name="l10357"></a><span class="lineno">10357</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a> = <a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$this-&gt;n</a>;</div>
<div class="line"><a name="l10358"></a><span class="lineno">10358</span>&#160;        }</div>
<div class="line"><a name="l10359"></a><span class="lineno">10359</span>&#160;        <span class="keywordflow">return</span> $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa152b05eedf7152d8163ab4f5083de1c">_encrypt_data</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>, $s);</div>
<div class="line"><a name="l10360"></a><span class="lineno">10360</span>&#160;    }</div>
<div class="line"><a name="l10361"></a><span class="lineno">10361</span>&#160;</div>
<div class="line"><a name="l10369"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a3c441291e8b83dc4a15794ea92f44415">10369</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a3c441291e8b83dc4a15794ea92f44415">_getstream</a>($s, <a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>=0) {</div>
<div class="line"><a name="l10370"></a><span class="lineno">10370</span>&#160;        <span class="keywordflow">return</span> <span class="stringliteral">&#39;stream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.$this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a7c7c1beebd83fa777197a842f2ca73eb">_getrawstream</a>($s, <a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>).<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endstream&#39;</span>;</div>
<div class="line"><a name="l10371"></a><span class="lineno">10371</span>&#160;    }</div>
<div class="line"><a name="l10372"></a><span class="lineno">10372</span>&#160;</div>
<div class="line"><a name="l10380"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a54cc2d89767ef5425957a0c0a9b34269">10380</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a54cc2d89767ef5425957a0c0a9b34269">_putstream</a>($s, <a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>=0) {</div>
<div class="line"><a name="l10381"></a><span class="lineno">10381</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a3c441291e8b83dc4a15794ea92f44415">_getstream</a>($s, <a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>));</div>
<div class="line"><a name="l10382"></a><span class="lineno">10382</span>&#160;    }</div>
<div class="line"><a name="l10383"></a><span class="lineno">10383</span>&#160;</div>
<div class="line"><a name="l10389"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">10389</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($s) {</div>
<div class="line"><a name="l10390"></a><span class="lineno">10390</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;state == 2) {</div>
<div class="line"><a name="l10391"></a><span class="lineno">10391</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;inxobj) {</div>
<div class="line"><a name="l10392"></a><span class="lineno">10392</span>&#160;                <span class="comment">// we are inside an XObject template</span></div>
<div class="line"><a name="l10393"></a><span class="lineno">10393</span>&#160;                $this-&gt;xobjects[<a class="code" href="../../d4/d40/classTCPDF.html#abe4390b4e1939e10c9b61a986adfc117">$this-&gt;xobjid</a>][<span class="stringliteral">&#39;outdata&#39;</span>] .= $s.<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l10394"></a><span class="lineno">10394</span>&#160;            } elseif ((!$this-&gt;InFooter) AND isset($this-&gt;footerlen[$this-&gt;page]) AND ($this-&gt;footerlen[$this-&gt;page] &gt; 0)) {</div>
<div class="line"><a name="l10395"></a><span class="lineno">10395</span>&#160;                <span class="comment">// puts data before page footer</span></div>
<div class="line"><a name="l10396"></a><span class="lineno">10396</span>&#160;                $pagebuff = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d67b0a8681222f71fa9f9f6e65e0c56">getPageBuffer</a>($this-&gt;page);</div>
<div class="line"><a name="l10397"></a><span class="lineno">10397</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a> = substr($pagebuff, 0, -$this-&gt;footerlen[$this-&gt;page]);</div>
<div class="line"><a name="l10398"></a><span class="lineno">10398</span>&#160;                $footer = substr($pagebuff, -$this-&gt;footerlen[$this-&gt;page]);</div>
<div class="line"><a name="l10399"></a><span class="lineno">10399</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a2b85f6395de14dd40cab8839b3ce25a8">setPageBuffer</a>($this-&gt;page, <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>.$s.<span class="stringliteral">&quot;\n&quot;</span>.$footer);</div>
<div class="line"><a name="l10400"></a><span class="lineno">10400</span>&#160;                <span class="comment">// update footer position</span></div>
<div class="line"><a name="l10401"></a><span class="lineno">10401</span>&#160;                $this-&gt;footerpos[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>] += strlen($s.<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l10402"></a><span class="lineno">10402</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l10403"></a><span class="lineno">10403</span>&#160;                <span class="comment">// set page data</span></div>
<div class="line"><a name="l10404"></a><span class="lineno">10404</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a2b85f6395de14dd40cab8839b3ce25a8">setPageBuffer</a>($this-&gt;page, $s.<span class="stringliteral">&quot;\n&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l10405"></a><span class="lineno">10405</span>&#160;            }</div>
<div class="line"><a name="l10406"></a><span class="lineno">10406</span>&#160;        } elseif ($this-&gt;state &gt; 0) {</div>
<div class="line"><a name="l10407"></a><span class="lineno">10407</span>&#160;            <span class="comment">// set general data</span></div>
<div class="line"><a name="l10408"></a><span class="lineno">10408</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a7a19b2f2308c1f3a4ddb97447cb5ee90">setBuffer</a>($s.<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l10409"></a><span class="lineno">10409</span>&#160;        }</div>
<div class="line"><a name="l10410"></a><span class="lineno">10410</span>&#160;    }</div>
<div class="line"><a name="l10411"></a><span class="lineno">10411</span>&#160;</div>
<div class="line"><a name="l10418"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aee22655aad0ae32a3194298585da16a2">10418</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#aee22655aad0ae32a3194298585da16a2">setHeaderFont</a>($font) {</div>
<div class="line"><a name="l10419"></a><span class="lineno">10419</span>&#160;        $this-&gt;header_font = $font;</div>
<div class="line"><a name="l10420"></a><span class="lineno">10420</span>&#160;    }</div>
<div class="line"><a name="l10421"></a><span class="lineno">10421</span>&#160;</div>
<div class="line"><a name="l10428"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a2490e635d8ff11d41b6578bab46acba5">10428</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a2490e635d8ff11d41b6578bab46acba5">getHeaderFont</a>() {</div>
<div class="line"><a name="l10429"></a><span class="lineno">10429</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#aa29f2cb5b3679f1c6658e2a1e775bcb3">$this-&gt;header_font</a>;</div>
<div class="line"><a name="l10430"></a><span class="lineno">10430</span>&#160;    }</div>
<div class="line"><a name="l10431"></a><span class="lineno">10431</span>&#160;</div>
<div class="line"><a name="l10438"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#af1b0f1f3ec868528230e8b0293a23a4c">10438</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#af1b0f1f3ec868528230e8b0293a23a4c">setFooterFont</a>($font) {</div>
<div class="line"><a name="l10439"></a><span class="lineno">10439</span>&#160;        $this-&gt;footer_font = $font;</div>
<div class="line"><a name="l10440"></a><span class="lineno">10440</span>&#160;    }</div>
<div class="line"><a name="l10441"></a><span class="lineno">10441</span>&#160;</div>
<div class="line"><a name="l10448"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a3ff8e789876c7376f95a614c8e2a8a7d">10448</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a3ff8e789876c7376f95a614c8e2a8a7d">getFooterFont</a>() {</div>
<div class="line"><a name="l10449"></a><span class="lineno">10449</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#a63fc9b0fba1a33cc5d27588f3e512df8">$this-&gt;footer_font</a>;</div>
<div class="line"><a name="l10450"></a><span class="lineno">10450</span>&#160;    }</div>
<div class="line"><a name="l10451"></a><span class="lineno">10451</span>&#160;</div>
<div class="line"><a name="l10458"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a2a7cc18749cac51d0efca5d491d9217c">10458</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a2a7cc18749cac51d0efca5d491d9217c">setLanguageArray</a>($language) {</div>
<div class="line"><a name="l10459"></a><span class="lineno">10459</span>&#160;        $this-&gt;l = $language;</div>
<div class="line"><a name="l10460"></a><span class="lineno">10460</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;l[<span class="stringliteral">&#39;a_meta_dir&#39;</span>])) {</div>
<div class="line"><a name="l10461"></a><span class="lineno">10461</span>&#160;            $this-&gt;rtl = $this-&gt;l[<span class="stringliteral">&#39;a_meta_dir&#39;</span>]==<span class="stringliteral">&#39;rtl&#39;</span> ? <span class="keyword">true</span> : <span class="keyword">false</span>;</div>
<div class="line"><a name="l10462"></a><span class="lineno">10462</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l10463"></a><span class="lineno">10463</span>&#160;            $this-&gt;rtl = <span class="keyword">false</span>;</div>
<div class="line"><a name="l10464"></a><span class="lineno">10464</span>&#160;        }</div>
<div class="line"><a name="l10465"></a><span class="lineno">10465</span>&#160;    }</div>
<div class="line"><a name="l10466"></a><span class="lineno">10466</span>&#160;</div>
<div class="line"><a name="l10471"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a1cff8ee966955eb911a71e2535735683">10471</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a1cff8ee966955eb911a71e2535735683">getPDFData</a>() {</div>
<div class="line"><a name="l10472"></a><span class="lineno">10472</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;state &lt; 3) {</div>
<div class="line"><a name="l10473"></a><span class="lineno">10473</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a2ea842192062587293c25981098c820c">Close</a>();</div>
<div class="line"><a name="l10474"></a><span class="lineno">10474</span>&#160;        }</div>
<div class="line"><a name="l10475"></a><span class="lineno">10475</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#a61840390b5ae16c58b1b6bd6b060af46">$this-&gt;buffer</a>;</div>
<div class="line"><a name="l10476"></a><span class="lineno">10476</span>&#160;    }</div>
<div class="line"><a name="l10477"></a><span class="lineno">10477</span>&#160;</div>
<div class="line"><a name="l10490"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#af26dfbff2e1507f87a2fae64eebe08e1">10490</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#af26dfbff2e1507f87a2fae64eebe08e1">addHtmlLink</a>($url, $name, $fill=<span class="keyword">false</span>, $firstline=<span class="keyword">false</span>, $color=<span class="stringliteral">&#39;&#39;</span>, $style=-1, $firstblock=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l10491"></a><span class="lineno">10491</span>&#160;        <span class="keywordflow">if</span> (isset($url[1]) AND ($url[0] == <span class="charliteral">&#39;#&#39;</span>)) {</div>
<div class="line"><a name="l10492"></a><span class="lineno">10492</span>&#160;            <span class="comment">// convert url to internal link</span></div>
<div class="line"><a name="l10493"></a><span class="lineno">10493</span>&#160;            $lnkdata = explode(<span class="charliteral">&#39;,&#39;</span>, $url);</div>
<div class="line"><a name="l10494"></a><span class="lineno">10494</span>&#160;            <span class="keywordflow">if</span> (isset($lnkdata[0]) ) {</div>
<div class="line"><a name="l10495"></a><span class="lineno">10495</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a> = substr($lnkdata[0], 1);</div>
<div class="line"><a name="l10496"></a><span class="lineno">10496</span>&#160;                <span class="keywordflow">if</span> (isset($lnkdata[1]) AND (strlen($lnkdata[1]) &gt; 0)) {</div>
<div class="line"><a name="l10497"></a><span class="lineno">10497</span>&#160;                    $lnky = floatval($lnkdata[1]);</div>
<div class="line"><a name="l10498"></a><span class="lineno">10498</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l10499"></a><span class="lineno">10499</span>&#160;                    $lnky = 0;</div>
<div class="line"><a name="l10500"></a><span class="lineno">10500</span>&#160;                }</div>
<div class="line"><a name="l10501"></a><span class="lineno">10501</span>&#160;                $url = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a749522038ed7786c3e1701435dcb891e">AddLink</a>();</div>
<div class="line"><a name="l10502"></a><span class="lineno">10502</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ace5be60e7857953ea5e2b89cb90df0ae">SetLink</a>($url, $lnky, <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>);</div>
<div class="line"><a name="l10503"></a><span class="lineno">10503</span>&#160;            }</div>
<div class="line"><a name="l10504"></a><span class="lineno">10504</span>&#160;        }</div>
<div class="line"><a name="l10505"></a><span class="lineno">10505</span>&#160;        <span class="comment">// store current settings</span></div>
<div class="line"><a name="l10506"></a><span class="lineno">10506</span>&#160;        $prevcolor = <a class="code" href="../../d4/d40/classTCPDF.html#a98585a6dd732caf2ba4c0ae2d9aa9841">$this-&gt;fgcolor</a>;</div>
<div class="line"><a name="l10507"></a><span class="lineno">10507</span>&#160;        $prevstyle = <a class="code" href="../../d4/d40/classTCPDF.html#a6fce74bcde6c138d286dce274950dff7">$this-&gt;FontStyle</a>;</div>
<div class="line"><a name="l10508"></a><span class="lineno">10508</span>&#160;        <span class="keywordflow">if</span> (empty($color)) {</div>
<div class="line"><a name="l10509"></a><span class="lineno">10509</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ae6e2854e4d5c71966ef5121934c24566">SetTextColorArray</a>($this-&gt;htmlLinkColorArray);</div>
<div class="line"><a name="l10510"></a><span class="lineno">10510</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l10511"></a><span class="lineno">10511</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ae6e2854e4d5c71966ef5121934c24566">SetTextColorArray</a>($color);</div>
<div class="line"><a name="l10512"></a><span class="lineno">10512</span>&#160;        }</div>
<div class="line"><a name="l10513"></a><span class="lineno">10513</span>&#160;        <span class="keywordflow">if</span> ($style == -1) {</div>
<div class="line"><a name="l10514"></a><span class="lineno">10514</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#afd56e360c43553830d543323e81bc045">SetFont</a>(<span class="stringliteral">&#39;&#39;</span>, $this-&gt;FontStyle.$this-&gt;htmlLinkFontStyle);</div>
<div class="line"><a name="l10515"></a><span class="lineno">10515</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l10516"></a><span class="lineno">10516</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#afd56e360c43553830d543323e81bc045">SetFont</a>(<span class="stringliteral">&#39;&#39;</span>, $this-&gt;FontStyle.$style);</div>
<div class="line"><a name="l10517"></a><span class="lineno">10517</span>&#160;        }</div>
<div class="line"><a name="l10518"></a><span class="lineno">10518</span>&#160;        $ret = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a6669ae88090963e9487d0388c7577dc9">Write</a>($this-&gt;lasth, $name, $url, $fill, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>, 0, $firstline, $firstblock, 0);</div>
<div class="line"><a name="l10519"></a><span class="lineno">10519</span>&#160;        <span class="comment">// restore settings</span></div>
<div class="line"><a name="l10520"></a><span class="lineno">10520</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#afd56e360c43553830d543323e81bc045">SetFont</a>(<span class="stringliteral">&#39;&#39;</span>, $prevstyle);</div>
<div class="line"><a name="l10521"></a><span class="lineno">10521</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ae6e2854e4d5c71966ef5121934c24566">SetTextColorArray</a>($prevcolor);</div>
<div class="line"><a name="l10522"></a><span class="lineno">10522</span>&#160;        <span class="keywordflow">return</span> $ret;</div>
<div class="line"><a name="l10523"></a><span class="lineno">10523</span>&#160;    }</div>
<div class="line"><a name="l10524"></a><span class="lineno">10524</span>&#160;</div>
<div class="line"><a name="l10532"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a9a0a09e2334f92e7a54cf1f550c3f921">10532</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a9a0a09e2334f92e7a54cf1f550c3f921">pixelsToUnits</a>($px) {</div>
<div class="line"><a name="l10533"></a><span class="lineno">10533</span>&#160;        <span class="keywordflow">return</span> ($px / ($this-&gt;imgscale * $this-&gt;k));</div>
<div class="line"><a name="l10534"></a><span class="lineno">10534</span>&#160;    }</div>
<div class="line"><a name="l10535"></a><span class="lineno">10535</span>&#160;</div>
<div class="line"><a name="l10543"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ae4bdb1a4c29d0a0d707caad308dcd320">10543</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ae4bdb1a4c29d0a0d707caad308dcd320">unhtmlentities</a>($text_to_convert) {</div>
<div class="line"><a name="l10544"></a><span class="lineno">10544</span>&#160;        <span class="keywordflow">return</span> @html_entity_decode($text_to_convert, ENT_QUOTES, $this-&gt;encoding);</div>
<div class="line"><a name="l10545"></a><span class="lineno">10545</span>&#160;    }</div>
<div class="line"><a name="l10546"></a><span class="lineno">10546</span>&#160;</div>
<div class="line"><a name="l10547"></a><span class="lineno">10547</span>&#160;    <span class="comment">// ENCRYPTION METHODS ----------------------------------</span></div>
<div class="line"><a name="l10548"></a><span class="lineno">10548</span>&#160;</div>
<div class="line"><a name="l10558"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a8637af5bc22147a813797a4fbda3dba2">10558</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a8637af5bc22147a813797a4fbda3dba2">_objectkey</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>) {</div>
<div class="line"><a name="l10559"></a><span class="lineno">10559</span>&#160;        $objkey = $this-&gt;encryptdata[<span class="stringliteral">&#39;key&#39;</span>].pack(<span class="stringliteral">&#39;VXxx&#39;</span>, <a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>);</div>
<div class="line"><a name="l10560"></a><span class="lineno">10560</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;encryptdata[<span class="stringliteral">&#39;mode&#39;</span>] == 2) { <span class="comment">// AES-128</span></div>
<div class="line"><a name="l10561"></a><span class="lineno">10561</span>&#160;            <span class="comment">// AES padding</span></div>
<div class="line"><a name="l10562"></a><span class="lineno">10562</span>&#160;            $objkey .= <span class="stringliteral">&quot;\x73\x41\x6C\x54&quot;</span>; <span class="comment">// sAlT</span></div>
<div class="line"><a name="l10563"></a><span class="lineno">10563</span>&#160;        }</div>
<div class="line"><a name="l10564"></a><span class="lineno">10564</span>&#160;        $objkey = substr(TCPDF_STATIC::_md5_16($objkey), 0, (($this-&gt;encryptdata[<span class="stringliteral">&#39;Length&#39;</span>] / 8) + 5));</div>
<div class="line"><a name="l10565"></a><span class="lineno">10565</span>&#160;        $objkey = substr($objkey, 0, 16);</div>
<div class="line"><a name="l10566"></a><span class="lineno">10566</span>&#160;        <span class="keywordflow">return</span> $objkey;</div>
<div class="line"><a name="l10567"></a><span class="lineno">10567</span>&#160;    }</div>
<div class="line"><a name="l10568"></a><span class="lineno">10568</span>&#160;</div>
<div class="line"><a name="l10578"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aa152b05eedf7152d8163ab4f5083de1c">10578</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#aa152b05eedf7152d8163ab4f5083de1c">_encrypt_data</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>, $s) {</div>
<div class="line"><a name="l10579"></a><span class="lineno">10579</span>&#160;        <span class="keywordflow">if</span> (!$this-&gt;encrypted) {</div>
<div class="line"><a name="l10580"></a><span class="lineno">10580</span>&#160;            <span class="keywordflow">return</span> $s;</div>
<div class="line"><a name="l10581"></a><span class="lineno">10581</span>&#160;        }</div>
<div class="line"><a name="l10582"></a><span class="lineno">10582</span>&#160;        <span class="keywordflow">switch</span> ($this-&gt;encryptdata[<span class="stringliteral">&#39;mode&#39;</span>]) {</div>
<div class="line"><a name="l10583"></a><span class="lineno">10583</span>&#160;            <span class="keywordflow">case</span> 0:   <span class="comment">// RC4-40</span></div>
<div class="line"><a name="l10584"></a><span class="lineno">10584</span>&#160;            <span class="keywordflow">case</span> 1: { <span class="comment">// RC4-128</span></div>
<div class="line"><a name="l10585"></a><span class="lineno">10585</span>&#160;                $s = TCPDF_STATIC::_RC4($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8637af5bc22147a813797a4fbda3dba2">_objectkey</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>), $s, $this-&gt;last_enc_key, $this-&gt;last_enc_key_c);</div>
<div class="line"><a name="l10586"></a><span class="lineno">10586</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l10587"></a><span class="lineno">10587</span>&#160;            }</div>
<div class="line"><a name="l10588"></a><span class="lineno">10588</span>&#160;            <span class="keywordflow">case</span> 2: { <span class="comment">// AES-128</span></div>
<div class="line"><a name="l10589"></a><span class="lineno">10589</span>&#160;                $s = TCPDF_STATIC::_AES($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8637af5bc22147a813797a4fbda3dba2">_objectkey</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>), $s);</div>
<div class="line"><a name="l10590"></a><span class="lineno">10590</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l10591"></a><span class="lineno">10591</span>&#160;            }</div>
<div class="line"><a name="l10592"></a><span class="lineno">10592</span>&#160;            <span class="keywordflow">case</span> 3: { <span class="comment">// AES-256</span></div>
<div class="line"><a name="l10593"></a><span class="lineno">10593</span>&#160;                $s = TCPDF_STATIC::_AES($this-&gt;encryptdata[<span class="stringliteral">&#39;key&#39;</span>], $s);</div>
<div class="line"><a name="l10594"></a><span class="lineno">10594</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l10595"></a><span class="lineno">10595</span>&#160;            }</div>
<div class="line"><a name="l10596"></a><span class="lineno">10596</span>&#160;        }</div>
<div class="line"><a name="l10597"></a><span class="lineno">10597</span>&#160;        <span class="keywordflow">return</span> $s;</div>
<div class="line"><a name="l10598"></a><span class="lineno">10598</span>&#160;    }</div>
<div class="line"><a name="l10599"></a><span class="lineno">10599</span>&#160;</div>
<div class="line"><a name="l10606"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ab5ed9ad2bde4d072fbd2facb96599e95">10606</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ab5ed9ad2bde4d072fbd2facb96599e95">_putencryption</a>() {</div>
<div class="line"><a name="l10607"></a><span class="lineno">10607</span>&#160;        <span class="keywordflow">if</span> (!$this-&gt;encrypted) {</div>
<div class="line"><a name="l10608"></a><span class="lineno">10608</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l10609"></a><span class="lineno">10609</span>&#160;        }</div>
<div class="line"><a name="l10610"></a><span class="lineno">10610</span>&#160;        $this-&gt;encryptdata[<span class="stringliteral">&#39;objid&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d">_newobj</a>();</div>
<div class="line"><a name="l10611"></a><span class="lineno">10611</span>&#160;        $out = <span class="stringliteral">&#39;&lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l10612"></a><span class="lineno">10612</span>&#160;        <span class="keywordflow">if</span> (!isset($this-&gt;encryptdata[<span class="stringliteral">&#39;Filter&#39;</span>]) OR empty($this-&gt;encryptdata[<span class="stringliteral">&#39;Filter&#39;</span>])) {</div>
<div class="line"><a name="l10613"></a><span class="lineno">10613</span>&#160;            $this-&gt;encryptdata[<span class="stringliteral">&#39;Filter&#39;</span>] = <span class="stringliteral">&#39;Standard&#39;</span>;</div>
<div class="line"><a name="l10614"></a><span class="lineno">10614</span>&#160;        }</div>
<div class="line"><a name="l10615"></a><span class="lineno">10615</span>&#160;        $out .= <span class="stringliteral">&#39; /Filter /&#39;</span>.$this-&gt;encryptdata[<span class="stringliteral">&#39;Filter&#39;</span>];</div>
<div class="line"><a name="l10616"></a><span class="lineno">10616</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;encryptdata[<span class="stringliteral">&#39;SubFilter&#39;</span>]) AND !empty($this-&gt;encryptdata[<span class="stringliteral">&#39;SubFilter&#39;</span>])) {</div>
<div class="line"><a name="l10617"></a><span class="lineno">10617</span>&#160;            $out .= <span class="stringliteral">&#39; /SubFilter /&#39;</span>.$this-&gt;encryptdata[<span class="stringliteral">&#39;SubFilter&#39;</span>];</div>
<div class="line"><a name="l10618"></a><span class="lineno">10618</span>&#160;        }</div>
<div class="line"><a name="l10619"></a><span class="lineno">10619</span>&#160;        <span class="keywordflow">if</span> (!isset($this-&gt;encryptdata[<span class="charliteral">&#39;V&#39;</span>]) OR empty($this-&gt;encryptdata[<span class="charliteral">&#39;V&#39;</span>])) {</div>
<div class="line"><a name="l10620"></a><span class="lineno">10620</span>&#160;            $this-&gt;encryptdata[<span class="charliteral">&#39;V&#39;</span>] = 1;</div>
<div class="line"><a name="l10621"></a><span class="lineno">10621</span>&#160;        }</div>
<div class="line"><a name="l10622"></a><span class="lineno">10622</span>&#160;        <span class="comment">// V is a code specifying the algorithm to be used in encrypting and decrypting the document</span></div>
<div class="line"><a name="l10623"></a><span class="lineno">10623</span>&#160;        $out .= <span class="stringliteral">&#39; /V &#39;</span>.$this-&gt;encryptdata[<span class="charliteral">&#39;V&#39;</span>];</div>
<div class="line"><a name="l10624"></a><span class="lineno">10624</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;encryptdata[<span class="stringliteral">&#39;Length&#39;</span>]) AND !empty($this-&gt;encryptdata[<span class="stringliteral">&#39;Length&#39;</span>])) {</div>
<div class="line"><a name="l10625"></a><span class="lineno">10625</span>&#160;            <span class="comment">// The length of the encryption key, in bits. The value shall be a multiple of 8, in the range 40 to 256</span></div>
<div class="line"><a name="l10626"></a><span class="lineno">10626</span>&#160;            $out .= <span class="stringliteral">&#39; /Length &#39;</span>.$this-&gt;encryptdata[<span class="stringliteral">&#39;Length&#39;</span>];</div>
<div class="line"><a name="l10627"></a><span class="lineno">10627</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l10628"></a><span class="lineno">10628</span>&#160;            $out .= <span class="stringliteral">&#39; /Length 40&#39;</span>;</div>
<div class="line"><a name="l10629"></a><span class="lineno">10629</span>&#160;        }</div>
<div class="line"><a name="l10630"></a><span class="lineno">10630</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;encryptdata[<span class="charliteral">&#39;V&#39;</span>] &gt;= 4) {</div>
<div class="line"><a name="l10631"></a><span class="lineno">10631</span>&#160;            <span class="keywordflow">if</span> (!isset($this-&gt;encryptdata[<span class="stringliteral">&#39;StmF&#39;</span>]) OR empty($this-&gt;encryptdata[<span class="stringliteral">&#39;StmF&#39;</span>])) {</div>
<div class="line"><a name="l10632"></a><span class="lineno">10632</span>&#160;                $this-&gt;encryptdata[<span class="stringliteral">&#39;StmF&#39;</span>] = <span class="stringliteral">&#39;Identity&#39;</span>;</div>
<div class="line"><a name="l10633"></a><span class="lineno">10633</span>&#160;            }</div>
<div class="line"><a name="l10634"></a><span class="lineno">10634</span>&#160;            <span class="keywordflow">if</span> (!isset($this-&gt;encryptdata[<span class="stringliteral">&#39;StrF&#39;</span>]) OR empty($this-&gt;encryptdata[<span class="stringliteral">&#39;StrF&#39;</span>])) {</div>
<div class="line"><a name="l10635"></a><span class="lineno">10635</span>&#160;                <span class="comment">// The name of the crypt filter that shall be used when decrypting all strings in the document.</span></div>
<div class="line"><a name="l10636"></a><span class="lineno">10636</span>&#160;                $this-&gt;encryptdata[<span class="stringliteral">&#39;StrF&#39;</span>] = <span class="stringliteral">&#39;Identity&#39;</span>;</div>
<div class="line"><a name="l10637"></a><span class="lineno">10637</span>&#160;            }</div>
<div class="line"><a name="l10638"></a><span class="lineno">10638</span>&#160;            <span class="comment">// A dictionary whose keys shall be crypt filter names and whose values shall be the corresponding crypt filter dictionaries.</span></div>
<div class="line"><a name="l10639"></a><span class="lineno">10639</span>&#160;            <span class="keywordflow">if</span> (isset($this-&gt;encryptdata[<span class="stringliteral">&#39;CF&#39;</span>]) AND !empty($this-&gt;encryptdata[<span class="stringliteral">&#39;CF&#39;</span>])) {</div>
<div class="line"><a name="l10640"></a><span class="lineno">10640</span>&#160;                $out .= <span class="stringliteral">&#39; /CF &lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l10641"></a><span class="lineno">10641</span>&#160;                $out .= <span class="stringliteral">&#39; /&#39;</span>.$this-&gt;encryptdata[<span class="stringliteral">&#39;StmF&#39;</span>].<span class="stringliteral">&#39; &lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l10642"></a><span class="lineno">10642</span>&#160;                $out .= <span class="stringliteral">&#39; /Type /CryptFilter&#39;</span>;</div>
<div class="line"><a name="l10643"></a><span class="lineno">10643</span>&#160;                <span class="keywordflow">if</span> (isset($this-&gt;encryptdata[<span class="stringliteral">&#39;CF&#39;</span>][<span class="stringliteral">&#39;CFM&#39;</span>]) AND !empty($this-&gt;encryptdata[<span class="stringliteral">&#39;CF&#39;</span>][<span class="stringliteral">&#39;CFM&#39;</span>])) {</div>
<div class="line"><a name="l10644"></a><span class="lineno">10644</span>&#160;                    <span class="comment">// The method used</span></div>
<div class="line"><a name="l10645"></a><span class="lineno">10645</span>&#160;                    $out .= <span class="stringliteral">&#39; /CFM /&#39;</span>.$this-&gt;encryptdata[<span class="stringliteral">&#39;CF&#39;</span>][<span class="stringliteral">&#39;CFM&#39;</span>];</div>
<div class="line"><a name="l10646"></a><span class="lineno">10646</span>&#160;                    <span class="keywordflow">if</span> ($this-&gt;encryptdata[<span class="stringliteral">&#39;pubkey&#39;</span>]) {</div>
<div class="line"><a name="l10647"></a><span class="lineno">10647</span>&#160;                        $out .= <span class="stringliteral">&#39; /Recipients [&#39;</span>;</div>
<div class="line"><a name="l10648"></a><span class="lineno">10648</span>&#160;                        <span class="keywordflow">foreach</span> ($this-&gt;encryptdata[<span class="stringliteral">&#39;Recipients&#39;</span>] as $rec) {</div>
<div class="line"><a name="l10649"></a><span class="lineno">10649</span>&#160;                            $out .= <span class="stringliteral">&#39; &lt;&#39;</span>.$rec.<span class="charliteral">&#39;&gt;&#39;</span>;</div>
<div class="line"><a name="l10650"></a><span class="lineno">10650</span>&#160;                        }</div>
<div class="line"><a name="l10651"></a><span class="lineno">10651</span>&#160;                        $out .= <span class="stringliteral">&#39; ]&#39;</span>;</div>
<div class="line"><a name="l10652"></a><span class="lineno">10652</span>&#160;                        <span class="keywordflow">if</span> (isset($this-&gt;encryptdata[<span class="stringliteral">&#39;CF&#39;</span>][<span class="stringliteral">&#39;EncryptMetadata&#39;</span>]) AND (!$this-&gt;encryptdata[<span class="stringliteral">&#39;CF&#39;</span>][<span class="stringliteral">&#39;EncryptMetadata&#39;</span>])) {</div>
<div class="line"><a name="l10653"></a><span class="lineno">10653</span>&#160;                            $out .= <span class="stringliteral">&#39; /EncryptMetadata false&#39;</span>;</div>
<div class="line"><a name="l10654"></a><span class="lineno">10654</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l10655"></a><span class="lineno">10655</span>&#160;                            $out .= <span class="stringliteral">&#39; /EncryptMetadata true&#39;</span>;</div>
<div class="line"><a name="l10656"></a><span class="lineno">10656</span>&#160;                        }</div>
<div class="line"><a name="l10657"></a><span class="lineno">10657</span>&#160;                    }</div>
<div class="line"><a name="l10658"></a><span class="lineno">10658</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l10659"></a><span class="lineno">10659</span>&#160;                    $out .= <span class="stringliteral">&#39; /CFM /None&#39;</span>;</div>
<div class="line"><a name="l10660"></a><span class="lineno">10660</span>&#160;                }</div>
<div class="line"><a name="l10661"></a><span class="lineno">10661</span>&#160;                <span class="keywordflow">if</span> (isset($this-&gt;encryptdata[<span class="stringliteral">&#39;CF&#39;</span>][<span class="stringliteral">&#39;AuthEvent&#39;</span>]) AND !empty($this-&gt;encryptdata[<span class="stringliteral">&#39;CF&#39;</span>][<span class="stringliteral">&#39;AuthEvent&#39;</span>])) {</div>
<div class="line"><a name="l10662"></a><span class="lineno">10662</span>&#160;                    <span class="comment">// The event to be used to trigger the authorization that is required to access encryption keys used by this filter.</span></div>
<div class="line"><a name="l10663"></a><span class="lineno">10663</span>&#160;                    $out .= <span class="stringliteral">&#39; /AuthEvent /&#39;</span>.$this-&gt;encryptdata[<span class="stringliteral">&#39;CF&#39;</span>][<span class="stringliteral">&#39;AuthEvent&#39;</span>];</div>
<div class="line"><a name="l10664"></a><span class="lineno">10664</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l10665"></a><span class="lineno">10665</span>&#160;                    $out .= <span class="stringliteral">&#39; /AuthEvent /DocOpen&#39;</span>;</div>
<div class="line"><a name="l10666"></a><span class="lineno">10666</span>&#160;                }</div>
<div class="line"><a name="l10667"></a><span class="lineno">10667</span>&#160;                <span class="keywordflow">if</span> (isset($this-&gt;encryptdata[<span class="stringliteral">&#39;CF&#39;</span>][<span class="stringliteral">&#39;Length&#39;</span>]) AND !empty($this-&gt;encryptdata[<span class="stringliteral">&#39;CF&#39;</span>][<span class="stringliteral">&#39;Length&#39;</span>])) {</div>
<div class="line"><a name="l10668"></a><span class="lineno">10668</span>&#160;                    <span class="comment">// The bit length of the encryption key.</span></div>
<div class="line"><a name="l10669"></a><span class="lineno">10669</span>&#160;                    $out .= <span class="stringliteral">&#39; /Length &#39;</span>.$this-&gt;encryptdata[<span class="stringliteral">&#39;CF&#39;</span>][<span class="stringliteral">&#39;Length&#39;</span>];</div>
<div class="line"><a name="l10670"></a><span class="lineno">10670</span>&#160;                }</div>
<div class="line"><a name="l10671"></a><span class="lineno">10671</span>&#160;                $out .= <span class="stringliteral">&#39; &gt;&gt; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l10672"></a><span class="lineno">10672</span>&#160;            }</div>
<div class="line"><a name="l10673"></a><span class="lineno">10673</span>&#160;            <span class="comment">// The name of the crypt filter that shall be used by default when decrypting streams.</span></div>
<div class="line"><a name="l10674"></a><span class="lineno">10674</span>&#160;            $out .= <span class="stringliteral">&#39; /StmF /&#39;</span>.$this-&gt;encryptdata[<span class="stringliteral">&#39;StmF&#39;</span>];</div>
<div class="line"><a name="l10675"></a><span class="lineno">10675</span>&#160;            <span class="comment">// The name of the crypt filter that shall be used when decrypting all strings in the document.</span></div>
<div class="line"><a name="l10676"></a><span class="lineno">10676</span>&#160;            $out .= <span class="stringliteral">&#39; /StrF /&#39;</span>.$this-&gt;encryptdata[<span class="stringliteral">&#39;StrF&#39;</span>];</div>
<div class="line"><a name="l10677"></a><span class="lineno">10677</span>&#160;            <span class="keywordflow">if</span> (isset($this-&gt;encryptdata[<span class="stringliteral">&#39;EFF&#39;</span>]) AND !empty($this-&gt;encryptdata[<span class="stringliteral">&#39;EFF&#39;</span>])) {</div>
<div class="line"><a name="l10678"></a><span class="lineno">10678</span>&#160;                <span class="comment">// The name of the crypt filter that shall be used when encrypting embedded file streams that do not have their own crypt filter specifier.</span></div>
<div class="line"><a name="l10679"></a><span class="lineno">10679</span>&#160;                $out .= <span class="stringliteral">&#39; /EFF /&#39;</span>.$this-&gt;encryptdata[<span class="stringliteral">&#39;&#39;</span>];</div>
<div class="line"><a name="l10680"></a><span class="lineno">10680</span>&#160;            }</div>
<div class="line"><a name="l10681"></a><span class="lineno">10681</span>&#160;        }</div>
<div class="line"><a name="l10682"></a><span class="lineno">10682</span>&#160;        <span class="comment">// Additional encryption dictionary entries for the standard security handler</span></div>
<div class="line"><a name="l10683"></a><span class="lineno">10683</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;encryptdata[<span class="stringliteral">&#39;pubkey&#39;</span>]) {</div>
<div class="line"><a name="l10684"></a><span class="lineno">10684</span>&#160;            <span class="keywordflow">if</span> (($this-&gt;encryptdata[<span class="charliteral">&#39;V&#39;</span>] &lt; 4) AND isset($this-&gt;encryptdata[<span class="stringliteral">&#39;Recipients&#39;</span>]) AND !empty($this-&gt;encryptdata[<span class="stringliteral">&#39;Recipients&#39;</span>])) {</div>
<div class="line"><a name="l10685"></a><span class="lineno">10685</span>&#160;                $out .= <span class="stringliteral">&#39; /Recipients [&#39;</span>;</div>
<div class="line"><a name="l10686"></a><span class="lineno">10686</span>&#160;                <span class="keywordflow">foreach</span> ($this-&gt;encryptdata[<span class="stringliteral">&#39;Recipients&#39;</span>] as $rec) {</div>
<div class="line"><a name="l10687"></a><span class="lineno">10687</span>&#160;                    $out .= <span class="stringliteral">&#39; &lt;&#39;</span>.$rec.<span class="charliteral">&#39;&gt;&#39;</span>;</div>
<div class="line"><a name="l10688"></a><span class="lineno">10688</span>&#160;                }</div>
<div class="line"><a name="l10689"></a><span class="lineno">10689</span>&#160;                $out .= <span class="stringliteral">&#39; ]&#39;</span>;</div>
<div class="line"><a name="l10690"></a><span class="lineno">10690</span>&#160;            }</div>
<div class="line"><a name="l10691"></a><span class="lineno">10691</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l10692"></a><span class="lineno">10692</span>&#160;            $out .= <span class="stringliteral">&#39; /R&#39;</span>;</div>
<div class="line"><a name="l10693"></a><span class="lineno">10693</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;encryptdata[<span class="charliteral">&#39;V&#39;</span>] == 5) { <span class="comment">// AES-256</span></div>
<div class="line"><a name="l10694"></a><span class="lineno">10694</span>&#160;                $out .= <span class="stringliteral">&#39; 5&#39;</span>;</div>
<div class="line"><a name="l10695"></a><span class="lineno">10695</span>&#160;                $out .= <span class="stringliteral">&#39; /OE (&#39;</span>.TCPDF_STATIC::_escape($this-&gt;encryptdata[<span class="stringliteral">&#39;OE&#39;</span>]).<span class="charliteral">&#39;)&#39;</span>;</div>
<div class="line"><a name="l10696"></a><span class="lineno">10696</span>&#160;                $out .= <span class="stringliteral">&#39; /UE (&#39;</span>.TCPDF_STATIC::_escape($this-&gt;encryptdata[<span class="stringliteral">&#39;UE&#39;</span>]).<span class="charliteral">&#39;)&#39;</span>;</div>
<div class="line"><a name="l10697"></a><span class="lineno">10697</span>&#160;                $out .= <span class="stringliteral">&#39; /Perms (&#39;</span>.TCPDF_STATIC::_escape($this-&gt;encryptdata[<span class="stringliteral">&#39;perms&#39;</span>]).<span class="charliteral">&#39;)&#39;</span>;</div>
<div class="line"><a name="l10698"></a><span class="lineno">10698</span>&#160;            } elseif ($this-&gt;encryptdata[<span class="charliteral">&#39;V&#39;</span>] == 4) { <span class="comment">// AES-128</span></div>
<div class="line"><a name="l10699"></a><span class="lineno">10699</span>&#160;                $out .= <span class="stringliteral">&#39; 4&#39;</span>;</div>
<div class="line"><a name="l10700"></a><span class="lineno">10700</span>&#160;            } elseif ($this-&gt;encryptdata[<span class="charliteral">&#39;V&#39;</span>] &lt; 2) { <span class="comment">// RC-40</span></div>
<div class="line"><a name="l10701"></a><span class="lineno">10701</span>&#160;                $out .= <span class="stringliteral">&#39; 2&#39;</span>;</div>
<div class="line"><a name="l10702"></a><span class="lineno">10702</span>&#160;            } <span class="keywordflow">else</span> { <span class="comment">// RC-128</span></div>
<div class="line"><a name="l10703"></a><span class="lineno">10703</span>&#160;                $out .= <span class="stringliteral">&#39; 3&#39;</span>;</div>
<div class="line"><a name="l10704"></a><span class="lineno">10704</span>&#160;            }</div>
<div class="line"><a name="l10705"></a><span class="lineno">10705</span>&#160;            $out .= <span class="stringliteral">&#39; /O (&#39;</span>.TCPDF_STATIC::_escape($this-&gt;encryptdata[<span class="charliteral">&#39;O&#39;</span>]).<span class="charliteral">&#39;)&#39;</span>;</div>
<div class="line"><a name="l10706"></a><span class="lineno">10706</span>&#160;            $out .= <span class="stringliteral">&#39; /U (&#39;</span>.TCPDF_STATIC::_escape($this-&gt;encryptdata[<span class="charliteral">&#39;U&#39;</span>]).<span class="charliteral">&#39;)&#39;</span>;</div>
<div class="line"><a name="l10707"></a><span class="lineno">10707</span>&#160;            $out .= <span class="stringliteral">&#39; /P &#39;</span>.$this-&gt;encryptdata[<span class="charliteral">&#39;P&#39;</span>];</div>
<div class="line"><a name="l10708"></a><span class="lineno">10708</span>&#160;            <span class="keywordflow">if</span> (isset($this-&gt;encryptdata[<span class="stringliteral">&#39;EncryptMetadata&#39;</span>]) AND (!$this-&gt;encryptdata[<span class="stringliteral">&#39;EncryptMetadata&#39;</span>])) {</div>
<div class="line"><a name="l10709"></a><span class="lineno">10709</span>&#160;                $out .= <span class="stringliteral">&#39; /EncryptMetadata false&#39;</span>;</div>
<div class="line"><a name="l10710"></a><span class="lineno">10710</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l10711"></a><span class="lineno">10711</span>&#160;                $out .= <span class="stringliteral">&#39; /EncryptMetadata true&#39;</span>;</div>
<div class="line"><a name="l10712"></a><span class="lineno">10712</span>&#160;            }</div>
<div class="line"><a name="l10713"></a><span class="lineno">10713</span>&#160;        }</div>
<div class="line"><a name="l10714"></a><span class="lineno">10714</span>&#160;        $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l10715"></a><span class="lineno">10715</span>&#160;        $out .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l10716"></a><span class="lineno">10716</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($out);</div>
<div class="line"><a name="l10717"></a><span class="lineno">10717</span>&#160;    }</div>
<div class="line"><a name="l10718"></a><span class="lineno">10718</span>&#160;</div>
<div class="line"><a name="l10726"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aa486c0cad639e303d878b1f4b5ef772e">10726</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#aa486c0cad639e303d878b1f4b5ef772e">_Uvalue</a>() {</div>
<div class="line"><a name="l10727"></a><span class="lineno">10727</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;encryptdata[<span class="stringliteral">&#39;mode&#39;</span>] == 0) { <span class="comment">// RC4-40</span></div>
<div class="line"><a name="l10728"></a><span class="lineno">10728</span>&#160;            <span class="keywordflow">return</span> TCPDF_STATIC::_RC4($this-&gt;encryptdata[<span class="stringliteral">&#39;key&#39;</span>], TCPDF_STATIC::$enc_padding, $this-&gt;last_enc_key, $this-&gt;last_enc_key_c);</div>
<div class="line"><a name="l10729"></a><span class="lineno">10729</span>&#160;        } elseif ($this-&gt;encryptdata[<span class="stringliteral">&#39;mode&#39;</span>] &lt; 3) { <span class="comment">// RC4-128, AES-128</span></div>
<div class="line"><a name="l10730"></a><span class="lineno">10730</span>&#160;            $tmp = TCPDF_STATIC::_md5_16(TCPDF_STATIC::$enc_padding.$this-&gt;encryptdata[<span class="stringliteral">&#39;fileid&#39;</span>]);</div>
<div class="line"><a name="l10731"></a><span class="lineno">10731</span>&#160;            $enc = TCPDF_STATIC::_RC4($this-&gt;encryptdata[<span class="stringliteral">&#39;key&#39;</span>], $tmp, $this-&gt;last_enc_key, $this-&gt;last_enc_key_c);</div>
<div class="line"><a name="l10732"></a><span class="lineno">10732</span>&#160;            $len = strlen($tmp);</div>
<div class="line"><a name="l10733"></a><span class="lineno">10733</span>&#160;            <span class="keywordflow">for</span> ($i = 1; $i &lt;= 19; ++$i) {</div>
<div class="line"><a name="l10734"></a><span class="lineno">10734</span>&#160;                $ek = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l10735"></a><span class="lineno">10735</span>&#160;                <span class="keywordflow">for</span> ($j = 0; $j &lt; $len; ++$j) {</div>
<div class="line"><a name="l10736"></a><span class="lineno">10736</span>&#160;                    $ek .= chr(ord($this-&gt;encryptdata[<span class="stringliteral">&#39;key&#39;</span>][$j]) ^ $i);</div>
<div class="line"><a name="l10737"></a><span class="lineno">10737</span>&#160;                }</div>
<div class="line"><a name="l10738"></a><span class="lineno">10738</span>&#160;                $enc = TCPDF_STATIC::_RC4($ek, $enc, $this-&gt;last_enc_key, $this-&gt;last_enc_key_c);</div>
<div class="line"><a name="l10739"></a><span class="lineno">10739</span>&#160;            }</div>
<div class="line"><a name="l10740"></a><span class="lineno">10740</span>&#160;            $enc .= str_repeat(<span class="stringliteral">&quot;\x00&quot;</span>, 16);</div>
<div class="line"><a name="l10741"></a><span class="lineno">10741</span>&#160;            <span class="keywordflow">return</span> substr($enc, 0, 32);</div>
<div class="line"><a name="l10742"></a><span class="lineno">10742</span>&#160;        } elseif ($this-&gt;encryptdata[<span class="stringliteral">&#39;mode&#39;</span>] == 3) { <span class="comment">// AES-256</span></div>
<div class="line"><a name="l10743"></a><span class="lineno">10743</span>&#160;            $seed = TCPDF_STATIC::_md5_16(TCPDF_STATIC::getRandomSeed());</div>
<div class="line"><a name="l10744"></a><span class="lineno">10744</span>&#160;            <span class="comment">// User Validation Salt</span></div>
<div class="line"><a name="l10745"></a><span class="lineno">10745</span>&#160;            $this-&gt;encryptdata[<span class="stringliteral">&#39;UVS&#39;</span>] = substr($seed, 0, 8);</div>
<div class="line"><a name="l10746"></a><span class="lineno">10746</span>&#160;            <span class="comment">// User Key Salt</span></div>
<div class="line"><a name="l10747"></a><span class="lineno">10747</span>&#160;            $this-&gt;encryptdata[<span class="stringliteral">&#39;UKS&#39;</span>] = substr($seed, 8, 16);</div>
<div class="line"><a name="l10748"></a><span class="lineno">10748</span>&#160;            <span class="keywordflow">return</span> hash(<span class="stringliteral">&#39;sha256&#39;</span>, $this-&gt;encryptdata[<span class="stringliteral">&#39;user_password&#39;</span>].$this-&gt;encryptdata[<span class="stringliteral">&#39;UVS&#39;</span>], <span class="keyword">true</span>).$this-&gt;encryptdata[<span class="stringliteral">&#39;UVS&#39;</span>].$this-&gt;encryptdata[<span class="stringliteral">&#39;UKS&#39;</span>];</div>
<div class="line"><a name="l10749"></a><span class="lineno">10749</span>&#160;        }</div>
<div class="line"><a name="l10750"></a><span class="lineno">10750</span>&#160;    }</div>
<div class="line"><a name="l10751"></a><span class="lineno">10751</span>&#160;</div>
<div class="line"><a name="l10759"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a47524cc909428afea2ee2eb02a72130f">10759</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a47524cc909428afea2ee2eb02a72130f">_UEvalue</a>() {</div>
<div class="line"><a name="l10760"></a><span class="lineno">10760</span>&#160;        $hashkey = hash(<span class="stringliteral">&#39;sha256&#39;</span>, $this-&gt;encryptdata[<span class="stringliteral">&#39;user_password&#39;</span>].$this-&gt;encryptdata[<span class="stringliteral">&#39;UKS&#39;</span>], <span class="keyword">true</span>);</div>
<div class="line"><a name="l10761"></a><span class="lineno">10761</span>&#160;        $iv = str_repeat(<span class="stringliteral">&quot;\x00&quot;</span>, mcrypt_get_iv_size(MCRYPT_RIJNDAEL_128, MCRYPT_MODE_CBC));</div>
<div class="line"><a name="l10762"></a><span class="lineno">10762</span>&#160;        <span class="keywordflow">return</span> mcrypt_encrypt(MCRYPT_RIJNDAEL_128, $hashkey, $this-&gt;encryptdata[<span class="stringliteral">&#39;key&#39;</span>], MCRYPT_MODE_CBC, $iv);</div>
<div class="line"><a name="l10763"></a><span class="lineno">10763</span>&#160;    }</div>
<div class="line"><a name="l10764"></a><span class="lineno">10764</span>&#160;</div>
<div class="line"><a name="l10772"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#abe60f253ebfc6088b3248e84ccf0a4fe">10772</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#abe60f253ebfc6088b3248e84ccf0a4fe">_Ovalue</a>() {</div>
<div class="line"><a name="l10773"></a><span class="lineno">10773</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;encryptdata[<span class="stringliteral">&#39;mode&#39;</span>] &lt; 3) { <span class="comment">// RC4-40, RC4-128, AES-128</span></div>
<div class="line"><a name="l10774"></a><span class="lineno">10774</span>&#160;            $tmp = TCPDF_STATIC::_md5_16($this-&gt;encryptdata[<span class="stringliteral">&#39;owner_password&#39;</span>]);</div>
<div class="line"><a name="l10775"></a><span class="lineno">10775</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;encryptdata[<span class="stringliteral">&#39;mode&#39;</span>] &gt; 0) {</div>
<div class="line"><a name="l10776"></a><span class="lineno">10776</span>&#160;                <span class="keywordflow">for</span> ($i = 0; $i &lt; 50; ++$i) {</div>
<div class="line"><a name="l10777"></a><span class="lineno">10777</span>&#160;                    $tmp = TCPDF_STATIC::_md5_16($tmp);</div>
<div class="line"><a name="l10778"></a><span class="lineno">10778</span>&#160;                }</div>
<div class="line"><a name="l10779"></a><span class="lineno">10779</span>&#160;            }</div>
<div class="line"><a name="l10780"></a><span class="lineno">10780</span>&#160;            $owner_key = substr($tmp, 0, ($this-&gt;encryptdata[<span class="stringliteral">&#39;Length&#39;</span>] / 8));</div>
<div class="line"><a name="l10781"></a><span class="lineno">10781</span>&#160;            $enc = TCPDF_STATIC::_RC4($owner_key, $this-&gt;encryptdata[<span class="stringliteral">&#39;user_password&#39;</span>], $this-&gt;last_enc_key, $this-&gt;last_enc_key_c);</div>
<div class="line"><a name="l10782"></a><span class="lineno">10782</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;encryptdata[<span class="stringliteral">&#39;mode&#39;</span>] &gt; 0) {</div>
<div class="line"><a name="l10783"></a><span class="lineno">10783</span>&#160;                $len = strlen($owner_key);</div>
<div class="line"><a name="l10784"></a><span class="lineno">10784</span>&#160;                <span class="keywordflow">for</span> ($i = 1; $i &lt;= 19; ++$i) {</div>
<div class="line"><a name="l10785"></a><span class="lineno">10785</span>&#160;                    $ek = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l10786"></a><span class="lineno">10786</span>&#160;                    <span class="keywordflow">for</span> ($j = 0; $j &lt; $len; ++$j) {</div>
<div class="line"><a name="l10787"></a><span class="lineno">10787</span>&#160;                        $ek .= chr(ord($owner_key[$j]) ^ $i);</div>
<div class="line"><a name="l10788"></a><span class="lineno">10788</span>&#160;                    }</div>
<div class="line"><a name="l10789"></a><span class="lineno">10789</span>&#160;                    $enc = TCPDF_STATIC::_RC4($ek, $enc, $this-&gt;last_enc_key, $this-&gt;last_enc_key_c);</div>
<div class="line"><a name="l10790"></a><span class="lineno">10790</span>&#160;                }</div>
<div class="line"><a name="l10791"></a><span class="lineno">10791</span>&#160;            }</div>
<div class="line"><a name="l10792"></a><span class="lineno">10792</span>&#160;            <span class="keywordflow">return</span> $enc;</div>
<div class="line"><a name="l10793"></a><span class="lineno">10793</span>&#160;        } elseif ($this-&gt;encryptdata[<span class="stringliteral">&#39;mode&#39;</span>] == 3) { <span class="comment">// AES-256</span></div>
<div class="line"><a name="l10794"></a><span class="lineno">10794</span>&#160;            $seed = TCPDF_STATIC::_md5_16(TCPDF_STATIC::getRandomSeed());</div>
<div class="line"><a name="l10795"></a><span class="lineno">10795</span>&#160;            <span class="comment">// Owner Validation Salt</span></div>
<div class="line"><a name="l10796"></a><span class="lineno">10796</span>&#160;            $this-&gt;encryptdata[<span class="stringliteral">&#39;OVS&#39;</span>] = substr($seed, 0, 8);</div>
<div class="line"><a name="l10797"></a><span class="lineno">10797</span>&#160;            <span class="comment">// Owner Key Salt</span></div>
<div class="line"><a name="l10798"></a><span class="lineno">10798</span>&#160;            $this-&gt;encryptdata[<span class="stringliteral">&#39;OKS&#39;</span>] = substr($seed, 8, 16);</div>
<div class="line"><a name="l10799"></a><span class="lineno">10799</span>&#160;            <span class="keywordflow">return</span> hash(<span class="stringliteral">&#39;sha256&#39;</span>, $this-&gt;encryptdata[<span class="stringliteral">&#39;owner_password&#39;</span>].$this-&gt;encryptdata[<span class="stringliteral">&#39;OVS&#39;</span>].$this-&gt;encryptdata[<span class="charliteral">&#39;U&#39;</span>], <span class="keyword">true</span>).$this-&gt;encryptdata[<span class="stringliteral">&#39;OVS&#39;</span>].$this-&gt;encryptdata[<span class="stringliteral">&#39;OKS&#39;</span>];</div>
<div class="line"><a name="l10800"></a><span class="lineno">10800</span>&#160;        }</div>
<div class="line"><a name="l10801"></a><span class="lineno">10801</span>&#160;    }</div>
<div class="line"><a name="l10802"></a><span class="lineno">10802</span>&#160;</div>
<div class="line"><a name="l10810"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a9d325db7b1243a5f1184b3c3365d588d">10810</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a9d325db7b1243a5f1184b3c3365d588d">_OEvalue</a>() {</div>
<div class="line"><a name="l10811"></a><span class="lineno">10811</span>&#160;        $hashkey = hash(<span class="stringliteral">&#39;sha256&#39;</span>, $this-&gt;encryptdata[<span class="stringliteral">&#39;owner_password&#39;</span>].$this-&gt;encryptdata[<span class="stringliteral">&#39;OKS&#39;</span>].$this-&gt;encryptdata[<span class="charliteral">&#39;U&#39;</span>], <span class="keyword">true</span>);</div>
<div class="line"><a name="l10812"></a><span class="lineno">10812</span>&#160;        $iv = str_repeat(<span class="stringliteral">&quot;\x00&quot;</span>, mcrypt_get_iv_size(MCRYPT_RIJNDAEL_128, MCRYPT_MODE_CBC));</div>
<div class="line"><a name="l10813"></a><span class="lineno">10813</span>&#160;        <span class="keywordflow">return</span> mcrypt_encrypt(MCRYPT_RIJNDAEL_128, $hashkey, $this-&gt;encryptdata[<span class="stringliteral">&#39;key&#39;</span>], MCRYPT_MODE_CBC, $iv);</div>
<div class="line"><a name="l10814"></a><span class="lineno">10814</span>&#160;    }</div>
<div class="line"><a name="l10815"></a><span class="lineno">10815</span>&#160;</div>
<div class="line"><a name="l10824"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a73ce7a4a68a80ec0efb9317b15819ab4">10824</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a73ce7a4a68a80ec0efb9317b15819ab4">_fixAES256Password</a>($password) {</div>
<div class="line"><a name="l10825"></a><span class="lineno">10825</span>&#160;        $psw = <span class="stringliteral">&#39;&#39;</span>; <span class="comment">// password to be returned</span></div>
<div class="line"><a name="l10826"></a><span class="lineno">10826</span>&#160;        $psw_array = TCPDF_FONTS::utf8Bidi(TCPDF_FONTS::UTF8StringToArray($password, $this-&gt;isunicode, $this-&gt;CurrentFont), $password, $this-&gt;rtl, $this-&gt;isunicode, $this-&gt;CurrentFont);</div>
<div class="line"><a name="l10827"></a><span class="lineno">10827</span>&#160;        <span class="keywordflow">foreach</span> ($psw_array as $c) {</div>
<div class="line"><a name="l10828"></a><span class="lineno">10828</span>&#160;            $psw .= TCPDF_FONTS::unichr($c, $this-&gt;isunicode);</div>
<div class="line"><a name="l10829"></a><span class="lineno">10829</span>&#160;        }</div>
<div class="line"><a name="l10830"></a><span class="lineno">10830</span>&#160;        <span class="keywordflow">return</span> substr($psw, 0, 127);</div>
<div class="line"><a name="l10831"></a><span class="lineno">10831</span>&#160;    }</div>
<div class="line"><a name="l10832"></a><span class="lineno">10832</span>&#160;</div>
<div class="line"><a name="l10839"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aebcb9fe17da560731acc6c5329366c52">10839</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#aebcb9fe17da560731acc6c5329366c52">_generateencryptionkey</a>() {</div>
<div class="line"><a name="l10840"></a><span class="lineno">10840</span>&#160;        $keybytelen = ($this-&gt;encryptdata[<span class="stringliteral">&#39;Length&#39;</span>] / 8);</div>
<div class="line"><a name="l10841"></a><span class="lineno">10841</span>&#160;        <span class="keywordflow">if</span> (!$this-&gt;encryptdata[<span class="stringliteral">&#39;pubkey&#39;</span>]) { <span class="comment">// standard mode</span></div>
<div class="line"><a name="l10842"></a><span class="lineno">10842</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;encryptdata[<span class="stringliteral">&#39;mode&#39;</span>] == 3) { <span class="comment">// AES-256</span></div>
<div class="line"><a name="l10843"></a><span class="lineno">10843</span>&#160;                <span class="comment">// generate 256 bit random key</span></div>
<div class="line"><a name="l10844"></a><span class="lineno">10844</span>&#160;                $this-&gt;encryptdata[<span class="stringliteral">&#39;key&#39;</span>] = substr(hash(<span class="stringliteral">&#39;sha256&#39;</span>, TCPDF_STATIC::getRandomSeed(), <span class="keyword">true</span>), 0, $keybytelen);</div>
<div class="line"><a name="l10845"></a><span class="lineno">10845</span>&#160;                <span class="comment">// truncate passwords</span></div>
<div class="line"><a name="l10846"></a><span class="lineno">10846</span>&#160;                $this-&gt;encryptdata[<span class="stringliteral">&#39;user_password&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a73ce7a4a68a80ec0efb9317b15819ab4">_fixAES256Password</a>($this-&gt;encryptdata[<span class="stringliteral">&#39;user_password&#39;</span>]);</div>
<div class="line"><a name="l10847"></a><span class="lineno">10847</span>&#160;                $this-&gt;encryptdata[<span class="stringliteral">&#39;owner_password&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a73ce7a4a68a80ec0efb9317b15819ab4">_fixAES256Password</a>($this-&gt;encryptdata[<span class="stringliteral">&#39;owner_password&#39;</span>]);</div>
<div class="line"><a name="l10848"></a><span class="lineno">10848</span>&#160;                <span class="comment">// Compute U value</span></div>
<div class="line"><a name="l10849"></a><span class="lineno">10849</span>&#160;                $this-&gt;encryptdata[<span class="charliteral">&#39;U&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa486c0cad639e303d878b1f4b5ef772e">_Uvalue</a>();</div>
<div class="line"><a name="l10850"></a><span class="lineno">10850</span>&#160;                <span class="comment">// Compute UE value</span></div>
<div class="line"><a name="l10851"></a><span class="lineno">10851</span>&#160;                $this-&gt;encryptdata[<span class="stringliteral">&#39;UE&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a47524cc909428afea2ee2eb02a72130f">_UEvalue</a>();</div>
<div class="line"><a name="l10852"></a><span class="lineno">10852</span>&#160;                <span class="comment">// Compute O value</span></div>
<div class="line"><a name="l10853"></a><span class="lineno">10853</span>&#160;                $this-&gt;encryptdata[<span class="charliteral">&#39;O&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#abe60f253ebfc6088b3248e84ccf0a4fe">_Ovalue</a>();</div>
<div class="line"><a name="l10854"></a><span class="lineno">10854</span>&#160;                <span class="comment">// Compute OE value</span></div>
<div class="line"><a name="l10855"></a><span class="lineno">10855</span>&#160;                $this-&gt;encryptdata[<span class="stringliteral">&#39;OE&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a9d325db7b1243a5f1184b3c3365d588d">_OEvalue</a>();</div>
<div class="line"><a name="l10856"></a><span class="lineno">10856</span>&#160;                <span class="comment">// Compute P value</span></div>
<div class="line"><a name="l10857"></a><span class="lineno">10857</span>&#160;                $this-&gt;encryptdata[<span class="charliteral">&#39;P&#39;</span>] = $this-&gt;encryptdata[<span class="stringliteral">&#39;protection&#39;</span>];</div>
<div class="line"><a name="l10858"></a><span class="lineno">10858</span>&#160;                <span class="comment">// Computing the encryption dictionary&#39;s Perms (permissions) value</span></div>
<div class="line"><a name="l10859"></a><span class="lineno">10859</span>&#160;                $perms = TCPDF_STATIC::getEncPermissionsString($this-&gt;encryptdata[<span class="stringliteral">&#39;protection&#39;</span>]); <span class="comment">// bytes 0-3</span></div>
<div class="line"><a name="l10860"></a><span class="lineno">10860</span>&#160;                $perms .= chr(255).chr(255).chr(255).chr(255); <span class="comment">// bytes 4-7</span></div>
<div class="line"><a name="l10861"></a><span class="lineno">10861</span>&#160;                <span class="keywordflow">if</span> (isset($this-&gt;encryptdata[<span class="stringliteral">&#39;CF&#39;</span>][<span class="stringliteral">&#39;EncryptMetadata&#39;</span>]) AND (!$this-&gt;encryptdata[<span class="stringliteral">&#39;CF&#39;</span>][<span class="stringliteral">&#39;EncryptMetadata&#39;</span>])) { <span class="comment">// byte 8</span></div>
<div class="line"><a name="l10862"></a><span class="lineno">10862</span>&#160;                    $perms .= <span class="charliteral">&#39;F&#39;</span>;</div>
<div class="line"><a name="l10863"></a><span class="lineno">10863</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l10864"></a><span class="lineno">10864</span>&#160;                    $perms .= <span class="charliteral">&#39;T&#39;</span>;</div>
<div class="line"><a name="l10865"></a><span class="lineno">10865</span>&#160;                }</div>
<div class="line"><a name="l10866"></a><span class="lineno">10866</span>&#160;                $perms .= <span class="stringliteral">&#39;adb&#39;</span>; <span class="comment">// bytes 9-11</span></div>
<div class="line"><a name="l10867"></a><span class="lineno">10867</span>&#160;                $perms .= <span class="stringliteral">&#39;nick&#39;</span>; <span class="comment">// bytes 12-15</span></div>
<div class="line"><a name="l10868"></a><span class="lineno">10868</span>&#160;                $iv = str_repeat(<span class="stringliteral">&quot;\x00&quot;</span>, mcrypt_get_iv_size(MCRYPT_RIJNDAEL_128, MCRYPT_MODE_ECB));</div>
<div class="line"><a name="l10869"></a><span class="lineno">10869</span>&#160;                $this-&gt;encryptdata[<span class="stringliteral">&#39;perms&#39;</span>] = mcrypt_encrypt(MCRYPT_RIJNDAEL_128, $this-&gt;encryptdata[<span class="stringliteral">&#39;key&#39;</span>], $perms, MCRYPT_MODE_ECB, $iv);</div>
<div class="line"><a name="l10870"></a><span class="lineno">10870</span>&#160;            } <span class="keywordflow">else</span> { <span class="comment">// RC4-40, RC4-128, AES-128</span></div>
<div class="line"><a name="l10871"></a><span class="lineno">10871</span>&#160;                <span class="comment">// Pad passwords</span></div>
<div class="line"><a name="l10872"></a><span class="lineno">10872</span>&#160;                $this-&gt;encryptdata[<span class="stringliteral">&#39;user_password&#39;</span>] = substr($this-&gt;encryptdata[<span class="stringliteral">&#39;user_password&#39;</span>].TCPDF_STATIC::$enc_padding, 0, 32);</div>
<div class="line"><a name="l10873"></a><span class="lineno">10873</span>&#160;                $this-&gt;encryptdata[<span class="stringliteral">&#39;owner_password&#39;</span>] = substr($this-&gt;encryptdata[<span class="stringliteral">&#39;owner_password&#39;</span>].TCPDF_STATIC::$enc_padding, 0, 32);</div>
<div class="line"><a name="l10874"></a><span class="lineno">10874</span>&#160;                <span class="comment">// Compute O value</span></div>
<div class="line"><a name="l10875"></a><span class="lineno">10875</span>&#160;                $this-&gt;encryptdata[<span class="charliteral">&#39;O&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#abe60f253ebfc6088b3248e84ccf0a4fe">_Ovalue</a>();</div>
<div class="line"><a name="l10876"></a><span class="lineno">10876</span>&#160;                <span class="comment">// get default permissions (reverse byte order)</span></div>
<div class="line"><a name="l10877"></a><span class="lineno">10877</span>&#160;                $permissions = TCPDF_STATIC::getEncPermissionsString($this-&gt;encryptdata[<span class="stringliteral">&#39;protection&#39;</span>]);</div>
<div class="line"><a name="l10878"></a><span class="lineno">10878</span>&#160;                <span class="comment">// Compute encryption key</span></div>
<div class="line"><a name="l10879"></a><span class="lineno">10879</span>&#160;                $tmp = TCPDF_STATIC::_md5_16($this-&gt;encryptdata[<span class="stringliteral">&#39;user_password&#39;</span>].$this-&gt;encryptdata[<span class="charliteral">&#39;O&#39;</span>].$permissions.$this-&gt;encryptdata[<span class="stringliteral">&#39;fileid&#39;</span>]);</div>
<div class="line"><a name="l10880"></a><span class="lineno">10880</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;encryptdata[<span class="stringliteral">&#39;mode&#39;</span>] &gt; 0) {</div>
<div class="line"><a name="l10881"></a><span class="lineno">10881</span>&#160;                    <span class="keywordflow">for</span> ($i = 0; $i &lt; 50; ++$i) {</div>
<div class="line"><a name="l10882"></a><span class="lineno">10882</span>&#160;                        $tmp = TCPDF_STATIC::_md5_16(substr($tmp, 0, $keybytelen));</div>
<div class="line"><a name="l10883"></a><span class="lineno">10883</span>&#160;                    }</div>
<div class="line"><a name="l10884"></a><span class="lineno">10884</span>&#160;                }</div>
<div class="line"><a name="l10885"></a><span class="lineno">10885</span>&#160;                $this-&gt;encryptdata[<span class="stringliteral">&#39;key&#39;</span>] = substr($tmp, 0, $keybytelen);</div>
<div class="line"><a name="l10886"></a><span class="lineno">10886</span>&#160;                <span class="comment">// Compute U value</span></div>
<div class="line"><a name="l10887"></a><span class="lineno">10887</span>&#160;                $this-&gt;encryptdata[<span class="charliteral">&#39;U&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa486c0cad639e303d878b1f4b5ef772e">_Uvalue</a>();</div>
<div class="line"><a name="l10888"></a><span class="lineno">10888</span>&#160;                <span class="comment">// Compute P value</span></div>
<div class="line"><a name="l10889"></a><span class="lineno">10889</span>&#160;                $this-&gt;encryptdata[<span class="charliteral">&#39;P&#39;</span>] = $this-&gt;encryptdata[<span class="stringliteral">&#39;protection&#39;</span>];</div>
<div class="line"><a name="l10890"></a><span class="lineno">10890</span>&#160;            }</div>
<div class="line"><a name="l10891"></a><span class="lineno">10891</span>&#160;        } <span class="keywordflow">else</span> { <span class="comment">// Public-Key mode</span></div>
<div class="line"><a name="l10892"></a><span class="lineno">10892</span>&#160;            <span class="comment">// random 20-byte seed</span></div>
<div class="line"><a name="l10893"></a><span class="lineno">10893</span>&#160;            $seed = sha1(TCPDF_STATIC::getRandomSeed(), <span class="keyword">true</span>);</div>
<div class="line"><a name="l10894"></a><span class="lineno">10894</span>&#160;            $recipient_bytes = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l10895"></a><span class="lineno">10895</span>&#160;            <span class="keywordflow">foreach</span> ($this-&gt;encryptdata[<span class="stringliteral">&#39;pubkeys&#39;</span>] as $pubkey) {</div>
<div class="line"><a name="l10896"></a><span class="lineno">10896</span>&#160;                <span class="comment">// for each public certificate</span></div>
<div class="line"><a name="l10897"></a><span class="lineno">10897</span>&#160;                <span class="keywordflow">if</span> (isset($pubkey[<span class="charliteral">&#39;p&#39;</span>])) {</div>
<div class="line"><a name="l10898"></a><span class="lineno">10898</span>&#160;                    $pkprotection = TCPDF_STATIC::getUserPermissionCode($pubkey[<span class="charliteral">&#39;p&#39;</span>], $this-&gt;encryptdata[<span class="stringliteral">&#39;mode&#39;</span>]);</div>
<div class="line"><a name="l10899"></a><span class="lineno">10899</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l10900"></a><span class="lineno">10900</span>&#160;                    $pkprotection = $this-&gt;encryptdata[<span class="stringliteral">&#39;protection&#39;</span>];</div>
<div class="line"><a name="l10901"></a><span class="lineno">10901</span>&#160;                }</div>
<div class="line"><a name="l10902"></a><span class="lineno">10902</span>&#160;                <span class="comment">// get default permissions (reverse byte order)</span></div>
<div class="line"><a name="l10903"></a><span class="lineno">10903</span>&#160;                $pkpermissions = TCPDF_STATIC::getEncPermissionsString($pkprotection);</div>
<div class="line"><a name="l10904"></a><span class="lineno">10904</span>&#160;                <span class="comment">// envelope data</span></div>
<div class="line"><a name="l10905"></a><span class="lineno">10905</span>&#160;                $envelope = $seed.$pkpermissions;</div>
<div class="line"><a name="l10906"></a><span class="lineno">10906</span>&#160;                <span class="comment">// write the envelope data to a temporary file</span></div>
<div class="line"><a name="l10907"></a><span class="lineno">10907</span>&#160;                $tempkeyfile = TCPDF_STATIC::getObjFilename(<span class="stringliteral">&#39;key&#39;</span>);</div>
<div class="line"><a name="l10908"></a><span class="lineno">10908</span>&#160;                $f = fopen($tempkeyfile, <span class="stringliteral">&#39;wb&#39;</span>);</div>
<div class="line"><a name="l10909"></a><span class="lineno">10909</span>&#160;                <span class="keywordflow">if</span> (!$f) {</div>
<div class="line"><a name="l10910"></a><span class="lineno">10910</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;Unable to create temporary key file: &#39;</span>.$tempkeyfile);</div>
<div class="line"><a name="l10911"></a><span class="lineno">10911</span>&#160;                }</div>
<div class="line"><a name="l10912"></a><span class="lineno">10912</span>&#160;                $envelope_length = strlen($envelope);</div>
<div class="line"><a name="l10913"></a><span class="lineno">10913</span>&#160;                fwrite($f, $envelope, $envelope_length);</div>
<div class="line"><a name="l10914"></a><span class="lineno">10914</span>&#160;                fclose($f);</div>
<div class="line"><a name="l10915"></a><span class="lineno">10915</span>&#160;                $tempencfile = TCPDF_STATIC::getObjFilename(<span class="stringliteral">&#39;enc&#39;</span>);</div>
<div class="line"><a name="l10916"></a><span class="lineno">10916</span>&#160;                <span class="keywordflow">if</span> (!openssl_pkcs7_encrypt($tempkeyfile, $tempencfile, $pubkey[<span class="charliteral">&#39;c&#39;</span>], array(), PKCS7_BINARY | PKCS7_DETACHED)) {</div>
<div class="line"><a name="l10917"></a><span class="lineno">10917</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;Unable to encrypt the file: &#39;</span>.$tempkeyfile);</div>
<div class="line"><a name="l10918"></a><span class="lineno">10918</span>&#160;                }</div>
<div class="line"><a name="l10919"></a><span class="lineno">10919</span>&#160;                unlink($tempkeyfile);</div>
<div class="line"><a name="l10920"></a><span class="lineno">10920</span>&#160;                <span class="comment">// read encryption signature</span></div>
<div class="line"><a name="l10921"></a><span class="lineno">10921</span>&#160;                $signature = file_get_contents($tempencfile, <span class="keyword">false</span>, null, $envelope_length);</div>
<div class="line"><a name="l10922"></a><span class="lineno">10922</span>&#160;                unlink($tempencfile);</div>
<div class="line"><a name="l10923"></a><span class="lineno">10923</span>&#160;                <span class="comment">// extract signature</span></div>
<div class="line"><a name="l10924"></a><span class="lineno">10924</span>&#160;                $signature = substr($signature, strpos($signature, <span class="stringliteral">&#39;Content-Disposition&#39;</span>));</div>
<div class="line"><a name="l10925"></a><span class="lineno">10925</span>&#160;                $tmparr = explode(<span class="stringliteral">&quot;\n\n&quot;</span>, $signature);</div>
<div class="line"><a name="l10926"></a><span class="lineno">10926</span>&#160;                $signature = trim($tmparr[1]);</div>
<div class="line"><a name="l10927"></a><span class="lineno">10927</span>&#160;                unset($tmparr);</div>
<div class="line"><a name="l10928"></a><span class="lineno">10928</span>&#160;                <span class="comment">// decode signature</span></div>
<div class="line"><a name="l10929"></a><span class="lineno">10929</span>&#160;                $signature = base64_decode($signature);</div>
<div class="line"><a name="l10930"></a><span class="lineno">10930</span>&#160;                <span class="comment">// convert signature to hex</span></div>
<div class="line"><a name="l10931"></a><span class="lineno">10931</span>&#160;                $hexsignature = current(unpack(<span class="stringliteral">&#39;H*&#39;</span>, $signature));</div>
<div class="line"><a name="l10932"></a><span class="lineno">10932</span>&#160;                <span class="comment">// store signature on recipients array</span></div>
<div class="line"><a name="l10933"></a><span class="lineno">10933</span>&#160;                $this-&gt;encryptdata[<span class="stringliteral">&#39;Recipients&#39;</span>][] = $hexsignature;</div>
<div class="line"><a name="l10934"></a><span class="lineno">10934</span>&#160;                <span class="comment">// The bytes of each item in the Recipients array of PKCS#7 objects in the order in which they appear in the array</span></div>
<div class="line"><a name="l10935"></a><span class="lineno">10935</span>&#160;                $recipient_bytes .= $signature;</div>
<div class="line"><a name="l10936"></a><span class="lineno">10936</span>&#160;            }</div>
<div class="line"><a name="l10937"></a><span class="lineno">10937</span>&#160;            <span class="comment">// calculate encryption key</span></div>
<div class="line"><a name="l10938"></a><span class="lineno">10938</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;encryptdata[<span class="stringliteral">&#39;mode&#39;</span>] == 3) { <span class="comment">// AES-256</span></div>
<div class="line"><a name="l10939"></a><span class="lineno">10939</span>&#160;                $this-&gt;encryptdata[<span class="stringliteral">&#39;key&#39;</span>] = substr(hash(<span class="stringliteral">&#39;sha256&#39;</span>, $seed.$recipient_bytes, <span class="keyword">true</span>), 0, $keybytelen);</div>
<div class="line"><a name="l10940"></a><span class="lineno">10940</span>&#160;            } <span class="keywordflow">else</span> { <span class="comment">// RC4-40, RC4-128, AES-128</span></div>
<div class="line"><a name="l10941"></a><span class="lineno">10941</span>&#160;                $this-&gt;encryptdata[<span class="stringliteral">&#39;key&#39;</span>] = substr(sha1($seed.$recipient_bytes, <span class="keyword">true</span>), 0, $keybytelen);</div>
<div class="line"><a name="l10942"></a><span class="lineno">10942</span>&#160;            }</div>
<div class="line"><a name="l10943"></a><span class="lineno">10943</span>&#160;        }</div>
<div class="line"><a name="l10944"></a><span class="lineno">10944</span>&#160;    }</div>
<div class="line"><a name="l10945"></a><span class="lineno">10945</span>&#160;</div>
<div class="line"><a name="l10960"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a7ea250b2b4e3d7e55e657d52732a3b1d">10960</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a7ea250b2b4e3d7e55e657d52732a3b1d">SetProtection</a>($permissions=array(<span class="stringliteral">&#39;print&#39;</span>, <span class="stringliteral">&#39;modify&#39;</span>, <span class="stringliteral">&#39;copy&#39;</span>, <span class="stringliteral">&#39;annot-forms&#39;</span>, <span class="stringliteral">&#39;fill-forms&#39;</span>, <span class="stringliteral">&#39;extract&#39;</span>, <span class="stringliteral">&#39;assemble&#39;</span>, <span class="stringliteral">&#39;print-high&#39;</span>), $user_pass=<span class="stringliteral">&#39;&#39;</span>, $owner_pass=null, $mode=0, $pubkeys=null) {</div>
<div class="line"><a name="l10961"></a><span class="lineno">10961</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;pdfa_mode) {</div>
<div class="line"><a name="l10962"></a><span class="lineno">10962</span>&#160;            <span class="comment">// encryption is not allowed in PDF/A mode</span></div>
<div class="line"><a name="l10963"></a><span class="lineno">10963</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l10964"></a><span class="lineno">10964</span>&#160;        }</div>
<div class="line"><a name="l10965"></a><span class="lineno">10965</span>&#160;        $this-&gt;encryptdata[<span class="stringliteral">&#39;protection&#39;</span>] = TCPDF_STATIC::getUserPermissionCode($permissions, $mode);</div>
<div class="line"><a name="l10966"></a><span class="lineno">10966</span>&#160;        <span class="keywordflow">if</span> (($pubkeys !== null) AND (is_array($pubkeys))) {</div>
<div class="line"><a name="l10967"></a><span class="lineno">10967</span>&#160;            <span class="comment">// public-key mode</span></div>
<div class="line"><a name="l10968"></a><span class="lineno">10968</span>&#160;            $this-&gt;encryptdata[<span class="stringliteral">&#39;pubkeys&#39;</span>] = $pubkeys;</div>
<div class="line"><a name="l10969"></a><span class="lineno">10969</span>&#160;            <span class="keywordflow">if</span> ($mode == 0) {</div>
<div class="line"><a name="l10970"></a><span class="lineno">10970</span>&#160;                <span class="comment">// public-Key Security requires at least 128 bit</span></div>
<div class="line"><a name="l10971"></a><span class="lineno">10971</span>&#160;                $mode = 1;</div>
<div class="line"><a name="l10972"></a><span class="lineno">10972</span>&#160;            }</div>
<div class="line"><a name="l10973"></a><span class="lineno">10973</span>&#160;            <span class="keywordflow">if</span> (!function_exists(<span class="stringliteral">&#39;openssl_pkcs7_encrypt&#39;</span>)) {</div>
<div class="line"><a name="l10974"></a><span class="lineno">10974</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;Public-Key Security requires openssl library.&#39;</span>);</div>
<div class="line"><a name="l10975"></a><span class="lineno">10975</span>&#160;            }</div>
<div class="line"><a name="l10976"></a><span class="lineno">10976</span>&#160;            <span class="comment">// Set Public-Key filter (availabe are: Entrust.PPKEF, Adobe.PPKLite, Adobe.PubSec)</span></div>
<div class="line"><a name="l10977"></a><span class="lineno">10977</span>&#160;            $this-&gt;encryptdata[<span class="stringliteral">&#39;pubkey&#39;</span>] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l10978"></a><span class="lineno">10978</span>&#160;            $this-&gt;encryptdata[<span class="stringliteral">&#39;Filter&#39;</span>] = <span class="stringliteral">&#39;Adobe.PubSec&#39;</span>;</div>
<div class="line"><a name="l10979"></a><span class="lineno">10979</span>&#160;            $this-&gt;encryptdata[<span class="stringliteral">&#39;StmF&#39;</span>] = <span class="stringliteral">&#39;DefaultCryptFilter&#39;</span>;</div>
<div class="line"><a name="l10980"></a><span class="lineno">10980</span>&#160;            $this-&gt;encryptdata[<span class="stringliteral">&#39;StrF&#39;</span>] = <span class="stringliteral">&#39;DefaultCryptFilter&#39;</span>;</div>
<div class="line"><a name="l10981"></a><span class="lineno">10981</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l10982"></a><span class="lineno">10982</span>&#160;            <span class="comment">// standard mode (password mode)</span></div>
<div class="line"><a name="l10983"></a><span class="lineno">10983</span>&#160;            $this-&gt;encryptdata[<span class="stringliteral">&#39;pubkey&#39;</span>] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l10984"></a><span class="lineno">10984</span>&#160;            $this-&gt;encryptdata[<span class="stringliteral">&#39;Filter&#39;</span>] = <span class="stringliteral">&#39;Standard&#39;</span>;</div>
<div class="line"><a name="l10985"></a><span class="lineno">10985</span>&#160;            $this-&gt;encryptdata[<span class="stringliteral">&#39;StmF&#39;</span>] = <span class="stringliteral">&#39;StdCF&#39;</span>;</div>
<div class="line"><a name="l10986"></a><span class="lineno">10986</span>&#160;            $this-&gt;encryptdata[<span class="stringliteral">&#39;StrF&#39;</span>] = <span class="stringliteral">&#39;StdCF&#39;</span>;</div>
<div class="line"><a name="l10987"></a><span class="lineno">10987</span>&#160;        }</div>
<div class="line"><a name="l10988"></a><span class="lineno">10988</span>&#160;        <span class="keywordflow">if</span> ($mode &gt; 1) { <span class="comment">// AES</span></div>
<div class="line"><a name="l10989"></a><span class="lineno">10989</span>&#160;            <span class="keywordflow">if</span> (!extension_loaded(<span class="stringliteral">&#39;mcrypt&#39;</span>)) {</div>
<div class="line"><a name="l10990"></a><span class="lineno">10990</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;AES encryption requires mcrypt library (http://www.php.net/manual/en/mcrypt.requirements.php).&#39;</span>);</div>
<div class="line"><a name="l10991"></a><span class="lineno">10991</span>&#160;            }</div>
<div class="line"><a name="l10992"></a><span class="lineno">10992</span>&#160;            <span class="keywordflow">if</span> (mcrypt_get_cipher_name(MCRYPT_RIJNDAEL_128) === <span class="keyword">false</span>) {</div>
<div class="line"><a name="l10993"></a><span class="lineno">10993</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;AES encryption requires MCRYPT_RIJNDAEL_128 cypher.&#39;</span>);</div>
<div class="line"><a name="l10994"></a><span class="lineno">10994</span>&#160;            }</div>
<div class="line"><a name="l10995"></a><span class="lineno">10995</span>&#160;            <span class="keywordflow">if</span> (($mode == 3) AND !function_exists(<span class="stringliteral">&#39;hash&#39;</span>)) {</div>
<div class="line"><a name="l10996"></a><span class="lineno">10996</span>&#160;                <span class="comment">// the Hash extension requires no external libraries and is enabled by default as of PHP 5.1.2.</span></div>
<div class="line"><a name="l10997"></a><span class="lineno">10997</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;AES 256 encryption requires HASH Message Digest Framework (http://www.php.net/manual/en/book.hash.php).&#39;</span>);</div>
<div class="line"><a name="l10998"></a><span class="lineno">10998</span>&#160;            }</div>
<div class="line"><a name="l10999"></a><span class="lineno">10999</span>&#160;        }</div>
<div class="line"><a name="l11000"></a><span class="lineno">11000</span>&#160;        <span class="keywordflow">if</span> ($owner_pass === null) {</div>
<div class="line"><a name="l11001"></a><span class="lineno">11001</span>&#160;            $owner_pass = md5(TCPDF_STATIC::getRandomSeed());</div>
<div class="line"><a name="l11002"></a><span class="lineno">11002</span>&#160;        }</div>
<div class="line"><a name="l11003"></a><span class="lineno">11003</span>&#160;        $this-&gt;encryptdata[<span class="stringliteral">&#39;user_password&#39;</span>] = $user_pass;</div>
<div class="line"><a name="l11004"></a><span class="lineno">11004</span>&#160;        $this-&gt;encryptdata[<span class="stringliteral">&#39;owner_password&#39;</span>] = $owner_pass;</div>
<div class="line"><a name="l11005"></a><span class="lineno">11005</span>&#160;        $this-&gt;encryptdata[<span class="stringliteral">&#39;mode&#39;</span>] = $mode;</div>
<div class="line"><a name="l11006"></a><span class="lineno">11006</span>&#160;        <span class="keywordflow">switch</span> ($mode) {</div>
<div class="line"><a name="l11007"></a><span class="lineno">11007</span>&#160;            <span class="keywordflow">case</span> 0: { <span class="comment">// RC4 40 bit</span></div>
<div class="line"><a name="l11008"></a><span class="lineno">11008</span>&#160;                $this-&gt;encryptdata[<span class="charliteral">&#39;V&#39;</span>] = 1;</div>
<div class="line"><a name="l11009"></a><span class="lineno">11009</span>&#160;                $this-&gt;encryptdata[<span class="stringliteral">&#39;Length&#39;</span>] = 40;</div>
<div class="line"><a name="l11010"></a><span class="lineno">11010</span>&#160;                $this-&gt;encryptdata[<span class="stringliteral">&#39;CF&#39;</span>][<span class="stringliteral">&#39;CFM&#39;</span>] = <span class="stringliteral">&#39;V2&#39;</span>;</div>
<div class="line"><a name="l11011"></a><span class="lineno">11011</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l11012"></a><span class="lineno">11012</span>&#160;            }</div>
<div class="line"><a name="l11013"></a><span class="lineno">11013</span>&#160;            <span class="keywordflow">case</span> 1: { <span class="comment">// RC4 128 bit</span></div>
<div class="line"><a name="l11014"></a><span class="lineno">11014</span>&#160;                $this-&gt;encryptdata[<span class="charliteral">&#39;V&#39;</span>] = 2;</div>
<div class="line"><a name="l11015"></a><span class="lineno">11015</span>&#160;                $this-&gt;encryptdata[<span class="stringliteral">&#39;Length&#39;</span>] = 128;</div>
<div class="line"><a name="l11016"></a><span class="lineno">11016</span>&#160;                $this-&gt;encryptdata[<span class="stringliteral">&#39;CF&#39;</span>][<span class="stringliteral">&#39;CFM&#39;</span>] = <span class="stringliteral">&#39;V2&#39;</span>;</div>
<div class="line"><a name="l11017"></a><span class="lineno">11017</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;encryptdata[<span class="stringliteral">&#39;pubkey&#39;</span>]) {</div>
<div class="line"><a name="l11018"></a><span class="lineno">11018</span>&#160;                    $this-&gt;encryptdata[<span class="stringliteral">&#39;SubFilter&#39;</span>] = <span class="stringliteral">&#39;adbe.pkcs7.s4&#39;</span>;</div>
<div class="line"><a name="l11019"></a><span class="lineno">11019</span>&#160;                    $this-&gt;encryptdata[<span class="stringliteral">&#39;Recipients&#39;</span>] = array();</div>
<div class="line"><a name="l11020"></a><span class="lineno">11020</span>&#160;                }</div>
<div class="line"><a name="l11021"></a><span class="lineno">11021</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l11022"></a><span class="lineno">11022</span>&#160;            }</div>
<div class="line"><a name="l11023"></a><span class="lineno">11023</span>&#160;            <span class="keywordflow">case</span> 2: { <span class="comment">// AES 128 bit</span></div>
<div class="line"><a name="l11024"></a><span class="lineno">11024</span>&#160;                $this-&gt;encryptdata[<span class="charliteral">&#39;V&#39;</span>] = 4;</div>
<div class="line"><a name="l11025"></a><span class="lineno">11025</span>&#160;                $this-&gt;encryptdata[<span class="stringliteral">&#39;Length&#39;</span>] = 128;</div>
<div class="line"><a name="l11026"></a><span class="lineno">11026</span>&#160;                $this-&gt;encryptdata[<span class="stringliteral">&#39;CF&#39;</span>][<span class="stringliteral">&#39;CFM&#39;</span>] = <span class="stringliteral">&#39;AESV2&#39;</span>;</div>
<div class="line"><a name="l11027"></a><span class="lineno">11027</span>&#160;                $this-&gt;encryptdata[<span class="stringliteral">&#39;CF&#39;</span>][<span class="stringliteral">&#39;Length&#39;</span>] = 128;</div>
<div class="line"><a name="l11028"></a><span class="lineno">11028</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;encryptdata[<span class="stringliteral">&#39;pubkey&#39;</span>]) {</div>
<div class="line"><a name="l11029"></a><span class="lineno">11029</span>&#160;                    $this-&gt;encryptdata[<span class="stringliteral">&#39;SubFilter&#39;</span>] = <span class="stringliteral">&#39;adbe.pkcs7.s5&#39;</span>;</div>
<div class="line"><a name="l11030"></a><span class="lineno">11030</span>&#160;                    $this-&gt;encryptdata[<span class="stringliteral">&#39;Recipients&#39;</span>] = array();</div>
<div class="line"><a name="l11031"></a><span class="lineno">11031</span>&#160;                }</div>
<div class="line"><a name="l11032"></a><span class="lineno">11032</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l11033"></a><span class="lineno">11033</span>&#160;            }</div>
<div class="line"><a name="l11034"></a><span class="lineno">11034</span>&#160;            <span class="keywordflow">case</span> 3: { <span class="comment">// AES 256 bit</span></div>
<div class="line"><a name="l11035"></a><span class="lineno">11035</span>&#160;                $this-&gt;encryptdata[<span class="charliteral">&#39;V&#39;</span>] = 5;</div>
<div class="line"><a name="l11036"></a><span class="lineno">11036</span>&#160;                $this-&gt;encryptdata[<span class="stringliteral">&#39;Length&#39;</span>] = 256;</div>
<div class="line"><a name="l11037"></a><span class="lineno">11037</span>&#160;                $this-&gt;encryptdata[<span class="stringliteral">&#39;CF&#39;</span>][<span class="stringliteral">&#39;CFM&#39;</span>] = <span class="stringliteral">&#39;AESV3&#39;</span>;</div>
<div class="line"><a name="l11038"></a><span class="lineno">11038</span>&#160;                $this-&gt;encryptdata[<span class="stringliteral">&#39;CF&#39;</span>][<span class="stringliteral">&#39;Length&#39;</span>] = 256;</div>
<div class="line"><a name="l11039"></a><span class="lineno">11039</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;encryptdata[<span class="stringliteral">&#39;pubkey&#39;</span>]) {</div>
<div class="line"><a name="l11040"></a><span class="lineno">11040</span>&#160;                    $this-&gt;encryptdata[<span class="stringliteral">&#39;SubFilter&#39;</span>] = <span class="stringliteral">&#39;adbe.pkcs7.s5&#39;</span>;</div>
<div class="line"><a name="l11041"></a><span class="lineno">11041</span>&#160;                    $this-&gt;encryptdata[<span class="stringliteral">&#39;Recipients&#39;</span>] = array();</div>
<div class="line"><a name="l11042"></a><span class="lineno">11042</span>&#160;                }</div>
<div class="line"><a name="l11043"></a><span class="lineno">11043</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l11044"></a><span class="lineno">11044</span>&#160;            }</div>
<div class="line"><a name="l11045"></a><span class="lineno">11045</span>&#160;        }</div>
<div class="line"><a name="l11046"></a><span class="lineno">11046</span>&#160;        $this-&gt;encrypted = <span class="keyword">true</span>;</div>
<div class="line"><a name="l11047"></a><span class="lineno">11047</span>&#160;        $this-&gt;encryptdata[<span class="stringliteral">&#39;fileid&#39;</span>] = TCPDF_STATIC::convertHexStringToString($this-&gt;file_id);</div>
<div class="line"><a name="l11048"></a><span class="lineno">11048</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aebcb9fe17da560731acc6c5329366c52">_generateencryptionkey</a>();</div>
<div class="line"><a name="l11049"></a><span class="lineno">11049</span>&#160;    }</div>
<div class="line"><a name="l11050"></a><span class="lineno">11050</span>&#160;</div>
<div class="line"><a name="l11051"></a><span class="lineno">11051</span>&#160;    <span class="comment">// END OF ENCRYPTION FUNCTIONS -------------------------</span></div>
<div class="line"><a name="l11052"></a><span class="lineno">11052</span>&#160;</div>
<div class="line"><a name="l11053"></a><span class="lineno">11053</span>&#160;    <span class="comment">// START TRANSFORMATIONS SECTION -----------------------</span></div>
<div class="line"><a name="l11054"></a><span class="lineno">11054</span>&#160;</div>
<div class="line"><a name="l11063"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aa07b31137128fee6f4d505cb1e7052ec">11063</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#aa07b31137128fee6f4d505cb1e7052ec">StartTransform</a>() {</div>
<div class="line"><a name="l11064"></a><span class="lineno">11064</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;state != 2) {</div>
<div class="line"><a name="l11065"></a><span class="lineno">11065</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l11066"></a><span class="lineno">11066</span>&#160;        }</div>
<div class="line"><a name="l11067"></a><span class="lineno">11067</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa316f47dbdd13a6dd2897d6be347cbbb">_outSaveGraphicsState</a>();</div>
<div class="line"><a name="l11068"></a><span class="lineno">11068</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;inxobj) {</div>
<div class="line"><a name="l11069"></a><span class="lineno">11069</span>&#160;            <span class="comment">// we are inside an XObject template</span></div>
<div class="line"><a name="l11070"></a><span class="lineno">11070</span>&#160;            $this-&gt;xobjects[<a class="code" href="../../d4/d40/classTCPDF.html#abe4390b4e1939e10c9b61a986adfc117">$this-&gt;xobjid</a>][<span class="stringliteral">&#39;transfmrk&#39;</span>][] = strlen($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;outdata&#39;</span>]);</div>
<div class="line"><a name="l11071"></a><span class="lineno">11071</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l11072"></a><span class="lineno">11072</span>&#160;            $this-&gt;transfmrk[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][] = $this-&gt;pagelen[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>];</div>
<div class="line"><a name="l11073"></a><span class="lineno">11073</span>&#160;        }</div>
<div class="line"><a name="l11074"></a><span class="lineno">11074</span>&#160;        ++<a class="code" href="../../d4/d40/classTCPDF.html#af166f060da54f13a6d9871160284cc30">$this-&gt;transfmatrix_key</a>;</div>
<div class="line"><a name="l11075"></a><span class="lineno">11075</span>&#160;        $this-&gt;transfmatrix[<a class="code" href="../../d4/d40/classTCPDF.html#af166f060da54f13a6d9871160284cc30">$this-&gt;transfmatrix_key</a>] = array();</div>
<div class="line"><a name="l11076"></a><span class="lineno">11076</span>&#160;    }</div>
<div class="line"><a name="l11077"></a><span class="lineno">11077</span>&#160;</div>
<div class="line"><a name="l11086"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a26529ccdd9f9ec9d0ea0c40980776760">11086</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a26529ccdd9f9ec9d0ea0c40980776760">StopTransform</a>() {</div>
<div class="line"><a name="l11087"></a><span class="lineno">11087</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;state != 2) {</div>
<div class="line"><a name="l11088"></a><span class="lineno">11088</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l11089"></a><span class="lineno">11089</span>&#160;        }</div>
<div class="line"><a name="l11090"></a><span class="lineno">11090</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af623eface3ce63b2bc1709d47c84ab69">_outRestoreGraphicsState</a>();</div>
<div class="line"><a name="l11091"></a><span class="lineno">11091</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;transfmatrix[$this-&gt;transfmatrix_key])) {</div>
<div class="line"><a name="l11092"></a><span class="lineno">11092</span>&#160;            array_pop($this-&gt;transfmatrix[$this-&gt;transfmatrix_key]);</div>
<div class="line"><a name="l11093"></a><span class="lineno">11093</span>&#160;            --<a class="code" href="../../d4/d40/classTCPDF.html#af166f060da54f13a6d9871160284cc30">$this-&gt;transfmatrix_key</a>;</div>
<div class="line"><a name="l11094"></a><span class="lineno">11094</span>&#160;        }</div>
<div class="line"><a name="l11095"></a><span class="lineno">11095</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;inxobj) {</div>
<div class="line"><a name="l11096"></a><span class="lineno">11096</span>&#160;            <span class="comment">// we are inside an XObject template</span></div>
<div class="line"><a name="l11097"></a><span class="lineno">11097</span>&#160;            array_pop($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;transfmrk&#39;</span>]);</div>
<div class="line"><a name="l11098"></a><span class="lineno">11098</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l11099"></a><span class="lineno">11099</span>&#160;            array_pop($this-&gt;transfmrk[$this-&gt;page]);</div>
<div class="line"><a name="l11100"></a><span class="lineno">11100</span>&#160;        }</div>
<div class="line"><a name="l11101"></a><span class="lineno">11101</span>&#160;    }</div>
<div class="line"><a name="l11111"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ad80a884a2336e06f2f8ed9b8c31d11c9">11111</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ad80a884a2336e06f2f8ed9b8c31d11c9">ScaleX</a>($s_x, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l11112"></a><span class="lineno">11112</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a5a55ff5ef0a33fcd4b8b4f924f576020">Scale</a>($s_x, 100, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>);</div>
<div class="line"><a name="l11113"></a><span class="lineno">11113</span>&#160;    }</div>
<div class="line"><a name="l11114"></a><span class="lineno">11114</span>&#160;</div>
<div class="line"><a name="l11124"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a21df9dfbc3a918515ba028dd26063956">11124</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a21df9dfbc3a918515ba028dd26063956">ScaleY</a>($s_y, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l11125"></a><span class="lineno">11125</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a5a55ff5ef0a33fcd4b8b4f924f576020">Scale</a>(100, $s_y, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>);</div>
<div class="line"><a name="l11126"></a><span class="lineno">11126</span>&#160;    }</div>
<div class="line"><a name="l11127"></a><span class="lineno">11127</span>&#160;</div>
<div class="line"><a name="l11137"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a765be81c830574535ed8cb33f0ad2065">11137</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a765be81c830574535ed8cb33f0ad2065">ScaleXY</a>($s, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l11138"></a><span class="lineno">11138</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a5a55ff5ef0a33fcd4b8b4f924f576020">Scale</a>($s, $s, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>);</div>
<div class="line"><a name="l11139"></a><span class="lineno">11139</span>&#160;    }</div>
<div class="line"><a name="l11140"></a><span class="lineno">11140</span>&#160;</div>
<div class="line"><a name="l11151"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a5a55ff5ef0a33fcd4b8b4f924f576020">11151</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a5a55ff5ef0a33fcd4b8b4f924f576020">Scale</a>($s_x, $s_y, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l11152"></a><span class="lineno">11152</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> === <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l11153"></a><span class="lineno">11153</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$this-&gt;x</a>;</div>
<div class="line"><a name="l11154"></a><span class="lineno">11154</span>&#160;        }</div>
<div class="line"><a name="l11155"></a><span class="lineno">11155</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> === <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l11156"></a><span class="lineno">11156</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l11157"></a><span class="lineno">11157</span>&#160;        }</div>
<div class="line"><a name="l11158"></a><span class="lineno">11158</span>&#160;        <span class="keywordflow">if</span> (($s_x == 0) OR ($s_y == 0)) {</div>
<div class="line"><a name="l11159"></a><span class="lineno">11159</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;Please do not use values equal to zero for scaling&#39;</span>);</div>
<div class="line"><a name="l11160"></a><span class="lineno">11160</span>&#160;        }</div>
<div class="line"><a name="l11161"></a><span class="lineno">11161</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> = ($this-&gt;h - <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>) * $this-&gt;k;</div>
<div class="line"><a name="l11162"></a><span class="lineno">11162</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> *= <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>;</div>
<div class="line"><a name="l11163"></a><span class="lineno">11163</span>&#160;        <span class="comment">//calculate elements of transformation matrix</span></div>
<div class="line"><a name="l11164"></a><span class="lineno">11164</span>&#160;        $s_x /= 100;</div>
<div class="line"><a name="l11165"></a><span class="lineno">11165</span>&#160;        $s_y /= 100;</div>
<div class="line"><a name="l11166"></a><span class="lineno">11166</span>&#160;        $tm = array();</div>
<div class="line"><a name="l11167"></a><span class="lineno">11167</span>&#160;        $tm[0] = $s_x;</div>
<div class="line"><a name="l11168"></a><span class="lineno">11168</span>&#160;        $tm[1] = 0;</div>
<div class="line"><a name="l11169"></a><span class="lineno">11169</span>&#160;        $tm[2] = 0;</div>
<div class="line"><a name="l11170"></a><span class="lineno">11170</span>&#160;        $tm[3] = $s_y;</div>
<div class="line"><a name="l11171"></a><span class="lineno">11171</span>&#160;        $tm[4] = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> * (1 - $s_x);</div>
<div class="line"><a name="l11172"></a><span class="lineno">11172</span>&#160;        $tm[5] = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> * (1 - $s_y);</div>
<div class="line"><a name="l11173"></a><span class="lineno">11173</span>&#160;        <span class="comment">//scale the coordinate system</span></div>
<div class="line"><a name="l11174"></a><span class="lineno">11174</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a647e9da3d08df82049ad403508fe247b">Transform</a>($tm);</div>
<div class="line"><a name="l11175"></a><span class="lineno">11175</span>&#160;    }</div>
<div class="line"><a name="l11176"></a><span class="lineno">11176</span>&#160;</div>
<div class="line"><a name="l11184"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a4b01dfbc5e4e8453f3fce47026a264f2">11184</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a4b01dfbc5e4e8453f3fce47026a264f2">MirrorH</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l11185"></a><span class="lineno">11185</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a5a55ff5ef0a33fcd4b8b4f924f576020">Scale</a>(-100, 100, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>);</div>
<div class="line"><a name="l11186"></a><span class="lineno">11186</span>&#160;    }</div>
<div class="line"><a name="l11187"></a><span class="lineno">11187</span>&#160;</div>
<div class="line"><a name="l11195"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a06342f489c3f60c456c95a825217629b">11195</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a06342f489c3f60c456c95a825217629b">MirrorV</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l11196"></a><span class="lineno">11196</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a5a55ff5ef0a33fcd4b8b4f924f576020">Scale</a>(100, -100, <span class="stringliteral">&#39;&#39;</span>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>);</div>
<div class="line"><a name="l11197"></a><span class="lineno">11197</span>&#160;    }</div>
<div class="line"><a name="l11198"></a><span class="lineno">11198</span>&#160;</div>
<div class="line"><a name="l11207"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aa41b8f844cab4dccdfa5f34cb667c46a">11207</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#aa41b8f844cab4dccdfa5f34cb667c46a">MirrorP</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>=<span class="stringliteral">&#39;&#39;</span>,<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l11208"></a><span class="lineno">11208</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a5a55ff5ef0a33fcd4b8b4f924f576020">Scale</a>(-100, -100, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>);</div>
<div class="line"><a name="l11209"></a><span class="lineno">11209</span>&#160;    }</div>
<div class="line"><a name="l11210"></a><span class="lineno">11210</span>&#160;</div>
<div class="line"><a name="l11220"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ad19f623e09f67dd7fbd433196f804ec1">11220</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ad19f623e09f67dd7fbd433196f804ec1">MirrorL</a>($angle=0, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>=<span class="stringliteral">&#39;&#39;</span>,<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l11221"></a><span class="lineno">11221</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a5a55ff5ef0a33fcd4b8b4f924f576020">Scale</a>(-100, 100, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>);</div>
<div class="line"><a name="l11222"></a><span class="lineno">11222</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aef1e19d18b0a82b1c45b53d3f17ae2b5">Rotate</a>(-2*($angle-90), <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>);</div>
<div class="line"><a name="l11223"></a><span class="lineno">11223</span>&#160;    }</div>
<div class="line"><a name="l11224"></a><span class="lineno">11224</span>&#160;</div>
<div class="line"><a name="l11232"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a215c81355915eff7d0c1586013591b75">11232</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a215c81355915eff7d0c1586013591b75">TranslateX</a>($t_x) {</div>
<div class="line"><a name="l11233"></a><span class="lineno">11233</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a458fb5ffaa345608b1346a38fdbbb096">Translate</a>($t_x, 0);</div>
<div class="line"><a name="l11234"></a><span class="lineno">11234</span>&#160;    }</div>
<div class="line"><a name="l11235"></a><span class="lineno">11235</span>&#160;</div>
<div class="line"><a name="l11243"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aa853a06ba07b77833755b83194f1fb1e">11243</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#aa853a06ba07b77833755b83194f1fb1e">TranslateY</a>($t_y) {</div>
<div class="line"><a name="l11244"></a><span class="lineno">11244</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a458fb5ffaa345608b1346a38fdbbb096">Translate</a>(0, $t_y);</div>
<div class="line"><a name="l11245"></a><span class="lineno">11245</span>&#160;    }</div>
<div class="line"><a name="l11246"></a><span class="lineno">11246</span>&#160;</div>
<div class="line"><a name="l11255"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a458fb5ffaa345608b1346a38fdbbb096">11255</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a458fb5ffaa345608b1346a38fdbbb096">Translate</a>($t_x, $t_y) {</div>
<div class="line"><a name="l11256"></a><span class="lineno">11256</span>&#160;        <span class="comment">//calculate elements of transformation matrix</span></div>
<div class="line"><a name="l11257"></a><span class="lineno">11257</span>&#160;        $tm = array();</div>
<div class="line"><a name="l11258"></a><span class="lineno">11258</span>&#160;        $tm[0] = 1;</div>
<div class="line"><a name="l11259"></a><span class="lineno">11259</span>&#160;        $tm[1] = 0;</div>
<div class="line"><a name="l11260"></a><span class="lineno">11260</span>&#160;        $tm[2] = 0;</div>
<div class="line"><a name="l11261"></a><span class="lineno">11261</span>&#160;        $tm[3] = 1;</div>
<div class="line"><a name="l11262"></a><span class="lineno">11262</span>&#160;        $tm[4] = $t_x * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>;</div>
<div class="line"><a name="l11263"></a><span class="lineno">11263</span>&#160;        $tm[5] = -$t_y * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>;</div>
<div class="line"><a name="l11264"></a><span class="lineno">11264</span>&#160;        <span class="comment">//translate the coordinate system</span></div>
<div class="line"><a name="l11265"></a><span class="lineno">11265</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a647e9da3d08df82049ad403508fe247b">Transform</a>($tm);</div>
<div class="line"><a name="l11266"></a><span class="lineno">11266</span>&#160;    }</div>
<div class="line"><a name="l11267"></a><span class="lineno">11267</span>&#160;</div>
<div class="line"><a name="l11277"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aef1e19d18b0a82b1c45b53d3f17ae2b5">11277</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#aef1e19d18b0a82b1c45b53d3f17ae2b5">Rotate</a>($angle, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l11278"></a><span class="lineno">11278</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> === <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l11279"></a><span class="lineno">11279</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$this-&gt;x</a>;</div>
<div class="line"><a name="l11280"></a><span class="lineno">11280</span>&#160;        }</div>
<div class="line"><a name="l11281"></a><span class="lineno">11281</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> === <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l11282"></a><span class="lineno">11282</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l11283"></a><span class="lineno">11283</span>&#160;        }</div>
<div class="line"><a name="l11284"></a><span class="lineno">11284</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> = ($this-&gt;h - <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>) * $this-&gt;k;</div>
<div class="line"><a name="l11285"></a><span class="lineno">11285</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> *= <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>;</div>
<div class="line"><a name="l11286"></a><span class="lineno">11286</span>&#160;        <span class="comment">//calculate elements of transformation matrix</span></div>
<div class="line"><a name="l11287"></a><span class="lineno">11287</span>&#160;        $tm = array();</div>
<div class="line"><a name="l11288"></a><span class="lineno">11288</span>&#160;        $tm[0] = cos(deg2rad($angle));</div>
<div class="line"><a name="l11289"></a><span class="lineno">11289</span>&#160;        $tm[1] = sin(deg2rad($angle));</div>
<div class="line"><a name="l11290"></a><span class="lineno">11290</span>&#160;        $tm[2] = -$tm[1];</div>
<div class="line"><a name="l11291"></a><span class="lineno">11291</span>&#160;        $tm[3] = $tm[0];</div>
<div class="line"><a name="l11292"></a><span class="lineno">11292</span>&#160;        $tm[4] = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> + ($tm[1] * <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>) - ($tm[0] * <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>);</div>
<div class="line"><a name="l11293"></a><span class="lineno">11293</span>&#160;        $tm[5] = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> - ($tm[0] * <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>) - ($tm[1] * $x);</div>
<div class="line"><a name="l11294"></a><span class="lineno">11294</span>&#160;        <span class="comment">//rotate the coordinate system around ($x,$y)</span></div>
<div class="line"><a name="l11295"></a><span class="lineno">11295</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a647e9da3d08df82049ad403508fe247b">Transform</a>($tm);</div>
<div class="line"><a name="l11296"></a><span class="lineno">11296</span>&#160;    }</div>
<div class="line"><a name="l11297"></a><span class="lineno">11297</span>&#160;</div>
<div class="line"><a name="l11307"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#abb40c80af416b4d177860872f5b27758">11307</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#abb40c80af416b4d177860872f5b27758">SkewX</a>($angle_x, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l11308"></a><span class="lineno">11308</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a979b6d066b2a0a5cc1496907bc9841e6">Skew</a>($angle_x, 0, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>);</div>
<div class="line"><a name="l11309"></a><span class="lineno">11309</span>&#160;    }</div>
<div class="line"><a name="l11310"></a><span class="lineno">11310</span>&#160;</div>
<div class="line"><a name="l11320"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a6563f6f3fb785efb230ee37719cf76f9">11320</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a6563f6f3fb785efb230ee37719cf76f9">SkewY</a>($angle_y, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l11321"></a><span class="lineno">11321</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a979b6d066b2a0a5cc1496907bc9841e6">Skew</a>(0, $angle_y, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>);</div>
<div class="line"><a name="l11322"></a><span class="lineno">11322</span>&#160;    }</div>
<div class="line"><a name="l11323"></a><span class="lineno">11323</span>&#160;</div>
<div class="line"><a name="l11334"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a979b6d066b2a0a5cc1496907bc9841e6">11334</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a979b6d066b2a0a5cc1496907bc9841e6">Skew</a>($angle_x, $angle_y, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l11335"></a><span class="lineno">11335</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> === <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l11336"></a><span class="lineno">11336</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$this-&gt;x</a>;</div>
<div class="line"><a name="l11337"></a><span class="lineno">11337</span>&#160;        }</div>
<div class="line"><a name="l11338"></a><span class="lineno">11338</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> === <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l11339"></a><span class="lineno">11339</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l11340"></a><span class="lineno">11340</span>&#160;        }</div>
<div class="line"><a name="l11341"></a><span class="lineno">11341</span>&#160;        <span class="keywordflow">if</span> (($angle_x &lt;= -90) OR ($angle_x &gt;= 90) OR ($angle_y &lt;= -90) OR ($angle_y &gt;= 90)) {</div>
<div class="line"><a name="l11342"></a><span class="lineno">11342</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;Please use values between -90 and +90 degrees for Skewing.&#39;</span>);</div>
<div class="line"><a name="l11343"></a><span class="lineno">11343</span>&#160;        }</div>
<div class="line"><a name="l11344"></a><span class="lineno">11344</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> *= <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>;</div>
<div class="line"><a name="l11345"></a><span class="lineno">11345</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> = ($this-&gt;h - <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>) * $this-&gt;k;</div>
<div class="line"><a name="l11346"></a><span class="lineno">11346</span>&#160;        <span class="comment">//calculate elements of transformation matrix</span></div>
<div class="line"><a name="l11347"></a><span class="lineno">11347</span>&#160;        $tm = array();</div>
<div class="line"><a name="l11348"></a><span class="lineno">11348</span>&#160;        $tm[0] = 1;</div>
<div class="line"><a name="l11349"></a><span class="lineno">11349</span>&#160;        $tm[1] = tan(deg2rad($angle_y));</div>
<div class="line"><a name="l11350"></a><span class="lineno">11350</span>&#160;        $tm[2] = tan(deg2rad($angle_x));</div>
<div class="line"><a name="l11351"></a><span class="lineno">11351</span>&#160;        $tm[3] = 1;</div>
<div class="line"><a name="l11352"></a><span class="lineno">11352</span>&#160;        $tm[4] = -$tm[2] * <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>;</div>
<div class="line"><a name="l11353"></a><span class="lineno">11353</span>&#160;        $tm[5] = -$tm[1] * <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>;</div>
<div class="line"><a name="l11354"></a><span class="lineno">11354</span>&#160;        <span class="comment">//skew the coordinate system</span></div>
<div class="line"><a name="l11355"></a><span class="lineno">11355</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a647e9da3d08df82049ad403508fe247b">Transform</a>($tm);</div>
<div class="line"><a name="l11356"></a><span class="lineno">11356</span>&#160;    }</div>
<div class="line"><a name="l11357"></a><span class="lineno">11357</span>&#160;</div>
<div class="line"><a name="l11365"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a647e9da3d08df82049ad403508fe247b">11365</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a647e9da3d08df82049ad403508fe247b">Transform</a>($tm) {</div>
<div class="line"><a name="l11366"></a><span class="lineno">11366</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;state != 2) {</div>
<div class="line"><a name="l11367"></a><span class="lineno">11367</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l11368"></a><span class="lineno">11368</span>&#160;        }</div>
<div class="line"><a name="l11369"></a><span class="lineno">11369</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(sprintf(<span class="stringliteral">&#39;%F %F %F %F %F %F cm&#39;</span>, $tm[0], $tm[1], $tm[2], $tm[3], $tm[4], $tm[5]));</div>
<div class="line"><a name="l11370"></a><span class="lineno">11370</span>&#160;        <span class="comment">// add tranformation matrix</span></div>
<div class="line"><a name="l11371"></a><span class="lineno">11371</span>&#160;        $this-&gt;transfmatrix[<a class="code" href="../../d4/d40/classTCPDF.html#af166f060da54f13a6d9871160284cc30">$this-&gt;transfmatrix_key</a>][] = array(<span class="charliteral">&#39;a&#39;</span> =&gt; $tm[0], <span class="charliteral">&#39;b&#39;</span> =&gt; $tm[1], <span class="charliteral">&#39;c&#39;</span> =&gt; $tm[2], <span class="charliteral">&#39;d&#39;</span> =&gt; $tm[3], <span class="charliteral">&#39;e&#39;</span> =&gt; $tm[4], <span class="charliteral">&#39;f&#39;</span> =&gt; $tm[5]);</div>
<div class="line"><a name="l11372"></a><span class="lineno">11372</span>&#160;        <span class="comment">// update transformation mark</span></div>
<div class="line"><a name="l11373"></a><span class="lineno">11373</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;inxobj) {</div>
<div class="line"><a name="l11374"></a><span class="lineno">11374</span>&#160;            <span class="comment">// we are inside an XObject template</span></div>
<div class="line"><a name="l11375"></a><span class="lineno">11375</span>&#160;            <span class="keywordflow">if</span> (end($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;transfmrk&#39;</span>]) !== <span class="keyword">false</span>) {</div>
<div class="line"><a name="l11376"></a><span class="lineno">11376</span>&#160;                $key = key($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;transfmrk&#39;</span>]);</div>
<div class="line"><a name="l11377"></a><span class="lineno">11377</span>&#160;                $this-&gt;xobjects[<a class="code" href="../../d4/d40/classTCPDF.html#abe4390b4e1939e10c9b61a986adfc117">$this-&gt;xobjid</a>][<span class="stringliteral">&#39;transfmrk&#39;</span>][$key] = strlen($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;outdata&#39;</span>]);</div>
<div class="line"><a name="l11378"></a><span class="lineno">11378</span>&#160;            }</div>
<div class="line"><a name="l11379"></a><span class="lineno">11379</span>&#160;        } elseif (end($this-&gt;transfmrk[$this-&gt;page]) !== <span class="keyword">false</span>) {</div>
<div class="line"><a name="l11380"></a><span class="lineno">11380</span>&#160;            $key = key($this-&gt;transfmrk[$this-&gt;page]);</div>
<div class="line"><a name="l11381"></a><span class="lineno">11381</span>&#160;            $this-&gt;transfmrk[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][$key] = $this-&gt;pagelen[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>];</div>
<div class="line"><a name="l11382"></a><span class="lineno">11382</span>&#160;        }</div>
<div class="line"><a name="l11383"></a><span class="lineno">11383</span>&#160;    }</div>
<div class="line"><a name="l11384"></a><span class="lineno">11384</span>&#160;</div>
<div class="line"><a name="l11385"></a><span class="lineno">11385</span>&#160;    <span class="comment">// END TRANSFORMATIONS SECTION -------------------------</span></div>
<div class="line"><a name="l11386"></a><span class="lineno">11386</span>&#160;</div>
<div class="line"><a name="l11387"></a><span class="lineno">11387</span>&#160;    <span class="comment">// START GRAPHIC FUNCTIONS SECTION ---------------------</span></div>
<div class="line"><a name="l11388"></a><span class="lineno">11388</span>&#160;    <span class="comment">// The following section is based on the code provided by David Hernandez Sanz</span></div>
<div class="line"><a name="l11389"></a><span class="lineno">11389</span>&#160;</div>
<div class="line"><a name="l11397"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a0ef34c0ce76bd8e4671da42b3588d9b6">11397</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a0ef34c0ce76bd8e4671da42b3588d9b6">SetLineWidth</a>($width) {</div>
<div class="line"><a name="l11398"></a><span class="lineno">11398</span>&#160;        <span class="comment">//Set line width</span></div>
<div class="line"><a name="l11399"></a><span class="lineno">11399</span>&#160;        $this-&gt;LineWidth = $width;</div>
<div class="line"><a name="l11400"></a><span class="lineno">11400</span>&#160;        $this-&gt;linestyleWidth = sprintf(<span class="stringliteral">&#39;%F w&#39;</span>, ($width * $this-&gt;k));</div>
<div class="line"><a name="l11401"></a><span class="lineno">11401</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;state == 2) {</div>
<div class="line"><a name="l11402"></a><span class="lineno">11402</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($this-&gt;linestyleWidth);</div>
<div class="line"><a name="l11403"></a><span class="lineno">11403</span>&#160;        }</div>
<div class="line"><a name="l11404"></a><span class="lineno">11404</span>&#160;    }</div>
<div class="line"><a name="l11405"></a><span class="lineno">11405</span>&#160;</div>
<div class="line"><a name="l11413"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a9dd28e7bb04ba8f881492d06f501bce5">11413</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a9dd28e7bb04ba8f881492d06f501bce5">GetLineWidth</a>() {</div>
<div class="line"><a name="l11414"></a><span class="lineno">11414</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#a5971d565157974939d3edf96baeb0eeb">$this-&gt;LineWidth</a>;</div>
<div class="line"><a name="l11415"></a><span class="lineno">11415</span>&#160;    }</div>
<div class="line"><a name="l11416"></a><span class="lineno">11416</span>&#160;</div>
<div class="line"><a name="l11440"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a3d9b3717cd9ad8db31642155c832d148">11440</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a3d9b3717cd9ad8db31642155c832d148">SetLineStyle</a>($style, $ret=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l11441"></a><span class="lineno">11441</span>&#160;        $s = <span class="stringliteral">&#39;&#39;</span>; <span class="comment">// string to be returned</span></div>
<div class="line"><a name="l11442"></a><span class="lineno">11442</span>&#160;        <span class="keywordflow">if</span> (!is_array($style)) {</div>
<div class="line"><a name="l11443"></a><span class="lineno">11443</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l11444"></a><span class="lineno">11444</span>&#160;        }</div>
<div class="line"><a name="l11445"></a><span class="lineno">11445</span>&#160;        <span class="keywordflow">if</span> (isset($style[<span class="stringliteral">&#39;width&#39;</span>])) {</div>
<div class="line"><a name="l11446"></a><span class="lineno">11446</span>&#160;            $this-&gt;LineWidth = $style[<span class="stringliteral">&#39;width&#39;</span>];</div>
<div class="line"><a name="l11447"></a><span class="lineno">11447</span>&#160;            $this-&gt;linestyleWidth = sprintf(<span class="stringliteral">&#39;%F w&#39;</span>, ($style[<span class="stringliteral">&#39;width&#39;</span>] * $this-&gt;k));</div>
<div class="line"><a name="l11448"></a><span class="lineno">11448</span>&#160;            $s .= $this-&gt;linestyleWidth.<span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l11449"></a><span class="lineno">11449</span>&#160;        }</div>
<div class="line"><a name="l11450"></a><span class="lineno">11450</span>&#160;        <span class="keywordflow">if</span> (isset($style[<span class="stringliteral">&#39;cap&#39;</span>])) {</div>
<div class="line"><a name="l11451"></a><span class="lineno">11451</span>&#160;            $ca = array(<span class="stringliteral">&#39;butt&#39;</span> =&gt; 0, <span class="stringliteral">&#39;round&#39;</span>=&gt; 1, <span class="stringliteral">&#39;square&#39;</span> =&gt; 2);</div>
<div class="line"><a name="l11452"></a><span class="lineno">11452</span>&#160;            <span class="keywordflow">if</span> (isset($ca[$style[<span class="stringliteral">&#39;cap&#39;</span>]])) {</div>
<div class="line"><a name="l11453"></a><span class="lineno">11453</span>&#160;                $this-&gt;linestyleCap = $ca[$style[<span class="stringliteral">&#39;cap&#39;</span>]].<span class="stringliteral">&#39; J&#39;</span>;</div>
<div class="line"><a name="l11454"></a><span class="lineno">11454</span>&#160;                $s .= $this-&gt;linestyleCap.<span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l11455"></a><span class="lineno">11455</span>&#160;            }</div>
<div class="line"><a name="l11456"></a><span class="lineno">11456</span>&#160;        }</div>
<div class="line"><a name="l11457"></a><span class="lineno">11457</span>&#160;        <span class="keywordflow">if</span> (isset($style[<span class="stringliteral">&#39;join&#39;</span>])) {</div>
<div class="line"><a name="l11458"></a><span class="lineno">11458</span>&#160;            $ja = array(<span class="stringliteral">&#39;miter&#39;</span> =&gt; 0, <span class="stringliteral">&#39;round&#39;</span> =&gt; 1, <span class="stringliteral">&#39;bevel&#39;</span> =&gt; 2);</div>
<div class="line"><a name="l11459"></a><span class="lineno">11459</span>&#160;            <span class="keywordflow">if</span> (isset($ja[$style[<span class="stringliteral">&#39;join&#39;</span>]])) {</div>
<div class="line"><a name="l11460"></a><span class="lineno">11460</span>&#160;                $this-&gt;linestyleJoin = $ja[$style[<span class="stringliteral">&#39;join&#39;</span>]].<span class="stringliteral">&#39; j&#39;</span>;</div>
<div class="line"><a name="l11461"></a><span class="lineno">11461</span>&#160;                $s .= $this-&gt;linestyleJoin.<span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l11462"></a><span class="lineno">11462</span>&#160;            }</div>
<div class="line"><a name="l11463"></a><span class="lineno">11463</span>&#160;        }</div>
<div class="line"><a name="l11464"></a><span class="lineno">11464</span>&#160;        <span class="keywordflow">if</span> (isset($style[<span class="stringliteral">&#39;dash&#39;</span>])) {</div>
<div class="line"><a name="l11465"></a><span class="lineno">11465</span>&#160;            $dash_string = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l11466"></a><span class="lineno">11466</span>&#160;            <span class="keywordflow">if</span> ($style[<span class="stringliteral">&#39;dash&#39;</span>]) {</div>
<div class="line"><a name="l11467"></a><span class="lineno">11467</span>&#160;                <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/^.+,/&#39;</span>, $style[<span class="stringliteral">&#39;dash&#39;</span>]) &gt; 0) {</div>
<div class="line"><a name="l11468"></a><span class="lineno">11468</span>&#160;                    $tab = explode(<span class="charliteral">&#39;,&#39;</span>, $style[<span class="stringliteral">&#39;dash&#39;</span>]);</div>
<div class="line"><a name="l11469"></a><span class="lineno">11469</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l11470"></a><span class="lineno">11470</span>&#160;                    $tab = array($style[<span class="stringliteral">&#39;dash&#39;</span>]);</div>
<div class="line"><a name="l11471"></a><span class="lineno">11471</span>&#160;                }</div>
<div class="line"><a name="l11472"></a><span class="lineno">11472</span>&#160;                $dash_string = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l11473"></a><span class="lineno">11473</span>&#160;                <span class="keywordflow">foreach</span> ($tab as $i =&gt; $v) {</div>
<div class="line"><a name="l11474"></a><span class="lineno">11474</span>&#160;                    <span class="keywordflow">if</span> ($i) {</div>
<div class="line"><a name="l11475"></a><span class="lineno">11475</span>&#160;                        $dash_string .= <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l11476"></a><span class="lineno">11476</span>&#160;                    }</div>
<div class="line"><a name="l11477"></a><span class="lineno">11477</span>&#160;                    $dash_string .= sprintf(<span class="stringliteral">&#39;%F&#39;</span>, $v);</div>
<div class="line"><a name="l11478"></a><span class="lineno">11478</span>&#160;                }</div>
<div class="line"><a name="l11479"></a><span class="lineno">11479</span>&#160;            }</div>
<div class="line"><a name="l11480"></a><span class="lineno">11480</span>&#160;            <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;phase&#39;</span>]) OR !$style[<span class="stringliteral">&#39;dash&#39;</span>]) {</div>
<div class="line"><a name="l11481"></a><span class="lineno">11481</span>&#160;                $style[<span class="stringliteral">&#39;phase&#39;</span>] = 0;</div>
<div class="line"><a name="l11482"></a><span class="lineno">11482</span>&#160;            }</div>
<div class="line"><a name="l11483"></a><span class="lineno">11483</span>&#160;            $this-&gt;linestyleDash = sprintf(<span class="stringliteral">&#39;[%s] %F d&#39;</span>, $dash_string, $style[<span class="stringliteral">&#39;phase&#39;</span>]);</div>
<div class="line"><a name="l11484"></a><span class="lineno">11484</span>&#160;            $s .= $this-&gt;linestyleDash.<span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l11485"></a><span class="lineno">11485</span>&#160;        }</div>
<div class="line"><a name="l11486"></a><span class="lineno">11486</span>&#160;        <span class="keywordflow">if</span> (isset($style[<span class="stringliteral">&#39;color&#39;</span>])) {</div>
<div class="line"><a name="l11487"></a><span class="lineno">11487</span>&#160;            $s .= $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8f3481f3ce8a4fcd40ac1e1a6bd8960e">SetDrawColorArray</a>($style[<span class="stringliteral">&#39;color&#39;</span>], <span class="keyword">true</span>).<span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l11488"></a><span class="lineno">11488</span>&#160;        }</div>
<div class="line"><a name="l11489"></a><span class="lineno">11489</span>&#160;        <span class="keywordflow">if</span> (!$ret AND ($this-&gt;state == 2)) {</div>
<div class="line"><a name="l11490"></a><span class="lineno">11490</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($s);</div>
<div class="line"><a name="l11491"></a><span class="lineno">11491</span>&#160;        }</div>
<div class="line"><a name="l11492"></a><span class="lineno">11492</span>&#160;        <span class="keywordflow">return</span> $s;</div>
<div class="line"><a name="l11493"></a><span class="lineno">11493</span>&#160;    }</div>
<div class="line"><a name="l11494"></a><span class="lineno">11494</span>&#160;</div>
<div class="line"><a name="l11502"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ab0a7280484f906a0b2d58e3a15dbb469">11502</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ab0a7280484f906a0b2d58e3a15dbb469">_outPoint</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>) {</div>
<div class="line"><a name="l11503"></a><span class="lineno">11503</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;state == 2) {</div>
<div class="line"><a name="l11504"></a><span class="lineno">11504</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(sprintf(<span class="stringliteral">&#39;%F %F m&#39;</span>, (<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> * $this-&gt;k), (($this-&gt;h - <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>) * $this-&gt;k)));</div>
<div class="line"><a name="l11505"></a><span class="lineno">11505</span>&#160;        }</div>
<div class="line"><a name="l11506"></a><span class="lineno">11506</span>&#160;    }</div>
<div class="line"><a name="l11507"></a><span class="lineno">11507</span>&#160;</div>
<div class="line"><a name="l11516"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#af5e5357f5db0128c824f0a22cab63719">11516</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#af5e5357f5db0128c824f0a22cab63719">_outLine</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>) {</div>
<div class="line"><a name="l11517"></a><span class="lineno">11517</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;state == 2) {</div>
<div class="line"><a name="l11518"></a><span class="lineno">11518</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(sprintf(<span class="stringliteral">&#39;%F %F l&#39;</span>, (<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> * $this-&gt;k), (($this-&gt;h - <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>) * $this-&gt;k)));</div>
<div class="line"><a name="l11519"></a><span class="lineno">11519</span>&#160;        }</div>
<div class="line"><a name="l11520"></a><span class="lineno">11520</span>&#160;    }</div>
<div class="line"><a name="l11521"></a><span class="lineno">11521</span>&#160;</div>
<div class="line"><a name="l11532"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aacc2ee9f1c08cda7c71f2a203ed9d6c2">11532</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#aacc2ee9f1c08cda7c71f2a203ed9d6c2">_outRect</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $op) {</div>
<div class="line"><a name="l11533"></a><span class="lineno">11533</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;state == 2) {</div>
<div class="line"><a name="l11534"></a><span class="lineno">11534</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(sprintf(<span class="stringliteral">&#39;%F %F %F %F re %s&#39;</span>, (<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> * $this-&gt;k), (($this-&gt;h - <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>) * $this-&gt;k), (<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> * $this-&gt;k), (-<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> * $this-&gt;k), $op));</div>
<div class="line"><a name="l11535"></a><span class="lineno">11535</span>&#160;        }</div>
<div class="line"><a name="l11536"></a><span class="lineno">11536</span>&#160;    }</div>
<div class="line"><a name="l11537"></a><span class="lineno">11537</span>&#160;</div>
<div class="line"><a name="l11550"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a90efde54832587803c17467bfff03038">11550</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a90efde54832587803c17467bfff03038">_outCurve</a>($x1, $y1, $x2, $y2, $x3, $y3) {</div>
<div class="line"><a name="l11551"></a><span class="lineno">11551</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;state == 2) {</div>
<div class="line"><a name="l11552"></a><span class="lineno">11552</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(sprintf(<span class="stringliteral">&#39;%F %F %F %F %F %F c&#39;</span>, ($x1 * $this-&gt;k), (($this-&gt;h - $y1) * $this-&gt;k), ($x2 * $this-&gt;k), (($this-&gt;h - $y2) * $this-&gt;k), ($x3 * $this-&gt;k), (($this-&gt;h - $y3) * $this-&gt;k)));</div>
<div class="line"><a name="l11553"></a><span class="lineno">11553</span>&#160;        }</div>
<div class="line"><a name="l11554"></a><span class="lineno">11554</span>&#160;    }</div>
<div class="line"><a name="l11555"></a><span class="lineno">11555</span>&#160;</div>
<div class="line"><a name="l11566"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a5f1c38efd67c4e1d70a40f13a7b286bb">11566</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a5f1c38efd67c4e1d70a40f13a7b286bb">_outCurveV</a>($x2, $y2, $x3, $y3) {</div>
<div class="line"><a name="l11567"></a><span class="lineno">11567</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;state == 2) {</div>
<div class="line"><a name="l11568"></a><span class="lineno">11568</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(sprintf(<span class="stringliteral">&#39;%F %F %F %F v&#39;</span>, ($x2 * $this-&gt;k), (($this-&gt;h - $y2) * $this-&gt;k), ($x3 * $this-&gt;k), (($this-&gt;h - $y3) * $this-&gt;k)));</div>
<div class="line"><a name="l11569"></a><span class="lineno">11569</span>&#160;        }</div>
<div class="line"><a name="l11570"></a><span class="lineno">11570</span>&#160;    }</div>
<div class="line"><a name="l11571"></a><span class="lineno">11571</span>&#160;</div>
<div class="line"><a name="l11582"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#afc90d19ade9358676bbde3633db5d808">11582</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#afc90d19ade9358676bbde3633db5d808">_outCurveY</a>($x1, $y1, $x3, $y3) {</div>
<div class="line"><a name="l11583"></a><span class="lineno">11583</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;state == 2) {</div>
<div class="line"><a name="l11584"></a><span class="lineno">11584</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(sprintf(<span class="stringliteral">&#39;%F %F %F %F y&#39;</span>, ($x1 * $this-&gt;k), (($this-&gt;h - $y1) * $this-&gt;k), ($x3 * $this-&gt;k), (($this-&gt;h - $y3) * $this-&gt;k)));</div>
<div class="line"><a name="l11585"></a><span class="lineno">11585</span>&#160;        }</div>
<div class="line"><a name="l11586"></a><span class="lineno">11586</span>&#160;    }</div>
<div class="line"><a name="l11587"></a><span class="lineno">11587</span>&#160;</div>
<div class="line"><a name="l11599"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a89c0fac95da962719ba92b057df9c201">11599</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a89c0fac95da962719ba92b057df9c201">Line</a>($x1, $y1, $x2, $y2, $style=array()) {</div>
<div class="line"><a name="l11600"></a><span class="lineno">11600</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;state != 2) {</div>
<div class="line"><a name="l11601"></a><span class="lineno">11601</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l11602"></a><span class="lineno">11602</span>&#160;        }</div>
<div class="line"><a name="l11603"></a><span class="lineno">11603</span>&#160;        <span class="keywordflow">if</span> (is_array($style)) {</div>
<div class="line"><a name="l11604"></a><span class="lineno">11604</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a3d9b3717cd9ad8db31642155c832d148">SetLineStyle</a>($style);</div>
<div class="line"><a name="l11605"></a><span class="lineno">11605</span>&#160;        }</div>
<div class="line"><a name="l11606"></a><span class="lineno">11606</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ab0a7280484f906a0b2d58e3a15dbb469">_outPoint</a>($x1, $y1);</div>
<div class="line"><a name="l11607"></a><span class="lineno">11607</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af5e5357f5db0128c824f0a22cab63719">_outLine</a>($x2, $y2);</div>
<div class="line"><a name="l11608"></a><span class="lineno">11608</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(<span class="charliteral">&#39;S&#39;</span>);</div>
<div class="line"><a name="l11609"></a><span class="lineno">11609</span>&#160;    }</div>
<div class="line"><a name="l11610"></a><span class="lineno">11610</span>&#160;</div>
<div class="line"><a name="l11629"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a8fc7b86c255aeb0f14d281bdaeb2015c">11629</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a8fc7b86c255aeb0f14d281bdaeb2015c">Rect</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $style=<span class="stringliteral">&#39;&#39;</span>, $border_style=array(), $fill_color=array()) {</div>
<div class="line"><a name="l11630"></a><span class="lineno">11630</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;state != 2) {</div>
<div class="line"><a name="l11631"></a><span class="lineno">11631</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l11632"></a><span class="lineno">11632</span>&#160;        }</div>
<div class="line"><a name="l11633"></a><span class="lineno">11633</span>&#160;        <span class="keywordflow">if</span> (empty($style)) {</div>
<div class="line"><a name="l11634"></a><span class="lineno">11634</span>&#160;            $style = <span class="charliteral">&#39;S&#39;</span>;</div>
<div class="line"><a name="l11635"></a><span class="lineno">11635</span>&#160;        }</div>
<div class="line"><a name="l11636"></a><span class="lineno">11636</span>&#160;        <span class="keywordflow">if</span> (!(strpos($style, <span class="charliteral">&#39;F&#39;</span>) === <span class="keyword">false</span>) AND !empty($fill_color)) {</div>
<div class="line"><a name="l11637"></a><span class="lineno">11637</span>&#160;            <span class="comment">// set background color</span></div>
<div class="line"><a name="l11638"></a><span class="lineno">11638</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a850dd347f649c99548a193f2b84a502e">SetFillColorArray</a>($fill_color);</div>
<div class="line"><a name="l11639"></a><span class="lineno">11639</span>&#160;        }</div>
<div class="line"><a name="l11640"></a><span class="lineno">11640</span>&#160;        <span class="keywordflow">if</span> (!empty($border_style)) {</div>
<div class="line"><a name="l11641"></a><span class="lineno">11641</span>&#160;            <span class="keywordflow">if</span> (isset($border_style[<span class="stringliteral">&#39;all&#39;</span>]) AND !empty($border_style[<span class="stringliteral">&#39;all&#39;</span>])) {</div>
<div class="line"><a name="l11642"></a><span class="lineno">11642</span>&#160;                <span class="comment">//set global style for border</span></div>
<div class="line"><a name="l11643"></a><span class="lineno">11643</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a3d9b3717cd9ad8db31642155c832d148">SetLineStyle</a>($border_style[<span class="stringliteral">&#39;all&#39;</span>]);</div>
<div class="line"><a name="l11644"></a><span class="lineno">11644</span>&#160;                $border_style = array();</div>
<div class="line"><a name="l11645"></a><span class="lineno">11645</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l11646"></a><span class="lineno">11646</span>&#160;                <span class="comment">// remove stroke operator from style</span></div>
<div class="line"><a name="l11647"></a><span class="lineno">11647</span>&#160;                $opnostroke = array(<span class="charliteral">&#39;S&#39;</span> =&gt; <span class="stringliteral">&#39;&#39;</span>, <span class="charliteral">&#39;D&#39;</span> =&gt; <span class="stringliteral">&#39;&#39;</span>, <span class="charliteral">&#39;s&#39;</span> =&gt; <span class="stringliteral">&#39;&#39;</span>, <span class="charliteral">&#39;d&#39;</span> =&gt; <span class="stringliteral">&#39;&#39;</span>, <span class="charliteral">&#39;B&#39;</span> =&gt; <span class="charliteral">&#39;F&#39;</span>, <span class="stringliteral">&#39;FD&#39;</span> =&gt; <span class="charliteral">&#39;F&#39;</span>, <span class="stringliteral">&#39;DF&#39;</span> =&gt; <span class="charliteral">&#39;F&#39;</span>, <span class="stringliteral">&#39;B*&#39;</span> =&gt; <span class="stringliteral">&#39;F*&#39;</span>, <span class="stringliteral">&#39;F*D&#39;</span> =&gt; <span class="stringliteral">&#39;F*&#39;</span>, <span class="stringliteral">&#39;DF*&#39;</span> =&gt; <span class="stringliteral">&#39;F*&#39;</span>, <span class="charliteral">&#39;b&#39;</span> =&gt; <span class="charliteral">&#39;f&#39;</span>, <span class="stringliteral">&#39;fd&#39;</span> =&gt; <span class="charliteral">&#39;f&#39;</span>, <span class="stringliteral">&#39;df&#39;</span> =&gt; <span class="charliteral">&#39;f&#39;</span>, <span class="stringliteral">&#39;b*&#39;</span> =&gt; <span class="stringliteral">&#39;f*&#39;</span>, <span class="stringliteral">&#39;f*d&#39;</span> =&gt; <span class="stringliteral">&#39;f*&#39;</span>, <span class="stringliteral">&#39;df*&#39;</span> =&gt; <span class="stringliteral">&#39;f*&#39;</span> );</div>
<div class="line"><a name="l11648"></a><span class="lineno">11648</span>&#160;                <span class="keywordflow">if</span> (isset($opnostroke[$style])) {</div>
<div class="line"><a name="l11649"></a><span class="lineno">11649</span>&#160;                    $style = $opnostroke[$style];</div>
<div class="line"><a name="l11650"></a><span class="lineno">11650</span>&#160;                }</div>
<div class="line"><a name="l11651"></a><span class="lineno">11651</span>&#160;            }</div>
<div class="line"><a name="l11652"></a><span class="lineno">11652</span>&#160;        }</div>
<div class="line"><a name="l11653"></a><span class="lineno">11653</span>&#160;        <span class="keywordflow">if</span> (!empty($style)) {</div>
<div class="line"><a name="l11654"></a><span class="lineno">11654</span>&#160;            $op = TCPDF_STATIC::getPathPaintOperator($style);</div>
<div class="line"><a name="l11655"></a><span class="lineno">11655</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aacc2ee9f1c08cda7c71f2a203ed9d6c2">_outRect</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $op);</div>
<div class="line"><a name="l11656"></a><span class="lineno">11656</span>&#160;        }</div>
<div class="line"><a name="l11657"></a><span class="lineno">11657</span>&#160;        <span class="keywordflow">if</span> (!empty($border_style)) {</div>
<div class="line"><a name="l11658"></a><span class="lineno">11658</span>&#160;            $border_style2 = array();</div>
<div class="line"><a name="l11659"></a><span class="lineno">11659</span>&#160;            <span class="keywordflow">foreach</span> ($border_style as $line =&gt; $value) {</div>
<div class="line"><a name="l11660"></a><span class="lineno">11660</span>&#160;                $length = strlen($line);</div>
<div class="line"><a name="l11661"></a><span class="lineno">11661</span>&#160;                <span class="keywordflow">for</span> ($i = 0; $i &lt; $length; ++$i) {</div>
<div class="line"><a name="l11662"></a><span class="lineno">11662</span>&#160;                    $border_style2[$line[$i]] = $value;</div>
<div class="line"><a name="l11663"></a><span class="lineno">11663</span>&#160;                }</div>
<div class="line"><a name="l11664"></a><span class="lineno">11664</span>&#160;            }</div>
<div class="line"><a name="l11665"></a><span class="lineno">11665</span>&#160;            $border_style = $border_style2;</div>
<div class="line"><a name="l11666"></a><span class="lineno">11666</span>&#160;            <span class="keywordflow">if</span> (isset($border_style[<span class="charliteral">&#39;L&#39;</span>]) AND $border_style[<span class="charliteral">&#39;L&#39;</span>]) {</div>
<div class="line"><a name="l11667"></a><span class="lineno">11667</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a89c0fac95da962719ba92b057df9c201">Line</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> + <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $border_style[<span class="charliteral">&#39;L&#39;</span>]);</div>
<div class="line"><a name="l11668"></a><span class="lineno">11668</span>&#160;            }</div>
<div class="line"><a name="l11669"></a><span class="lineno">11669</span>&#160;            <span class="keywordflow">if</span> (isset($border_style[<span class="charliteral">&#39;T&#39;</span>]) AND $border_style[<span class="charliteral">&#39;T&#39;</span>]) {</div>
<div class="line"><a name="l11670"></a><span class="lineno">11670</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a89c0fac95da962719ba92b057df9c201">Line</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> + <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, $border_style[<span class="charliteral">&#39;T&#39;</span>]);</div>
<div class="line"><a name="l11671"></a><span class="lineno">11671</span>&#160;            }</div>
<div class="line"><a name="l11672"></a><span class="lineno">11672</span>&#160;            <span class="keywordflow">if</span> (isset($border_style[<span class="charliteral">&#39;R&#39;</span>]) AND $border_style[<span class="charliteral">&#39;R&#39;</span>]) {</div>
<div class="line"><a name="l11673"></a><span class="lineno">11673</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a89c0fac95da962719ba92b057df9c201">Line</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> + <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> + <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> + <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $border_style[<span class="charliteral">&#39;R&#39;</span>]);</div>
<div class="line"><a name="l11674"></a><span class="lineno">11674</span>&#160;            }</div>
<div class="line"><a name="l11675"></a><span class="lineno">11675</span>&#160;            <span class="keywordflow">if</span> (isset($border_style[<span class="charliteral">&#39;B&#39;</span>]) AND $border_style[<span class="charliteral">&#39;B&#39;</span>]) {</div>
<div class="line"><a name="l11676"></a><span class="lineno">11676</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a89c0fac95da962719ba92b057df9c201">Line</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> + <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> + <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> + <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $border_style[<span class="charliteral">&#39;B&#39;</span>]);</div>
<div class="line"><a name="l11677"></a><span class="lineno">11677</span>&#160;            }</div>
<div class="line"><a name="l11678"></a><span class="lineno">11678</span>&#160;        }</div>
<div class="line"><a name="l11679"></a><span class="lineno">11679</span>&#160;    }</div>
<div class="line"><a name="l11680"></a><span class="lineno">11680</span>&#160;</div>
<div class="line"><a name="l11700"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a23895bb8d9fae071308f9d307ea638fd">11700</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a23895bb8d9fae071308f9d307ea638fd">Curve</a>($x0, $y0, $x1, $y1, $x2, $y2, $x3, $y3, $style=<span class="stringliteral">&#39;&#39;</span>, $line_style=array(), $fill_color=array()) {</div>
<div class="line"><a name="l11701"></a><span class="lineno">11701</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;state != 2) {</div>
<div class="line"><a name="l11702"></a><span class="lineno">11702</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l11703"></a><span class="lineno">11703</span>&#160;        }</div>
<div class="line"><a name="l11704"></a><span class="lineno">11704</span>&#160;        <span class="keywordflow">if</span> (!(<span class="keyword">false</span> === strpos($style, <span class="charliteral">&#39;F&#39;</span>)) AND isset($fill_color)) {</div>
<div class="line"><a name="l11705"></a><span class="lineno">11705</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a850dd347f649c99548a193f2b84a502e">SetFillColorArray</a>($fill_color);</div>
<div class="line"><a name="l11706"></a><span class="lineno">11706</span>&#160;        }</div>
<div class="line"><a name="l11707"></a><span class="lineno">11707</span>&#160;        $op = TCPDF_STATIC::getPathPaintOperator($style);</div>
<div class="line"><a name="l11708"></a><span class="lineno">11708</span>&#160;        <span class="keywordflow">if</span> ($line_style) {</div>
<div class="line"><a name="l11709"></a><span class="lineno">11709</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a3d9b3717cd9ad8db31642155c832d148">SetLineStyle</a>($line_style);</div>
<div class="line"><a name="l11710"></a><span class="lineno">11710</span>&#160;        }</div>
<div class="line"><a name="l11711"></a><span class="lineno">11711</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ab0a7280484f906a0b2d58e3a15dbb469">_outPoint</a>($x0, $y0);</div>
<div class="line"><a name="l11712"></a><span class="lineno">11712</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a90efde54832587803c17467bfff03038">_outCurve</a>($x1, $y1, $x2, $y2, $x3, $y3);</div>
<div class="line"><a name="l11713"></a><span class="lineno">11713</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($op);</div>
<div class="line"><a name="l11714"></a><span class="lineno">11714</span>&#160;    }</div>
<div class="line"><a name="l11715"></a><span class="lineno">11715</span>&#160;</div>
<div class="line"><a name="l11730"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aaf0b4fbcfc6c68a0a0877b39667184ef">11730</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#aaf0b4fbcfc6c68a0a0877b39667184ef">Polycurve</a>($x0, $y0, $segments, $style=<span class="stringliteral">&#39;&#39;</span>, $line_style=array(), $fill_color=array()) {</div>
<div class="line"><a name="l11731"></a><span class="lineno">11731</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;state != 2) {</div>
<div class="line"><a name="l11732"></a><span class="lineno">11732</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l11733"></a><span class="lineno">11733</span>&#160;        }</div>
<div class="line"><a name="l11734"></a><span class="lineno">11734</span>&#160;        <span class="keywordflow">if</span> (!(<span class="keyword">false</span> === strpos($style, <span class="charliteral">&#39;F&#39;</span>)) AND isset($fill_color)) {</div>
<div class="line"><a name="l11735"></a><span class="lineno">11735</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a850dd347f649c99548a193f2b84a502e">SetFillColorArray</a>($fill_color);</div>
<div class="line"><a name="l11736"></a><span class="lineno">11736</span>&#160;        }</div>
<div class="line"><a name="l11737"></a><span class="lineno">11737</span>&#160;        $op = TCPDF_STATIC::getPathPaintOperator($style);</div>
<div class="line"><a name="l11738"></a><span class="lineno">11738</span>&#160;        <span class="keywordflow">if</span> ($op == <span class="charliteral">&#39;f&#39;</span>) {</div>
<div class="line"><a name="l11739"></a><span class="lineno">11739</span>&#160;            $line_style = array();</div>
<div class="line"><a name="l11740"></a><span class="lineno">11740</span>&#160;        }</div>
<div class="line"><a name="l11741"></a><span class="lineno">11741</span>&#160;        <span class="keywordflow">if</span> ($line_style) {</div>
<div class="line"><a name="l11742"></a><span class="lineno">11742</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a3d9b3717cd9ad8db31642155c832d148">SetLineStyle</a>($line_style);</div>
<div class="line"><a name="l11743"></a><span class="lineno">11743</span>&#160;        }</div>
<div class="line"><a name="l11744"></a><span class="lineno">11744</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ab0a7280484f906a0b2d58e3a15dbb469">_outPoint</a>($x0, $y0);</div>
<div class="line"><a name="l11745"></a><span class="lineno">11745</span>&#160;        <span class="keywordflow">foreach</span> ($segments as $segment) {</div>
<div class="line"><a name="l11746"></a><span class="lineno">11746</span>&#160;            list($x1, $y1, $x2, $y2, $x3, $y3) = $segment;</div>
<div class="line"><a name="l11747"></a><span class="lineno">11747</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a90efde54832587803c17467bfff03038">_outCurve</a>($x1, $y1, $x2, $y2, $x3, $y3);</div>
<div class="line"><a name="l11748"></a><span class="lineno">11748</span>&#160;        }</div>
<div class="line"><a name="l11749"></a><span class="lineno">11749</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($op);</div>
<div class="line"><a name="l11750"></a><span class="lineno">11750</span>&#160;    }</div>
<div class="line"><a name="l11751"></a><span class="lineno">11751</span>&#160;</div>
<div class="line"><a name="l11770"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ab45f86866ef0d753a8fca04dddd63d68">11770</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ab45f86866ef0d753a8fca04dddd63d68">Ellipse</a>($x0, $y0, $rx, $ry=<span class="stringliteral">&#39;&#39;</span>, $angle=0, $astart=0, $afinish=360, $style=<span class="stringliteral">&#39;&#39;</span>, $line_style=array(), $fill_color=array(), $nc=2) {</div>
<div class="line"><a name="l11771"></a><span class="lineno">11771</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;state != 2) {</div>
<div class="line"><a name="l11772"></a><span class="lineno">11772</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l11773"></a><span class="lineno">11773</span>&#160;        }</div>
<div class="line"><a name="l11774"></a><span class="lineno">11774</span>&#160;        <span class="keywordflow">if</span> (TCPDF_STATIC::empty_string($ry) OR ($ry == 0)) {</div>
<div class="line"><a name="l11775"></a><span class="lineno">11775</span>&#160;            $ry = $rx;</div>
<div class="line"><a name="l11776"></a><span class="lineno">11776</span>&#160;        }</div>
<div class="line"><a name="l11777"></a><span class="lineno">11777</span>&#160;        <span class="keywordflow">if</span> (!(<span class="keyword">false</span> === strpos($style, <span class="charliteral">&#39;F&#39;</span>)) AND isset($fill_color)) {</div>
<div class="line"><a name="l11778"></a><span class="lineno">11778</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a850dd347f649c99548a193f2b84a502e">SetFillColorArray</a>($fill_color);</div>
<div class="line"><a name="l11779"></a><span class="lineno">11779</span>&#160;        }</div>
<div class="line"><a name="l11780"></a><span class="lineno">11780</span>&#160;        $op = TCPDF_STATIC::getPathPaintOperator($style);</div>
<div class="line"><a name="l11781"></a><span class="lineno">11781</span>&#160;        <span class="keywordflow">if</span> ($op == <span class="charliteral">&#39;f&#39;</span>) {</div>
<div class="line"><a name="l11782"></a><span class="lineno">11782</span>&#160;            $line_style = array();</div>
<div class="line"><a name="l11783"></a><span class="lineno">11783</span>&#160;        }</div>
<div class="line"><a name="l11784"></a><span class="lineno">11784</span>&#160;        <span class="keywordflow">if</span> ($line_style) {</div>
<div class="line"><a name="l11785"></a><span class="lineno">11785</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a3d9b3717cd9ad8db31642155c832d148">SetLineStyle</a>($line_style);</div>
<div class="line"><a name="l11786"></a><span class="lineno">11786</span>&#160;        }</div>
<div class="line"><a name="l11787"></a><span class="lineno">11787</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa36b100b48a17cd6c35de87431a3d54c">_outellipticalarc</a>($x0, $y0, $rx, $ry, $angle, $astart, $afinish, <span class="keyword">false</span>, $nc, <span class="keyword">true</span>, <span class="keyword">true</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l11788"></a><span class="lineno">11788</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($op);</div>
<div class="line"><a name="l11789"></a><span class="lineno">11789</span>&#160;    }</div>
<div class="line"><a name="l11790"></a><span class="lineno">11790</span>&#160;</div>
<div class="line"><a name="l11811"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aa36b100b48a17cd6c35de87431a3d54c">11811</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#aa36b100b48a17cd6c35de87431a3d54c">_outellipticalarc</a>($xc, $yc, $rx, $ry, $xang=0, $angs=0, $angf=360, $pie=<span class="keyword">false</span>, $nc=2, $startpoint=<span class="keyword">true</span>, $ccw=<span class="keyword">true</span>, $svg=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l11812"></a><span class="lineno">11812</span>&#160;        <span class="keywordflow">if</span> (($rx &lt;= 0) OR ($ry &lt; 0)) {</div>
<div class="line"><a name="l11813"></a><span class="lineno">11813</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l11814"></a><span class="lineno">11814</span>&#160;        }</div>
<div class="line"><a name="l11815"></a><span class="lineno">11815</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a> = <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>;</div>
<div class="line"><a name="l11816"></a><span class="lineno">11816</span>&#160;        <span class="keywordflow">if</span> ($nc &lt; 2) {</div>
<div class="line"><a name="l11817"></a><span class="lineno">11817</span>&#160;            $nc = 2;</div>
<div class="line"><a name="l11818"></a><span class="lineno">11818</span>&#160;        }</div>
<div class="line"><a name="l11819"></a><span class="lineno">11819</span>&#160;        $xmin = 2147483647;</div>
<div class="line"><a name="l11820"></a><span class="lineno">11820</span>&#160;        $ymin = 2147483647;</div>
<div class="line"><a name="l11821"></a><span class="lineno">11821</span>&#160;        $xmax = 0;</div>
<div class="line"><a name="l11822"></a><span class="lineno">11822</span>&#160;        $ymax = 0;</div>
<div class="line"><a name="l11823"></a><span class="lineno">11823</span>&#160;        <span class="keywordflow">if</span> ($pie) {</div>
<div class="line"><a name="l11824"></a><span class="lineno">11824</span>&#160;            <span class="comment">// center of the arc</span></div>
<div class="line"><a name="l11825"></a><span class="lineno">11825</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ab0a7280484f906a0b2d58e3a15dbb469">_outPoint</a>($xc, $yc);</div>
<div class="line"><a name="l11826"></a><span class="lineno">11826</span>&#160;        }</div>
<div class="line"><a name="l11827"></a><span class="lineno">11827</span>&#160;        $xang = deg2rad((<span class="keywordtype">float</span>) $xang);</div>
<div class="line"><a name="l11828"></a><span class="lineno">11828</span>&#160;        $angs = deg2rad((<span class="keywordtype">float</span>) $angs);</div>
<div class="line"><a name="l11829"></a><span class="lineno">11829</span>&#160;        $angf = deg2rad((<span class="keywordtype">float</span>) $angf);</div>
<div class="line"><a name="l11830"></a><span class="lineno">11830</span>&#160;        <span class="keywordflow">if</span> ($svg) {</div>
<div class="line"><a name="l11831"></a><span class="lineno">11831</span>&#160;            $as = $angs;</div>
<div class="line"><a name="l11832"></a><span class="lineno">11832</span>&#160;            $af = $angf;</div>
<div class="line"><a name="l11833"></a><span class="lineno">11833</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l11834"></a><span class="lineno">11834</span>&#160;            $as = atan2((sin($angs) / $ry), (cos($angs) / $rx));</div>
<div class="line"><a name="l11835"></a><span class="lineno">11835</span>&#160;            $af = atan2((sin($angf) / $ry), (cos($angf) / $rx));</div>
<div class="line"><a name="l11836"></a><span class="lineno">11836</span>&#160;        }</div>
<div class="line"><a name="l11837"></a><span class="lineno">11837</span>&#160;        <span class="keywordflow">if</span> ($as &lt; 0) {</div>
<div class="line"><a name="l11838"></a><span class="lineno">11838</span>&#160;            $as += (2 * M_PI);</div>
<div class="line"><a name="l11839"></a><span class="lineno">11839</span>&#160;        }</div>
<div class="line"><a name="l11840"></a><span class="lineno">11840</span>&#160;        <span class="keywordflow">if</span> ($af &lt; 0) {</div>
<div class="line"><a name="l11841"></a><span class="lineno">11841</span>&#160;            $af += (2 * M_PI);</div>
<div class="line"><a name="l11842"></a><span class="lineno">11842</span>&#160;        }</div>
<div class="line"><a name="l11843"></a><span class="lineno">11843</span>&#160;        <span class="keywordflow">if</span> ($ccw AND ($as &gt; $af)) {</div>
<div class="line"><a name="l11844"></a><span class="lineno">11844</span>&#160;            <span class="comment">// reverse rotation</span></div>
<div class="line"><a name="l11845"></a><span class="lineno">11845</span>&#160;            $as -= (2 * M_PI);</div>
<div class="line"><a name="l11846"></a><span class="lineno">11846</span>&#160;        } elseif (!$ccw AND ($as &lt; $af)) {</div>
<div class="line"><a name="l11847"></a><span class="lineno">11847</span>&#160;            <span class="comment">// reverse rotation</span></div>
<div class="line"><a name="l11848"></a><span class="lineno">11848</span>&#160;            $af -= (2 * M_PI);</div>
<div class="line"><a name="l11849"></a><span class="lineno">11849</span>&#160;        }</div>
<div class="line"><a name="l11850"></a><span class="lineno">11850</span>&#160;        $total_angle = ($af - $as);</div>
<div class="line"><a name="l11851"></a><span class="lineno">11851</span>&#160;        <span class="keywordflow">if</span> ($nc &lt; 2) {</div>
<div class="line"><a name="l11852"></a><span class="lineno">11852</span>&#160;            $nc = 2;</div>
<div class="line"><a name="l11853"></a><span class="lineno">11853</span>&#160;        }</div>
<div class="line"><a name="l11854"></a><span class="lineno">11854</span>&#160;        <span class="comment">// total arcs to draw</span></div>
<div class="line"><a name="l11855"></a><span class="lineno">11855</span>&#160;        $nc *= (2 * abs($total_angle) / M_PI);</div>
<div class="line"><a name="l11856"></a><span class="lineno">11856</span>&#160;        $nc = round($nc) + 1;</div>
<div class="line"><a name="l11857"></a><span class="lineno">11857</span>&#160;        <span class="comment">// angle of each arc</span></div>
<div class="line"><a name="l11858"></a><span class="lineno">11858</span>&#160;        $arcang = ($total_angle / $nc);</div>
<div class="line"><a name="l11859"></a><span class="lineno">11859</span>&#160;        <span class="comment">// center point in PDF coordinates</span></div>
<div class="line"><a name="l11860"></a><span class="lineno">11860</span>&#160;        $x0 = $xc;</div>
<div class="line"><a name="l11861"></a><span class="lineno">11861</span>&#160;        $y0 = ($this-&gt;h - $yc);</div>
<div class="line"><a name="l11862"></a><span class="lineno">11862</span>&#160;        <span class="comment">// starting angle</span></div>
<div class="line"><a name="l11863"></a><span class="lineno">11863</span>&#160;        $ang = $as;</div>
<div class="line"><a name="l11864"></a><span class="lineno">11864</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#ae4a86c2e1ba1b7026fbfb1eb43845f1a">$alpha</a> = sin($arcang) * ((sqrt(4 + (3 * pow(tan(($arcang) / 2), 2))) - 1) / 3);</div>
<div class="line"><a name="l11865"></a><span class="lineno">11865</span>&#160;        $cos_xang = cos($xang);</div>
<div class="line"><a name="l11866"></a><span class="lineno">11866</span>&#160;        $sin_xang = sin($xang);</div>
<div class="line"><a name="l11867"></a><span class="lineno">11867</span>&#160;        $cos_ang = cos($ang);</div>
<div class="line"><a name="l11868"></a><span class="lineno">11868</span>&#160;        $sin_ang = sin($ang);</div>
<div class="line"><a name="l11869"></a><span class="lineno">11869</span>&#160;        <span class="comment">// first arc point</span></div>
<div class="line"><a name="l11870"></a><span class="lineno">11870</span>&#160;        $px1 = $x0 + ($rx * $cos_xang * $cos_ang) - ($ry * $sin_xang * $sin_ang);</div>
<div class="line"><a name="l11871"></a><span class="lineno">11871</span>&#160;        $py1 = $y0 + ($rx * $sin_xang * $cos_ang) + ($ry * $cos_xang * $sin_ang);</div>
<div class="line"><a name="l11872"></a><span class="lineno">11872</span>&#160;        <span class="comment">// first Bezier control point</span></div>
<div class="line"><a name="l11873"></a><span class="lineno">11873</span>&#160;        $qx1 = (<a class="code" href="../../d4/d40/classTCPDF.html#ae4a86c2e1ba1b7026fbfb1eb43845f1a">$alpha</a> * ((-$rx * $cos_xang * $sin_ang) - ($ry * $sin_xang * $cos_ang)));</div>
<div class="line"><a name="l11874"></a><span class="lineno">11874</span>&#160;        $qy1 = (<a class="code" href="../../d4/d40/classTCPDF.html#ae4a86c2e1ba1b7026fbfb1eb43845f1a">$alpha</a> * ((-$rx * $sin_xang * $sin_ang) + ($ry * $cos_xang * $cos_ang)));</div>
<div class="line"><a name="l11875"></a><span class="lineno">11875</span>&#160;        <span class="keywordflow">if</span> ($pie) {</div>
<div class="line"><a name="l11876"></a><span class="lineno">11876</span>&#160;            <span class="comment">// line from center to arc starting point</span></div>
<div class="line"><a name="l11877"></a><span class="lineno">11877</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af5e5357f5db0128c824f0a22cab63719">_outLine</a>($px1, $this-&gt;h - $py1);</div>
<div class="line"><a name="l11878"></a><span class="lineno">11878</span>&#160;        } elseif ($startpoint) {</div>
<div class="line"><a name="l11879"></a><span class="lineno">11879</span>&#160;            <span class="comment">// arc starting point</span></div>
<div class="line"><a name="l11880"></a><span class="lineno">11880</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ab0a7280484f906a0b2d58e3a15dbb469">_outPoint</a>($px1, $this-&gt;h - $py1);</div>
<div class="line"><a name="l11881"></a><span class="lineno">11881</span>&#160;        }</div>
<div class="line"><a name="l11882"></a><span class="lineno">11882</span>&#160;        <span class="comment">// draw arcs</span></div>
<div class="line"><a name="l11883"></a><span class="lineno">11883</span>&#160;        <span class="keywordflow">for</span> ($i = 1; $i &lt;= $nc; ++$i) {</div>
<div class="line"><a name="l11884"></a><span class="lineno">11884</span>&#160;            <span class="comment">// starting angle</span></div>
<div class="line"><a name="l11885"></a><span class="lineno">11885</span>&#160;            $ang = $as + ($i * $arcang);</div>
<div class="line"><a name="l11886"></a><span class="lineno">11886</span>&#160;            <span class="keywordflow">if</span> ($i == $nc) {</div>
<div class="line"><a name="l11887"></a><span class="lineno">11887</span>&#160;                $ang = $af;</div>
<div class="line"><a name="l11888"></a><span class="lineno">11888</span>&#160;            }</div>
<div class="line"><a name="l11889"></a><span class="lineno">11889</span>&#160;            $cos_ang = cos($ang);</div>
<div class="line"><a name="l11890"></a><span class="lineno">11890</span>&#160;            $sin_ang = sin($ang);</div>
<div class="line"><a name="l11891"></a><span class="lineno">11891</span>&#160;            <span class="comment">// second arc point</span></div>
<div class="line"><a name="l11892"></a><span class="lineno">11892</span>&#160;            $px2 = $x0 + ($rx * $cos_xang * $cos_ang) - ($ry * $sin_xang * $sin_ang);</div>
<div class="line"><a name="l11893"></a><span class="lineno">11893</span>&#160;            $py2 = $y0 + ($rx * $sin_xang * $cos_ang) + ($ry * $cos_xang * $sin_ang);</div>
<div class="line"><a name="l11894"></a><span class="lineno">11894</span>&#160;            <span class="comment">// second Bezier control point</span></div>
<div class="line"><a name="l11895"></a><span class="lineno">11895</span>&#160;            $qx2 = (<a class="code" href="../../d4/d40/classTCPDF.html#ae4a86c2e1ba1b7026fbfb1eb43845f1a">$alpha</a> * ((-$rx * $cos_xang * $sin_ang) - ($ry * $sin_xang * $cos_ang)));</div>
<div class="line"><a name="l11896"></a><span class="lineno">11896</span>&#160;            $qy2 = (<a class="code" href="../../d4/d40/classTCPDF.html#ae4a86c2e1ba1b7026fbfb1eb43845f1a">$alpha</a> * ((-$rx * $sin_xang * $sin_ang) + ($ry * $cos_xang * $cos_ang)));</div>
<div class="line"><a name="l11897"></a><span class="lineno">11897</span>&#160;            <span class="comment">// draw arc</span></div>
<div class="line"><a name="l11898"></a><span class="lineno">11898</span>&#160;            $cx1 = ($px1 + $qx1);</div>
<div class="line"><a name="l11899"></a><span class="lineno">11899</span>&#160;            $cy1 = ($this-&gt;h - ($py1 + $qy1));</div>
<div class="line"><a name="l11900"></a><span class="lineno">11900</span>&#160;            $cx2 = ($px2 - $qx2);</div>
<div class="line"><a name="l11901"></a><span class="lineno">11901</span>&#160;            $cy2 = ($this-&gt;h - ($py2 - $qy2));</div>
<div class="line"><a name="l11902"></a><span class="lineno">11902</span>&#160;            $cx3 = $px2;</div>
<div class="line"><a name="l11903"></a><span class="lineno">11903</span>&#160;            $cy3 = ($this-&gt;h - $py2);</div>
<div class="line"><a name="l11904"></a><span class="lineno">11904</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a90efde54832587803c17467bfff03038">_outCurve</a>($cx1, $cy1, $cx2, $cy2, $cx3, $cy3);</div>
<div class="line"><a name="l11905"></a><span class="lineno">11905</span>&#160;            <span class="comment">// get bounding box coordinates</span></div>
<div class="line"><a name="l11906"></a><span class="lineno">11906</span>&#160;            $xmin = min($xmin, $cx1, $cx2, $cx3);</div>
<div class="line"><a name="l11907"></a><span class="lineno">11907</span>&#160;            $ymin = min($ymin, $cy1, $cy2, $cy3);</div>
<div class="line"><a name="l11908"></a><span class="lineno">11908</span>&#160;            $xmax = max($xmax, $cx1, $cx2, $cx3);</div>
<div class="line"><a name="l11909"></a><span class="lineno">11909</span>&#160;            $ymax = max($ymax, $cy1, $cy2, $cy3);</div>
<div class="line"><a name="l11910"></a><span class="lineno">11910</span>&#160;            <span class="comment">// move to next point</span></div>
<div class="line"><a name="l11911"></a><span class="lineno">11911</span>&#160;            $px1 = $px2;</div>
<div class="line"><a name="l11912"></a><span class="lineno">11912</span>&#160;            $py1 = $py2;</div>
<div class="line"><a name="l11913"></a><span class="lineno">11913</span>&#160;            $qx1 = $qx2;</div>
<div class="line"><a name="l11914"></a><span class="lineno">11914</span>&#160;            $qy1 = $qy2;</div>
<div class="line"><a name="l11915"></a><span class="lineno">11915</span>&#160;        }</div>
<div class="line"><a name="l11916"></a><span class="lineno">11916</span>&#160;        <span class="keywordflow">if</span> ($pie) {</div>
<div class="line"><a name="l11917"></a><span class="lineno">11917</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af5e5357f5db0128c824f0a22cab63719">_outLine</a>($xc, $yc);</div>
<div class="line"><a name="l11918"></a><span class="lineno">11918</span>&#160;            <span class="comment">// get bounding box coordinates</span></div>
<div class="line"><a name="l11919"></a><span class="lineno">11919</span>&#160;            $xmin = min($xmin, $xc);</div>
<div class="line"><a name="l11920"></a><span class="lineno">11920</span>&#160;            $ymin = min($ymin, $yc);</div>
<div class="line"><a name="l11921"></a><span class="lineno">11921</span>&#160;            $xmax = max($xmax, $xc);</div>
<div class="line"><a name="l11922"></a><span class="lineno">11922</span>&#160;            $ymax = max($ymax, $yc);</div>
<div class="line"><a name="l11923"></a><span class="lineno">11923</span>&#160;        }</div>
<div class="line"><a name="l11924"></a><span class="lineno">11924</span>&#160;        <span class="keywordflow">return</span> array($xmin, $ymin, $xmax, $ymax);</div>
<div class="line"><a name="l11925"></a><span class="lineno">11925</span>&#160;    }</div>
<div class="line"><a name="l11926"></a><span class="lineno">11926</span>&#160;</div>
<div class="line"><a name="l11942"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a7e7f5d97a5c33e2245d3860aed35a593">11942</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a7e7f5d97a5c33e2245d3860aed35a593">Circle</a>($x0, $y0, $r, $angstr=0, $angend=360, $style=<span class="stringliteral">&#39;&#39;</span>, $line_style=array(), $fill_color=array(), $nc=2) {</div>
<div class="line"><a name="l11943"></a><span class="lineno">11943</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ab45f86866ef0d753a8fca04dddd63d68">Ellipse</a>($x0, $y0, $r, $r, 0, $angstr, $angend, $style, $line_style, $fill_color, $nc);</div>
<div class="line"><a name="l11944"></a><span class="lineno">11944</span>&#160;    }</div>
<div class="line"><a name="l11945"></a><span class="lineno">11945</span>&#160;</div>
<div class="line"><a name="l11960"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a4afa2740651c35051628d9a9a1d1edb8">11960</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a4afa2740651c35051628d9a9a1d1edb8">PolyLine</a>($p, $style=<span class="stringliteral">&#39;&#39;</span>, $line_style=array(), $fill_color=array()) {</div>
<div class="line"><a name="l11961"></a><span class="lineno">11961</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a2aa8a59e174cfa8f61eb1a33489ce16b">Polygon</a>($p, $style, $line_style, $fill_color, <span class="keyword">false</span>);</div>
<div class="line"><a name="l11962"></a><span class="lineno">11962</span>&#160;    }</div>
<div class="line"><a name="l11963"></a><span class="lineno">11963</span>&#160;</div>
<div class="line"><a name="l11979"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a2aa8a59e174cfa8f61eb1a33489ce16b">11979</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a2aa8a59e174cfa8f61eb1a33489ce16b">Polygon</a>($p, $style=<span class="stringliteral">&#39;&#39;</span>, $line_style=array(), $fill_color=array(), $closed=<span class="keyword">true</span>) {</div>
<div class="line"><a name="l11980"></a><span class="lineno">11980</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;state != 2) {</div>
<div class="line"><a name="l11981"></a><span class="lineno">11981</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l11982"></a><span class="lineno">11982</span>&#160;        }</div>
<div class="line"><a name="l11983"></a><span class="lineno">11983</span>&#160;        $nc = count($p); <span class="comment">// number of coordinates</span></div>
<div class="line"><a name="l11984"></a><span class="lineno">11984</span>&#160;        $np = $nc / 2; <span class="comment">// number of points</span></div>
<div class="line"><a name="l11985"></a><span class="lineno">11985</span>&#160;        <span class="keywordflow">if</span> ($closed) {</div>
<div class="line"><a name="l11986"></a><span class="lineno">11986</span>&#160;            <span class="comment">// close polygon by adding the first 2 points at the end (one line)</span></div>
<div class="line"><a name="l11987"></a><span class="lineno">11987</span>&#160;            <span class="keywordflow">for</span> ($i = 0; $i &lt; 4; ++$i) {</div>
<div class="line"><a name="l11988"></a><span class="lineno">11988</span>&#160;                $p[$nc + $i] = $p[$i];</div>
<div class="line"><a name="l11989"></a><span class="lineno">11989</span>&#160;            }</div>
<div class="line"><a name="l11990"></a><span class="lineno">11990</span>&#160;            <span class="comment">// copy style for the last added line</span></div>
<div class="line"><a name="l11991"></a><span class="lineno">11991</span>&#160;            <span class="keywordflow">if</span> (isset($line_style[0])) {</div>
<div class="line"><a name="l11992"></a><span class="lineno">11992</span>&#160;                $line_style[$np] = $line_style[0];</div>
<div class="line"><a name="l11993"></a><span class="lineno">11993</span>&#160;            }</div>
<div class="line"><a name="l11994"></a><span class="lineno">11994</span>&#160;            $nc += 4;</div>
<div class="line"><a name="l11995"></a><span class="lineno">11995</span>&#160;        }</div>
<div class="line"><a name="l11996"></a><span class="lineno">11996</span>&#160;        <span class="keywordflow">if</span> (!(<span class="keyword">false</span> === strpos($style, <span class="charliteral">&#39;F&#39;</span>)) AND isset($fill_color)) {</div>
<div class="line"><a name="l11997"></a><span class="lineno">11997</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a850dd347f649c99548a193f2b84a502e">SetFillColorArray</a>($fill_color);</div>
<div class="line"><a name="l11998"></a><span class="lineno">11998</span>&#160;        }</div>
<div class="line"><a name="l11999"></a><span class="lineno">11999</span>&#160;        $op = TCPDF_STATIC::getPathPaintOperator($style);</div>
<div class="line"><a name="l12000"></a><span class="lineno">12000</span>&#160;        <span class="keywordflow">if</span> ($op == <span class="charliteral">&#39;f&#39;</span>) {</div>
<div class="line"><a name="l12001"></a><span class="lineno">12001</span>&#160;            $line_style = array();</div>
<div class="line"><a name="l12002"></a><span class="lineno">12002</span>&#160;        }</div>
<div class="line"><a name="l12003"></a><span class="lineno">12003</span>&#160;        $draw = <span class="keyword">true</span>;</div>
<div class="line"><a name="l12004"></a><span class="lineno">12004</span>&#160;        <span class="keywordflow">if</span> ($line_style) {</div>
<div class="line"><a name="l12005"></a><span class="lineno">12005</span>&#160;            <span class="keywordflow">if</span> (isset($line_style[<span class="stringliteral">&#39;all&#39;</span>])) {</div>
<div class="line"><a name="l12006"></a><span class="lineno">12006</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a3d9b3717cd9ad8db31642155c832d148">SetLineStyle</a>($line_style[<span class="stringliteral">&#39;all&#39;</span>]);</div>
<div class="line"><a name="l12007"></a><span class="lineno">12007</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l12008"></a><span class="lineno">12008</span>&#160;                $draw = <span class="keyword">false</span>;</div>
<div class="line"><a name="l12009"></a><span class="lineno">12009</span>&#160;                <span class="keywordflow">if</span> ($op == <span class="charliteral">&#39;B&#39;</span>) {</div>
<div class="line"><a name="l12010"></a><span class="lineno">12010</span>&#160;                    <span class="comment">// draw fill</span></div>
<div class="line"><a name="l12011"></a><span class="lineno">12011</span>&#160;                    $op = <span class="charliteral">&#39;f&#39;</span>;</div>
<div class="line"><a name="l12012"></a><span class="lineno">12012</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ab0a7280484f906a0b2d58e3a15dbb469">_outPoint</a>($p[0], $p[1]);</div>
<div class="line"><a name="l12013"></a><span class="lineno">12013</span>&#160;                    <span class="keywordflow">for</span> ($i = 2; $i &lt; $nc; $i = $i + 2) {</div>
<div class="line"><a name="l12014"></a><span class="lineno">12014</span>&#160;                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af5e5357f5db0128c824f0a22cab63719">_outLine</a>($p[$i], $p[$i + 1]);</div>
<div class="line"><a name="l12015"></a><span class="lineno">12015</span>&#160;                    }</div>
<div class="line"><a name="l12016"></a><span class="lineno">12016</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($op);</div>
<div class="line"><a name="l12017"></a><span class="lineno">12017</span>&#160;                }</div>
<div class="line"><a name="l12018"></a><span class="lineno">12018</span>&#160;                <span class="comment">// draw outline</span></div>
<div class="line"><a name="l12019"></a><span class="lineno">12019</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ab0a7280484f906a0b2d58e3a15dbb469">_outPoint</a>($p[0], $p[1]);</div>
<div class="line"><a name="l12020"></a><span class="lineno">12020</span>&#160;                <span class="keywordflow">for</span> ($i = 2; $i &lt; $nc; $i = $i + 2) {</div>
<div class="line"><a name="l12021"></a><span class="lineno">12021</span>&#160;                    $line_num = ($i / 2) - 1;</div>
<div class="line"><a name="l12022"></a><span class="lineno">12022</span>&#160;                    <span class="keywordflow">if</span> (isset($line_style[$line_num])) {</div>
<div class="line"><a name="l12023"></a><span class="lineno">12023</span>&#160;                        <span class="keywordflow">if</span> ($line_style[$line_num] != 0) {</div>
<div class="line"><a name="l12024"></a><span class="lineno">12024</span>&#160;                            <span class="keywordflow">if</span> (is_array($line_style[$line_num])) {</div>
<div class="line"><a name="l12025"></a><span class="lineno">12025</span>&#160;                                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(<span class="charliteral">&#39;S&#39;</span>);</div>
<div class="line"><a name="l12026"></a><span class="lineno">12026</span>&#160;                                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a3d9b3717cd9ad8db31642155c832d148">SetLineStyle</a>($line_style[$line_num]);</div>
<div class="line"><a name="l12027"></a><span class="lineno">12027</span>&#160;                                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ab0a7280484f906a0b2d58e3a15dbb469">_outPoint</a>($p[$i - 2], $p[$i - 1]);</div>
<div class="line"><a name="l12028"></a><span class="lineno">12028</span>&#160;                                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af5e5357f5db0128c824f0a22cab63719">_outLine</a>($p[$i], $p[$i + 1]);</div>
<div class="line"><a name="l12029"></a><span class="lineno">12029</span>&#160;                                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(<span class="charliteral">&#39;S&#39;</span>);</div>
<div class="line"><a name="l12030"></a><span class="lineno">12030</span>&#160;                                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ab0a7280484f906a0b2d58e3a15dbb469">_outPoint</a>($p[$i], $p[$i + 1]);</div>
<div class="line"><a name="l12031"></a><span class="lineno">12031</span>&#160;                            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l12032"></a><span class="lineno">12032</span>&#160;                                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af5e5357f5db0128c824f0a22cab63719">_outLine</a>($p[$i], $p[$i + 1]);</div>
<div class="line"><a name="l12033"></a><span class="lineno">12033</span>&#160;                            }</div>
<div class="line"><a name="l12034"></a><span class="lineno">12034</span>&#160;                        }</div>
<div class="line"><a name="l12035"></a><span class="lineno">12035</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l12036"></a><span class="lineno">12036</span>&#160;                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af5e5357f5db0128c824f0a22cab63719">_outLine</a>($p[$i], $p[$i + 1]);</div>
<div class="line"><a name="l12037"></a><span class="lineno">12037</span>&#160;                    }</div>
<div class="line"><a name="l12038"></a><span class="lineno">12038</span>&#160;                }</div>
<div class="line"><a name="l12039"></a><span class="lineno">12039</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($op);</div>
<div class="line"><a name="l12040"></a><span class="lineno">12040</span>&#160;            }</div>
<div class="line"><a name="l12041"></a><span class="lineno">12041</span>&#160;        }</div>
<div class="line"><a name="l12042"></a><span class="lineno">12042</span>&#160;        <span class="keywordflow">if</span> ($draw) {</div>
<div class="line"><a name="l12043"></a><span class="lineno">12043</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ab0a7280484f906a0b2d58e3a15dbb469">_outPoint</a>($p[0], $p[1]);</div>
<div class="line"><a name="l12044"></a><span class="lineno">12044</span>&#160;            <span class="keywordflow">for</span> ($i = 2; $i &lt; $nc; $i = $i + 2) {</div>
<div class="line"><a name="l12045"></a><span class="lineno">12045</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af5e5357f5db0128c824f0a22cab63719">_outLine</a>($p[$i], $p[$i + 1]);</div>
<div class="line"><a name="l12046"></a><span class="lineno">12046</span>&#160;            }</div>
<div class="line"><a name="l12047"></a><span class="lineno">12047</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($op);</div>
<div class="line"><a name="l12048"></a><span class="lineno">12048</span>&#160;        }</div>
<div class="line"><a name="l12049"></a><span class="lineno">12049</span>&#160;    }</div>
<div class="line"><a name="l12050"></a><span class="lineno">12050</span>&#160;</div>
<div class="line"><a name="l12080"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#add34ab0872e65557749d744941fd435d">12080</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#add34ab0872e65557749d744941fd435d">RegularPolygon</a>($x0, $y0, $r, $ns, $angle=0, $draw_circle=<span class="keyword">false</span>, $style=<span class="stringliteral">&#39;&#39;</span>, $line_style=array(), $fill_color=array(), $circle_style=<span class="stringliteral">&#39;&#39;</span>, $circle_outLine_style=array(), $circle_fill_color=array()) {</div>
<div class="line"><a name="l12081"></a><span class="lineno">12081</span>&#160;        <span class="keywordflow">if</span> (3 &gt; $ns) {</div>
<div class="line"><a name="l12082"></a><span class="lineno">12082</span>&#160;            $ns = 3;</div>
<div class="line"><a name="l12083"></a><span class="lineno">12083</span>&#160;        }</div>
<div class="line"><a name="l12084"></a><span class="lineno">12084</span>&#160;        <span class="keywordflow">if</span> ($draw_circle) {</div>
<div class="line"><a name="l12085"></a><span class="lineno">12085</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a7e7f5d97a5c33e2245d3860aed35a593">Circle</a>($x0, $y0, $r, 0, 360, $circle_style, $circle_outLine_style, $circle_fill_color);</div>
<div class="line"><a name="l12086"></a><span class="lineno">12086</span>&#160;        }</div>
<div class="line"><a name="l12087"></a><span class="lineno">12087</span>&#160;        $p = array();</div>
<div class="line"><a name="l12088"></a><span class="lineno">12088</span>&#160;        <span class="keywordflow">for</span> ($i = 0; $i &lt; $ns; ++$i) {</div>
<div class="line"><a name="l12089"></a><span class="lineno">12089</span>&#160;            $a = $angle + ($i * 360 / $ns);</div>
<div class="line"><a name="l12090"></a><span class="lineno">12090</span>&#160;            $a_rad = deg2rad((<span class="keywordtype">float</span>) $a);</div>
<div class="line"><a name="l12091"></a><span class="lineno">12091</span>&#160;            $p[] = $x0 + ($r * sin($a_rad));</div>
<div class="line"><a name="l12092"></a><span class="lineno">12092</span>&#160;            $p[] = $y0 + ($r * cos($a_rad));</div>
<div class="line"><a name="l12093"></a><span class="lineno">12093</span>&#160;        }</div>
<div class="line"><a name="l12094"></a><span class="lineno">12094</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a2aa8a59e174cfa8f61eb1a33489ce16b">Polygon</a>($p, $style, $line_style, $fill_color);</div>
<div class="line"><a name="l12095"></a><span class="lineno">12095</span>&#160;    }</div>
<div class="line"><a name="l12096"></a><span class="lineno">12096</span>&#160;</div>
<div class="line"><a name="l12128"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aa57e6af79ccaf81eeeeb97d5eae93ecf">12128</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#aa57e6af79ccaf81eeeeb97d5eae93ecf">StarPolygon</a>($x0, $y0, $r, $nv, $ng, $angle=0, $draw_circle=<span class="keyword">false</span>, $style=<span class="stringliteral">&#39;&#39;</span>, $line_style=array(), $fill_color=array(), $circle_style=<span class="stringliteral">&#39;&#39;</span>, $circle_outLine_style=array(), $circle_fill_color=array()) {</div>
<div class="line"><a name="l12129"></a><span class="lineno">12129</span>&#160;        <span class="keywordflow">if</span> ($nv &lt; 2) {</div>
<div class="line"><a name="l12130"></a><span class="lineno">12130</span>&#160;            $nv = 2;</div>
<div class="line"><a name="l12131"></a><span class="lineno">12131</span>&#160;        }</div>
<div class="line"><a name="l12132"></a><span class="lineno">12132</span>&#160;        <span class="keywordflow">if</span> ($draw_circle) {</div>
<div class="line"><a name="l12133"></a><span class="lineno">12133</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a7e7f5d97a5c33e2245d3860aed35a593">Circle</a>($x0, $y0, $r, 0, 360, $circle_style, $circle_outLine_style, $circle_fill_color);</div>
<div class="line"><a name="l12134"></a><span class="lineno">12134</span>&#160;        }</div>
<div class="line"><a name="l12135"></a><span class="lineno">12135</span>&#160;        $p2 = array();</div>
<div class="line"><a name="l12136"></a><span class="lineno">12136</span>&#160;        $visited = array();</div>
<div class="line"><a name="l12137"></a><span class="lineno">12137</span>&#160;        <span class="keywordflow">for</span> ($i = 0; $i &lt; $nv; ++$i) {</div>
<div class="line"><a name="l12138"></a><span class="lineno">12138</span>&#160;            $a = $angle + ($i * 360 / $nv);</div>
<div class="line"><a name="l12139"></a><span class="lineno">12139</span>&#160;            $a_rad = deg2rad((<span class="keywordtype">float</span>) $a);</div>
<div class="line"><a name="l12140"></a><span class="lineno">12140</span>&#160;            $p2[] = $x0 + ($r * sin($a_rad));</div>
<div class="line"><a name="l12141"></a><span class="lineno">12141</span>&#160;            $p2[] = $y0 + ($r * cos($a_rad));</div>
<div class="line"><a name="l12142"></a><span class="lineno">12142</span>&#160;            $visited[] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l12143"></a><span class="lineno">12143</span>&#160;        }</div>
<div class="line"><a name="l12144"></a><span class="lineno">12144</span>&#160;        $p = array();</div>
<div class="line"><a name="l12145"></a><span class="lineno">12145</span>&#160;        $i = 0;</div>
<div class="line"><a name="l12146"></a><span class="lineno">12146</span>&#160;        <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l12147"></a><span class="lineno">12147</span>&#160;            $p[] = $p2[$i * 2];</div>
<div class="line"><a name="l12148"></a><span class="lineno">12148</span>&#160;            $p[] = $p2[($i * 2) + 1];</div>
<div class="line"><a name="l12149"></a><span class="lineno">12149</span>&#160;            $visited[$i] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l12150"></a><span class="lineno">12150</span>&#160;            $i += $ng;</div>
<div class="line"><a name="l12151"></a><span class="lineno">12151</span>&#160;            $i %= $nv;</div>
<div class="line"><a name="l12152"></a><span class="lineno">12152</span>&#160;        } <span class="keywordflow">while</span> (!$visited[$i]);</div>
<div class="line"><a name="l12153"></a><span class="lineno">12153</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a2aa8a59e174cfa8f61eb1a33489ce16b">Polygon</a>($p, $style, $line_style, $fill_color);</div>
<div class="line"><a name="l12154"></a><span class="lineno">12154</span>&#160;    }</div>
<div class="line"><a name="l12155"></a><span class="lineno">12155</span>&#160;</div>
<div class="line"><a name="l12170"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a5fa62d7764cd7f3ff96fb902bf2ad7c5">12170</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a5fa62d7764cd7f3ff96fb902bf2ad7c5">RoundedRect</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $r, $round_corner=<span class="stringliteral">&#39;1111&#39;</span>, $style=<span class="stringliteral">&#39;&#39;</span>, $border_style=array(), $fill_color=array()) {</div>
<div class="line"><a name="l12171"></a><span class="lineno">12171</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aae395cced777e52fac95cbbba28af98a">RoundedRectXY</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $r, $r, $round_corner, $style, $border_style, $fill_color);</div>
<div class="line"><a name="l12172"></a><span class="lineno">12172</span>&#160;    }</div>
<div class="line"><a name="l12173"></a><span class="lineno">12173</span>&#160;</div>
<div class="line"><a name="l12189"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aae395cced777e52fac95cbbba28af98a">12189</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#aae395cced777e52fac95cbbba28af98a">RoundedRectXY</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $rx, $ry, $round_corner=<span class="stringliteral">&#39;1111&#39;</span>, $style=<span class="stringliteral">&#39;&#39;</span>, $border_style=array(), $fill_color=array()) {</div>
<div class="line"><a name="l12190"></a><span class="lineno">12190</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;state != 2) {</div>
<div class="line"><a name="l12191"></a><span class="lineno">12191</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l12192"></a><span class="lineno">12192</span>&#160;        }</div>
<div class="line"><a name="l12193"></a><span class="lineno">12193</span>&#160;        <span class="keywordflow">if</span> (($round_corner == <span class="stringliteral">&#39;0000&#39;</span>) OR (($rx == $ry) AND ($rx == 0))) {</div>
<div class="line"><a name="l12194"></a><span class="lineno">12194</span>&#160;            <span class="comment">// Not rounded</span></div>
<div class="line"><a name="l12195"></a><span class="lineno">12195</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8fc7b86c255aeb0f14d281bdaeb2015c">Rect</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $style, $border_style, $fill_color);</div>
<div class="line"><a name="l12196"></a><span class="lineno">12196</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l12197"></a><span class="lineno">12197</span>&#160;        }</div>
<div class="line"><a name="l12198"></a><span class="lineno">12198</span>&#160;        <span class="comment">// Rounded</span></div>
<div class="line"><a name="l12199"></a><span class="lineno">12199</span>&#160;        <span class="keywordflow">if</span> (!(<span class="keyword">false</span> === strpos($style, <span class="charliteral">&#39;F&#39;</span>)) AND isset($fill_color)) {</div>
<div class="line"><a name="l12200"></a><span class="lineno">12200</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a850dd347f649c99548a193f2b84a502e">SetFillColorArray</a>($fill_color);</div>
<div class="line"><a name="l12201"></a><span class="lineno">12201</span>&#160;        }</div>
<div class="line"><a name="l12202"></a><span class="lineno">12202</span>&#160;        $op = TCPDF_STATIC::getPathPaintOperator($style);</div>
<div class="line"><a name="l12203"></a><span class="lineno">12203</span>&#160;        <span class="keywordflow">if</span> ($op == <span class="charliteral">&#39;f&#39;</span>) {</div>
<div class="line"><a name="l12204"></a><span class="lineno">12204</span>&#160;            $border_style = array();</div>
<div class="line"><a name="l12205"></a><span class="lineno">12205</span>&#160;        }</div>
<div class="line"><a name="l12206"></a><span class="lineno">12206</span>&#160;        <span class="keywordflow">if</span> ($border_style) {</div>
<div class="line"><a name="l12207"></a><span class="lineno">12207</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a3d9b3717cd9ad8db31642155c832d148">SetLineStyle</a>($border_style);</div>
<div class="line"><a name="l12208"></a><span class="lineno">12208</span>&#160;        }</div>
<div class="line"><a name="l12209"></a><span class="lineno">12209</span>&#160;        $MyArc = 4 / 3 * (sqrt(2) - 1);</div>
<div class="line"><a name="l12210"></a><span class="lineno">12210</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ab0a7280484f906a0b2d58e3a15dbb469">_outPoint</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> + $rx, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>);</div>
<div class="line"><a name="l12211"></a><span class="lineno">12211</span>&#160;        $xc = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> + <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> - $rx;</div>
<div class="line"><a name="l12212"></a><span class="lineno">12212</span>&#160;        $yc = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> + $ry;</div>
<div class="line"><a name="l12213"></a><span class="lineno">12213</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af5e5357f5db0128c824f0a22cab63719">_outLine</a>($xc, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>);</div>
<div class="line"><a name="l12214"></a><span class="lineno">12214</span>&#160;        <span class="keywordflow">if</span> ($round_corner[0]) {</div>
<div class="line"><a name="l12215"></a><span class="lineno">12215</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a90efde54832587803c17467bfff03038">_outCurve</a>($xc + ($rx * $MyArc), $yc - $ry, $xc + $rx, $yc - ($ry * $MyArc), $xc + $rx, $yc);</div>
<div class="line"><a name="l12216"></a><span class="lineno">12216</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l12217"></a><span class="lineno">12217</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af5e5357f5db0128c824f0a22cab63719">_outLine</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> + <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>);</div>
<div class="line"><a name="l12218"></a><span class="lineno">12218</span>&#160;        }</div>
<div class="line"><a name="l12219"></a><span class="lineno">12219</span>&#160;        $xc = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> + <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> - $rx;</div>
<div class="line"><a name="l12220"></a><span class="lineno">12220</span>&#160;        $yc = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> + <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> - $ry;</div>
<div class="line"><a name="l12221"></a><span class="lineno">12221</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af5e5357f5db0128c824f0a22cab63719">_outLine</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> + <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, $yc);</div>
<div class="line"><a name="l12222"></a><span class="lineno">12222</span>&#160;        <span class="keywordflow">if</span> ($round_corner[1]) {</div>
<div class="line"><a name="l12223"></a><span class="lineno">12223</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a90efde54832587803c17467bfff03038">_outCurve</a>($xc + $rx, $yc + ($ry * $MyArc), $xc + ($rx * $MyArc), $yc + $ry, $xc, $yc + $ry);</div>
<div class="line"><a name="l12224"></a><span class="lineno">12224</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l12225"></a><span class="lineno">12225</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af5e5357f5db0128c824f0a22cab63719">_outLine</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> + <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> + <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>);</div>
<div class="line"><a name="l12226"></a><span class="lineno">12226</span>&#160;        }</div>
<div class="line"><a name="l12227"></a><span class="lineno">12227</span>&#160;        $xc = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> + $rx;</div>
<div class="line"><a name="l12228"></a><span class="lineno">12228</span>&#160;        $yc = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> + <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> - $ry;</div>
<div class="line"><a name="l12229"></a><span class="lineno">12229</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af5e5357f5db0128c824f0a22cab63719">_outLine</a>($xc, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> + <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>);</div>
<div class="line"><a name="l12230"></a><span class="lineno">12230</span>&#160;        <span class="keywordflow">if</span> ($round_corner[2]) {</div>
<div class="line"><a name="l12231"></a><span class="lineno">12231</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a90efde54832587803c17467bfff03038">_outCurve</a>($xc - ($rx * $MyArc), $yc + $ry, $xc - $rx, $yc + ($ry * $MyArc), $xc - $rx, $yc);</div>
<div class="line"><a name="l12232"></a><span class="lineno">12232</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l12233"></a><span class="lineno">12233</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af5e5357f5db0128c824f0a22cab63719">_outLine</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> + <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>);</div>
<div class="line"><a name="l12234"></a><span class="lineno">12234</span>&#160;        }</div>
<div class="line"><a name="l12235"></a><span class="lineno">12235</span>&#160;        $xc = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> + $rx;</div>
<div class="line"><a name="l12236"></a><span class="lineno">12236</span>&#160;        $yc = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> + $ry;</div>
<div class="line"><a name="l12237"></a><span class="lineno">12237</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af5e5357f5db0128c824f0a22cab63719">_outLine</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, $yc);</div>
<div class="line"><a name="l12238"></a><span class="lineno">12238</span>&#160;        <span class="keywordflow">if</span> ($round_corner[3]) {</div>
<div class="line"><a name="l12239"></a><span class="lineno">12239</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a90efde54832587803c17467bfff03038">_outCurve</a>($xc - $rx, $yc - ($ry * $MyArc), $xc - ($rx * $MyArc), $yc - $ry, $xc, $yc - $ry);</div>
<div class="line"><a name="l12240"></a><span class="lineno">12240</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l12241"></a><span class="lineno">12241</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af5e5357f5db0128c824f0a22cab63719">_outLine</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>);</div>
<div class="line"><a name="l12242"></a><span class="lineno">12242</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af5e5357f5db0128c824f0a22cab63719">_outLine</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> + $rx, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>);</div>
<div class="line"><a name="l12243"></a><span class="lineno">12243</span>&#160;        }</div>
<div class="line"><a name="l12244"></a><span class="lineno">12244</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($op);</div>
<div class="line"><a name="l12245"></a><span class="lineno">12245</span>&#160;    }</div>
<div class="line"><a name="l12246"></a><span class="lineno">12246</span>&#160;</div>
<div class="line"><a name="l12259"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ada0489b022bfd41ff1fa7a3fd666831a">12259</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ada0489b022bfd41ff1fa7a3fd666831a">Arrow</a>($x0, $y0, $x1, $y1, $head_style=0, $arm_size=5, $arm_angle=15) {</div>
<div class="line"><a name="l12260"></a><span class="lineno">12260</span>&#160;        <span class="comment">// getting arrow direction angle</span></div>
<div class="line"><a name="l12261"></a><span class="lineno">12261</span>&#160;        <span class="comment">// 0 deg angle is when both arms go along X axis. angle grows clockwise.</span></div>
<div class="line"><a name="l12262"></a><span class="lineno">12262</span>&#160;        $dir_angle = atan2(($y0 - $y1), ($x0 - $x1));</div>
<div class="line"><a name="l12263"></a><span class="lineno">12263</span>&#160;        <span class="keywordflow">if</span> ($dir_angle &lt; 0) {</div>
<div class="line"><a name="l12264"></a><span class="lineno">12264</span>&#160;            $dir_angle += (2 * M_PI);</div>
<div class="line"><a name="l12265"></a><span class="lineno">12265</span>&#160;        }</div>
<div class="line"><a name="l12266"></a><span class="lineno">12266</span>&#160;        $arm_angle = deg2rad($arm_angle);</div>
<div class="line"><a name="l12267"></a><span class="lineno">12267</span>&#160;        $sx1 = $x1;</div>
<div class="line"><a name="l12268"></a><span class="lineno">12268</span>&#160;        $sy1 = $y1;</div>
<div class="line"><a name="l12269"></a><span class="lineno">12269</span>&#160;        <span class="keywordflow">if</span> ($head_style &gt; 0) {</div>
<div class="line"><a name="l12270"></a><span class="lineno">12270</span>&#160;            <span class="comment">// calculate the stopping point for the arrow shaft</span></div>
<div class="line"><a name="l12271"></a><span class="lineno">12271</span>&#160;            $sx1 = $x1 + (($arm_size - <a class="code" href="../../d4/d40/classTCPDF.html#a5971d565157974939d3edf96baeb0eeb">$this-&gt;LineWidth</a>) * cos($dir_angle));</div>
<div class="line"><a name="l12272"></a><span class="lineno">12272</span>&#160;            $sy1 = $y1 + (($arm_size - <a class="code" href="../../d4/d40/classTCPDF.html#a5971d565157974939d3edf96baeb0eeb">$this-&gt;LineWidth</a>) * sin($dir_angle));</div>
<div class="line"><a name="l12273"></a><span class="lineno">12273</span>&#160;        }</div>
<div class="line"><a name="l12274"></a><span class="lineno">12274</span>&#160;        <span class="comment">// main arrow line / shaft</span></div>
<div class="line"><a name="l12275"></a><span class="lineno">12275</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a89c0fac95da962719ba92b057df9c201">Line</a>($x0, $y0, $sx1, $sy1);</div>
<div class="line"><a name="l12276"></a><span class="lineno">12276</span>&#160;        <span class="comment">// left arrowhead arm tip</span></div>
<div class="line"><a name="l12277"></a><span class="lineno">12277</span>&#160;        $x2L = $x1 + ($arm_size * cos($dir_angle + $arm_angle));</div>
<div class="line"><a name="l12278"></a><span class="lineno">12278</span>&#160;        $y2L = $y1 + ($arm_size * sin($dir_angle + $arm_angle));</div>
<div class="line"><a name="l12279"></a><span class="lineno">12279</span>&#160;        <span class="comment">// right arrowhead arm tip</span></div>
<div class="line"><a name="l12280"></a><span class="lineno">12280</span>&#160;        $x2R = $x1 + ($arm_size * cos($dir_angle - $arm_angle));</div>
<div class="line"><a name="l12281"></a><span class="lineno">12281</span>&#160;        $y2R = $y1 + ($arm_size * sin($dir_angle - $arm_angle));</div>
<div class="line"><a name="l12282"></a><span class="lineno">12282</span>&#160;        $mode = <span class="charliteral">&#39;D&#39;</span>;</div>
<div class="line"><a name="l12283"></a><span class="lineno">12283</span>&#160;        $style = array();</div>
<div class="line"><a name="l12284"></a><span class="lineno">12284</span>&#160;        <span class="keywordflow">switch</span> ($head_style) {</div>
<div class="line"><a name="l12285"></a><span class="lineno">12285</span>&#160;            <span class="keywordflow">case</span> 0: {</div>
<div class="line"><a name="l12286"></a><span class="lineno">12286</span>&#160;                <span class="comment">// draw only arrowhead arms</span></div>
<div class="line"><a name="l12287"></a><span class="lineno">12287</span>&#160;                $mode = <span class="charliteral">&#39;D&#39;</span>;</div>
<div class="line"><a name="l12288"></a><span class="lineno">12288</span>&#160;                $style = array(1, 1, 0);</div>
<div class="line"><a name="l12289"></a><span class="lineno">12289</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l12290"></a><span class="lineno">12290</span>&#160;            }</div>
<div class="line"><a name="l12291"></a><span class="lineno">12291</span>&#160;            <span class="keywordflow">case</span> 1: {</div>
<div class="line"><a name="l12292"></a><span class="lineno">12292</span>&#160;                <span class="comment">// draw closed arrowhead, but no fill</span></div>
<div class="line"><a name="l12293"></a><span class="lineno">12293</span>&#160;                $mode = <span class="charliteral">&#39;D&#39;</span>;</div>
<div class="line"><a name="l12294"></a><span class="lineno">12294</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l12295"></a><span class="lineno">12295</span>&#160;            }</div>
<div class="line"><a name="l12296"></a><span class="lineno">12296</span>&#160;            <span class="keywordflow">case</span> 2: {</div>
<div class="line"><a name="l12297"></a><span class="lineno">12297</span>&#160;                <span class="comment">// closed and filled arrowhead</span></div>
<div class="line"><a name="l12298"></a><span class="lineno">12298</span>&#160;                $mode = <span class="stringliteral">&#39;DF&#39;</span>;</div>
<div class="line"><a name="l12299"></a><span class="lineno">12299</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l12300"></a><span class="lineno">12300</span>&#160;            }</div>
<div class="line"><a name="l12301"></a><span class="lineno">12301</span>&#160;            <span class="keywordflow">case</span> 3: {</div>
<div class="line"><a name="l12302"></a><span class="lineno">12302</span>&#160;                <span class="comment">// filled arrowhead</span></div>
<div class="line"><a name="l12303"></a><span class="lineno">12303</span>&#160;                $mode = <span class="charliteral">&#39;F&#39;</span>;</div>
<div class="line"><a name="l12304"></a><span class="lineno">12304</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l12305"></a><span class="lineno">12305</span>&#160;            }</div>
<div class="line"><a name="l12306"></a><span class="lineno">12306</span>&#160;        }</div>
<div class="line"><a name="l12307"></a><span class="lineno">12307</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a2aa8a59e174cfa8f61eb1a33489ce16b">Polygon</a>(array($x2L, $y2L, $x1, $y1, $x2R, $y2R), $mode, $style, array());</div>
<div class="line"><a name="l12308"></a><span class="lineno">12308</span>&#160;    }</div>
<div class="line"><a name="l12309"></a><span class="lineno">12309</span>&#160;</div>
<div class="line"><a name="l12310"></a><span class="lineno">12310</span>&#160;    <span class="comment">// END GRAPHIC FUNCTIONS SECTION -----------------------</span></div>
<div class="line"><a name="l12311"></a><span class="lineno">12311</span>&#160;</div>
<div class="line"><a name="l12324"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a94cc2168d0b49e11f6c4d1420a6eb509">12324</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a94cc2168d0b49e11f6c4d1420a6eb509">setDestination</a>($name, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>=-1, <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>=-1) {</div>
<div class="line"><a name="l12325"></a><span class="lineno">12325</span>&#160;        <span class="comment">// remove unsupported characters</span></div>
<div class="line"><a name="l12326"></a><span class="lineno">12326</span>&#160;        $name = TCPDF_STATIC::encodeNameObject($name);</div>
<div class="line"><a name="l12327"></a><span class="lineno">12327</span>&#160;        <span class="keywordflow">if</span> (TCPDF_STATIC::empty_string($name)) {</div>
<div class="line"><a name="l12328"></a><span class="lineno">12328</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l12329"></a><span class="lineno">12329</span>&#160;        }</div>
<div class="line"><a name="l12330"></a><span class="lineno">12330</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> == -1) {</div>
<div class="line"><a name="l12331"></a><span class="lineno">12331</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ae3b6169ba729309f289a5ac9680dd799">GetY</a>();</div>
<div class="line"><a name="l12332"></a><span class="lineno">12332</span>&#160;        } elseif (<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> &lt; 0) {</div>
<div class="line"><a name="l12333"></a><span class="lineno">12333</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> = 0;</div>
<div class="line"><a name="l12334"></a><span class="lineno">12334</span>&#160;        } elseif (<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> &gt; $this-&gt;h) {</div>
<div class="line"><a name="l12335"></a><span class="lineno">12335</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> = <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$this-&gt;h</a>;</div>
<div class="line"><a name="l12336"></a><span class="lineno">12336</span>&#160;        }</div>
<div class="line"><a name="l12337"></a><span class="lineno">12337</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> == -1) {</div>
<div class="line"><a name="l12338"></a><span class="lineno">12338</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a415a80a301208fa77552048b27d2e0ce">GetX</a>();</div>
<div class="line"><a name="l12339"></a><span class="lineno">12339</span>&#160;        } elseif (<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> &lt; 0) {</div>
<div class="line"><a name="l12340"></a><span class="lineno">12340</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> = 0;</div>
<div class="line"><a name="l12341"></a><span class="lineno">12341</span>&#160;        } elseif (<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> &gt; $this-&gt;w) {</div>
<div class="line"><a name="l12342"></a><span class="lineno">12342</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> = <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$this-&gt;w</a>;</div>
<div class="line"><a name="l12343"></a><span class="lineno">12343</span>&#160;        }</div>
<div class="line"><a name="l12344"></a><span class="lineno">12344</span>&#160;        $fixed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l12345"></a><span class="lineno">12345</span>&#160;        <span class="keywordflow">if</span> (!empty(<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>) AND (<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>[0] == <span class="charliteral">&#39;*&#39;</span>)) {</div>
<div class="line"><a name="l12346"></a><span class="lineno">12346</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a> = intval(substr(<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>, 1));</div>
<div class="line"><a name="l12347"></a><span class="lineno">12347</span>&#160;            <span class="comment">// this page number will not be changed when moving/add/deleting pages</span></div>
<div class="line"><a name="l12348"></a><span class="lineno">12348</span>&#160;            $fixed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l12349"></a><span class="lineno">12349</span>&#160;        }</div>
<div class="line"><a name="l12350"></a><span class="lineno">12350</span>&#160;        <span class="keywordflow">if</span> (empty(<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>)) {</div>
<div class="line"><a name="l12351"></a><span class="lineno">12351</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a> = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a9ad828b184f08828f570a7e52316ba79">PageNo</a>();</div>
<div class="line"><a name="l12352"></a><span class="lineno">12352</span>&#160;            <span class="keywordflow">if</span> (empty(<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>)) {</div>
<div class="line"><a name="l12353"></a><span class="lineno">12353</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l12354"></a><span class="lineno">12354</span>&#160;            }</div>
<div class="line"><a name="l12355"></a><span class="lineno">12355</span>&#160;        }</div>
<div class="line"><a name="l12356"></a><span class="lineno">12356</span>&#160;        $this-&gt;dests[$name] = array(<span class="charliteral">&#39;x&#39;</span> =&gt; <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <span class="charliteral">&#39;y&#39;</span> =&gt; <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <span class="charliteral">&#39;p&#39;</span> =&gt; <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>, <span class="charliteral">&#39;f&#39;</span> =&gt; $fixed);</div>
<div class="line"><a name="l12357"></a><span class="lineno">12357</span>&#160;        <span class="keywordflow">return</span> $name;</div>
<div class="line"><a name="l12358"></a><span class="lineno">12358</span>&#160;    }</div>
<div class="line"><a name="l12359"></a><span class="lineno">12359</span>&#160;</div>
<div class="line"><a name="l12367"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a4a6a1902a07dbb6a98f107ae2b9574ce">12367</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a4a6a1902a07dbb6a98f107ae2b9574ce">getDestination</a>() {</div>
<div class="line"><a name="l12368"></a><span class="lineno">12368</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#a75ae8e6fcf6f618c962e18dc11987753">$this-&gt;dests</a>;</div>
<div class="line"><a name="l12369"></a><span class="lineno">12369</span>&#160;    }</div>
<div class="line"><a name="l12370"></a><span class="lineno">12370</span>&#160;</div>
<div class="line"><a name="l12377"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#abc3ef1743fa889f0190b61d80490a770">12377</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#abc3ef1743fa889f0190b61d80490a770">_putdests</a>() {</div>
<div class="line"><a name="l12378"></a><span class="lineno">12378</span>&#160;        <span class="keywordflow">if</span> (empty($this-&gt;dests)) {</div>
<div class="line"><a name="l12379"></a><span class="lineno">12379</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l12380"></a><span class="lineno">12380</span>&#160;        }</div>
<div class="line"><a name="l12381"></a><span class="lineno">12381</span>&#160;        $this-&gt;n_dests = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d">_newobj</a>();</div>
<div class="line"><a name="l12382"></a><span class="lineno">12382</span>&#160;        $out = <span class="stringliteral">&#39; &lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l12383"></a><span class="lineno">12383</span>&#160;        <span class="keywordflow">foreach</span>($this-&gt;dests as $name =&gt; $o) {</div>
<div class="line"><a name="l12384"></a><span class="lineno">12384</span>&#160;            $out .= <span class="stringliteral">&#39; /&#39;</span>.$name.<span class="charliteral">&#39; &#39;</span>.sprintf(<span class="stringliteral">&#39;[%u 0 R /XYZ %F %F null]&#39;</span>, $this-&gt;page_obj_id[($o[<span class="charliteral">&#39;p&#39;</span>])], ($o[<span class="charliteral">&#39;x&#39;</span>] * $this-&gt;k), ($this-&gt;pagedim[$o[<span class="charliteral">&#39;p&#39;</span>]][<span class="charliteral">&#39;h&#39;</span>] - ($o[<span class="charliteral">&#39;y&#39;</span>] * $this-&gt;k)));</div>
<div class="line"><a name="l12385"></a><span class="lineno">12385</span>&#160;        }</div>
<div class="line"><a name="l12386"></a><span class="lineno">12386</span>&#160;        $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l12387"></a><span class="lineno">12387</span>&#160;        $out .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l12388"></a><span class="lineno">12388</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($out);</div>
<div class="line"><a name="l12389"></a><span class="lineno">12389</span>&#160;    }</div>
<div class="line"><a name="l12390"></a><span class="lineno">12390</span>&#160;</div>
<div class="line"><a name="l12403"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a8a4701753ef6b45df310b34cecde6497">12403</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a8a4701753ef6b45df310b34cecde6497">setBookmark</a>($txt, $level=0, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>=-1, <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>=<span class="stringliteral">&#39;&#39;</span>, $style=<span class="stringliteral">&#39;&#39;</span>, $color=array(0,0,0), <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>=-1, $link=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l12404"></a><span class="lineno">12404</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a2a38a999dd99b95bbd140ea31da36f44">Bookmark</a>($txt, $level, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>, $style, $color, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, $link);</div>
<div class="line"><a name="l12405"></a><span class="lineno">12405</span>&#160;    }</div>
<div class="line"><a name="l12406"></a><span class="lineno">12406</span>&#160;</div>
<div class="line"><a name="l12420"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a2a38a999dd99b95bbd140ea31da36f44">12420</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a2a38a999dd99b95bbd140ea31da36f44">Bookmark</a>($txt, $level=0, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>=-1, <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>=<span class="stringliteral">&#39;&#39;</span>, $style=<span class="stringliteral">&#39;&#39;</span>, $color=array(0,0,0), <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>=-1, $link=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l12421"></a><span class="lineno">12421</span>&#160;        <span class="keywordflow">if</span> ($level &lt; 0) {</div>
<div class="line"><a name="l12422"></a><span class="lineno">12422</span>&#160;            $level = 0;</div>
<div class="line"><a name="l12423"></a><span class="lineno">12423</span>&#160;        }</div>
<div class="line"><a name="l12424"></a><span class="lineno">12424</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;outlines[0])) {</div>
<div class="line"><a name="l12425"></a><span class="lineno">12425</span>&#160;            $lastoutline = end($this-&gt;outlines);</div>
<div class="line"><a name="l12426"></a><span class="lineno">12426</span>&#160;            $maxlevel = $lastoutline[<span class="charliteral">&#39;l&#39;</span>] + 1;</div>
<div class="line"><a name="l12427"></a><span class="lineno">12427</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l12428"></a><span class="lineno">12428</span>&#160;            $maxlevel = 0;</div>
<div class="line"><a name="l12429"></a><span class="lineno">12429</span>&#160;        }</div>
<div class="line"><a name="l12430"></a><span class="lineno">12430</span>&#160;        <span class="keywordflow">if</span> ($level &gt; $maxlevel) {</div>
<div class="line"><a name="l12431"></a><span class="lineno">12431</span>&#160;            $level = $maxlevel;</div>
<div class="line"><a name="l12432"></a><span class="lineno">12432</span>&#160;        }</div>
<div class="line"><a name="l12433"></a><span class="lineno">12433</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> == -1) {</div>
<div class="line"><a name="l12434"></a><span class="lineno">12434</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ae3b6169ba729309f289a5ac9680dd799">GetY</a>();</div>
<div class="line"><a name="l12435"></a><span class="lineno">12435</span>&#160;        } elseif (<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> &lt; 0) {</div>
<div class="line"><a name="l12436"></a><span class="lineno">12436</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> = 0;</div>
<div class="line"><a name="l12437"></a><span class="lineno">12437</span>&#160;        } elseif (<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> &gt; $this-&gt;h) {</div>
<div class="line"><a name="l12438"></a><span class="lineno">12438</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> = <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$this-&gt;h</a>;</div>
<div class="line"><a name="l12439"></a><span class="lineno">12439</span>&#160;        }</div>
<div class="line"><a name="l12440"></a><span class="lineno">12440</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> == -1) {</div>
<div class="line"><a name="l12441"></a><span class="lineno">12441</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a415a80a301208fa77552048b27d2e0ce">GetX</a>();</div>
<div class="line"><a name="l12442"></a><span class="lineno">12442</span>&#160;        } elseif (<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> &lt; 0) {</div>
<div class="line"><a name="l12443"></a><span class="lineno">12443</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> = 0;</div>
<div class="line"><a name="l12444"></a><span class="lineno">12444</span>&#160;        } elseif (<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> &gt; $this-&gt;w) {</div>
<div class="line"><a name="l12445"></a><span class="lineno">12445</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> = <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$this-&gt;w</a>;</div>
<div class="line"><a name="l12446"></a><span class="lineno">12446</span>&#160;        }</div>
<div class="line"><a name="l12447"></a><span class="lineno">12447</span>&#160;        $fixed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l12448"></a><span class="lineno">12448</span>&#160;        <span class="keywordflow">if</span> (!empty(<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>) AND (<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>[0] == <span class="charliteral">&#39;*&#39;</span>)) {</div>
<div class="line"><a name="l12449"></a><span class="lineno">12449</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a> = intval(substr(<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>, 1));</div>
<div class="line"><a name="l12450"></a><span class="lineno">12450</span>&#160;            <span class="comment">// this page number will not be changed when moving/add/deleting pages</span></div>
<div class="line"><a name="l12451"></a><span class="lineno">12451</span>&#160;            $fixed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l12452"></a><span class="lineno">12452</span>&#160;        }</div>
<div class="line"><a name="l12453"></a><span class="lineno">12453</span>&#160;        <span class="keywordflow">if</span> (empty(<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>)) {</div>
<div class="line"><a name="l12454"></a><span class="lineno">12454</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a> = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a9ad828b184f08828f570a7e52316ba79">PageNo</a>();</div>
<div class="line"><a name="l12455"></a><span class="lineno">12455</span>&#160;            <span class="keywordflow">if</span> (empty(<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>)) {</div>
<div class="line"><a name="l12456"></a><span class="lineno">12456</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l12457"></a><span class="lineno">12457</span>&#160;            }</div>
<div class="line"><a name="l12458"></a><span class="lineno">12458</span>&#160;        }</div>
<div class="line"><a name="l12459"></a><span class="lineno">12459</span>&#160;        $this-&gt;outlines[] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; $txt, <span class="charliteral">&#39;l&#39;</span> =&gt; $level, <span class="charliteral">&#39;x&#39;</span> =&gt; <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <span class="charliteral">&#39;y&#39;</span> =&gt; <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <span class="charliteral">&#39;p&#39;</span> =&gt; <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>, <span class="charliteral">&#39;f&#39;</span> =&gt; $fixed, <span class="charliteral">&#39;s&#39;</span> =&gt; strtoupper($style), <span class="charliteral">&#39;c&#39;</span> =&gt; $color, <span class="charliteral">&#39;u&#39;</span> =&gt; $link);</div>
<div class="line"><a name="l12460"></a><span class="lineno">12460</span>&#160;    }</div>
<div class="line"><a name="l12461"></a><span class="lineno">12461</span>&#160;</div>
<div class="line"><a name="l12467"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a40e972ed81a794c72ef784a5ba23bf72">12467</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a40e972ed81a794c72ef784a5ba23bf72">sortBookmarks</a>() {</div>
<div class="line"><a name="l12468"></a><span class="lineno">12468</span>&#160;        <span class="comment">// get sorting columns</span></div>
<div class="line"><a name="l12469"></a><span class="lineno">12469</span>&#160;        $outline_p = array();</div>
<div class="line"><a name="l12470"></a><span class="lineno">12470</span>&#160;        $outline_y = array();</div>
<div class="line"><a name="l12471"></a><span class="lineno">12471</span>&#160;        <span class="keywordflow">foreach</span> ($this-&gt;outlines as $key =&gt; $row) {</div>
<div class="line"><a name="l12472"></a><span class="lineno">12472</span>&#160;            $outline_p[$key] = $row[<span class="charliteral">&#39;p&#39;</span>];</div>
<div class="line"><a name="l12473"></a><span class="lineno">12473</span>&#160;            $outline_k[$key] = $key;</div>
<div class="line"><a name="l12474"></a><span class="lineno">12474</span>&#160;        }</div>
<div class="line"><a name="l12475"></a><span class="lineno">12475</span>&#160;        <span class="comment">// sort outlines by page and original position</span></div>
<div class="line"><a name="l12476"></a><span class="lineno">12476</span>&#160;        array_multisort($outline_p, SORT_NUMERIC, SORT_ASC, $outline_k, SORT_NUMERIC, SORT_ASC, $this-&gt;outlines);</div>
<div class="line"><a name="l12477"></a><span class="lineno">12477</span>&#160;    }</div>
<div class="line"><a name="l12478"></a><span class="lineno">12478</span>&#160;</div>
<div class="line"><a name="l12485"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a42a44895af6f9c61714d178ec0260267">12485</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a42a44895af6f9c61714d178ec0260267">_putbookmarks</a>() {</div>
<div class="line"><a name="l12486"></a><span class="lineno">12486</span>&#160;        $nb = count($this-&gt;outlines);</div>
<div class="line"><a name="l12487"></a><span class="lineno">12487</span>&#160;        <span class="keywordflow">if</span> ($nb == 0) {</div>
<div class="line"><a name="l12488"></a><span class="lineno">12488</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l12489"></a><span class="lineno">12489</span>&#160;        }</div>
<div class="line"><a name="l12490"></a><span class="lineno">12490</span>&#160;        <span class="comment">// sort bookmarks</span></div>
<div class="line"><a name="l12491"></a><span class="lineno">12491</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a40e972ed81a794c72ef784a5ba23bf72">sortBookmarks</a>();</div>
<div class="line"><a name="l12492"></a><span class="lineno">12492</span>&#160;        $lru = array();</div>
<div class="line"><a name="l12493"></a><span class="lineno">12493</span>&#160;        $level = 0;</div>
<div class="line"><a name="l12494"></a><span class="lineno">12494</span>&#160;        <span class="keywordflow">foreach</span> ($this-&gt;outlines as $i =&gt; $o) {</div>
<div class="line"><a name="l12495"></a><span class="lineno">12495</span>&#160;            <span class="keywordflow">if</span> ($o[<span class="charliteral">&#39;l&#39;</span>] &gt; 0) {</div>
<div class="line"><a name="l12496"></a><span class="lineno">12496</span>&#160;                $parent = $lru[($o[<span class="charliteral">&#39;l&#39;</span>] - 1)];</div>
<div class="line"><a name="l12497"></a><span class="lineno">12497</span>&#160;                <span class="comment">//Set parent and last pointers</span></div>
<div class="line"><a name="l12498"></a><span class="lineno">12498</span>&#160;                $this-&gt;outlines[$i][<span class="stringliteral">&#39;parent&#39;</span>] = $parent;</div>
<div class="line"><a name="l12499"></a><span class="lineno">12499</span>&#160;                $this-&gt;outlines[$parent][<span class="stringliteral">&#39;last&#39;</span>] = $i;</div>
<div class="line"><a name="l12500"></a><span class="lineno">12500</span>&#160;                <span class="keywordflow">if</span> ($o[<span class="charliteral">&#39;l&#39;</span>] &gt; $level) {</div>
<div class="line"><a name="l12501"></a><span class="lineno">12501</span>&#160;                    <span class="comment">//Level increasing: set first pointer</span></div>
<div class="line"><a name="l12502"></a><span class="lineno">12502</span>&#160;                    $this-&gt;outlines[$parent][<span class="stringliteral">&#39;first&#39;</span>] = $i;</div>
<div class="line"><a name="l12503"></a><span class="lineno">12503</span>&#160;                }</div>
<div class="line"><a name="l12504"></a><span class="lineno">12504</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l12505"></a><span class="lineno">12505</span>&#160;                $this-&gt;outlines[$i][<span class="stringliteral">&#39;parent&#39;</span>] = $nb;</div>
<div class="line"><a name="l12506"></a><span class="lineno">12506</span>&#160;            }</div>
<div class="line"><a name="l12507"></a><span class="lineno">12507</span>&#160;            <span class="keywordflow">if</span> (($o[<span class="charliteral">&#39;l&#39;</span>] &lt;= $level) AND ($i &gt; 0)) {</div>
<div class="line"><a name="l12508"></a><span class="lineno">12508</span>&#160;                <span class="comment">//Set prev and next pointers</span></div>
<div class="line"><a name="l12509"></a><span class="lineno">12509</span>&#160;                $prev = $lru[$o[<span class="charliteral">&#39;l&#39;</span>]];</div>
<div class="line"><a name="l12510"></a><span class="lineno">12510</span>&#160;                $this-&gt;outlines[$prev][<span class="stringliteral">&#39;next&#39;</span>] = $i;</div>
<div class="line"><a name="l12511"></a><span class="lineno">12511</span>&#160;                $this-&gt;outlines[$i][<span class="stringliteral">&#39;prev&#39;</span>] = $prev;</div>
<div class="line"><a name="l12512"></a><span class="lineno">12512</span>&#160;            }</div>
<div class="line"><a name="l12513"></a><span class="lineno">12513</span>&#160;            $lru[$o[<span class="charliteral">&#39;l&#39;</span>]] = $i;</div>
<div class="line"><a name="l12514"></a><span class="lineno">12514</span>&#160;            $level = $o[<span class="charliteral">&#39;l&#39;</span>];</div>
<div class="line"><a name="l12515"></a><span class="lineno">12515</span>&#160;        }</div>
<div class="line"><a name="l12516"></a><span class="lineno">12516</span>&#160;        <span class="comment">//Outline items</span></div>
<div class="line"><a name="l12517"></a><span class="lineno">12517</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a> = $this-&gt;n + 1;</div>
<div class="line"><a name="l12518"></a><span class="lineno">12518</span>&#160;        $nltags = <span class="stringliteral">&#39;/&lt;br[\s]?\/&gt;|&lt;\/(blockquote|dd|dl|div|dt|h1|h2|h3|h4|h5|h6|hr|li|ol|p|pre|ul|tcpdf|table|tr|td)&gt;/si&#39;</span>;</div>
<div class="line"><a name="l12519"></a><span class="lineno">12519</span>&#160;        <span class="keywordflow">foreach</span> ($this-&gt;outlines as $i =&gt; $o) {</div>
<div class="line"><a name="l12520"></a><span class="lineno">12520</span>&#160;            $oid = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d">_newobj</a>();</div>
<div class="line"><a name="l12521"></a><span class="lineno">12521</span>&#160;            <span class="comment">// covert HTML title to string</span></div>
<div class="line"><a name="l12522"></a><span class="lineno">12522</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a63acf0babc0299784cbb54354329a734">$title</a> = preg_replace($nltags, <span class="stringliteral">&quot;\n&quot;</span>, $o[<span class="charliteral">&#39;t&#39;</span>]);</div>
<div class="line"><a name="l12523"></a><span class="lineno">12523</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a63acf0babc0299784cbb54354329a734">$title</a> = preg_replace(<span class="stringliteral">&quot;/[\r]+/si&quot;</span>, <span class="stringliteral">&#39;&#39;</span>, <a class="code" href="../../d4/d40/classTCPDF.html#a63acf0babc0299784cbb54354329a734">$title</a>);</div>
<div class="line"><a name="l12524"></a><span class="lineno">12524</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a63acf0babc0299784cbb54354329a734">$title</a> = preg_replace(<span class="stringliteral">&quot;/[\n]+/si&quot;</span>, <span class="stringliteral">&quot;\n&quot;</span>, <a class="code" href="../../d4/d40/classTCPDF.html#a63acf0babc0299784cbb54354329a734">$title</a>);</div>
<div class="line"><a name="l12525"></a><span class="lineno">12525</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a63acf0babc0299784cbb54354329a734">$title</a> = strip_tags(<a class="code" href="../../d4/d40/classTCPDF.html#a63acf0babc0299784cbb54354329a734">$title</a>);</div>
<div class="line"><a name="l12526"></a><span class="lineno">12526</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a63acf0babc0299784cbb54354329a734">$title</a> = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#abdc6aa462bc81023df2ec043742bcb4b">stringTrim</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a63acf0babc0299784cbb54354329a734">$title</a>);</div>
<div class="line"><a name="l12527"></a><span class="lineno">12527</span>&#160;            $out = <span class="stringliteral">&#39;&lt;&lt;/Title &#39;</span>.$this-&gt;_textstring(<a class="code" href="../../d4/d40/classTCPDF.html#a63acf0babc0299784cbb54354329a734">$title</a>, $oid);</div>
<div class="line"><a name="l12528"></a><span class="lineno">12528</span>&#160;            $out .= <span class="stringliteral">&#39; /Parent &#39;</span>.($n + $o[<span class="stringliteral">&#39;parent&#39;</span>]).<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l12529"></a><span class="lineno">12529</span>&#160;            <span class="keywordflow">if</span> (isset($o[<span class="stringliteral">&#39;prev&#39;</span>])) {</div>
<div class="line"><a name="l12530"></a><span class="lineno">12530</span>&#160;                $out .= <span class="stringliteral">&#39; /Prev &#39;</span>.($n + $o[<span class="stringliteral">&#39;prev&#39;</span>]).<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l12531"></a><span class="lineno">12531</span>&#160;            }</div>
<div class="line"><a name="l12532"></a><span class="lineno">12532</span>&#160;            <span class="keywordflow">if</span> (isset($o[<span class="stringliteral">&#39;next&#39;</span>])) {</div>
<div class="line"><a name="l12533"></a><span class="lineno">12533</span>&#160;                $out .= <span class="stringliteral">&#39; /Next &#39;</span>.($n + $o[<span class="stringliteral">&#39;next&#39;</span>]).<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l12534"></a><span class="lineno">12534</span>&#160;            }</div>
<div class="line"><a name="l12535"></a><span class="lineno">12535</span>&#160;            <span class="keywordflow">if</span> (isset($o[<span class="stringliteral">&#39;first&#39;</span>])) {</div>
<div class="line"><a name="l12536"></a><span class="lineno">12536</span>&#160;                $out .= <span class="stringliteral">&#39; /First &#39;</span>.($n + $o[<span class="stringliteral">&#39;first&#39;</span>]).<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l12537"></a><span class="lineno">12537</span>&#160;            }</div>
<div class="line"><a name="l12538"></a><span class="lineno">12538</span>&#160;            <span class="keywordflow">if</span> (isset($o[<span class="stringliteral">&#39;last&#39;</span>])) {</div>
<div class="line"><a name="l12539"></a><span class="lineno">12539</span>&#160;                $out .= <span class="stringliteral">&#39; /Last &#39;</span>.($n + $o[<span class="stringliteral">&#39;last&#39;</span>]).<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l12540"></a><span class="lineno">12540</span>&#160;            }</div>
<div class="line"><a name="l12541"></a><span class="lineno">12541</span>&#160;            <span class="keywordflow">if</span> (isset($o[<span class="charliteral">&#39;u&#39;</span>]) AND !empty($o[<span class="charliteral">&#39;u&#39;</span>])) {</div>
<div class="line"><a name="l12542"></a><span class="lineno">12542</span>&#160;                <span class="comment">// link</span></div>
<div class="line"><a name="l12543"></a><span class="lineno">12543</span>&#160;                <span class="keywordflow">if</span> (is_string($o[<span class="charliteral">&#39;u&#39;</span>])) {</div>
<div class="line"><a name="l12544"></a><span class="lineno">12544</span>&#160;                    <span class="keywordflow">if</span> ($o[<span class="charliteral">&#39;u&#39;</span>][0] == <span class="charliteral">&#39;#&#39;</span>) {</div>
<div class="line"><a name="l12545"></a><span class="lineno">12545</span>&#160;                        <span class="comment">// internal destination</span></div>
<div class="line"><a name="l12546"></a><span class="lineno">12546</span>&#160;                        $out .= <span class="stringliteral">&#39; /Dest /&#39;</span>.TCPDF_STATIC::encodeNameObject(substr($o[<span class="charliteral">&#39;u&#39;</span>], 1));</div>
<div class="line"><a name="l12547"></a><span class="lineno">12547</span>&#160;                    } elseif ($o[<span class="charliteral">&#39;u&#39;</span>][0] == <span class="charliteral">&#39;%&#39;</span>) {</div>
<div class="line"><a name="l12548"></a><span class="lineno">12548</span>&#160;                        <span class="comment">// embedded PDF file</span></div>
<div class="line"><a name="l12549"></a><span class="lineno">12549</span>&#160;                        $filename = basename(substr($o[<span class="charliteral">&#39;u&#39;</span>], 1));</div>
<div class="line"><a name="l12550"></a><span class="lineno">12550</span>&#160;                        $out .= <span class="stringliteral">&#39; /A &lt;&lt;/S /GoToE /D [0 /Fit] /NewWindow true /T &lt;&lt; /R /C /P &#39;</span>.($o[<span class="charliteral">&#39;p&#39;</span>] - 1).<span class="stringliteral">&#39; /A &#39;</span>.$this-&gt;embeddedfiles[$filename][<span class="charliteral">&#39;a&#39;</span>].<span class="stringliteral">&#39; &gt;&gt; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l12551"></a><span class="lineno">12551</span>&#160;                    } elseif ($o[<span class="charliteral">&#39;u&#39;</span>][0] == <span class="charliteral">&#39;*&#39;</span>) {</div>
<div class="line"><a name="l12552"></a><span class="lineno">12552</span>&#160;                        <span class="comment">// embedded generic file</span></div>
<div class="line"><a name="l12553"></a><span class="lineno">12553</span>&#160;                        $filename = basename(substr($o[<span class="charliteral">&#39;u&#39;</span>], 1));</div>
<div class="line"><a name="l12554"></a><span class="lineno">12554</span>&#160;                        $jsa = <span class="stringliteral">&#39;var D=event.target.doc;var MyData=D.dataObjects;for (var i in MyData) if (MyData[i].path==&quot;&#39;</span>.$filename.<span class="stringliteral">&#39;&quot;) D.exportDataObject( { cName : MyData[i].name, nLaunch : 2});&#39;</span>;</div>
<div class="line"><a name="l12555"></a><span class="lineno">12555</span>&#160;                        $out .= <span class="stringliteral">&#39; /A &lt;&lt;/S /JavaScript /JS &#39;</span>.$this-&gt;_textstring($jsa, $oid).<span class="stringliteral">&#39;&gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l12556"></a><span class="lineno">12556</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l12557"></a><span class="lineno">12557</span>&#160;                        <span class="comment">// external URI link</span></div>
<div class="line"><a name="l12558"></a><span class="lineno">12558</span>&#160;                        $out .= <span class="stringliteral">&#39; /A &lt;&lt;/S /URI /URI &#39;</span>.$this-&gt;_datastring($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ae4bdb1a4c29d0a0d707caad308dcd320">unhtmlentities</a>($o[<span class="charliteral">&#39;u&#39;</span>]), $oid).<span class="stringliteral">&#39;&gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l12559"></a><span class="lineno">12559</span>&#160;                    }</div>
<div class="line"><a name="l12560"></a><span class="lineno">12560</span>&#160;                } elseif (isset($this-&gt;links[$o[<span class="charliteral">&#39;u&#39;</span>]])) {</div>
<div class="line"><a name="l12561"></a><span class="lineno">12561</span>&#160;                    <span class="comment">// internal link ID</span></div>
<div class="line"><a name="l12562"></a><span class="lineno">12562</span>&#160;                    <a class="code" href="../../d4/d40/classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f">$l</a> = $this-&gt;links[$o[<span class="charliteral">&#39;u&#39;</span>]];</div>
<div class="line"><a name="l12563"></a><span class="lineno">12563</span>&#160;                    <span class="keywordflow">if</span> (isset($this-&gt;page_obj_id[(<a class="code" href="../../d4/d40/classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f">$l</a>[<span class="charliteral">&#39;p&#39;</span>])])) {</div>
<div class="line"><a name="l12564"></a><span class="lineno">12564</span>&#160;                        $out .= sprintf(<span class="stringliteral">&#39; /Dest [%u 0 R /XYZ 0 %F null]&#39;</span>, $this-&gt;page_obj_id[(<a class="code" href="../../d4/d40/classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f">$l</a>[<span class="charliteral">&#39;p&#39;</span>])], ($this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f">$l</a>[<span class="charliteral">&#39;p&#39;</span>]][<span class="charliteral">&#39;h&#39;</span>] - (<a class="code" href="../../d4/d40/classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f">$l</a>[<span class="charliteral">&#39;y&#39;</span>] * $this-&gt;k)));</div>
<div class="line"><a name="l12565"></a><span class="lineno">12565</span>&#160;                    }</div>
<div class="line"><a name="l12566"></a><span class="lineno">12566</span>&#160;                }</div>
<div class="line"><a name="l12567"></a><span class="lineno">12567</span>&#160;            } elseif (isset($this-&gt;page_obj_id[($o[<span class="charliteral">&#39;p&#39;</span>])])) {</div>
<div class="line"><a name="l12568"></a><span class="lineno">12568</span>&#160;                <span class="comment">// link to a page</span></div>
<div class="line"><a name="l12569"></a><span class="lineno">12569</span>&#160;                $out .= <span class="charliteral">&#39; &#39;</span>.sprintf(<span class="stringliteral">&#39;/Dest [%u 0 R /XYZ %F %F null]&#39;</span>, $this-&gt;page_obj_id[($o[<span class="charliteral">&#39;p&#39;</span>])], ($o[<span class="charliteral">&#39;x&#39;</span>] * $this-&gt;k), ($this-&gt;pagedim[$o[<span class="charliteral">&#39;p&#39;</span>]][<span class="charliteral">&#39;h&#39;</span>] - ($o[<span class="charliteral">&#39;y&#39;</span>] * $this-&gt;k)));</div>
<div class="line"><a name="l12570"></a><span class="lineno">12570</span>&#160;            }</div>
<div class="line"><a name="l12571"></a><span class="lineno">12571</span>&#160;            <span class="comment">// set font style</span></div>
<div class="line"><a name="l12572"></a><span class="lineno">12572</span>&#160;            $style = 0;</div>
<div class="line"><a name="l12573"></a><span class="lineno">12573</span>&#160;            <span class="keywordflow">if</span> (!empty($o[<span class="charliteral">&#39;s&#39;</span>])) {</div>
<div class="line"><a name="l12574"></a><span class="lineno">12574</span>&#160;                <span class="comment">// bold</span></div>
<div class="line"><a name="l12575"></a><span class="lineno">12575</span>&#160;                <span class="keywordflow">if</span> (strpos($o[<span class="charliteral">&#39;s&#39;</span>], <span class="charliteral">&#39;B&#39;</span>) !== <span class="keyword">false</span>) {</div>
<div class="line"><a name="l12576"></a><span class="lineno">12576</span>&#160;                    $style |= 2;</div>
<div class="line"><a name="l12577"></a><span class="lineno">12577</span>&#160;                }</div>
<div class="line"><a name="l12578"></a><span class="lineno">12578</span>&#160;                <span class="comment">// oblique</span></div>
<div class="line"><a name="l12579"></a><span class="lineno">12579</span>&#160;                <span class="keywordflow">if</span> (strpos($o[<span class="charliteral">&#39;s&#39;</span>], <span class="charliteral">&#39;I&#39;</span>) !== <span class="keyword">false</span>) {</div>
<div class="line"><a name="l12580"></a><span class="lineno">12580</span>&#160;                    $style |= 1;</div>
<div class="line"><a name="l12581"></a><span class="lineno">12581</span>&#160;                }</div>
<div class="line"><a name="l12582"></a><span class="lineno">12582</span>&#160;            }</div>
<div class="line"><a name="l12583"></a><span class="lineno">12583</span>&#160;            $out .= sprintf(<span class="stringliteral">&#39; /F %d&#39;</span>, $style);</div>
<div class="line"><a name="l12584"></a><span class="lineno">12584</span>&#160;            <span class="comment">// set bookmark color</span></div>
<div class="line"><a name="l12585"></a><span class="lineno">12585</span>&#160;            <span class="keywordflow">if</span> (isset($o[<span class="charliteral">&#39;c&#39;</span>]) AND is_array($o[<span class="charliteral">&#39;c&#39;</span>]) AND (count($o[<span class="charliteral">&#39;c&#39;</span>]) == 3)) {</div>
<div class="line"><a name="l12586"></a><span class="lineno">12586</span>&#160;                $color = array_values($o[<span class="charliteral">&#39;c&#39;</span>]);</div>
<div class="line"><a name="l12587"></a><span class="lineno">12587</span>&#160;                $out .= sprintf(<span class="stringliteral">&#39; /C [%F %F %F]&#39;</span>, ($color[0] / 255), ($color[1] / 255), ($color[2] / 255));</div>
<div class="line"><a name="l12588"></a><span class="lineno">12588</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l12589"></a><span class="lineno">12589</span>&#160;                <span class="comment">// black</span></div>
<div class="line"><a name="l12590"></a><span class="lineno">12590</span>&#160;                $out .= <span class="stringliteral">&#39; /C [0.0 0.0 0.0]&#39;</span>;</div>
<div class="line"><a name="l12591"></a><span class="lineno">12591</span>&#160;            }</div>
<div class="line"><a name="l12592"></a><span class="lineno">12592</span>&#160;            $out .= <span class="stringliteral">&#39; /Count 0&#39;</span>; <span class="comment">// normally closed item</span></div>
<div class="line"><a name="l12593"></a><span class="lineno">12593</span>&#160;            $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l12594"></a><span class="lineno">12594</span>&#160;            $out .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l12595"></a><span class="lineno">12595</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($out);</div>
<div class="line"><a name="l12596"></a><span class="lineno">12596</span>&#160;        }</div>
<div class="line"><a name="l12597"></a><span class="lineno">12597</span>&#160;        <span class="comment">//Outline root</span></div>
<div class="line"><a name="l12598"></a><span class="lineno">12598</span>&#160;        $this-&gt;OutlineRoot = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d">_newobj</a>();</div>
<div class="line"><a name="l12599"></a><span class="lineno">12599</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(<span class="stringliteral">&#39;&lt;&lt; /Type /Outlines /First &#39;</span>.<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>.<span class="stringliteral">&#39; 0 R /Last &#39;</span>.(<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a> + $lru[0]).<span class="stringliteral">&#39; 0 R &gt;&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>);</div>
<div class="line"><a name="l12600"></a><span class="lineno">12600</span>&#160;    }</div>
<div class="line"><a name="l12601"></a><span class="lineno">12601</span>&#160;</div>
<div class="line"><a name="l12602"></a><span class="lineno">12602</span>&#160;    <span class="comment">// --- JAVASCRIPT ------------------------------------------------------</span></div>
<div class="line"><a name="l12603"></a><span class="lineno">12603</span>&#160;</div>
<div class="line"><a name="l12611"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a057c8815533ff886e4b23a9780e31f78">12611</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a057c8815533ff886e4b23a9780e31f78">IncludeJS</a>($script) {</div>
<div class="line"><a name="l12612"></a><span class="lineno">12612</span>&#160;        $this-&gt;javascript .= $script;</div>
<div class="line"><a name="l12613"></a><span class="lineno">12613</span>&#160;    }</div>
<div class="line"><a name="l12614"></a><span class="lineno">12614</span>&#160;</div>
<div class="line"><a name="l12624"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ac9c37f99a7bbc56109a019f4d5fab568">12624</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ac9c37f99a7bbc56109a019f4d5fab568">addJavascriptObject</a>($script, $onload=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l12625"></a><span class="lineno">12625</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;pdfa_mode) {</div>
<div class="line"><a name="l12626"></a><span class="lineno">12626</span>&#160;            <span class="comment">// javascript is not allowed in PDF/A mode</span></div>
<div class="line"><a name="l12627"></a><span class="lineno">12627</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l12628"></a><span class="lineno">12628</span>&#160;        }</div>
<div class="line"><a name="l12629"></a><span class="lineno">12629</span>&#160;        ++<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$this-&gt;n</a>;</div>
<div class="line"><a name="l12630"></a><span class="lineno">12630</span>&#160;        $this-&gt;js_objects[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$this-&gt;n</a>] = array(<span class="charliteral">&#39;n&#39;</span> =&gt; $this-&gt;n, <span class="stringliteral">&#39;js&#39;</span> =&gt; $script, <span class="stringliteral">&#39;onload&#39;</span> =&gt; $onload);</div>
<div class="line"><a name="l12631"></a><span class="lineno">12631</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$this-&gt;n</a>;</div>
<div class="line"><a name="l12632"></a><span class="lineno">12632</span>&#160;    }</div>
<div class="line"><a name="l12633"></a><span class="lineno">12633</span>&#160;</div>
<div class="line"><a name="l12640"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a3ddff5ab94a793cf535b06de3e773826">12640</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a3ddff5ab94a793cf535b06de3e773826">_putjavascript</a>() {</div>
<div class="line"><a name="l12641"></a><span class="lineno">12641</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;pdfa_mode OR (empty($this-&gt;javascript) AND empty($this-&gt;js_objects))) {</div>
<div class="line"><a name="l12642"></a><span class="lineno">12642</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l12643"></a><span class="lineno">12643</span>&#160;        }</div>
<div class="line"><a name="l12644"></a><span class="lineno">12644</span>&#160;        <span class="keywordflow">if</span> (strpos($this-&gt;javascript, <span class="stringliteral">&#39;this.addField&#39;</span>) &gt; 0) {</div>
<div class="line"><a name="l12645"></a><span class="lineno">12645</span>&#160;            <span class="keywordflow">if</span> (!$this-&gt;ur[<span class="stringliteral">&#39;enabled&#39;</span>]) {</div>
<div class="line"><a name="l12646"></a><span class="lineno">12646</span>&#160;                <span class="comment">//$this-&gt;setUserRights();</span></div>
<div class="line"><a name="l12647"></a><span class="lineno">12647</span>&#160;            }</div>
<div class="line"><a name="l12648"></a><span class="lineno">12648</span>&#160;            <span class="comment">// the following two lines are used to avoid form fields duplication after saving</span></div>
<div class="line"><a name="l12649"></a><span class="lineno">12649</span>&#160;            <span class="comment">// The addField method only works when releasing user rights (UR3)</span></div>
<div class="line"><a name="l12650"></a><span class="lineno">12650</span>&#160;            $jsa = sprintf(<span class="stringliteral">&quot;ftcpdfdocsaved=this.addField(&#39;%s&#39;,&#39;%s&#39;,%d,[%F,%F,%F,%F]);&quot;</span>, <span class="stringliteral">&#39;tcpdfdocsaved&#39;</span>, <span class="stringliteral">&#39;text&#39;</span>, 0, 0, 1, 0, 1);</div>
<div class="line"><a name="l12651"></a><span class="lineno">12651</span>&#160;            $jsb = <span class="stringliteral">&quot;getField(&#39;tcpdfdocsaved&#39;).value=&#39;saved&#39;;&quot;</span>;</div>
<div class="line"><a name="l12652"></a><span class="lineno">12652</span>&#160;            $this-&gt;javascript = $jsa.<span class="stringliteral">&quot;\n&quot;</span>.$this-&gt;javascript.<span class="stringliteral">&quot;\n&quot;</span>.$jsb;</div>
<div class="line"><a name="l12653"></a><span class="lineno">12653</span>&#160;        }</div>
<div class="line"><a name="l12654"></a><span class="lineno">12654</span>&#160;        <span class="comment">// name tree for javascript</span></div>
<div class="line"><a name="l12655"></a><span class="lineno">12655</span>&#160;        $this-&gt;n_js = <span class="stringliteral">&#39;&lt;&lt; /Names [&#39;</span>;</div>
<div class="line"><a name="l12656"></a><span class="lineno">12656</span>&#160;        <span class="keywordflow">if</span> (!empty($this-&gt;javascript)) {</div>
<div class="line"><a name="l12657"></a><span class="lineno">12657</span>&#160;            $this-&gt;n_js .= <span class="stringliteral">&#39; (EmbeddedJS) &#39;</span>.($this-&gt;n + 1).<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l12658"></a><span class="lineno">12658</span>&#160;        }</div>
<div class="line"><a name="l12659"></a><span class="lineno">12659</span>&#160;        <span class="keywordflow">if</span> (!empty($this-&gt;js_objects)) {</div>
<div class="line"><a name="l12660"></a><span class="lineno">12660</span>&#160;            <span class="keywordflow">foreach</span> ($this-&gt;js_objects as $key =&gt; $val) {</div>
<div class="line"><a name="l12661"></a><span class="lineno">12661</span>&#160;                <span class="keywordflow">if</span> ($val[<span class="stringliteral">&#39;onload&#39;</span>]) {</div>
<div class="line"><a name="l12662"></a><span class="lineno">12662</span>&#160;                    $this-&gt;n_js .= <span class="stringliteral">&#39; (JS&#39;</span>.$key.<span class="stringliteral">&#39;) &#39;</span>.$key.<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l12663"></a><span class="lineno">12663</span>&#160;                }</div>
<div class="line"><a name="l12664"></a><span class="lineno">12664</span>&#160;            }</div>
<div class="line"><a name="l12665"></a><span class="lineno">12665</span>&#160;        }</div>
<div class="line"><a name="l12666"></a><span class="lineno">12666</span>&#160;        $this-&gt;n_js .= <span class="stringliteral">&#39; ] &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l12667"></a><span class="lineno">12667</span>&#160;        <span class="comment">// default Javascript object</span></div>
<div class="line"><a name="l12668"></a><span class="lineno">12668</span>&#160;        <span class="keywordflow">if</span> (!empty($this-&gt;javascript)) {</div>
<div class="line"><a name="l12669"></a><span class="lineno">12669</span>&#160;            $obj_id = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d">_newobj</a>();</div>
<div class="line"><a name="l12670"></a><span class="lineno">12670</span>&#160;            $out = <span class="stringliteral">&#39;&lt;&lt; /S /JavaScript&#39;</span>;</div>
<div class="line"><a name="l12671"></a><span class="lineno">12671</span>&#160;            $out .= <span class="stringliteral">&#39; /JS &#39;</span>.$this-&gt;_textstring($this-&gt;javascript, $obj_id);</div>
<div class="line"><a name="l12672"></a><span class="lineno">12672</span>&#160;            $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l12673"></a><span class="lineno">12673</span>&#160;            $out .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l12674"></a><span class="lineno">12674</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($out);</div>
<div class="line"><a name="l12675"></a><span class="lineno">12675</span>&#160;        }</div>
<div class="line"><a name="l12676"></a><span class="lineno">12676</span>&#160;        <span class="comment">// additional Javascript objects</span></div>
<div class="line"><a name="l12677"></a><span class="lineno">12677</span>&#160;        <span class="keywordflow">if</span> (!empty($this-&gt;js_objects)) {</div>
<div class="line"><a name="l12678"></a><span class="lineno">12678</span>&#160;            <span class="keywordflow">foreach</span> ($this-&gt;js_objects as $key =&gt; $val) {</div>
<div class="line"><a name="l12679"></a><span class="lineno">12679</span>&#160;                $out = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1ef3c591556f7668c8a62b81e98da8a1">_getobj</a>($key).<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39; &lt;&lt; /S /JavaScript /JS &#39;</span>.$this-&gt;_textstring($val[<span class="stringliteral">&#39;js&#39;</span>], $key).<span class="stringliteral">&#39; &gt;&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l12680"></a><span class="lineno">12680</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($out);</div>
<div class="line"><a name="l12681"></a><span class="lineno">12681</span>&#160;            }</div>
<div class="line"><a name="l12682"></a><span class="lineno">12682</span>&#160;        }</div>
<div class="line"><a name="l12683"></a><span class="lineno">12683</span>&#160;    }</div>
<div class="line"><a name="l12684"></a><span class="lineno">12684</span>&#160;</div>
<div class="line"><a name="l12698"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a1fc76cf135e8b98b3f654461d8345a57">12698</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a1fc76cf135e8b98b3f654461d8345a57">_addfield</a>($type, $name, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $prop) {</div>
<div class="line"><a name="l12699"></a><span class="lineno">12699</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l12700"></a><span class="lineno">12700</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> - <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>;</div>
<div class="line"><a name="l12701"></a><span class="lineno">12701</span>&#160;        }</div>
<div class="line"><a name="l12702"></a><span class="lineno">12702</span>&#160;        <span class="comment">// the followind avoid fields duplication after saving the document</span></div>
<div class="line"><a name="l12703"></a><span class="lineno">12703</span>&#160;        $this-&gt;javascript .= <span class="stringliteral">&quot;if (getField(&#39;tcpdfdocsaved&#39;).value != &#39;saved&#39;) {&quot;</span>;</div>
<div class="line"><a name="l12704"></a><span class="lineno">12704</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a> = <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>;</div>
<div class="line"><a name="l12705"></a><span class="lineno">12705</span>&#160;        $this-&gt;javascript .= sprintf(<span class="stringliteral">&quot;f&quot;</span>.$name.<span class="stringliteral">&quot;=this.addField(&#39;%s&#39;,&#39;%s&#39;,%u,[%F,%F,%F,%F]);&quot;</span>, $name, $type, $this-&gt;PageNo()-1, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>*<a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a>, ($this-&gt;h-<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>)*$k+1, (<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>+<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>)*<a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a>, ($this-&gt;h-<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>-<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>)*$k+1).<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l12706"></a><span class="lineno">12706</span>&#160;        $this-&gt;javascript .= <span class="charliteral">&#39;f&#39;</span>.$name.<span class="stringliteral">&#39;.textSize=&#39;</span>.$this-&gt;FontSizePt.<span class="stringliteral">&quot;;\n&quot;</span>;</div>
<div class="line"><a name="l12707"></a><span class="lineno">12707</span>&#160;        <span class="keywordflow">while</span> (list($key, $val) = each($prop)) {</div>
<div class="line"><a name="l12708"></a><span class="lineno">12708</span>&#160;            <span class="keywordflow">if</span> (strcmp(substr($key, -5), <span class="stringliteral">&#39;Color&#39;</span>) == 0) {</div>
<div class="line"><a name="l12709"></a><span class="lineno">12709</span>&#160;                $val = TCPDF_COLORS::_JScolor($val);</div>
<div class="line"><a name="l12710"></a><span class="lineno">12710</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l12711"></a><span class="lineno">12711</span>&#160;                $val = <span class="stringliteral">&quot;&#39;&quot;</span>.$val.<span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line"><a name="l12712"></a><span class="lineno">12712</span>&#160;            }</div>
<div class="line"><a name="l12713"></a><span class="lineno">12713</span>&#160;            $this-&gt;javascript .= <span class="charliteral">&#39;f&#39;</span>.$name.<span class="charliteral">&#39;.&#39;</span>.$key.<span class="charliteral">&#39;=&#39;</span>.$val.<span class="stringliteral">&quot;;\n&quot;</span>;</div>
<div class="line"><a name="l12714"></a><span class="lineno">12714</span>&#160;        }</div>
<div class="line"><a name="l12715"></a><span class="lineno">12715</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l12716"></a><span class="lineno">12716</span>&#160;            $this-&gt;x -= <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>;</div>
<div class="line"><a name="l12717"></a><span class="lineno">12717</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l12718"></a><span class="lineno">12718</span>&#160;            $this-&gt;x += <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>;</div>
<div class="line"><a name="l12719"></a><span class="lineno">12719</span>&#160;        }</div>
<div class="line"><a name="l12720"></a><span class="lineno">12720</span>&#160;        $this-&gt;javascript .= <span class="charliteral">&#39;}&#39;</span>;</div>
<div class="line"><a name="l12721"></a><span class="lineno">12721</span>&#160;    }</div>
<div class="line"><a name="l12722"></a><span class="lineno">12722</span>&#160;</div>
<div class="line"><a name="l12723"></a><span class="lineno">12723</span>&#160;    <span class="comment">// --- FORM FIELDS -----------------------------------------------------</span></div>
<div class="line"><a name="l12724"></a><span class="lineno">12724</span>&#160;</div>
<div class="line"><a name="l12725"></a><span class="lineno">12725</span>&#160;</div>
<div class="line"><a name="l12726"></a><span class="lineno">12726</span>&#160;</div>
<div class="line"><a name="l12734"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a1611451af253619217095e279f52fa52">12734</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a1611451af253619217095e279f52fa52">setFormDefaultProp</a>($prop=array()) {</div>
<div class="line"><a name="l12735"></a><span class="lineno">12735</span>&#160;        $this-&gt;default_form_prop = $prop;</div>
<div class="line"><a name="l12736"></a><span class="lineno">12736</span>&#160;    }</div>
<div class="line"><a name="l12737"></a><span class="lineno">12737</span>&#160;</div>
<div class="line"><a name="l12745"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aca1da710f70d3b0e756be97adf23418c">12745</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#aca1da710f70d3b0e756be97adf23418c">getFormDefaultProp</a>() {</div>
<div class="line"><a name="l12746"></a><span class="lineno">12746</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#aac92d698d00f2c049c2941a6faa8253b">$this-&gt;default_form_prop</a>;</div>
<div class="line"><a name="l12747"></a><span class="lineno">12747</span>&#160;    }</div>
<div class="line"><a name="l12748"></a><span class="lineno">12748</span>&#160;</div>
<div class="line"><a name="l12763"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a71d382a4356e7fb3f9fa72e53642c09c">12763</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a71d382a4356e7fb3f9fa72e53642c09c">TextField</a>($name, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $prop=array(), $opt=array(), <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>=<span class="stringliteral">&#39;&#39;</span>, $js=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l12764"></a><span class="lineno">12764</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> === <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l12765"></a><span class="lineno">12765</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$this-&gt;x</a>;</div>
<div class="line"><a name="l12766"></a><span class="lineno">12766</span>&#160;        }</div>
<div class="line"><a name="l12767"></a><span class="lineno">12767</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> === <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l12768"></a><span class="lineno">12768</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l12769"></a><span class="lineno">12769</span>&#160;        }</div>
<div class="line"><a name="l12770"></a><span class="lineno">12770</span>&#160;        <span class="comment">// check page for no-write regions and adapt page margins if necessary</span></div>
<div class="line"><a name="l12771"></a><span class="lineno">12771</span>&#160;        list(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>) = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1d99e81697a90efb13a6734001427f40">checkPageRegions</a>(<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>);</div>
<div class="line"><a name="l12772"></a><span class="lineno">12772</span>&#160;        <span class="keywordflow">if</span> ($js) {</div>
<div class="line"><a name="l12773"></a><span class="lineno">12773</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1fc76cf135e8b98b3f654461d8345a57">_addfield</a>(<span class="stringliteral">&#39;text&#39;</span>, $name, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $prop);</div>
<div class="line"><a name="l12774"></a><span class="lineno">12774</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l12775"></a><span class="lineno">12775</span>&#160;        }</div>
<div class="line"><a name="l12776"></a><span class="lineno">12776</span>&#160;        <span class="comment">// get default style</span></div>
<div class="line"><a name="l12777"></a><span class="lineno">12777</span>&#160;        $prop = array_merge($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aca1da710f70d3b0e756be97adf23418c">getFormDefaultProp</a>(), $prop);</div>
<div class="line"><a name="l12778"></a><span class="lineno">12778</span>&#160;        <span class="comment">// get annotation data</span></div>
<div class="line"><a name="l12779"></a><span class="lineno">12779</span>&#160;        $popt = TCPDF_STATIC::getAnnotOptFromJSProp($prop, $this-&gt;spot_colors, $this-&gt;rtl);</div>
<div class="line"><a name="l12780"></a><span class="lineno">12780</span>&#160;        <span class="comment">// set default appearance stream</span></div>
<div class="line"><a name="l12781"></a><span class="lineno">12781</span>&#160;        $this-&gt;annotation_fonts[$this-&gt;CurrentFont[<span class="stringliteral">&#39;fontkey&#39;</span>]] = $this-&gt;CurrentFont[<span class="charliteral">&#39;i&#39;</span>];</div>
<div class="line"><a name="l12782"></a><span class="lineno">12782</span>&#160;        $fontstyle = sprintf(<span class="stringliteral">&#39;/F%d %F Tf %s&#39;</span>, $this-&gt;CurrentFont[<span class="charliteral">&#39;i&#39;</span>], $this-&gt;FontSizePt, $this-&gt;TextColor);</div>
<div class="line"><a name="l12783"></a><span class="lineno">12783</span>&#160;        $popt[<span class="stringliteral">&#39;da&#39;</span>] = $fontstyle;</div>
<div class="line"><a name="l12784"></a><span class="lineno">12784</span>&#160;        <span class="comment">// build appearance stream</span></div>
<div class="line"><a name="l12785"></a><span class="lineno">12785</span>&#160;        $popt[<span class="stringliteral">&#39;ap&#39;</span>] = array();</div>
<div class="line"><a name="l12786"></a><span class="lineno">12786</span>&#160;        $popt[<span class="stringliteral">&#39;ap&#39;</span>][<span class="charliteral">&#39;n&#39;</span>] = <span class="stringliteral">&#39;/Tx BMC q &#39;</span>.$fontstyle.<span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l12787"></a><span class="lineno">12787</span>&#160;        $text = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l12788"></a><span class="lineno">12788</span>&#160;        <span class="keywordflow">if</span> (isset($prop[<span class="stringliteral">&#39;value&#39;</span>]) AND !empty($prop[<span class="stringliteral">&#39;value&#39;</span>])) {</div>
<div class="line"><a name="l12789"></a><span class="lineno">12789</span>&#160;            $text = $prop[<span class="stringliteral">&#39;value&#39;</span>];</div>
<div class="line"><a name="l12790"></a><span class="lineno">12790</span>&#160;        } elseif (isset($opt[<span class="charliteral">&#39;v&#39;</span>]) AND !empty($opt[<span class="charliteral">&#39;v&#39;</span>])) {</div>
<div class="line"><a name="l12791"></a><span class="lineno">12791</span>&#160;            $text = $opt[<span class="charliteral">&#39;v&#39;</span>];</div>
<div class="line"><a name="l12792"></a><span class="lineno">12792</span>&#160;        }</div>
<div class="line"><a name="l12793"></a><span class="lineno">12793</span>&#160;        $tmpid = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a7eae5df3511dac591b5b76ab5d8b9a68">startTemplate</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l12794"></a><span class="lineno">12794</span>&#160;        $align = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l12795"></a><span class="lineno">12795</span>&#160;        <span class="keywordflow">if</span> (isset($popt[<span class="charliteral">&#39;q&#39;</span>])) {</div>
<div class="line"><a name="l12796"></a><span class="lineno">12796</span>&#160;            <span class="keywordflow">switch</span> ($popt[<span class="charliteral">&#39;q&#39;</span>]) {</div>
<div class="line"><a name="l12797"></a><span class="lineno">12797</span>&#160;                <span class="keywordflow">case</span> 0: {</div>
<div class="line"><a name="l12798"></a><span class="lineno">12798</span>&#160;                    $align = <span class="charliteral">&#39;L&#39;</span>;</div>
<div class="line"><a name="l12799"></a><span class="lineno">12799</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l12800"></a><span class="lineno">12800</span>&#160;                }</div>
<div class="line"><a name="l12801"></a><span class="lineno">12801</span>&#160;                <span class="keywordflow">case</span> 1: {</div>
<div class="line"><a name="l12802"></a><span class="lineno">12802</span>&#160;                    $align = <span class="charliteral">&#39;C&#39;</span>;</div>
<div class="line"><a name="l12803"></a><span class="lineno">12803</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l12804"></a><span class="lineno">12804</span>&#160;                }</div>
<div class="line"><a name="l12805"></a><span class="lineno">12805</span>&#160;                <span class="keywordflow">case</span> 2: {</div>
<div class="line"><a name="l12806"></a><span class="lineno">12806</span>&#160;                    $align = <span class="charliteral">&#39;R&#39;</span>;</div>
<div class="line"><a name="l12807"></a><span class="lineno">12807</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l12808"></a><span class="lineno">12808</span>&#160;                }</div>
<div class="line"><a name="l12809"></a><span class="lineno">12809</span>&#160;                <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l12810"></a><span class="lineno">12810</span>&#160;                    $align = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l12811"></a><span class="lineno">12811</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l12812"></a><span class="lineno">12812</span>&#160;                }</div>
<div class="line"><a name="l12813"></a><span class="lineno">12813</span>&#160;            }</div>
<div class="line"><a name="l12814"></a><span class="lineno">12814</span>&#160;        }</div>
<div class="line"><a name="l12815"></a><span class="lineno">12815</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa81d4b585de305c054760ec983ed3ece">MultiCell</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $text, 0, $align, <span class="keyword">false</span>, 0, 0, 0, <span class="keyword">true</span>, 0, <span class="keyword">false</span>, <span class="keyword">true</span>, 0, <span class="charliteral">&#39;T&#39;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l12816"></a><span class="lineno">12816</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a0b98de81d99a1a0e983dd0016e30fc75">endTemplate</a>();</div>
<div class="line"><a name="l12817"></a><span class="lineno">12817</span>&#160;        --<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$this-&gt;n</a>;</div>
<div class="line"><a name="l12818"></a><span class="lineno">12818</span>&#160;        $popt[<span class="stringliteral">&#39;ap&#39;</span>][<span class="charliteral">&#39;n&#39;</span>] .= $this-&gt;xobjects[$tmpid][<span class="stringliteral">&#39;outdata&#39;</span>];</div>
<div class="line"><a name="l12819"></a><span class="lineno">12819</span>&#160;        unset($this-&gt;xobjects[$tmpid]);</div>
<div class="line"><a name="l12820"></a><span class="lineno">12820</span>&#160;        $popt[<span class="stringliteral">&#39;ap&#39;</span>][<span class="charliteral">&#39;n&#39;</span>] .= <span class="stringliteral">&#39;Q EMC&#39;</span>;</div>
<div class="line"><a name="l12821"></a><span class="lineno">12821</span>&#160;        <span class="comment">// merge options</span></div>
<div class="line"><a name="l12822"></a><span class="lineno">12822</span>&#160;        $opt = array_merge($popt, $opt);</div>
<div class="line"><a name="l12823"></a><span class="lineno">12823</span>&#160;        <span class="comment">// remove some conflicting options</span></div>
<div class="line"><a name="l12824"></a><span class="lineno">12824</span>&#160;        unset($opt[<span class="stringliteral">&#39;bs&#39;</span>]);</div>
<div class="line"><a name="l12825"></a><span class="lineno">12825</span>&#160;        <span class="comment">// set remaining annotation data</span></div>
<div class="line"><a name="l12826"></a><span class="lineno">12826</span>&#160;        $opt[<span class="stringliteral">&#39;Subtype&#39;</span>] = <span class="stringliteral">&#39;Widget&#39;</span>;</div>
<div class="line"><a name="l12827"></a><span class="lineno">12827</span>&#160;        $opt[<span class="stringliteral">&#39;ft&#39;</span>] = <span class="stringliteral">&#39;Tx&#39;</span>;</div>
<div class="line"><a name="l12828"></a><span class="lineno">12828</span>&#160;        $opt[<span class="charliteral">&#39;t&#39;</span>] = $name;</div>
<div class="line"><a name="l12829"></a><span class="lineno">12829</span>&#160;        <span class="comment">// Additional annotation&#39;s parameters (check _putannotsobj() method):</span></div>
<div class="line"><a name="l12830"></a><span class="lineno">12830</span>&#160;        <span class="comment">//$opt[&#39;f&#39;]</span></div>
<div class="line"><a name="l12831"></a><span class="lineno">12831</span>&#160;        <span class="comment">//$opt[&#39;as&#39;]</span></div>
<div class="line"><a name="l12832"></a><span class="lineno">12832</span>&#160;        <span class="comment">//$opt[&#39;bs&#39;]</span></div>
<div class="line"><a name="l12833"></a><span class="lineno">12833</span>&#160;        <span class="comment">//$opt[&#39;be&#39;]</span></div>
<div class="line"><a name="l12834"></a><span class="lineno">12834</span>&#160;        <span class="comment">//$opt[&#39;c&#39;]</span></div>
<div class="line"><a name="l12835"></a><span class="lineno">12835</span>&#160;        <span class="comment">//$opt[&#39;border&#39;]</span></div>
<div class="line"><a name="l12836"></a><span class="lineno">12836</span>&#160;        <span class="comment">//$opt[&#39;h&#39;]</span></div>
<div class="line"><a name="l12837"></a><span class="lineno">12837</span>&#160;        <span class="comment">//$opt[&#39;mk&#39;];</span></div>
<div class="line"><a name="l12838"></a><span class="lineno">12838</span>&#160;        <span class="comment">//$opt[&#39;mk&#39;][&#39;r&#39;]</span></div>
<div class="line"><a name="l12839"></a><span class="lineno">12839</span>&#160;        <span class="comment">//$opt[&#39;mk&#39;][&#39;bc&#39;];</span></div>
<div class="line"><a name="l12840"></a><span class="lineno">12840</span>&#160;        <span class="comment">//$opt[&#39;mk&#39;][&#39;bg&#39;];</span></div>
<div class="line"><a name="l12841"></a><span class="lineno">12841</span>&#160;        unset($opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;ca&#39;</span>]);</div>
<div class="line"><a name="l12842"></a><span class="lineno">12842</span>&#160;        unset($opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;rc&#39;</span>]);</div>
<div class="line"><a name="l12843"></a><span class="lineno">12843</span>&#160;        unset($opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;ac&#39;</span>]);</div>
<div class="line"><a name="l12844"></a><span class="lineno">12844</span>&#160;        unset($opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="charliteral">&#39;i&#39;</span>]);</div>
<div class="line"><a name="l12845"></a><span class="lineno">12845</span>&#160;        unset($opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;ri&#39;</span>]);</div>
<div class="line"><a name="l12846"></a><span class="lineno">12846</span>&#160;        unset($opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;ix&#39;</span>]);</div>
<div class="line"><a name="l12847"></a><span class="lineno">12847</span>&#160;        unset($opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;if&#39;</span>]);</div>
<div class="line"><a name="l12848"></a><span class="lineno">12848</span>&#160;        <span class="comment">//$opt[&#39;mk&#39;][&#39;if&#39;][&#39;sw&#39;];</span></div>
<div class="line"><a name="l12849"></a><span class="lineno">12849</span>&#160;        <span class="comment">//$opt[&#39;mk&#39;][&#39;if&#39;][&#39;s&#39;];</span></div>
<div class="line"><a name="l12850"></a><span class="lineno">12850</span>&#160;        <span class="comment">//$opt[&#39;mk&#39;][&#39;if&#39;][&#39;a&#39;];</span></div>
<div class="line"><a name="l12851"></a><span class="lineno">12851</span>&#160;        <span class="comment">//$opt[&#39;mk&#39;][&#39;if&#39;][&#39;fb&#39;];</span></div>
<div class="line"><a name="l12852"></a><span class="lineno">12852</span>&#160;        unset($opt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;tp&#39;</span>]);</div>
<div class="line"><a name="l12853"></a><span class="lineno">12853</span>&#160;        <span class="comment">//$opt[&#39;tu&#39;]</span></div>
<div class="line"><a name="l12854"></a><span class="lineno">12854</span>&#160;        <span class="comment">//$opt[&#39;tm&#39;]</span></div>
<div class="line"><a name="l12855"></a><span class="lineno">12855</span>&#160;        <span class="comment">//$opt[&#39;ff&#39;]</span></div>
<div class="line"><a name="l12856"></a><span class="lineno">12856</span>&#160;        <span class="comment">//$opt[&#39;v&#39;]</span></div>
<div class="line"><a name="l12857"></a><span class="lineno">12857</span>&#160;        <span class="comment">//$opt[&#39;dv&#39;]</span></div>
<div class="line"><a name="l12858"></a><span class="lineno">12858</span>&#160;        <span class="comment">//$opt[&#39;a&#39;]</span></div>
<div class="line"><a name="l12859"></a><span class="lineno">12859</span>&#160;        <span class="comment">//$opt[&#39;aa&#39;]</span></div>
<div class="line"><a name="l12860"></a><span class="lineno">12860</span>&#160;        <span class="comment">//$opt[&#39;q&#39;]</span></div>
<div class="line"><a name="l12861"></a><span class="lineno">12861</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a6b05e14a0ff7b12eb78f884cabd69e9b">Annotation</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $name, $opt, 0);</div>
<div class="line"><a name="l12862"></a><span class="lineno">12862</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l12863"></a><span class="lineno">12863</span>&#160;            $this-&gt;x -= <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>;</div>
<div class="line"><a name="l12864"></a><span class="lineno">12864</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l12865"></a><span class="lineno">12865</span>&#160;            $this-&gt;x += <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>;</div>
<div class="line"><a name="l12866"></a><span class="lineno">12866</span>&#160;        }</div>
<div class="line"><a name="l12867"></a><span class="lineno">12867</span>&#160;    }</div>
<div class="line"><a name="l12868"></a><span class="lineno">12868</span>&#160;</div>
<div class="line"><a name="l12884"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a8a1af14cce3111886a7ec8024a02bbbc">12884</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a8a1af14cce3111886a7ec8024a02bbbc">RadioButton</a>($name, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, $prop=array(), $opt=array(), $onvalue=<span class="stringliteral">&#39;On&#39;</span>, $checked=<span class="keyword">false</span>, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>=<span class="stringliteral">&#39;&#39;</span>, $js=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l12885"></a><span class="lineno">12885</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> === <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l12886"></a><span class="lineno">12886</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$this-&gt;x</a>;</div>
<div class="line"><a name="l12887"></a><span class="lineno">12887</span>&#160;        }</div>
<div class="line"><a name="l12888"></a><span class="lineno">12888</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> === <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l12889"></a><span class="lineno">12889</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l12890"></a><span class="lineno">12890</span>&#160;        }</div>
<div class="line"><a name="l12891"></a><span class="lineno">12891</span>&#160;        <span class="comment">// check page for no-write regions and adapt page margins if necessary</span></div>
<div class="line"><a name="l12892"></a><span class="lineno">12892</span>&#160;        list(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>) = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1d99e81697a90efb13a6734001427f40">checkPageRegions</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>);</div>
<div class="line"><a name="l12893"></a><span class="lineno">12893</span>&#160;        <span class="keywordflow">if</span> ($js) {</div>
<div class="line"><a name="l12894"></a><span class="lineno">12894</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1fc76cf135e8b98b3f654461d8345a57">_addfield</a>(<span class="stringliteral">&#39;radiobutton&#39;</span>, $name, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, $prop);</div>
<div class="line"><a name="l12895"></a><span class="lineno">12895</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l12896"></a><span class="lineno">12896</span>&#160;        }</div>
<div class="line"><a name="l12897"></a><span class="lineno">12897</span>&#160;        <span class="keywordflow">if</span> (TCPDF_STATIC::empty_string($onvalue)) {</div>
<div class="line"><a name="l12898"></a><span class="lineno">12898</span>&#160;            $onvalue = <span class="stringliteral">&#39;On&#39;</span>;</div>
<div class="line"><a name="l12899"></a><span class="lineno">12899</span>&#160;        }</div>
<div class="line"><a name="l12900"></a><span class="lineno">12900</span>&#160;        <span class="keywordflow">if</span> ($checked) {</div>
<div class="line"><a name="l12901"></a><span class="lineno">12901</span>&#160;            $defval = $onvalue;</div>
<div class="line"><a name="l12902"></a><span class="lineno">12902</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l12903"></a><span class="lineno">12903</span>&#160;            $defval = <span class="stringliteral">&#39;Off&#39;</span>;</div>
<div class="line"><a name="l12904"></a><span class="lineno">12904</span>&#160;        }</div>
<div class="line"><a name="l12905"></a><span class="lineno">12905</span>&#160;        <span class="comment">// set font</span></div>
<div class="line"><a name="l12906"></a><span class="lineno">12906</span>&#160;        $font = <span class="stringliteral">&#39;zapfdingbats&#39;</span>;</div>
<div class="line"><a name="l12907"></a><span class="lineno">12907</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;pdfa_mode) {</div>
<div class="line"><a name="l12908"></a><span class="lineno">12908</span>&#160;            <span class="comment">// all fonts must be embedded</span></div>
<div class="line"><a name="l12909"></a><span class="lineno">12909</span>&#160;            $font = <span class="stringliteral">&#39;pdfa&#39;</span>.$font;</div>
<div class="line"><a name="l12910"></a><span class="lineno">12910</span>&#160;        }</div>
<div class="line"><a name="l12911"></a><span class="lineno">12911</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a06cba4fc5e83b02bb37a947e56196776">AddFont</a>($font);</div>
<div class="line"><a name="l12912"></a><span class="lineno">12912</span>&#160;        $tmpfont = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac63fff093a17846764bbcc09af7c8640">getFontBuffer</a>($font);</div>
<div class="line"><a name="l12913"></a><span class="lineno">12913</span>&#160;        <span class="comment">// set data for parent group</span></div>
<div class="line"><a name="l12914"></a><span class="lineno">12914</span>&#160;        <span class="keywordflow">if</span> (!isset($this-&gt;radiobutton_groups[$this-&gt;page])) {</div>
<div class="line"><a name="l12915"></a><span class="lineno">12915</span>&#160;            $this-&gt;radiobutton_groups[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>] = array();</div>
<div class="line"><a name="l12916"></a><span class="lineno">12916</span>&#160;        }</div>
<div class="line"><a name="l12917"></a><span class="lineno">12917</span>&#160;        <span class="keywordflow">if</span> (!isset($this-&gt;radiobutton_groups[$this-&gt;page][$name])) {</div>
<div class="line"><a name="l12918"></a><span class="lineno">12918</span>&#160;            $this-&gt;radiobutton_groups[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][$name] = array();</div>
<div class="line"><a name="l12919"></a><span class="lineno">12919</span>&#160;            ++<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$this-&gt;n</a>;</div>
<div class="line"><a name="l12920"></a><span class="lineno">12920</span>&#160;            $this-&gt;radiobutton_groups[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][$name][<span class="charliteral">&#39;n&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$this-&gt;n</a>;</div>
<div class="line"><a name="l12921"></a><span class="lineno">12921</span>&#160;            $this-&gt;radio_groups[] = <a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$this-&gt;n</a>;</div>
<div class="line"><a name="l12922"></a><span class="lineno">12922</span>&#160;        }</div>
<div class="line"><a name="l12923"></a><span class="lineno">12923</span>&#160;        $kid = ($this-&gt;n + 1);</div>
<div class="line"><a name="l12924"></a><span class="lineno">12924</span>&#160;        <span class="comment">// save object ID to be added on Kids entry on parent object</span></div>
<div class="line"><a name="l12925"></a><span class="lineno">12925</span>&#160;        $this-&gt;radiobutton_groups[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][$name][] = array(<span class="stringliteral">&#39;kid&#39;</span> =&gt; $kid, <span class="stringliteral">&#39;def&#39;</span> =&gt; $defval);</div>
<div class="line"><a name="l12926"></a><span class="lineno">12926</span>&#160;        <span class="comment">// get default style</span></div>
<div class="line"><a name="l12927"></a><span class="lineno">12927</span>&#160;        $prop = array_merge($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aca1da710f70d3b0e756be97adf23418c">getFormDefaultProp</a>(), $prop);</div>
<div class="line"><a name="l12928"></a><span class="lineno">12928</span>&#160;        $prop[<span class="stringliteral">&#39;NoToggleToOff&#39;</span>] = <span class="stringliteral">&#39;true&#39;</span>;</div>
<div class="line"><a name="l12929"></a><span class="lineno">12929</span>&#160;        $prop[<span class="stringliteral">&#39;Radio&#39;</span>] = <span class="stringliteral">&#39;true&#39;</span>;</div>
<div class="line"><a name="l12930"></a><span class="lineno">12930</span>&#160;        $prop[<span class="stringliteral">&#39;borderStyle&#39;</span>] = <span class="stringliteral">&#39;inset&#39;</span>;</div>
<div class="line"><a name="l12931"></a><span class="lineno">12931</span>&#160;        <span class="comment">// get annotation data</span></div>
<div class="line"><a name="l12932"></a><span class="lineno">12932</span>&#160;        $popt = TCPDF_STATIC::getAnnotOptFromJSProp($prop, $this-&gt;spot_colors, $this-&gt;rtl);</div>
<div class="line"><a name="l12933"></a><span class="lineno">12933</span>&#160;        <span class="comment">// set additional default options</span></div>
<div class="line"><a name="l12934"></a><span class="lineno">12934</span>&#160;        $this-&gt;annotation_fonts[$tmpfont[<span class="stringliteral">&#39;fontkey&#39;</span>]] = $tmpfont[<span class="charliteral">&#39;i&#39;</span>];</div>
<div class="line"><a name="l12935"></a><span class="lineno">12935</span>&#160;        $fontstyle = sprintf(<span class="stringliteral">&#39;/F%d %F Tf %s&#39;</span>, $tmpfont[<span class="charliteral">&#39;i&#39;</span>], $this-&gt;FontSizePt, $this-&gt;TextColor);</div>
<div class="line"><a name="l12936"></a><span class="lineno">12936</span>&#160;        $popt[<span class="stringliteral">&#39;da&#39;</span>] = $fontstyle;</div>
<div class="line"><a name="l12937"></a><span class="lineno">12937</span>&#160;        <span class="comment">// build appearance stream</span></div>
<div class="line"><a name="l12938"></a><span class="lineno">12938</span>&#160;        $popt[<span class="stringliteral">&#39;ap&#39;</span>] = array();</div>
<div class="line"><a name="l12939"></a><span class="lineno">12939</span>&#160;        $popt[<span class="stringliteral">&#39;ap&#39;</span>][<span class="charliteral">&#39;n&#39;</span>] = array();</div>
<div class="line"><a name="l12940"></a><span class="lineno">12940</span>&#160;        $fx = (((<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> - $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a2ade1952794fe6eb23191314fd74550c">getAbsFontMeasure</a>($tmpfont[<span class="stringliteral">&#39;cw&#39;</span>][108])) / 2) * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>);</div>
<div class="line"><a name="l12941"></a><span class="lineno">12941</span>&#160;        $fy = ((<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> - ((($tmpfont[<span class="stringliteral">&#39;desc&#39;</span>][<span class="stringliteral">&#39;Ascent&#39;</span>] - $tmpfont[<span class="stringliteral">&#39;desc&#39;</span>][<span class="stringliteral">&#39;Descent&#39;</span>]) * $this-&gt;FontSizePt / 1000) / <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>)) * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>);</div>
<div class="line"><a name="l12942"></a><span class="lineno">12942</span>&#160;        $popt[<span class="stringliteral">&#39;ap&#39;</span>][<span class="charliteral">&#39;n&#39;</span>][$onvalue] = sprintf(<span class="stringliteral">&#39;q %s BT /F%d %F Tf %F %F Td (&#39;</span>.chr(108).<span class="stringliteral">&#39;) Tj ET Q&#39;</span>, $this-&gt;TextColor, $tmpfont[<span class="charliteral">&#39;i&#39;</span>], $this-&gt;FontSizePt, $fx, $fy);</div>
<div class="line"><a name="l12943"></a><span class="lineno">12943</span>&#160;        $popt[<span class="stringliteral">&#39;ap&#39;</span>][<span class="charliteral">&#39;n&#39;</span>][<span class="stringliteral">&#39;Off&#39;</span>] = sprintf(<span class="stringliteral">&#39;q %s BT /F%d %F Tf %F %F Td (&#39;</span>.chr(109).<span class="stringliteral">&#39;) Tj ET Q&#39;</span>, $this-&gt;TextColor, $tmpfont[<span class="charliteral">&#39;i&#39;</span>], $this-&gt;FontSizePt, $fx, $fy);</div>
<div class="line"><a name="l12944"></a><span class="lineno">12944</span>&#160;        <span class="keywordflow">if</span> (!isset($popt[<span class="stringliteral">&#39;mk&#39;</span>])) {</div>
<div class="line"><a name="l12945"></a><span class="lineno">12945</span>&#160;            $popt[<span class="stringliteral">&#39;mk&#39;</span>] = array();</div>
<div class="line"><a name="l12946"></a><span class="lineno">12946</span>&#160;        }</div>
<div class="line"><a name="l12947"></a><span class="lineno">12947</span>&#160;        $popt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;ca&#39;</span>] = <span class="stringliteral">&#39;(l)&#39;</span>;</div>
<div class="line"><a name="l12948"></a><span class="lineno">12948</span>&#160;        <span class="comment">// merge options</span></div>
<div class="line"><a name="l12949"></a><span class="lineno">12949</span>&#160;        $opt = array_merge($popt, $opt);</div>
<div class="line"><a name="l12950"></a><span class="lineno">12950</span>&#160;        <span class="comment">// set remaining annotation data</span></div>
<div class="line"><a name="l12951"></a><span class="lineno">12951</span>&#160;        $opt[<span class="stringliteral">&#39;Subtype&#39;</span>] = <span class="stringliteral">&#39;Widget&#39;</span>;</div>
<div class="line"><a name="l12952"></a><span class="lineno">12952</span>&#160;        $opt[<span class="stringliteral">&#39;ft&#39;</span>] = <span class="stringliteral">&#39;Btn&#39;</span>;</div>
<div class="line"><a name="l12953"></a><span class="lineno">12953</span>&#160;        <span class="keywordflow">if</span> ($checked) {</div>
<div class="line"><a name="l12954"></a><span class="lineno">12954</span>&#160;            $opt[<span class="charliteral">&#39;v&#39;</span>] = array(<span class="charliteral">&#39;/&#39;</span>.$onvalue);</div>
<div class="line"><a name="l12955"></a><span class="lineno">12955</span>&#160;            $opt[<span class="stringliteral">&#39;as&#39;</span>] = $onvalue;</div>
<div class="line"><a name="l12956"></a><span class="lineno">12956</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l12957"></a><span class="lineno">12957</span>&#160;            $opt[<span class="stringliteral">&#39;as&#39;</span>] = <span class="stringliteral">&#39;Off&#39;</span>;</div>
<div class="line"><a name="l12958"></a><span class="lineno">12958</span>&#160;        }</div>
<div class="line"><a name="l12959"></a><span class="lineno">12959</span>&#160;        <span class="comment">// store readonly flag</span></div>
<div class="line"><a name="l12960"></a><span class="lineno">12960</span>&#160;        <span class="keywordflow">if</span> (!isset($this-&gt;radiobutton_groups[$this-&gt;page][$name][<span class="stringliteral">&#39;#readonly#&#39;</span>])) {</div>
<div class="line"><a name="l12961"></a><span class="lineno">12961</span>&#160;            $this-&gt;radiobutton_groups[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][$name][<span class="stringliteral">&#39;#readonly#&#39;</span>] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l12962"></a><span class="lineno">12962</span>&#160;        }</div>
<div class="line"><a name="l12963"></a><span class="lineno">12963</span>&#160;        $this-&gt;radiobutton_groups[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][$name][<span class="stringliteral">&#39;#readonly#&#39;</span>] |= ($opt[<span class="charliteral">&#39;f&#39;</span>] &amp; 64);</div>
<div class="line"><a name="l12964"></a><span class="lineno">12964</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a6b05e14a0ff7b12eb78f884cabd69e9b">Annotation</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, $name, $opt, 0);</div>
<div class="line"><a name="l12965"></a><span class="lineno">12965</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l12966"></a><span class="lineno">12966</span>&#160;            $this-&gt;x -= <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>;</div>
<div class="line"><a name="l12967"></a><span class="lineno">12967</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l12968"></a><span class="lineno">12968</span>&#160;            $this-&gt;x += <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>;</div>
<div class="line"><a name="l12969"></a><span class="lineno">12969</span>&#160;        }</div>
<div class="line"><a name="l12970"></a><span class="lineno">12970</span>&#160;    }</div>
<div class="line"><a name="l12971"></a><span class="lineno">12971</span>&#160;</div>
<div class="line"><a name="l12987"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a72e9f4b59b7aa0dfd4f96c011d460e56">12987</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a72e9f4b59b7aa0dfd4f96c011d460e56">ListBox</a>($name, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $values, $prop=array(), $opt=array(), <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>=<span class="stringliteral">&#39;&#39;</span>, $js=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l12988"></a><span class="lineno">12988</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> === <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l12989"></a><span class="lineno">12989</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$this-&gt;x</a>;</div>
<div class="line"><a name="l12990"></a><span class="lineno">12990</span>&#160;        }</div>
<div class="line"><a name="l12991"></a><span class="lineno">12991</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> === <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l12992"></a><span class="lineno">12992</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l12993"></a><span class="lineno">12993</span>&#160;        }</div>
<div class="line"><a name="l12994"></a><span class="lineno">12994</span>&#160;        <span class="comment">// check page for no-write regions and adapt page margins if necessary</span></div>
<div class="line"><a name="l12995"></a><span class="lineno">12995</span>&#160;        list(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>) = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1d99e81697a90efb13a6734001427f40">checkPageRegions</a>(<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>);</div>
<div class="line"><a name="l12996"></a><span class="lineno">12996</span>&#160;        <span class="keywordflow">if</span> ($js) {</div>
<div class="line"><a name="l12997"></a><span class="lineno">12997</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1fc76cf135e8b98b3f654461d8345a57">_addfield</a>(<span class="stringliteral">&#39;listbox&#39;</span>, $name, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $prop);</div>
<div class="line"><a name="l12998"></a><span class="lineno">12998</span>&#160;            $s = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l12999"></a><span class="lineno">12999</span>&#160;            <span class="keywordflow">foreach</span> ($values as $value) {</div>
<div class="line"><a name="l13000"></a><span class="lineno">13000</span>&#160;                <span class="keywordflow">if</span> (is_array($value)) {</div>
<div class="line"><a name="l13001"></a><span class="lineno">13001</span>&#160;                    $s .= <span class="stringliteral">&#39;,[\&#39;&#39;</span>.addslashes($value[1]).<span class="charliteral">&#39;\&#39;</span>,\<span class="stringliteral">&#39;&#39;</span>.addslashes($value[0]).<span class="charliteral">&#39;\&#39;</span>]<span class="stringliteral">&#39;;</span></div>
<div class="line"><a name="l13002"></a><span class="lineno">13002</span>&#160;<span class="stringliteral">                } else {</span></div>
<div class="line"><a name="l13003"></a><span class="lineno">13003</span>&#160;<span class="stringliteral">                    $s .= &#39;</span>,[\<span class="stringliteral">&#39;&#39;</span>.addslashes($value).<span class="charliteral">&#39;\&#39;</span>,\<span class="stringliteral">&#39;&#39;</span>.addslashes($value).<span class="charliteral">&#39;\&#39;</span>]<span class="stringliteral">&#39;;</span></div>
<div class="line"><a name="l13004"></a><span class="lineno">13004</span>&#160;<span class="stringliteral">                }</span></div>
<div class="line"><a name="l13005"></a><span class="lineno">13005</span>&#160;<span class="stringliteral">            }</span></div>
<div class="line"><a name="l13006"></a><span class="lineno">13006</span>&#160;<span class="stringliteral">            $this-&gt;javascript .= &#39;</span>f<span class="stringliteral">&#39;.$name.&#39;</span>.setItems(<span class="stringliteral">&#39;.substr($s, 1).&#39;</span>);<span class="stringliteral">&#39;.&quot;\n&quot;;</span></div>
<div class="line"><a name="l13007"></a><span class="lineno">13007</span>&#160;<span class="stringliteral">            return;</span></div>
<div class="line"><a name="l13008"></a><span class="lineno">13008</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l13009"></a><span class="lineno">13009</span>&#160;<span class="stringliteral">        // get default style</span></div>
<div class="line"><a name="l13010"></a><span class="lineno">13010</span>&#160;<span class="stringliteral">        $prop = array_merge($this-&gt;getFormDefaultProp(), $prop);</span></div>
<div class="line"><a name="l13011"></a><span class="lineno">13011</span>&#160;<span class="stringliteral">        // get annotation data</span></div>
<div class="line"><a name="l13012"></a><span class="lineno">13012</span>&#160;<span class="stringliteral">        $popt = TCPDF_STATIC::getAnnotOptFromJSProp($prop, $this-&gt;spot_colors, $this-&gt;rtl);</span></div>
<div class="line"><a name="l13013"></a><span class="lineno">13013</span>&#160;<span class="stringliteral">        // set additional default values</span></div>
<div class="line"><a name="l13014"></a><span class="lineno">13014</span>&#160;<span class="stringliteral">        $this-&gt;annotation_fonts[$this-&gt;CurrentFont[&#39;</span>fontkey<span class="stringliteral">&#39;]] = $this-&gt;CurrentFont[&#39;</span>i<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l13015"></a><span class="lineno">13015</span>&#160;<span class="stringliteral">        $fontstyle = sprintf(&#39;</span>/F%d %F Tf %s<span class="stringliteral">&#39;, $this-&gt;CurrentFont[&#39;</span>i<span class="stringliteral">&#39;], $this-&gt;FontSizePt, $this-&gt;TextColor);</span></div>
<div class="line"><a name="l13016"></a><span class="lineno">13016</span>&#160;<span class="stringliteral">        $popt[&#39;</span>da<span class="stringliteral">&#39;] = $fontstyle;</span></div>
<div class="line"><a name="l13017"></a><span class="lineno">13017</span>&#160;<span class="stringliteral">        // build appearance stream</span></div>
<div class="line"><a name="l13018"></a><span class="lineno">13018</span>&#160;<span class="stringliteral">        $popt[&#39;</span>ap<span class="stringliteral">&#39;] = array();</span></div>
<div class="line"><a name="l13019"></a><span class="lineno">13019</span>&#160;<span class="stringliteral">        $popt[&#39;</span>ap<span class="stringliteral">&#39;][&#39;</span>n<span class="stringliteral">&#39;] = &#39;</span>/Tx BMC q <span class="stringliteral">&#39;.$fontstyle.&#39;</span> <span class="stringliteral">&#39;;</span></div>
<div class="line"><a name="l13020"></a><span class="lineno">13020</span>&#160;<span class="stringliteral">        $text = &#39;</span><span class="stringliteral">&#39;;</span></div>
<div class="line"><a name="l13021"></a><span class="lineno">13021</span>&#160;<span class="stringliteral">        foreach($values as $item) {</span></div>
<div class="line"><a name="l13022"></a><span class="lineno">13022</span>&#160;<span class="stringliteral">            if (is_array($item)) {</span></div>
<div class="line"><a name="l13023"></a><span class="lineno">13023</span>&#160;<span class="stringliteral">                $text .= $item[1].&quot;\n&quot;;</span></div>
<div class="line"><a name="l13024"></a><span class="lineno">13024</span>&#160;<span class="stringliteral">            } else {</span></div>
<div class="line"><a name="l13025"></a><span class="lineno">13025</span>&#160;<span class="stringliteral">                $text .= $item.&quot;\n&quot;;</span></div>
<div class="line"><a name="l13026"></a><span class="lineno">13026</span>&#160;<span class="stringliteral">            }</span></div>
<div class="line"><a name="l13027"></a><span class="lineno">13027</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l13028"></a><span class="lineno">13028</span>&#160;<span class="stringliteral">        $tmpid = $this-&gt;startTemplate($w, $h, false);</span></div>
<div class="line"><a name="l13029"></a><span class="lineno">13029</span>&#160;<span class="stringliteral">        $this-&gt;MultiCell($w, $h, $text, 0, &#39;</span><span class="stringliteral">&#39;, false, 0, 0, 0, true, 0, false, true, 0, &#39;</span>T<span class="stringliteral">&#39;, false);</span></div>
<div class="line"><a name="l13030"></a><span class="lineno">13030</span>&#160;<span class="stringliteral">        $this-&gt;endTemplate();</span></div>
<div class="line"><a name="l13031"></a><span class="lineno">13031</span>&#160;<span class="stringliteral">        --$this-&gt;n;</span></div>
<div class="line"><a name="l13032"></a><span class="lineno">13032</span>&#160;<span class="stringliteral">        $popt[&#39;</span>ap<span class="stringliteral">&#39;][&#39;</span>n<span class="stringliteral">&#39;] .= $this-&gt;xobjects[$tmpid][&#39;</span>outdata<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l13033"></a><span class="lineno">13033</span>&#160;<span class="stringliteral">        unset($this-&gt;xobjects[$tmpid]);</span></div>
<div class="line"><a name="l13034"></a><span class="lineno">13034</span>&#160;<span class="stringliteral">        $popt[&#39;</span>ap<span class="stringliteral">&#39;][&#39;</span>n<span class="stringliteral">&#39;] .= &#39;</span>Q EMC<span class="stringliteral">&#39;;</span></div>
<div class="line"><a name="l13035"></a><span class="lineno">13035</span>&#160;<span class="stringliteral">        // merge options</span></div>
<div class="line"><a name="l13036"></a><span class="lineno">13036</span>&#160;<span class="stringliteral">        $opt = array_merge($popt, $opt);</span></div>
<div class="line"><a name="l13037"></a><span class="lineno">13037</span>&#160;<span class="stringliteral">        // set remaining annotation data</span></div>
<div class="line"><a name="l13038"></a><span class="lineno">13038</span>&#160;<span class="stringliteral">        $opt[&#39;</span>Subtype<span class="stringliteral">&#39;] = &#39;</span>Widget<span class="stringliteral">&#39;;</span></div>
<div class="line"><a name="l13039"></a><span class="lineno">13039</span>&#160;<span class="stringliteral">        $opt[&#39;</span>ft<span class="stringliteral">&#39;] = &#39;</span>Ch<span class="stringliteral">&#39;;</span></div>
<div class="line"><a name="l13040"></a><span class="lineno">13040</span>&#160;<span class="stringliteral">        $opt[&#39;</span>t<span class="stringliteral">&#39;] = $name;</span></div>
<div class="line"><a name="l13041"></a><span class="lineno">13041</span>&#160;<span class="stringliteral">        $opt[&#39;</span>opt<span class="stringliteral">&#39;] = $values;</span></div>
<div class="line"><a name="l13042"></a><span class="lineno">13042</span>&#160;<span class="stringliteral">        unset($opt[&#39;</span>mk<span class="stringliteral">&#39;][&#39;</span>ca<span class="stringliteral">&#39;]);</span></div>
<div class="line"><a name="l13043"></a><span class="lineno">13043</span>&#160;<span class="stringliteral">        unset($opt[&#39;</span>mk<span class="stringliteral">&#39;][&#39;</span>rc<span class="stringliteral">&#39;]);</span></div>
<div class="line"><a name="l13044"></a><span class="lineno">13044</span>&#160;<span class="stringliteral">        unset($opt[&#39;</span>mk<span class="stringliteral">&#39;][&#39;</span>ac<span class="stringliteral">&#39;]);</span></div>
<div class="line"><a name="l13045"></a><span class="lineno">13045</span>&#160;<span class="stringliteral">        unset($opt[&#39;</span>mk<span class="stringliteral">&#39;][&#39;</span>i<span class="stringliteral">&#39;]);</span></div>
<div class="line"><a name="l13046"></a><span class="lineno">13046</span>&#160;<span class="stringliteral">        unset($opt[&#39;</span>mk<span class="stringliteral">&#39;][&#39;</span>ri<span class="stringliteral">&#39;]);</span></div>
<div class="line"><a name="l13047"></a><span class="lineno">13047</span>&#160;<span class="stringliteral">        unset($opt[&#39;</span>mk<span class="stringliteral">&#39;][&#39;</span>ix<span class="stringliteral">&#39;]);</span></div>
<div class="line"><a name="l13048"></a><span class="lineno">13048</span>&#160;<span class="stringliteral">        unset($opt[&#39;</span>mk<span class="stringliteral">&#39;][&#39;</span><span class="keywordflow">if</span><span class="stringliteral">&#39;]);</span></div>
<div class="line"><a name="l13049"></a><span class="lineno">13049</span>&#160;<span class="stringliteral">        unset($opt[&#39;</span>mk<span class="stringliteral">&#39;][&#39;</span>tp<span class="stringliteral">&#39;]);</span></div>
<div class="line"><a name="l13050"></a><span class="lineno">13050</span>&#160;<span class="stringliteral">        $this-&gt;Annotation($x, $y, $w, $h, $name, $opt, 0);</span></div>
<div class="line"><a name="l13051"></a><span class="lineno">13051</span>&#160;<span class="stringliteral">        if ($this-&gt;rtl) {</span></div>
<div class="line"><a name="l13052"></a><span class="lineno">13052</span>&#160;<span class="stringliteral">            $this-&gt;x -= $w;</span></div>
<div class="line"><a name="l13053"></a><span class="lineno">13053</span>&#160;<span class="stringliteral">        } else {</span></div>
<div class="line"><a name="l13054"></a><span class="lineno">13054</span>&#160;<span class="stringliteral">            $this-&gt;x += $w;</span></div>
<div class="line"><a name="l13055"></a><span class="lineno">13055</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l13056"></a><span class="lineno">13056</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l13057"></a><span class="lineno">13057</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l13073"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#af4e1e050349376d6a3174ab31bdde29f">13073</a></span>&#160;<span class="stringliteral">    public function ComboBox($name, $w, $h, $values, $prop=array(), $opt=array(), $x=&#39;</span><span class="stringliteral">&#39;, $y=&#39;</span><span class="stringliteral">&#39;, $js=false) {</span></div>
<div class="line"><a name="l13074"></a><span class="lineno">13074</span>&#160;<span class="stringliteral">        if ($x === &#39;</span><span class="stringliteral">&#39;) {</span></div>
<div class="line"><a name="l13075"></a><span class="lineno">13075</span>&#160;<span class="stringliteral">            $x = $this-&gt;x;</span></div>
<div class="line"><a name="l13076"></a><span class="lineno">13076</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l13077"></a><span class="lineno">13077</span>&#160;<span class="stringliteral">        if ($y === &#39;</span><span class="stringliteral">&#39;) {</span></div>
<div class="line"><a name="l13078"></a><span class="lineno">13078</span>&#160;<span class="stringliteral">            $y = $this-&gt;y;</span></div>
<div class="line"><a name="l13079"></a><span class="lineno">13079</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l13080"></a><span class="lineno">13080</span>&#160;<span class="stringliteral">        // check page for no-write regions and adapt page margins if necessary</span></div>
<div class="line"><a name="l13081"></a><span class="lineno">13081</span>&#160;<span class="stringliteral">        list($x, $y) = $this-&gt;checkPageRegions($h, $x, $y);</span></div>
<div class="line"><a name="l13082"></a><span class="lineno">13082</span>&#160;<span class="stringliteral">        if ($js) {</span></div>
<div class="line"><a name="l13083"></a><span class="lineno">13083</span>&#160;<span class="stringliteral">            $this-&gt;_addfield(&#39;</span>combobox<span class="stringliteral">&#39;, $name, $x, $y, $w, $h, $prop);</span></div>
<div class="line"><a name="l13084"></a><span class="lineno">13084</span>&#160;<span class="stringliteral">            $s = &#39;</span><span class="stringliteral">&#39;;</span></div>
<div class="line"><a name="l13085"></a><span class="lineno">13085</span>&#160;<span class="stringliteral">            foreach ($values as $value) {</span></div>
<div class="line"><a name="l13086"></a><span class="lineno">13086</span>&#160;<span class="stringliteral">                if (is_array($value)) {</span></div>
<div class="line"><a name="l13087"></a><span class="lineno">13087</span>&#160;<span class="stringliteral">                    $s .= &#39;</span>,[\<span class="stringliteral">&#39;&#39;</span>.addslashes($value[1]).<span class="charliteral">&#39;\&#39;</span>,\<span class="stringliteral">&#39;&#39;</span>.addslashes($value[0]).<span class="charliteral">&#39;\&#39;</span>]<span class="stringliteral">&#39;;</span></div>
<div class="line"><a name="l13088"></a><span class="lineno">13088</span>&#160;<span class="stringliteral">                } else {</span></div>
<div class="line"><a name="l13089"></a><span class="lineno">13089</span>&#160;<span class="stringliteral">                    $s .= &#39;</span>,[\<span class="stringliteral">&#39;&#39;</span>.addslashes($value).<span class="charliteral">&#39;\&#39;</span>,\<span class="stringliteral">&#39;&#39;</span>.addslashes($value).<span class="charliteral">&#39;\&#39;</span>]<span class="stringliteral">&#39;;</span></div>
<div class="line"><a name="l13090"></a><span class="lineno">13090</span>&#160;<span class="stringliteral">                }</span></div>
<div class="line"><a name="l13091"></a><span class="lineno">13091</span>&#160;<span class="stringliteral">            }</span></div>
<div class="line"><a name="l13092"></a><span class="lineno">13092</span>&#160;<span class="stringliteral">            $this-&gt;javascript .= &#39;</span>f<span class="stringliteral">&#39;.$name.&#39;</span>.setItems(<span class="stringliteral">&#39;.substr($s, 1).&#39;</span>);<span class="stringliteral">&#39;.&quot;\n&quot;;</span></div>
<div class="line"><a name="l13093"></a><span class="lineno">13093</span>&#160;<span class="stringliteral">            return;</span></div>
<div class="line"><a name="l13094"></a><span class="lineno">13094</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l13095"></a><span class="lineno">13095</span>&#160;<span class="stringliteral">        // get default style</span></div>
<div class="line"><a name="l13096"></a><span class="lineno">13096</span>&#160;<span class="stringliteral">        $prop = array_merge($this-&gt;getFormDefaultProp(), $prop);</span></div>
<div class="line"><a name="l13097"></a><span class="lineno">13097</span>&#160;<span class="stringliteral">        $prop[&#39;</span>Combo<span class="stringliteral">&#39;] = true;</span></div>
<div class="line"><a name="l13098"></a><span class="lineno">13098</span>&#160;<span class="stringliteral">        // get annotation data</span></div>
<div class="line"><a name="l13099"></a><span class="lineno">13099</span>&#160;<span class="stringliteral">        $popt = TCPDF_STATIC::getAnnotOptFromJSProp($prop, $this-&gt;spot_colors, $this-&gt;rtl);</span></div>
<div class="line"><a name="l13100"></a><span class="lineno">13100</span>&#160;<span class="stringliteral">        // set additional default options</span></div>
<div class="line"><a name="l13101"></a><span class="lineno">13101</span>&#160;<span class="stringliteral">        $this-&gt;annotation_fonts[$this-&gt;CurrentFont[&#39;</span>fontkey<span class="stringliteral">&#39;]] = $this-&gt;CurrentFont[&#39;</span>i<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l13102"></a><span class="lineno">13102</span>&#160;<span class="stringliteral">        $fontstyle = sprintf(&#39;</span>/F%d %F Tf %s<span class="stringliteral">&#39;, $this-&gt;CurrentFont[&#39;</span>i<span class="stringliteral">&#39;], $this-&gt;FontSizePt, $this-&gt;TextColor);</span></div>
<div class="line"><a name="l13103"></a><span class="lineno">13103</span>&#160;<span class="stringliteral">        $popt[&#39;</span>da<span class="stringliteral">&#39;] = $fontstyle;</span></div>
<div class="line"><a name="l13104"></a><span class="lineno">13104</span>&#160;<span class="stringliteral">        // build appearance stream</span></div>
<div class="line"><a name="l13105"></a><span class="lineno">13105</span>&#160;<span class="stringliteral">        $popt[&#39;</span>ap<span class="stringliteral">&#39;] = array();</span></div>
<div class="line"><a name="l13106"></a><span class="lineno">13106</span>&#160;<span class="stringliteral">        $popt[&#39;</span>ap<span class="stringliteral">&#39;][&#39;</span>n<span class="stringliteral">&#39;] = &#39;</span>/Tx BMC q <span class="stringliteral">&#39;.$fontstyle.&#39;</span> <span class="stringliteral">&#39;;</span></div>
<div class="line"><a name="l13107"></a><span class="lineno">13107</span>&#160;<span class="stringliteral">        $text = &#39;</span><span class="stringliteral">&#39;;</span></div>
<div class="line"><a name="l13108"></a><span class="lineno">13108</span>&#160;<span class="stringliteral">        foreach($values as $item) {</span></div>
<div class="line"><a name="l13109"></a><span class="lineno">13109</span>&#160;<span class="stringliteral">            if (is_array($item)) {</span></div>
<div class="line"><a name="l13110"></a><span class="lineno">13110</span>&#160;<span class="stringliteral">                $text .= $item[1].&quot;\n&quot;;</span></div>
<div class="line"><a name="l13111"></a><span class="lineno">13111</span>&#160;<span class="stringliteral">            } else {</span></div>
<div class="line"><a name="l13112"></a><span class="lineno">13112</span>&#160;<span class="stringliteral">                $text .= $item.&quot;\n&quot;;</span></div>
<div class="line"><a name="l13113"></a><span class="lineno">13113</span>&#160;<span class="stringliteral">            }</span></div>
<div class="line"><a name="l13114"></a><span class="lineno">13114</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l13115"></a><span class="lineno">13115</span>&#160;<span class="stringliteral">        $tmpid = $this-&gt;startTemplate($w, $h, false);</span></div>
<div class="line"><a name="l13116"></a><span class="lineno">13116</span>&#160;<span class="stringliteral">        $this-&gt;MultiCell($w, $h, $text, 0, &#39;</span><span class="stringliteral">&#39;, false, 0, 0, 0, true, 0, false, true, 0, &#39;</span>T<span class="stringliteral">&#39;, false);</span></div>
<div class="line"><a name="l13117"></a><span class="lineno">13117</span>&#160;<span class="stringliteral">        $this-&gt;endTemplate();</span></div>
<div class="line"><a name="l13118"></a><span class="lineno">13118</span>&#160;<span class="stringliteral">        --$this-&gt;n;</span></div>
<div class="line"><a name="l13119"></a><span class="lineno">13119</span>&#160;<span class="stringliteral">        $popt[&#39;</span>ap<span class="stringliteral">&#39;][&#39;</span>n<span class="stringliteral">&#39;] .= $this-&gt;xobjects[$tmpid][&#39;</span>outdata<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l13120"></a><span class="lineno">13120</span>&#160;<span class="stringliteral">        unset($this-&gt;xobjects[$tmpid]);</span></div>
<div class="line"><a name="l13121"></a><span class="lineno">13121</span>&#160;<span class="stringliteral">        $popt[&#39;</span>ap<span class="stringliteral">&#39;][&#39;</span>n<span class="stringliteral">&#39;] .= &#39;</span>Q EMC<span class="stringliteral">&#39;;</span></div>
<div class="line"><a name="l13122"></a><span class="lineno">13122</span>&#160;<span class="stringliteral">        // merge options</span></div>
<div class="line"><a name="l13123"></a><span class="lineno">13123</span>&#160;<span class="stringliteral">        $opt = array_merge($popt, $opt);</span></div>
<div class="line"><a name="l13124"></a><span class="lineno">13124</span>&#160;<span class="stringliteral">        // set remaining annotation data</span></div>
<div class="line"><a name="l13125"></a><span class="lineno">13125</span>&#160;<span class="stringliteral">        $opt[&#39;</span>Subtype<span class="stringliteral">&#39;] = &#39;</span>Widget<span class="stringliteral">&#39;;</span></div>
<div class="line"><a name="l13126"></a><span class="lineno">13126</span>&#160;<span class="stringliteral">        $opt[&#39;</span>ft<span class="stringliteral">&#39;] = &#39;</span>Ch<span class="stringliteral">&#39;;</span></div>
<div class="line"><a name="l13127"></a><span class="lineno">13127</span>&#160;<span class="stringliteral">        $opt[&#39;</span>t<span class="stringliteral">&#39;] = $name;</span></div>
<div class="line"><a name="l13128"></a><span class="lineno">13128</span>&#160;<span class="stringliteral">        $opt[&#39;</span>opt<span class="stringliteral">&#39;] = $values;</span></div>
<div class="line"><a name="l13129"></a><span class="lineno">13129</span>&#160;<span class="stringliteral">        unset($opt[&#39;</span>mk<span class="stringliteral">&#39;][&#39;</span>ca<span class="stringliteral">&#39;]);</span></div>
<div class="line"><a name="l13130"></a><span class="lineno">13130</span>&#160;<span class="stringliteral">        unset($opt[&#39;</span>mk<span class="stringliteral">&#39;][&#39;</span>rc<span class="stringliteral">&#39;]);</span></div>
<div class="line"><a name="l13131"></a><span class="lineno">13131</span>&#160;<span class="stringliteral">        unset($opt[&#39;</span>mk<span class="stringliteral">&#39;][&#39;</span>ac<span class="stringliteral">&#39;]);</span></div>
<div class="line"><a name="l13132"></a><span class="lineno">13132</span>&#160;<span class="stringliteral">        unset($opt[&#39;</span>mk<span class="stringliteral">&#39;][&#39;</span>i<span class="stringliteral">&#39;]);</span></div>
<div class="line"><a name="l13133"></a><span class="lineno">13133</span>&#160;<span class="stringliteral">        unset($opt[&#39;</span>mk<span class="stringliteral">&#39;][&#39;</span>ri<span class="stringliteral">&#39;]);</span></div>
<div class="line"><a name="l13134"></a><span class="lineno">13134</span>&#160;<span class="stringliteral">        unset($opt[&#39;</span>mk<span class="stringliteral">&#39;][&#39;</span>ix<span class="stringliteral">&#39;]);</span></div>
<div class="line"><a name="l13135"></a><span class="lineno">13135</span>&#160;<span class="stringliteral">        unset($opt[&#39;</span>mk<span class="stringliteral">&#39;][&#39;</span><span class="keywordflow">if</span><span class="stringliteral">&#39;]);</span></div>
<div class="line"><a name="l13136"></a><span class="lineno">13136</span>&#160;<span class="stringliteral">        unset($opt[&#39;</span>mk<span class="stringliteral">&#39;][&#39;</span>tp<span class="stringliteral">&#39;]);</span></div>
<div class="line"><a name="l13137"></a><span class="lineno">13137</span>&#160;<span class="stringliteral">        $this-&gt;Annotation($x, $y, $w, $h, $name, $opt, 0);</span></div>
<div class="line"><a name="l13138"></a><span class="lineno">13138</span>&#160;<span class="stringliteral">        if ($this-&gt;rtl) {</span></div>
<div class="line"><a name="l13139"></a><span class="lineno">13139</span>&#160;<span class="stringliteral">            $this-&gt;x -= $w;</span></div>
<div class="line"><a name="l13140"></a><span class="lineno">13140</span>&#160;<span class="stringliteral">        } else {</span></div>
<div class="line"><a name="l13141"></a><span class="lineno">13141</span>&#160;<span class="stringliteral">            $this-&gt;x += $w;</span></div>
<div class="line"><a name="l13142"></a><span class="lineno">13142</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l13143"></a><span class="lineno">13143</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l13144"></a><span class="lineno">13144</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l13160"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a9237608d2579943f4bb2428617bfb73c">13160</a></span>&#160;<span class="stringliteral">    public function CheckBox($name, $w, $checked=false, $prop=array(), $opt=array(), $onvalue=&#39;</span>Yes<span class="stringliteral">&#39;, $x=&#39;</span><span class="stringliteral">&#39;, $y=&#39;</span><span class="stringliteral">&#39;, $js=false) {</span></div>
<div class="line"><a name="l13161"></a><span class="lineno">13161</span>&#160;<span class="stringliteral">        if ($x === &#39;</span><span class="stringliteral">&#39;) {</span></div>
<div class="line"><a name="l13162"></a><span class="lineno">13162</span>&#160;<span class="stringliteral">            $x = $this-&gt;x;</span></div>
<div class="line"><a name="l13163"></a><span class="lineno">13163</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l13164"></a><span class="lineno">13164</span>&#160;<span class="stringliteral">        if ($y === &#39;</span><span class="stringliteral">&#39;) {</span></div>
<div class="line"><a name="l13165"></a><span class="lineno">13165</span>&#160;<span class="stringliteral">            $y = $this-&gt;y;</span></div>
<div class="line"><a name="l13166"></a><span class="lineno">13166</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l13167"></a><span class="lineno">13167</span>&#160;<span class="stringliteral">        // check page for no-write regions and adapt page margins if necessary</span></div>
<div class="line"><a name="l13168"></a><span class="lineno">13168</span>&#160;<span class="stringliteral">        list($x, $y) = $this-&gt;checkPageRegions($w, $x, $y);</span></div>
<div class="line"><a name="l13169"></a><span class="lineno">13169</span>&#160;<span class="stringliteral">        if ($js) {</span></div>
<div class="line"><a name="l13170"></a><span class="lineno">13170</span>&#160;<span class="stringliteral">            $this-&gt;_addfield(&#39;</span>checkbox<span class="stringliteral">&#39;, $name, $x, $y, $w, $w, $prop);</span></div>
<div class="line"><a name="l13171"></a><span class="lineno">13171</span>&#160;<span class="stringliteral">            return;</span></div>
<div class="line"><a name="l13172"></a><span class="lineno">13172</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l13173"></a><span class="lineno">13173</span>&#160;<span class="stringliteral">        if (!isset($prop[&#39;</span>value<span class="stringliteral">&#39;])) {</span></div>
<div class="line"><a name="l13174"></a><span class="lineno">13174</span>&#160;<span class="stringliteral">            $prop[&#39;</span>value<span class="stringliteral">&#39;] = array(&#39;</span>Yes<span class="stringliteral">&#39;);</span></div>
<div class="line"><a name="l13175"></a><span class="lineno">13175</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l13176"></a><span class="lineno">13176</span>&#160;<span class="stringliteral">        // get default style</span></div>
<div class="line"><a name="l13177"></a><span class="lineno">13177</span>&#160;<span class="stringliteral">        $prop = array_merge($this-&gt;getFormDefaultProp(), $prop);</span></div>
<div class="line"><a name="l13178"></a><span class="lineno">13178</span>&#160;<span class="stringliteral">        $prop[&#39;</span>borderStyle<span class="stringliteral">&#39;] = &#39;</span>inset<span class="stringliteral">&#39;;</span></div>
<div class="line"><a name="l13179"></a><span class="lineno">13179</span>&#160;<span class="stringliteral">        // get annotation data</span></div>
<div class="line"><a name="l13180"></a><span class="lineno">13180</span>&#160;<span class="stringliteral">        $popt = TCPDF_STATIC::getAnnotOptFromJSProp($prop, $this-&gt;spot_colors, $this-&gt;rtl);</span></div>
<div class="line"><a name="l13181"></a><span class="lineno">13181</span>&#160;<span class="stringliteral">        // set additional default options</span></div>
<div class="line"><a name="l13182"></a><span class="lineno">13182</span>&#160;<span class="stringliteral">        $font = &#39;</span>zapfdingbats<span class="stringliteral">&#39;;</span></div>
<div class="line"><a name="l13183"></a><span class="lineno">13183</span>&#160;<span class="stringliteral">        if ($this-&gt;pdfa_mode) {</span></div>
<div class="line"><a name="l13184"></a><span class="lineno">13184</span>&#160;<span class="stringliteral">            // all fonts must be embedded</span></div>
<div class="line"><a name="l13185"></a><span class="lineno">13185</span>&#160;<span class="stringliteral">            $font = &#39;</span>pdfa<span class="stringliteral">&#39;.$font;</span></div>
<div class="line"><a name="l13186"></a><span class="lineno">13186</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l13187"></a><span class="lineno">13187</span>&#160;<span class="stringliteral">        $this-&gt;AddFont($font);</span></div>
<div class="line"><a name="l13188"></a><span class="lineno">13188</span>&#160;<span class="stringliteral">        $tmpfont = $this-&gt;getFontBuffer($font);</span></div>
<div class="line"><a name="l13189"></a><span class="lineno">13189</span>&#160;<span class="stringliteral">        $this-&gt;annotation_fonts[$tmpfont[&#39;</span>fontkey<span class="stringliteral">&#39;]] = $tmpfont[&#39;</span>i<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l13190"></a><span class="lineno">13190</span>&#160;<span class="stringliteral">        $fontstyle = sprintf(&#39;</span>/F%d %F Tf %s<span class="stringliteral">&#39;, $tmpfont[&#39;</span>i<span class="stringliteral">&#39;], $this-&gt;FontSizePt, $this-&gt;TextColor);</span></div>
<div class="line"><a name="l13191"></a><span class="lineno">13191</span>&#160;<span class="stringliteral">        $popt[&#39;</span>da<span class="stringliteral">&#39;] = $fontstyle;</span></div>
<div class="line"><a name="l13192"></a><span class="lineno">13192</span>&#160;<span class="stringliteral">        // build appearance stream</span></div>
<div class="line"><a name="l13193"></a><span class="lineno">13193</span>&#160;<span class="stringliteral">        $popt[&#39;</span>ap<span class="stringliteral">&#39;] = array();</span></div>
<div class="line"><a name="l13194"></a><span class="lineno">13194</span>&#160;<span class="stringliteral">        $popt[&#39;</span>ap<span class="stringliteral">&#39;][&#39;</span>n<span class="stringliteral">&#39;] = array();</span></div>
<div class="line"><a name="l13195"></a><span class="lineno">13195</span>&#160;<span class="stringliteral">        $fx = ((($w - $this-&gt;getAbsFontMeasure($tmpfont[&#39;</span>cw<span class="stringliteral">&#39;][110])) / 2) * $this-&gt;k);</span></div>
<div class="line"><a name="l13196"></a><span class="lineno">13196</span>&#160;<span class="stringliteral">        $fy = (($w - ((($tmpfont[&#39;</span>desc<span class="stringliteral">&#39;][&#39;</span>Ascent<span class="stringliteral">&#39;] - $tmpfont[&#39;</span>desc<span class="stringliteral">&#39;][&#39;</span>Descent<span class="stringliteral">&#39;]) * $this-&gt;FontSizePt / 1000) / $this-&gt;k)) * $this-&gt;k);</span></div>
<div class="line"><a name="l13197"></a><span class="lineno">13197</span>&#160;<span class="stringliteral">        $popt[&#39;</span>ap<span class="stringliteral">&#39;][&#39;</span>n<span class="stringliteral">&#39;][&#39;</span>Yes<span class="stringliteral">&#39;] = sprintf(&#39;</span>q %s BT /F%d %F Tf %F %F Td (<span class="stringliteral">&#39;.chr(110).&#39;</span>) Tj ET Q&#39;, $this-&gt;TextColor, $tmpfont[&#39;i&#39;], $this-&gt;FontSizePt, $fx, $fy);</div>
<div class="line"><a name="l13198"></a><span class="lineno">13198</span>&#160;        $popt[&#39;ap&#39;][&#39;n&#39;][&#39;Off&#39;] = sprintf(&#39;q %s BT /F%d %F Tf %F %F Td (&#39;.chr(111).&#39;) Tj ET Q&#39;, $this-&gt;TextColor, $tmpfont[&#39;i&#39;], $this-&gt;FontSizePt, $fx, $fy);</div>
<div class="line"><a name="l13199"></a><span class="lineno">13199</span>&#160;        <span class="comment">// merge options</span></div>
<div class="line"><a name="l13200"></a><span class="lineno">13200</span>&#160;        $opt = array_merge($popt, $opt);</div>
<div class="line"><a name="l13201"></a><span class="lineno">13201</span>&#160;        <span class="comment">// set remaining annotation data</span></div>
<div class="line"><a name="l13202"></a><span class="lineno">13202</span>&#160;        $opt[&#39;Subtype&#39;] = &#39;Widget&#39;;</div>
<div class="line"><a name="l13203"></a><span class="lineno">13203</span>&#160;        $opt[&#39;ft&#39;] = &#39;Btn&#39;;</div>
<div class="line"><a name="l13204"></a><span class="lineno">13204</span>&#160;        $opt[&#39;t&#39;] = $name;</div>
<div class="line"><a name="l13205"></a><span class="lineno">13205</span>&#160;        <a class="code" href="../../d0/dd3/error__404_8php.html#aea8bd098bc952d8b75498dae4c304fd7">if</a> (TCPDF_STATIC::empty_string($onvalue)) {</div>
<div class="line"><a name="l13206"></a><span class="lineno">13206</span>&#160;            $onvalue = <span class="stringliteral">&#39;Yes&#39;</span>;</div>
<div class="line"><a name="l13207"></a><span class="lineno">13207</span>&#160;        }</div>
<div class="line"><a name="l13208"></a><span class="lineno">13208</span>&#160;        $opt[<span class="stringliteral">&#39;opt&#39;</span>] = array($onvalue);</div>
<div class="line"><a name="l13209"></a><span class="lineno">13209</span>&#160;        <span class="keywordflow">if</span> ($checked) {</div>
<div class="line"><a name="l13210"></a><span class="lineno">13210</span>&#160;            $opt[<span class="charliteral">&#39;v&#39;</span>] = array(<span class="stringliteral">&#39;/Yes&#39;</span>);</div>
<div class="line"><a name="l13211"></a><span class="lineno">13211</span>&#160;            $opt[<span class="stringliteral">&#39;as&#39;</span>] = <span class="stringliteral">&#39;Yes&#39;</span>;</div>
<div class="line"><a name="l13212"></a><span class="lineno">13212</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l13213"></a><span class="lineno">13213</span>&#160;            $opt[<span class="charliteral">&#39;v&#39;</span>] = array(<span class="stringliteral">&#39;/Off&#39;</span>);</div>
<div class="line"><a name="l13214"></a><span class="lineno">13214</span>&#160;            $opt[<span class="stringliteral">&#39;as&#39;</span>] = <span class="stringliteral">&#39;Off&#39;</span>;</div>
<div class="line"><a name="l13215"></a><span class="lineno">13215</span>&#160;        }</div>
<div class="line"><a name="l13216"></a><span class="lineno">13216</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a6b05e14a0ff7b12eb78f884cabd69e9b">Annotation</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, $name, $opt, 0);</div>
<div class="line"><a name="l13217"></a><span class="lineno">13217</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l13218"></a><span class="lineno">13218</span>&#160;            $this-&gt;x -= <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>;</div>
<div class="line"><a name="l13219"></a><span class="lineno">13219</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l13220"></a><span class="lineno">13220</span>&#160;            $this-&gt;x += <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>;</div>
<div class="line"><a name="l13221"></a><span class="lineno">13221</span>&#160;        }</div>
<div class="line"><a name="l13222"></a><span class="lineno">13222</span>&#160;    }</div>
<div class="line"><a name="l13223"></a><span class="lineno">13223</span>&#160;</div>
<div class="line"><a name="l13240"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a93f18d686b7db10133a76317bfbb0d59">13240</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a93f18d686b7db10133a76317bfbb0d59">Button</a>($name, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $caption, $action, $prop=array(), $opt=array(), <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>=<span class="stringliteral">&#39;&#39;</span>, $js=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l13241"></a><span class="lineno">13241</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> === <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l13242"></a><span class="lineno">13242</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$this-&gt;x</a>;</div>
<div class="line"><a name="l13243"></a><span class="lineno">13243</span>&#160;        }</div>
<div class="line"><a name="l13244"></a><span class="lineno">13244</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> === <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l13245"></a><span class="lineno">13245</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l13246"></a><span class="lineno">13246</span>&#160;        }</div>
<div class="line"><a name="l13247"></a><span class="lineno">13247</span>&#160;        <span class="comment">// check page for no-write regions and adapt page margins if necessary</span></div>
<div class="line"><a name="l13248"></a><span class="lineno">13248</span>&#160;        list(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>) = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1d99e81697a90efb13a6734001427f40">checkPageRegions</a>(<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>);</div>
<div class="line"><a name="l13249"></a><span class="lineno">13249</span>&#160;        <span class="keywordflow">if</span> ($js) {</div>
<div class="line"><a name="l13250"></a><span class="lineno">13250</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1fc76cf135e8b98b3f654461d8345a57">_addfield</a>(<span class="stringliteral">&#39;button&#39;</span>, $name, $this-&gt;x, $this-&gt;y, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $prop);</div>
<div class="line"><a name="l13251"></a><span class="lineno">13251</span>&#160;            $this-&gt;javascript .= <span class="charliteral">&#39;f&#39;</span>.$name.<span class="stringliteral">&quot;.buttonSetCaption(&#39;&quot;</span>.addslashes($caption).<span class="stringliteral">&quot;&#39;);\n&quot;</span>;</div>
<div class="line"><a name="l13252"></a><span class="lineno">13252</span>&#160;            $this-&gt;javascript .= <span class="charliteral">&#39;f&#39;</span>.$name.<span class="stringliteral">&quot;.setAction(&#39;MouseUp&#39;,&#39;&quot;</span>.addslashes($action).<span class="stringliteral">&quot;&#39;);\n&quot;</span>;</div>
<div class="line"><a name="l13253"></a><span class="lineno">13253</span>&#160;            $this-&gt;javascript .= <span class="charliteral">&#39;f&#39;</span>.$name.<span class="stringliteral">&quot;.highlight=&#39;push&#39;;\n&quot;</span>;</div>
<div class="line"><a name="l13254"></a><span class="lineno">13254</span>&#160;            $this-&gt;javascript .= <span class="charliteral">&#39;f&#39;</span>.$name.<span class="stringliteral">&quot;.print=false;\n&quot;</span>;</div>
<div class="line"><a name="l13255"></a><span class="lineno">13255</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l13256"></a><span class="lineno">13256</span>&#160;        }</div>
<div class="line"><a name="l13257"></a><span class="lineno">13257</span>&#160;        <span class="comment">// get default style</span></div>
<div class="line"><a name="l13258"></a><span class="lineno">13258</span>&#160;        $prop = array_merge($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aca1da710f70d3b0e756be97adf23418c">getFormDefaultProp</a>(), $prop);</div>
<div class="line"><a name="l13259"></a><span class="lineno">13259</span>&#160;        $prop[<span class="stringliteral">&#39;Pushbutton&#39;</span>] = <span class="stringliteral">&#39;true&#39;</span>;</div>
<div class="line"><a name="l13260"></a><span class="lineno">13260</span>&#160;        $prop[<span class="stringliteral">&#39;highlight&#39;</span>] = <span class="stringliteral">&#39;push&#39;</span>;</div>
<div class="line"><a name="l13261"></a><span class="lineno">13261</span>&#160;        $prop[<span class="stringliteral">&#39;display&#39;</span>] = <span class="stringliteral">&#39;display.noPrint&#39;</span>;</div>
<div class="line"><a name="l13262"></a><span class="lineno">13262</span>&#160;        <span class="comment">// get annotation data</span></div>
<div class="line"><a name="l13263"></a><span class="lineno">13263</span>&#160;        $popt = TCPDF_STATIC::getAnnotOptFromJSProp($prop, $this-&gt;spot_colors, $this-&gt;rtl);</div>
<div class="line"><a name="l13264"></a><span class="lineno">13264</span>&#160;        $this-&gt;annotation_fonts[$this-&gt;CurrentFont[<span class="stringliteral">&#39;fontkey&#39;</span>]] = $this-&gt;CurrentFont[<span class="charliteral">&#39;i&#39;</span>];</div>
<div class="line"><a name="l13265"></a><span class="lineno">13265</span>&#160;        $fontstyle = sprintf(<span class="stringliteral">&#39;/F%d %F Tf %s&#39;</span>, $this-&gt;CurrentFont[<span class="charliteral">&#39;i&#39;</span>], $this-&gt;FontSizePt, $this-&gt;TextColor);</div>
<div class="line"><a name="l13266"></a><span class="lineno">13266</span>&#160;        $popt[<span class="stringliteral">&#39;da&#39;</span>] = $fontstyle;</div>
<div class="line"><a name="l13267"></a><span class="lineno">13267</span>&#160;        <span class="comment">// build appearance stream</span></div>
<div class="line"><a name="l13268"></a><span class="lineno">13268</span>&#160;        $popt[<span class="stringliteral">&#39;ap&#39;</span>] = array();</div>
<div class="line"><a name="l13269"></a><span class="lineno">13269</span>&#160;        $popt[<span class="stringliteral">&#39;ap&#39;</span>][<span class="charliteral">&#39;n&#39;</span>] = <span class="stringliteral">&#39;/Tx BMC q &#39;</span>.$fontstyle.<span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l13270"></a><span class="lineno">13270</span>&#160;        $tmpid = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a7eae5df3511dac591b5b76ab5d8b9a68">startTemplate</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l13271"></a><span class="lineno">13271</span>&#160;        $bw = (2 / <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>); <span class="comment">// border width</span></div>
<div class="line"><a name="l13272"></a><span class="lineno">13272</span>&#160;        $border = array(</div>
<div class="line"><a name="l13273"></a><span class="lineno">13273</span>&#160;            <span class="charliteral">&#39;L&#39;</span> =&gt; array(<span class="stringliteral">&#39;width&#39;</span> =&gt; $bw, <span class="stringliteral">&#39;cap&#39;</span> =&gt; <span class="stringliteral">&#39;square&#39;</span>, <span class="stringliteral">&#39;join&#39;</span> =&gt; <span class="stringliteral">&#39;miter&#39;</span>, <span class="stringliteral">&#39;dash&#39;</span> =&gt; 0, <span class="stringliteral">&#39;color&#39;</span> =&gt; array(231)),</div>
<div class="line"><a name="l13274"></a><span class="lineno">13274</span>&#160;            <span class="charliteral">&#39;R&#39;</span> =&gt; array(<span class="stringliteral">&#39;width&#39;</span> =&gt; $bw, <span class="stringliteral">&#39;cap&#39;</span> =&gt; <span class="stringliteral">&#39;square&#39;</span>, <span class="stringliteral">&#39;join&#39;</span> =&gt; <span class="stringliteral">&#39;miter&#39;</span>, <span class="stringliteral">&#39;dash&#39;</span> =&gt; 0, <span class="stringliteral">&#39;color&#39;</span> =&gt; array(51)),</div>
<div class="line"><a name="l13275"></a><span class="lineno">13275</span>&#160;            <span class="charliteral">&#39;T&#39;</span> =&gt; array(<span class="stringliteral">&#39;width&#39;</span> =&gt; $bw, <span class="stringliteral">&#39;cap&#39;</span> =&gt; <span class="stringliteral">&#39;square&#39;</span>, <span class="stringliteral">&#39;join&#39;</span> =&gt; <span class="stringliteral">&#39;miter&#39;</span>, <span class="stringliteral">&#39;dash&#39;</span> =&gt; 0, <span class="stringliteral">&#39;color&#39;</span> =&gt; array(231)),</div>
<div class="line"><a name="l13276"></a><span class="lineno">13276</span>&#160;            <span class="charliteral">&#39;B&#39;</span> =&gt; array(<span class="stringliteral">&#39;width&#39;</span> =&gt; $bw, <span class="stringliteral">&#39;cap&#39;</span> =&gt; <span class="stringliteral">&#39;square&#39;</span>, <span class="stringliteral">&#39;join&#39;</span> =&gt; <span class="stringliteral">&#39;miter&#39;</span>, <span class="stringliteral">&#39;dash&#39;</span> =&gt; 0, <span class="stringliteral">&#39;color&#39;</span> =&gt; array(51)));</div>
<div class="line"><a name="l13277"></a><span class="lineno">13277</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#abad599cd85cc60cbe9cbb7765ccfb535">SetFillColor</a>(204);</div>
<div class="line"><a name="l13278"></a><span class="lineno">13278</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a33b265e5eb3e4d1d4fedfe29f8166f31">Cell</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $caption, $border, 0, <span class="charliteral">&#39;C&#39;</span>, <span class="keyword">true</span>, <span class="stringliteral">&#39;&#39;</span>, 1, <span class="keyword">false</span>, <span class="charliteral">&#39;T&#39;</span>, <span class="charliteral">&#39;M&#39;</span>);</div>
<div class="line"><a name="l13279"></a><span class="lineno">13279</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a0b98de81d99a1a0e983dd0016e30fc75">endTemplate</a>();</div>
<div class="line"><a name="l13280"></a><span class="lineno">13280</span>&#160;        --<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$this-&gt;n</a>;</div>
<div class="line"><a name="l13281"></a><span class="lineno">13281</span>&#160;        $popt[<span class="stringliteral">&#39;ap&#39;</span>][<span class="charliteral">&#39;n&#39;</span>] .= $this-&gt;xobjects[$tmpid][<span class="stringliteral">&#39;outdata&#39;</span>];</div>
<div class="line"><a name="l13282"></a><span class="lineno">13282</span>&#160;        unset($this-&gt;xobjects[$tmpid]);</div>
<div class="line"><a name="l13283"></a><span class="lineno">13283</span>&#160;        $popt[<span class="stringliteral">&#39;ap&#39;</span>][<span class="charliteral">&#39;n&#39;</span>] .= <span class="stringliteral">&#39;Q EMC&#39;</span>;</div>
<div class="line"><a name="l13284"></a><span class="lineno">13284</span>&#160;        <span class="comment">// set additional default options</span></div>
<div class="line"><a name="l13285"></a><span class="lineno">13285</span>&#160;        <span class="keywordflow">if</span> (!isset($popt[<span class="stringliteral">&#39;mk&#39;</span>])) {</div>
<div class="line"><a name="l13286"></a><span class="lineno">13286</span>&#160;            $popt[<span class="stringliteral">&#39;mk&#39;</span>] = array();</div>
<div class="line"><a name="l13287"></a><span class="lineno">13287</span>&#160;        }</div>
<div class="line"><a name="l13288"></a><span class="lineno">13288</span>&#160;        $ann_obj_id = ($this-&gt;n + 1);</div>
<div class="line"><a name="l13289"></a><span class="lineno">13289</span>&#160;        <span class="keywordflow">if</span> (!empty($action) AND !is_array($action)) {</div>
<div class="line"><a name="l13290"></a><span class="lineno">13290</span>&#160;            $ann_obj_id = ($this-&gt;n + 2);</div>
<div class="line"><a name="l13291"></a><span class="lineno">13291</span>&#160;        }</div>
<div class="line"><a name="l13292"></a><span class="lineno">13292</span>&#160;        $popt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;ca&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac7082d1545bb2ee22c4713ab57879d81">_textstring</a>($caption, $ann_obj_id);</div>
<div class="line"><a name="l13293"></a><span class="lineno">13293</span>&#160;        $popt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;rc&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac7082d1545bb2ee22c4713ab57879d81">_textstring</a>($caption, $ann_obj_id);</div>
<div class="line"><a name="l13294"></a><span class="lineno">13294</span>&#160;        $popt[<span class="stringliteral">&#39;mk&#39;</span>][<span class="stringliteral">&#39;ac&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac7082d1545bb2ee22c4713ab57879d81">_textstring</a>($caption, $ann_obj_id);</div>
<div class="line"><a name="l13295"></a><span class="lineno">13295</span>&#160;        <span class="comment">// merge options</span></div>
<div class="line"><a name="l13296"></a><span class="lineno">13296</span>&#160;        $opt = array_merge($popt, $opt);</div>
<div class="line"><a name="l13297"></a><span class="lineno">13297</span>&#160;        <span class="comment">// set remaining annotation data</span></div>
<div class="line"><a name="l13298"></a><span class="lineno">13298</span>&#160;        $opt[<span class="stringliteral">&#39;Subtype&#39;</span>] = <span class="stringliteral">&#39;Widget&#39;</span>;</div>
<div class="line"><a name="l13299"></a><span class="lineno">13299</span>&#160;        $opt[<span class="stringliteral">&#39;ft&#39;</span>] = <span class="stringliteral">&#39;Btn&#39;</span>;</div>
<div class="line"><a name="l13300"></a><span class="lineno">13300</span>&#160;        $opt[<span class="charliteral">&#39;t&#39;</span>] = $caption;</div>
<div class="line"><a name="l13301"></a><span class="lineno">13301</span>&#160;        $opt[<span class="charliteral">&#39;v&#39;</span>] = $name;</div>
<div class="line"><a name="l13302"></a><span class="lineno">13302</span>&#160;        <span class="keywordflow">if</span> (!empty($action)) {</div>
<div class="line"><a name="l13303"></a><span class="lineno">13303</span>&#160;            <span class="keywordflow">if</span> (is_array($action)) {</div>
<div class="line"><a name="l13304"></a><span class="lineno">13304</span>&#160;                <span class="comment">// form action options as on section 12.7.5 of PDF32000_2008.</span></div>
<div class="line"><a name="l13305"></a><span class="lineno">13305</span>&#160;                $opt[<span class="stringliteral">&#39;aa&#39;</span>] = <span class="stringliteral">&#39;/D &lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l13306"></a><span class="lineno">13306</span>&#160;                $bmode = array(<span class="stringliteral">&#39;SubmitForm&#39;</span>, <span class="stringliteral">&#39;ResetForm&#39;</span>, <span class="stringliteral">&#39;ImportData&#39;</span>);</div>
<div class="line"><a name="l13307"></a><span class="lineno">13307</span>&#160;                <span class="keywordflow">foreach</span> ($action AS $key =&gt; $val) {</div>
<div class="line"><a name="l13308"></a><span class="lineno">13308</span>&#160;                    <span class="keywordflow">if</span> (($key == <span class="charliteral">&#39;S&#39;</span>) AND in_array($val, $bmode)) {</div>
<div class="line"><a name="l13309"></a><span class="lineno">13309</span>&#160;                        $opt[<span class="stringliteral">&#39;aa&#39;</span>] .= <span class="stringliteral">&#39; /S /&#39;</span>.$val;</div>
<div class="line"><a name="l13310"></a><span class="lineno">13310</span>&#160;                    } elseif (($key == <span class="charliteral">&#39;F&#39;</span>) AND (!empty($val))) {</div>
<div class="line"><a name="l13311"></a><span class="lineno">13311</span>&#160;                        $opt[<span class="stringliteral">&#39;aa&#39;</span>] .= <span class="stringliteral">&#39; /F &#39;</span>.$this-&gt;_datastring($val, $ann_obj_id);</div>
<div class="line"><a name="l13312"></a><span class="lineno">13312</span>&#160;                    } elseif (($key == <span class="stringliteral">&#39;Fields&#39;</span>) AND is_array($val) AND !empty($val)) {</div>
<div class="line"><a name="l13313"></a><span class="lineno">13313</span>&#160;                        $opt[<span class="stringliteral">&#39;aa&#39;</span>] .= <span class="stringliteral">&#39; /Fields [&#39;</span>;</div>
<div class="line"><a name="l13314"></a><span class="lineno">13314</span>&#160;                        <span class="keywordflow">foreach</span> ($val AS $field) {</div>
<div class="line"><a name="l13315"></a><span class="lineno">13315</span>&#160;                            $opt[<span class="stringliteral">&#39;aa&#39;</span>] .= <span class="charliteral">&#39; &#39;</span>.$this-&gt;_textstring($field, $ann_obj_id);</div>
<div class="line"><a name="l13316"></a><span class="lineno">13316</span>&#160;                        }</div>
<div class="line"><a name="l13317"></a><span class="lineno">13317</span>&#160;                        $opt[<span class="stringliteral">&#39;aa&#39;</span>] .= <span class="charliteral">&#39;]&#39;</span>;</div>
<div class="line"><a name="l13318"></a><span class="lineno">13318</span>&#160;                    } elseif (($key == <span class="stringliteral">&#39;Flags&#39;</span>)) {</div>
<div class="line"><a name="l13319"></a><span class="lineno">13319</span>&#160;                        $ff = 0;</div>
<div class="line"><a name="l13320"></a><span class="lineno">13320</span>&#160;                        <span class="keywordflow">if</span> (is_array($val)) {</div>
<div class="line"><a name="l13321"></a><span class="lineno">13321</span>&#160;                            <span class="keywordflow">foreach</span> ($val AS $flag) {</div>
<div class="line"><a name="l13322"></a><span class="lineno">13322</span>&#160;                                <span class="keywordflow">switch</span> ($flag) {</div>
<div class="line"><a name="l13323"></a><span class="lineno">13323</span>&#160;                                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;Include/Exclude&#39;</span>: {</div>
<div class="line"><a name="l13324"></a><span class="lineno">13324</span>&#160;                                        $ff += 1 &lt;&lt; 0;</div>
<div class="line"><a name="l13325"></a><span class="lineno">13325</span>&#160;                                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l13326"></a><span class="lineno">13326</span>&#160;                                    }</div>
<div class="line"><a name="l13327"></a><span class="lineno">13327</span>&#160;                                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;IncludeNoValueFields&#39;</span>: {</div>
<div class="line"><a name="l13328"></a><span class="lineno">13328</span>&#160;                                        $ff += 1 &lt;&lt; 1;</div>
<div class="line"><a name="l13329"></a><span class="lineno">13329</span>&#160;                                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l13330"></a><span class="lineno">13330</span>&#160;                                    }</div>
<div class="line"><a name="l13331"></a><span class="lineno">13331</span>&#160;                                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;ExportFormat&#39;</span>: {</div>
<div class="line"><a name="l13332"></a><span class="lineno">13332</span>&#160;                                        $ff += 1 &lt;&lt; 2;</div>
<div class="line"><a name="l13333"></a><span class="lineno">13333</span>&#160;                                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l13334"></a><span class="lineno">13334</span>&#160;                                    }</div>
<div class="line"><a name="l13335"></a><span class="lineno">13335</span>&#160;                                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;GetMethod&#39;</span>: {</div>
<div class="line"><a name="l13336"></a><span class="lineno">13336</span>&#160;                                        $ff += 1 &lt;&lt; 3;</div>
<div class="line"><a name="l13337"></a><span class="lineno">13337</span>&#160;                                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l13338"></a><span class="lineno">13338</span>&#160;                                    }</div>
<div class="line"><a name="l13339"></a><span class="lineno">13339</span>&#160;                                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;SubmitCoordinates&#39;</span>: {</div>
<div class="line"><a name="l13340"></a><span class="lineno">13340</span>&#160;                                        $ff += 1 &lt;&lt; 4;</div>
<div class="line"><a name="l13341"></a><span class="lineno">13341</span>&#160;                                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l13342"></a><span class="lineno">13342</span>&#160;                                    }</div>
<div class="line"><a name="l13343"></a><span class="lineno">13343</span>&#160;                                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;XFDF&#39;</span>: {</div>
<div class="line"><a name="l13344"></a><span class="lineno">13344</span>&#160;                                        $ff += 1 &lt;&lt; 5;</div>
<div class="line"><a name="l13345"></a><span class="lineno">13345</span>&#160;                                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l13346"></a><span class="lineno">13346</span>&#160;                                    }</div>
<div class="line"><a name="l13347"></a><span class="lineno">13347</span>&#160;                                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;IncludeAppendSaves&#39;</span>: {</div>
<div class="line"><a name="l13348"></a><span class="lineno">13348</span>&#160;                                        $ff += 1 &lt;&lt; 6;</div>
<div class="line"><a name="l13349"></a><span class="lineno">13349</span>&#160;                                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l13350"></a><span class="lineno">13350</span>&#160;                                    }</div>
<div class="line"><a name="l13351"></a><span class="lineno">13351</span>&#160;                                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;IncludeAnnotations&#39;</span>: {</div>
<div class="line"><a name="l13352"></a><span class="lineno">13352</span>&#160;                                        $ff += 1 &lt;&lt; 7;</div>
<div class="line"><a name="l13353"></a><span class="lineno">13353</span>&#160;                                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l13354"></a><span class="lineno">13354</span>&#160;                                    }</div>
<div class="line"><a name="l13355"></a><span class="lineno">13355</span>&#160;                                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;SubmitPDF&#39;</span>: {</div>
<div class="line"><a name="l13356"></a><span class="lineno">13356</span>&#160;                                        $ff += 1 &lt;&lt; 8;</div>
<div class="line"><a name="l13357"></a><span class="lineno">13357</span>&#160;                                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l13358"></a><span class="lineno">13358</span>&#160;                                    }</div>
<div class="line"><a name="l13359"></a><span class="lineno">13359</span>&#160;                                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;CanonicalFormat&#39;</span>: {</div>
<div class="line"><a name="l13360"></a><span class="lineno">13360</span>&#160;                                        $ff += 1 &lt;&lt; 9;</div>
<div class="line"><a name="l13361"></a><span class="lineno">13361</span>&#160;                                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l13362"></a><span class="lineno">13362</span>&#160;                                    }</div>
<div class="line"><a name="l13363"></a><span class="lineno">13363</span>&#160;                                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;ExclNonUserAnnots&#39;</span>: {</div>
<div class="line"><a name="l13364"></a><span class="lineno">13364</span>&#160;                                        $ff += 1 &lt;&lt; 10;</div>
<div class="line"><a name="l13365"></a><span class="lineno">13365</span>&#160;                                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l13366"></a><span class="lineno">13366</span>&#160;                                    }</div>
<div class="line"><a name="l13367"></a><span class="lineno">13367</span>&#160;                                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;ExclFKey&#39;</span>: {</div>
<div class="line"><a name="l13368"></a><span class="lineno">13368</span>&#160;                                        $ff += 1 &lt;&lt; 11;</div>
<div class="line"><a name="l13369"></a><span class="lineno">13369</span>&#160;                                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l13370"></a><span class="lineno">13370</span>&#160;                                    }</div>
<div class="line"><a name="l13371"></a><span class="lineno">13371</span>&#160;                                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;EmbedForm&#39;</span>: {</div>
<div class="line"><a name="l13372"></a><span class="lineno">13372</span>&#160;                                        $ff += 1 &lt;&lt; 13;</div>
<div class="line"><a name="l13373"></a><span class="lineno">13373</span>&#160;                                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l13374"></a><span class="lineno">13374</span>&#160;                                    }</div>
<div class="line"><a name="l13375"></a><span class="lineno">13375</span>&#160;                                }</div>
<div class="line"><a name="l13376"></a><span class="lineno">13376</span>&#160;                            }</div>
<div class="line"><a name="l13377"></a><span class="lineno">13377</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l13378"></a><span class="lineno">13378</span>&#160;                            $ff = intval($val);</div>
<div class="line"><a name="l13379"></a><span class="lineno">13379</span>&#160;                        }</div>
<div class="line"><a name="l13380"></a><span class="lineno">13380</span>&#160;                        $opt[<span class="stringliteral">&#39;aa&#39;</span>] .= <span class="stringliteral">&#39; /Flags &#39;</span>.$ff;</div>
<div class="line"><a name="l13381"></a><span class="lineno">13381</span>&#160;                    }</div>
<div class="line"><a name="l13382"></a><span class="lineno">13382</span>&#160;                }</div>
<div class="line"><a name="l13383"></a><span class="lineno">13383</span>&#160;                $opt[<span class="stringliteral">&#39;aa&#39;</span>] .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l13384"></a><span class="lineno">13384</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l13385"></a><span class="lineno">13385</span>&#160;                <span class="comment">// Javascript action or raw action command</span></div>
<div class="line"><a name="l13386"></a><span class="lineno">13386</span>&#160;                $js_obj_id = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac9c37f99a7bbc56109a019f4d5fab568">addJavascriptObject</a>($action);</div>
<div class="line"><a name="l13387"></a><span class="lineno">13387</span>&#160;                $opt[<span class="stringliteral">&#39;aa&#39;</span>] = <span class="stringliteral">&#39;/D &#39;</span>.$js_obj_id.<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l13388"></a><span class="lineno">13388</span>&#160;            }</div>
<div class="line"><a name="l13389"></a><span class="lineno">13389</span>&#160;        }</div>
<div class="line"><a name="l13390"></a><span class="lineno">13390</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a6b05e14a0ff7b12eb78f884cabd69e9b">Annotation</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $name, $opt, 0);</div>
<div class="line"><a name="l13391"></a><span class="lineno">13391</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l13392"></a><span class="lineno">13392</span>&#160;            $this-&gt;x -= <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>;</div>
<div class="line"><a name="l13393"></a><span class="lineno">13393</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l13394"></a><span class="lineno">13394</span>&#160;            $this-&gt;x += <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>;</div>
<div class="line"><a name="l13395"></a><span class="lineno">13395</span>&#160;        }</div>
<div class="line"><a name="l13396"></a><span class="lineno">13396</span>&#160;    }</div>
<div class="line"><a name="l13397"></a><span class="lineno">13397</span>&#160;</div>
<div class="line"><a name="l13398"></a><span class="lineno">13398</span>&#160;    <span class="comment">// --- END FORMS FIELDS ------------------------------------------------</span></div>
<div class="line"><a name="l13399"></a><span class="lineno">13399</span>&#160;</div>
<div class="line"><a name="l13407"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a0ade674cd5fe2d8901c056e689b6ab52">13407</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a0ade674cd5fe2d8901c056e689b6ab52">_putsignature</a>() {</div>
<div class="line"><a name="l13408"></a><span class="lineno">13408</span>&#160;        <span class="keywordflow">if</span> ((!$this-&gt;sign) OR (!isset($this-&gt;signature_data[<span class="stringliteral">&#39;cert_type&#39;</span>]))) {</div>
<div class="line"><a name="l13409"></a><span class="lineno">13409</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l13410"></a><span class="lineno">13410</span>&#160;        }</div>
<div class="line"><a name="l13411"></a><span class="lineno">13411</span>&#160;        $sigobjid = ($this-&gt;sig_obj_id + 1);</div>
<div class="line"><a name="l13412"></a><span class="lineno">13412</span>&#160;        $out = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1ef3c591556f7668c8a62b81e98da8a1">_getobj</a>($sigobjid).<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l13413"></a><span class="lineno">13413</span>&#160;        $out .= <span class="stringliteral">&#39;&lt;&lt; /Type /Sig&#39;</span>;</div>
<div class="line"><a name="l13414"></a><span class="lineno">13414</span>&#160;        $out .= <span class="stringliteral">&#39; /Filter /Adobe.PPKLite&#39;</span>;</div>
<div class="line"><a name="l13415"></a><span class="lineno">13415</span>&#160;        $out .= <span class="stringliteral">&#39; /SubFilter /adbe.pkcs7.detached&#39;</span>;</div>
<div class="line"><a name="l13416"></a><span class="lineno">13416</span>&#160;        $out .= <span class="charliteral">&#39; &#39;</span>.TCPDF_STATIC::$byterange_string;</div>
<div class="line"><a name="l13417"></a><span class="lineno">13417</span>&#160;        $out .= <span class="stringliteral">&#39; /Contents&lt;&#39;</span>.str_repeat(<span class="charliteral">&#39;0&#39;</span>, $this-&gt;signature_max_length).<span class="charliteral">&#39;&gt;&#39;</span>;</div>
<div class="line"><a name="l13418"></a><span class="lineno">13418</span>&#160;        <span class="keywordflow">if</span> (empty($this-&gt;signature_data[<span class="stringliteral">&#39;approval&#39;</span>]) OR ($this-&gt;signature_data[<span class="stringliteral">&#39;approval&#39;</span>] != <span class="charliteral">&#39;A&#39;</span>)) {</div>
<div class="line"><a name="l13419"></a><span class="lineno">13419</span>&#160;            $out .= <span class="stringliteral">&#39; /Reference [&#39;</span>; <span class="comment">// array of signature reference dictionaries</span></div>
<div class="line"><a name="l13420"></a><span class="lineno">13420</span>&#160;            $out .= <span class="stringliteral">&#39; &lt;&lt; /Type /SigRef&#39;</span>;</div>
<div class="line"><a name="l13421"></a><span class="lineno">13421</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;signature_data[<span class="stringliteral">&#39;cert_type&#39;</span>] &gt; 0) {</div>
<div class="line"><a name="l13422"></a><span class="lineno">13422</span>&#160;                $out .= <span class="stringliteral">&#39; /TransformMethod /DocMDP&#39;</span>;</div>
<div class="line"><a name="l13423"></a><span class="lineno">13423</span>&#160;                $out .= <span class="stringliteral">&#39; /TransformParams &lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l13424"></a><span class="lineno">13424</span>&#160;                $out .= <span class="stringliteral">&#39; /Type /TransformParams&#39;</span>;</div>
<div class="line"><a name="l13425"></a><span class="lineno">13425</span>&#160;                $out .= <span class="stringliteral">&#39; /P &#39;</span>.$this-&gt;signature_data[<span class="stringliteral">&#39;cert_type&#39;</span>];</div>
<div class="line"><a name="l13426"></a><span class="lineno">13426</span>&#160;                $out .= <span class="stringliteral">&#39; /V /1.2&#39;</span>;</div>
<div class="line"><a name="l13427"></a><span class="lineno">13427</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l13428"></a><span class="lineno">13428</span>&#160;                $out .= <span class="stringliteral">&#39; /TransformMethod /UR3&#39;</span>;</div>
<div class="line"><a name="l13429"></a><span class="lineno">13429</span>&#160;                $out .= <span class="stringliteral">&#39; /TransformParams &lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l13430"></a><span class="lineno">13430</span>&#160;                $out .= <span class="stringliteral">&#39; /Type /TransformParams&#39;</span>;</div>
<div class="line"><a name="l13431"></a><span class="lineno">13431</span>&#160;                $out .= <span class="stringliteral">&#39; /V /2.2&#39;</span>;</div>
<div class="line"><a name="l13432"></a><span class="lineno">13432</span>&#160;                <span class="keywordflow">if</span> (!TCPDF_STATIC::empty_string($this-&gt;ur[<span class="stringliteral">&#39;document&#39;</span>])) {</div>
<div class="line"><a name="l13433"></a><span class="lineno">13433</span>&#160;                    $out .= <span class="stringliteral">&#39; /Document[&#39;</span>.$this-&gt;ur[<span class="stringliteral">&#39;document&#39;</span>].<span class="charliteral">&#39;]&#39;</span>;</div>
<div class="line"><a name="l13434"></a><span class="lineno">13434</span>&#160;                }</div>
<div class="line"><a name="l13435"></a><span class="lineno">13435</span>&#160;                <span class="keywordflow">if</span> (!TCPDF_STATIC::empty_string($this-&gt;ur[<span class="stringliteral">&#39;form&#39;</span>])) {</div>
<div class="line"><a name="l13436"></a><span class="lineno">13436</span>&#160;                    $out .= <span class="stringliteral">&#39; /Form[&#39;</span>.$this-&gt;ur[<span class="stringliteral">&#39;form&#39;</span>].<span class="charliteral">&#39;]&#39;</span>;</div>
<div class="line"><a name="l13437"></a><span class="lineno">13437</span>&#160;                }</div>
<div class="line"><a name="l13438"></a><span class="lineno">13438</span>&#160;                <span class="keywordflow">if</span> (!TCPDF_STATIC::empty_string($this-&gt;ur[<span class="stringliteral">&#39;signature&#39;</span>])) {</div>
<div class="line"><a name="l13439"></a><span class="lineno">13439</span>&#160;                    $out .= <span class="stringliteral">&#39; /Signature[&#39;</span>.$this-&gt;ur[<span class="stringliteral">&#39;signature&#39;</span>].<span class="charliteral">&#39;]&#39;</span>;</div>
<div class="line"><a name="l13440"></a><span class="lineno">13440</span>&#160;                }</div>
<div class="line"><a name="l13441"></a><span class="lineno">13441</span>&#160;                <span class="keywordflow">if</span> (!TCPDF_STATIC::empty_string($this-&gt;ur[<span class="stringliteral">&#39;annots&#39;</span>])) {</div>
<div class="line"><a name="l13442"></a><span class="lineno">13442</span>&#160;                    $out .= <span class="stringliteral">&#39; /Annots[&#39;</span>.$this-&gt;ur[<span class="stringliteral">&#39;annots&#39;</span>].<span class="charliteral">&#39;]&#39;</span>;</div>
<div class="line"><a name="l13443"></a><span class="lineno">13443</span>&#160;                }</div>
<div class="line"><a name="l13444"></a><span class="lineno">13444</span>&#160;                <span class="keywordflow">if</span> (!TCPDF_STATIC::empty_string($this-&gt;ur[<span class="stringliteral">&#39;ef&#39;</span>])) {</div>
<div class="line"><a name="l13445"></a><span class="lineno">13445</span>&#160;                    $out .= <span class="stringliteral">&#39; /EF[&#39;</span>.$this-&gt;ur[<span class="stringliteral">&#39;ef&#39;</span>].<span class="charliteral">&#39;]&#39;</span>;</div>
<div class="line"><a name="l13446"></a><span class="lineno">13446</span>&#160;                }</div>
<div class="line"><a name="l13447"></a><span class="lineno">13447</span>&#160;                <span class="keywordflow">if</span> (!TCPDF_STATIC::empty_string($this-&gt;ur[<span class="stringliteral">&#39;formex&#39;</span>])) {</div>
<div class="line"><a name="l13448"></a><span class="lineno">13448</span>&#160;                    $out .= <span class="stringliteral">&#39; /FormEX[&#39;</span>.$this-&gt;ur[<span class="stringliteral">&#39;formex&#39;</span>].<span class="charliteral">&#39;]&#39;</span>;</div>
<div class="line"><a name="l13449"></a><span class="lineno">13449</span>&#160;                }</div>
<div class="line"><a name="l13450"></a><span class="lineno">13450</span>&#160;            }</div>
<div class="line"><a name="l13451"></a><span class="lineno">13451</span>&#160;            $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>; <span class="comment">// close TransformParams</span></div>
<div class="line"><a name="l13452"></a><span class="lineno">13452</span>&#160;            <span class="comment">// optional digest data (values must be calculated and replaced later)</span></div>
<div class="line"><a name="l13453"></a><span class="lineno">13453</span>&#160;            <span class="comment">//$out .= &#39; /Data ********** 0 R&#39;;</span></div>
<div class="line"><a name="l13454"></a><span class="lineno">13454</span>&#160;            <span class="comment">//$out .= &#39; /DigestMethod/MD5&#39;;</span></div>
<div class="line"><a name="l13455"></a><span class="lineno">13455</span>&#160;            <span class="comment">//$out .= &#39; /DigestLocation[********** 34]&#39;;</span></div>
<div class="line"><a name="l13456"></a><span class="lineno">13456</span>&#160;            <span class="comment">//$out .= &#39; /DigestValue&lt;********************************&gt;&#39;;</span></div>
<div class="line"><a name="l13457"></a><span class="lineno">13457</span>&#160;            $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l13458"></a><span class="lineno">13458</span>&#160;            $out .= <span class="stringliteral">&#39; ]&#39;</span>; <span class="comment">// end of reference</span></div>
<div class="line"><a name="l13459"></a><span class="lineno">13459</span>&#160;        }</div>
<div class="line"><a name="l13460"></a><span class="lineno">13460</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;signature_data[<span class="stringliteral">&#39;info&#39;</span>][<span class="stringliteral">&#39;Name&#39;</span>]) AND !TCPDF_STATIC::empty_string($this-&gt;signature_data[<span class="stringliteral">&#39;info&#39;</span>][<span class="stringliteral">&#39;Name&#39;</span>])) {</div>
<div class="line"><a name="l13461"></a><span class="lineno">13461</span>&#160;            $out .= <span class="stringliteral">&#39; /Name &#39;</span>.$this-&gt;_textstring($this-&gt;signature_data[<span class="stringliteral">&#39;info&#39;</span>][<span class="stringliteral">&#39;Name&#39;</span>], $sigobjid);</div>
<div class="line"><a name="l13462"></a><span class="lineno">13462</span>&#160;        }</div>
<div class="line"><a name="l13463"></a><span class="lineno">13463</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;signature_data[<span class="stringliteral">&#39;info&#39;</span>][<span class="stringliteral">&#39;Location&#39;</span>]) AND !TCPDF_STATIC::empty_string($this-&gt;signature_data[<span class="stringliteral">&#39;info&#39;</span>][<span class="stringliteral">&#39;Location&#39;</span>])) {</div>
<div class="line"><a name="l13464"></a><span class="lineno">13464</span>&#160;            $out .= <span class="stringliteral">&#39; /Location &#39;</span>.$this-&gt;_textstring($this-&gt;signature_data[<span class="stringliteral">&#39;info&#39;</span>][<span class="stringliteral">&#39;Location&#39;</span>], $sigobjid);</div>
<div class="line"><a name="l13465"></a><span class="lineno">13465</span>&#160;        }</div>
<div class="line"><a name="l13466"></a><span class="lineno">13466</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;signature_data[<span class="stringliteral">&#39;info&#39;</span>][<span class="stringliteral">&#39;Reason&#39;</span>]) AND !TCPDF_STATIC::empty_string($this-&gt;signature_data[<span class="stringliteral">&#39;info&#39;</span>][<span class="stringliteral">&#39;Reason&#39;</span>])) {</div>
<div class="line"><a name="l13467"></a><span class="lineno">13467</span>&#160;            $out .= <span class="stringliteral">&#39; /Reason &#39;</span>.$this-&gt;_textstring($this-&gt;signature_data[<span class="stringliteral">&#39;info&#39;</span>][<span class="stringliteral">&#39;Reason&#39;</span>], $sigobjid);</div>
<div class="line"><a name="l13468"></a><span class="lineno">13468</span>&#160;        }</div>
<div class="line"><a name="l13469"></a><span class="lineno">13469</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;signature_data[<span class="stringliteral">&#39;info&#39;</span>][<span class="stringliteral">&#39;ContactInfo&#39;</span>]) AND !TCPDF_STATIC::empty_string($this-&gt;signature_data[<span class="stringliteral">&#39;info&#39;</span>][<span class="stringliteral">&#39;ContactInfo&#39;</span>])) {</div>
<div class="line"><a name="l13470"></a><span class="lineno">13470</span>&#160;            $out .= <span class="stringliteral">&#39; /ContactInfo &#39;</span>.$this-&gt;_textstring($this-&gt;signature_data[<span class="stringliteral">&#39;info&#39;</span>][<span class="stringliteral">&#39;ContactInfo&#39;</span>], $sigobjid);</div>
<div class="line"><a name="l13471"></a><span class="lineno">13471</span>&#160;        }</div>
<div class="line"><a name="l13472"></a><span class="lineno">13472</span>&#160;        $out .= <span class="stringliteral">&#39; /M &#39;</span>.$this-&gt;_datestring($sigobjid, $this-&gt;doc_modification_timestamp);</div>
<div class="line"><a name="l13473"></a><span class="lineno">13473</span>&#160;        $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l13474"></a><span class="lineno">13474</span>&#160;        $out .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l13475"></a><span class="lineno">13475</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($out);</div>
<div class="line"><a name="l13476"></a><span class="lineno">13476</span>&#160;    }</div>
<div class="line"><a name="l13477"></a><span class="lineno">13477</span>&#160;</div>
<div class="line"><a name="l13495"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a1d40e45dc074815d0fdaf55af9e22d81">13495</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a1d40e45dc074815d0fdaf55af9e22d81">setUserRights</a>(</div>
<div class="line"><a name="l13496"></a><span class="lineno">13496</span>&#160;            $enable=<span class="keyword">true</span>,</div>
<div class="line"><a name="l13497"></a><span class="lineno">13497</span>&#160;            $document=<span class="stringliteral">&#39;/FullSave&#39;</span>,</div>
<div class="line"><a name="l13498"></a><span class="lineno">13498</span>&#160;            $annots=<span class="stringliteral">&#39;/Create/Delete/Modify/Copy/Import/Export&#39;</span>,</div>
<div class="line"><a name="l13499"></a><span class="lineno">13499</span>&#160;            $form=<span class="stringliteral">&#39;/Add/Delete/FillIn/Import/Export/SubmitStandalone/SpawnTemplate&#39;</span>,</div>
<div class="line"><a name="l13500"></a><span class="lineno">13500</span>&#160;            $signature=<span class="stringliteral">&#39;/Modify&#39;</span>,</div>
<div class="line"><a name="l13501"></a><span class="lineno">13501</span>&#160;            $ef=<span class="stringliteral">&#39;/Create/Delete/Modify/Import&#39;</span>,</div>
<div class="line"><a name="l13502"></a><span class="lineno">13502</span>&#160;            $formex=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l13503"></a><span class="lineno">13503</span>&#160;        $this-&gt;ur[<span class="stringliteral">&#39;enabled&#39;</span>] = $enable;</div>
<div class="line"><a name="l13504"></a><span class="lineno">13504</span>&#160;        $this-&gt;ur[<span class="stringliteral">&#39;document&#39;</span>] = $document;</div>
<div class="line"><a name="l13505"></a><span class="lineno">13505</span>&#160;        $this-&gt;ur[<span class="stringliteral">&#39;annots&#39;</span>] = $annots;</div>
<div class="line"><a name="l13506"></a><span class="lineno">13506</span>&#160;        $this-&gt;ur[<span class="stringliteral">&#39;form&#39;</span>] = $form;</div>
<div class="line"><a name="l13507"></a><span class="lineno">13507</span>&#160;        $this-&gt;ur[<span class="stringliteral">&#39;signature&#39;</span>] = $signature;</div>
<div class="line"><a name="l13508"></a><span class="lineno">13508</span>&#160;        $this-&gt;ur[<span class="stringliteral">&#39;ef&#39;</span>] = $ef;</div>
<div class="line"><a name="l13509"></a><span class="lineno">13509</span>&#160;        $this-&gt;ur[<span class="stringliteral">&#39;formex&#39;</span>] = $formex;</div>
<div class="line"><a name="l13510"></a><span class="lineno">13510</span>&#160;        <span class="keywordflow">if</span> (!$this-&gt;sign) {</div>
<div class="line"><a name="l13511"></a><span class="lineno">13511</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1184d1ac9ef4d6313bf23ddba45936dc">setSignature</a>(<span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, 0, array());</div>
<div class="line"><a name="l13512"></a><span class="lineno">13512</span>&#160;        }</div>
<div class="line"><a name="l13513"></a><span class="lineno">13513</span>&#160;    }</div>
<div class="line"><a name="l13514"></a><span class="lineno">13514</span>&#160;</div>
<div class="line"><a name="l13532"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a1184d1ac9ef4d6313bf23ddba45936dc">13532</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a1184d1ac9ef4d6313bf23ddba45936dc">setSignature</a>($signing_cert=<span class="stringliteral">&#39;&#39;</span>, $private_key=<span class="stringliteral">&#39;&#39;</span>, $private_key_password=<span class="stringliteral">&#39;&#39;</span>, $extracerts=<span class="stringliteral">&#39;&#39;</span>, $cert_type=2, $info=array(), $approval=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l13533"></a><span class="lineno">13533</span>&#160;        <span class="comment">// to create self-signed signature: openssl req -x509 -nodes -days 365000 -newkey rsa:1024 -keyout tcpdf.crt -out tcpdf.crt</span></div>
<div class="line"><a name="l13534"></a><span class="lineno">13534</span>&#160;        <span class="comment">// to export crt to p12: openssl pkcs12 -export -in tcpdf.crt -out tcpdf.p12</span></div>
<div class="line"><a name="l13535"></a><span class="lineno">13535</span>&#160;        <span class="comment">// to convert pfx certificate to pem: openssl</span></div>
<div class="line"><a name="l13536"></a><span class="lineno">13536</span>&#160;        <span class="comment">//     OpenSSL&gt; pkcs12 -in &lt;cert.pfx&gt; -out &lt;cert.crt&gt; -nodes</span></div>
<div class="line"><a name="l13537"></a><span class="lineno">13537</span>&#160;        $this-&gt;sign = <span class="keyword">true</span>;</div>
<div class="line"><a name="l13538"></a><span class="lineno">13538</span>&#160;        ++<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$this-&gt;n</a>;</div>
<div class="line"><a name="l13539"></a><span class="lineno">13539</span>&#160;        $this-&gt;sig_obj_id = <a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$this-&gt;n</a>; <span class="comment">// signature widget</span></div>
<div class="line"><a name="l13540"></a><span class="lineno">13540</span>&#160;        ++<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$this-&gt;n</a>; <span class="comment">// signature object ($this-&gt;sig_obj_id + 1)</span></div>
<div class="line"><a name="l13541"></a><span class="lineno">13541</span>&#160;        $this-&gt;signature_data = array();</div>
<div class="line"><a name="l13542"></a><span class="lineno">13542</span>&#160;        <span class="keywordflow">if</span> (strlen($signing_cert) == 0) {</div>
<div class="line"><a name="l13543"></a><span class="lineno">13543</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;Please provide a certificate file and password!&#39;</span>);</div>
<div class="line"><a name="l13544"></a><span class="lineno">13544</span>&#160;        }</div>
<div class="line"><a name="l13545"></a><span class="lineno">13545</span>&#160;        <span class="keywordflow">if</span> (strlen($private_key) == 0) {</div>
<div class="line"><a name="l13546"></a><span class="lineno">13546</span>&#160;            $private_key = $signing_cert;</div>
<div class="line"><a name="l13547"></a><span class="lineno">13547</span>&#160;        }</div>
<div class="line"><a name="l13548"></a><span class="lineno">13548</span>&#160;        $this-&gt;signature_data[<span class="stringliteral">&#39;signcert&#39;</span>] = $signing_cert;</div>
<div class="line"><a name="l13549"></a><span class="lineno">13549</span>&#160;        $this-&gt;signature_data[<span class="stringliteral">&#39;privkey&#39;</span>] = $private_key;</div>
<div class="line"><a name="l13550"></a><span class="lineno">13550</span>&#160;        $this-&gt;signature_data[<span class="stringliteral">&#39;password&#39;</span>] = $private_key_password;</div>
<div class="line"><a name="l13551"></a><span class="lineno">13551</span>&#160;        $this-&gt;signature_data[<span class="stringliteral">&#39;extracerts&#39;</span>] = $extracerts;</div>
<div class="line"><a name="l13552"></a><span class="lineno">13552</span>&#160;        $this-&gt;signature_data[<span class="stringliteral">&#39;cert_type&#39;</span>] = $cert_type;</div>
<div class="line"><a name="l13553"></a><span class="lineno">13553</span>&#160;        $this-&gt;signature_data[<span class="stringliteral">&#39;info&#39;</span>] = $info;</div>
<div class="line"><a name="l13554"></a><span class="lineno">13554</span>&#160;        $this-&gt;signature_data[<span class="stringliteral">&#39;approval&#39;</span>] = $approval;</div>
<div class="line"><a name="l13555"></a><span class="lineno">13555</span>&#160;    }</div>
<div class="line"><a name="l13556"></a><span class="lineno">13556</span>&#160;</div>
<div class="line"><a name="l13569"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#afddcb4a76989be254dc5a4eb4e1e0c90">13569</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#afddcb4a76989be254dc5a4eb4e1e0c90">setSignatureAppearance</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>=0, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>=0, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>=0, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>=0, <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>=-1, $name=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l13570"></a><span class="lineno">13570</span>&#160;        $this-&gt;signature_appearance = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ae80e86c6d3f113518cb28a1b0aa3bebc">getSignatureAppearanceArray</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>, $name);</div>
<div class="line"><a name="l13571"></a><span class="lineno">13571</span>&#160;    }</div>
<div class="line"><a name="l13572"></a><span class="lineno">13572</span>&#160;</div>
<div class="line"><a name="l13585"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a4d385a5f09edf2774d73c67d774a4336">13585</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a4d385a5f09edf2774d73c67d774a4336">addEmptySignatureAppearance</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>=0, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>=0, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>=0, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>=0, <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>=-1, $name=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l13586"></a><span class="lineno">13586</span>&#160;        ++<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$this-&gt;n</a>;</div>
<div class="line"><a name="l13587"></a><span class="lineno">13587</span>&#160;        $this-&gt;empty_signature_appearance[] = array(<span class="stringliteral">&#39;objid&#39;</span> =&gt; $this-&gt;n) + $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ae80e86c6d3f113518cb28a1b0aa3bebc">getSignatureAppearanceArray</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>, $name);</div>
<div class="line"><a name="l13588"></a><span class="lineno">13588</span>&#160;    }</div>
<div class="line"><a name="l13589"></a><span class="lineno">13589</span>&#160;</div>
<div class="line"><a name="l13603"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ae80e86c6d3f113518cb28a1b0aa3bebc">13603</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ae80e86c6d3f113518cb28a1b0aa3bebc">getSignatureAppearanceArray</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>=0, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>=0, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>=0, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>=0, <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>=-1, $name=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l13604"></a><span class="lineno">13604</span>&#160;        $sigapp = array();</div>
<div class="line"><a name="l13605"></a><span class="lineno">13605</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a> &lt; 1) OR (<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a> &gt; $this-&gt;numpages)) {</div>
<div class="line"><a name="l13606"></a><span class="lineno">13606</span>&#160;            $sigapp[<span class="stringliteral">&#39;page&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>;</div>
<div class="line"><a name="l13607"></a><span class="lineno">13607</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l13608"></a><span class="lineno">13608</span>&#160;            $sigapp[<span class="stringliteral">&#39;page&#39;</span>] = intval(<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>);</div>
<div class="line"><a name="l13609"></a><span class="lineno">13609</span>&#160;        }</div>
<div class="line"><a name="l13610"></a><span class="lineno">13610</span>&#160;        <span class="keywordflow">if</span> (empty($name)) {</div>
<div class="line"><a name="l13611"></a><span class="lineno">13611</span>&#160;            $sigapp[<span class="stringliteral">&#39;name&#39;</span>] = <span class="stringliteral">&#39;Signature&#39;</span>;</div>
<div class="line"><a name="l13612"></a><span class="lineno">13612</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l13613"></a><span class="lineno">13613</span>&#160;            $sigapp[<span class="stringliteral">&#39;name&#39;</span>] = $name;</div>
<div class="line"><a name="l13614"></a><span class="lineno">13614</span>&#160;        }</div>
<div class="line"><a name="l13615"></a><span class="lineno">13615</span>&#160;        $a = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>;</div>
<div class="line"><a name="l13616"></a><span class="lineno">13616</span>&#160;        $b = $this-&gt;pagedim[($sigapp[<span class="stringliteral">&#39;page&#39;</span>])][<span class="charliteral">&#39;h&#39;</span>] - ((<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> + <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>) * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>);</div>
<div class="line"><a name="l13617"></a><span class="lineno">13617</span>&#160;        $c = <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>;</div>
<div class="line"><a name="l13618"></a><span class="lineno">13618</span>&#160;        $d = <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>;</div>
<div class="line"><a name="l13619"></a><span class="lineno">13619</span>&#160;        $sigapp[<span class="stringliteral">&#39;rect&#39;</span>] = sprintf(<span class="stringliteral">&#39;%F %F %F %F&#39;</span>, $a, $b, ($a + $c), ($b + $d));</div>
<div class="line"><a name="l13620"></a><span class="lineno">13620</span>&#160;        <span class="keywordflow">return</span> $sigapp;</div>
<div class="line"><a name="l13621"></a><span class="lineno">13621</span>&#160;    }</div>
<div class="line"><a name="l13622"></a><span class="lineno">13622</span>&#160;</div>
<div class="line"><a name="l13635"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a936a4f5037af85ab74f698e43cd88022">13635</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a936a4f5037af85ab74f698e43cd88022">setTimeStamp</a>($tsa_host=<span class="stringliteral">&#39;&#39;</span>, $tsa_username=<span class="stringliteral">&#39;&#39;</span>, $tsa_password=<span class="stringliteral">&#39;&#39;</span>, $tsa_cert=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l13636"></a><span class="lineno">13636</span>&#160;        $this-&gt;tsa_data = array();</div>
<div class="line"><a name="l13637"></a><span class="lineno">13637</span>&#160;        <span class="keywordflow">if</span> (!function_exists(<span class="stringliteral">&#39;curl_init&#39;</span>)) {</div>
<div class="line"><a name="l13638"></a><span class="lineno">13638</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;Please enable cURL PHP extension!&#39;</span>);</div>
<div class="line"><a name="l13639"></a><span class="lineno">13639</span>&#160;        }</div>
<div class="line"><a name="l13640"></a><span class="lineno">13640</span>&#160;        <span class="keywordflow">if</span> (strlen($tsa_host) == 0) {</div>
<div class="line"><a name="l13641"></a><span class="lineno">13641</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;Please specify the host of Time Stamping Authority (TSA)!&#39;</span>);</div>
<div class="line"><a name="l13642"></a><span class="lineno">13642</span>&#160;        }</div>
<div class="line"><a name="l13643"></a><span class="lineno">13643</span>&#160;        $this-&gt;tsa_data[<span class="stringliteral">&#39;tsa_host&#39;</span>] = $tsa_host;</div>
<div class="line"><a name="l13644"></a><span class="lineno">13644</span>&#160;        <span class="keywordflow">if</span> (is_file($tsa_username)) {</div>
<div class="line"><a name="l13645"></a><span class="lineno">13645</span>&#160;            $this-&gt;tsa_data[<span class="stringliteral">&#39;tsa_auth&#39;</span>] = $tsa_username;</div>
<div class="line"><a name="l13646"></a><span class="lineno">13646</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l13647"></a><span class="lineno">13647</span>&#160;            $this-&gt;tsa_data[<span class="stringliteral">&#39;tsa_username&#39;</span>] = $tsa_username;</div>
<div class="line"><a name="l13648"></a><span class="lineno">13648</span>&#160;        }</div>
<div class="line"><a name="l13649"></a><span class="lineno">13649</span>&#160;        $this-&gt;tsa_data[<span class="stringliteral">&#39;tsa_password&#39;</span>] = $tsa_password;</div>
<div class="line"><a name="l13650"></a><span class="lineno">13650</span>&#160;        $this-&gt;tsa_data[<span class="stringliteral">&#39;tsa_cert&#39;</span>] = $tsa_cert;</div>
<div class="line"><a name="l13651"></a><span class="lineno">13651</span>&#160;        $this-&gt;tsa_timestamp = <span class="keyword">true</span>;</div>
<div class="line"><a name="l13652"></a><span class="lineno">13652</span>&#160;    }</div>
<div class="line"><a name="l13653"></a><span class="lineno">13653</span>&#160;</div>
<div class="line"><a name="l13663"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aef2a1b2504a6605d63e5851c01839149">13663</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#aef2a1b2504a6605d63e5851c01839149">applyTSA</a>($signature) {</div>
<div class="line"><a name="l13664"></a><span class="lineno">13664</span>&#160;        <span class="keywordflow">if</span> (!$this-&gt;tsa_timestamp) {</div>
<div class="line"><a name="l13665"></a><span class="lineno">13665</span>&#160;            <span class="keywordflow">return</span> $signature;</div>
<div class="line"><a name="l13666"></a><span class="lineno">13666</span>&#160;        }</div>
<div class="line"><a name="l13667"></a><span class="lineno">13667</span>&#160;        <span class="comment">//@TODO: implement this feature</span></div>
<div class="line"><a name="l13668"></a><span class="lineno">13668</span>&#160;        <span class="keywordflow">return</span> $signature;</div>
<div class="line"><a name="l13669"></a><span class="lineno">13669</span>&#160;    }</div>
<div class="line"><a name="l13670"></a><span class="lineno">13670</span>&#160;</div>
<div class="line"><a name="l13678"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a2ed08174efade970d4b641f77ab2b0d5">13678</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a2ed08174efade970d4b641f77ab2b0d5">startPageGroup</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l13679"></a><span class="lineno">13679</span>&#160;        <span class="keywordflow">if</span> (empty(<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>)) {</div>
<div class="line"><a name="l13680"></a><span class="lineno">13680</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a> = $this-&gt;page + 1;</div>
<div class="line"><a name="l13681"></a><span class="lineno">13681</span>&#160;        }</div>
<div class="line"><a name="l13682"></a><span class="lineno">13682</span>&#160;        $this-&gt;newpagegroup[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>] = <span class="keyword">sizeof</span>(<a class="code" href="../../d4/d40/classTCPDF.html#afb73712e74059488feca5f8b850ff6a4">$this-&gt;newpagegroup</a>) + 1;</div>
<div class="line"><a name="l13683"></a><span class="lineno">13683</span>&#160;    }</div>
<div class="line"><a name="l13684"></a><span class="lineno">13684</span>&#160;</div>
<div class="line"><a name="l13691"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a295eb20ff68b8f2a04b33e4dadd66dc4">13691</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a295eb20ff68b8f2a04b33e4dadd66dc4">setStartingPageNumber</a>($num=1) {</div>
<div class="line"><a name="l13692"></a><span class="lineno">13692</span>&#160;        $this-&gt;starting_page_number = max(0, intval($num));</div>
<div class="line"><a name="l13693"></a><span class="lineno">13693</span>&#160;    }</div>
<div class="line"><a name="l13694"></a><span class="lineno">13694</span>&#160;</div>
<div class="line"><a name="l13702"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ad089fa332b723086484ae0497ae90590">13702</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ad089fa332b723086484ae0497ae90590">getAliasRightShift</a>() {</div>
<div class="line"><a name="l13703"></a><span class="lineno">13703</span>&#160;        <span class="comment">// calculate aproximatively the ratio between widths of aliases and replacements.</span></div>
<div class="line"><a name="l13704"></a><span class="lineno">13704</span>&#160;        $ref = <span class="charliteral">&#39;{&#39;</span>.TCPDF_STATIC::$alias_right_shift.<span class="stringliteral">&#39;}{&#39;</span>.TCPDF_STATIC::$alias_tot_pages.<span class="stringliteral">&#39;}{&#39;</span>.TCPDF_STATIC::$alias_num_page.<span class="charliteral">&#39;}&#39;</span>;</div>
<div class="line"><a name="l13705"></a><span class="lineno">13705</span>&#160;        $rep = str_repeat(<span class="charliteral">&#39; &#39;</span>, $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac9dc6318fd217971aff282532ab91e43">GetNumChars</a>($ref));</div>
<div class="line"><a name="l13706"></a><span class="lineno">13706</span>&#160;        $wrep = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8075c1f04b6fbddc957cff786c4b16d9">GetStringWidth</a>($rep);</div>
<div class="line"><a name="l13707"></a><span class="lineno">13707</span>&#160;        <span class="keywordflow">if</span> ($wrep &gt; 0) {</div>
<div class="line"><a name="l13708"></a><span class="lineno">13708</span>&#160;            $wdiff = max(1, ($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8075c1f04b6fbddc957cff786c4b16d9">GetStringWidth</a>($ref) / $wrep));</div>
<div class="line"><a name="l13709"></a><span class="lineno">13709</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l13710"></a><span class="lineno">13710</span>&#160;            $wdiff = 1;</div>
<div class="line"><a name="l13711"></a><span class="lineno">13711</span>&#160;        }</div>
<div class="line"><a name="l13712"></a><span class="lineno">13712</span>&#160;        $sdiff = sprintf(<span class="stringliteral">&#39;%F&#39;</span>, $wdiff);</div>
<div class="line"><a name="l13713"></a><span class="lineno">13713</span>&#160;        $alias = TCPDF_STATIC::$alias_right_shift.$sdiff.<span class="charliteral">&#39;}&#39;</span>;</div>
<div class="line"><a name="l13714"></a><span class="lineno">13714</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a81c8257af5d6d6e40f1bb77d6b507b97">isUnicodeFont</a>()) {</div>
<div class="line"><a name="l13715"></a><span class="lineno">13715</span>&#160;            $alias = <span class="charliteral">&#39;{&#39;</span>.$alias;</div>
<div class="line"><a name="l13716"></a><span class="lineno">13716</span>&#160;        }</div>
<div class="line"><a name="l13717"></a><span class="lineno">13717</span>&#160;        <span class="keywordflow">return</span> $alias;</div>
<div class="line"><a name="l13718"></a><span class="lineno">13718</span>&#160;    }</div>
<div class="line"><a name="l13719"></a><span class="lineno">13719</span>&#160;</div>
<div class="line"><a name="l13728"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a3a6255516dcf07089fe29f13b3ef67bf">13728</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a3a6255516dcf07089fe29f13b3ef67bf">getAliasNbPages</a>() {</div>
<div class="line"><a name="l13729"></a><span class="lineno">13729</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a81c8257af5d6d6e40f1bb77d6b507b97">isUnicodeFont</a>()) {</div>
<div class="line"><a name="l13730"></a><span class="lineno">13730</span>&#160;            <span class="keywordflow">return</span> <span class="charliteral">&#39;{&#39;</span>.TCPDF_STATIC::$alias_tot_pages.<span class="charliteral">&#39;}&#39;</span>;</div>
<div class="line"><a name="l13731"></a><span class="lineno">13731</span>&#160;        }</div>
<div class="line"><a name="l13732"></a><span class="lineno">13732</span>&#160;        <span class="keywordflow">return</span> TCPDF_STATIC::$alias_tot_pages;</div>
<div class="line"><a name="l13733"></a><span class="lineno">13733</span>&#160;    }</div>
<div class="line"><a name="l13734"></a><span class="lineno">13734</span>&#160;</div>
<div class="line"><a name="l13743"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ae11c5f52caa0df8609ec22c30cd54055">13743</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ae11c5f52caa0df8609ec22c30cd54055">getAliasNumPage</a>() {</div>
<div class="line"><a name="l13744"></a><span class="lineno">13744</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a81c8257af5d6d6e40f1bb77d6b507b97">isUnicodeFont</a>()) {</div>
<div class="line"><a name="l13745"></a><span class="lineno">13745</span>&#160;            <span class="keywordflow">return</span> <span class="charliteral">&#39;{&#39;</span>.TCPDF_STATIC::$alias_num_page.<span class="charliteral">&#39;}&#39;</span>;</div>
<div class="line"><a name="l13746"></a><span class="lineno">13746</span>&#160;        }</div>
<div class="line"><a name="l13747"></a><span class="lineno">13747</span>&#160;        <span class="keywordflow">return</span> TCPDF_STATIC::$alias_num_page;</div>
<div class="line"><a name="l13748"></a><span class="lineno">13748</span>&#160;    }</div>
<div class="line"><a name="l13749"></a><span class="lineno">13749</span>&#160;</div>
<div class="line"><a name="l13758"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#af73382321461f24798a639c2f433a67f">13758</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#af73382321461f24798a639c2f433a67f">getPageGroupAlias</a>() {</div>
<div class="line"><a name="l13759"></a><span class="lineno">13759</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a81c8257af5d6d6e40f1bb77d6b507b97">isUnicodeFont</a>()) {</div>
<div class="line"><a name="l13760"></a><span class="lineno">13760</span>&#160;            <span class="keywordflow">return</span> <span class="charliteral">&#39;{&#39;</span>.TCPDF_STATIC::$alias_group_tot_pages.<span class="charliteral">&#39;}&#39;</span>;</div>
<div class="line"><a name="l13761"></a><span class="lineno">13761</span>&#160;        }</div>
<div class="line"><a name="l13762"></a><span class="lineno">13762</span>&#160;        <span class="keywordflow">return</span> TCPDF_STATIC::$alias_group_tot_pages;</div>
<div class="line"><a name="l13763"></a><span class="lineno">13763</span>&#160;    }</div>
<div class="line"><a name="l13764"></a><span class="lineno">13764</span>&#160;</div>
<div class="line"><a name="l13773"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a015d1f6a5d39877206bf2b12163eddcc">13773</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a015d1f6a5d39877206bf2b12163eddcc">getPageNumGroupAlias</a>() {</div>
<div class="line"><a name="l13774"></a><span class="lineno">13774</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a81c8257af5d6d6e40f1bb77d6b507b97">isUnicodeFont</a>()) {</div>
<div class="line"><a name="l13775"></a><span class="lineno">13775</span>&#160;            <span class="keywordflow">return</span> <span class="charliteral">&#39;{&#39;</span>.TCPDF_STATIC::$alias_group_num_page.<span class="charliteral">&#39;}&#39;</span>;</div>
<div class="line"><a name="l13776"></a><span class="lineno">13776</span>&#160;        }</div>
<div class="line"><a name="l13777"></a><span class="lineno">13777</span>&#160;        <span class="keywordflow">return</span> TCPDF_STATIC::$alias_group_num_page;</div>
<div class="line"><a name="l13778"></a><span class="lineno">13778</span>&#160;    }</div>
<div class="line"><a name="l13779"></a><span class="lineno">13779</span>&#160;</div>
<div class="line"><a name="l13786"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#abb054390914b3cb23d207f4c36f0395c">13786</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#abb054390914b3cb23d207f4c36f0395c">getGroupPageNo</a>() {</div>
<div class="line"><a name="l13787"></a><span class="lineno">13787</span>&#160;        <span class="keywordflow">return</span> $this-&gt;pagegroups[<a class="code" href="../../d4/d40/classTCPDF.html#ac78410b152f371b7239405ba246cee92">$this-&gt;currpagegroup</a>];</div>
<div class="line"><a name="l13788"></a><span class="lineno">13788</span>&#160;    }</div>
<div class="line"><a name="l13789"></a><span class="lineno">13789</span>&#160;</div>
<div class="line"><a name="l13796"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ac92bf6e625a271c53f17bf23c508613e">13796</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ac92bf6e625a271c53f17bf23c508613e">getGroupPageNoFormatted</a>() {</div>
<div class="line"><a name="l13797"></a><span class="lineno">13797</span>&#160;        <span class="keywordflow">return</span> TCPDF_STATIC::formatPageNumber($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#abb054390914b3cb23d207f4c36f0395c">getGroupPageNo</a>());</div>
<div class="line"><a name="l13798"></a><span class="lineno">13798</span>&#160;    }</div>
<div class="line"><a name="l13799"></a><span class="lineno">13799</span>&#160;</div>
<div class="line"><a name="l13806"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a43d7a316bc0f19d6540f238ebebe62d5">13806</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a43d7a316bc0f19d6540f238ebebe62d5">PageNoFormatted</a>() {</div>
<div class="line"><a name="l13807"></a><span class="lineno">13807</span>&#160;        <span class="keywordflow">return</span> TCPDF_STATIC::formatPageNumber($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a9ad828b184f08828f570a7e52316ba79">PageNo</a>());</div>
<div class="line"><a name="l13808"></a><span class="lineno">13808</span>&#160;    }</div>
<div class="line"><a name="l13809"></a><span class="lineno">13809</span>&#160;</div>
<div class="line"><a name="l13815"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a1de30d6f895d9fb9722f4440d9ae82d7">13815</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a1de30d6f895d9fb9722f4440d9ae82d7">_putocg</a>() {</div>
<div class="line"><a name="l13816"></a><span class="lineno">13816</span>&#160;        <span class="keywordflow">if</span> (empty($this-&gt;pdflayers)) {</div>
<div class="line"><a name="l13817"></a><span class="lineno">13817</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l13818"></a><span class="lineno">13818</span>&#160;        }</div>
<div class="line"><a name="l13819"></a><span class="lineno">13819</span>&#160;        <span class="keywordflow">foreach</span> ($this-&gt;pdflayers as $key =&gt; $layer) {</div>
<div class="line"><a name="l13820"></a><span class="lineno">13820</span>&#160;             $this-&gt;pdflayers[$key][<span class="stringliteral">&#39;objid&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d">_newobj</a>();</div>
<div class="line"><a name="l13821"></a><span class="lineno">13821</span>&#160;             $out = <span class="stringliteral">&#39;&lt;&lt; /Type /OCG&#39;</span>;</div>
<div class="line"><a name="l13822"></a><span class="lineno">13822</span>&#160;             $out .= <span class="stringliteral">&#39; /Name &#39;</span>.$this-&gt;_textstring($layer[<span class="stringliteral">&#39;name&#39;</span>], $this-&gt;pdflayers[$key][<span class="stringliteral">&#39;objid&#39;</span>]);</div>
<div class="line"><a name="l13823"></a><span class="lineno">13823</span>&#160;             $out .= <span class="stringliteral">&#39; /Usage &lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l13824"></a><span class="lineno">13824</span>&#160;             <span class="keywordflow">if</span> (isset($layer[<span class="stringliteral">&#39;print&#39;</span>]) AND ($layer[<span class="stringliteral">&#39;print&#39;</span>] !== NULL)) {</div>
<div class="line"><a name="l13825"></a><span class="lineno">13825</span>&#160;                $out .= <span class="stringliteral">&#39; /Print &lt;&lt;/PrintState /&#39;</span>.($layer[<span class="stringliteral">&#39;print&#39;</span>]?<span class="stringliteral">&#39;ON&#39;</span>:<span class="stringliteral">&#39;OFF&#39;</span>).<span class="stringliteral">&#39;&gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l13826"></a><span class="lineno">13826</span>&#160;             }</div>
<div class="line"><a name="l13827"></a><span class="lineno">13827</span>&#160;             $out .= <span class="stringliteral">&#39; /View &lt;&lt;/ViewState /&#39;</span>.($layer[<span class="stringliteral">&#39;view&#39;</span>]?<span class="stringliteral">&#39;ON&#39;</span>:<span class="stringliteral">&#39;OFF&#39;</span>).<span class="stringliteral">&#39;&gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l13828"></a><span class="lineno">13828</span>&#160;             $out .= <span class="stringliteral">&#39; &gt;&gt; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l13829"></a><span class="lineno">13829</span>&#160;             $out .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l13830"></a><span class="lineno">13830</span>&#160;             $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($out);</div>
<div class="line"><a name="l13831"></a><span class="lineno">13831</span>&#160;        }</div>
<div class="line"><a name="l13832"></a><span class="lineno">13832</span>&#160;    }</div>
<div class="line"><a name="l13833"></a><span class="lineno">13833</span>&#160;</div>
<div class="line"><a name="l13843"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a6c68aee9927218cac5798416a037f1a3">13843</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a6c68aee9927218cac5798416a037f1a3">startLayer</a>($name=<span class="stringliteral">&#39;&#39;</span>, $print=<span class="keyword">true</span>, $view=<span class="keyword">true</span>, $lock=<span class="keyword">true</span>) {</div>
<div class="line"><a name="l13844"></a><span class="lineno">13844</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;state != 2) {</div>
<div class="line"><a name="l13845"></a><span class="lineno">13845</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l13846"></a><span class="lineno">13846</span>&#160;        }</div>
<div class="line"><a name="l13847"></a><span class="lineno">13847</span>&#160;        $layer = sprintf(<span class="stringliteral">&#39;LYR%03d&#39;</span>, (count($this-&gt;pdflayers) + 1));</div>
<div class="line"><a name="l13848"></a><span class="lineno">13848</span>&#160;        <span class="keywordflow">if</span> (empty($name)) {</div>
<div class="line"><a name="l13849"></a><span class="lineno">13849</span>&#160;            $name = $layer;</div>
<div class="line"><a name="l13850"></a><span class="lineno">13850</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l13851"></a><span class="lineno">13851</span>&#160;            $name = preg_replace(<span class="stringliteral">&#39;/[^a-zA-Z0-9_\-]/&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $name);</div>
<div class="line"><a name="l13852"></a><span class="lineno">13852</span>&#160;        }</div>
<div class="line"><a name="l13853"></a><span class="lineno">13853</span>&#160;        $this-&gt;pdflayers[] = array(<span class="stringliteral">&#39;layer&#39;</span> =&gt; $layer, <span class="stringliteral">&#39;name&#39;</span> =&gt; $name, <span class="stringliteral">&#39;print&#39;</span> =&gt; $print, <span class="stringliteral">&#39;view&#39;</span> =&gt; $view, <span class="stringliteral">&#39;lock&#39;</span> =&gt; $lock);</div>
<div class="line"><a name="l13854"></a><span class="lineno">13854</span>&#160;        $this-&gt;openMarkedContent = <span class="keyword">true</span>;</div>
<div class="line"><a name="l13855"></a><span class="lineno">13855</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(<span class="stringliteral">&#39;/OC /&#39;</span>.$layer.<span class="stringliteral">&#39; BDC&#39;</span>);</div>
<div class="line"><a name="l13856"></a><span class="lineno">13856</span>&#160;    }</div>
<div class="line"><a name="l13857"></a><span class="lineno">13857</span>&#160;</div>
<div class="line"><a name="l13863"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a996258e3c16a3bb8de1f5c1ff8b8c9d8">13863</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a996258e3c16a3bb8de1f5c1ff8b8c9d8">endLayer</a>() {</div>
<div class="line"><a name="l13864"></a><span class="lineno">13864</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;state != 2) {</div>
<div class="line"><a name="l13865"></a><span class="lineno">13865</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l13866"></a><span class="lineno">13866</span>&#160;        }</div>
<div class="line"><a name="l13867"></a><span class="lineno">13867</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;openMarkedContent) {</div>
<div class="line"><a name="l13868"></a><span class="lineno">13868</span>&#160;            <span class="comment">// close existing open marked-content layer</span></div>
<div class="line"><a name="l13869"></a><span class="lineno">13869</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(<span class="stringliteral">&#39;EMC&#39;</span>);</div>
<div class="line"><a name="l13870"></a><span class="lineno">13870</span>&#160;            $this-&gt;openMarkedContent = <span class="keyword">false</span>;</div>
<div class="line"><a name="l13871"></a><span class="lineno">13871</span>&#160;        }</div>
<div class="line"><a name="l13872"></a><span class="lineno">13872</span>&#160;    }</div>
<div class="line"><a name="l13873"></a><span class="lineno">13873</span>&#160;</div>
<div class="line"><a name="l13882"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ab0f6ca38653854c80ef47a1909685030">13882</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ab0f6ca38653854c80ef47a1909685030">setVisibility</a>($v) {</div>
<div class="line"><a name="l13883"></a><span class="lineno">13883</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;state != 2) {</div>
<div class="line"><a name="l13884"></a><span class="lineno">13884</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l13885"></a><span class="lineno">13885</span>&#160;        }</div>
<div class="line"><a name="l13886"></a><span class="lineno">13886</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a996258e3c16a3bb8de1f5c1ff8b8c9d8">endLayer</a>();</div>
<div class="line"><a name="l13887"></a><span class="lineno">13887</span>&#160;        <span class="keywordflow">switch</span>($v) {</div>
<div class="line"><a name="l13888"></a><span class="lineno">13888</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;print&#39;</span>: {</div>
<div class="line"><a name="l13889"></a><span class="lineno">13889</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a6c68aee9927218cac5798416a037f1a3">startLayer</a>(<span class="stringliteral">&#39;Print&#39;</span>, <span class="keyword">true</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l13890"></a><span class="lineno">13890</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l13891"></a><span class="lineno">13891</span>&#160;            }</div>
<div class="line"><a name="l13892"></a><span class="lineno">13892</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;view&#39;</span>:</div>
<div class="line"><a name="l13893"></a><span class="lineno">13893</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;screen&#39;</span>: {</div>
<div class="line"><a name="l13894"></a><span class="lineno">13894</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a6c68aee9927218cac5798416a037f1a3">startLayer</a>(<span class="stringliteral">&#39;View&#39;</span>, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l13895"></a><span class="lineno">13895</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l13896"></a><span class="lineno">13896</span>&#160;            }</div>
<div class="line"><a name="l13897"></a><span class="lineno">13897</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;all&#39;</span>: {</div>
<div class="line"><a name="l13898"></a><span class="lineno">13898</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(<span class="stringliteral">&#39;&#39;</span>);</div>
<div class="line"><a name="l13899"></a><span class="lineno">13899</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l13900"></a><span class="lineno">13900</span>&#160;            }</div>
<div class="line"><a name="l13901"></a><span class="lineno">13901</span>&#160;            <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l13902"></a><span class="lineno">13902</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;Incorrect visibility: &#39;</span>.$v);</div>
<div class="line"><a name="l13903"></a><span class="lineno">13903</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l13904"></a><span class="lineno">13904</span>&#160;            }</div>
<div class="line"><a name="l13905"></a><span class="lineno">13905</span>&#160;        }</div>
<div class="line"><a name="l13906"></a><span class="lineno">13906</span>&#160;    }</div>
<div class="line"><a name="l13907"></a><span class="lineno">13907</span>&#160;</div>
<div class="line"><a name="l13915"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a4e9c60bd295bc60a66d7c6492072d1ef">13915</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a4e9c60bd295bc60a66d7c6492072d1ef">addExtGState</a>($parms) {</div>
<div class="line"><a name="l13916"></a><span class="lineno">13916</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;pdfa_mode) {</div>
<div class="line"><a name="l13917"></a><span class="lineno">13917</span>&#160;            <span class="comment">// transparencies are not allowed in PDF/A mode</span></div>
<div class="line"><a name="l13918"></a><span class="lineno">13918</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l13919"></a><span class="lineno">13919</span>&#160;        }</div>
<div class="line"><a name="l13920"></a><span class="lineno">13920</span>&#160;        <span class="comment">// check if this ExtGState already exist</span></div>
<div class="line"><a name="l13921"></a><span class="lineno">13921</span>&#160;        <span class="keywordflow">foreach</span> ($this-&gt;extgstates as $i =&gt; $ext) {</div>
<div class="line"><a name="l13922"></a><span class="lineno">13922</span>&#160;            <span class="keywordflow">if</span> ($ext[<span class="stringliteral">&#39;parms&#39;</span>] == $parms) {</div>
<div class="line"><a name="l13923"></a><span class="lineno">13923</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;inxobj) {</div>
<div class="line"><a name="l13924"></a><span class="lineno">13924</span>&#160;                    <span class="comment">// we are inside an XObject template</span></div>
<div class="line"><a name="l13925"></a><span class="lineno">13925</span>&#160;                    $this-&gt;xobjects[<a class="code" href="../../d4/d40/classTCPDF.html#abe4390b4e1939e10c9b61a986adfc117">$this-&gt;xobjid</a>][<span class="stringliteral">&#39;extgstates&#39;</span>][$i] = $ext;</div>
<div class="line"><a name="l13926"></a><span class="lineno">13926</span>&#160;                }</div>
<div class="line"><a name="l13927"></a><span class="lineno">13927</span>&#160;                <span class="comment">// return reference to existing ExtGState</span></div>
<div class="line"><a name="l13928"></a><span class="lineno">13928</span>&#160;                <span class="keywordflow">return</span> $i;</div>
<div class="line"><a name="l13929"></a><span class="lineno">13929</span>&#160;            }</div>
<div class="line"><a name="l13930"></a><span class="lineno">13930</span>&#160;        }</div>
<div class="line"><a name="l13931"></a><span class="lineno">13931</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a> = (count($this-&gt;extgstates) + 1);</div>
<div class="line"><a name="l13932"></a><span class="lineno">13932</span>&#160;        $this-&gt;extgstates[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>] = array(<span class="stringliteral">&#39;parms&#39;</span> =&gt; $parms);</div>
<div class="line"><a name="l13933"></a><span class="lineno">13933</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;inxobj) {</div>
<div class="line"><a name="l13934"></a><span class="lineno">13934</span>&#160;            <span class="comment">// we are inside an XObject template</span></div>
<div class="line"><a name="l13935"></a><span class="lineno">13935</span>&#160;            $this-&gt;xobjects[<a class="code" href="../../d4/d40/classTCPDF.html#abe4390b4e1939e10c9b61a986adfc117">$this-&gt;xobjid</a>][<span class="stringliteral">&#39;extgstates&#39;</span>][<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>] = $this-&gt;extgstates[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>];</div>
<div class="line"><a name="l13936"></a><span class="lineno">13936</span>&#160;        }</div>
<div class="line"><a name="l13937"></a><span class="lineno">13937</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>;</div>
<div class="line"><a name="l13938"></a><span class="lineno">13938</span>&#160;    }</div>
<div class="line"><a name="l13939"></a><span class="lineno">13939</span>&#160;</div>
<div class="line"><a name="l13946"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#adfc2d921b91adad5a68441245ddb2180">13946</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#adfc2d921b91adad5a68441245ddb2180">setExtGState</a>($gs) {</div>
<div class="line"><a name="l13947"></a><span class="lineno">13947</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;pdfa_mode OR ($this-&gt;state != 2)) {</div>
<div class="line"><a name="l13948"></a><span class="lineno">13948</span>&#160;            <span class="comment">// transparency is not allowed in PDF/A mode</span></div>
<div class="line"><a name="l13949"></a><span class="lineno">13949</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l13950"></a><span class="lineno">13950</span>&#160;        }</div>
<div class="line"><a name="l13951"></a><span class="lineno">13951</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(sprintf(<span class="stringliteral">&#39;/GS%d gs&#39;</span>, $gs));</div>
<div class="line"><a name="l13952"></a><span class="lineno">13952</span>&#160;    }</div>
<div class="line"><a name="l13953"></a><span class="lineno">13953</span>&#160;</div>
<div class="line"><a name="l13959"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a5bbbb689c42b3173b755c08cf9c0b58d">13959</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a5bbbb689c42b3173b755c08cf9c0b58d">_putextgstates</a>() {</div>
<div class="line"><a name="l13960"></a><span class="lineno">13960</span>&#160;        <span class="keywordflow">foreach</span> ($this-&gt;extgstates as $i =&gt; $ext) {</div>
<div class="line"><a name="l13961"></a><span class="lineno">13961</span>&#160;            $this-&gt;extgstates[$i][<span class="charliteral">&#39;n&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d">_newobj</a>();</div>
<div class="line"><a name="l13962"></a><span class="lineno">13962</span>&#160;            $out = <span class="stringliteral">&#39;&lt;&lt; /Type /ExtGState&#39;</span>;</div>
<div class="line"><a name="l13963"></a><span class="lineno">13963</span>&#160;            <span class="keywordflow">foreach</span> ($ext[<span class="stringliteral">&#39;parms&#39;</span>] as <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a> =&gt; $v) {</div>
<div class="line"><a name="l13964"></a><span class="lineno">13964</span>&#160;                <span class="keywordflow">if</span> (is_float($v)) {</div>
<div class="line"><a name="l13965"></a><span class="lineno">13965</span>&#160;                    $v = sprintf(<span class="stringliteral">&#39;%F&#39;</span>, $v);</div>
<div class="line"><a name="l13966"></a><span class="lineno">13966</span>&#160;                } elseif ($v === <span class="keyword">true</span>) {</div>
<div class="line"><a name="l13967"></a><span class="lineno">13967</span>&#160;                    $v = <span class="stringliteral">&#39;true&#39;</span>;</div>
<div class="line"><a name="l13968"></a><span class="lineno">13968</span>&#160;                } elseif ($v === <span class="keyword">false</span>) {</div>
<div class="line"><a name="l13969"></a><span class="lineno">13969</span>&#160;                    $v = <span class="stringliteral">&#39;false&#39;</span>;</div>
<div class="line"><a name="l13970"></a><span class="lineno">13970</span>&#160;                }</div>
<div class="line"><a name="l13971"></a><span class="lineno">13971</span>&#160;                $out .= <span class="stringliteral">&#39; /&#39;</span>.$k.<span class="charliteral">&#39; &#39;</span>.$v;</div>
<div class="line"><a name="l13972"></a><span class="lineno">13972</span>&#160;            }</div>
<div class="line"><a name="l13973"></a><span class="lineno">13973</span>&#160;            $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l13974"></a><span class="lineno">13974</span>&#160;            $out .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l13975"></a><span class="lineno">13975</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($out);</div>
<div class="line"><a name="l13976"></a><span class="lineno">13976</span>&#160;        }</div>
<div class="line"><a name="l13977"></a><span class="lineno">13977</span>&#160;    }</div>
<div class="line"><a name="l13978"></a><span class="lineno">13978</span>&#160;</div>
<div class="line"><a name="l13988"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a487f96d4c8261189e774c33d1f6c3409">13988</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a487f96d4c8261189e774c33d1f6c3409">setOverprint</a>($stroking=<span class="keyword">true</span>, $nonstroking=<span class="stringliteral">&#39;&#39;</span>, $mode=0) {</div>
<div class="line"><a name="l13989"></a><span class="lineno">13989</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;state != 2) {</div>
<div class="line"><a name="l13990"></a><span class="lineno">13990</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l13991"></a><span class="lineno">13991</span>&#160;        }</div>
<div class="line"><a name="l13992"></a><span class="lineno">13992</span>&#160;        $stroking = $stroking ? <span class="keyword">true</span> : <span class="keyword">false</span>;</div>
<div class="line"><a name="l13993"></a><span class="lineno">13993</span>&#160;        <span class="keywordflow">if</span> (TCPDF_STATIC::empty_string($nonstroking)) {</div>
<div class="line"><a name="l13994"></a><span class="lineno">13994</span>&#160;            <span class="comment">// default value if not set</span></div>
<div class="line"><a name="l13995"></a><span class="lineno">13995</span>&#160;            $nonstroking = $stroking;</div>
<div class="line"><a name="l13996"></a><span class="lineno">13996</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l13997"></a><span class="lineno">13997</span>&#160;            $nonstroking = $nonstroking ? <span class="keyword">true</span> : <span class="keyword">false</span>;</div>
<div class="line"><a name="l13998"></a><span class="lineno">13998</span>&#160;        }</div>
<div class="line"><a name="l13999"></a><span class="lineno">13999</span>&#160;        <span class="keywordflow">if</span> (($mode != 0) AND ($mode != 1)) {</div>
<div class="line"><a name="l14000"></a><span class="lineno">14000</span>&#160;            $mode = 0;</div>
<div class="line"><a name="l14001"></a><span class="lineno">14001</span>&#160;        }</div>
<div class="line"><a name="l14002"></a><span class="lineno">14002</span>&#160;        $this-&gt;overprint = array(<span class="stringliteral">&#39;OP&#39;</span> =&gt; $stroking, <span class="stringliteral">&#39;op&#39;</span> =&gt; $nonstroking, <span class="stringliteral">&#39;OPM&#39;</span> =&gt; $mode);</div>
<div class="line"><a name="l14003"></a><span class="lineno">14003</span>&#160;        $gs = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4e9c60bd295bc60a66d7c6492072d1ef">addExtGState</a>($this-&gt;overprint);</div>
<div class="line"><a name="l14004"></a><span class="lineno">14004</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#adfc2d921b91adad5a68441245ddb2180">setExtGState</a>($gs);</div>
<div class="line"><a name="l14005"></a><span class="lineno">14005</span>&#160;    }</div>
<div class="line"><a name="l14006"></a><span class="lineno">14006</span>&#160;</div>
<div class="line"><a name="l14014"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a26b593699320edd0a9e49fdf7acc0758">14014</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a26b593699320edd0a9e49fdf7acc0758">getOverprint</a>() {</div>
<div class="line"><a name="l14015"></a><span class="lineno">14015</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#a271d4b388e1d57856c6f569cd97cb58f">$this-&gt;overprint</a>;</div>
<div class="line"><a name="l14016"></a><span class="lineno">14016</span>&#160;    }</div>
<div class="line"><a name="l14017"></a><span class="lineno">14017</span>&#160;</div>
<div class="line"><a name="l14027"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a4624d23bdfb5df6a8760b63602d8b203">14027</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a4624d23bdfb5df6a8760b63602d8b203">setAlpha</a>($stroking=1, $bm=<span class="stringliteral">&#39;Normal&#39;</span>, $nonstroking=<span class="stringliteral">&#39;&#39;</span>, $ais=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l14028"></a><span class="lineno">14028</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;pdfa_mode) {</div>
<div class="line"><a name="l14029"></a><span class="lineno">14029</span>&#160;            <span class="comment">// transparency is not allowed in PDF/A mode</span></div>
<div class="line"><a name="l14030"></a><span class="lineno">14030</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l14031"></a><span class="lineno">14031</span>&#160;        }</div>
<div class="line"><a name="l14032"></a><span class="lineno">14032</span>&#160;        $stroking = floatval($stroking);</div>
<div class="line"><a name="l14033"></a><span class="lineno">14033</span>&#160;        <span class="keywordflow">if</span> (TCPDF_STATIC::empty_string($nonstroking)) {</div>
<div class="line"><a name="l14034"></a><span class="lineno">14034</span>&#160;            <span class="comment">// default value if not set</span></div>
<div class="line"><a name="l14035"></a><span class="lineno">14035</span>&#160;            $nonstroking = $stroking;</div>
<div class="line"><a name="l14036"></a><span class="lineno">14036</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l14037"></a><span class="lineno">14037</span>&#160;            $nonstroking = floatval($nonstroking);</div>
<div class="line"><a name="l14038"></a><span class="lineno">14038</span>&#160;        }</div>
<div class="line"><a name="l14039"></a><span class="lineno">14039</span>&#160;        <span class="keywordflow">if</span> ($bm[0] == <span class="charliteral">&#39;/&#39;</span>) {</div>
<div class="line"><a name="l14040"></a><span class="lineno">14040</span>&#160;            <span class="comment">// remove trailing slash</span></div>
<div class="line"><a name="l14041"></a><span class="lineno">14041</span>&#160;            $bm = substr($bm, 1);</div>
<div class="line"><a name="l14042"></a><span class="lineno">14042</span>&#160;        }</div>
<div class="line"><a name="l14043"></a><span class="lineno">14043</span>&#160;        <span class="keywordflow">if</span> (!in_array($bm, array(<span class="stringliteral">&#39;Normal&#39;</span>, <span class="stringliteral">&#39;Multiply&#39;</span>, <span class="stringliteral">&#39;Screen&#39;</span>, <span class="stringliteral">&#39;Overlay&#39;</span>, <span class="stringliteral">&#39;Darken&#39;</span>, <span class="stringliteral">&#39;Lighten&#39;</span>, <span class="stringliteral">&#39;ColorDodge&#39;</span>, <span class="stringliteral">&#39;ColorBurn&#39;</span>, <span class="stringliteral">&#39;HardLight&#39;</span>, <span class="stringliteral">&#39;SoftLight&#39;</span>, <span class="stringliteral">&#39;Difference&#39;</span>, <span class="stringliteral">&#39;Exclusion&#39;</span>, <span class="stringliteral">&#39;Hue&#39;</span>, <span class="stringliteral">&#39;Saturation&#39;</span>, <span class="stringliteral">&#39;Color&#39;</span>, <span class="stringliteral">&#39;Luminosity&#39;</span>))) {</div>
<div class="line"><a name="l14044"></a><span class="lineno">14044</span>&#160;            $bm = <span class="stringliteral">&#39;Normal&#39;</span>;</div>
<div class="line"><a name="l14045"></a><span class="lineno">14045</span>&#160;        }</div>
<div class="line"><a name="l14046"></a><span class="lineno">14046</span>&#160;        $ais = $ais ? <span class="keyword">true</span> : <span class="keyword">false</span>;</div>
<div class="line"><a name="l14047"></a><span class="lineno">14047</span>&#160;        $this-&gt;alpha = array(<span class="stringliteral">&#39;CA&#39;</span> =&gt; $stroking, <span class="stringliteral">&#39;ca&#39;</span> =&gt; $nonstroking, <span class="stringliteral">&#39;BM&#39;</span> =&gt; <span class="charliteral">&#39;/&#39;</span>.$bm, <span class="stringliteral">&#39;AIS&#39;</span> =&gt; $ais);</div>
<div class="line"><a name="l14048"></a><span class="lineno">14048</span>&#160;        $gs = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4e9c60bd295bc60a66d7c6492072d1ef">addExtGState</a>($this-&gt;alpha);</div>
<div class="line"><a name="l14049"></a><span class="lineno">14049</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#adfc2d921b91adad5a68441245ddb2180">setExtGState</a>($gs);</div>
<div class="line"><a name="l14050"></a><span class="lineno">14050</span>&#160;    }</div>
<div class="line"><a name="l14051"></a><span class="lineno">14051</span>&#160;</div>
<div class="line"><a name="l14059"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a1f5bcb7dd420836d8f1a287ff4b5a08e">14059</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a1f5bcb7dd420836d8f1a287ff4b5a08e">getAlpha</a>() {</div>
<div class="line"><a name="l14060"></a><span class="lineno">14060</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#ae4a86c2e1ba1b7026fbfb1eb43845f1a">$this-&gt;alpha</a>;</div>
<div class="line"><a name="l14061"></a><span class="lineno">14061</span>&#160;    }</div>
<div class="line"><a name="l14062"></a><span class="lineno">14062</span>&#160;</div>
<div class="line"><a name="l14069"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a06a80145927b40683b26d9013ec8d3c6">14069</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a06a80145927b40683b26d9013ec8d3c6">setJPEGQuality</a>($quality) {</div>
<div class="line"><a name="l14070"></a><span class="lineno">14070</span>&#160;        <span class="keywordflow">if</span> (($quality &lt; 1) OR ($quality &gt; 100)) {</div>
<div class="line"><a name="l14071"></a><span class="lineno">14071</span>&#160;            $quality = 75;</div>
<div class="line"><a name="l14072"></a><span class="lineno">14072</span>&#160;        }</div>
<div class="line"><a name="l14073"></a><span class="lineno">14073</span>&#160;        $this-&gt;jpeg_quality = intval($quality);</div>
<div class="line"><a name="l14074"></a><span class="lineno">14074</span>&#160;    }</div>
<div class="line"><a name="l14075"></a><span class="lineno">14075</span>&#160;</div>
<div class="line"><a name="l14082"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a77e62aa96deef4fed708e97c11cbac05">14082</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a77e62aa96deef4fed708e97c11cbac05">setDefaultTableColumns</a>($cols=4) {</div>
<div class="line"><a name="l14083"></a><span class="lineno">14083</span>&#160;        $this-&gt;default_table_columns = intval($cols);</div>
<div class="line"><a name="l14084"></a><span class="lineno">14084</span>&#160;    }</div>
<div class="line"><a name="l14085"></a><span class="lineno">14085</span>&#160;</div>
<div class="line"><a name="l14092"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a90ad3198737e6fead5791fa317a8a1f0">14092</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a90ad3198737e6fead5791fa317a8a1f0">setCellHeightRatio</a>(<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>) {</div>
<div class="line"><a name="l14093"></a><span class="lineno">14093</span>&#160;        $this-&gt;cell_height_ratio = <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>;</div>
<div class="line"><a name="l14094"></a><span class="lineno">14094</span>&#160;    }</div>
<div class="line"><a name="l14095"></a><span class="lineno">14095</span>&#160;</div>
<div class="line"><a name="l14101"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a6e29d82b9a9e318c703370ec474499ad">14101</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a6e29d82b9a9e318c703370ec474499ad">getCellHeightRatio</a>() {</div>
<div class="line"><a name="l14102"></a><span class="lineno">14102</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#af8cc74fe5806eb009a22791c3a4c7cce">$this-&gt;cell_height_ratio</a>;</div>
<div class="line"><a name="l14103"></a><span class="lineno">14103</span>&#160;    }</div>
<div class="line"><a name="l14104"></a><span class="lineno">14104</span>&#160;</div>
<div class="line"><a name="l14111"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a2803ddf7b83704355bcf1225f06cfcbb">14111</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a2803ddf7b83704355bcf1225f06cfcbb">setPDFVersion</a>($version=<span class="stringliteral">&#39;1.7&#39;</span>) {</div>
<div class="line"><a name="l14112"></a><span class="lineno">14112</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;pdfa_mode) {</div>
<div class="line"><a name="l14113"></a><span class="lineno">14113</span>&#160;            <span class="comment">// PDF/A mode</span></div>
<div class="line"><a name="l14114"></a><span class="lineno">14114</span>&#160;            $this-&gt;PDFVersion = <span class="stringliteral">&#39;1.4&#39;</span>;</div>
<div class="line"><a name="l14115"></a><span class="lineno">14115</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l14116"></a><span class="lineno">14116</span>&#160;            $this-&gt;PDFVersion = $version;</div>
<div class="line"><a name="l14117"></a><span class="lineno">14117</span>&#160;        }</div>
<div class="line"><a name="l14118"></a><span class="lineno">14118</span>&#160;    }</div>
<div class="line"><a name="l14119"></a><span class="lineno">14119</span>&#160;</div>
<div class="line"><a name="l14129"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ad09b32089f8e68c9d8424a2777627c21">14129</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ad09b32089f8e68c9d8424a2777627c21">setViewerPreferences</a>($preferences) {</div>
<div class="line"><a name="l14130"></a><span class="lineno">14130</span>&#160;        $this-&gt;viewer_preferences = $preferences;</div>
<div class="line"><a name="l14131"></a><span class="lineno">14131</span>&#160;    }</div>
<div class="line"><a name="l14132"></a><span class="lineno">14132</span>&#160;</div>
<div class="line"><a name="l14146"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a1d91b56a9679cf395342ad0b6c2a4191">14146</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a1d91b56a9679cf395342ad0b6c2a4191">colorRegistrationBar</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $transition=<span class="keyword">true</span>, $vertical=<span class="keyword">false</span>, $colors=<span class="stringliteral">&#39;A,R,G,B,C,M,Y,K&#39;</span>) {</div>
<div class="line"><a name="l14147"></a><span class="lineno">14147</span>&#160;        <span class="keywordflow">if</span> (strpos($colors, <span class="stringliteral">&#39;ALLSPOT&#39;</span>) !== <span class="keyword">false</span>) {</div>
<div class="line"><a name="l14148"></a><span class="lineno">14148</span>&#160;            <span class="comment">// expand spot colors</span></div>
<div class="line"><a name="l14149"></a><span class="lineno">14149</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a25c924c6b9a12aba0d0a3e535eca224d">$spot_colors</a> = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l14150"></a><span class="lineno">14150</span>&#160;            <span class="keywordflow">foreach</span> ($this-&gt;spot_colors as $spot_color_name =&gt; $v) {</div>
<div class="line"><a name="l14151"></a><span class="lineno">14151</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a25c924c6b9a12aba0d0a3e535eca224d">$spot_colors</a> .= <span class="charliteral">&#39;,&#39;</span>.$spot_color_name;</div>
<div class="line"><a name="l14152"></a><span class="lineno">14152</span>&#160;            }</div>
<div class="line"><a name="l14153"></a><span class="lineno">14153</span>&#160;            <span class="keywordflow">if</span> (!empty(<a class="code" href="../../d4/d40/classTCPDF.html#a25c924c6b9a12aba0d0a3e535eca224d">$spot_colors</a>)) {</div>
<div class="line"><a name="l14154"></a><span class="lineno">14154</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a25c924c6b9a12aba0d0a3e535eca224d">$spot_colors</a> = substr(<a class="code" href="../../d4/d40/classTCPDF.html#a25c924c6b9a12aba0d0a3e535eca224d">$spot_colors</a>, 1);</div>
<div class="line"><a name="l14155"></a><span class="lineno">14155</span>&#160;                $colors = str_replace(<span class="stringliteral">&#39;ALLSPOT&#39;</span>, <a class="code" href="../../d4/d40/classTCPDF.html#a25c924c6b9a12aba0d0a3e535eca224d">$spot_colors</a>, $colors);</div>
<div class="line"><a name="l14156"></a><span class="lineno">14156</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l14157"></a><span class="lineno">14157</span>&#160;                $colors = str_replace(<span class="stringliteral">&#39;ALLSPOT&#39;</span>, <span class="stringliteral">&#39;NONE&#39;</span>, $colors);</div>
<div class="line"><a name="l14158"></a><span class="lineno">14158</span>&#160;            }</div>
<div class="line"><a name="l14159"></a><span class="lineno">14159</span>&#160;        }</div>
<div class="line"><a name="l14160"></a><span class="lineno">14160</span>&#160;        $bars = explode(<span class="charliteral">&#39;,&#39;</span>, $colors);</div>
<div class="line"><a name="l14161"></a><span class="lineno">14161</span>&#160;        $numbars = count($bars); <span class="comment">// number of bars to print</span></div>
<div class="line"><a name="l14162"></a><span class="lineno">14162</span>&#160;        <span class="keywordflow">if</span> ($numbars &lt;= 0) {</div>
<div class="line"><a name="l14163"></a><span class="lineno">14163</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l14164"></a><span class="lineno">14164</span>&#160;        }</div>
<div class="line"><a name="l14165"></a><span class="lineno">14165</span>&#160;        <span class="comment">// set bar measures</span></div>
<div class="line"><a name="l14166"></a><span class="lineno">14166</span>&#160;        <span class="keywordflow">if</span> ($vertical) {</div>
<div class="line"><a name="l14167"></a><span class="lineno">14167</span>&#160;            $coords = array(0, 0, 0, 1);</div>
<div class="line"><a name="l14168"></a><span class="lineno">14168</span>&#160;            $wb = <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> / $numbars; <span class="comment">// bar width</span></div>
<div class="line"><a name="l14169"></a><span class="lineno">14169</span>&#160;            $hb = <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>; <span class="comment">// bar height</span></div>
<div class="line"><a name="l14170"></a><span class="lineno">14170</span>&#160;            $xd = $wb; <span class="comment">// delta x</span></div>
<div class="line"><a name="l14171"></a><span class="lineno">14171</span>&#160;            $yd = 0; <span class="comment">// delta y</span></div>
<div class="line"><a name="l14172"></a><span class="lineno">14172</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l14173"></a><span class="lineno">14173</span>&#160;            $coords = array(1, 0, 0, 0);</div>
<div class="line"><a name="l14174"></a><span class="lineno">14174</span>&#160;            $wb = <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>; <span class="comment">// bar width</span></div>
<div class="line"><a name="l14175"></a><span class="lineno">14175</span>&#160;            $hb = <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> / $numbars; <span class="comment">// bar height</span></div>
<div class="line"><a name="l14176"></a><span class="lineno">14176</span>&#160;            $xd = 0; <span class="comment">// delta x</span></div>
<div class="line"><a name="l14177"></a><span class="lineno">14177</span>&#160;            $yd = $hb; <span class="comment">// delta y</span></div>
<div class="line"><a name="l14178"></a><span class="lineno">14178</span>&#160;        }</div>
<div class="line"><a name="l14179"></a><span class="lineno">14179</span>&#160;        $xb = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>;</div>
<div class="line"><a name="l14180"></a><span class="lineno">14180</span>&#160;        $yb = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>;</div>
<div class="line"><a name="l14181"></a><span class="lineno">14181</span>&#160;        <span class="keywordflow">foreach</span> ($bars as $col) {</div>
<div class="line"><a name="l14182"></a><span class="lineno">14182</span>&#160;            <span class="keywordflow">switch</span> ($col) {</div>
<div class="line"><a name="l14183"></a><span class="lineno">14183</span>&#160;                <span class="comment">// set transition colors</span></div>
<div class="line"><a name="l14184"></a><span class="lineno">14184</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;A&#39;</span>: { <span class="comment">// BLACK (GRAYSCALE)</span></div>
<div class="line"><a name="l14185"></a><span class="lineno">14185</span>&#160;                    $col_a = array(255);</div>
<div class="line"><a name="l14186"></a><span class="lineno">14186</span>&#160;                    $col_b = array(0);</div>
<div class="line"><a name="l14187"></a><span class="lineno">14187</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l14188"></a><span class="lineno">14188</span>&#160;                }</div>
<div class="line"><a name="l14189"></a><span class="lineno">14189</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;W&#39;</span>: { <span class="comment">// WHITE (GRAYSCALE)</span></div>
<div class="line"><a name="l14190"></a><span class="lineno">14190</span>&#160;                    $col_a = array(0);</div>
<div class="line"><a name="l14191"></a><span class="lineno">14191</span>&#160;                    $col_b = array(255);</div>
<div class="line"><a name="l14192"></a><span class="lineno">14192</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l14193"></a><span class="lineno">14193</span>&#160;                }</div>
<div class="line"><a name="l14194"></a><span class="lineno">14194</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;R&#39;</span>: { <span class="comment">// RED (RGB)</span></div>
<div class="line"><a name="l14195"></a><span class="lineno">14195</span>&#160;                    $col_a = array(255,255,255);</div>
<div class="line"><a name="l14196"></a><span class="lineno">14196</span>&#160;                    $col_b = array(255,0,0);</div>
<div class="line"><a name="l14197"></a><span class="lineno">14197</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l14198"></a><span class="lineno">14198</span>&#160;                }</div>
<div class="line"><a name="l14199"></a><span class="lineno">14199</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;G&#39;</span>: { <span class="comment">// GREEN (RGB)</span></div>
<div class="line"><a name="l14200"></a><span class="lineno">14200</span>&#160;                    $col_a = array(255,255,255);</div>
<div class="line"><a name="l14201"></a><span class="lineno">14201</span>&#160;                    $col_b = array(0,255,0);</div>
<div class="line"><a name="l14202"></a><span class="lineno">14202</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l14203"></a><span class="lineno">14203</span>&#160;                }</div>
<div class="line"><a name="l14204"></a><span class="lineno">14204</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>: { <span class="comment">// BLUE (RGB)</span></div>
<div class="line"><a name="l14205"></a><span class="lineno">14205</span>&#160;                    $col_a = array(255,255,255);</div>
<div class="line"><a name="l14206"></a><span class="lineno">14206</span>&#160;                    $col_b = array(0,0,255);</div>
<div class="line"><a name="l14207"></a><span class="lineno">14207</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l14208"></a><span class="lineno">14208</span>&#160;                }</div>
<div class="line"><a name="l14209"></a><span class="lineno">14209</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>: { <span class="comment">// CYAN (CMYK)</span></div>
<div class="line"><a name="l14210"></a><span class="lineno">14210</span>&#160;                    $col_a = array(0,0,0,0);</div>
<div class="line"><a name="l14211"></a><span class="lineno">14211</span>&#160;                    $col_b = array(100,0,0,0);</div>
<div class="line"><a name="l14212"></a><span class="lineno">14212</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l14213"></a><span class="lineno">14213</span>&#160;                }</div>
<div class="line"><a name="l14214"></a><span class="lineno">14214</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;M&#39;</span>: { <span class="comment">// MAGENTA (CMYK)</span></div>
<div class="line"><a name="l14215"></a><span class="lineno">14215</span>&#160;                    $col_a = array(0,0,0,0);</div>
<div class="line"><a name="l14216"></a><span class="lineno">14216</span>&#160;                    $col_b = array(0,100,0,0);</div>
<div class="line"><a name="l14217"></a><span class="lineno">14217</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l14218"></a><span class="lineno">14218</span>&#160;                }</div>
<div class="line"><a name="l14219"></a><span class="lineno">14219</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;Y&#39;</span>: { <span class="comment">// YELLOW (CMYK)</span></div>
<div class="line"><a name="l14220"></a><span class="lineno">14220</span>&#160;                    $col_a = array(0,0,0,0);</div>
<div class="line"><a name="l14221"></a><span class="lineno">14221</span>&#160;                    $col_b = array(0,0,100,0);</div>
<div class="line"><a name="l14222"></a><span class="lineno">14222</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l14223"></a><span class="lineno">14223</span>&#160;                }</div>
<div class="line"><a name="l14224"></a><span class="lineno">14224</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;K&#39;</span>: { <span class="comment">// KEY - BLACK (CMYK)</span></div>
<div class="line"><a name="l14225"></a><span class="lineno">14225</span>&#160;                    $col_a = array(0,0,0,0);</div>
<div class="line"><a name="l14226"></a><span class="lineno">14226</span>&#160;                    $col_b = array(0,0,0,100);</div>
<div class="line"><a name="l14227"></a><span class="lineno">14227</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l14228"></a><span class="lineno">14228</span>&#160;                }</div>
<div class="line"><a name="l14229"></a><span class="lineno">14229</span>&#160;                <span class="keywordflow">case</span> <span class="stringliteral">&#39;RGB&#39;</span>: { <span class="comment">// BLACK REGISTRATION (RGB)</span></div>
<div class="line"><a name="l14230"></a><span class="lineno">14230</span>&#160;                    $col_a = array(255,255,255);</div>
<div class="line"><a name="l14231"></a><span class="lineno">14231</span>&#160;                    $col_b = array(0,0,0);</div>
<div class="line"><a name="l14232"></a><span class="lineno">14232</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l14233"></a><span class="lineno">14233</span>&#160;                }</div>
<div class="line"><a name="l14234"></a><span class="lineno">14234</span>&#160;                <span class="keywordflow">case</span> <span class="stringliteral">&#39;CMYK&#39;</span>: { <span class="comment">// BLACK REGISTRATION (CMYK)</span></div>
<div class="line"><a name="l14235"></a><span class="lineno">14235</span>&#160;                    $col_a = array(0,0,0,0);</div>
<div class="line"><a name="l14236"></a><span class="lineno">14236</span>&#160;                    $col_b = array(100,100,100,100);</div>
<div class="line"><a name="l14237"></a><span class="lineno">14237</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l14238"></a><span class="lineno">14238</span>&#160;                }</div>
<div class="line"><a name="l14239"></a><span class="lineno">14239</span>&#160;                <span class="keywordflow">case</span> <span class="stringliteral">&#39;ALL&#39;</span>: { <span class="comment">// SPOT COLOR REGISTRATION</span></div>
<div class="line"><a name="l14240"></a><span class="lineno">14240</span>&#160;                    $col_a = array(0,0,0,0,<span class="stringliteral">&#39;None&#39;</span>);</div>
<div class="line"><a name="l14241"></a><span class="lineno">14241</span>&#160;                    $col_b = array(100,100,100,100,<span class="stringliteral">&#39;All&#39;</span>);</div>
<div class="line"><a name="l14242"></a><span class="lineno">14242</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l14243"></a><span class="lineno">14243</span>&#160;                }</div>
<div class="line"><a name="l14244"></a><span class="lineno">14244</span>&#160;                <span class="keywordflow">case</span> <span class="stringliteral">&#39;NONE&#39;</span>: { <span class="comment">// SKIP THIS COLOR</span></div>
<div class="line"><a name="l14245"></a><span class="lineno">14245</span>&#160;                    $col_a = array(0,0,0,0,<span class="stringliteral">&#39;None&#39;</span>);</div>
<div class="line"><a name="l14246"></a><span class="lineno">14246</span>&#160;                    $col_b = array(0,0,0,0,<span class="stringliteral">&#39;None&#39;</span>);</div>
<div class="line"><a name="l14247"></a><span class="lineno">14247</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l14248"></a><span class="lineno">14248</span>&#160;                }</div>
<div class="line"><a name="l14249"></a><span class="lineno">14249</span>&#160;                <span class="keywordflow">default</span>: { <span class="comment">// SPECIFIC SPOT COLOR NAME</span></div>
<div class="line"><a name="l14250"></a><span class="lineno">14250</span>&#160;                    $col_a = array(0,0,0,0,<span class="stringliteral">&#39;None&#39;</span>);</div>
<div class="line"><a name="l14251"></a><span class="lineno">14251</span>&#160;                    $col_b = TCPDF_COLORS::getSpotColor($col, $this-&gt;spot_colors);</div>
<div class="line"><a name="l14252"></a><span class="lineno">14252</span>&#160;                    <span class="keywordflow">if</span> ($col_b === <span class="keyword">false</span>) {</div>
<div class="line"><a name="l14253"></a><span class="lineno">14253</span>&#160;                        <span class="comment">// in case of error defaults to the registration color</span></div>
<div class="line"><a name="l14254"></a><span class="lineno">14254</span>&#160;                        $col_b = array(100,100,100,100,<span class="stringliteral">&#39;All&#39;</span>);</div>
<div class="line"><a name="l14255"></a><span class="lineno">14255</span>&#160;                    }</div>
<div class="line"><a name="l14256"></a><span class="lineno">14256</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l14257"></a><span class="lineno">14257</span>&#160;                }</div>
<div class="line"><a name="l14258"></a><span class="lineno">14258</span>&#160;            }</div>
<div class="line"><a name="l14259"></a><span class="lineno">14259</span>&#160;            <span class="keywordflow">if</span> ($col != <span class="stringliteral">&#39;NONE&#39;</span>) {</div>
<div class="line"><a name="l14260"></a><span class="lineno">14260</span>&#160;                <span class="keywordflow">if</span> ($transition) {</div>
<div class="line"><a name="l14261"></a><span class="lineno">14261</span>&#160;                    <span class="comment">// color gradient</span></div>
<div class="line"><a name="l14262"></a><span class="lineno">14262</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a16a896313dd8736178a90d367edb6f61">LinearGradient</a>($xb, $yb, $wb, $hb, $col_a, $col_b, $coords);</div>
<div class="line"><a name="l14263"></a><span class="lineno">14263</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l14264"></a><span class="lineno">14264</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a850dd347f649c99548a193f2b84a502e">SetFillColorArray</a>($col_b);</div>
<div class="line"><a name="l14265"></a><span class="lineno">14265</span>&#160;                    <span class="comment">// colored rectangle</span></div>
<div class="line"><a name="l14266"></a><span class="lineno">14266</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8fc7b86c255aeb0f14d281bdaeb2015c">Rect</a>($xb, $yb, $wb, $hb, <span class="charliteral">&#39;F&#39;</span>, array());</div>
<div class="line"><a name="l14267"></a><span class="lineno">14267</span>&#160;                }</div>
<div class="line"><a name="l14268"></a><span class="lineno">14268</span>&#160;                $xb += $xd;</div>
<div class="line"><a name="l14269"></a><span class="lineno">14269</span>&#160;                $yb += $yd;</div>
<div class="line"><a name="l14270"></a><span class="lineno">14270</span>&#160;            }</div>
<div class="line"><a name="l14271"></a><span class="lineno">14271</span>&#160;        }</div>
<div class="line"><a name="l14272"></a><span class="lineno">14272</span>&#160;    }</div>
<div class="line"><a name="l14273"></a><span class="lineno">14273</span>&#160;</div>
<div class="line"><a name="l14286"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a73e8adbbe29b64c860af2d9c23105c3d">14286</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a73e8adbbe29b64c860af2d9c23105c3d">cropMark</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $type=<span class="stringliteral">&#39;T,R,B,L&#39;</span>, $color=array(100,100,100,100,<span class="stringliteral">&#39;All&#39;</span>)) {</div>
<div class="line"><a name="l14287"></a><span class="lineno">14287</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a3d9b3717cd9ad8db31642155c832d148">SetLineStyle</a>(array(<span class="stringliteral">&#39;width&#39;</span> =&gt; (0.5 / $this-&gt;k), <span class="stringliteral">&#39;cap&#39;</span> =&gt; <span class="stringliteral">&#39;butt&#39;</span>, <span class="stringliteral">&#39;join&#39;</span> =&gt; <span class="stringliteral">&#39;miter&#39;</span>, <span class="stringliteral">&#39;dash&#39;</span> =&gt; 0, <span class="stringliteral">&#39;color&#39;</span> =&gt; $color));</div>
<div class="line"><a name="l14288"></a><span class="lineno">14288</span>&#160;        $type = strtoupper($type);</div>
<div class="line"><a name="l14289"></a><span class="lineno">14289</span>&#160;        $type = preg_replace(<span class="stringliteral">&#39;/[^A-Z\-\,]*/&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $type);</div>
<div class="line"><a name="l14290"></a><span class="lineno">14290</span>&#160;        <span class="comment">// split type in single components</span></div>
<div class="line"><a name="l14291"></a><span class="lineno">14291</span>&#160;        $type = str_replace(<span class="charliteral">&#39;-&#39;</span>, <span class="charliteral">&#39;,&#39;</span>, $type);</div>
<div class="line"><a name="l14292"></a><span class="lineno">14292</span>&#160;        $type = str_replace(<span class="stringliteral">&#39;TL&#39;</span>, <span class="stringliteral">&#39;T,L&#39;</span>, $type);</div>
<div class="line"><a name="l14293"></a><span class="lineno">14293</span>&#160;        $type = str_replace(<span class="stringliteral">&#39;TR&#39;</span>, <span class="stringliteral">&#39;T,R&#39;</span>, $type);</div>
<div class="line"><a name="l14294"></a><span class="lineno">14294</span>&#160;        $type = str_replace(<span class="stringliteral">&#39;BL&#39;</span>, <span class="stringliteral">&#39;F,L&#39;</span>, $type);</div>
<div class="line"><a name="l14295"></a><span class="lineno">14295</span>&#160;        $type = str_replace(<span class="stringliteral">&#39;BR&#39;</span>, <span class="stringliteral">&#39;F,R&#39;</span>, $type);</div>
<div class="line"><a name="l14296"></a><span class="lineno">14296</span>&#160;        $type = str_replace(<span class="charliteral">&#39;A&#39;</span>, <span class="stringliteral">&#39;T,L&#39;</span>, $type);</div>
<div class="line"><a name="l14297"></a><span class="lineno">14297</span>&#160;        $type = str_replace(<span class="charliteral">&#39;B&#39;</span>, <span class="stringliteral">&#39;T,R&#39;</span>, $type);</div>
<div class="line"><a name="l14298"></a><span class="lineno">14298</span>&#160;        $type = str_replace(<span class="stringliteral">&#39;T,RO&#39;</span>, <span class="stringliteral">&#39;BO&#39;</span>, $type);</div>
<div class="line"><a name="l14299"></a><span class="lineno">14299</span>&#160;        $type = str_replace(<span class="charliteral">&#39;C&#39;</span>, <span class="stringliteral">&#39;F,L&#39;</span>, $type);</div>
<div class="line"><a name="l14300"></a><span class="lineno">14300</span>&#160;        $type = str_replace(<span class="charliteral">&#39;D&#39;</span>, <span class="stringliteral">&#39;F,R&#39;</span>, $type);</div>
<div class="line"><a name="l14301"></a><span class="lineno">14301</span>&#160;        $crops = explode(<span class="charliteral">&#39;,&#39;</span>, strtoupper($type));</div>
<div class="line"><a name="l14302"></a><span class="lineno">14302</span>&#160;        <span class="comment">// remove duplicates</span></div>
<div class="line"><a name="l14303"></a><span class="lineno">14303</span>&#160;        $crops = array_unique($crops);</div>
<div class="line"><a name="l14304"></a><span class="lineno">14304</span>&#160;        $dw = (<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> / 4); <span class="comment">// horizontal space to leave before the intersection point</span></div>
<div class="line"><a name="l14305"></a><span class="lineno">14305</span>&#160;        $dh = (<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> / 4); <span class="comment">// vertical space to leave before the intersection point</span></div>
<div class="line"><a name="l14306"></a><span class="lineno">14306</span>&#160;        <span class="keywordflow">foreach</span> ($crops as $crop) {</div>
<div class="line"><a name="l14307"></a><span class="lineno">14307</span>&#160;            <span class="keywordflow">switch</span> ($crop) {</div>
<div class="line"><a name="l14308"></a><span class="lineno">14308</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>:</div>
<div class="line"><a name="l14309"></a><span class="lineno">14309</span>&#160;                <span class="keywordflow">case</span> <span class="stringliteral">&#39;TOP&#39;</span>: {</div>
<div class="line"><a name="l14310"></a><span class="lineno">14310</span>&#160;                    $x1 = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>;</div>
<div class="line"><a name="l14311"></a><span class="lineno">14311</span>&#160;                    $y1 = (<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> - <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>);</div>
<div class="line"><a name="l14312"></a><span class="lineno">14312</span>&#160;                    $x2 = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>;</div>
<div class="line"><a name="l14313"></a><span class="lineno">14313</span>&#160;                    $y2 = (<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> - $dh);</div>
<div class="line"><a name="l14314"></a><span class="lineno">14314</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l14315"></a><span class="lineno">14315</span>&#160;                }</div>
<div class="line"><a name="l14316"></a><span class="lineno">14316</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;F&#39;</span>:</div>
<div class="line"><a name="l14317"></a><span class="lineno">14317</span>&#160;                <span class="keywordflow">case</span> <span class="stringliteral">&#39;BOTTOM&#39;</span>: {</div>
<div class="line"><a name="l14318"></a><span class="lineno">14318</span>&#160;                    $x1 = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>;</div>
<div class="line"><a name="l14319"></a><span class="lineno">14319</span>&#160;                    $y1 = (<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> + $dh);</div>
<div class="line"><a name="l14320"></a><span class="lineno">14320</span>&#160;                    $x2 = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>;</div>
<div class="line"><a name="l14321"></a><span class="lineno">14321</span>&#160;                    $y2 = (<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> + <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>);</div>
<div class="line"><a name="l14322"></a><span class="lineno">14322</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l14323"></a><span class="lineno">14323</span>&#160;                }</div>
<div class="line"><a name="l14324"></a><span class="lineno">14324</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;L&#39;</span>:</div>
<div class="line"><a name="l14325"></a><span class="lineno">14325</span>&#160;                <span class="keywordflow">case</span> <span class="stringliteral">&#39;LEFT&#39;</span>: {</div>
<div class="line"><a name="l14326"></a><span class="lineno">14326</span>&#160;                    $x1 = (<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> - <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>);</div>
<div class="line"><a name="l14327"></a><span class="lineno">14327</span>&#160;                    $y1 = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>;</div>
<div class="line"><a name="l14328"></a><span class="lineno">14328</span>&#160;                    $x2 = (<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> - $dw);</div>
<div class="line"><a name="l14329"></a><span class="lineno">14329</span>&#160;                    $y2 = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>;</div>
<div class="line"><a name="l14330"></a><span class="lineno">14330</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l14331"></a><span class="lineno">14331</span>&#160;                }</div>
<div class="line"><a name="l14332"></a><span class="lineno">14332</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;R&#39;</span>:</div>
<div class="line"><a name="l14333"></a><span class="lineno">14333</span>&#160;                <span class="keywordflow">case</span> <span class="stringliteral">&#39;RIGHT&#39;</span>: {</div>
<div class="line"><a name="l14334"></a><span class="lineno">14334</span>&#160;                    $x1 = (<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> + $dw);</div>
<div class="line"><a name="l14335"></a><span class="lineno">14335</span>&#160;                    $y1 = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>;</div>
<div class="line"><a name="l14336"></a><span class="lineno">14336</span>&#160;                    $x2 = (<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> + <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>);</div>
<div class="line"><a name="l14337"></a><span class="lineno">14337</span>&#160;                    $y2 = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>;</div>
<div class="line"><a name="l14338"></a><span class="lineno">14338</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l14339"></a><span class="lineno">14339</span>&#160;                }</div>
<div class="line"><a name="l14340"></a><span class="lineno">14340</span>&#160;            }</div>
<div class="line"><a name="l14341"></a><span class="lineno">14341</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a89c0fac95da962719ba92b057df9c201">Line</a>($x1, $y1, $x2, $y2);</div>
<div class="line"><a name="l14342"></a><span class="lineno">14342</span>&#160;        }</div>
<div class="line"><a name="l14343"></a><span class="lineno">14343</span>&#160;    }</div>
<div class="line"><a name="l14344"></a><span class="lineno">14344</span>&#160;</div>
<div class="line"><a name="l14357"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a1b321a324b9dde239fe1a61974174c7c">14357</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a1b321a324b9dde239fe1a61974174c7c">registrationMark</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, $r, $double=<span class="keyword">false</span>, $cola=array(100,100,100,100,<span class="stringliteral">&#39;All&#39;</span>), $colb=array(0,0,0,0,<span class="stringliteral">&#39;None&#39;</span>)) {</div>
<div class="line"><a name="l14358"></a><span class="lineno">14358</span>&#160;        $line_style = array(<span class="stringliteral">&#39;width&#39;</span> =&gt; max((0.5 / $this-&gt;k),($r / 30)), <span class="stringliteral">&#39;cap&#39;</span> =&gt; <span class="stringliteral">&#39;butt&#39;</span>, <span class="stringliteral">&#39;join&#39;</span> =&gt; <span class="stringliteral">&#39;miter&#39;</span>, <span class="stringliteral">&#39;dash&#39;</span> =&gt; 0, <span class="stringliteral">&#39;color&#39;</span> =&gt; $cola);</div>
<div class="line"><a name="l14359"></a><span class="lineno">14359</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a850dd347f649c99548a193f2b84a502e">SetFillColorArray</a>($cola);</div>
<div class="line"><a name="l14360"></a><span class="lineno">14360</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac138de610bac7bee8885178db32dcea0">PieSector</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, $r, 90, 180, <span class="charliteral">&#39;F&#39;</span>);</div>
<div class="line"><a name="l14361"></a><span class="lineno">14361</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac138de610bac7bee8885178db32dcea0">PieSector</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, $r, 270, 360, <span class="charliteral">&#39;F&#39;</span>);</div>
<div class="line"><a name="l14362"></a><span class="lineno">14362</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a7e7f5d97a5c33e2245d3860aed35a593">Circle</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, $r, 0, 360, <span class="charliteral">&#39;C&#39;</span>, $line_style, array(), 8);</div>
<div class="line"><a name="l14363"></a><span class="lineno">14363</span>&#160;        <span class="keywordflow">if</span> ($double) {</div>
<div class="line"><a name="l14364"></a><span class="lineno">14364</span>&#160;            $ri = $r * 0.5;</div>
<div class="line"><a name="l14365"></a><span class="lineno">14365</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a850dd347f649c99548a193f2b84a502e">SetFillColorArray</a>($colb);</div>
<div class="line"><a name="l14366"></a><span class="lineno">14366</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac138de610bac7bee8885178db32dcea0">PieSector</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, $ri, 90, 180, <span class="charliteral">&#39;F&#39;</span>);</div>
<div class="line"><a name="l14367"></a><span class="lineno">14367</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac138de610bac7bee8885178db32dcea0">PieSector</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, $ri, 270, 360, <span class="charliteral">&#39;F&#39;</span>);</div>
<div class="line"><a name="l14368"></a><span class="lineno">14368</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a850dd347f649c99548a193f2b84a502e">SetFillColorArray</a>($cola);</div>
<div class="line"><a name="l14369"></a><span class="lineno">14369</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac138de610bac7bee8885178db32dcea0">PieSector</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, $ri, 0, 90, <span class="charliteral">&#39;F&#39;</span>);</div>
<div class="line"><a name="l14370"></a><span class="lineno">14370</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac138de610bac7bee8885178db32dcea0">PieSector</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, $ri, 180, 270, <span class="charliteral">&#39;F&#39;</span>);</div>
<div class="line"><a name="l14371"></a><span class="lineno">14371</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a7e7f5d97a5c33e2245d3860aed35a593">Circle</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, $ri, 0, 360, <span class="charliteral">&#39;C&#39;</span>, $line_style, array(), 8);</div>
<div class="line"><a name="l14372"></a><span class="lineno">14372</span>&#160;        }</div>
<div class="line"><a name="l14373"></a><span class="lineno">14373</span>&#160;    }</div>
<div class="line"><a name="l14374"></a><span class="lineno">14374</span>&#160;</div>
<div class="line"><a name="l14384"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a8f4ca031806c6392225a504eff945f1e">14384</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a8f4ca031806c6392225a504eff945f1e">registrationMarkCMYK</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, $r) {</div>
<div class="line"><a name="l14385"></a><span class="lineno">14385</span>&#160;        <span class="comment">// line width</span></div>
<div class="line"><a name="l14386"></a><span class="lineno">14386</span>&#160;        $lw = max((0.5 / $this-&gt;k),($r / 8));</div>
<div class="line"><a name="l14387"></a><span class="lineno">14387</span>&#160;        <span class="comment">// internal radius</span></div>
<div class="line"><a name="l14388"></a><span class="lineno">14388</span>&#160;        $ri = ($r * 0.6);</div>
<div class="line"><a name="l14389"></a><span class="lineno">14389</span>&#160;        <span class="comment">// external radius</span></div>
<div class="line"><a name="l14390"></a><span class="lineno">14390</span>&#160;        $re = ($r * 1.3);</div>
<div class="line"><a name="l14391"></a><span class="lineno">14391</span>&#160;        <span class="comment">// Cyan</span></div>
<div class="line"><a name="l14392"></a><span class="lineno">14392</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a850dd347f649c99548a193f2b84a502e">SetFillColorArray</a>(array(100,0,0,0));</div>
<div class="line"><a name="l14393"></a><span class="lineno">14393</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac138de610bac7bee8885178db32dcea0">PieSector</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, $ri, 270, 360, <span class="charliteral">&#39;F&#39;</span>);</div>
<div class="line"><a name="l14394"></a><span class="lineno">14394</span>&#160;        <span class="comment">// Magenta</span></div>
<div class="line"><a name="l14395"></a><span class="lineno">14395</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a850dd347f649c99548a193f2b84a502e">SetFillColorArray</a>(array(0,100,0,0));</div>
<div class="line"><a name="l14396"></a><span class="lineno">14396</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac138de610bac7bee8885178db32dcea0">PieSector</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, $ri, 0, 90, <span class="charliteral">&#39;F&#39;</span>);</div>
<div class="line"><a name="l14397"></a><span class="lineno">14397</span>&#160;        <span class="comment">// Yellow</span></div>
<div class="line"><a name="l14398"></a><span class="lineno">14398</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a850dd347f649c99548a193f2b84a502e">SetFillColorArray</a>(array(0,0,100,0));</div>
<div class="line"><a name="l14399"></a><span class="lineno">14399</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac138de610bac7bee8885178db32dcea0">PieSector</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, $ri, 90, 180, <span class="charliteral">&#39;F&#39;</span>);</div>
<div class="line"><a name="l14400"></a><span class="lineno">14400</span>&#160;        <span class="comment">// Key - black</span></div>
<div class="line"><a name="l14401"></a><span class="lineno">14401</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a850dd347f649c99548a193f2b84a502e">SetFillColorArray</a>(array(0,0,0,100));</div>
<div class="line"><a name="l14402"></a><span class="lineno">14402</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac138de610bac7bee8885178db32dcea0">PieSector</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, $ri, 180, 270, <span class="charliteral">&#39;F&#39;</span>);</div>
<div class="line"><a name="l14403"></a><span class="lineno">14403</span>&#160;        <span class="comment">// registration color</span></div>
<div class="line"><a name="l14404"></a><span class="lineno">14404</span>&#160;        $line_style = array(<span class="stringliteral">&#39;width&#39;</span> =&gt; $lw, <span class="stringliteral">&#39;cap&#39;</span> =&gt; <span class="stringliteral">&#39;butt&#39;</span>, <span class="stringliteral">&#39;join&#39;</span> =&gt; <span class="stringliteral">&#39;miter&#39;</span>, <span class="stringliteral">&#39;dash&#39;</span> =&gt; 0, <span class="stringliteral">&#39;color&#39;</span> =&gt; array(100,100,100,100,<span class="stringliteral">&#39;All&#39;</span>));</div>
<div class="line"><a name="l14405"></a><span class="lineno">14405</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a850dd347f649c99548a193f2b84a502e">SetFillColorArray</a>(array(100,100,100,100,<span class="stringliteral">&#39;All&#39;</span>));</div>
<div class="line"><a name="l14406"></a><span class="lineno">14406</span>&#160;        <span class="comment">// external circle</span></div>
<div class="line"><a name="l14407"></a><span class="lineno">14407</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a7e7f5d97a5c33e2245d3860aed35a593">Circle</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, $r, 0, 360, <span class="charliteral">&#39;C&#39;</span>, $line_style, array(), 8);</div>
<div class="line"><a name="l14408"></a><span class="lineno">14408</span>&#160;        <span class="comment">// cross lines</span></div>
<div class="line"><a name="l14409"></a><span class="lineno">14409</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a89c0fac95da962719ba92b057df9c201">Line</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, (<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> - $re), <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, (<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> - $ri));</div>
<div class="line"><a name="l14410"></a><span class="lineno">14410</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a89c0fac95da962719ba92b057df9c201">Line</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, (<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> + $ri), <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, (<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> + $re));</div>
<div class="line"><a name="l14411"></a><span class="lineno">14411</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a89c0fac95da962719ba92b057df9c201">Line</a>((<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> - $re), <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, (<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> - $ri), <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>);</div>
<div class="line"><a name="l14412"></a><span class="lineno">14412</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a89c0fac95da962719ba92b057df9c201">Line</a>((<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> + $ri), <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, (<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> + $re), <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>);</div>
<div class="line"><a name="l14413"></a><span class="lineno">14413</span>&#160;    }</div>
<div class="line"><a name="l14414"></a><span class="lineno">14414</span>&#160;</div>
<div class="line"><a name="l14428"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a16a896313dd8736178a90d367edb6f61">14428</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a16a896313dd8736178a90d367edb6f61">LinearGradient</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $col1=array(), $col2=array(), $coords=array(0,0,1,0)) {</div>
<div class="line"><a name="l14429"></a><span class="lineno">14429</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af353ab2d04ac6b69733765f7ea35ebcc">Clip</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>);</div>
<div class="line"><a name="l14430"></a><span class="lineno">14430</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ab4f165583b4f50a0a0bbf81eb346e4bb">Gradient</a>(2, $coords, array(array(<span class="stringliteral">&#39;color&#39;</span> =&gt; $col1, <span class="stringliteral">&#39;offset&#39;</span> =&gt; 0, <span class="stringliteral">&#39;exponent&#39;</span> =&gt; 1), array(<span class="stringliteral">&#39;color&#39;</span> =&gt; $col2, <span class="stringliteral">&#39;offset&#39;</span> =&gt; 1, <span class="stringliteral">&#39;exponent&#39;</span> =&gt; 1)), array(), <span class="keyword">false</span>);</div>
<div class="line"><a name="l14431"></a><span class="lineno">14431</span>&#160;    }</div>
<div class="line"><a name="l14432"></a><span class="lineno">14432</span>&#160;</div>
<div class="line"><a name="l14446"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aae83f746192e3b8d28bedefe664b6c6d">14446</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#aae83f746192e3b8d28bedefe664b6c6d">RadialGradient</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $col1=array(), $col2=array(), $coords=array(0.5,0.5,0.5,0.5,1)) {</div>
<div class="line"><a name="l14447"></a><span class="lineno">14447</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af353ab2d04ac6b69733765f7ea35ebcc">Clip</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>);</div>
<div class="line"><a name="l14448"></a><span class="lineno">14448</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ab4f165583b4f50a0a0bbf81eb346e4bb">Gradient</a>(3, $coords, array(array(<span class="stringliteral">&#39;color&#39;</span> =&gt; $col1, <span class="stringliteral">&#39;offset&#39;</span> =&gt; 0, <span class="stringliteral">&#39;exponent&#39;</span> =&gt; 1), array(<span class="stringliteral">&#39;color&#39;</span> =&gt; $col2, <span class="stringliteral">&#39;offset&#39;</span> =&gt; 1, <span class="stringliteral">&#39;exponent&#39;</span> =&gt; 1)), array(), <span class="keyword">false</span>);</div>
<div class="line"><a name="l14449"></a><span class="lineno">14449</span>&#160;    }</div>
<div class="line"><a name="l14450"></a><span class="lineno">14450</span>&#160;</div>
<div class="line"><a name="l14469"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#afb4db924e2500df58789320694169785">14469</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#afb4db924e2500df58789320694169785">CoonsPatchMesh</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $col1=array(), $col2=array(), $col3=array(), $col4=array(), $coords=array(0.00,0.0,0.33,0.00,0.67,0.00,1.00,0.00,1.00,0.33,1.00,0.67,1.00,1.00,0.67,1.00,0.33,1.00,0.00,1.00,0.00,0.67,0.00,0.33), $coords_min=0, $coords_max=1, $antialias=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l14470"></a><span class="lineno">14470</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;pdfa_mode OR ($this-&gt;state != 2)) {</div>
<div class="line"><a name="l14471"></a><span class="lineno">14471</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l14472"></a><span class="lineno">14472</span>&#160;        }</div>
<div class="line"><a name="l14473"></a><span class="lineno">14473</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af353ab2d04ac6b69733765f7ea35ebcc">Clip</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>);</div>
<div class="line"><a name="l14474"></a><span class="lineno">14474</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a> = count($this-&gt;gradients) + 1;</div>
<div class="line"><a name="l14475"></a><span class="lineno">14475</span>&#160;        $this-&gt;gradients[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>] = array();</div>
<div class="line"><a name="l14476"></a><span class="lineno">14476</span>&#160;        $this-&gt;gradients[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;type&#39;</span>] = 6; <span class="comment">//coons patch mesh</span></div>
<div class="line"><a name="l14477"></a><span class="lineno">14477</span>&#160;        $this-&gt;gradients[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;coords&#39;</span>] = array();</div>
<div class="line"><a name="l14478"></a><span class="lineno">14478</span>&#160;        $this-&gt;gradients[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;antialias&#39;</span>] = $antialias;</div>
<div class="line"><a name="l14479"></a><span class="lineno">14479</span>&#160;        $this-&gt;gradients[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;colors&#39;</span>] = array();</div>
<div class="line"><a name="l14480"></a><span class="lineno">14480</span>&#160;        $this-&gt;gradients[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;transparency&#39;</span>] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l14481"></a><span class="lineno">14481</span>&#160;        <span class="comment">//check the coords array if it is the simple array or the multi patch array</span></div>
<div class="line"><a name="l14482"></a><span class="lineno">14482</span>&#160;        <span class="keywordflow">if</span> (!isset($coords[0][<span class="charliteral">&#39;f&#39;</span>])) {</div>
<div class="line"><a name="l14483"></a><span class="lineno">14483</span>&#160;            <span class="comment">//simple array -&gt; convert to multi patch array</span></div>
<div class="line"><a name="l14484"></a><span class="lineno">14484</span>&#160;            <span class="keywordflow">if</span> (!isset($col1[1])) {</div>
<div class="line"><a name="l14485"></a><span class="lineno">14485</span>&#160;                $col1[1] = $col1[2] = $col1[0];</div>
<div class="line"><a name="l14486"></a><span class="lineno">14486</span>&#160;            }</div>
<div class="line"><a name="l14487"></a><span class="lineno">14487</span>&#160;            <span class="keywordflow">if</span> (!isset($col2[1])) {</div>
<div class="line"><a name="l14488"></a><span class="lineno">14488</span>&#160;                $col2[1] = $col2[2] = $col2[0];</div>
<div class="line"><a name="l14489"></a><span class="lineno">14489</span>&#160;            }</div>
<div class="line"><a name="l14490"></a><span class="lineno">14490</span>&#160;            <span class="keywordflow">if</span> (!isset($col3[1])) {</div>
<div class="line"><a name="l14491"></a><span class="lineno">14491</span>&#160;                $col3[1] = $col3[2] = $col3[0];</div>
<div class="line"><a name="l14492"></a><span class="lineno">14492</span>&#160;            }</div>
<div class="line"><a name="l14493"></a><span class="lineno">14493</span>&#160;            <span class="keywordflow">if</span> (!isset($col4[1])) {</div>
<div class="line"><a name="l14494"></a><span class="lineno">14494</span>&#160;                $col4[1] = $col4[2] = $col4[0];</div>
<div class="line"><a name="l14495"></a><span class="lineno">14495</span>&#160;            }</div>
<div class="line"><a name="l14496"></a><span class="lineno">14496</span>&#160;            $patch_array[0][<span class="charliteral">&#39;f&#39;</span>] = 0;</div>
<div class="line"><a name="l14497"></a><span class="lineno">14497</span>&#160;            $patch_array[0][<span class="stringliteral">&#39;points&#39;</span>] = $coords;</div>
<div class="line"><a name="l14498"></a><span class="lineno">14498</span>&#160;            $patch_array[0][<span class="stringliteral">&#39;colors&#39;</span>][0][<span class="charliteral">&#39;r&#39;</span>] = $col1[0];</div>
<div class="line"><a name="l14499"></a><span class="lineno">14499</span>&#160;            $patch_array[0][<span class="stringliteral">&#39;colors&#39;</span>][0][<span class="charliteral">&#39;g&#39;</span>] = $col1[1];</div>
<div class="line"><a name="l14500"></a><span class="lineno">14500</span>&#160;            $patch_array[0][<span class="stringliteral">&#39;colors&#39;</span>][0][<span class="charliteral">&#39;b&#39;</span>] = $col1[2];</div>
<div class="line"><a name="l14501"></a><span class="lineno">14501</span>&#160;            $patch_array[0][<span class="stringliteral">&#39;colors&#39;</span>][1][<span class="charliteral">&#39;r&#39;</span>] = $col2[0];</div>
<div class="line"><a name="l14502"></a><span class="lineno">14502</span>&#160;            $patch_array[0][<span class="stringliteral">&#39;colors&#39;</span>][1][<span class="charliteral">&#39;g&#39;</span>] = $col2[1];</div>
<div class="line"><a name="l14503"></a><span class="lineno">14503</span>&#160;            $patch_array[0][<span class="stringliteral">&#39;colors&#39;</span>][1][<span class="charliteral">&#39;b&#39;</span>] = $col2[2];</div>
<div class="line"><a name="l14504"></a><span class="lineno">14504</span>&#160;            $patch_array[0][<span class="stringliteral">&#39;colors&#39;</span>][2][<span class="charliteral">&#39;r&#39;</span>] = $col3[0];</div>
<div class="line"><a name="l14505"></a><span class="lineno">14505</span>&#160;            $patch_array[0][<span class="stringliteral">&#39;colors&#39;</span>][2][<span class="charliteral">&#39;g&#39;</span>] = $col3[1];</div>
<div class="line"><a name="l14506"></a><span class="lineno">14506</span>&#160;            $patch_array[0][<span class="stringliteral">&#39;colors&#39;</span>][2][<span class="charliteral">&#39;b&#39;</span>] = $col3[2];</div>
<div class="line"><a name="l14507"></a><span class="lineno">14507</span>&#160;            $patch_array[0][<span class="stringliteral">&#39;colors&#39;</span>][3][<span class="charliteral">&#39;r&#39;</span>] = $col4[0];</div>
<div class="line"><a name="l14508"></a><span class="lineno">14508</span>&#160;            $patch_array[0][<span class="stringliteral">&#39;colors&#39;</span>][3][<span class="charliteral">&#39;g&#39;</span>] = $col4[1];</div>
<div class="line"><a name="l14509"></a><span class="lineno">14509</span>&#160;            $patch_array[0][<span class="stringliteral">&#39;colors&#39;</span>][3][<span class="charliteral">&#39;b&#39;</span>] = $col4[2];</div>
<div class="line"><a name="l14510"></a><span class="lineno">14510</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l14511"></a><span class="lineno">14511</span>&#160;            <span class="comment">//multi patch array</span></div>
<div class="line"><a name="l14512"></a><span class="lineno">14512</span>&#160;            $patch_array = $coords;</div>
<div class="line"><a name="l14513"></a><span class="lineno">14513</span>&#160;        }</div>
<div class="line"><a name="l14514"></a><span class="lineno">14514</span>&#160;        $bpcd = 65535; <span class="comment">//16 bits per coordinate</span></div>
<div class="line"><a name="l14515"></a><span class="lineno">14515</span>&#160;        <span class="comment">//build the data stream</span></div>
<div class="line"><a name="l14516"></a><span class="lineno">14516</span>&#160;        $this-&gt;gradients[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;stream&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l14517"></a><span class="lineno">14517</span>&#160;        $count_patch = count($patch_array);</div>
<div class="line"><a name="l14518"></a><span class="lineno">14518</span>&#160;        <span class="keywordflow">for</span> ($i=0; $i &lt; $count_patch; ++$i) {</div>
<div class="line"><a name="l14519"></a><span class="lineno">14519</span>&#160;            $this-&gt;gradients[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;stream&#39;</span>] .= chr($patch_array[$i][<span class="charliteral">&#39;f&#39;</span>]); <span class="comment">//start with the edge flag as 8 bit</span></div>
<div class="line"><a name="l14520"></a><span class="lineno">14520</span>&#160;            $count_points = count($patch_array[$i][<span class="stringliteral">&#39;points&#39;</span>]);</div>
<div class="line"><a name="l14521"></a><span class="lineno">14521</span>&#160;            <span class="keywordflow">for</span> ($j=0; $j &lt; $count_points; ++$j) {</div>
<div class="line"><a name="l14522"></a><span class="lineno">14522</span>&#160;                <span class="comment">//each point as 16 bit</span></div>
<div class="line"><a name="l14523"></a><span class="lineno">14523</span>&#160;                $patch_array[$i][<span class="stringliteral">&#39;points&#39;</span>][$j] = (($patch_array[$i][<span class="stringliteral">&#39;points&#39;</span>][$j] - $coords_min) / ($coords_max - $coords_min)) * $bpcd;</div>
<div class="line"><a name="l14524"></a><span class="lineno">14524</span>&#160;                <span class="keywordflow">if</span> ($patch_array[$i][<span class="stringliteral">&#39;points&#39;</span>][$j] &lt; 0) {</div>
<div class="line"><a name="l14525"></a><span class="lineno">14525</span>&#160;                    $patch_array[$i][<span class="stringliteral">&#39;points&#39;</span>][$j] = 0;</div>
<div class="line"><a name="l14526"></a><span class="lineno">14526</span>&#160;                }</div>
<div class="line"><a name="l14527"></a><span class="lineno">14527</span>&#160;                <span class="keywordflow">if</span> ($patch_array[$i][<span class="stringliteral">&#39;points&#39;</span>][$j] &gt; $bpcd) {</div>
<div class="line"><a name="l14528"></a><span class="lineno">14528</span>&#160;                    $patch_array[$i][<span class="stringliteral">&#39;points&#39;</span>][$j] = $bpcd;</div>
<div class="line"><a name="l14529"></a><span class="lineno">14529</span>&#160;                }</div>
<div class="line"><a name="l14530"></a><span class="lineno">14530</span>&#160;                $this-&gt;gradients[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;stream&#39;</span>] .= chr(floor($patch_array[$i][<span class="stringliteral">&#39;points&#39;</span>][$j] / 256));</div>
<div class="line"><a name="l14531"></a><span class="lineno">14531</span>&#160;                $this-&gt;gradients[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;stream&#39;</span>] .= chr(floor($patch_array[$i][<span class="stringliteral">&#39;points&#39;</span>][$j] % 256));</div>
<div class="line"><a name="l14532"></a><span class="lineno">14532</span>&#160;            }</div>
<div class="line"><a name="l14533"></a><span class="lineno">14533</span>&#160;            $count_cols = count($patch_array[$i][<span class="stringliteral">&#39;colors&#39;</span>]);</div>
<div class="line"><a name="l14534"></a><span class="lineno">14534</span>&#160;            <span class="keywordflow">for</span> ($j=0; $j &lt; $count_cols; ++$j) {</div>
<div class="line"><a name="l14535"></a><span class="lineno">14535</span>&#160;                <span class="comment">//each color component as 8 bit</span></div>
<div class="line"><a name="l14536"></a><span class="lineno">14536</span>&#160;                $this-&gt;gradients[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;stream&#39;</span>] .= chr($patch_array[$i][<span class="stringliteral">&#39;colors&#39;</span>][$j][<span class="charliteral">&#39;r&#39;</span>]);</div>
<div class="line"><a name="l14537"></a><span class="lineno">14537</span>&#160;                $this-&gt;gradients[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;stream&#39;</span>] .= chr($patch_array[$i][<span class="stringliteral">&#39;colors&#39;</span>][$j][<span class="charliteral">&#39;g&#39;</span>]);</div>
<div class="line"><a name="l14538"></a><span class="lineno">14538</span>&#160;                $this-&gt;gradients[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;stream&#39;</span>] .= chr($patch_array[$i][<span class="stringliteral">&#39;colors&#39;</span>][$j][<span class="charliteral">&#39;b&#39;</span>]);</div>
<div class="line"><a name="l14539"></a><span class="lineno">14539</span>&#160;            }</div>
<div class="line"><a name="l14540"></a><span class="lineno">14540</span>&#160;        }</div>
<div class="line"><a name="l14541"></a><span class="lineno">14541</span>&#160;        <span class="comment">//paint the gradient</span></div>
<div class="line"><a name="l14542"></a><span class="lineno">14542</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(<span class="stringliteral">&#39;/Sh&#39;</span>.<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>.<span class="stringliteral">&#39; sh&#39;</span>);</div>
<div class="line"><a name="l14543"></a><span class="lineno">14543</span>&#160;        <span class="comment">//restore previous Graphic State</span></div>
<div class="line"><a name="l14544"></a><span class="lineno">14544</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af623eface3ce63b2bc1709d47c84ab69">_outRestoreGraphicsState</a>();</div>
<div class="line"><a name="l14545"></a><span class="lineno">14545</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;inxobj) {</div>
<div class="line"><a name="l14546"></a><span class="lineno">14546</span>&#160;            <span class="comment">// we are inside an XObject template</span></div>
<div class="line"><a name="l14547"></a><span class="lineno">14547</span>&#160;            $this-&gt;xobjects[<a class="code" href="../../d4/d40/classTCPDF.html#abe4390b4e1939e10c9b61a986adfc117">$this-&gt;xobjid</a>][<span class="stringliteral">&#39;gradients&#39;</span>][<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>] = $this-&gt;gradients[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>];</div>
<div class="line"><a name="l14548"></a><span class="lineno">14548</span>&#160;        }</div>
<div class="line"><a name="l14549"></a><span class="lineno">14549</span>&#160;    }</div>
<div class="line"><a name="l14550"></a><span class="lineno">14550</span>&#160;</div>
<div class="line"><a name="l14561"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#af353ab2d04ac6b69733765f7ea35ebcc">14561</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#af353ab2d04ac6b69733765f7ea35ebcc">Clip</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>) {</div>
<div class="line"><a name="l14562"></a><span class="lineno">14562</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;state != 2) {</div>
<div class="line"><a name="l14563"></a><span class="lineno">14563</span>&#160;             <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l14564"></a><span class="lineno">14564</span>&#160;        }</div>
<div class="line"><a name="l14565"></a><span class="lineno">14565</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l14566"></a><span class="lineno">14566</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> = $this-&gt;w - <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> - <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>;</div>
<div class="line"><a name="l14567"></a><span class="lineno">14567</span>&#160;        }</div>
<div class="line"><a name="l14568"></a><span class="lineno">14568</span>&#160;        <span class="comment">//save current Graphic State</span></div>
<div class="line"><a name="l14569"></a><span class="lineno">14569</span>&#160;        $s = <span class="charliteral">&#39;q&#39;</span>;</div>
<div class="line"><a name="l14570"></a><span class="lineno">14570</span>&#160;        <span class="comment">//set clipping area</span></div>
<div class="line"><a name="l14571"></a><span class="lineno">14571</span>&#160;        $s .= sprintf(<span class="stringliteral">&#39; %F %F %F %F re W n&#39;</span>, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>*$this-&gt;k, ($this-&gt;h-<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>)*$this-&gt;k, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>*$this-&gt;k, -<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>*$this-&gt;k);</div>
<div class="line"><a name="l14572"></a><span class="lineno">14572</span>&#160;        <span class="comment">//set up transformation matrix for gradient</span></div>
<div class="line"><a name="l14573"></a><span class="lineno">14573</span>&#160;        $s .= sprintf(<span class="stringliteral">&#39; %F 0 0 %F %F %F cm&#39;</span>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>*$this-&gt;k, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>*$this-&gt;k, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>*$this-&gt;k, ($this-&gt;h-(<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>+<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>))*$this-&gt;k);</div>
<div class="line"><a name="l14574"></a><span class="lineno">14574</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($s);</div>
<div class="line"><a name="l14575"></a><span class="lineno">14575</span>&#160;    }</div>
<div class="line"><a name="l14576"></a><span class="lineno">14576</span>&#160;</div>
<div class="line"><a name="l14588"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ab4f165583b4f50a0a0bbf81eb346e4bb">14588</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ab4f165583b4f50a0a0bbf81eb346e4bb">Gradient</a>($type, $coords, $stops, $background=array(), $antialias=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l14589"></a><span class="lineno">14589</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;pdfa_mode OR ($this-&gt;state != 2)) {</div>
<div class="line"><a name="l14590"></a><span class="lineno">14590</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l14591"></a><span class="lineno">14591</span>&#160;        }</div>
<div class="line"><a name="l14592"></a><span class="lineno">14592</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a> = count($this-&gt;gradients) + 1;</div>
<div class="line"><a name="l14593"></a><span class="lineno">14593</span>&#160;        $this-&gt;gradients[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>] = array();</div>
<div class="line"><a name="l14594"></a><span class="lineno">14594</span>&#160;        $this-&gt;gradients[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;type&#39;</span>] = $type;</div>
<div class="line"><a name="l14595"></a><span class="lineno">14595</span>&#160;        $this-&gt;gradients[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;coords&#39;</span>] = $coords;</div>
<div class="line"><a name="l14596"></a><span class="lineno">14596</span>&#160;        $this-&gt;gradients[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;antialias&#39;</span>] = $antialias;</div>
<div class="line"><a name="l14597"></a><span class="lineno">14597</span>&#160;        $this-&gt;gradients[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;colors&#39;</span>] = array();</div>
<div class="line"><a name="l14598"></a><span class="lineno">14598</span>&#160;        $this-&gt;gradients[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;transparency&#39;</span>] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l14599"></a><span class="lineno">14599</span>&#160;        <span class="comment">// color space</span></div>
<div class="line"><a name="l14600"></a><span class="lineno">14600</span>&#160;        $numcolspace = count($stops[0][<span class="stringliteral">&#39;color&#39;</span>]);</div>
<div class="line"><a name="l14601"></a><span class="lineno">14601</span>&#160;        $bcolor = array_values($background);</div>
<div class="line"><a name="l14602"></a><span class="lineno">14602</span>&#160;        <span class="keywordflow">switch</span>($numcolspace) {</div>
<div class="line"><a name="l14603"></a><span class="lineno">14603</span>&#160;            <span class="keywordflow">case</span> 5:   <span class="comment">// SPOT</span></div>
<div class="line"><a name="l14604"></a><span class="lineno">14604</span>&#160;            <span class="keywordflow">case</span> 4: { <span class="comment">// CMYK</span></div>
<div class="line"><a name="l14605"></a><span class="lineno">14605</span>&#160;                $this-&gt;gradients[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;colspace&#39;</span>] = <span class="stringliteral">&#39;DeviceCMYK&#39;</span>;</div>
<div class="line"><a name="l14606"></a><span class="lineno">14606</span>&#160;                <span class="keywordflow">if</span> (!empty($background)) {</div>
<div class="line"><a name="l14607"></a><span class="lineno">14607</span>&#160;                    $this-&gt;gradients[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;background&#39;</span>] = sprintf(<span class="stringliteral">&#39;%F %F %F %F&#39;</span>, $bcolor[0]/100, $bcolor[1]/100, $bcolor[2]/100, $bcolor[3]/100);</div>
<div class="line"><a name="l14608"></a><span class="lineno">14608</span>&#160;                }</div>
<div class="line"><a name="l14609"></a><span class="lineno">14609</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l14610"></a><span class="lineno">14610</span>&#160;            }</div>
<div class="line"><a name="l14611"></a><span class="lineno">14611</span>&#160;            <span class="keywordflow">case</span> 3: { <span class="comment">// RGB</span></div>
<div class="line"><a name="l14612"></a><span class="lineno">14612</span>&#160;                $this-&gt;gradients[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;colspace&#39;</span>] = <span class="stringliteral">&#39;DeviceRGB&#39;</span>;</div>
<div class="line"><a name="l14613"></a><span class="lineno">14613</span>&#160;                <span class="keywordflow">if</span> (!empty($background)) {</div>
<div class="line"><a name="l14614"></a><span class="lineno">14614</span>&#160;                    $this-&gt;gradients[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;background&#39;</span>] = sprintf(<span class="stringliteral">&#39;%F %F %F&#39;</span>, $bcolor[0]/255, $bcolor[1]/255, $bcolor[2]/255);</div>
<div class="line"><a name="l14615"></a><span class="lineno">14615</span>&#160;                }</div>
<div class="line"><a name="l14616"></a><span class="lineno">14616</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l14617"></a><span class="lineno">14617</span>&#160;            }</div>
<div class="line"><a name="l14618"></a><span class="lineno">14618</span>&#160;            <span class="keywordflow">case</span> 1: { <span class="comment">// GRAY SCALE</span></div>
<div class="line"><a name="l14619"></a><span class="lineno">14619</span>&#160;                $this-&gt;gradients[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;colspace&#39;</span>] = <span class="stringliteral">&#39;DeviceGray&#39;</span>;</div>
<div class="line"><a name="l14620"></a><span class="lineno">14620</span>&#160;                <span class="keywordflow">if</span> (!empty($background)) {</div>
<div class="line"><a name="l14621"></a><span class="lineno">14621</span>&#160;                    $this-&gt;gradients[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;background&#39;</span>] = sprintf(<span class="stringliteral">&#39;%F&#39;</span>, $bcolor[0]/255);</div>
<div class="line"><a name="l14622"></a><span class="lineno">14622</span>&#160;                }</div>
<div class="line"><a name="l14623"></a><span class="lineno">14623</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l14624"></a><span class="lineno">14624</span>&#160;            }</div>
<div class="line"><a name="l14625"></a><span class="lineno">14625</span>&#160;        }</div>
<div class="line"><a name="l14626"></a><span class="lineno">14626</span>&#160;        $num_stops = count($stops);</div>
<div class="line"><a name="l14627"></a><span class="lineno">14627</span>&#160;        $last_stop_id = $num_stops - 1;</div>
<div class="line"><a name="l14628"></a><span class="lineno">14628</span>&#160;        <span class="keywordflow">foreach</span> ($stops as $key =&gt; $stop) {</div>
<div class="line"><a name="l14629"></a><span class="lineno">14629</span>&#160;            $this-&gt;gradients[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;colors&#39;</span>][$key] = array();</div>
<div class="line"><a name="l14630"></a><span class="lineno">14630</span>&#160;            <span class="comment">// offset represents a location along the gradient vector</span></div>
<div class="line"><a name="l14631"></a><span class="lineno">14631</span>&#160;            <span class="keywordflow">if</span> (isset($stop[<span class="stringliteral">&#39;offset&#39;</span>])) {</div>
<div class="line"><a name="l14632"></a><span class="lineno">14632</span>&#160;                $this-&gt;gradients[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;colors&#39;</span>][$key][<span class="stringliteral">&#39;offset&#39;</span>] = $stop[<span class="stringliteral">&#39;offset&#39;</span>];</div>
<div class="line"><a name="l14633"></a><span class="lineno">14633</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l14634"></a><span class="lineno">14634</span>&#160;                <span class="keywordflow">if</span> ($key == 0) {</div>
<div class="line"><a name="l14635"></a><span class="lineno">14635</span>&#160;                    $this-&gt;gradients[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;colors&#39;</span>][$key][<span class="stringliteral">&#39;offset&#39;</span>] = 0;</div>
<div class="line"><a name="l14636"></a><span class="lineno">14636</span>&#160;                } elseif ($key == $last_stop_id) {</div>
<div class="line"><a name="l14637"></a><span class="lineno">14637</span>&#160;                    $this-&gt;gradients[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;colors&#39;</span>][$key][<span class="stringliteral">&#39;offset&#39;</span>] = 1;</div>
<div class="line"><a name="l14638"></a><span class="lineno">14638</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l14639"></a><span class="lineno">14639</span>&#160;                    $offsetstep = (1 - $this-&gt;gradients[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;colors&#39;</span>][($key - 1)][<span class="stringliteral">&#39;offset&#39;</span>]) / ($num_stops - $key);</div>
<div class="line"><a name="l14640"></a><span class="lineno">14640</span>&#160;                    $this-&gt;gradients[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;colors&#39;</span>][$key][<span class="stringliteral">&#39;offset&#39;</span>] = $this-&gt;gradients[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;colors&#39;</span>][($key - 1)][<span class="stringliteral">&#39;offset&#39;</span>] + $offsetstep;</div>
<div class="line"><a name="l14641"></a><span class="lineno">14641</span>&#160;                }</div>
<div class="line"><a name="l14642"></a><span class="lineno">14642</span>&#160;            }</div>
<div class="line"><a name="l14643"></a><span class="lineno">14643</span>&#160;            <span class="keywordflow">if</span> (isset($stop[<span class="stringliteral">&#39;opacity&#39;</span>])) {</div>
<div class="line"><a name="l14644"></a><span class="lineno">14644</span>&#160;                $this-&gt;gradients[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;colors&#39;</span>][$key][<span class="stringliteral">&#39;opacity&#39;</span>] = $stop[<span class="stringliteral">&#39;opacity&#39;</span>];</div>
<div class="line"><a name="l14645"></a><span class="lineno">14645</span>&#160;                <span class="keywordflow">if</span> ((!$this-&gt;pdfa_mode) AND ($stop[<span class="stringliteral">&#39;opacity&#39;</span>] &lt; 1)) {</div>
<div class="line"><a name="l14646"></a><span class="lineno">14646</span>&#160;                    $this-&gt;gradients[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;transparency&#39;</span>] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l14647"></a><span class="lineno">14647</span>&#160;                }</div>
<div class="line"><a name="l14648"></a><span class="lineno">14648</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l14649"></a><span class="lineno">14649</span>&#160;                $this-&gt;gradients[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;colors&#39;</span>][$key][<span class="stringliteral">&#39;opacity&#39;</span>] = 1;</div>
<div class="line"><a name="l14650"></a><span class="lineno">14650</span>&#160;            }</div>
<div class="line"><a name="l14651"></a><span class="lineno">14651</span>&#160;            <span class="comment">// exponent for the exponential interpolation function</span></div>
<div class="line"><a name="l14652"></a><span class="lineno">14652</span>&#160;            <span class="keywordflow">if</span> (isset($stop[<span class="stringliteral">&#39;exponent&#39;</span>])) {</div>
<div class="line"><a name="l14653"></a><span class="lineno">14653</span>&#160;                $this-&gt;gradients[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;colors&#39;</span>][$key][<span class="stringliteral">&#39;exponent&#39;</span>] = $stop[<span class="stringliteral">&#39;exponent&#39;</span>];</div>
<div class="line"><a name="l14654"></a><span class="lineno">14654</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l14655"></a><span class="lineno">14655</span>&#160;                $this-&gt;gradients[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;colors&#39;</span>][$key][<span class="stringliteral">&#39;exponent&#39;</span>] = 1;</div>
<div class="line"><a name="l14656"></a><span class="lineno">14656</span>&#160;            }</div>
<div class="line"><a name="l14657"></a><span class="lineno">14657</span>&#160;            <span class="comment">// set colors</span></div>
<div class="line"><a name="l14658"></a><span class="lineno">14658</span>&#160;            $color = array_values($stop[<span class="stringliteral">&#39;color&#39;</span>]);</div>
<div class="line"><a name="l14659"></a><span class="lineno">14659</span>&#160;            <span class="keywordflow">switch</span>($numcolspace) {</div>
<div class="line"><a name="l14660"></a><span class="lineno">14660</span>&#160;                <span class="keywordflow">case</span> 5:   <span class="comment">// SPOT</span></div>
<div class="line"><a name="l14661"></a><span class="lineno">14661</span>&#160;                <span class="keywordflow">case</span> 4: { <span class="comment">// CMYK</span></div>
<div class="line"><a name="l14662"></a><span class="lineno">14662</span>&#160;                    $this-&gt;gradients[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;colors&#39;</span>][$key][<span class="stringliteral">&#39;color&#39;</span>] = sprintf(<span class="stringliteral">&#39;%F %F %F %F&#39;</span>, $color[0]/100, $color[1]/100, $color[2]/100, $color[3]/100);</div>
<div class="line"><a name="l14663"></a><span class="lineno">14663</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l14664"></a><span class="lineno">14664</span>&#160;                }</div>
<div class="line"><a name="l14665"></a><span class="lineno">14665</span>&#160;                <span class="keywordflow">case</span> 3: { <span class="comment">// RGB</span></div>
<div class="line"><a name="l14666"></a><span class="lineno">14666</span>&#160;                    $this-&gt;gradients[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;colors&#39;</span>][$key][<span class="stringliteral">&#39;color&#39;</span>] = sprintf(<span class="stringliteral">&#39;%F %F %F&#39;</span>, $color[0]/255, $color[1]/255, $color[2]/255);</div>
<div class="line"><a name="l14667"></a><span class="lineno">14667</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l14668"></a><span class="lineno">14668</span>&#160;                }</div>
<div class="line"><a name="l14669"></a><span class="lineno">14669</span>&#160;                <span class="keywordflow">case</span> 1: { <span class="comment">// GRAY SCALE</span></div>
<div class="line"><a name="l14670"></a><span class="lineno">14670</span>&#160;                    $this-&gt;gradients[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;colors&#39;</span>][$key][<span class="stringliteral">&#39;color&#39;</span>] = sprintf(<span class="stringliteral">&#39;%F&#39;</span>, $color[0]/255);</div>
<div class="line"><a name="l14671"></a><span class="lineno">14671</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l14672"></a><span class="lineno">14672</span>&#160;                }</div>
<div class="line"><a name="l14673"></a><span class="lineno">14673</span>&#160;            }</div>
<div class="line"><a name="l14674"></a><span class="lineno">14674</span>&#160;        }</div>
<div class="line"><a name="l14675"></a><span class="lineno">14675</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;gradients[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>][<span class="stringliteral">&#39;transparency&#39;</span>]) {</div>
<div class="line"><a name="l14676"></a><span class="lineno">14676</span>&#160;            <span class="comment">// paint luminosity gradient</span></div>
<div class="line"><a name="l14677"></a><span class="lineno">14677</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(<span class="stringliteral">&#39;/TGS&#39;</span>.$n.<span class="stringliteral">&#39; gs&#39;</span>);</div>
<div class="line"><a name="l14678"></a><span class="lineno">14678</span>&#160;        }</div>
<div class="line"><a name="l14679"></a><span class="lineno">14679</span>&#160;        <span class="comment">//paint the gradient</span></div>
<div class="line"><a name="l14680"></a><span class="lineno">14680</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(<span class="stringliteral">&#39;/Sh&#39;</span>.$n.<span class="stringliteral">&#39; sh&#39;</span>);</div>
<div class="line"><a name="l14681"></a><span class="lineno">14681</span>&#160;        <span class="comment">//restore previous Graphic State</span></div>
<div class="line"><a name="l14682"></a><span class="lineno">14682</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af623eface3ce63b2bc1709d47c84ab69">_outRestoreGraphicsState</a>();</div>
<div class="line"><a name="l14683"></a><span class="lineno">14683</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;inxobj) {</div>
<div class="line"><a name="l14684"></a><span class="lineno">14684</span>&#160;            <span class="comment">// we are inside an XObject template</span></div>
<div class="line"><a name="l14685"></a><span class="lineno">14685</span>&#160;            $this-&gt;xobjects[<a class="code" href="../../d4/d40/classTCPDF.html#abe4390b4e1939e10c9b61a986adfc117">$this-&gt;xobjid</a>][<span class="stringliteral">&#39;gradients&#39;</span>][<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>] = $this-&gt;gradients[<a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$n</a>];</div>
<div class="line"><a name="l14686"></a><span class="lineno">14686</span>&#160;        }</div>
<div class="line"><a name="l14687"></a><span class="lineno">14687</span>&#160;    }</div>
<div class="line"><a name="l14688"></a><span class="lineno">14688</span>&#160;</div>
<div class="line"><a name="l14695"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ac4f7fe7f2836e624fb0317f75a74236b">14695</a></span>&#160;    <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ac4f7fe7f2836e624fb0317f75a74236b">_putshaders</a>() {</div>
<div class="line"><a name="l14696"></a><span class="lineno">14696</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;pdfa_mode) {</div>
<div class="line"><a name="l14697"></a><span class="lineno">14697</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l14698"></a><span class="lineno">14698</span>&#160;        }</div>
<div class="line"><a name="l14699"></a><span class="lineno">14699</span>&#160;        $idt = count($this-&gt;gradients); <span class="comment">//index for transparency gradients</span></div>
<div class="line"><a name="l14700"></a><span class="lineno">14700</span>&#160;        <span class="keywordflow">foreach</span> ($this-&gt;gradients as $id =&gt; $grad) {</div>
<div class="line"><a name="l14701"></a><span class="lineno">14701</span>&#160;            <span class="keywordflow">if</span> (($grad[<span class="stringliteral">&#39;type&#39;</span>] == 2) OR ($grad[<span class="stringliteral">&#39;type&#39;</span>] == 3)) {</div>
<div class="line"><a name="l14702"></a><span class="lineno">14702</span>&#160;                $fc = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d">_newobj</a>();</div>
<div class="line"><a name="l14703"></a><span class="lineno">14703</span>&#160;                $out = <span class="stringliteral">&#39;&lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l14704"></a><span class="lineno">14704</span>&#160;                $out .= <span class="stringliteral">&#39; /FunctionType 3&#39;</span>;</div>
<div class="line"><a name="l14705"></a><span class="lineno">14705</span>&#160;                $out .= <span class="stringliteral">&#39; /Domain [0 1]&#39;</span>;</div>
<div class="line"><a name="l14706"></a><span class="lineno">14706</span>&#160;                $functions = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l14707"></a><span class="lineno">14707</span>&#160;                $bounds = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l14708"></a><span class="lineno">14708</span>&#160;                $encode = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l14709"></a><span class="lineno">14709</span>&#160;                $i = 1;</div>
<div class="line"><a name="l14710"></a><span class="lineno">14710</span>&#160;                $num_cols = count($grad[<span class="stringliteral">&#39;colors&#39;</span>]);</div>
<div class="line"><a name="l14711"></a><span class="lineno">14711</span>&#160;                $lastcols = $num_cols - 1;</div>
<div class="line"><a name="l14712"></a><span class="lineno">14712</span>&#160;                <span class="keywordflow">for</span> ($i = 1; $i &lt; $num_cols; ++$i) {</div>
<div class="line"><a name="l14713"></a><span class="lineno">14713</span>&#160;                    $functions .= ($fc + $i).<span class="stringliteral">&#39; 0 R &#39;</span>;</div>
<div class="line"><a name="l14714"></a><span class="lineno">14714</span>&#160;                    <span class="keywordflow">if</span> ($i &lt; $lastcols) {</div>
<div class="line"><a name="l14715"></a><span class="lineno">14715</span>&#160;                        $bounds .= sprintf(<span class="stringliteral">&#39;%F &#39;</span>, $grad[<span class="stringliteral">&#39;colors&#39;</span>][$i][<span class="stringliteral">&#39;offset&#39;</span>]);</div>
<div class="line"><a name="l14716"></a><span class="lineno">14716</span>&#160;                    }</div>
<div class="line"><a name="l14717"></a><span class="lineno">14717</span>&#160;                    $encode .= <span class="stringliteral">&#39;0 1 &#39;</span>;</div>
<div class="line"><a name="l14718"></a><span class="lineno">14718</span>&#160;                }</div>
<div class="line"><a name="l14719"></a><span class="lineno">14719</span>&#160;                $out .= <span class="stringliteral">&#39; /Functions [&#39;</span>.trim($functions).<span class="charliteral">&#39;]&#39;</span>;</div>
<div class="line"><a name="l14720"></a><span class="lineno">14720</span>&#160;                $out .= <span class="stringliteral">&#39; /Bounds [&#39;</span>.trim($bounds).<span class="charliteral">&#39;]&#39;</span>;</div>
<div class="line"><a name="l14721"></a><span class="lineno">14721</span>&#160;                $out .= <span class="stringliteral">&#39; /Encode [&#39;</span>.trim($encode).<span class="charliteral">&#39;]&#39;</span>;</div>
<div class="line"><a name="l14722"></a><span class="lineno">14722</span>&#160;                $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l14723"></a><span class="lineno">14723</span>&#160;                $out .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l14724"></a><span class="lineno">14724</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($out);</div>
<div class="line"><a name="l14725"></a><span class="lineno">14725</span>&#160;                <span class="keywordflow">for</span> ($i = 1; $i &lt; $num_cols; ++$i) {</div>
<div class="line"><a name="l14726"></a><span class="lineno">14726</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d">_newobj</a>();</div>
<div class="line"><a name="l14727"></a><span class="lineno">14727</span>&#160;                    $out = <span class="stringliteral">&#39;&lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l14728"></a><span class="lineno">14728</span>&#160;                    $out .= <span class="stringliteral">&#39; /FunctionType 2&#39;</span>;</div>
<div class="line"><a name="l14729"></a><span class="lineno">14729</span>&#160;                    $out .= <span class="stringliteral">&#39; /Domain [0 1]&#39;</span>;</div>
<div class="line"><a name="l14730"></a><span class="lineno">14730</span>&#160;                    $out .= <span class="stringliteral">&#39; /C0 [&#39;</span>.$grad[<span class="stringliteral">&#39;colors&#39;</span>][($i - 1)][<span class="stringliteral">&#39;color&#39;</span>].<span class="charliteral">&#39;]&#39;</span>;</div>
<div class="line"><a name="l14731"></a><span class="lineno">14731</span>&#160;                    $out .= <span class="stringliteral">&#39; /C1 [&#39;</span>.$grad[<span class="stringliteral">&#39;colors&#39;</span>][$i][<span class="stringliteral">&#39;color&#39;</span>].<span class="charliteral">&#39;]&#39;</span>;</div>
<div class="line"><a name="l14732"></a><span class="lineno">14732</span>&#160;                    $out .= <span class="stringliteral">&#39; /N &#39;</span>.$grad[<span class="stringliteral">&#39;colors&#39;</span>][$i][<span class="stringliteral">&#39;exponent&#39;</span>];</div>
<div class="line"><a name="l14733"></a><span class="lineno">14733</span>&#160;                    $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l14734"></a><span class="lineno">14734</span>&#160;                    $out .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l14735"></a><span class="lineno">14735</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($out);</div>
<div class="line"><a name="l14736"></a><span class="lineno">14736</span>&#160;                }</div>
<div class="line"><a name="l14737"></a><span class="lineno">14737</span>&#160;                <span class="comment">// set transparency fuctions</span></div>
<div class="line"><a name="l14738"></a><span class="lineno">14738</span>&#160;                <span class="keywordflow">if</span> ($grad[<span class="stringliteral">&#39;transparency&#39;</span>]) {</div>
<div class="line"><a name="l14739"></a><span class="lineno">14739</span>&#160;                    $ft = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d">_newobj</a>();</div>
<div class="line"><a name="l14740"></a><span class="lineno">14740</span>&#160;                    $out = <span class="stringliteral">&#39;&lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l14741"></a><span class="lineno">14741</span>&#160;                    $out .= <span class="stringliteral">&#39; /FunctionType 3&#39;</span>;</div>
<div class="line"><a name="l14742"></a><span class="lineno">14742</span>&#160;                    $out .= <span class="stringliteral">&#39; /Domain [0 1]&#39;</span>;</div>
<div class="line"><a name="l14743"></a><span class="lineno">14743</span>&#160;                    $functions = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l14744"></a><span class="lineno">14744</span>&#160;                    $i = 1;</div>
<div class="line"><a name="l14745"></a><span class="lineno">14745</span>&#160;                    $num_cols = count($grad[<span class="stringliteral">&#39;colors&#39;</span>]);</div>
<div class="line"><a name="l14746"></a><span class="lineno">14746</span>&#160;                    <span class="keywordflow">for</span> ($i = 1; $i &lt; $num_cols; ++$i) {</div>
<div class="line"><a name="l14747"></a><span class="lineno">14747</span>&#160;                        $functions .= ($ft + $i).<span class="stringliteral">&#39; 0 R &#39;</span>;</div>
<div class="line"><a name="l14748"></a><span class="lineno">14748</span>&#160;                    }</div>
<div class="line"><a name="l14749"></a><span class="lineno">14749</span>&#160;                    $out .= <span class="stringliteral">&#39; /Functions [&#39;</span>.trim($functions).<span class="charliteral">&#39;]&#39;</span>;</div>
<div class="line"><a name="l14750"></a><span class="lineno">14750</span>&#160;                    $out .= <span class="stringliteral">&#39; /Bounds [&#39;</span>.trim($bounds).<span class="charliteral">&#39;]&#39;</span>;</div>
<div class="line"><a name="l14751"></a><span class="lineno">14751</span>&#160;                    $out .= <span class="stringliteral">&#39; /Encode [&#39;</span>.trim($encode).<span class="charliteral">&#39;]&#39;</span>;</div>
<div class="line"><a name="l14752"></a><span class="lineno">14752</span>&#160;                    $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l14753"></a><span class="lineno">14753</span>&#160;                    $out .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l14754"></a><span class="lineno">14754</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($out);</div>
<div class="line"><a name="l14755"></a><span class="lineno">14755</span>&#160;                    <span class="keywordflow">for</span> ($i = 1; $i &lt; $num_cols; ++$i) {</div>
<div class="line"><a name="l14756"></a><span class="lineno">14756</span>&#160;                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d">_newobj</a>();</div>
<div class="line"><a name="l14757"></a><span class="lineno">14757</span>&#160;                        $out = <span class="stringliteral">&#39;&lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l14758"></a><span class="lineno">14758</span>&#160;                        $out .= <span class="stringliteral">&#39; /FunctionType 2&#39;</span>;</div>
<div class="line"><a name="l14759"></a><span class="lineno">14759</span>&#160;                        $out .= <span class="stringliteral">&#39; /Domain [0 1]&#39;</span>;</div>
<div class="line"><a name="l14760"></a><span class="lineno">14760</span>&#160;                        $out .= <span class="stringliteral">&#39; /C0 [&#39;</span>.$grad[<span class="stringliteral">&#39;colors&#39;</span>][($i - 1)][<span class="stringliteral">&#39;opacity&#39;</span>].<span class="charliteral">&#39;]&#39;</span>;</div>
<div class="line"><a name="l14761"></a><span class="lineno">14761</span>&#160;                        $out .= <span class="stringliteral">&#39; /C1 [&#39;</span>.$grad[<span class="stringliteral">&#39;colors&#39;</span>][$i][<span class="stringliteral">&#39;opacity&#39;</span>].<span class="charliteral">&#39;]&#39;</span>;</div>
<div class="line"><a name="l14762"></a><span class="lineno">14762</span>&#160;                        $out .= <span class="stringliteral">&#39; /N &#39;</span>.$grad[<span class="stringliteral">&#39;colors&#39;</span>][$i][<span class="stringliteral">&#39;exponent&#39;</span>];</div>
<div class="line"><a name="l14763"></a><span class="lineno">14763</span>&#160;                        $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l14764"></a><span class="lineno">14764</span>&#160;                        $out .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l14765"></a><span class="lineno">14765</span>&#160;                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($out);</div>
<div class="line"><a name="l14766"></a><span class="lineno">14766</span>&#160;                    }</div>
<div class="line"><a name="l14767"></a><span class="lineno">14767</span>&#160;                }</div>
<div class="line"><a name="l14768"></a><span class="lineno">14768</span>&#160;            }</div>
<div class="line"><a name="l14769"></a><span class="lineno">14769</span>&#160;            <span class="comment">// set shading object</span></div>
<div class="line"><a name="l14770"></a><span class="lineno">14770</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d">_newobj</a>();</div>
<div class="line"><a name="l14771"></a><span class="lineno">14771</span>&#160;            $out = <span class="stringliteral">&#39;&lt;&lt; /ShadingType &#39;</span>.$grad[<span class="stringliteral">&#39;type&#39;</span>];</div>
<div class="line"><a name="l14772"></a><span class="lineno">14772</span>&#160;            <span class="keywordflow">if</span> (isset($grad[<span class="stringliteral">&#39;colspace&#39;</span>])) {</div>
<div class="line"><a name="l14773"></a><span class="lineno">14773</span>&#160;                $out .= <span class="stringliteral">&#39; /ColorSpace /&#39;</span>.$grad[<span class="stringliteral">&#39;colspace&#39;</span>];</div>
<div class="line"><a name="l14774"></a><span class="lineno">14774</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l14775"></a><span class="lineno">14775</span>&#160;                $out .= <span class="stringliteral">&#39; /ColorSpace /DeviceRGB&#39;</span>;</div>
<div class="line"><a name="l14776"></a><span class="lineno">14776</span>&#160;            }</div>
<div class="line"><a name="l14777"></a><span class="lineno">14777</span>&#160;            <span class="keywordflow">if</span> (isset($grad[<span class="stringliteral">&#39;background&#39;</span>]) AND !empty($grad[<span class="stringliteral">&#39;background&#39;</span>])) {</div>
<div class="line"><a name="l14778"></a><span class="lineno">14778</span>&#160;                $out .= <span class="stringliteral">&#39; /Background [&#39;</span>.$grad[<span class="stringliteral">&#39;background&#39;</span>].<span class="charliteral">&#39;]&#39;</span>;</div>
<div class="line"><a name="l14779"></a><span class="lineno">14779</span>&#160;            }</div>
<div class="line"><a name="l14780"></a><span class="lineno">14780</span>&#160;            <span class="keywordflow">if</span> (isset($grad[<span class="stringliteral">&#39;antialias&#39;</span>]) AND ($grad[<span class="stringliteral">&#39;antialias&#39;</span>] === <span class="keyword">true</span>)) {</div>
<div class="line"><a name="l14781"></a><span class="lineno">14781</span>&#160;                $out .= <span class="stringliteral">&#39; /AntiAlias true&#39;</span>;</div>
<div class="line"><a name="l14782"></a><span class="lineno">14782</span>&#160;            }</div>
<div class="line"><a name="l14783"></a><span class="lineno">14783</span>&#160;            <span class="keywordflow">if</span> ($grad[<span class="stringliteral">&#39;type&#39;</span>] == 2) {</div>
<div class="line"><a name="l14784"></a><span class="lineno">14784</span>&#160;                $out .= <span class="charliteral">&#39; &#39;</span>.sprintf(<span class="stringliteral">&#39;/Coords [%F %F %F %F]&#39;</span>, $grad[<span class="stringliteral">&#39;coords&#39;</span>][0], $grad[<span class="stringliteral">&#39;coords&#39;</span>][1], $grad[<span class="stringliteral">&#39;coords&#39;</span>][2], $grad[<span class="stringliteral">&#39;coords&#39;</span>][3]);</div>
<div class="line"><a name="l14785"></a><span class="lineno">14785</span>&#160;                $out .= <span class="stringliteral">&#39; /Domain [0 1]&#39;</span>;</div>
<div class="line"><a name="l14786"></a><span class="lineno">14786</span>&#160;                $out .= <span class="stringliteral">&#39; /Function &#39;</span>.$fc.<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l14787"></a><span class="lineno">14787</span>&#160;                $out .= <span class="stringliteral">&#39; /Extend [true true]&#39;</span>;</div>
<div class="line"><a name="l14788"></a><span class="lineno">14788</span>&#160;                $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l14789"></a><span class="lineno">14789</span>&#160;            } elseif ($grad[<span class="stringliteral">&#39;type&#39;</span>] == 3) {</div>
<div class="line"><a name="l14790"></a><span class="lineno">14790</span>&#160;                <span class="comment">//x0, y0, r0, x1, y1, r1</span></div>
<div class="line"><a name="l14791"></a><span class="lineno">14791</span>&#160;                <span class="comment">//at this this time radius of inner circle is 0</span></div>
<div class="line"><a name="l14792"></a><span class="lineno">14792</span>&#160;                $out .= <span class="charliteral">&#39; &#39;</span>.sprintf(<span class="stringliteral">&#39;/Coords [%F %F 0 %F %F %F]&#39;</span>, $grad[<span class="stringliteral">&#39;coords&#39;</span>][0], $grad[<span class="stringliteral">&#39;coords&#39;</span>][1], $grad[<span class="stringliteral">&#39;coords&#39;</span>][2], $grad[<span class="stringliteral">&#39;coords&#39;</span>][3], $grad[<span class="stringliteral">&#39;coords&#39;</span>][4]);</div>
<div class="line"><a name="l14793"></a><span class="lineno">14793</span>&#160;                $out .= <span class="stringliteral">&#39; /Domain [0 1]&#39;</span>;</div>
<div class="line"><a name="l14794"></a><span class="lineno">14794</span>&#160;                $out .= <span class="stringliteral">&#39; /Function &#39;</span>.$fc.<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l14795"></a><span class="lineno">14795</span>&#160;                $out .= <span class="stringliteral">&#39; /Extend [true true]&#39;</span>;</div>
<div class="line"><a name="l14796"></a><span class="lineno">14796</span>&#160;                $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l14797"></a><span class="lineno">14797</span>&#160;            } elseif ($grad[<span class="stringliteral">&#39;type&#39;</span>] == 6) {</div>
<div class="line"><a name="l14798"></a><span class="lineno">14798</span>&#160;                $out .= <span class="stringliteral">&#39; /BitsPerCoordinate 16&#39;</span>;</div>
<div class="line"><a name="l14799"></a><span class="lineno">14799</span>&#160;                $out .= <span class="stringliteral">&#39; /BitsPerComponent 8&#39;</span>;</div>
<div class="line"><a name="l14800"></a><span class="lineno">14800</span>&#160;                $out .= <span class="stringliteral">&#39; /Decode[0 1 0 1 0 1 0 1 0 1]&#39;</span>;</div>
<div class="line"><a name="l14801"></a><span class="lineno">14801</span>&#160;                $out .= <span class="stringliteral">&#39; /BitsPerFlag 8&#39;</span>;</div>
<div class="line"><a name="l14802"></a><span class="lineno">14802</span>&#160;                $stream = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a7c7c1beebd83fa777197a842f2ca73eb">_getrawstream</a>($grad[<span class="stringliteral">&#39;stream&#39;</span>]);</div>
<div class="line"><a name="l14803"></a><span class="lineno">14803</span>&#160;                $out .= <span class="stringliteral">&#39; /Length &#39;</span>.strlen($stream);</div>
<div class="line"><a name="l14804"></a><span class="lineno">14804</span>&#160;                $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l14805"></a><span class="lineno">14805</span>&#160;                $out .= <span class="stringliteral">&#39; stream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.$stream.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endstream&#39;</span>;</div>
<div class="line"><a name="l14806"></a><span class="lineno">14806</span>&#160;            }</div>
<div class="line"><a name="l14807"></a><span class="lineno">14807</span>&#160;            $out .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l14808"></a><span class="lineno">14808</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($out);</div>
<div class="line"><a name="l14809"></a><span class="lineno">14809</span>&#160;            <span class="keywordflow">if</span> ($grad[<span class="stringliteral">&#39;transparency&#39;</span>]) {</div>
<div class="line"><a name="l14810"></a><span class="lineno">14810</span>&#160;                $shading_transparency = preg_replace(<span class="stringliteral">&#39;/\/ColorSpace \/[^\s]+/si&#39;</span>, <span class="stringliteral">&#39;/ColorSpace /DeviceGray&#39;</span>, $out);</div>
<div class="line"><a name="l14811"></a><span class="lineno">14811</span>&#160;                $shading_transparency = preg_replace(<span class="stringliteral">&#39;/\/Function [0-9]+ /si&#39;</span>, <span class="stringliteral">&#39;/Function &#39;</span>.$ft.<span class="charliteral">&#39; &#39;</span>, $shading_transparency);</div>
<div class="line"><a name="l14812"></a><span class="lineno">14812</span>&#160;            }</div>
<div class="line"><a name="l14813"></a><span class="lineno">14813</span>&#160;            $this-&gt;gradients[$id][<span class="stringliteral">&#39;id&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$this-&gt;n</a>;</div>
<div class="line"><a name="l14814"></a><span class="lineno">14814</span>&#160;            <span class="comment">// set pattern object</span></div>
<div class="line"><a name="l14815"></a><span class="lineno">14815</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d">_newobj</a>();</div>
<div class="line"><a name="l14816"></a><span class="lineno">14816</span>&#160;            $out = <span class="stringliteral">&#39;&lt;&lt; /Type /Pattern /PatternType 2&#39;</span>;</div>
<div class="line"><a name="l14817"></a><span class="lineno">14817</span>&#160;            $out .= <span class="stringliteral">&#39; /Shading &#39;</span>.$this-&gt;gradients[$id][<span class="stringliteral">&#39;id&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l14818"></a><span class="lineno">14818</span>&#160;            $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l14819"></a><span class="lineno">14819</span>&#160;            $out .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l14820"></a><span class="lineno">14820</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($out);</div>
<div class="line"><a name="l14821"></a><span class="lineno">14821</span>&#160;            $this-&gt;gradients[$id][<span class="stringliteral">&#39;pattern&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$this-&gt;n</a>;</div>
<div class="line"><a name="l14822"></a><span class="lineno">14822</span>&#160;            <span class="comment">// set shading and pattern for transparency mask</span></div>
<div class="line"><a name="l14823"></a><span class="lineno">14823</span>&#160;            <span class="keywordflow">if</span> ($grad[<span class="stringliteral">&#39;transparency&#39;</span>]) {</div>
<div class="line"><a name="l14824"></a><span class="lineno">14824</span>&#160;                <span class="comment">// luminosity pattern</span></div>
<div class="line"><a name="l14825"></a><span class="lineno">14825</span>&#160;                $idgs = $id + $idt;</div>
<div class="line"><a name="l14826"></a><span class="lineno">14826</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d">_newobj</a>();</div>
<div class="line"><a name="l14827"></a><span class="lineno">14827</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($shading_transparency);</div>
<div class="line"><a name="l14828"></a><span class="lineno">14828</span>&#160;                $this-&gt;gradients[$idgs][<span class="stringliteral">&#39;id&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$this-&gt;n</a>;</div>
<div class="line"><a name="l14829"></a><span class="lineno">14829</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d">_newobj</a>();</div>
<div class="line"><a name="l14830"></a><span class="lineno">14830</span>&#160;                $out = <span class="stringliteral">&#39;&lt;&lt; /Type /Pattern /PatternType 2&#39;</span>;</div>
<div class="line"><a name="l14831"></a><span class="lineno">14831</span>&#160;                $out .= <span class="stringliteral">&#39; /Shading &#39;</span>.$this-&gt;gradients[$idgs][<span class="stringliteral">&#39;id&#39;</span>].<span class="stringliteral">&#39; 0 R&#39;</span>;</div>
<div class="line"><a name="l14832"></a><span class="lineno">14832</span>&#160;                $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l14833"></a><span class="lineno">14833</span>&#160;                $out .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l14834"></a><span class="lineno">14834</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($out);</div>
<div class="line"><a name="l14835"></a><span class="lineno">14835</span>&#160;                $this-&gt;gradients[$idgs][<span class="stringliteral">&#39;pattern&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">$this-&gt;n</a>;</div>
<div class="line"><a name="l14836"></a><span class="lineno">14836</span>&#160;                <span class="comment">// luminosity XObject</span></div>
<div class="line"><a name="l14837"></a><span class="lineno">14837</span>&#160;                $oid = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d">_newobj</a>();</div>
<div class="line"><a name="l14838"></a><span class="lineno">14838</span>&#160;                $this-&gt;xobjects[<span class="stringliteral">&#39;LX&#39;</span>.$oid] = array(<span class="charliteral">&#39;n&#39;</span> =&gt; $oid);</div>
<div class="line"><a name="l14839"></a><span class="lineno">14839</span>&#160;                $filter = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l14840"></a><span class="lineno">14840</span>&#160;                $stream = <span class="stringliteral">&#39;q /a0 gs /Pattern cs /p&#39;</span>.$idgs.<span class="stringliteral">&#39; scn 0 0 &#39;</span>.$this-&gt;wPt.<span class="charliteral">&#39; &#39;</span>.$this-&gt;hPt.<span class="stringliteral">&#39; re f Q&#39;</span>;</div>
<div class="line"><a name="l14841"></a><span class="lineno">14841</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;compress) {</div>
<div class="line"><a name="l14842"></a><span class="lineno">14842</span>&#160;                    $filter = <span class="stringliteral">&#39; /Filter /FlateDecode&#39;</span>;</div>
<div class="line"><a name="l14843"></a><span class="lineno">14843</span>&#160;                    $stream = gzcompress($stream);</div>
<div class="line"><a name="l14844"></a><span class="lineno">14844</span>&#160;                }</div>
<div class="line"><a name="l14845"></a><span class="lineno">14845</span>&#160;                $stream = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a7c7c1beebd83fa777197a842f2ca73eb">_getrawstream</a>($stream);</div>
<div class="line"><a name="l14846"></a><span class="lineno">14846</span>&#160;                $out = <span class="stringliteral">&#39;&lt;&lt; /Type /XObject /Subtype /Form /FormType 1&#39;</span>.$filter;</div>
<div class="line"><a name="l14847"></a><span class="lineno">14847</span>&#160;                $out .= <span class="stringliteral">&#39; /Length &#39;</span>.strlen($stream);</div>
<div class="line"><a name="l14848"></a><span class="lineno">14848</span>&#160;                $rect = sprintf(<span class="stringliteral">&#39;%F %F&#39;</span>, $this-&gt;wPt, $this-&gt;hPt);</div>
<div class="line"><a name="l14849"></a><span class="lineno">14849</span>&#160;                $out .= <span class="stringliteral">&#39; /BBox [0 0 &#39;</span>.$rect.<span class="charliteral">&#39;]&#39;</span>;</div>
<div class="line"><a name="l14850"></a><span class="lineno">14850</span>&#160;                $out .= <span class="stringliteral">&#39; /Group &lt;&lt; /Type /Group /S /Transparency /CS /DeviceGray &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l14851"></a><span class="lineno">14851</span>&#160;                $out .= <span class="stringliteral">&#39; /Resources &lt;&lt;&#39;</span>;</div>
<div class="line"><a name="l14852"></a><span class="lineno">14852</span>&#160;                $out .= <span class="stringliteral">&#39; /ExtGState &lt;&lt; /a0 &lt;&lt; /ca 1 /CA 1 &gt;&gt; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l14853"></a><span class="lineno">14853</span>&#160;                $out .= <span class="stringliteral">&#39; /Pattern &lt;&lt; /p&#39;</span>.$idgs.<span class="charliteral">&#39; &#39;</span>.$this-&gt;gradients[$idgs][<span class="stringliteral">&#39;pattern&#39;</span>].<span class="stringliteral">&#39; 0 R &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l14854"></a><span class="lineno">14854</span>&#160;                $out .= <span class="stringliteral">&#39; &gt;&gt;&#39;</span>;</div>
<div class="line"><a name="l14855"></a><span class="lineno">14855</span>&#160;                $out .= <span class="stringliteral">&#39; &gt;&gt; &#39;</span>;</div>
<div class="line"><a name="l14856"></a><span class="lineno">14856</span>&#160;                $out .= <span class="stringliteral">&#39; stream&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.$stream.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endstream&#39;</span>;</div>
<div class="line"><a name="l14857"></a><span class="lineno">14857</span>&#160;                $out .= <span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l14858"></a><span class="lineno">14858</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($out);</div>
<div class="line"><a name="l14859"></a><span class="lineno">14859</span>&#160;                <span class="comment">// SMask</span></div>
<div class="line"><a name="l14860"></a><span class="lineno">14860</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d">_newobj</a>();</div>
<div class="line"><a name="l14861"></a><span class="lineno">14861</span>&#160;                $out = <span class="stringliteral">&#39;&lt;&lt; /Type /Mask /S /Luminosity /G &#39;</span>.($this-&gt;n - 1).<span class="stringliteral">&#39; 0 R &gt;&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l14862"></a><span class="lineno">14862</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($out);</div>
<div class="line"><a name="l14863"></a><span class="lineno">14863</span>&#160;                <span class="comment">// ExtGState</span></div>
<div class="line"><a name="l14864"></a><span class="lineno">14864</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d">_newobj</a>();</div>
<div class="line"><a name="l14865"></a><span class="lineno">14865</span>&#160;                $out = <span class="stringliteral">&#39;&lt;&lt; /Type /ExtGState /SMask &#39;</span>.($this-&gt;n - 1).<span class="stringliteral">&#39; 0 R /AIS false &gt;&gt;&#39;</span>.<span class="stringliteral">&quot;\n&quot;</span>.<span class="stringliteral">&#39;endobj&#39;</span>;</div>
<div class="line"><a name="l14866"></a><span class="lineno">14866</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($out);</div>
<div class="line"><a name="l14867"></a><span class="lineno">14867</span>&#160;                $this-&gt;extgstates[] = array(<span class="charliteral">&#39;n&#39;</span> =&gt; $this-&gt;n, <span class="stringliteral">&#39;name&#39;</span> =&gt; <span class="stringliteral">&#39;TGS&#39;</span>.$id);</div>
<div class="line"><a name="l14868"></a><span class="lineno">14868</span>&#160;            }</div>
<div class="line"><a name="l14869"></a><span class="lineno">14869</span>&#160;        }</div>
<div class="line"><a name="l14870"></a><span class="lineno">14870</span>&#160;    }</div>
<div class="line"><a name="l14871"></a><span class="lineno">14871</span>&#160;</div>
<div class="line"><a name="l14887"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ac138de610bac7bee8885178db32dcea0">14887</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ac138de610bac7bee8885178db32dcea0">PieSector</a>($xc, $yc, $r, $a, $b, $style=<span class="stringliteral">&#39;FD&#39;</span>, $cw=<span class="keyword">true</span>, $o=90) {</div>
<div class="line"><a name="l14888"></a><span class="lineno">14888</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a26e2c92f3d3177b8f5508f4724f516a8">PieSectorXY</a>($xc, $yc, $r, $r, $a, $b, $style, $cw, $o);</div>
<div class="line"><a name="l14889"></a><span class="lineno">14889</span>&#160;    }</div>
<div class="line"><a name="l14890"></a><span class="lineno">14890</span>&#160;</div>
<div class="line"><a name="l14908"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a26e2c92f3d3177b8f5508f4724f516a8">14908</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a26e2c92f3d3177b8f5508f4724f516a8">PieSectorXY</a>($xc, $yc, $rx, $ry, $a, $b, $style=<span class="stringliteral">&#39;FD&#39;</span>, $cw=<span class="keyword">false</span>, $o=0, $nc=2) {</div>
<div class="line"><a name="l14909"></a><span class="lineno">14909</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;state != 2) {</div>
<div class="line"><a name="l14910"></a><span class="lineno">14910</span>&#160;             <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l14911"></a><span class="lineno">14911</span>&#160;        }</div>
<div class="line"><a name="l14912"></a><span class="lineno">14912</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l14913"></a><span class="lineno">14913</span>&#160;            $xc = ($this-&gt;w - $xc);</div>
<div class="line"><a name="l14914"></a><span class="lineno">14914</span>&#160;        }</div>
<div class="line"><a name="l14915"></a><span class="lineno">14915</span>&#160;        $op = TCPDF_STATIC::getPathPaintOperator($style);</div>
<div class="line"><a name="l14916"></a><span class="lineno">14916</span>&#160;        <span class="keywordflow">if</span> ($op == <span class="charliteral">&#39;f&#39;</span>) {</div>
<div class="line"><a name="l14917"></a><span class="lineno">14917</span>&#160;            $line_style = array();</div>
<div class="line"><a name="l14918"></a><span class="lineno">14918</span>&#160;        }</div>
<div class="line"><a name="l14919"></a><span class="lineno">14919</span>&#160;        <span class="keywordflow">if</span> ($cw) {</div>
<div class="line"><a name="l14920"></a><span class="lineno">14920</span>&#160;            $d = $b;</div>
<div class="line"><a name="l14921"></a><span class="lineno">14921</span>&#160;            $b = (360 - $a + $o);</div>
<div class="line"><a name="l14922"></a><span class="lineno">14922</span>&#160;            $a = (360 - $d + $o);</div>
<div class="line"><a name="l14923"></a><span class="lineno">14923</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l14924"></a><span class="lineno">14924</span>&#160;            $b += $o;</div>
<div class="line"><a name="l14925"></a><span class="lineno">14925</span>&#160;            $a += $o;</div>
<div class="line"><a name="l14926"></a><span class="lineno">14926</span>&#160;        }</div>
<div class="line"><a name="l14927"></a><span class="lineno">14927</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa36b100b48a17cd6c35de87431a3d54c">_outellipticalarc</a>($xc, $yc, $rx, $ry, 0, $a, $b, <span class="keyword">true</span>, $nc);</div>
<div class="line"><a name="l14928"></a><span class="lineno">14928</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($op);</div>
<div class="line"><a name="l14929"></a><span class="lineno">14929</span>&#160;    }</div>
<div class="line"><a name="l14930"></a><span class="lineno">14930</span>&#160;</div>
<div class="line"><a name="l14952"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ace0583441eed657b827420fcfb37a3bd">14952</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ace0583441eed657b827420fcfb37a3bd">ImageEps</a>($file, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>=0, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>=0, $link=<span class="stringliteral">&#39;&#39;</span>, $useBoundingBox=<span class="keyword">true</span>, $align=<span class="stringliteral">&#39;&#39;</span>, $palign=<span class="stringliteral">&#39;&#39;</span>, $border=0, $fitonpage=<span class="keyword">false</span>, $fixoutvals=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l14953"></a><span class="lineno">14953</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;state != 2) {</div>
<div class="line"><a name="l14954"></a><span class="lineno">14954</span>&#160;             <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l14955"></a><span class="lineno">14955</span>&#160;        }</div>
<div class="line"><a name="l14956"></a><span class="lineno">14956</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;rasterize_vector_images AND (<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> &gt; 0) AND (<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> &gt; 0)) {</div>
<div class="line"><a name="l14957"></a><span class="lineno">14957</span>&#160;            <span class="comment">// convert EPS to raster image using GD or ImageMagick libraries</span></div>
<div class="line"><a name="l14958"></a><span class="lineno">14958</span>&#160;            <span class="keywordflow">return</span> $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a714c2bee7d6b39d4d6d304540c761352">Image</a>($file, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, <span class="stringliteral">&#39;EPS&#39;</span>, $link, $align, <span class="keyword">true</span>, 300, $palign, <span class="keyword">false</span>, <span class="keyword">false</span>, $border, <span class="keyword">false</span>, <span class="keyword">false</span>, $fitonpage);</div>
<div class="line"><a name="l14959"></a><span class="lineno">14959</span>&#160;        }</div>
<div class="line"><a name="l14960"></a><span class="lineno">14960</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> === <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l14961"></a><span class="lineno">14961</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$this-&gt;x</a>;</div>
<div class="line"><a name="l14962"></a><span class="lineno">14962</span>&#160;        }</div>
<div class="line"><a name="l14963"></a><span class="lineno">14963</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> === <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l14964"></a><span class="lineno">14964</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l14965"></a><span class="lineno">14965</span>&#160;        }</div>
<div class="line"><a name="l14966"></a><span class="lineno">14966</span>&#160;        <span class="comment">// check page for no-write regions and adapt page margins if necessary</span></div>
<div class="line"><a name="l14967"></a><span class="lineno">14967</span>&#160;        list(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>) = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1d99e81697a90efb13a6734001427f40">checkPageRegions</a>(<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>);</div>
<div class="line"><a name="l14968"></a><span class="lineno">14968</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a> = <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>;</div>
<div class="line"><a name="l14969"></a><span class="lineno">14969</span>&#160;        <span class="keywordflow">if</span> ($file[0] === <span class="charliteral">&#39;@&#39;</span>) { <span class="comment">// image from string</span></div>
<div class="line"><a name="l14970"></a><span class="lineno">14970</span>&#160;            $data = substr($file, 1);</div>
<div class="line"><a name="l14971"></a><span class="lineno">14971</span>&#160;        } <span class="keywordflow">else</span> { <span class="comment">// EPS/AI file</span></div>
<div class="line"><a name="l14972"></a><span class="lineno">14972</span>&#160;            $data = TCPDF_STATIC::fileGetContents($file);</div>
<div class="line"><a name="l14973"></a><span class="lineno">14973</span>&#160;        }</div>
<div class="line"><a name="l14974"></a><span class="lineno">14974</span>&#160;        <span class="keywordflow">if</span> ($data === FALSE) {</div>
<div class="line"><a name="l14975"></a><span class="lineno">14975</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;EPS file not found: &#39;</span>.$file);</div>
<div class="line"><a name="l14976"></a><span class="lineno">14976</span>&#160;        }</div>
<div class="line"><a name="l14977"></a><span class="lineno">14977</span>&#160;        $regs = array();</div>
<div class="line"><a name="l14978"></a><span class="lineno">14978</span>&#160;        <span class="comment">// EPS/AI compatibility check (only checks files created by Adobe Illustrator!)</span></div>
<div class="line"><a name="l14979"></a><span class="lineno">14979</span>&#160;        preg_match(<span class="stringliteral">&quot;/%%Creator:([^\r\n]+)/&quot;</span>, $data, $regs); # find Creator</div>
<div class="line"><a name="l14980"></a><span class="lineno">14980</span>&#160;        <span class="keywordflow">if</span> (count($regs) &gt; 1) {</div>
<div class="line"><a name="l14981"></a><span class="lineno">14981</span>&#160;            $version_str = trim($regs[1]); # e.g. <span class="stringliteral">&quot;Adobe Illustrator(R) 8.0&quot;</span></div>
<div class="line"><a name="l14982"></a><span class="lineno">14982</span>&#160;            <span class="keywordflow">if</span> (strpos($version_str, <span class="stringliteral">&#39;Adobe Illustrator&#39;</span>) !== <span class="keyword">false</span>) {</div>
<div class="line"><a name="l14983"></a><span class="lineno">14983</span>&#160;                $versexp = explode(<span class="charliteral">&#39; &#39;</span>, $version_str);</div>
<div class="line"><a name="l14984"></a><span class="lineno">14984</span>&#160;                $version = (float)array_pop($versexp);</div>
<div class="line"><a name="l14985"></a><span class="lineno">14985</span>&#160;                <span class="keywordflow">if</span> ($version &gt;= 9) {</div>
<div class="line"><a name="l14986"></a><span class="lineno">14986</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;This version of Adobe Illustrator file is not supported: &#39;</span>.$file);</div>
<div class="line"><a name="l14987"></a><span class="lineno">14987</span>&#160;                }</div>
<div class="line"><a name="l14988"></a><span class="lineno">14988</span>&#160;            }</div>
<div class="line"><a name="l14989"></a><span class="lineno">14989</span>&#160;        }</div>
<div class="line"><a name="l14990"></a><span class="lineno">14990</span>&#160;        <span class="comment">// strip binary bytes in front of PS-header</span></div>
<div class="line"><a name="l14991"></a><span class="lineno">14991</span>&#160;        $start = strpos($data, <span class="stringliteral">&#39;%!PS-Adobe&#39;</span>);</div>
<div class="line"><a name="l14992"></a><span class="lineno">14992</span>&#160;        <span class="keywordflow">if</span> ($start &gt; 0) {</div>
<div class="line"><a name="l14993"></a><span class="lineno">14993</span>&#160;            $data = substr($data, $start);</div>
<div class="line"><a name="l14994"></a><span class="lineno">14994</span>&#160;        }</div>
<div class="line"><a name="l14995"></a><span class="lineno">14995</span>&#160;        <span class="comment">// find BoundingBox params</span></div>
<div class="line"><a name="l14996"></a><span class="lineno">14996</span>&#160;        preg_match(<span class="stringliteral">&quot;/%%BoundingBox:([^\r\n]+)/&quot;</span>, $data, $regs);</div>
<div class="line"><a name="l14997"></a><span class="lineno">14997</span>&#160;        <span class="keywordflow">if</span> (count($regs) &gt; 1) {</div>
<div class="line"><a name="l14998"></a><span class="lineno">14998</span>&#160;            list($x1, $y1, $x2, $y2) = explode(<span class="charliteral">&#39; &#39;</span>, trim($regs[1]));</div>
<div class="line"><a name="l14999"></a><span class="lineno">14999</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l15000"></a><span class="lineno">15000</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;No BoundingBox found in EPS/AI file: &#39;</span>.$file);</div>
<div class="line"><a name="l15001"></a><span class="lineno">15001</span>&#160;        }</div>
<div class="line"><a name="l15002"></a><span class="lineno">15002</span>&#160;        $start = strpos($data, <span class="stringliteral">&#39;%%EndSetup&#39;</span>);</div>
<div class="line"><a name="l15003"></a><span class="lineno">15003</span>&#160;        <span class="keywordflow">if</span> ($start === <span class="keyword">false</span>) {</div>
<div class="line"><a name="l15004"></a><span class="lineno">15004</span>&#160;            $start = strpos($data, <span class="stringliteral">&#39;%%EndProlog&#39;</span>);</div>
<div class="line"><a name="l15005"></a><span class="lineno">15005</span>&#160;        }</div>
<div class="line"><a name="l15006"></a><span class="lineno">15006</span>&#160;        <span class="keywordflow">if</span> ($start === <span class="keyword">false</span>) {</div>
<div class="line"><a name="l15007"></a><span class="lineno">15007</span>&#160;            $start = strpos($data, <span class="stringliteral">&#39;%%BoundingBox&#39;</span>);</div>
<div class="line"><a name="l15008"></a><span class="lineno">15008</span>&#160;        }</div>
<div class="line"><a name="l15009"></a><span class="lineno">15009</span>&#160;        $data = substr($data, $start);</div>
<div class="line"><a name="l15010"></a><span class="lineno">15010</span>&#160;        $end = strpos($data, <span class="stringliteral">&#39;%%PageTrailer&#39;</span>);</div>
<div class="line"><a name="l15011"></a><span class="lineno">15011</span>&#160;        <span class="keywordflow">if</span> ($end===<span class="keyword">false</span>) {</div>
<div class="line"><a name="l15012"></a><span class="lineno">15012</span>&#160;            $end = strpos($data, <span class="stringliteral">&#39;showpage&#39;</span>);</div>
<div class="line"><a name="l15013"></a><span class="lineno">15013</span>&#160;        }</div>
<div class="line"><a name="l15014"></a><span class="lineno">15014</span>&#160;        <span class="keywordflow">if</span> ($end) {</div>
<div class="line"><a name="l15015"></a><span class="lineno">15015</span>&#160;            $data = substr($data, 0, $end);</div>
<div class="line"><a name="l15016"></a><span class="lineno">15016</span>&#160;        }</div>
<div class="line"><a name="l15017"></a><span class="lineno">15017</span>&#160;        <span class="comment">// calculate image width and height on document</span></div>
<div class="line"><a name="l15018"></a><span class="lineno">15018</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> &lt;= 0) AND (<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> &lt;= 0)) {</div>
<div class="line"><a name="l15019"></a><span class="lineno">15019</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = ($x2 - $x1) / <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a>;</div>
<div class="line"><a name="l15020"></a><span class="lineno">15020</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> = ($y2 - $y1) / <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a>;</div>
<div class="line"><a name="l15021"></a><span class="lineno">15021</span>&#160;        } elseif (<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> &lt;= 0) {</div>
<div class="line"><a name="l15022"></a><span class="lineno">15022</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = ($x2-$x1) / <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a> * (<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> / (($y2 - $y1) / <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a>));</div>
<div class="line"><a name="l15023"></a><span class="lineno">15023</span>&#160;        } elseif (<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> &lt;= 0) {</div>
<div class="line"><a name="l15024"></a><span class="lineno">15024</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> = ($y2 - $y1) / <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a> * (<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> / (($x2 - $x1) / <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a>));</div>
<div class="line"><a name="l15025"></a><span class="lineno">15025</span>&#160;        }</div>
<div class="line"><a name="l15026"></a><span class="lineno">15026</span>&#160;        <span class="comment">// fit the image on available space</span></div>
<div class="line"><a name="l15027"></a><span class="lineno">15027</span>&#160;        list(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>) = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af1db92d221fd87c76d7c607f32266d0a">fitBlock</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, $fitonpage);</div>
<div class="line"><a name="l15028"></a><span class="lineno">15028</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;rasterize_vector_images) {</div>
<div class="line"><a name="l15029"></a><span class="lineno">15029</span>&#160;            <span class="comment">// convert EPS to raster image using GD or ImageMagick libraries</span></div>
<div class="line"><a name="l15030"></a><span class="lineno">15030</span>&#160;            <span class="keywordflow">return</span> $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a714c2bee7d6b39d4d6d304540c761352">Image</a>($file, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, <span class="stringliteral">&#39;EPS&#39;</span>, $link, $align, <span class="keyword">true</span>, 300, $palign, <span class="keyword">false</span>, <span class="keyword">false</span>, $border, <span class="keyword">false</span>, <span class="keyword">false</span>, $fitonpage);</div>
<div class="line"><a name="l15031"></a><span class="lineno">15031</span>&#160;        }</div>
<div class="line"><a name="l15032"></a><span class="lineno">15032</span>&#160;        <span class="comment">// set scaling factors</span></div>
<div class="line"><a name="l15033"></a><span class="lineno">15033</span>&#160;        $scale_x = <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> / (($x2 - $x1) / <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a>);</div>
<div class="line"><a name="l15034"></a><span class="lineno">15034</span>&#160;        $scale_y = <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> / (($y2 - $y1) / <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a>);</div>
<div class="line"><a name="l15035"></a><span class="lineno">15035</span>&#160;        <span class="comment">// set alignment</span></div>
<div class="line"><a name="l15036"></a><span class="lineno">15036</span>&#160;        $this-&gt;img_rb_y = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> + <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>;</div>
<div class="line"><a name="l15037"></a><span class="lineno">15037</span>&#160;        <span class="comment">// set alignment</span></div>
<div class="line"><a name="l15038"></a><span class="lineno">15038</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l15039"></a><span class="lineno">15039</span>&#160;            <span class="keywordflow">if</span> ($palign == <span class="charliteral">&#39;L&#39;</span>) {</div>
<div class="line"><a name="l15040"></a><span class="lineno">15040</span>&#160;                $ximg = <a class="code" href="../../d4/d40/classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da">$this-&gt;lMargin</a>;</div>
<div class="line"><a name="l15041"></a><span class="lineno">15041</span>&#160;            } elseif ($palign == <span class="charliteral">&#39;C&#39;</span>) {</div>
<div class="line"><a name="l15042"></a><span class="lineno">15042</span>&#160;                $ximg = ($this-&gt;w + $this-&gt;lMargin - $this-&gt;rMargin - <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>) / 2;</div>
<div class="line"><a name="l15043"></a><span class="lineno">15043</span>&#160;            } elseif ($palign == <span class="charliteral">&#39;R&#39;</span>) {</div>
<div class="line"><a name="l15044"></a><span class="lineno">15044</span>&#160;                $ximg = $this-&gt;w - $this-&gt;rMargin - <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>;</div>
<div class="line"><a name="l15045"></a><span class="lineno">15045</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l15046"></a><span class="lineno">15046</span>&#160;                $ximg = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> - <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>;</div>
<div class="line"><a name="l15047"></a><span class="lineno">15047</span>&#160;            }</div>
<div class="line"><a name="l15048"></a><span class="lineno">15048</span>&#160;            $this-&gt;img_rb_x = $ximg;</div>
<div class="line"><a name="l15049"></a><span class="lineno">15049</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l15050"></a><span class="lineno">15050</span>&#160;            <span class="keywordflow">if</span> ($palign == <span class="charliteral">&#39;L&#39;</span>) {</div>
<div class="line"><a name="l15051"></a><span class="lineno">15051</span>&#160;                $ximg = <a class="code" href="../../d4/d40/classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da">$this-&gt;lMargin</a>;</div>
<div class="line"><a name="l15052"></a><span class="lineno">15052</span>&#160;            } elseif ($palign == <span class="charliteral">&#39;C&#39;</span>) {</div>
<div class="line"><a name="l15053"></a><span class="lineno">15053</span>&#160;                $ximg = ($this-&gt;w + $this-&gt;lMargin - $this-&gt;rMargin - <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>) / 2;</div>
<div class="line"><a name="l15054"></a><span class="lineno">15054</span>&#160;            } elseif ($palign == <span class="charliteral">&#39;R&#39;</span>) {</div>
<div class="line"><a name="l15055"></a><span class="lineno">15055</span>&#160;                $ximg = $this-&gt;w - $this-&gt;rMargin - <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>;</div>
<div class="line"><a name="l15056"></a><span class="lineno">15056</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l15057"></a><span class="lineno">15057</span>&#160;                $ximg = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>;</div>
<div class="line"><a name="l15058"></a><span class="lineno">15058</span>&#160;            }</div>
<div class="line"><a name="l15059"></a><span class="lineno">15059</span>&#160;            $this-&gt;img_rb_x = $ximg + <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>;</div>
<div class="line"><a name="l15060"></a><span class="lineno">15060</span>&#160;        }</div>
<div class="line"><a name="l15061"></a><span class="lineno">15061</span>&#160;        <span class="keywordflow">if</span> ($useBoundingBox) {</div>
<div class="line"><a name="l15062"></a><span class="lineno">15062</span>&#160;            $dx = $ximg * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a> - $x1;</div>
<div class="line"><a name="l15063"></a><span class="lineno">15063</span>&#160;            $dy = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a> - $y1;</div>
<div class="line"><a name="l15064"></a><span class="lineno">15064</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l15065"></a><span class="lineno">15065</span>&#160;            $dx = $ximg * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a>;</div>
<div class="line"><a name="l15066"></a><span class="lineno">15066</span>&#160;            $dy = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a>;</div>
<div class="line"><a name="l15067"></a><span class="lineno">15067</span>&#160;        }</div>
<div class="line"><a name="l15068"></a><span class="lineno">15068</span>&#160;        <span class="comment">// save the current graphic state</span></div>
<div class="line"><a name="l15069"></a><span class="lineno">15069</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(<span class="charliteral">&#39;q&#39;</span>.$this-&gt;epsmarker);</div>
<div class="line"><a name="l15070"></a><span class="lineno">15070</span>&#160;        <span class="comment">// translate</span></div>
<div class="line"><a name="l15071"></a><span class="lineno">15071</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(sprintf(<span class="stringliteral">&#39;%F %F %F %F %F %F cm&#39;</span>, 1, 0, 0, 1, $dx, $dy + ($this-&gt;hPt - (2 * <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a>) - ($y2 - $y1))));</div>
<div class="line"><a name="l15072"></a><span class="lineno">15072</span>&#160;        <span class="comment">// scale</span></div>
<div class="line"><a name="l15073"></a><span class="lineno">15073</span>&#160;        <span class="keywordflow">if</span> (isset($scale_x)) {</div>
<div class="line"><a name="l15074"></a><span class="lineno">15074</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(sprintf(<span class="stringliteral">&#39;%F %F %F %F %F %F cm&#39;</span>, $scale_x, 0, 0, $scale_y, $x1 * (1 - $scale_x), $y2 * (1 - $scale_y)));</div>
<div class="line"><a name="l15075"></a><span class="lineno">15075</span>&#160;        }</div>
<div class="line"><a name="l15076"></a><span class="lineno">15076</span>&#160;        <span class="comment">// handle pc/unix/mac line endings</span></div>
<div class="line"><a name="l15077"></a><span class="lineno">15077</span>&#160;        $lines = preg_split(<span class="stringliteral">&#39;/[\r\n]+/si&#39;</span>, $data, -1, PREG_SPLIT_NO_EMPTY);</div>
<div class="line"><a name="l15078"></a><span class="lineno">15078</span>&#160;        $u=0;</div>
<div class="line"><a name="l15079"></a><span class="lineno">15079</span>&#160;        $cnt = count($lines);</div>
<div class="line"><a name="l15080"></a><span class="lineno">15080</span>&#160;        <span class="keywordflow">for</span> ($i=0; $i &lt; $cnt; ++$i) {</div>
<div class="line"><a name="l15081"></a><span class="lineno">15081</span>&#160;            $line = $lines[$i];</div>
<div class="line"><a name="l15082"></a><span class="lineno">15082</span>&#160;            <span class="keywordflow">if</span> (($line == <span class="stringliteral">&#39;&#39;</span>) OR ($line[0] == <span class="charliteral">&#39;%&#39;</span>)) {</div>
<div class="line"><a name="l15083"></a><span class="lineno">15083</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l15084"></a><span class="lineno">15084</span>&#160;            }</div>
<div class="line"><a name="l15085"></a><span class="lineno">15085</span>&#160;            $len = strlen($line);</div>
<div class="line"><a name="l15086"></a><span class="lineno">15086</span>&#160;            <span class="comment">// check for spot color names</span></div>
<div class="line"><a name="l15087"></a><span class="lineno">15087</span>&#160;            $color_name = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l15088"></a><span class="lineno">15088</span>&#160;            <span class="keywordflow">if</span> (strcasecmp(<span class="charliteral">&#39;x&#39;</span>, substr(trim($line), -1)) == 0) {</div>
<div class="line"><a name="l15089"></a><span class="lineno">15089</span>&#160;                <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/\([^\)]*\)/&#39;</span>, $line, $matches) &gt; 0) {</div>
<div class="line"><a name="l15090"></a><span class="lineno">15090</span>&#160;                    <span class="comment">// extract spot color name</span></div>
<div class="line"><a name="l15091"></a><span class="lineno">15091</span>&#160;                    $color_name = $matches[0];</div>
<div class="line"><a name="l15092"></a><span class="lineno">15092</span>&#160;                    <span class="comment">// remove color name from string</span></div>
<div class="line"><a name="l15093"></a><span class="lineno">15093</span>&#160;                    $line = str_replace(<span class="charliteral">&#39; &#39;</span>.$color_name, <span class="stringliteral">&#39;&#39;</span>, $line);</div>
<div class="line"><a name="l15094"></a><span class="lineno">15094</span>&#160;                    <span class="comment">// remove pharentesis from color name</span></div>
<div class="line"><a name="l15095"></a><span class="lineno">15095</span>&#160;                    $color_name = substr($color_name, 1, -1);</div>
<div class="line"><a name="l15096"></a><span class="lineno">15096</span>&#160;                }</div>
<div class="line"><a name="l15097"></a><span class="lineno">15097</span>&#160;            }</div>
<div class="line"><a name="l15098"></a><span class="lineno">15098</span>&#160;            $chunks = explode(<span class="charliteral">&#39; &#39;</span>, $line);</div>
<div class="line"><a name="l15099"></a><span class="lineno">15099</span>&#160;            $cmd = trim(array_pop($chunks));</div>
<div class="line"><a name="l15100"></a><span class="lineno">15100</span>&#160;            <span class="comment">// RGB</span></div>
<div class="line"><a name="l15101"></a><span class="lineno">15101</span>&#160;            <span class="keywordflow">if</span> (($cmd == <span class="stringliteral">&#39;Xa&#39;</span>) OR ($cmd == <span class="stringliteral">&#39;XA&#39;</span>)) {</div>
<div class="line"><a name="l15102"></a><span class="lineno">15102</span>&#160;                $b = array_pop($chunks);</div>
<div class="line"><a name="l15103"></a><span class="lineno">15103</span>&#160;                $g = array_pop($chunks);</div>
<div class="line"><a name="l15104"></a><span class="lineno">15104</span>&#160;                $r = array_pop($chunks);</div>
<div class="line"><a name="l15105"></a><span class="lineno">15105</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(<span class="stringliteral">&#39;&#39;</span>.$r.<span class="charliteral">&#39; &#39;</span>.$g.<span class="charliteral">&#39; &#39;</span>.$b.<span class="charliteral">&#39; &#39;</span>.($cmd==<span class="stringliteral">&#39;Xa&#39;</span>?<span class="stringliteral">&#39;rg&#39;</span>:<span class="stringliteral">&#39;RG&#39;</span>)); <span class="comment">//substr($line, 0, -2).&#39;rg&#39; -&gt; in EPS (AI8): c m y k r g b rg!</span></div>
<div class="line"><a name="l15106"></a><span class="lineno">15106</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l15107"></a><span class="lineno">15107</span>&#160;            }</div>
<div class="line"><a name="l15108"></a><span class="lineno">15108</span>&#160;            $skip = <span class="keyword">false</span>;</div>
<div class="line"><a name="l15109"></a><span class="lineno">15109</span>&#160;            <span class="keywordflow">if</span> ($fixoutvals) {</div>
<div class="line"><a name="l15110"></a><span class="lineno">15110</span>&#160;                <span class="comment">// check for values outside the bounding box</span></div>
<div class="line"><a name="l15111"></a><span class="lineno">15111</span>&#160;                <span class="keywordflow">switch</span> ($cmd) {</div>
<div class="line"><a name="l15112"></a><span class="lineno">15112</span>&#160;                    <span class="keywordflow">case</span> <span class="charliteral">&#39;m&#39;</span>:</div>
<div class="line"><a name="l15113"></a><span class="lineno">15113</span>&#160;                    <span class="keywordflow">case</span> <span class="charliteral">&#39;l&#39;</span>:</div>
<div class="line"><a name="l15114"></a><span class="lineno">15114</span>&#160;                    <span class="keywordflow">case</span> <span class="charliteral">&#39;L&#39;</span>: {</div>
<div class="line"><a name="l15115"></a><span class="lineno">15115</span>&#160;                        <span class="comment">// skip values outside bounding box</span></div>
<div class="line"><a name="l15116"></a><span class="lineno">15116</span>&#160;                        <span class="keywordflow">foreach</span> ($chunks as $key =&gt; $val) {</div>
<div class="line"><a name="l15117"></a><span class="lineno">15117</span>&#160;                            <span class="keywordflow">if</span> ((($key % 2) == 0) AND (($val &lt; $x1) OR ($val &gt; $x2))) {</div>
<div class="line"><a name="l15118"></a><span class="lineno">15118</span>&#160;                                $skip = <span class="keyword">true</span>;</div>
<div class="line"><a name="l15119"></a><span class="lineno">15119</span>&#160;                            } elseif ((($key % 2) != 0) AND (($val &lt; $y1) OR ($val &gt; $y2))) {</div>
<div class="line"><a name="l15120"></a><span class="lineno">15120</span>&#160;                                $skip = <span class="keyword">true</span>;</div>
<div class="line"><a name="l15121"></a><span class="lineno">15121</span>&#160;                            }</div>
<div class="line"><a name="l15122"></a><span class="lineno">15122</span>&#160;                        }</div>
<div class="line"><a name="l15123"></a><span class="lineno">15123</span>&#160;                    }</div>
<div class="line"><a name="l15124"></a><span class="lineno">15124</span>&#160;                }</div>
<div class="line"><a name="l15125"></a><span class="lineno">15125</span>&#160;            }</div>
<div class="line"><a name="l15126"></a><span class="lineno">15126</span>&#160;            <span class="keywordflow">switch</span> ($cmd) {</div>
<div class="line"><a name="l15127"></a><span class="lineno">15127</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;m&#39;</span>:</div>
<div class="line"><a name="l15128"></a><span class="lineno">15128</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;l&#39;</span>:</div>
<div class="line"><a name="l15129"></a><span class="lineno">15129</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;v&#39;</span>:</div>
<div class="line"><a name="l15130"></a><span class="lineno">15130</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;y&#39;</span>:</div>
<div class="line"><a name="l15131"></a><span class="lineno">15131</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;c&#39;</span>:</div>
<div class="line"><a name="l15132"></a><span class="lineno">15132</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;k&#39;</span>:</div>
<div class="line"><a name="l15133"></a><span class="lineno">15133</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;K&#39;</span>:</div>
<div class="line"><a name="l15134"></a><span class="lineno">15134</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;g&#39;</span>:</div>
<div class="line"><a name="l15135"></a><span class="lineno">15135</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;G&#39;</span>:</div>
<div class="line"><a name="l15136"></a><span class="lineno">15136</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;s&#39;</span>:</div>
<div class="line"><a name="l15137"></a><span class="lineno">15137</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;S&#39;</span>:</div>
<div class="line"><a name="l15138"></a><span class="lineno">15138</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;J&#39;</span>:</div>
<div class="line"><a name="l15139"></a><span class="lineno">15139</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;j&#39;</span>:</div>
<div class="line"><a name="l15140"></a><span class="lineno">15140</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;w&#39;</span>:</div>
<div class="line"><a name="l15141"></a><span class="lineno">15141</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;M&#39;</span>:</div>
<div class="line"><a name="l15142"></a><span class="lineno">15142</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;d&#39;</span>:</div>
<div class="line"><a name="l15143"></a><span class="lineno">15143</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;n&#39;</span>: {</div>
<div class="line"><a name="l15144"></a><span class="lineno">15144</span>&#160;                    <span class="keywordflow">if</span> ($skip) {</div>
<div class="line"><a name="l15145"></a><span class="lineno">15145</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l15146"></a><span class="lineno">15146</span>&#160;                    }</div>
<div class="line"><a name="l15147"></a><span class="lineno">15147</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($line);</div>
<div class="line"><a name="l15148"></a><span class="lineno">15148</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l15149"></a><span class="lineno">15149</span>&#160;                }</div>
<div class="line"><a name="l15150"></a><span class="lineno">15150</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;x&#39;</span>: {<span class="comment">// custom fill color</span></div>
<div class="line"><a name="l15151"></a><span class="lineno">15151</span>&#160;                    <span class="keywordflow">if</span> (empty($color_name)) {</div>
<div class="line"><a name="l15152"></a><span class="lineno">15152</span>&#160;                        <span class="comment">// CMYK color</span></div>
<div class="line"><a name="l15153"></a><span class="lineno">15153</span>&#160;                        list($col_c, $col_m, $col_y, $col_k) = $chunks;</div>
<div class="line"><a name="l15154"></a><span class="lineno">15154</span>&#160;                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(<span class="stringliteral">&#39;&#39;</span>.$col_c.<span class="charliteral">&#39; &#39;</span>.$col_m.<span class="charliteral">&#39; &#39;</span>.$col_y.<span class="charliteral">&#39; &#39;</span>.$col_k.<span class="stringliteral">&#39; k&#39;</span>);</div>
<div class="line"><a name="l15155"></a><span class="lineno">15155</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l15156"></a><span class="lineno">15156</span>&#160;                        <span class="comment">// Spot Color (CMYK + tint)</span></div>
<div class="line"><a name="l15157"></a><span class="lineno">15157</span>&#160;                        list($col_c, $col_m, $col_y, $col_k, $col_t) = $chunks;</div>
<div class="line"><a name="l15158"></a><span class="lineno">15158</span>&#160;                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a082e1feab2282c76f5b7e2eaafc6f457">AddSpotColor</a>($color_name, ($col_c * 100), ($col_m * 100), ($col_y * 100), ($col_k * 100));</div>
<div class="line"><a name="l15159"></a><span class="lineno">15159</span>&#160;                        $color_cmd = sprintf(<span class="stringliteral">&#39;/CS%d cs %F scn&#39;</span>, $this-&gt;spot_colors[$color_name][<span class="charliteral">&#39;i&#39;</span>], (1 - $col_t));</div>
<div class="line"><a name="l15160"></a><span class="lineno">15160</span>&#160;                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($color_cmd);</div>
<div class="line"><a name="l15161"></a><span class="lineno">15161</span>&#160;                    }</div>
<div class="line"><a name="l15162"></a><span class="lineno">15162</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l15163"></a><span class="lineno">15163</span>&#160;                }</div>
<div class="line"><a name="l15164"></a><span class="lineno">15164</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;X&#39;</span>: { <span class="comment">// custom stroke color</span></div>
<div class="line"><a name="l15165"></a><span class="lineno">15165</span>&#160;                    <span class="keywordflow">if</span> (empty($color_name)) {</div>
<div class="line"><a name="l15166"></a><span class="lineno">15166</span>&#160;                        <span class="comment">// CMYK color</span></div>
<div class="line"><a name="l15167"></a><span class="lineno">15167</span>&#160;                        list($col_c, $col_m, $col_y, $col_k) = $chunks;</div>
<div class="line"><a name="l15168"></a><span class="lineno">15168</span>&#160;                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(<span class="stringliteral">&#39;&#39;</span>.$col_c.<span class="charliteral">&#39; &#39;</span>.$col_m.<span class="charliteral">&#39; &#39;</span>.$col_y.<span class="charliteral">&#39; &#39;</span>.$col_k.<span class="stringliteral">&#39; K&#39;</span>);</div>
<div class="line"><a name="l15169"></a><span class="lineno">15169</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l15170"></a><span class="lineno">15170</span>&#160;                        <span class="comment">// Spot Color (CMYK + tint)</span></div>
<div class="line"><a name="l15171"></a><span class="lineno">15171</span>&#160;                        list($col_c, $col_m, $col_y, $col_k, $col_t) = $chunks;</div>
<div class="line"><a name="l15172"></a><span class="lineno">15172</span>&#160;                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a082e1feab2282c76f5b7e2eaafc6f457">AddSpotColor</a>($color_name, ($col_c * 100), ($col_m * 100), ($col_y * 100), ($col_k * 100));</div>
<div class="line"><a name="l15173"></a><span class="lineno">15173</span>&#160;                        $color_cmd = sprintf(<span class="stringliteral">&#39;/CS%d CS %F SCN&#39;</span>, $this-&gt;spot_colors[$color_name][<span class="charliteral">&#39;i&#39;</span>], (1 - $col_t));</div>
<div class="line"><a name="l15174"></a><span class="lineno">15174</span>&#160;                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($color_cmd);</div>
<div class="line"><a name="l15175"></a><span class="lineno">15175</span>&#160;                    }</div>
<div class="line"><a name="l15176"></a><span class="lineno">15176</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l15177"></a><span class="lineno">15177</span>&#160;                }</div>
<div class="line"><a name="l15178"></a><span class="lineno">15178</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;Y&#39;</span>:</div>
<div class="line"><a name="l15179"></a><span class="lineno">15179</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;N&#39;</span>:</div>
<div class="line"><a name="l15180"></a><span class="lineno">15180</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;V&#39;</span>:</div>
<div class="line"><a name="l15181"></a><span class="lineno">15181</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;L&#39;</span>:</div>
<div class="line"><a name="l15182"></a><span class="lineno">15182</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>: {</div>
<div class="line"><a name="l15183"></a><span class="lineno">15183</span>&#160;                    <span class="keywordflow">if</span> ($skip) {</div>
<div class="line"><a name="l15184"></a><span class="lineno">15184</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l15185"></a><span class="lineno">15185</span>&#160;                    }</div>
<div class="line"><a name="l15186"></a><span class="lineno">15186</span>&#160;                    $line[($len - 1)] = strtolower($cmd);</div>
<div class="line"><a name="l15187"></a><span class="lineno">15187</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($line);</div>
<div class="line"><a name="l15188"></a><span class="lineno">15188</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l15189"></a><span class="lineno">15189</span>&#160;                }</div>
<div class="line"><a name="l15190"></a><span class="lineno">15190</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;b&#39;</span>:</div>
<div class="line"><a name="l15191"></a><span class="lineno">15191</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>: {</div>
<div class="line"><a name="l15192"></a><span class="lineno">15192</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($cmd . <span class="charliteral">&#39;*&#39;</span>);</div>
<div class="line"><a name="l15193"></a><span class="lineno">15193</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l15194"></a><span class="lineno">15194</span>&#160;                }</div>
<div class="line"><a name="l15195"></a><span class="lineno">15195</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;f&#39;</span>:</div>
<div class="line"><a name="l15196"></a><span class="lineno">15196</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;F&#39;</span>: {</div>
<div class="line"><a name="l15197"></a><span class="lineno">15197</span>&#160;                    <span class="keywordflow">if</span> ($u &gt; 0) {</div>
<div class="line"><a name="l15198"></a><span class="lineno">15198</span>&#160;                        $isU = <span class="keyword">false</span>;</div>
<div class="line"><a name="l15199"></a><span class="lineno">15199</span>&#160;                        $max = min(($i + 5), $cnt);</div>
<div class="line"><a name="l15200"></a><span class="lineno">15200</span>&#160;                        <span class="keywordflow">for</span> ($j = ($i + 1); $j &lt; $max; ++$j) {</div>
<div class="line"><a name="l15201"></a><span class="lineno">15201</span>&#160;                            $isU = ($isU OR (($lines[$j] == <span class="charliteral">&#39;U&#39;</span>) OR ($lines[$j] == <span class="stringliteral">&#39;*U&#39;</span>)));</div>
<div class="line"><a name="l15202"></a><span class="lineno">15202</span>&#160;                        }</div>
<div class="line"><a name="l15203"></a><span class="lineno">15203</span>&#160;                        <span class="keywordflow">if</span> ($isU) {</div>
<div class="line"><a name="l15204"></a><span class="lineno">15204</span>&#160;                            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(<span class="stringliteral">&#39;f*&#39;</span>);</div>
<div class="line"><a name="l15205"></a><span class="lineno">15205</span>&#160;                        }</div>
<div class="line"><a name="l15206"></a><span class="lineno">15206</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l15207"></a><span class="lineno">15207</span>&#160;                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>(<span class="stringliteral">&#39;f*&#39;</span>);</div>
<div class="line"><a name="l15208"></a><span class="lineno">15208</span>&#160;                    }</div>
<div class="line"><a name="l15209"></a><span class="lineno">15209</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l15210"></a><span class="lineno">15210</span>&#160;                }</div>
<div class="line"><a name="l15211"></a><span class="lineno">15211</span>&#160;                <span class="keywordflow">case</span> <span class="stringliteral">&#39;*u&#39;</span>: {</div>
<div class="line"><a name="l15212"></a><span class="lineno">15212</span>&#160;                    ++$u;</div>
<div class="line"><a name="l15213"></a><span class="lineno">15213</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l15214"></a><span class="lineno">15214</span>&#160;                }</div>
<div class="line"><a name="l15215"></a><span class="lineno">15215</span>&#160;                <span class="keywordflow">case</span> <span class="stringliteral">&#39;*U&#39;</span>: {</div>
<div class="line"><a name="l15216"></a><span class="lineno">15216</span>&#160;                    --$u;</div>
<div class="line"><a name="l15217"></a><span class="lineno">15217</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l15218"></a><span class="lineno">15218</span>&#160;                }</div>
<div class="line"><a name="l15219"></a><span class="lineno">15219</span>&#160;            }</div>
<div class="line"><a name="l15220"></a><span class="lineno">15220</span>&#160;        }</div>
<div class="line"><a name="l15221"></a><span class="lineno">15221</span>&#160;        <span class="comment">// restore previous graphic state</span></div>
<div class="line"><a name="l15222"></a><span class="lineno">15222</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">_out</a>($this-&gt;epsmarker.<span class="charliteral">&#39;Q&#39;</span>);</div>
<div class="line"><a name="l15223"></a><span class="lineno">15223</span>&#160;        <span class="keywordflow">if</span> (!empty($border)) {</div>
<div class="line"><a name="l15224"></a><span class="lineno">15224</span>&#160;            $bx = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$this-&gt;x</a>;</div>
<div class="line"><a name="l15225"></a><span class="lineno">15225</span>&#160;            $by = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l15226"></a><span class="lineno">15226</span>&#160;            $this-&gt;x = $ximg;</div>
<div class="line"><a name="l15227"></a><span class="lineno">15227</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l15228"></a><span class="lineno">15228</span>&#160;                $this-&gt;x += <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>;</div>
<div class="line"><a name="l15229"></a><span class="lineno">15229</span>&#160;            }</div>
<div class="line"><a name="l15230"></a><span class="lineno">15230</span>&#160;            $this-&gt;y = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>;</div>
<div class="line"><a name="l15231"></a><span class="lineno">15231</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a33b265e5eb3e4d1d4fedfe29f8166f31">Cell</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, $h, <span class="stringliteral">&#39;&#39;</span>, $border, 0, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="keyword">true</span>);</div>
<div class="line"><a name="l15232"></a><span class="lineno">15232</span>&#160;            $this-&gt;x = $bx;</div>
<div class="line"><a name="l15233"></a><span class="lineno">15233</span>&#160;            $this-&gt;y = $by;</div>
<div class="line"><a name="l15234"></a><span class="lineno">15234</span>&#160;        }</div>
<div class="line"><a name="l15235"></a><span class="lineno">15235</span>&#160;        <span class="keywordflow">if</span> ($link) {</div>
<div class="line"><a name="l15236"></a><span class="lineno">15236</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ab87bf1826384fbfe30eb499d42f1d994">Link</a>($ximg, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, $h, $link, 0);</div>
<div class="line"><a name="l15237"></a><span class="lineno">15237</span>&#160;        }</div>
<div class="line"><a name="l15238"></a><span class="lineno">15238</span>&#160;        <span class="comment">// set pointer to align the next text/objects</span></div>
<div class="line"><a name="l15239"></a><span class="lineno">15239</span>&#160;        <span class="keywordflow">switch</span>($align) {</div>
<div class="line"><a name="l15240"></a><span class="lineno">15240</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>:{</div>
<div class="line"><a name="l15241"></a><span class="lineno">15241</span>&#160;                $this-&gt;y = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>;</div>
<div class="line"><a name="l15242"></a><span class="lineno">15242</span>&#160;                $this-&gt;x = <a class="code" href="../../d4/d40/classTCPDF.html#ace8e68000d6185a28a180bbe4531b428">$this-&gt;img_rb_x</a>;</div>
<div class="line"><a name="l15243"></a><span class="lineno">15243</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l15244"></a><span class="lineno">15244</span>&#160;            }</div>
<div class="line"><a name="l15245"></a><span class="lineno">15245</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;M&#39;</span>:{</div>
<div class="line"><a name="l15246"></a><span class="lineno">15246</span>&#160;                $this-&gt;y = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> + round($h/2);</div>
<div class="line"><a name="l15247"></a><span class="lineno">15247</span>&#160;                $this-&gt;x = <a class="code" href="../../d4/d40/classTCPDF.html#ace8e68000d6185a28a180bbe4531b428">$this-&gt;img_rb_x</a>;</div>
<div class="line"><a name="l15248"></a><span class="lineno">15248</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l15249"></a><span class="lineno">15249</span>&#160;            }</div>
<div class="line"><a name="l15250"></a><span class="lineno">15250</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>:{</div>
<div class="line"><a name="l15251"></a><span class="lineno">15251</span>&#160;                $this-&gt;y = <a class="code" href="../../d4/d40/classTCPDF.html#abc05496cf88772b492f67e87c53121d0">$this-&gt;img_rb_y</a>;</div>
<div class="line"><a name="l15252"></a><span class="lineno">15252</span>&#160;                $this-&gt;x = <a class="code" href="../../d4/d40/classTCPDF.html#ace8e68000d6185a28a180bbe4531b428">$this-&gt;img_rb_x</a>;</div>
<div class="line"><a name="l15253"></a><span class="lineno">15253</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l15254"></a><span class="lineno">15254</span>&#160;            }</div>
<div class="line"><a name="l15255"></a><span class="lineno">15255</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;N&#39;</span>:{</div>
<div class="line"><a name="l15256"></a><span class="lineno">15256</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ad3439990de56253b039bca6a09305758">SetY</a>($this-&gt;img_rb_y);</div>
<div class="line"><a name="l15257"></a><span class="lineno">15257</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l15258"></a><span class="lineno">15258</span>&#160;            }</div>
<div class="line"><a name="l15259"></a><span class="lineno">15259</span>&#160;            <span class="keywordflow">default</span>:{</div>
<div class="line"><a name="l15260"></a><span class="lineno">15260</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l15261"></a><span class="lineno">15261</span>&#160;            }</div>
<div class="line"><a name="l15262"></a><span class="lineno">15262</span>&#160;        }</div>
<div class="line"><a name="l15263"></a><span class="lineno">15263</span>&#160;        $this-&gt;endlinex = <a class="code" href="../../d4/d40/classTCPDF.html#ace8e68000d6185a28a180bbe4531b428">$this-&gt;img_rb_x</a>;</div>
<div class="line"><a name="l15264"></a><span class="lineno">15264</span>&#160;    }</div>
<div class="line"><a name="l15265"></a><span class="lineno">15265</span>&#160;</div>
<div class="line"><a name="l15271"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ad66f051c544895eb0a35ad0e033c3fa9">15271</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ad66f051c544895eb0a35ad0e033c3fa9">setBarcode</a>($bc=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l15272"></a><span class="lineno">15272</span>&#160;        $this-&gt;barcode = $bc;</div>
<div class="line"><a name="l15273"></a><span class="lineno">15273</span>&#160;    }</div>
<div class="line"><a name="l15274"></a><span class="lineno">15274</span>&#160;</div>
<div class="line"><a name="l15281"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aa3deb91c4ae36afa6253c831df589b3d">15281</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#aa3deb91c4ae36afa6253c831df589b3d">getBarcode</a>() {</div>
<div class="line"><a name="l15282"></a><span class="lineno">15282</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#aa043d6a67959c785e8decc6ef1400cd8">$this-&gt;barcode</a>;</div>
<div class="line"><a name="l15283"></a><span class="lineno">15283</span>&#160;    }</div>
<div class="line"><a name="l15284"></a><span class="lineno">15284</span>&#160;</div>
<div class="line"><a name="l15315"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a4816d61822a4bad6e35bb441c1699aab">15315</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a4816d61822a4bad6e35bb441c1699aab">write1DBarcode</a>($code, $type, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>=<span class="stringliteral">&#39;&#39;</span>, $xres=<span class="stringliteral">&#39;&#39;</span>, $style=<span class="stringliteral">&#39;&#39;</span>, $align=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l15316"></a><span class="lineno">15316</span>&#160;        <span class="keywordflow">if</span> (TCPDF_STATIC::empty_string(trim($code))) {</div>
<div class="line"><a name="l15317"></a><span class="lineno">15317</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l15318"></a><span class="lineno">15318</span>&#160;        }</div>
<div class="line"><a name="l15319"></a><span class="lineno">15319</span>&#160;        require_once(dirname(__FILE__).<span class="stringliteral">&#39;/tcpdf_barcodes_1d.php&#39;</span>);</div>
<div class="line"><a name="l15320"></a><span class="lineno">15320</span>&#160;        <span class="comment">// save current graphic settings</span></div>
<div class="line"><a name="l15321"></a><span class="lineno">15321</span>&#160;        $gvars = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a24d3c102468b6ab9d2f4859a8b01863a">getGraphicVars</a>();</div>
<div class="line"><a name="l15322"></a><span class="lineno">15322</span>&#160;        <span class="comment">// create new barcode object</span></div>
<div class="line"><a name="l15323"></a><span class="lineno">15323</span>&#160;        $barcodeobj = <span class="keyword">new</span> <a class="code" href="../../d1/d8c/classTCPDFBarcode.html">TCPDFBarcode</a>($code, $type);</div>
<div class="line"><a name="l15324"></a><span class="lineno">15324</span>&#160;        $arrcode = $barcodeobj-&gt;getBarcodeArray();</div>
<div class="line"><a name="l15325"></a><span class="lineno">15325</span>&#160;        <span class="keywordflow">if</span> (($arrcode === <span class="keyword">false</span>) OR empty($arrcode) OR ($arrcode[<span class="stringliteral">&#39;maxw&#39;</span>] &lt;= 0)) {</div>
<div class="line"><a name="l15326"></a><span class="lineno">15326</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;Error in 1D barcode string&#39;</span>);</div>
<div class="line"><a name="l15327"></a><span class="lineno">15327</span>&#160;        }</div>
<div class="line"><a name="l15328"></a><span class="lineno">15328</span>&#160;        <span class="keywordflow">if</span> ($arrcode[<span class="stringliteral">&#39;maxh&#39;</span>] &lt;= 0) {</div>
<div class="line"><a name="l15329"></a><span class="lineno">15329</span>&#160;            $arrcode[<span class="stringliteral">&#39;maxh&#39;</span>] = 1;</div>
<div class="line"><a name="l15330"></a><span class="lineno">15330</span>&#160;        }</div>
<div class="line"><a name="l15331"></a><span class="lineno">15331</span>&#160;        <span class="comment">// set default values</span></div>
<div class="line"><a name="l15332"></a><span class="lineno">15332</span>&#160;        <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;position&#39;</span>])) {</div>
<div class="line"><a name="l15333"></a><span class="lineno">15333</span>&#160;            $style[<span class="stringliteral">&#39;position&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l15334"></a><span class="lineno">15334</span>&#160;        } elseif ($style[<span class="stringliteral">&#39;position&#39;</span>] == <span class="charliteral">&#39;S&#39;</span>) {</div>
<div class="line"><a name="l15335"></a><span class="lineno">15335</span>&#160;            <span class="comment">// keep this for backward compatibility</span></div>
<div class="line"><a name="l15336"></a><span class="lineno">15336</span>&#160;            $style[<span class="stringliteral">&#39;position&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l15337"></a><span class="lineno">15337</span>&#160;            $style[<span class="stringliteral">&#39;stretch&#39;</span>] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l15338"></a><span class="lineno">15338</span>&#160;        }</div>
<div class="line"><a name="l15339"></a><span class="lineno">15339</span>&#160;        <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;fitwidth&#39;</span>])) {</div>
<div class="line"><a name="l15340"></a><span class="lineno">15340</span>&#160;            <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;stretch&#39;</span>])) {</div>
<div class="line"><a name="l15341"></a><span class="lineno">15341</span>&#160;                $style[<span class="stringliteral">&#39;fitwidth&#39;</span>] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l15342"></a><span class="lineno">15342</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l15343"></a><span class="lineno">15343</span>&#160;                $style[<span class="stringliteral">&#39;fitwidth&#39;</span>] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l15344"></a><span class="lineno">15344</span>&#160;            }</div>
<div class="line"><a name="l15345"></a><span class="lineno">15345</span>&#160;        }</div>
<div class="line"><a name="l15346"></a><span class="lineno">15346</span>&#160;        <span class="keywordflow">if</span> ($style[<span class="stringliteral">&#39;fitwidth&#39;</span>]) {</div>
<div class="line"><a name="l15347"></a><span class="lineno">15347</span>&#160;            <span class="comment">// disable stretch</span></div>
<div class="line"><a name="l15348"></a><span class="lineno">15348</span>&#160;            $style[<span class="stringliteral">&#39;stretch&#39;</span>] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l15349"></a><span class="lineno">15349</span>&#160;        }</div>
<div class="line"><a name="l15350"></a><span class="lineno">15350</span>&#160;        <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;stretch&#39;</span>])) {</div>
<div class="line"><a name="l15351"></a><span class="lineno">15351</span>&#160;            <span class="keywordflow">if</span> ((<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> === <span class="stringliteral">&#39;&#39;</span>) OR (<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> &lt;= 0)) {</div>
<div class="line"><a name="l15352"></a><span class="lineno">15352</span>&#160;                $style[<span class="stringliteral">&#39;stretch&#39;</span>] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l15353"></a><span class="lineno">15353</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l15354"></a><span class="lineno">15354</span>&#160;                $style[<span class="stringliteral">&#39;stretch&#39;</span>] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l15355"></a><span class="lineno">15355</span>&#160;            }</div>
<div class="line"><a name="l15356"></a><span class="lineno">15356</span>&#160;        }</div>
<div class="line"><a name="l15357"></a><span class="lineno">15357</span>&#160;        <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;fgcolor&#39;</span>])) {</div>
<div class="line"><a name="l15358"></a><span class="lineno">15358</span>&#160;            $style[<span class="stringliteral">&#39;fgcolor&#39;</span>] = array(0,0,0); <span class="comment">// default black</span></div>
<div class="line"><a name="l15359"></a><span class="lineno">15359</span>&#160;        }</div>
<div class="line"><a name="l15360"></a><span class="lineno">15360</span>&#160;        <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;bgcolor&#39;</span>])) {</div>
<div class="line"><a name="l15361"></a><span class="lineno">15361</span>&#160;            $style[<span class="stringliteral">&#39;bgcolor&#39;</span>] = <span class="keyword">false</span>; <span class="comment">// default transparent</span></div>
<div class="line"><a name="l15362"></a><span class="lineno">15362</span>&#160;        }</div>
<div class="line"><a name="l15363"></a><span class="lineno">15363</span>&#160;        <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;border&#39;</span>])) {</div>
<div class="line"><a name="l15364"></a><span class="lineno">15364</span>&#160;            $style[<span class="stringliteral">&#39;border&#39;</span>] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l15365"></a><span class="lineno">15365</span>&#160;        }</div>
<div class="line"><a name="l15366"></a><span class="lineno">15366</span>&#160;        $fontsize = 0;</div>
<div class="line"><a name="l15367"></a><span class="lineno">15367</span>&#160;        <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;text&#39;</span>])) {</div>
<div class="line"><a name="l15368"></a><span class="lineno">15368</span>&#160;            $style[<span class="stringliteral">&#39;text&#39;</span>] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l15369"></a><span class="lineno">15369</span>&#160;        }</div>
<div class="line"><a name="l15370"></a><span class="lineno">15370</span>&#160;        <span class="keywordflow">if</span> ($style[<span class="stringliteral">&#39;text&#39;</span>] AND isset($style[<span class="stringliteral">&#39;font&#39;</span>])) {</div>
<div class="line"><a name="l15371"></a><span class="lineno">15371</span>&#160;            <span class="keywordflow">if</span> (isset($style[<span class="stringliteral">&#39;fontsize&#39;</span>])) {</div>
<div class="line"><a name="l15372"></a><span class="lineno">15372</span>&#160;                $fontsize = $style[<span class="stringliteral">&#39;fontsize&#39;</span>];</div>
<div class="line"><a name="l15373"></a><span class="lineno">15373</span>&#160;            }</div>
<div class="line"><a name="l15374"></a><span class="lineno">15374</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#afd56e360c43553830d543323e81bc045">SetFont</a>($style[<span class="stringliteral">&#39;font&#39;</span>], <span class="stringliteral">&#39;&#39;</span>, $fontsize);</div>
<div class="line"><a name="l15375"></a><span class="lineno">15375</span>&#160;        }</div>
<div class="line"><a name="l15376"></a><span class="lineno">15376</span>&#160;        <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;stretchtext&#39;</span>])) {</div>
<div class="line"><a name="l15377"></a><span class="lineno">15377</span>&#160;            $style[<span class="stringliteral">&#39;stretchtext&#39;</span>] = 4;</div>
<div class="line"><a name="l15378"></a><span class="lineno">15378</span>&#160;        }</div>
<div class="line"><a name="l15379"></a><span class="lineno">15379</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> === <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l15380"></a><span class="lineno">15380</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$this-&gt;x</a>;</div>
<div class="line"><a name="l15381"></a><span class="lineno">15381</span>&#160;        }</div>
<div class="line"><a name="l15382"></a><span class="lineno">15382</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> === <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l15383"></a><span class="lineno">15383</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l15384"></a><span class="lineno">15384</span>&#160;        }</div>
<div class="line"><a name="l15385"></a><span class="lineno">15385</span>&#160;        <span class="comment">// check page for no-write regions and adapt page margins if necessary</span></div>
<div class="line"><a name="l15386"></a><span class="lineno">15386</span>&#160;        list(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>) = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1d99e81697a90efb13a6734001427f40">checkPageRegions</a>(<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>);</div>
<div class="line"><a name="l15387"></a><span class="lineno">15387</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> === <span class="stringliteral">&#39;&#39;</span>) OR (<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> &lt;= 0)) {</div>
<div class="line"><a name="l15388"></a><span class="lineno">15388</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l15389"></a><span class="lineno">15389</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> - <a class="code" href="../../d4/d40/classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da">$this-&gt;lMargin</a>;</div>
<div class="line"><a name="l15390"></a><span class="lineno">15390</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l15391"></a><span class="lineno">15391</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = $this-&gt;w - $this-&gt;rMargin - <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>;</div>
<div class="line"><a name="l15392"></a><span class="lineno">15392</span>&#160;            }</div>
<div class="line"><a name="l15393"></a><span class="lineno">15393</span>&#160;        }</div>
<div class="line"><a name="l15394"></a><span class="lineno">15394</span>&#160;        <span class="comment">// padding</span></div>
<div class="line"><a name="l15395"></a><span class="lineno">15395</span>&#160;        <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;padding&#39;</span>])) {</div>
<div class="line"><a name="l15396"></a><span class="lineno">15396</span>&#160;            $padding = 0;</div>
<div class="line"><a name="l15397"></a><span class="lineno">15397</span>&#160;        } elseif ($style[<span class="stringliteral">&#39;padding&#39;</span>] === <span class="stringliteral">&#39;auto&#39;</span>) {</div>
<div class="line"><a name="l15398"></a><span class="lineno">15398</span>&#160;            $padding = 10 * (<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> / ($arrcode[<span class="stringliteral">&#39;maxw&#39;</span>] + 20));</div>
<div class="line"><a name="l15399"></a><span class="lineno">15399</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l15400"></a><span class="lineno">15400</span>&#160;            $padding = floatval($style[<span class="stringliteral">&#39;padding&#39;</span>]);</div>
<div class="line"><a name="l15401"></a><span class="lineno">15401</span>&#160;        }</div>
<div class="line"><a name="l15402"></a><span class="lineno">15402</span>&#160;        <span class="comment">// horizontal padding</span></div>
<div class="line"><a name="l15403"></a><span class="lineno">15403</span>&#160;        <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;hpadding&#39;</span>])) {</div>
<div class="line"><a name="l15404"></a><span class="lineno">15404</span>&#160;            $hpadding = $padding;</div>
<div class="line"><a name="l15405"></a><span class="lineno">15405</span>&#160;        } elseif ($style[<span class="stringliteral">&#39;hpadding&#39;</span>] === <span class="stringliteral">&#39;auto&#39;</span>) {</div>
<div class="line"><a name="l15406"></a><span class="lineno">15406</span>&#160;            $hpadding = 10 * (<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> / ($arrcode[<span class="stringliteral">&#39;maxw&#39;</span>] + 20));</div>
<div class="line"><a name="l15407"></a><span class="lineno">15407</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l15408"></a><span class="lineno">15408</span>&#160;            $hpadding = floatval($style[<span class="stringliteral">&#39;hpadding&#39;</span>]);</div>
<div class="line"><a name="l15409"></a><span class="lineno">15409</span>&#160;        }</div>
<div class="line"><a name="l15410"></a><span class="lineno">15410</span>&#160;        <span class="comment">// vertical padding</span></div>
<div class="line"><a name="l15411"></a><span class="lineno">15411</span>&#160;        <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;vpadding&#39;</span>])) {</div>
<div class="line"><a name="l15412"></a><span class="lineno">15412</span>&#160;            $vpadding = $padding;</div>
<div class="line"><a name="l15413"></a><span class="lineno">15413</span>&#160;        } elseif ($style[<span class="stringliteral">&#39;vpadding&#39;</span>] === <span class="stringliteral">&#39;auto&#39;</span>) {</div>
<div class="line"><a name="l15414"></a><span class="lineno">15414</span>&#160;            $vpadding = ($hpadding / 2);</div>
<div class="line"><a name="l15415"></a><span class="lineno">15415</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l15416"></a><span class="lineno">15416</span>&#160;            $vpadding = floatval($style[<span class="stringliteral">&#39;vpadding&#39;</span>]);</div>
<div class="line"><a name="l15417"></a><span class="lineno">15417</span>&#160;        }</div>
<div class="line"><a name="l15418"></a><span class="lineno">15418</span>&#160;        <span class="comment">// calculate xres (single bar width)</span></div>
<div class="line"><a name="l15419"></a><span class="lineno">15419</span>&#160;        $max_xres = (<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> - (2 * $hpadding)) / $arrcode[<span class="stringliteral">&#39;maxw&#39;</span>];</div>
<div class="line"><a name="l15420"></a><span class="lineno">15420</span>&#160;        <span class="keywordflow">if</span> ($style[<span class="stringliteral">&#39;stretch&#39;</span>]) {</div>
<div class="line"><a name="l15421"></a><span class="lineno">15421</span>&#160;            $xres = $max_xres;</div>
<div class="line"><a name="l15422"></a><span class="lineno">15422</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l15423"></a><span class="lineno">15423</span>&#160;            <span class="keywordflow">if</span> (TCPDF_STATIC::empty_string($xres)) {</div>
<div class="line"><a name="l15424"></a><span class="lineno">15424</span>&#160;                $xres = (0.141 * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>); <span class="comment">// default bar width = 0.4 mm</span></div>
<div class="line"><a name="l15425"></a><span class="lineno">15425</span>&#160;            }</div>
<div class="line"><a name="l15426"></a><span class="lineno">15426</span>&#160;            <span class="keywordflow">if</span> ($xres &gt; $max_xres) {</div>
<div class="line"><a name="l15427"></a><span class="lineno">15427</span>&#160;                <span class="comment">// correct xres to fit on $w</span></div>
<div class="line"><a name="l15428"></a><span class="lineno">15428</span>&#160;                $xres = $max_xres;</div>
<div class="line"><a name="l15429"></a><span class="lineno">15429</span>&#160;            }</div>
<div class="line"><a name="l15430"></a><span class="lineno">15430</span>&#160;            <span class="keywordflow">if</span> ((isset($style[<span class="stringliteral">&#39;padding&#39;</span>]) AND ($style[<span class="stringliteral">&#39;padding&#39;</span>] === <span class="stringliteral">&#39;auto&#39;</span>))</div>
<div class="line"><a name="l15431"></a><span class="lineno">15431</span>&#160;                OR (isset($style[<span class="stringliteral">&#39;hpadding&#39;</span>]) AND ($style[<span class="stringliteral">&#39;hpadding&#39;</span>] === <span class="stringliteral">&#39;auto&#39;</span>))) {</div>
<div class="line"><a name="l15432"></a><span class="lineno">15432</span>&#160;                $hpadding = 10 * $xres;</div>
<div class="line"><a name="l15433"></a><span class="lineno">15433</span>&#160;                <span class="keywordflow">if</span> (isset($style[<span class="stringliteral">&#39;vpadding&#39;</span>]) AND ($style[<span class="stringliteral">&#39;vpadding&#39;</span>] === <span class="stringliteral">&#39;auto&#39;</span>)) {</div>
<div class="line"><a name="l15434"></a><span class="lineno">15434</span>&#160;                    $vpadding = ($hpadding / 2);</div>
<div class="line"><a name="l15435"></a><span class="lineno">15435</span>&#160;                }</div>
<div class="line"><a name="l15436"></a><span class="lineno">15436</span>&#160;            }</div>
<div class="line"><a name="l15437"></a><span class="lineno">15437</span>&#160;        }</div>
<div class="line"><a name="l15438"></a><span class="lineno">15438</span>&#160;        <span class="keywordflow">if</span> ($style[<span class="stringliteral">&#39;fitwidth&#39;</span>]) {</div>
<div class="line"><a name="l15439"></a><span class="lineno">15439</span>&#160;            $wold = <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>;</div>
<div class="line"><a name="l15440"></a><span class="lineno">15440</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = (($arrcode[<span class="stringliteral">&#39;maxw&#39;</span>] * $xres) + (2 * $hpadding));</div>
<div class="line"><a name="l15441"></a><span class="lineno">15441</span>&#160;            <span class="keywordflow">if</span> (isset($style[<span class="stringliteral">&#39;cellfitalign&#39;</span>])) {</div>
<div class="line"><a name="l15442"></a><span class="lineno">15442</span>&#160;                <span class="keywordflow">switch</span> ($style[<span class="stringliteral">&#39;cellfitalign&#39;</span>]) {</div>
<div class="line"><a name="l15443"></a><span class="lineno">15443</span>&#160;                    <span class="keywordflow">case</span> <span class="charliteral">&#39;L&#39;</span>: {</div>
<div class="line"><a name="l15444"></a><span class="lineno">15444</span>&#160;                        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l15445"></a><span class="lineno">15445</span>&#160;                            <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> -= ($wold - <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>);</div>
<div class="line"><a name="l15446"></a><span class="lineno">15446</span>&#160;                        }</div>
<div class="line"><a name="l15447"></a><span class="lineno">15447</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l15448"></a><span class="lineno">15448</span>&#160;                    }</div>
<div class="line"><a name="l15449"></a><span class="lineno">15449</span>&#160;                    <span class="keywordflow">case</span> <span class="charliteral">&#39;R&#39;</span>: {</div>
<div class="line"><a name="l15450"></a><span class="lineno">15450</span>&#160;                        <span class="keywordflow">if</span> (!$this-&gt;rtl) {</div>
<div class="line"><a name="l15451"></a><span class="lineno">15451</span>&#160;                            <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> += ($wold - <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>);</div>
<div class="line"><a name="l15452"></a><span class="lineno">15452</span>&#160;                        }</div>
<div class="line"><a name="l15453"></a><span class="lineno">15453</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l15454"></a><span class="lineno">15454</span>&#160;                    }</div>
<div class="line"><a name="l15455"></a><span class="lineno">15455</span>&#160;                    <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>: {</div>
<div class="line"><a name="l15456"></a><span class="lineno">15456</span>&#160;                        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l15457"></a><span class="lineno">15457</span>&#160;                            <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> -= (($wold - <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>) / 2);</div>
<div class="line"><a name="l15458"></a><span class="lineno">15458</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l15459"></a><span class="lineno">15459</span>&#160;                            <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> += (($wold - <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>) / 2);</div>
<div class="line"><a name="l15460"></a><span class="lineno">15460</span>&#160;                        }</div>
<div class="line"><a name="l15461"></a><span class="lineno">15461</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l15462"></a><span class="lineno">15462</span>&#160;                    }</div>
<div class="line"><a name="l15463"></a><span class="lineno">15463</span>&#160;                    <span class="keywordflow">default</span> : {</div>
<div class="line"><a name="l15464"></a><span class="lineno">15464</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l15465"></a><span class="lineno">15465</span>&#160;                    }</div>
<div class="line"><a name="l15466"></a><span class="lineno">15466</span>&#160;                }</div>
<div class="line"><a name="l15467"></a><span class="lineno">15467</span>&#160;            }</div>
<div class="line"><a name="l15468"></a><span class="lineno">15468</span>&#160;        }</div>
<div class="line"><a name="l15469"></a><span class="lineno">15469</span>&#160;        $text_height = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a25c7f71b3fcb19024497ea620f885346">getCellHeight</a>($fontsize / $this-&gt;k);</div>
<div class="line"><a name="l15470"></a><span class="lineno">15470</span>&#160;        <span class="comment">// height</span></div>
<div class="line"><a name="l15471"></a><span class="lineno">15471</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> === <span class="stringliteral">&#39;&#39;</span>) OR (<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> &lt;= 0)) {</div>
<div class="line"><a name="l15472"></a><span class="lineno">15472</span>&#160;            <span class="comment">// set default height</span></div>
<div class="line"><a name="l15473"></a><span class="lineno">15473</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> = (($arrcode[<span class="stringliteral">&#39;maxw&#39;</span>] * $xres) / 3) + (2 * $vpadding) + $text_height;</div>
<div class="line"><a name="l15474"></a><span class="lineno">15474</span>&#160;        }</div>
<div class="line"><a name="l15475"></a><span class="lineno">15475</span>&#160;        $barh = <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> - $text_height - (2 * $vpadding);</div>
<div class="line"><a name="l15476"></a><span class="lineno">15476</span>&#160;        <span class="keywordflow">if</span> ($barh &lt;=0) {</div>
<div class="line"><a name="l15477"></a><span class="lineno">15477</span>&#160;            <span class="comment">// try to reduce font or padding to fit barcode on available height</span></div>
<div class="line"><a name="l15478"></a><span class="lineno">15478</span>&#160;            <span class="keywordflow">if</span> ($text_height &gt; <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>) {</div>
<div class="line"><a name="l15479"></a><span class="lineno">15479</span>&#160;                $fontsize = ((<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>) / (4 * $this-&gt;cell_height_ratio));</div>
<div class="line"><a name="l15480"></a><span class="lineno">15480</span>&#160;                $text_height = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a25c7f71b3fcb19024497ea620f885346">getCellHeight</a>($fontsize / $this-&gt;k);</div>
<div class="line"><a name="l15481"></a><span class="lineno">15481</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#afd56e360c43553830d543323e81bc045">SetFont</a>($style[<span class="stringliteral">&#39;font&#39;</span>], <span class="stringliteral">&#39;&#39;</span>, $fontsize);</div>
<div class="line"><a name="l15482"></a><span class="lineno">15482</span>&#160;            }</div>
<div class="line"><a name="l15483"></a><span class="lineno">15483</span>&#160;            <span class="keywordflow">if</span> ($vpadding &gt; 0) {</div>
<div class="line"><a name="l15484"></a><span class="lineno">15484</span>&#160;                $vpadding = ((<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> - $text_height) / 4);</div>
<div class="line"><a name="l15485"></a><span class="lineno">15485</span>&#160;            }</div>
<div class="line"><a name="l15486"></a><span class="lineno">15486</span>&#160;            $barh = <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> - $text_height - (2 * $vpadding);</div>
<div class="line"><a name="l15487"></a><span class="lineno">15487</span>&#160;        }</div>
<div class="line"><a name="l15488"></a><span class="lineno">15488</span>&#160;        <span class="comment">// fit the barcode on available space</span></div>
<div class="line"><a name="l15489"></a><span class="lineno">15489</span>&#160;        list(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>) = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af1db92d221fd87c76d7c607f32266d0a">fitBlock</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l15490"></a><span class="lineno">15490</span>&#160;        <span class="comment">// set alignment</span></div>
<div class="line"><a name="l15491"></a><span class="lineno">15491</span>&#160;        $this-&gt;img_rb_y = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> + <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>;</div>
<div class="line"><a name="l15492"></a><span class="lineno">15492</span>&#160;        <span class="comment">// set alignment</span></div>
<div class="line"><a name="l15493"></a><span class="lineno">15493</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l15494"></a><span class="lineno">15494</span>&#160;            <span class="keywordflow">if</span> ($style[<span class="stringliteral">&#39;position&#39;</span>] == <span class="charliteral">&#39;L&#39;</span>) {</div>
<div class="line"><a name="l15495"></a><span class="lineno">15495</span>&#160;                $xpos = <a class="code" href="../../d4/d40/classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da">$this-&gt;lMargin</a>;</div>
<div class="line"><a name="l15496"></a><span class="lineno">15496</span>&#160;            } elseif ($style[<span class="stringliteral">&#39;position&#39;</span>] == <span class="charliteral">&#39;C&#39;</span>) {</div>
<div class="line"><a name="l15497"></a><span class="lineno">15497</span>&#160;                $xpos = ($this-&gt;w + $this-&gt;lMargin - $this-&gt;rMargin - <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>) / 2;</div>
<div class="line"><a name="l15498"></a><span class="lineno">15498</span>&#160;            } elseif ($style[<span class="stringliteral">&#39;position&#39;</span>] == <span class="charliteral">&#39;R&#39;</span>) {</div>
<div class="line"><a name="l15499"></a><span class="lineno">15499</span>&#160;                $xpos = $this-&gt;w - $this-&gt;rMargin - <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>;</div>
<div class="line"><a name="l15500"></a><span class="lineno">15500</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l15501"></a><span class="lineno">15501</span>&#160;                $xpos = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> - <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>;</div>
<div class="line"><a name="l15502"></a><span class="lineno">15502</span>&#160;            }</div>
<div class="line"><a name="l15503"></a><span class="lineno">15503</span>&#160;            $this-&gt;img_rb_x = $xpos;</div>
<div class="line"><a name="l15504"></a><span class="lineno">15504</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l15505"></a><span class="lineno">15505</span>&#160;            <span class="keywordflow">if</span> ($style[<span class="stringliteral">&#39;position&#39;</span>] == <span class="charliteral">&#39;L&#39;</span>) {</div>
<div class="line"><a name="l15506"></a><span class="lineno">15506</span>&#160;                $xpos = <a class="code" href="../../d4/d40/classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da">$this-&gt;lMargin</a>;</div>
<div class="line"><a name="l15507"></a><span class="lineno">15507</span>&#160;            } elseif ($style[<span class="stringliteral">&#39;position&#39;</span>] == <span class="charliteral">&#39;C&#39;</span>) {</div>
<div class="line"><a name="l15508"></a><span class="lineno">15508</span>&#160;                $xpos = ($this-&gt;w + $this-&gt;lMargin - $this-&gt;rMargin - <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>) / 2;</div>
<div class="line"><a name="l15509"></a><span class="lineno">15509</span>&#160;            } elseif ($style[<span class="stringliteral">&#39;position&#39;</span>] == <span class="charliteral">&#39;R&#39;</span>) {</div>
<div class="line"><a name="l15510"></a><span class="lineno">15510</span>&#160;                $xpos = $this-&gt;w - $this-&gt;rMargin - <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>;</div>
<div class="line"><a name="l15511"></a><span class="lineno">15511</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l15512"></a><span class="lineno">15512</span>&#160;                $xpos = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>;</div>
<div class="line"><a name="l15513"></a><span class="lineno">15513</span>&#160;            }</div>
<div class="line"><a name="l15514"></a><span class="lineno">15514</span>&#160;            $this-&gt;img_rb_x = $xpos + <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>;</div>
<div class="line"><a name="l15515"></a><span class="lineno">15515</span>&#160;        }</div>
<div class="line"><a name="l15516"></a><span class="lineno">15516</span>&#160;        $xpos_rect = $xpos;</div>
<div class="line"><a name="l15517"></a><span class="lineno">15517</span>&#160;        <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;align&#39;</span>])) {</div>
<div class="line"><a name="l15518"></a><span class="lineno">15518</span>&#160;            $style[<span class="stringliteral">&#39;align&#39;</span>] = <span class="charliteral">&#39;C&#39;</span>;</div>
<div class="line"><a name="l15519"></a><span class="lineno">15519</span>&#160;        }</div>
<div class="line"><a name="l15520"></a><span class="lineno">15520</span>&#160;        <span class="keywordflow">switch</span> ($style[<span class="stringliteral">&#39;align&#39;</span>]) {</div>
<div class="line"><a name="l15521"></a><span class="lineno">15521</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;L&#39;</span>: {</div>
<div class="line"><a name="l15522"></a><span class="lineno">15522</span>&#160;                $xpos = $xpos_rect + $hpadding;</div>
<div class="line"><a name="l15523"></a><span class="lineno">15523</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l15524"></a><span class="lineno">15524</span>&#160;            }</div>
<div class="line"><a name="l15525"></a><span class="lineno">15525</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;R&#39;</span>: {</div>
<div class="line"><a name="l15526"></a><span class="lineno">15526</span>&#160;                $xpos = $xpos_rect + (<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> - ($arrcode[<span class="stringliteral">&#39;maxw&#39;</span>] * $xres)) - $hpadding;</div>
<div class="line"><a name="l15527"></a><span class="lineno">15527</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l15528"></a><span class="lineno">15528</span>&#160;            }</div>
<div class="line"><a name="l15529"></a><span class="lineno">15529</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>:</div>
<div class="line"><a name="l15530"></a><span class="lineno">15530</span>&#160;            <span class="keywordflow">default</span> : {</div>
<div class="line"><a name="l15531"></a><span class="lineno">15531</span>&#160;                $xpos = $xpos_rect + ((<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> - ($arrcode[<span class="stringliteral">&#39;maxw&#39;</span>] * $xres)) / 2);</div>
<div class="line"><a name="l15532"></a><span class="lineno">15532</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l15533"></a><span class="lineno">15533</span>&#160;            }</div>
<div class="line"><a name="l15534"></a><span class="lineno">15534</span>&#160;        }</div>
<div class="line"><a name="l15535"></a><span class="lineno">15535</span>&#160;        $xpos_text = $xpos;</div>
<div class="line"><a name="l15536"></a><span class="lineno">15536</span>&#160;        <span class="comment">// barcode is always printed in LTR direction</span></div>
<div class="line"><a name="l15537"></a><span class="lineno">15537</span>&#160;        $tempRTL = <a class="code" href="../../d4/d40/classTCPDF.html#a4ccd9d69e0839838b105328953794a40">$this-&gt;rtl</a>;</div>
<div class="line"><a name="l15538"></a><span class="lineno">15538</span>&#160;        $this-&gt;rtl = <span class="keyword">false</span>;</div>
<div class="line"><a name="l15539"></a><span class="lineno">15539</span>&#160;        <span class="comment">// print background color</span></div>
<div class="line"><a name="l15540"></a><span class="lineno">15540</span>&#160;        <span class="keywordflow">if</span> ($style[<span class="stringliteral">&#39;bgcolor&#39;</span>]) {</div>
<div class="line"><a name="l15541"></a><span class="lineno">15541</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8fc7b86c255aeb0f14d281bdaeb2015c">Rect</a>($xpos_rect, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, $h, $style[<span class="stringliteral">&#39;border&#39;</span>] ? <span class="stringliteral">&#39;DF&#39;</span> : <span class="charliteral">&#39;F&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $style[<span class="stringliteral">&#39;bgcolor&#39;</span>]);</div>
<div class="line"><a name="l15542"></a><span class="lineno">15542</span>&#160;        } elseif ($style[<span class="stringliteral">&#39;border&#39;</span>]) {</div>
<div class="line"><a name="l15543"></a><span class="lineno">15543</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8fc7b86c255aeb0f14d281bdaeb2015c">Rect</a>($xpos_rect, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, $h, <span class="charliteral">&#39;D&#39;</span>);</div>
<div class="line"><a name="l15544"></a><span class="lineno">15544</span>&#160;        }</div>
<div class="line"><a name="l15545"></a><span class="lineno">15545</span>&#160;        <span class="comment">// set foreground color</span></div>
<div class="line"><a name="l15546"></a><span class="lineno">15546</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8f3481f3ce8a4fcd40ac1e1a6bd8960e">SetDrawColorArray</a>($style[<span class="stringliteral">&#39;fgcolor&#39;</span>]);</div>
<div class="line"><a name="l15547"></a><span class="lineno">15547</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ae6e2854e4d5c71966ef5121934c24566">SetTextColorArray</a>($style[<span class="stringliteral">&#39;fgcolor&#39;</span>]);</div>
<div class="line"><a name="l15548"></a><span class="lineno">15548</span>&#160;        <span class="comment">// print bars</span></div>
<div class="line"><a name="l15549"></a><span class="lineno">15549</span>&#160;        <span class="keywordflow">foreach</span> ($arrcode[<span class="stringliteral">&#39;bcode&#39;</span>] as <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a> =&gt; $v) {</div>
<div class="line"><a name="l15550"></a><span class="lineno">15550</span>&#160;            $bw = ($v[<span class="charliteral">&#39;w&#39;</span>] * $xres);</div>
<div class="line"><a name="l15551"></a><span class="lineno">15551</span>&#160;            <span class="keywordflow">if</span> ($v[<span class="charliteral">&#39;t&#39;</span>]) {</div>
<div class="line"><a name="l15552"></a><span class="lineno">15552</span>&#160;                <span class="comment">// draw a vertical bar</span></div>
<div class="line"><a name="l15553"></a><span class="lineno">15553</span>&#160;                $ypos = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> + $vpadding + ($v[<span class="charliteral">&#39;p&#39;</span>] * $barh / $arrcode[<span class="stringliteral">&#39;maxh&#39;</span>]);</div>
<div class="line"><a name="l15554"></a><span class="lineno">15554</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8fc7b86c255aeb0f14d281bdaeb2015c">Rect</a>($xpos, $ypos, $bw, ($v[<span class="charliteral">&#39;h&#39;</span>] * $barh / $arrcode[<span class="stringliteral">&#39;maxh&#39;</span>]), <span class="charliteral">&#39;F&#39;</span>, array(), $style[<span class="stringliteral">&#39;fgcolor&#39;</span>]);</div>
<div class="line"><a name="l15555"></a><span class="lineno">15555</span>&#160;            }</div>
<div class="line"><a name="l15556"></a><span class="lineno">15556</span>&#160;            $xpos += $bw;</div>
<div class="line"><a name="l15557"></a><span class="lineno">15557</span>&#160;        }</div>
<div class="line"><a name="l15558"></a><span class="lineno">15558</span>&#160;        <span class="comment">// print text</span></div>
<div class="line"><a name="l15559"></a><span class="lineno">15559</span>&#160;        <span class="keywordflow">if</span> ($style[<span class="stringliteral">&#39;text&#39;</span>]) {</div>
<div class="line"><a name="l15560"></a><span class="lineno">15560</span>&#160;            <span class="keywordflow">if</span> (isset($style[<span class="stringliteral">&#39;label&#39;</span>]) AND !TCPDF_STATIC::empty_string($style[<span class="stringliteral">&#39;label&#39;</span>])) {</div>
<div class="line"><a name="l15561"></a><span class="lineno">15561</span>&#160;                $label = $style[<span class="stringliteral">&#39;label&#39;</span>];</div>
<div class="line"><a name="l15562"></a><span class="lineno">15562</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l15563"></a><span class="lineno">15563</span>&#160;                $label = $code;</div>
<div class="line"><a name="l15564"></a><span class="lineno">15564</span>&#160;            }</div>
<div class="line"><a name="l15565"></a><span class="lineno">15565</span>&#160;            $txtwidth = ($arrcode[<span class="stringliteral">&#39;maxw&#39;</span>] * $xres);</div>
<div class="line"><a name="l15566"></a><span class="lineno">15566</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8075c1f04b6fbddc957cff786c4b16d9">GetStringWidth</a>($label) &gt; $txtwidth) {</div>
<div class="line"><a name="l15567"></a><span class="lineno">15567</span>&#160;                $style[<span class="stringliteral">&#39;stretchtext&#39;</span>] = 2;</div>
<div class="line"><a name="l15568"></a><span class="lineno">15568</span>&#160;            }</div>
<div class="line"><a name="l15569"></a><span class="lineno">15569</span>&#160;            <span class="comment">// print text</span></div>
<div class="line"><a name="l15570"></a><span class="lineno">15570</span>&#160;            $this-&gt;x = $xpos_text;</div>
<div class="line"><a name="l15571"></a><span class="lineno">15571</span>&#160;            $this-&gt;y = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> + $vpadding + $barh;</div>
<div class="line"><a name="l15572"></a><span class="lineno">15572</span>&#160;            $cellpadding = <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$this-&gt;cell_padding</a>;</div>
<div class="line"><a name="l15573"></a><span class="lineno">15573</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a374b24751bf76e4ca5ba7694f87ec2c1">SetCellPadding</a>(0);</div>
<div class="line"><a name="l15574"></a><span class="lineno">15574</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a33b265e5eb3e4d1d4fedfe29f8166f31">Cell</a>($txtwidth, <span class="stringliteral">&#39;&#39;</span>, $label, 0, 0, <span class="charliteral">&#39;C&#39;</span>, <span class="keyword">false</span>, <span class="stringliteral">&#39;&#39;</span>, $style[<span class="stringliteral">&#39;stretchtext&#39;</span>], <span class="keyword">false</span>, <span class="charliteral">&#39;T&#39;</span>, <span class="charliteral">&#39;T&#39;</span>);</div>
<div class="line"><a name="l15575"></a><span class="lineno">15575</span>&#160;            $this-&gt;cell_padding = $cellpadding;</div>
<div class="line"><a name="l15576"></a><span class="lineno">15576</span>&#160;        }</div>
<div class="line"><a name="l15577"></a><span class="lineno">15577</span>&#160;        <span class="comment">// restore original direction</span></div>
<div class="line"><a name="l15578"></a><span class="lineno">15578</span>&#160;        $this-&gt;rtl = $tempRTL;</div>
<div class="line"><a name="l15579"></a><span class="lineno">15579</span>&#160;        <span class="comment">// restore previous settings</span></div>
<div class="line"><a name="l15580"></a><span class="lineno">15580</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a072053646725b19770a795050b3b6221">setGraphicVars</a>($gvars);</div>
<div class="line"><a name="l15581"></a><span class="lineno">15581</span>&#160;        <span class="comment">// set pointer to align the next text/objects</span></div>
<div class="line"><a name="l15582"></a><span class="lineno">15582</span>&#160;        <span class="keywordflow">switch</span>($align) {</div>
<div class="line"><a name="l15583"></a><span class="lineno">15583</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>:{</div>
<div class="line"><a name="l15584"></a><span class="lineno">15584</span>&#160;                $this-&gt;y = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>;</div>
<div class="line"><a name="l15585"></a><span class="lineno">15585</span>&#160;                $this-&gt;x = <a class="code" href="../../d4/d40/classTCPDF.html#ace8e68000d6185a28a180bbe4531b428">$this-&gt;img_rb_x</a>;</div>
<div class="line"><a name="l15586"></a><span class="lineno">15586</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l15587"></a><span class="lineno">15587</span>&#160;            }</div>
<div class="line"><a name="l15588"></a><span class="lineno">15588</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;M&#39;</span>:{</div>
<div class="line"><a name="l15589"></a><span class="lineno">15589</span>&#160;                $this-&gt;y = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> + round($h / 2);</div>
<div class="line"><a name="l15590"></a><span class="lineno">15590</span>&#160;                $this-&gt;x = <a class="code" href="../../d4/d40/classTCPDF.html#ace8e68000d6185a28a180bbe4531b428">$this-&gt;img_rb_x</a>;</div>
<div class="line"><a name="l15591"></a><span class="lineno">15591</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l15592"></a><span class="lineno">15592</span>&#160;            }</div>
<div class="line"><a name="l15593"></a><span class="lineno">15593</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>:{</div>
<div class="line"><a name="l15594"></a><span class="lineno">15594</span>&#160;                $this-&gt;y = <a class="code" href="../../d4/d40/classTCPDF.html#abc05496cf88772b492f67e87c53121d0">$this-&gt;img_rb_y</a>;</div>
<div class="line"><a name="l15595"></a><span class="lineno">15595</span>&#160;                $this-&gt;x = <a class="code" href="../../d4/d40/classTCPDF.html#ace8e68000d6185a28a180bbe4531b428">$this-&gt;img_rb_x</a>;</div>
<div class="line"><a name="l15596"></a><span class="lineno">15596</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l15597"></a><span class="lineno">15597</span>&#160;            }</div>
<div class="line"><a name="l15598"></a><span class="lineno">15598</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;N&#39;</span>:{</div>
<div class="line"><a name="l15599"></a><span class="lineno">15599</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ad3439990de56253b039bca6a09305758">SetY</a>($this-&gt;img_rb_y);</div>
<div class="line"><a name="l15600"></a><span class="lineno">15600</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l15601"></a><span class="lineno">15601</span>&#160;            }</div>
<div class="line"><a name="l15602"></a><span class="lineno">15602</span>&#160;            <span class="keywordflow">default</span>:{</div>
<div class="line"><a name="l15603"></a><span class="lineno">15603</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l15604"></a><span class="lineno">15604</span>&#160;            }</div>
<div class="line"><a name="l15605"></a><span class="lineno">15605</span>&#160;        }</div>
<div class="line"><a name="l15606"></a><span class="lineno">15606</span>&#160;        $this-&gt;endlinex = <a class="code" href="../../d4/d40/classTCPDF.html#ace8e68000d6185a28a180bbe4531b428">$this-&gt;img_rb_x</a>;</div>
<div class="line"><a name="l15607"></a><span class="lineno">15607</span>&#160;    }</div>
<div class="line"><a name="l15608"></a><span class="lineno">15608</span>&#160;</div>
<div class="line"><a name="l15634"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#afddb62386f44b3011c9e4a8ed1d90517">15634</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#afddb62386f44b3011c9e4a8ed1d90517">write2DBarcode</a>($code, $type, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>=<span class="stringliteral">&#39;&#39;</span>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>=<span class="stringliteral">&#39;&#39;</span>, $style=<span class="stringliteral">&#39;&#39;</span>, $align=<span class="stringliteral">&#39;&#39;</span>, $distort=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l15635"></a><span class="lineno">15635</span>&#160;        <span class="keywordflow">if</span> (TCPDF_STATIC::empty_string(trim($code))) {</div>
<div class="line"><a name="l15636"></a><span class="lineno">15636</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l15637"></a><span class="lineno">15637</span>&#160;        }</div>
<div class="line"><a name="l15638"></a><span class="lineno">15638</span>&#160;        require_once(dirname(__FILE__).<span class="stringliteral">&#39;/tcpdf_barcodes_2d.php&#39;</span>);</div>
<div class="line"><a name="l15639"></a><span class="lineno">15639</span>&#160;        <span class="comment">// save current graphic settings</span></div>
<div class="line"><a name="l15640"></a><span class="lineno">15640</span>&#160;        $gvars = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a24d3c102468b6ab9d2f4859a8b01863a">getGraphicVars</a>();</div>
<div class="line"><a name="l15641"></a><span class="lineno">15641</span>&#160;        <span class="comment">// create new barcode object</span></div>
<div class="line"><a name="l15642"></a><span class="lineno">15642</span>&#160;        $barcodeobj = <span class="keyword">new</span> <a class="code" href="../../d5/d90/classTCPDF2DBarcode.html">TCPDF2DBarcode</a>($code, $type);</div>
<div class="line"><a name="l15643"></a><span class="lineno">15643</span>&#160;        $arrcode = $barcodeobj-&gt;getBarcodeArray();</div>
<div class="line"><a name="l15644"></a><span class="lineno">15644</span>&#160;        <span class="keywordflow">if</span> (($arrcode === <span class="keyword">false</span>) OR empty($arrcode) OR !isset($arrcode[<span class="stringliteral">&#39;num_rows&#39;</span>]) OR ($arrcode[<span class="stringliteral">&#39;num_rows&#39;</span>] == 0) OR !isset($arrcode[<span class="stringliteral">&#39;num_cols&#39;</span>]) OR ($arrcode[<span class="stringliteral">&#39;num_cols&#39;</span>] == 0)) {</div>
<div class="line"><a name="l15645"></a><span class="lineno">15645</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;Error in 2D barcode string&#39;</span>);</div>
<div class="line"><a name="l15646"></a><span class="lineno">15646</span>&#160;        }</div>
<div class="line"><a name="l15647"></a><span class="lineno">15647</span>&#160;        <span class="comment">// set default values</span></div>
<div class="line"><a name="l15648"></a><span class="lineno">15648</span>&#160;        <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;position&#39;</span>])) {</div>
<div class="line"><a name="l15649"></a><span class="lineno">15649</span>&#160;            $style[<span class="stringliteral">&#39;position&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l15650"></a><span class="lineno">15650</span>&#160;        }</div>
<div class="line"><a name="l15651"></a><span class="lineno">15651</span>&#160;        <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;fgcolor&#39;</span>])) {</div>
<div class="line"><a name="l15652"></a><span class="lineno">15652</span>&#160;            $style[<span class="stringliteral">&#39;fgcolor&#39;</span>] = array(0,0,0); <span class="comment">// default black</span></div>
<div class="line"><a name="l15653"></a><span class="lineno">15653</span>&#160;        }</div>
<div class="line"><a name="l15654"></a><span class="lineno">15654</span>&#160;        <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;bgcolor&#39;</span>])) {</div>
<div class="line"><a name="l15655"></a><span class="lineno">15655</span>&#160;            $style[<span class="stringliteral">&#39;bgcolor&#39;</span>] = <span class="keyword">false</span>; <span class="comment">// default transparent</span></div>
<div class="line"><a name="l15656"></a><span class="lineno">15656</span>&#160;        }</div>
<div class="line"><a name="l15657"></a><span class="lineno">15657</span>&#160;        <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;border&#39;</span>])) {</div>
<div class="line"><a name="l15658"></a><span class="lineno">15658</span>&#160;            $style[<span class="stringliteral">&#39;border&#39;</span>] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l15659"></a><span class="lineno">15659</span>&#160;        }</div>
<div class="line"><a name="l15660"></a><span class="lineno">15660</span>&#160;        <span class="comment">// padding</span></div>
<div class="line"><a name="l15661"></a><span class="lineno">15661</span>&#160;        <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;padding&#39;</span>])) {</div>
<div class="line"><a name="l15662"></a><span class="lineno">15662</span>&#160;            $style[<span class="stringliteral">&#39;padding&#39;</span>] = 0;</div>
<div class="line"><a name="l15663"></a><span class="lineno">15663</span>&#160;        } elseif ($style[<span class="stringliteral">&#39;padding&#39;</span>] === <span class="stringliteral">&#39;auto&#39;</span>) {</div>
<div class="line"><a name="l15664"></a><span class="lineno">15664</span>&#160;            $style[<span class="stringliteral">&#39;padding&#39;</span>] = 4;</div>
<div class="line"><a name="l15665"></a><span class="lineno">15665</span>&#160;        }</div>
<div class="line"><a name="l15666"></a><span class="lineno">15666</span>&#160;        <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;hpadding&#39;</span>])) {</div>
<div class="line"><a name="l15667"></a><span class="lineno">15667</span>&#160;            $style[<span class="stringliteral">&#39;hpadding&#39;</span>] = $style[<span class="stringliteral">&#39;padding&#39;</span>];</div>
<div class="line"><a name="l15668"></a><span class="lineno">15668</span>&#160;        } elseif ($style[<span class="stringliteral">&#39;hpadding&#39;</span>] === <span class="stringliteral">&#39;auto&#39;</span>) {</div>
<div class="line"><a name="l15669"></a><span class="lineno">15669</span>&#160;            $style[<span class="stringliteral">&#39;hpadding&#39;</span>] = 4;</div>
<div class="line"><a name="l15670"></a><span class="lineno">15670</span>&#160;        }</div>
<div class="line"><a name="l15671"></a><span class="lineno">15671</span>&#160;        <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;vpadding&#39;</span>])) {</div>
<div class="line"><a name="l15672"></a><span class="lineno">15672</span>&#160;            $style[<span class="stringliteral">&#39;vpadding&#39;</span>] = $style[<span class="stringliteral">&#39;padding&#39;</span>];</div>
<div class="line"><a name="l15673"></a><span class="lineno">15673</span>&#160;        } elseif ($style[<span class="stringliteral">&#39;vpadding&#39;</span>] === <span class="stringliteral">&#39;auto&#39;</span>) {</div>
<div class="line"><a name="l15674"></a><span class="lineno">15674</span>&#160;            $style[<span class="stringliteral">&#39;vpadding&#39;</span>] = 4;</div>
<div class="line"><a name="l15675"></a><span class="lineno">15675</span>&#160;        }</div>
<div class="line"><a name="l15676"></a><span class="lineno">15676</span>&#160;        $hpad = (2 * $style[<span class="stringliteral">&#39;hpadding&#39;</span>]);</div>
<div class="line"><a name="l15677"></a><span class="lineno">15677</span>&#160;        $vpad = (2 * $style[<span class="stringliteral">&#39;vpadding&#39;</span>]);</div>
<div class="line"><a name="l15678"></a><span class="lineno">15678</span>&#160;        <span class="comment">// cell (module) dimension</span></div>
<div class="line"><a name="l15679"></a><span class="lineno">15679</span>&#160;        <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;module_width&#39;</span>])) {</div>
<div class="line"><a name="l15680"></a><span class="lineno">15680</span>&#160;            $style[<span class="stringliteral">&#39;module_width&#39;</span>] = 1; <span class="comment">// width of a single module in points</span></div>
<div class="line"><a name="l15681"></a><span class="lineno">15681</span>&#160;        }</div>
<div class="line"><a name="l15682"></a><span class="lineno">15682</span>&#160;        <span class="keywordflow">if</span> (!isset($style[<span class="stringliteral">&#39;module_height&#39;</span>])) {</div>
<div class="line"><a name="l15683"></a><span class="lineno">15683</span>&#160;            $style[<span class="stringliteral">&#39;module_height&#39;</span>] = 1; <span class="comment">// height of a single module in points</span></div>
<div class="line"><a name="l15684"></a><span class="lineno">15684</span>&#160;        }</div>
<div class="line"><a name="l15685"></a><span class="lineno">15685</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> === <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l15686"></a><span class="lineno">15686</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$this-&gt;x</a>;</div>
<div class="line"><a name="l15687"></a><span class="lineno">15687</span>&#160;        }</div>
<div class="line"><a name="l15688"></a><span class="lineno">15688</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> === <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l15689"></a><span class="lineno">15689</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l15690"></a><span class="lineno">15690</span>&#160;        }</div>
<div class="line"><a name="l15691"></a><span class="lineno">15691</span>&#160;        <span class="comment">// check page for no-write regions and adapt page margins if necessary</span></div>
<div class="line"><a name="l15692"></a><span class="lineno">15692</span>&#160;        list(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>) = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1d99e81697a90efb13a6734001427f40">checkPageRegions</a>(<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>);</div>
<div class="line"><a name="l15693"></a><span class="lineno">15693</span>&#160;        <span class="comment">// number of barcode columns and rows</span></div>
<div class="line"><a name="l15694"></a><span class="lineno">15694</span>&#160;        $rows = $arrcode[<span class="stringliteral">&#39;num_rows&#39;</span>];</div>
<div class="line"><a name="l15695"></a><span class="lineno">15695</span>&#160;        $cols = $arrcode[<span class="stringliteral">&#39;num_cols&#39;</span>];</div>
<div class="line"><a name="l15696"></a><span class="lineno">15696</span>&#160;        <span class="keywordflow">if</span> (($rows &lt;= 0) || ($cols &lt;= 0)){</div>
<div class="line"><a name="l15697"></a><span class="lineno">15697</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;Error in 2D barcode string&#39;</span>);</div>
<div class="line"><a name="l15698"></a><span class="lineno">15698</span>&#160;        }</div>
<div class="line"><a name="l15699"></a><span class="lineno">15699</span>&#160;        <span class="comment">// module width and height</span></div>
<div class="line"><a name="l15700"></a><span class="lineno">15700</span>&#160;        $mw = $style[<span class="stringliteral">&#39;module_width&#39;</span>];</div>
<div class="line"><a name="l15701"></a><span class="lineno">15701</span>&#160;        $mh = $style[<span class="stringliteral">&#39;module_height&#39;</span>];</div>
<div class="line"><a name="l15702"></a><span class="lineno">15702</span>&#160;        <span class="keywordflow">if</span> (($mw &lt;= 0) OR ($mh &lt;= 0)) {</div>
<div class="line"><a name="l15703"></a><span class="lineno">15703</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;Error in 2D barcode string&#39;</span>);</div>
<div class="line"><a name="l15704"></a><span class="lineno">15704</span>&#160;        }</div>
<div class="line"><a name="l15705"></a><span class="lineno">15705</span>&#160;        <span class="comment">// get max dimensions</span></div>
<div class="line"><a name="l15706"></a><span class="lineno">15706</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l15707"></a><span class="lineno">15707</span>&#160;            $maxw = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> - <a class="code" href="../../d4/d40/classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da">$this-&gt;lMargin</a>;</div>
<div class="line"><a name="l15708"></a><span class="lineno">15708</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l15709"></a><span class="lineno">15709</span>&#160;            $maxw = $this-&gt;w - $this-&gt;rMargin - <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>;</div>
<div class="line"><a name="l15710"></a><span class="lineno">15710</span>&#160;        }</div>
<div class="line"><a name="l15711"></a><span class="lineno">15711</span>&#160;        $maxh = ($this-&gt;h - $this-&gt;tMargin - <a class="code" href="../../d4/d40/classTCPDF.html#acfe6c98519acb01dd53aa153c12bf79b">$this-&gt;bMargin</a>);</div>
<div class="line"><a name="l15712"></a><span class="lineno">15712</span>&#160;        $ratioHW = ((($rows * $mh) + $hpad) / (($cols * $mw) + $vpad));</div>
<div class="line"><a name="l15713"></a><span class="lineno">15713</span>&#160;        $ratioWH = ((($cols * $mw) + $vpad) / (($rows * $mh) + $hpad));</div>
<div class="line"><a name="l15714"></a><span class="lineno">15714</span>&#160;        <span class="keywordflow">if</span> (!$distort) {</div>
<div class="line"><a name="l15715"></a><span class="lineno">15715</span>&#160;            <span class="keywordflow">if</span> (($maxw * $ratioHW) &gt; $maxh) {</div>
<div class="line"><a name="l15716"></a><span class="lineno">15716</span>&#160;                $maxw = $maxh * $ratioWH;</div>
<div class="line"><a name="l15717"></a><span class="lineno">15717</span>&#160;            }</div>
<div class="line"><a name="l15718"></a><span class="lineno">15718</span>&#160;            <span class="keywordflow">if</span> (($maxh * $ratioWH) &gt; $maxw) {</div>
<div class="line"><a name="l15719"></a><span class="lineno">15719</span>&#160;                $maxh = $maxw * $ratioHW;</div>
<div class="line"><a name="l15720"></a><span class="lineno">15720</span>&#160;            }</div>
<div class="line"><a name="l15721"></a><span class="lineno">15721</span>&#160;        }</div>
<div class="line"><a name="l15722"></a><span class="lineno">15722</span>&#160;        <span class="comment">// set maximum dimesions</span></div>
<div class="line"><a name="l15723"></a><span class="lineno">15723</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> &gt; $maxw) {</div>
<div class="line"><a name="l15724"></a><span class="lineno">15724</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = $maxw;</div>
<div class="line"><a name="l15725"></a><span class="lineno">15725</span>&#160;        }</div>
<div class="line"><a name="l15726"></a><span class="lineno">15726</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> &gt; $maxh) {</div>
<div class="line"><a name="l15727"></a><span class="lineno">15727</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> = $maxh;</div>
<div class="line"><a name="l15728"></a><span class="lineno">15728</span>&#160;        }</div>
<div class="line"><a name="l15729"></a><span class="lineno">15729</span>&#160;        <span class="comment">// set dimensions</span></div>
<div class="line"><a name="l15730"></a><span class="lineno">15730</span>&#160;        <span class="keywordflow">if</span> (((<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> === <span class="stringliteral">&#39;&#39;</span>) OR (<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> &lt;= 0)) AND ((<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> === <span class="stringliteral">&#39;&#39;</span>) OR (<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> &lt;= 0))) {</div>
<div class="line"><a name="l15731"></a><span class="lineno">15731</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = ($cols + $hpad) * ($mw / $this-&gt;k);</div>
<div class="line"><a name="l15732"></a><span class="lineno">15732</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> = ($rows + $vpad) * ($mh / $this-&gt;k);</div>
<div class="line"><a name="l15733"></a><span class="lineno">15733</span>&#160;        } elseif ((<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> === <span class="stringliteral">&#39;&#39;</span>) OR (<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> &lt;= 0)) {</div>
<div class="line"><a name="l15734"></a><span class="lineno">15734</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> * $ratioWH;</div>
<div class="line"><a name="l15735"></a><span class="lineno">15735</span>&#160;        } elseif ((<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> === <span class="stringliteral">&#39;&#39;</span>) OR (<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> &lt;= 0)) {</div>
<div class="line"><a name="l15736"></a><span class="lineno">15736</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> = <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> * $ratioHW;</div>
<div class="line"><a name="l15737"></a><span class="lineno">15737</span>&#160;        }</div>
<div class="line"><a name="l15738"></a><span class="lineno">15738</span>&#160;        <span class="comment">// barcode size (excluding padding)</span></div>
<div class="line"><a name="l15739"></a><span class="lineno">15739</span>&#160;        $bw = (<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> * $cols) / ($cols + $hpad);</div>
<div class="line"><a name="l15740"></a><span class="lineno">15740</span>&#160;        $bh = (<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> * $rows) / ($rows + $vpad);</div>
<div class="line"><a name="l15741"></a><span class="lineno">15741</span>&#160;        <span class="comment">// dimension of single barcode cell unit</span></div>
<div class="line"><a name="l15742"></a><span class="lineno">15742</span>&#160;        $cw = $bw / $cols;</div>
<div class="line"><a name="l15743"></a><span class="lineno">15743</span>&#160;        $ch = $bh / $rows;</div>
<div class="line"><a name="l15744"></a><span class="lineno">15744</span>&#160;        <span class="keywordflow">if</span> (!$distort) {</div>
<div class="line"><a name="l15745"></a><span class="lineno">15745</span>&#160;            <span class="keywordflow">if</span> (($cw / $ch) &gt; ($mw / $mh)) {</div>
<div class="line"><a name="l15746"></a><span class="lineno">15746</span>&#160;                <span class="comment">// correct horizontal distortion</span></div>
<div class="line"><a name="l15747"></a><span class="lineno">15747</span>&#160;                $cw = $ch * $mw / $mh;</div>
<div class="line"><a name="l15748"></a><span class="lineno">15748</span>&#160;                $bw = $cw * $cols;</div>
<div class="line"><a name="l15749"></a><span class="lineno">15749</span>&#160;                $style[<span class="stringliteral">&#39;hpadding&#39;</span>] = (<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> - $bw) / (2 * $cw);</div>
<div class="line"><a name="l15750"></a><span class="lineno">15750</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l15751"></a><span class="lineno">15751</span>&#160;                <span class="comment">// correct vertical distortion</span></div>
<div class="line"><a name="l15752"></a><span class="lineno">15752</span>&#160;                $ch = $cw * $mh / $mw;</div>
<div class="line"><a name="l15753"></a><span class="lineno">15753</span>&#160;                $bh = $ch * $rows;</div>
<div class="line"><a name="l15754"></a><span class="lineno">15754</span>&#160;                $style[<span class="stringliteral">&#39;vpadding&#39;</span>] = (<a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> - $bh) / (2 * $ch);</div>
<div class="line"><a name="l15755"></a><span class="lineno">15755</span>&#160;            }</div>
<div class="line"><a name="l15756"></a><span class="lineno">15756</span>&#160;        }</div>
<div class="line"><a name="l15757"></a><span class="lineno">15757</span>&#160;        <span class="comment">// fit the barcode on available space</span></div>
<div class="line"><a name="l15758"></a><span class="lineno">15758</span>&#160;        list(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>) = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af1db92d221fd87c76d7c607f32266d0a">fitBlock</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l15759"></a><span class="lineno">15759</span>&#160;        <span class="comment">// set alignment</span></div>
<div class="line"><a name="l15760"></a><span class="lineno">15760</span>&#160;        $this-&gt;img_rb_y = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> + <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>;</div>
<div class="line"><a name="l15761"></a><span class="lineno">15761</span>&#160;        <span class="comment">// set alignment</span></div>
<div class="line"><a name="l15762"></a><span class="lineno">15762</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l15763"></a><span class="lineno">15763</span>&#160;            <span class="keywordflow">if</span> ($style[<span class="stringliteral">&#39;position&#39;</span>] == <span class="charliteral">&#39;L&#39;</span>) {</div>
<div class="line"><a name="l15764"></a><span class="lineno">15764</span>&#160;                $xpos = <a class="code" href="../../d4/d40/classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da">$this-&gt;lMargin</a>;</div>
<div class="line"><a name="l15765"></a><span class="lineno">15765</span>&#160;            } elseif ($style[<span class="stringliteral">&#39;position&#39;</span>] == <span class="charliteral">&#39;C&#39;</span>) {</div>
<div class="line"><a name="l15766"></a><span class="lineno">15766</span>&#160;                $xpos = ($this-&gt;w + $this-&gt;lMargin - $this-&gt;rMargin - <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>) / 2;</div>
<div class="line"><a name="l15767"></a><span class="lineno">15767</span>&#160;            } elseif ($style[<span class="stringliteral">&#39;position&#39;</span>] == <span class="charliteral">&#39;R&#39;</span>) {</div>
<div class="line"><a name="l15768"></a><span class="lineno">15768</span>&#160;                $xpos = $this-&gt;w - $this-&gt;rMargin - <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>;</div>
<div class="line"><a name="l15769"></a><span class="lineno">15769</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l15770"></a><span class="lineno">15770</span>&#160;                $xpos = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> - <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>;</div>
<div class="line"><a name="l15771"></a><span class="lineno">15771</span>&#160;            }</div>
<div class="line"><a name="l15772"></a><span class="lineno">15772</span>&#160;            $this-&gt;img_rb_x = $xpos;</div>
<div class="line"><a name="l15773"></a><span class="lineno">15773</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l15774"></a><span class="lineno">15774</span>&#160;            <span class="keywordflow">if</span> ($style[<span class="stringliteral">&#39;position&#39;</span>] == <span class="charliteral">&#39;L&#39;</span>) {</div>
<div class="line"><a name="l15775"></a><span class="lineno">15775</span>&#160;                $xpos = <a class="code" href="../../d4/d40/classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da">$this-&gt;lMargin</a>;</div>
<div class="line"><a name="l15776"></a><span class="lineno">15776</span>&#160;            } elseif ($style[<span class="stringliteral">&#39;position&#39;</span>] == <span class="charliteral">&#39;C&#39;</span>) {</div>
<div class="line"><a name="l15777"></a><span class="lineno">15777</span>&#160;                $xpos = ($this-&gt;w + $this-&gt;lMargin - $this-&gt;rMargin - <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>) / 2;</div>
<div class="line"><a name="l15778"></a><span class="lineno">15778</span>&#160;            } elseif ($style[<span class="stringliteral">&#39;position&#39;</span>] == <span class="charliteral">&#39;R&#39;</span>) {</div>
<div class="line"><a name="l15779"></a><span class="lineno">15779</span>&#160;                $xpos = $this-&gt;w - $this-&gt;rMargin - <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>;</div>
<div class="line"><a name="l15780"></a><span class="lineno">15780</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l15781"></a><span class="lineno">15781</span>&#160;                $xpos = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>;</div>
<div class="line"><a name="l15782"></a><span class="lineno">15782</span>&#160;            }</div>
<div class="line"><a name="l15783"></a><span class="lineno">15783</span>&#160;            $this-&gt;img_rb_x = $xpos + <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>;</div>
<div class="line"><a name="l15784"></a><span class="lineno">15784</span>&#160;        }</div>
<div class="line"><a name="l15785"></a><span class="lineno">15785</span>&#160;        $xstart = $xpos + ($style[<span class="stringliteral">&#39;hpadding&#39;</span>] * $cw);</div>
<div class="line"><a name="l15786"></a><span class="lineno">15786</span>&#160;        $ystart = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> + ($style[<span class="stringliteral">&#39;vpadding&#39;</span>] * $ch);</div>
<div class="line"><a name="l15787"></a><span class="lineno">15787</span>&#160;        <span class="comment">// barcode is always printed in LTR direction</span></div>
<div class="line"><a name="l15788"></a><span class="lineno">15788</span>&#160;        $tempRTL = <a class="code" href="../../d4/d40/classTCPDF.html#a4ccd9d69e0839838b105328953794a40">$this-&gt;rtl</a>;</div>
<div class="line"><a name="l15789"></a><span class="lineno">15789</span>&#160;        $this-&gt;rtl = <span class="keyword">false</span>;</div>
<div class="line"><a name="l15790"></a><span class="lineno">15790</span>&#160;        <span class="comment">// print background color</span></div>
<div class="line"><a name="l15791"></a><span class="lineno">15791</span>&#160;        <span class="keywordflow">if</span> ($style[<span class="stringliteral">&#39;bgcolor&#39;</span>]) {</div>
<div class="line"><a name="l15792"></a><span class="lineno">15792</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8fc7b86c255aeb0f14d281bdaeb2015c">Rect</a>($xpos, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, $h, $style[<span class="stringliteral">&#39;border&#39;</span>] ? <span class="stringliteral">&#39;DF&#39;</span> : <span class="charliteral">&#39;F&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $style[<span class="stringliteral">&#39;bgcolor&#39;</span>]);</div>
<div class="line"><a name="l15793"></a><span class="lineno">15793</span>&#160;        } elseif ($style[<span class="stringliteral">&#39;border&#39;</span>]) {</div>
<div class="line"><a name="l15794"></a><span class="lineno">15794</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8fc7b86c255aeb0f14d281bdaeb2015c">Rect</a>($xpos, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, $h, <span class="charliteral">&#39;D&#39;</span>);</div>
<div class="line"><a name="l15795"></a><span class="lineno">15795</span>&#160;        }</div>
<div class="line"><a name="l15796"></a><span class="lineno">15796</span>&#160;        <span class="comment">// set foreground color</span></div>
<div class="line"><a name="l15797"></a><span class="lineno">15797</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8f3481f3ce8a4fcd40ac1e1a6bd8960e">SetDrawColorArray</a>($style[<span class="stringliteral">&#39;fgcolor&#39;</span>]);</div>
<div class="line"><a name="l15798"></a><span class="lineno">15798</span>&#160;        <span class="comment">// print barcode cells</span></div>
<div class="line"><a name="l15799"></a><span class="lineno">15799</span>&#160;        <span class="comment">// for each row</span></div>
<div class="line"><a name="l15800"></a><span class="lineno">15800</span>&#160;        <span class="keywordflow">for</span> ($r = 0; $r &lt; $rows; ++$r) {</div>
<div class="line"><a name="l15801"></a><span class="lineno">15801</span>&#160;            $xr = $xstart;</div>
<div class="line"><a name="l15802"></a><span class="lineno">15802</span>&#160;            <span class="comment">// for each column</span></div>
<div class="line"><a name="l15803"></a><span class="lineno">15803</span>&#160;            <span class="keywordflow">for</span> ($c = 0; $c &lt; $cols; ++$c) {</div>
<div class="line"><a name="l15804"></a><span class="lineno">15804</span>&#160;                <span class="keywordflow">if</span> ($arrcode[<span class="stringliteral">&#39;bcode&#39;</span>][$r][$c] == 1) {</div>
<div class="line"><a name="l15805"></a><span class="lineno">15805</span>&#160;                    <span class="comment">// draw a single barcode cell</span></div>
<div class="line"><a name="l15806"></a><span class="lineno">15806</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8fc7b86c255aeb0f14d281bdaeb2015c">Rect</a>($xr, $ystart, $cw, $ch, <span class="charliteral">&#39;F&#39;</span>, array(), $style[<span class="stringliteral">&#39;fgcolor&#39;</span>]);</div>
<div class="line"><a name="l15807"></a><span class="lineno">15807</span>&#160;                }</div>
<div class="line"><a name="l15808"></a><span class="lineno">15808</span>&#160;                $xr += $cw;</div>
<div class="line"><a name="l15809"></a><span class="lineno">15809</span>&#160;            }</div>
<div class="line"><a name="l15810"></a><span class="lineno">15810</span>&#160;            $ystart += $ch;</div>
<div class="line"><a name="l15811"></a><span class="lineno">15811</span>&#160;        }</div>
<div class="line"><a name="l15812"></a><span class="lineno">15812</span>&#160;        <span class="comment">// restore original direction</span></div>
<div class="line"><a name="l15813"></a><span class="lineno">15813</span>&#160;        $this-&gt;rtl = $tempRTL;</div>
<div class="line"><a name="l15814"></a><span class="lineno">15814</span>&#160;        <span class="comment">// restore previous settings</span></div>
<div class="line"><a name="l15815"></a><span class="lineno">15815</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a072053646725b19770a795050b3b6221">setGraphicVars</a>($gvars);</div>
<div class="line"><a name="l15816"></a><span class="lineno">15816</span>&#160;        <span class="comment">// set pointer to align the next text/objects</span></div>
<div class="line"><a name="l15817"></a><span class="lineno">15817</span>&#160;        <span class="keywordflow">switch</span>($align) {</div>
<div class="line"><a name="l15818"></a><span class="lineno">15818</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>:{</div>
<div class="line"><a name="l15819"></a><span class="lineno">15819</span>&#160;                $this-&gt;y = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>;</div>
<div class="line"><a name="l15820"></a><span class="lineno">15820</span>&#160;                $this-&gt;x = <a class="code" href="../../d4/d40/classTCPDF.html#ace8e68000d6185a28a180bbe4531b428">$this-&gt;img_rb_x</a>;</div>
<div class="line"><a name="l15821"></a><span class="lineno">15821</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l15822"></a><span class="lineno">15822</span>&#160;            }</div>
<div class="line"><a name="l15823"></a><span class="lineno">15823</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;M&#39;</span>:{</div>
<div class="line"><a name="l15824"></a><span class="lineno">15824</span>&#160;                $this-&gt;y = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> + round($h/2);</div>
<div class="line"><a name="l15825"></a><span class="lineno">15825</span>&#160;                $this-&gt;x = <a class="code" href="../../d4/d40/classTCPDF.html#ace8e68000d6185a28a180bbe4531b428">$this-&gt;img_rb_x</a>;</div>
<div class="line"><a name="l15826"></a><span class="lineno">15826</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l15827"></a><span class="lineno">15827</span>&#160;            }</div>
<div class="line"><a name="l15828"></a><span class="lineno">15828</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>:{</div>
<div class="line"><a name="l15829"></a><span class="lineno">15829</span>&#160;                $this-&gt;y = <a class="code" href="../../d4/d40/classTCPDF.html#abc05496cf88772b492f67e87c53121d0">$this-&gt;img_rb_y</a>;</div>
<div class="line"><a name="l15830"></a><span class="lineno">15830</span>&#160;                $this-&gt;x = <a class="code" href="../../d4/d40/classTCPDF.html#ace8e68000d6185a28a180bbe4531b428">$this-&gt;img_rb_x</a>;</div>
<div class="line"><a name="l15831"></a><span class="lineno">15831</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l15832"></a><span class="lineno">15832</span>&#160;            }</div>
<div class="line"><a name="l15833"></a><span class="lineno">15833</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;N&#39;</span>:{</div>
<div class="line"><a name="l15834"></a><span class="lineno">15834</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ad3439990de56253b039bca6a09305758">SetY</a>($this-&gt;img_rb_y);</div>
<div class="line"><a name="l15835"></a><span class="lineno">15835</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l15836"></a><span class="lineno">15836</span>&#160;            }</div>
<div class="line"><a name="l15837"></a><span class="lineno">15837</span>&#160;            <span class="keywordflow">default</span>:{</div>
<div class="line"><a name="l15838"></a><span class="lineno">15838</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l15839"></a><span class="lineno">15839</span>&#160;            }</div>
<div class="line"><a name="l15840"></a><span class="lineno">15840</span>&#160;        }</div>
<div class="line"><a name="l15841"></a><span class="lineno">15841</span>&#160;        $this-&gt;endlinex = <a class="code" href="../../d4/d40/classTCPDF.html#ace8e68000d6185a28a180bbe4531b428">$this-&gt;img_rb_x</a>;</div>
<div class="line"><a name="l15842"></a><span class="lineno">15842</span>&#160;    }</div>
<div class="line"><a name="l15843"></a><span class="lineno">15843</span>&#160;</div>
<div class="line"><a name="l15863"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ae9bd660bf5b5e00eea82f1168cc67b5b">15863</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ae9bd660bf5b5e00eea82f1168cc67b5b">getMargins</a>() {</div>
<div class="line"><a name="l15864"></a><span class="lineno">15864</span>&#160;        $ret = array(</div>
<div class="line"><a name="l15865"></a><span class="lineno">15865</span>&#160;            <span class="stringliteral">&#39;left&#39;</span> =&gt; $this-&gt;lMargin,</div>
<div class="line"><a name="l15866"></a><span class="lineno">15866</span>&#160;            <span class="stringliteral">&#39;right&#39;</span> =&gt; $this-&gt;rMargin,</div>
<div class="line"><a name="l15867"></a><span class="lineno">15867</span>&#160;            <span class="stringliteral">&#39;top&#39;</span> =&gt; $this-&gt;tMargin,</div>
<div class="line"><a name="l15868"></a><span class="lineno">15868</span>&#160;            <span class="stringliteral">&#39;bottom&#39;</span> =&gt; $this-&gt;bMargin,</div>
<div class="line"><a name="l15869"></a><span class="lineno">15869</span>&#160;            <span class="stringliteral">&#39;header&#39;</span> =&gt; $this-&gt;header_margin,</div>
<div class="line"><a name="l15870"></a><span class="lineno">15870</span>&#160;            <span class="stringliteral">&#39;footer&#39;</span> =&gt; $this-&gt;footer_margin,</div>
<div class="line"><a name="l15871"></a><span class="lineno">15871</span>&#160;            <span class="stringliteral">&#39;cell&#39;</span> =&gt; $this-&gt;cell_padding,</div>
<div class="line"><a name="l15872"></a><span class="lineno">15872</span>&#160;            <span class="stringliteral">&#39;padding_left&#39;</span> =&gt; $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>],</div>
<div class="line"><a name="l15873"></a><span class="lineno">15873</span>&#160;            <span class="stringliteral">&#39;padding_top&#39;</span> =&gt; $this-&gt;cell_padding[<span class="charliteral">&#39;T&#39;</span>],</div>
<div class="line"><a name="l15874"></a><span class="lineno">15874</span>&#160;            <span class="stringliteral">&#39;padding_right&#39;</span> =&gt; $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>],</div>
<div class="line"><a name="l15875"></a><span class="lineno">15875</span>&#160;            <span class="stringliteral">&#39;padding_bottom&#39;</span> =&gt; $this-&gt;cell_padding[<span class="charliteral">&#39;B&#39;</span>]</div>
<div class="line"><a name="l15876"></a><span class="lineno">15876</span>&#160;        );</div>
<div class="line"><a name="l15877"></a><span class="lineno">15877</span>&#160;        <span class="keywordflow">return</span> $ret;</div>
<div class="line"><a name="l15878"></a><span class="lineno">15878</span>&#160;    }</div>
<div class="line"><a name="l15879"></a><span class="lineno">15879</span>&#160;</div>
<div class="line"><a name="l15890"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a0cee973f21b885929d2c71c28782adac">15890</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a0cee973f21b885929d2c71c28782adac">getOriginalMargins</a>() {</div>
<div class="line"><a name="l15891"></a><span class="lineno">15891</span>&#160;        $ret = array(</div>
<div class="line"><a name="l15892"></a><span class="lineno">15892</span>&#160;            <span class="stringliteral">&#39;left&#39;</span> =&gt; $this-&gt;original_lMargin,</div>
<div class="line"><a name="l15893"></a><span class="lineno">15893</span>&#160;            <span class="stringliteral">&#39;right&#39;</span> =&gt; $this-&gt;original_rMargin</div>
<div class="line"><a name="l15894"></a><span class="lineno">15894</span>&#160;        );</div>
<div class="line"><a name="l15895"></a><span class="lineno">15895</span>&#160;        <span class="keywordflow">return</span> $ret;</div>
<div class="line"><a name="l15896"></a><span class="lineno">15896</span>&#160;    }</div>
<div class="line"><a name="l15897"></a><span class="lineno">15897</span>&#160;</div>
<div class="line"><a name="l15904"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#acd080ff16d09e445402c5bc8e831af7b">15904</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#acd080ff16d09e445402c5bc8e831af7b">getFontSize</a>() {</div>
<div class="line"><a name="l15905"></a><span class="lineno">15905</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#aa4460c72a6e45784dff4dad7708c372c">$this-&gt;FontSize</a>;</div>
<div class="line"><a name="l15906"></a><span class="lineno">15906</span>&#160;    }</div>
<div class="line"><a name="l15907"></a><span class="lineno">15907</span>&#160;</div>
<div class="line"><a name="l15914"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a8d34f3978888eaf89b4d78a361fb4416">15914</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a8d34f3978888eaf89b4d78a361fb4416">getFontSizePt</a>() {</div>
<div class="line"><a name="l15915"></a><span class="lineno">15915</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#a9a787786c9f1a04f54f1dec622869d4d">$this-&gt;FontSizePt</a>;</div>
<div class="line"><a name="l15916"></a><span class="lineno">15916</span>&#160;    }</div>
<div class="line"><a name="l15917"></a><span class="lineno">15917</span>&#160;</div>
<div class="line"><a name="l15924"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#acf73334191df85e1c4effbc5cf257cf5">15924</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#acf73334191df85e1c4effbc5cf257cf5">getFontFamily</a>() {</div>
<div class="line"><a name="l15925"></a><span class="lineno">15925</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#a642c62438ec9c983283a98d5099ba7ba">$this-&gt;FontFamily</a>;</div>
<div class="line"><a name="l15926"></a><span class="lineno">15926</span>&#160;    }</div>
<div class="line"><a name="l15927"></a><span class="lineno">15927</span>&#160;</div>
<div class="line"><a name="l15934"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a130bd080e3028082d43b4d1d64f6702e">15934</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a130bd080e3028082d43b4d1d64f6702e">getFontStyle</a>() {</div>
<div class="line"><a name="l15935"></a><span class="lineno">15935</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#a6fce74bcde6c138d286dce274950dff7">$this-&gt;FontStyle</a>;</div>
<div class="line"><a name="l15936"></a><span class="lineno">15936</span>&#160;    }</div>
<div class="line"><a name="l15937"></a><span class="lineno">15937</span>&#160;</div>
<div class="line"><a name="l15950"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ae11c5c603573f58c854481fb3d74d588">15950</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ae11c5c603573f58c854481fb3d74d588">fixHTMLCode</a>($html, $default_css=<span class="stringliteral">&#39;&#39;</span>, $tagvs=<span class="stringliteral">&#39;&#39;</span>, $tidy_options=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l15951"></a><span class="lineno">15951</span>&#160;        <span class="keywordflow">return</span> TCPDF_STATIC::fixHTMLCode($html, $default_css, $tagvs, $tidy_options, $this-&gt;tagvspaces);</div>
<div class="line"><a name="l15952"></a><span class="lineno">15952</span>&#160;    }</div>
<div class="line"><a name="l15953"></a><span class="lineno">15953</span>&#160;</div>
<div class="line"><a name="l15961"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a79695745bece08e32a7899f8217bf74d">15961</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a79695745bece08e32a7899f8217bf74d">getCSSBorderWidth</a>($width) {</div>
<div class="line"><a name="l15962"></a><span class="lineno">15962</span>&#160;        <span class="keywordflow">if</span> ($width == <span class="stringliteral">&#39;thin&#39;</span>) {</div>
<div class="line"><a name="l15963"></a><span class="lineno">15963</span>&#160;            $width = (2 / <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>);</div>
<div class="line"><a name="l15964"></a><span class="lineno">15964</span>&#160;        } elseif ($width == <span class="stringliteral">&#39;medium&#39;</span>) {</div>
<div class="line"><a name="l15965"></a><span class="lineno">15965</span>&#160;            $width = (4 / <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>);</div>
<div class="line"><a name="l15966"></a><span class="lineno">15966</span>&#160;        } elseif ($width == <span class="stringliteral">&#39;thick&#39;</span>) {</div>
<div class="line"><a name="l15967"></a><span class="lineno">15967</span>&#160;            $width = (6 / <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>);</div>
<div class="line"><a name="l15968"></a><span class="lineno">15968</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l15969"></a><span class="lineno">15969</span>&#160;            $width = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9">getHTMLUnitToUnits</a>($width, 1, <span class="stringliteral">&#39;px&#39;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l15970"></a><span class="lineno">15970</span>&#160;        }</div>
<div class="line"><a name="l15971"></a><span class="lineno">15971</span>&#160;        <span class="keywordflow">return</span> $width;</div>
<div class="line"><a name="l15972"></a><span class="lineno">15972</span>&#160;    }</div>
<div class="line"><a name="l15973"></a><span class="lineno">15973</span>&#160;</div>
<div class="line"><a name="l15981"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a7cd52df1697c10362b74645261fb38f1">15981</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a7cd52df1697c10362b74645261fb38f1">getCSSBorderDashStyle</a>($style) {</div>
<div class="line"><a name="l15982"></a><span class="lineno">15982</span>&#160;        <span class="keywordflow">switch</span> (strtolower($style)) {</div>
<div class="line"><a name="l15983"></a><span class="lineno">15983</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;none&#39;</span>:</div>
<div class="line"><a name="l15984"></a><span class="lineno">15984</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;hidden&#39;</span>: {</div>
<div class="line"><a name="l15985"></a><span class="lineno">15985</span>&#160;                $dash = -1;</div>
<div class="line"><a name="l15986"></a><span class="lineno">15986</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l15987"></a><span class="lineno">15987</span>&#160;            }</div>
<div class="line"><a name="l15988"></a><span class="lineno">15988</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;dotted&#39;</span>: {</div>
<div class="line"><a name="l15989"></a><span class="lineno">15989</span>&#160;                $dash = 1;</div>
<div class="line"><a name="l15990"></a><span class="lineno">15990</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l15991"></a><span class="lineno">15991</span>&#160;            }</div>
<div class="line"><a name="l15992"></a><span class="lineno">15992</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;dashed&#39;</span>: {</div>
<div class="line"><a name="l15993"></a><span class="lineno">15993</span>&#160;                $dash = 3;</div>
<div class="line"><a name="l15994"></a><span class="lineno">15994</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l15995"></a><span class="lineno">15995</span>&#160;            }</div>
<div class="line"><a name="l15996"></a><span class="lineno">15996</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;double&#39;</span>:</div>
<div class="line"><a name="l15997"></a><span class="lineno">15997</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;groove&#39;</span>:</div>
<div class="line"><a name="l15998"></a><span class="lineno">15998</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;ridge&#39;</span>:</div>
<div class="line"><a name="l15999"></a><span class="lineno">15999</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;inset&#39;</span>:</div>
<div class="line"><a name="l16000"></a><span class="lineno">16000</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;outset&#39;</span>:</div>
<div class="line"><a name="l16001"></a><span class="lineno">16001</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;solid&#39;</span>:</div>
<div class="line"><a name="l16002"></a><span class="lineno">16002</span>&#160;            <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l16003"></a><span class="lineno">16003</span>&#160;                $dash = 0;</div>
<div class="line"><a name="l16004"></a><span class="lineno">16004</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l16005"></a><span class="lineno">16005</span>&#160;            }</div>
<div class="line"><a name="l16006"></a><span class="lineno">16006</span>&#160;        }</div>
<div class="line"><a name="l16007"></a><span class="lineno">16007</span>&#160;        <span class="keywordflow">return</span> $dash;</div>
<div class="line"><a name="l16008"></a><span class="lineno">16008</span>&#160;    }</div>
<div class="line"><a name="l16009"></a><span class="lineno">16009</span>&#160;</div>
<div class="line"><a name="l16017"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a2e65a8cc55a9b4b9c9ac01e6513d64c7">16017</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a2e65a8cc55a9b4b9c9ac01e6513d64c7">getCSSBorderStyle</a>($cssborder) {</div>
<div class="line"><a name="l16018"></a><span class="lineno">16018</span>&#160;        $bprop = preg_split(<span class="stringliteral">&#39;/[\s]+/&#39;</span>, trim($cssborder));</div>
<div class="line"><a name="l16019"></a><span class="lineno">16019</span>&#160;        $border = array(); <span class="comment">// value to be returned</span></div>
<div class="line"><a name="l16020"></a><span class="lineno">16020</span>&#160;        <span class="keywordflow">switch</span> (count($bprop)) {</div>
<div class="line"><a name="l16021"></a><span class="lineno">16021</span>&#160;            <span class="keywordflow">case</span> 3: {</div>
<div class="line"><a name="l16022"></a><span class="lineno">16022</span>&#160;                $width = $bprop[0];</div>
<div class="line"><a name="l16023"></a><span class="lineno">16023</span>&#160;                $style = $bprop[1];</div>
<div class="line"><a name="l16024"></a><span class="lineno">16024</span>&#160;                $color = $bprop[2];</div>
<div class="line"><a name="l16025"></a><span class="lineno">16025</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l16026"></a><span class="lineno">16026</span>&#160;            }</div>
<div class="line"><a name="l16027"></a><span class="lineno">16027</span>&#160;            <span class="keywordflow">case</span> 2: {</div>
<div class="line"><a name="l16028"></a><span class="lineno">16028</span>&#160;                $width = <span class="stringliteral">&#39;medium&#39;</span>;</div>
<div class="line"><a name="l16029"></a><span class="lineno">16029</span>&#160;                $style = $bprop[0];</div>
<div class="line"><a name="l16030"></a><span class="lineno">16030</span>&#160;                $color = $bprop[1];</div>
<div class="line"><a name="l16031"></a><span class="lineno">16031</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l16032"></a><span class="lineno">16032</span>&#160;            }</div>
<div class="line"><a name="l16033"></a><span class="lineno">16033</span>&#160;            <span class="keywordflow">case</span> 1: {</div>
<div class="line"><a name="l16034"></a><span class="lineno">16034</span>&#160;                $width = <span class="stringliteral">&#39;medium&#39;</span>;</div>
<div class="line"><a name="l16035"></a><span class="lineno">16035</span>&#160;                $style = $bprop[0];</div>
<div class="line"><a name="l16036"></a><span class="lineno">16036</span>&#160;                $color = <span class="stringliteral">&#39;black&#39;</span>;</div>
<div class="line"><a name="l16037"></a><span class="lineno">16037</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l16038"></a><span class="lineno">16038</span>&#160;            }</div>
<div class="line"><a name="l16039"></a><span class="lineno">16039</span>&#160;            <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l16040"></a><span class="lineno">16040</span>&#160;                $width = <span class="stringliteral">&#39;medium&#39;</span>;</div>
<div class="line"><a name="l16041"></a><span class="lineno">16041</span>&#160;                $style = <span class="stringliteral">&#39;solid&#39;</span>;</div>
<div class="line"><a name="l16042"></a><span class="lineno">16042</span>&#160;                $color = <span class="stringliteral">&#39;black&#39;</span>;</div>
<div class="line"><a name="l16043"></a><span class="lineno">16043</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l16044"></a><span class="lineno">16044</span>&#160;            }</div>
<div class="line"><a name="l16045"></a><span class="lineno">16045</span>&#160;        }</div>
<div class="line"><a name="l16046"></a><span class="lineno">16046</span>&#160;        <span class="keywordflow">if</span> ($style == <span class="stringliteral">&#39;none&#39;</span>) {</div>
<div class="line"><a name="l16047"></a><span class="lineno">16047</span>&#160;            <span class="keywordflow">return</span> array();</div>
<div class="line"><a name="l16048"></a><span class="lineno">16048</span>&#160;        }</div>
<div class="line"><a name="l16049"></a><span class="lineno">16049</span>&#160;        $border[<span class="stringliteral">&#39;cap&#39;</span>] = <span class="stringliteral">&#39;square&#39;</span>;</div>
<div class="line"><a name="l16050"></a><span class="lineno">16050</span>&#160;        $border[<span class="stringliteral">&#39;join&#39;</span>] = <span class="stringliteral">&#39;miter&#39;</span>;</div>
<div class="line"><a name="l16051"></a><span class="lineno">16051</span>&#160;        $border[<span class="stringliteral">&#39;dash&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a7cd52df1697c10362b74645261fb38f1">getCSSBorderDashStyle</a>($style);</div>
<div class="line"><a name="l16052"></a><span class="lineno">16052</span>&#160;        <span class="keywordflow">if</span> ($border[<span class="stringliteral">&#39;dash&#39;</span>] &lt; 0) {</div>
<div class="line"><a name="l16053"></a><span class="lineno">16053</span>&#160;            <span class="keywordflow">return</span> array();</div>
<div class="line"><a name="l16054"></a><span class="lineno">16054</span>&#160;        }</div>
<div class="line"><a name="l16055"></a><span class="lineno">16055</span>&#160;        $border[<span class="stringliteral">&#39;width&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a79695745bece08e32a7899f8217bf74d">getCSSBorderWidth</a>($width);</div>
<div class="line"><a name="l16056"></a><span class="lineno">16056</span>&#160;        $border[<span class="stringliteral">&#39;color&#39;</span>] = TCPDF_COLORS::convertHTMLColorToDec($color, $this-&gt;spot_colors);</div>
<div class="line"><a name="l16057"></a><span class="lineno">16057</span>&#160;        <span class="keywordflow">return</span> $border;</div>
<div class="line"><a name="l16058"></a><span class="lineno">16058</span>&#160;    }</div>
<div class="line"><a name="l16059"></a><span class="lineno">16059</span>&#160;</div>
<div class="line"><a name="l16068"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#acd3d7dae873b9873302616698abafcf3">16068</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#acd3d7dae873b9873302616698abafcf3">getCSSPadding</a>($csspadding, $width=0) {</div>
<div class="line"><a name="l16069"></a><span class="lineno">16069</span>&#160;        $padding = preg_split(<span class="stringliteral">&#39;/[\s]+/&#39;</span>, trim($csspadding));</div>
<div class="line"><a name="l16070"></a><span class="lineno">16070</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$cell_padding</a> = array(); <span class="comment">// value to be returned</span></div>
<div class="line"><a name="l16071"></a><span class="lineno">16071</span>&#160;        <span class="keywordflow">switch</span> (count($padding)) {</div>
<div class="line"><a name="l16072"></a><span class="lineno">16072</span>&#160;            <span class="keywordflow">case</span> 4: {</div>
<div class="line"><a name="l16073"></a><span class="lineno">16073</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$cell_padding</a>[<span class="charliteral">&#39;T&#39;</span>] = $padding[0];</div>
<div class="line"><a name="l16074"></a><span class="lineno">16074</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$cell_padding</a>[<span class="charliteral">&#39;R&#39;</span>] = $padding[1];</div>
<div class="line"><a name="l16075"></a><span class="lineno">16075</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$cell_padding</a>[<span class="charliteral">&#39;B&#39;</span>] = $padding[2];</div>
<div class="line"><a name="l16076"></a><span class="lineno">16076</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$cell_padding</a>[<span class="charliteral">&#39;L&#39;</span>] = $padding[3];</div>
<div class="line"><a name="l16077"></a><span class="lineno">16077</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l16078"></a><span class="lineno">16078</span>&#160;            }</div>
<div class="line"><a name="l16079"></a><span class="lineno">16079</span>&#160;            <span class="keywordflow">case</span> 3: {</div>
<div class="line"><a name="l16080"></a><span class="lineno">16080</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$cell_padding</a>[<span class="charliteral">&#39;T&#39;</span>] = $padding[0];</div>
<div class="line"><a name="l16081"></a><span class="lineno">16081</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$cell_padding</a>[<span class="charliteral">&#39;R&#39;</span>] = $padding[1];</div>
<div class="line"><a name="l16082"></a><span class="lineno">16082</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$cell_padding</a>[<span class="charliteral">&#39;B&#39;</span>] = $padding[2];</div>
<div class="line"><a name="l16083"></a><span class="lineno">16083</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$cell_padding</a>[<span class="charliteral">&#39;L&#39;</span>] = $padding[1];</div>
<div class="line"><a name="l16084"></a><span class="lineno">16084</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l16085"></a><span class="lineno">16085</span>&#160;            }</div>
<div class="line"><a name="l16086"></a><span class="lineno">16086</span>&#160;            <span class="keywordflow">case</span> 2: {</div>
<div class="line"><a name="l16087"></a><span class="lineno">16087</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$cell_padding</a>[<span class="charliteral">&#39;T&#39;</span>] = $padding[0];</div>
<div class="line"><a name="l16088"></a><span class="lineno">16088</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$cell_padding</a>[<span class="charliteral">&#39;R&#39;</span>] = $padding[1];</div>
<div class="line"><a name="l16089"></a><span class="lineno">16089</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$cell_padding</a>[<span class="charliteral">&#39;B&#39;</span>] = $padding[0];</div>
<div class="line"><a name="l16090"></a><span class="lineno">16090</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$cell_padding</a>[<span class="charliteral">&#39;L&#39;</span>] = $padding[1];</div>
<div class="line"><a name="l16091"></a><span class="lineno">16091</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l16092"></a><span class="lineno">16092</span>&#160;            }</div>
<div class="line"><a name="l16093"></a><span class="lineno">16093</span>&#160;            <span class="keywordflow">case</span> 1: {</div>
<div class="line"><a name="l16094"></a><span class="lineno">16094</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$cell_padding</a>[<span class="charliteral">&#39;T&#39;</span>] = $padding[0];</div>
<div class="line"><a name="l16095"></a><span class="lineno">16095</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$cell_padding</a>[<span class="charliteral">&#39;R&#39;</span>] = $padding[0];</div>
<div class="line"><a name="l16096"></a><span class="lineno">16096</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$cell_padding</a>[<span class="charliteral">&#39;B&#39;</span>] = $padding[0];</div>
<div class="line"><a name="l16097"></a><span class="lineno">16097</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$cell_padding</a>[<span class="charliteral">&#39;L&#39;</span>] = $padding[0];</div>
<div class="line"><a name="l16098"></a><span class="lineno">16098</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l16099"></a><span class="lineno">16099</span>&#160;            }</div>
<div class="line"><a name="l16100"></a><span class="lineno">16100</span>&#160;            <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l16101"></a><span class="lineno">16101</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$this-&gt;cell_padding</a>;</div>
<div class="line"><a name="l16102"></a><span class="lineno">16102</span>&#160;            }</div>
<div class="line"><a name="l16103"></a><span class="lineno">16103</span>&#160;        }</div>
<div class="line"><a name="l16104"></a><span class="lineno">16104</span>&#160;        <span class="keywordflow">if</span> ($width == 0) {</div>
<div class="line"><a name="l16105"></a><span class="lineno">16105</span>&#160;            $width = $this-&gt;w - $this-&gt;lMargin - <a class="code" href="../../d4/d40/classTCPDF.html#a44fb75b85bea40ced25fdea9d89dc8e9">$this-&gt;rMargin</a>;</div>
<div class="line"><a name="l16106"></a><span class="lineno">16106</span>&#160;        }</div>
<div class="line"><a name="l16107"></a><span class="lineno">16107</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$cell_padding</a>[<span class="charliteral">&#39;T&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9">getHTMLUnitToUnits</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$cell_padding</a>[<span class="charliteral">&#39;T&#39;</span>], $width, <span class="stringliteral">&#39;px&#39;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l16108"></a><span class="lineno">16108</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$cell_padding</a>[<span class="charliteral">&#39;R&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9">getHTMLUnitToUnits</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$cell_padding</a>[<span class="charliteral">&#39;R&#39;</span>], $width, <span class="stringliteral">&#39;px&#39;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l16109"></a><span class="lineno">16109</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$cell_padding</a>[<span class="charliteral">&#39;B&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9">getHTMLUnitToUnits</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$cell_padding</a>[<span class="charliteral">&#39;B&#39;</span>], $width, <span class="stringliteral">&#39;px&#39;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l16110"></a><span class="lineno">16110</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$cell_padding</a>[<span class="charliteral">&#39;L&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9">getHTMLUnitToUnits</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$cell_padding</a>[<span class="charliteral">&#39;L&#39;</span>], $width, <span class="stringliteral">&#39;px&#39;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l16111"></a><span class="lineno">16111</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$cell_padding</a>;</div>
<div class="line"><a name="l16112"></a><span class="lineno">16112</span>&#160;    }</div>
<div class="line"><a name="l16113"></a><span class="lineno">16113</span>&#160;</div>
<div class="line"><a name="l16122"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a5667689bccca7385dc41c64040e59121">16122</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a5667689bccca7385dc41c64040e59121">getCSSMargin</a>($cssmargin, $width=0) {</div>
<div class="line"><a name="l16123"></a><span class="lineno">16123</span>&#160;        $margin = preg_split(<span class="stringliteral">&#39;/[\s]+/&#39;</span>, trim($cssmargin));</div>
<div class="line"><a name="l16124"></a><span class="lineno">16124</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#a6decef4569cfd79d75e47cab1315fa77">$cell_margin</a> = array(); <span class="comment">// value to be returned</span></div>
<div class="line"><a name="l16125"></a><span class="lineno">16125</span>&#160;        <span class="keywordflow">switch</span> (count($margin)) {</div>
<div class="line"><a name="l16126"></a><span class="lineno">16126</span>&#160;            <span class="keywordflow">case</span> 4: {</div>
<div class="line"><a name="l16127"></a><span class="lineno">16127</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a6decef4569cfd79d75e47cab1315fa77">$cell_margin</a>[<span class="charliteral">&#39;T&#39;</span>] = $margin[0];</div>
<div class="line"><a name="l16128"></a><span class="lineno">16128</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a6decef4569cfd79d75e47cab1315fa77">$cell_margin</a>[<span class="charliteral">&#39;R&#39;</span>] = $margin[1];</div>
<div class="line"><a name="l16129"></a><span class="lineno">16129</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a6decef4569cfd79d75e47cab1315fa77">$cell_margin</a>[<span class="charliteral">&#39;B&#39;</span>] = $margin[2];</div>
<div class="line"><a name="l16130"></a><span class="lineno">16130</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a6decef4569cfd79d75e47cab1315fa77">$cell_margin</a>[<span class="charliteral">&#39;L&#39;</span>] = $margin[3];</div>
<div class="line"><a name="l16131"></a><span class="lineno">16131</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l16132"></a><span class="lineno">16132</span>&#160;            }</div>
<div class="line"><a name="l16133"></a><span class="lineno">16133</span>&#160;            <span class="keywordflow">case</span> 3: {</div>
<div class="line"><a name="l16134"></a><span class="lineno">16134</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a6decef4569cfd79d75e47cab1315fa77">$cell_margin</a>[<span class="charliteral">&#39;T&#39;</span>] = $margin[0];</div>
<div class="line"><a name="l16135"></a><span class="lineno">16135</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a6decef4569cfd79d75e47cab1315fa77">$cell_margin</a>[<span class="charliteral">&#39;R&#39;</span>] = $margin[1];</div>
<div class="line"><a name="l16136"></a><span class="lineno">16136</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a6decef4569cfd79d75e47cab1315fa77">$cell_margin</a>[<span class="charliteral">&#39;B&#39;</span>] = $margin[2];</div>
<div class="line"><a name="l16137"></a><span class="lineno">16137</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a6decef4569cfd79d75e47cab1315fa77">$cell_margin</a>[<span class="charliteral">&#39;L&#39;</span>] = $margin[1];</div>
<div class="line"><a name="l16138"></a><span class="lineno">16138</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l16139"></a><span class="lineno">16139</span>&#160;            }</div>
<div class="line"><a name="l16140"></a><span class="lineno">16140</span>&#160;            <span class="keywordflow">case</span> 2: {</div>
<div class="line"><a name="l16141"></a><span class="lineno">16141</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a6decef4569cfd79d75e47cab1315fa77">$cell_margin</a>[<span class="charliteral">&#39;T&#39;</span>] = $margin[0];</div>
<div class="line"><a name="l16142"></a><span class="lineno">16142</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a6decef4569cfd79d75e47cab1315fa77">$cell_margin</a>[<span class="charliteral">&#39;R&#39;</span>] = $margin[1];</div>
<div class="line"><a name="l16143"></a><span class="lineno">16143</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a6decef4569cfd79d75e47cab1315fa77">$cell_margin</a>[<span class="charliteral">&#39;B&#39;</span>] = $margin[0];</div>
<div class="line"><a name="l16144"></a><span class="lineno">16144</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a6decef4569cfd79d75e47cab1315fa77">$cell_margin</a>[<span class="charliteral">&#39;L&#39;</span>] = $margin[1];</div>
<div class="line"><a name="l16145"></a><span class="lineno">16145</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l16146"></a><span class="lineno">16146</span>&#160;            }</div>
<div class="line"><a name="l16147"></a><span class="lineno">16147</span>&#160;            <span class="keywordflow">case</span> 1: {</div>
<div class="line"><a name="l16148"></a><span class="lineno">16148</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a6decef4569cfd79d75e47cab1315fa77">$cell_margin</a>[<span class="charliteral">&#39;T&#39;</span>] = $margin[0];</div>
<div class="line"><a name="l16149"></a><span class="lineno">16149</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a6decef4569cfd79d75e47cab1315fa77">$cell_margin</a>[<span class="charliteral">&#39;R&#39;</span>] = $margin[0];</div>
<div class="line"><a name="l16150"></a><span class="lineno">16150</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a6decef4569cfd79d75e47cab1315fa77">$cell_margin</a>[<span class="charliteral">&#39;B&#39;</span>] = $margin[0];</div>
<div class="line"><a name="l16151"></a><span class="lineno">16151</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a6decef4569cfd79d75e47cab1315fa77">$cell_margin</a>[<span class="charliteral">&#39;L&#39;</span>] = $margin[0];</div>
<div class="line"><a name="l16152"></a><span class="lineno">16152</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l16153"></a><span class="lineno">16153</span>&#160;            }</div>
<div class="line"><a name="l16154"></a><span class="lineno">16154</span>&#160;            <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l16155"></a><span class="lineno">16155</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#a6decef4569cfd79d75e47cab1315fa77">$this-&gt;cell_margin</a>;</div>
<div class="line"><a name="l16156"></a><span class="lineno">16156</span>&#160;            }</div>
<div class="line"><a name="l16157"></a><span class="lineno">16157</span>&#160;        }</div>
<div class="line"><a name="l16158"></a><span class="lineno">16158</span>&#160;        <span class="keywordflow">if</span> ($width == 0) {</div>
<div class="line"><a name="l16159"></a><span class="lineno">16159</span>&#160;            $width = $this-&gt;w - $this-&gt;lMargin - <a class="code" href="../../d4/d40/classTCPDF.html#a44fb75b85bea40ced25fdea9d89dc8e9">$this-&gt;rMargin</a>;</div>
<div class="line"><a name="l16160"></a><span class="lineno">16160</span>&#160;        }</div>
<div class="line"><a name="l16161"></a><span class="lineno">16161</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#a6decef4569cfd79d75e47cab1315fa77">$cell_margin</a>[<span class="charliteral">&#39;T&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9">getHTMLUnitToUnits</a>(str_replace(<span class="stringliteral">&#39;auto&#39;</span>, <span class="charliteral">&#39;0&#39;</span>, <a class="code" href="../../d4/d40/classTCPDF.html#a6decef4569cfd79d75e47cab1315fa77">$cell_margin</a>[<span class="charliteral">&#39;T&#39;</span>]), $width, <span class="stringliteral">&#39;px&#39;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l16162"></a><span class="lineno">16162</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#a6decef4569cfd79d75e47cab1315fa77">$cell_margin</a>[<span class="charliteral">&#39;R&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9">getHTMLUnitToUnits</a>(str_replace(<span class="stringliteral">&#39;auto&#39;</span>, <span class="charliteral">&#39;0&#39;</span>, <a class="code" href="../../d4/d40/classTCPDF.html#a6decef4569cfd79d75e47cab1315fa77">$cell_margin</a>[<span class="charliteral">&#39;R&#39;</span>]), $width, <span class="stringliteral">&#39;px&#39;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l16163"></a><span class="lineno">16163</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#a6decef4569cfd79d75e47cab1315fa77">$cell_margin</a>[<span class="charliteral">&#39;B&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9">getHTMLUnitToUnits</a>(str_replace(<span class="stringliteral">&#39;auto&#39;</span>, <span class="charliteral">&#39;0&#39;</span>, <a class="code" href="../../d4/d40/classTCPDF.html#a6decef4569cfd79d75e47cab1315fa77">$cell_margin</a>[<span class="charliteral">&#39;B&#39;</span>]), $width, <span class="stringliteral">&#39;px&#39;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l16164"></a><span class="lineno">16164</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#a6decef4569cfd79d75e47cab1315fa77">$cell_margin</a>[<span class="charliteral">&#39;L&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9">getHTMLUnitToUnits</a>(str_replace(<span class="stringliteral">&#39;auto&#39;</span>, <span class="charliteral">&#39;0&#39;</span>, <a class="code" href="../../d4/d40/classTCPDF.html#a6decef4569cfd79d75e47cab1315fa77">$cell_margin</a>[<span class="charliteral">&#39;L&#39;</span>]), $width, <span class="stringliteral">&#39;px&#39;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l16165"></a><span class="lineno">16165</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../d4/d40/classTCPDF.html#a6decef4569cfd79d75e47cab1315fa77">$cell_margin</a>;</div>
<div class="line"><a name="l16166"></a><span class="lineno">16166</span>&#160;    }</div>
<div class="line"><a name="l16167"></a><span class="lineno">16167</span>&#160;</div>
<div class="line"><a name="l16176"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a7ec79640f33b5a1334632c2a893571b7">16176</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a7ec79640f33b5a1334632c2a893571b7">getCSSBorderMargin</a>($cssbspace, $width=0) {</div>
<div class="line"><a name="l16177"></a><span class="lineno">16177</span>&#160;        $space = preg_split(<span class="stringliteral">&#39;/[\s]+/&#39;</span>, trim($cssbspace));</div>
<div class="line"><a name="l16178"></a><span class="lineno">16178</span>&#160;        $border_spacing = array(); <span class="comment">// value to be returned</span></div>
<div class="line"><a name="l16179"></a><span class="lineno">16179</span>&#160;        <span class="keywordflow">switch</span> (count($space)) {</div>
<div class="line"><a name="l16180"></a><span class="lineno">16180</span>&#160;            <span class="keywordflow">case</span> 2: {</div>
<div class="line"><a name="l16181"></a><span class="lineno">16181</span>&#160;                $border_spacing[<span class="charliteral">&#39;H&#39;</span>] = $space[0];</div>
<div class="line"><a name="l16182"></a><span class="lineno">16182</span>&#160;                $border_spacing[<span class="charliteral">&#39;V&#39;</span>] = $space[1];</div>
<div class="line"><a name="l16183"></a><span class="lineno">16183</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l16184"></a><span class="lineno">16184</span>&#160;            }</div>
<div class="line"><a name="l16185"></a><span class="lineno">16185</span>&#160;            <span class="keywordflow">case</span> 1: {</div>
<div class="line"><a name="l16186"></a><span class="lineno">16186</span>&#160;                $border_spacing[<span class="charliteral">&#39;H&#39;</span>] = $space[0];</div>
<div class="line"><a name="l16187"></a><span class="lineno">16187</span>&#160;                $border_spacing[<span class="charliteral">&#39;V&#39;</span>] = $space[0];</div>
<div class="line"><a name="l16188"></a><span class="lineno">16188</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l16189"></a><span class="lineno">16189</span>&#160;            }</div>
<div class="line"><a name="l16190"></a><span class="lineno">16190</span>&#160;            <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l16191"></a><span class="lineno">16191</span>&#160;                <span class="keywordflow">return</span> array(<span class="charliteral">&#39;H&#39;</span> =&gt; 0, <span class="charliteral">&#39;V&#39;</span> =&gt; 0);</div>
<div class="line"><a name="l16192"></a><span class="lineno">16192</span>&#160;            }</div>
<div class="line"><a name="l16193"></a><span class="lineno">16193</span>&#160;        }</div>
<div class="line"><a name="l16194"></a><span class="lineno">16194</span>&#160;        <span class="keywordflow">if</span> ($width == 0) {</div>
<div class="line"><a name="l16195"></a><span class="lineno">16195</span>&#160;            $width = $this-&gt;w - $this-&gt;lMargin - <a class="code" href="../../d4/d40/classTCPDF.html#a44fb75b85bea40ced25fdea9d89dc8e9">$this-&gt;rMargin</a>;</div>
<div class="line"><a name="l16196"></a><span class="lineno">16196</span>&#160;        }</div>
<div class="line"><a name="l16197"></a><span class="lineno">16197</span>&#160;        $border_spacing[<span class="charliteral">&#39;H&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9">getHTMLUnitToUnits</a>($border_spacing[<span class="charliteral">&#39;H&#39;</span>], $width, <span class="stringliteral">&#39;px&#39;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l16198"></a><span class="lineno">16198</span>&#160;        $border_spacing[<span class="charliteral">&#39;V&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9">getHTMLUnitToUnits</a>($border_spacing[<span class="charliteral">&#39;V&#39;</span>], $width, <span class="stringliteral">&#39;px&#39;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l16199"></a><span class="lineno">16199</span>&#160;        <span class="keywordflow">return</span> $border_spacing;</div>
<div class="line"><a name="l16200"></a><span class="lineno">16200</span>&#160;    }</div>
<div class="line"><a name="l16201"></a><span class="lineno">16201</span>&#160;</div>
<div class="line"><a name="l16210"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a4f4b2eb6bd3ea30b0cfa58a10396736b">16210</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a4f4b2eb6bd3ea30b0cfa58a10396736b">getCSSFontSpacing</a>($spacing, $parent=0) {</div>
<div class="line"><a name="l16211"></a><span class="lineno">16211</span>&#160;        $val = 0; <span class="comment">// value to be returned</span></div>
<div class="line"><a name="l16212"></a><span class="lineno">16212</span>&#160;        $spacing = trim($spacing);</div>
<div class="line"><a name="l16213"></a><span class="lineno">16213</span>&#160;        <span class="keywordflow">switch</span> ($spacing) {</div>
<div class="line"><a name="l16214"></a><span class="lineno">16214</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;normal&#39;</span>: {</div>
<div class="line"><a name="l16215"></a><span class="lineno">16215</span>&#160;                $val = 0;</div>
<div class="line"><a name="l16216"></a><span class="lineno">16216</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l16217"></a><span class="lineno">16217</span>&#160;            }</div>
<div class="line"><a name="l16218"></a><span class="lineno">16218</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;inherit&#39;</span>: {</div>
<div class="line"><a name="l16219"></a><span class="lineno">16219</span>&#160;                <span class="keywordflow">if</span> ($parent == <span class="stringliteral">&#39;normal&#39;</span>) {</div>
<div class="line"><a name="l16220"></a><span class="lineno">16220</span>&#160;                    $val = 0;</div>
<div class="line"><a name="l16221"></a><span class="lineno">16221</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l16222"></a><span class="lineno">16222</span>&#160;                    $val = $parent;</div>
<div class="line"><a name="l16223"></a><span class="lineno">16223</span>&#160;                }</div>
<div class="line"><a name="l16224"></a><span class="lineno">16224</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l16225"></a><span class="lineno">16225</span>&#160;            }</div>
<div class="line"><a name="l16226"></a><span class="lineno">16226</span>&#160;            <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l16227"></a><span class="lineno">16227</span>&#160;                $val = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9">getHTMLUnitToUnits</a>($spacing, 0, <span class="stringliteral">&#39;px&#39;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l16228"></a><span class="lineno">16228</span>&#160;            }</div>
<div class="line"><a name="l16229"></a><span class="lineno">16229</span>&#160;        }</div>
<div class="line"><a name="l16230"></a><span class="lineno">16230</span>&#160;        <span class="keywordflow">return</span> $val;</div>
<div class="line"><a name="l16231"></a><span class="lineno">16231</span>&#160;    }</div>
<div class="line"><a name="l16232"></a><span class="lineno">16232</span>&#160;</div>
<div class="line"><a name="l16241"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a0d8075a3d1489875d600e7735c790929">16241</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a0d8075a3d1489875d600e7735c790929">getCSSFontStretching</a>($stretch, $parent=100) {</div>
<div class="line"><a name="l16242"></a><span class="lineno">16242</span>&#160;        $val = 100; <span class="comment">// value to be returned</span></div>
<div class="line"><a name="l16243"></a><span class="lineno">16243</span>&#160;        $stretch = trim($stretch);</div>
<div class="line"><a name="l16244"></a><span class="lineno">16244</span>&#160;        <span class="keywordflow">switch</span> ($stretch) {</div>
<div class="line"><a name="l16245"></a><span class="lineno">16245</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;ultra-condensed&#39;</span>: {</div>
<div class="line"><a name="l16246"></a><span class="lineno">16246</span>&#160;                $val = 40;</div>
<div class="line"><a name="l16247"></a><span class="lineno">16247</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l16248"></a><span class="lineno">16248</span>&#160;            }</div>
<div class="line"><a name="l16249"></a><span class="lineno">16249</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;extra-condensed&#39;</span>: {</div>
<div class="line"><a name="l16250"></a><span class="lineno">16250</span>&#160;                $val = 55;</div>
<div class="line"><a name="l16251"></a><span class="lineno">16251</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l16252"></a><span class="lineno">16252</span>&#160;            }</div>
<div class="line"><a name="l16253"></a><span class="lineno">16253</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;condensed&#39;</span>: {</div>
<div class="line"><a name="l16254"></a><span class="lineno">16254</span>&#160;                $val = 70;</div>
<div class="line"><a name="l16255"></a><span class="lineno">16255</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l16256"></a><span class="lineno">16256</span>&#160;            }</div>
<div class="line"><a name="l16257"></a><span class="lineno">16257</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;semi-condensed&#39;</span>: {</div>
<div class="line"><a name="l16258"></a><span class="lineno">16258</span>&#160;                $val = 85;</div>
<div class="line"><a name="l16259"></a><span class="lineno">16259</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l16260"></a><span class="lineno">16260</span>&#160;            }</div>
<div class="line"><a name="l16261"></a><span class="lineno">16261</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;normal&#39;</span>: {</div>
<div class="line"><a name="l16262"></a><span class="lineno">16262</span>&#160;                $val = 100;</div>
<div class="line"><a name="l16263"></a><span class="lineno">16263</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l16264"></a><span class="lineno">16264</span>&#160;            }</div>
<div class="line"><a name="l16265"></a><span class="lineno">16265</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;semi-expanded&#39;</span>: {</div>
<div class="line"><a name="l16266"></a><span class="lineno">16266</span>&#160;                $val = 115;</div>
<div class="line"><a name="l16267"></a><span class="lineno">16267</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l16268"></a><span class="lineno">16268</span>&#160;            }</div>
<div class="line"><a name="l16269"></a><span class="lineno">16269</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;expanded&#39;</span>: {</div>
<div class="line"><a name="l16270"></a><span class="lineno">16270</span>&#160;                $val = 130;</div>
<div class="line"><a name="l16271"></a><span class="lineno">16271</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l16272"></a><span class="lineno">16272</span>&#160;            }</div>
<div class="line"><a name="l16273"></a><span class="lineno">16273</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;extra-expanded&#39;</span>: {</div>
<div class="line"><a name="l16274"></a><span class="lineno">16274</span>&#160;                $val = 145;</div>
<div class="line"><a name="l16275"></a><span class="lineno">16275</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l16276"></a><span class="lineno">16276</span>&#160;            }</div>
<div class="line"><a name="l16277"></a><span class="lineno">16277</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;ultra-expanded&#39;</span>: {</div>
<div class="line"><a name="l16278"></a><span class="lineno">16278</span>&#160;                $val = 160;</div>
<div class="line"><a name="l16279"></a><span class="lineno">16279</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l16280"></a><span class="lineno">16280</span>&#160;            }</div>
<div class="line"><a name="l16281"></a><span class="lineno">16281</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;wider&#39;</span>: {</div>
<div class="line"><a name="l16282"></a><span class="lineno">16282</span>&#160;                $val = ($parent + 10);</div>
<div class="line"><a name="l16283"></a><span class="lineno">16283</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l16284"></a><span class="lineno">16284</span>&#160;            }</div>
<div class="line"><a name="l16285"></a><span class="lineno">16285</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;narrower&#39;</span>: {</div>
<div class="line"><a name="l16286"></a><span class="lineno">16286</span>&#160;                $val = ($parent - 10);</div>
<div class="line"><a name="l16287"></a><span class="lineno">16287</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l16288"></a><span class="lineno">16288</span>&#160;            }</div>
<div class="line"><a name="l16289"></a><span class="lineno">16289</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;inherit&#39;</span>: {</div>
<div class="line"><a name="l16290"></a><span class="lineno">16290</span>&#160;                <span class="keywordflow">if</span> ($parent == <span class="stringliteral">&#39;normal&#39;</span>) {</div>
<div class="line"><a name="l16291"></a><span class="lineno">16291</span>&#160;                    $val = 100;</div>
<div class="line"><a name="l16292"></a><span class="lineno">16292</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l16293"></a><span class="lineno">16293</span>&#160;                    $val = $parent;</div>
<div class="line"><a name="l16294"></a><span class="lineno">16294</span>&#160;                }</div>
<div class="line"><a name="l16295"></a><span class="lineno">16295</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l16296"></a><span class="lineno">16296</span>&#160;            }</div>
<div class="line"><a name="l16297"></a><span class="lineno">16297</span>&#160;            <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l16298"></a><span class="lineno">16298</span>&#160;                $val = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9">getHTMLUnitToUnits</a>($stretch, 100, <span class="charliteral">&#39;%&#39;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l16299"></a><span class="lineno">16299</span>&#160;            }</div>
<div class="line"><a name="l16300"></a><span class="lineno">16300</span>&#160;        }</div>
<div class="line"><a name="l16301"></a><span class="lineno">16301</span>&#160;        <span class="keywordflow">return</span> $val;</div>
<div class="line"><a name="l16302"></a><span class="lineno">16302</span>&#160;    }</div>
<div class="line"><a name="l16303"></a><span class="lineno">16303</span>&#160;</div>
<div class="line"><a name="l16313"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ac7f2c7f76bd73f9c6874ec6b3a738a2c">16313</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ac7f2c7f76bd73f9c6874ec6b3a738a2c">getHTMLFontUnits</a>($val, $refsize=12, $parent_size=12, $defaultunit=<span class="stringliteral">&#39;pt&#39;</span>) {</div>
<div class="line"><a name="l16314"></a><span class="lineno">16314</span>&#160;        $refsize = TCPDF_FONTS::getFontRefSize($refsize);</div>
<div class="line"><a name="l16315"></a><span class="lineno">16315</span>&#160;        $parent_size = TCPDF_FONTS::getFontRefSize($parent_size, $refsize);</div>
<div class="line"><a name="l16316"></a><span class="lineno">16316</span>&#160;        <span class="keywordflow">switch</span> ($val) {</div>
<div class="line"><a name="l16317"></a><span class="lineno">16317</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;xx-small&#39;</span>: {</div>
<div class="line"><a name="l16318"></a><span class="lineno">16318</span>&#160;                $size = ($refsize - 4);</div>
<div class="line"><a name="l16319"></a><span class="lineno">16319</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l16320"></a><span class="lineno">16320</span>&#160;            }</div>
<div class="line"><a name="l16321"></a><span class="lineno">16321</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;x-small&#39;</span>: {</div>
<div class="line"><a name="l16322"></a><span class="lineno">16322</span>&#160;                $size = ($refsize - 3);</div>
<div class="line"><a name="l16323"></a><span class="lineno">16323</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l16324"></a><span class="lineno">16324</span>&#160;            }</div>
<div class="line"><a name="l16325"></a><span class="lineno">16325</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;small&#39;</span>: {</div>
<div class="line"><a name="l16326"></a><span class="lineno">16326</span>&#160;                $size = ($refsize - 2);</div>
<div class="line"><a name="l16327"></a><span class="lineno">16327</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l16328"></a><span class="lineno">16328</span>&#160;            }</div>
<div class="line"><a name="l16329"></a><span class="lineno">16329</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;medium&#39;</span>: {</div>
<div class="line"><a name="l16330"></a><span class="lineno">16330</span>&#160;                $size = $refsize;</div>
<div class="line"><a name="l16331"></a><span class="lineno">16331</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l16332"></a><span class="lineno">16332</span>&#160;            }</div>
<div class="line"><a name="l16333"></a><span class="lineno">16333</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;large&#39;</span>: {</div>
<div class="line"><a name="l16334"></a><span class="lineno">16334</span>&#160;                $size = ($refsize + 2);</div>
<div class="line"><a name="l16335"></a><span class="lineno">16335</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l16336"></a><span class="lineno">16336</span>&#160;            }</div>
<div class="line"><a name="l16337"></a><span class="lineno">16337</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;x-large&#39;</span>: {</div>
<div class="line"><a name="l16338"></a><span class="lineno">16338</span>&#160;                $size = ($refsize + 4);</div>
<div class="line"><a name="l16339"></a><span class="lineno">16339</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l16340"></a><span class="lineno">16340</span>&#160;            }</div>
<div class="line"><a name="l16341"></a><span class="lineno">16341</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;xx-large&#39;</span>: {</div>
<div class="line"><a name="l16342"></a><span class="lineno">16342</span>&#160;                $size = ($refsize + 6);</div>
<div class="line"><a name="l16343"></a><span class="lineno">16343</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l16344"></a><span class="lineno">16344</span>&#160;            }</div>
<div class="line"><a name="l16345"></a><span class="lineno">16345</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;smaller&#39;</span>: {</div>
<div class="line"><a name="l16346"></a><span class="lineno">16346</span>&#160;                $size = ($parent_size - 3);</div>
<div class="line"><a name="l16347"></a><span class="lineno">16347</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l16348"></a><span class="lineno">16348</span>&#160;            }</div>
<div class="line"><a name="l16349"></a><span class="lineno">16349</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;larger&#39;</span>: {</div>
<div class="line"><a name="l16350"></a><span class="lineno">16350</span>&#160;                $size = ($parent_size + 3);</div>
<div class="line"><a name="l16351"></a><span class="lineno">16351</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l16352"></a><span class="lineno">16352</span>&#160;            }</div>
<div class="line"><a name="l16353"></a><span class="lineno">16353</span>&#160;            <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l16354"></a><span class="lineno">16354</span>&#160;                $size = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9">getHTMLUnitToUnits</a>($val, $parent_size, $defaultunit, <span class="keyword">true</span>);</div>
<div class="line"><a name="l16355"></a><span class="lineno">16355</span>&#160;            }</div>
<div class="line"><a name="l16356"></a><span class="lineno">16356</span>&#160;        }</div>
<div class="line"><a name="l16357"></a><span class="lineno">16357</span>&#160;        <span class="keywordflow">return</span> $size;</div>
<div class="line"><a name="l16358"></a><span class="lineno">16358</span>&#160;    }</div>
<div class="line"><a name="l16359"></a><span class="lineno">16359</span>&#160;</div>
<div class="line"><a name="l16367"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a591ae03ca6c5202c19a36d3dccb1eb0a">16367</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a591ae03ca6c5202c19a36d3dccb1eb0a">getHtmlDomArray</a>($html) {</div>
<div class="line"><a name="l16368"></a><span class="lineno">16368</span>&#160;        <span class="comment">// array of CSS styles ( selector =&gt; properties).</span></div>
<div class="line"><a name="l16369"></a><span class="lineno">16369</span>&#160;        $css = array();</div>
<div class="line"><a name="l16370"></a><span class="lineno">16370</span>&#160;        <span class="comment">// get CSS array defined at previous call</span></div>
<div class="line"><a name="l16371"></a><span class="lineno">16371</span>&#160;        $matches = array();</div>
<div class="line"><a name="l16372"></a><span class="lineno">16372</span>&#160;        <span class="keywordflow">if</span> (preg_match_all(<span class="stringliteral">&#39;/&lt;cssarray&gt;([^&lt;]*)&lt;\/cssarray&gt;/isU&#39;</span>, $html, $matches) &gt; 0) {</div>
<div class="line"><a name="l16373"></a><span class="lineno">16373</span>&#160;            <span class="keywordflow">if</span> (isset($matches[1][0])) {</div>
<div class="line"><a name="l16374"></a><span class="lineno">16374</span>&#160;                $css = array_merge($css, json_decode($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ae4bdb1a4c29d0a0d707caad308dcd320">unhtmlentities</a>($matches[1][0]), <span class="keyword">true</span>));</div>
<div class="line"><a name="l16375"></a><span class="lineno">16375</span>&#160;            }</div>
<div class="line"><a name="l16376"></a><span class="lineno">16376</span>&#160;            $html = preg_replace(<span class="stringliteral">&#39;/&lt;cssarray&gt;(.*?)&lt;\/cssarray&gt;/isU&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $html);</div>
<div class="line"><a name="l16377"></a><span class="lineno">16377</span>&#160;        }</div>
<div class="line"><a name="l16378"></a><span class="lineno">16378</span>&#160;        <span class="comment">// extract external CSS files</span></div>
<div class="line"><a name="l16379"></a><span class="lineno">16379</span>&#160;        $matches = array();</div>
<div class="line"><a name="l16380"></a><span class="lineno">16380</span>&#160;        <span class="keywordflow">if</span> (preg_match_all(<span class="stringliteral">&#39;/&lt;link([^&gt;]*)&gt;/isU&#39;</span>, $html, $matches) &gt; 0) {</div>
<div class="line"><a name="l16381"></a><span class="lineno">16381</span>&#160;            <span class="keywordflow">foreach</span> ($matches[1] as $key =&gt; $link) {</div>
<div class="line"><a name="l16382"></a><span class="lineno">16382</span>&#160;                $type = array();</div>
<div class="line"><a name="l16383"></a><span class="lineno">16383</span>&#160;                <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/type[\s]*=[\s]*&quot;text\/css&quot;/&#39;</span>, $link, $type)) {</div>
<div class="line"><a name="l16384"></a><span class="lineno">16384</span>&#160;                    $type = array();</div>
<div class="line"><a name="l16385"></a><span class="lineno">16385</span>&#160;                    preg_match(<span class="stringliteral">&#39;/media[\s]*=[\s]*&quot;([^&quot;]*)&quot;/&#39;</span>, $link, $type);</div>
<div class="line"><a name="l16386"></a><span class="lineno">16386</span>&#160;                    <span class="comment">// get &#39;all&#39; and &#39;print&#39; media, other media types are discarded</span></div>
<div class="line"><a name="l16387"></a><span class="lineno">16387</span>&#160;                    <span class="comment">// (all, braille, embossed, handheld, print, projection, screen, speech, tty, tv)</span></div>
<div class="line"><a name="l16388"></a><span class="lineno">16388</span>&#160;                    <span class="keywordflow">if</span> (empty($type) OR (isset($type[1]) AND (($type[1] == <span class="stringliteral">&#39;all&#39;</span>) OR ($type[1] == <span class="stringliteral">&#39;print&#39;</span>)))) {</div>
<div class="line"><a name="l16389"></a><span class="lineno">16389</span>&#160;                        $type = array();</div>
<div class="line"><a name="l16390"></a><span class="lineno">16390</span>&#160;                        <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/href[\s]*=[\s]*&quot;([^&quot;]*)&quot;/&#39;</span>, $link, $type) &gt; 0) {</div>
<div class="line"><a name="l16391"></a><span class="lineno">16391</span>&#160;                            <span class="comment">// read CSS data file</span></div>
<div class="line"><a name="l16392"></a><span class="lineno">16392</span>&#160;                            $cssdata = TCPDF_STATIC::fileGetContents(trim($type[1]));</div>
<div class="line"><a name="l16393"></a><span class="lineno">16393</span>&#160;                            <span class="keywordflow">if</span> (($cssdata !== FALSE) AND (strlen($cssdata) &gt; 0)) {</div>
<div class="line"><a name="l16394"></a><span class="lineno">16394</span>&#160;                                $css = array_merge($css, TCPDF_STATIC::extractCSSproperties($cssdata));</div>
<div class="line"><a name="l16395"></a><span class="lineno">16395</span>&#160;                            }</div>
<div class="line"><a name="l16396"></a><span class="lineno">16396</span>&#160;                        }</div>
<div class="line"><a name="l16397"></a><span class="lineno">16397</span>&#160;                    }</div>
<div class="line"><a name="l16398"></a><span class="lineno">16398</span>&#160;                }</div>
<div class="line"><a name="l16399"></a><span class="lineno">16399</span>&#160;            }</div>
<div class="line"><a name="l16400"></a><span class="lineno">16400</span>&#160;        }</div>
<div class="line"><a name="l16401"></a><span class="lineno">16401</span>&#160;        <span class="comment">// extract style tags</span></div>
<div class="line"><a name="l16402"></a><span class="lineno">16402</span>&#160;        $matches = array();</div>
<div class="line"><a name="l16403"></a><span class="lineno">16403</span>&#160;        <span class="keywordflow">if</span> (preg_match_all(<span class="stringliteral">&#39;/&lt;style([^&gt;]*)&gt;([^&lt;]*)&lt;\/style&gt;/isU&#39;</span>, $html, $matches) &gt; 0) {</div>
<div class="line"><a name="l16404"></a><span class="lineno">16404</span>&#160;            <span class="keywordflow">foreach</span> ($matches[1] as $key =&gt; $media) {</div>
<div class="line"><a name="l16405"></a><span class="lineno">16405</span>&#160;                $type = array();</div>
<div class="line"><a name="l16406"></a><span class="lineno">16406</span>&#160;                preg_match(<span class="stringliteral">&#39;/media[\s]*=[\s]*&quot;([^&quot;]*)&quot;/&#39;</span>, $media, $type);</div>
<div class="line"><a name="l16407"></a><span class="lineno">16407</span>&#160;                <span class="comment">// get &#39;all&#39; and &#39;print&#39; media, other media types are discarded</span></div>
<div class="line"><a name="l16408"></a><span class="lineno">16408</span>&#160;                <span class="comment">// (all, braille, embossed, handheld, print, projection, screen, speech, tty, tv)</span></div>
<div class="line"><a name="l16409"></a><span class="lineno">16409</span>&#160;                <span class="keywordflow">if</span> (empty($type) OR (isset($type[1]) AND (($type[1] == <span class="stringliteral">&#39;all&#39;</span>) OR ($type[1] == <span class="stringliteral">&#39;print&#39;</span>)))) {</div>
<div class="line"><a name="l16410"></a><span class="lineno">16410</span>&#160;                    $cssdata = $matches[2][$key];</div>
<div class="line"><a name="l16411"></a><span class="lineno">16411</span>&#160;                    $css = array_merge($css, TCPDF_STATIC::extractCSSproperties($cssdata));</div>
<div class="line"><a name="l16412"></a><span class="lineno">16412</span>&#160;                }</div>
<div class="line"><a name="l16413"></a><span class="lineno">16413</span>&#160;            }</div>
<div class="line"><a name="l16414"></a><span class="lineno">16414</span>&#160;        }</div>
<div class="line"><a name="l16415"></a><span class="lineno">16415</span>&#160;        <span class="comment">// create a special tag to contain the CSS array (used for table content)</span></div>
<div class="line"><a name="l16416"></a><span class="lineno">16416</span>&#160;        $csstagarray = <span class="stringliteral">&#39;&lt;cssarray&gt;&#39;</span>.htmlentities(json_encode($css)).<span class="stringliteral">&#39;&lt;/cssarray&gt;&#39;</span>;</div>
<div class="line"><a name="l16417"></a><span class="lineno">16417</span>&#160;        <span class="comment">// remove head and style blocks</span></div>
<div class="line"><a name="l16418"></a><span class="lineno">16418</span>&#160;        $html = preg_replace(<span class="stringliteral">&#39;/&lt;head([^&gt;]*)&gt;(.*?)&lt;\/head&gt;/siU&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $html);</div>
<div class="line"><a name="l16419"></a><span class="lineno">16419</span>&#160;        $html = preg_replace(<span class="stringliteral">&#39;/&lt;style([^&gt;]*)&gt;([^&lt;]*)&lt;\/style&gt;/isU&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $html);</div>
<div class="line"><a name="l16420"></a><span class="lineno">16420</span>&#160;        <span class="comment">// define block tags</span></div>
<div class="line"><a name="l16421"></a><span class="lineno">16421</span>&#160;        $blocktags = array(<span class="stringliteral">&#39;blockquote&#39;</span>,<span class="stringliteral">&#39;br&#39;</span>,<span class="stringliteral">&#39;dd&#39;</span>,<span class="stringliteral">&#39;dl&#39;</span>,<span class="stringliteral">&#39;div&#39;</span>,<span class="stringliteral">&#39;dt&#39;</span>,<span class="stringliteral">&#39;h1&#39;</span>,<span class="stringliteral">&#39;h2&#39;</span>,<span class="stringliteral">&#39;h3&#39;</span>,<span class="stringliteral">&#39;h4&#39;</span>,<span class="stringliteral">&#39;h5&#39;</span>,<span class="stringliteral">&#39;h6&#39;</span>,<span class="stringliteral">&#39;hr&#39;</span>,<span class="stringliteral">&#39;li&#39;</span>,<span class="stringliteral">&#39;ol&#39;</span>,<span class="charliteral">&#39;p&#39;</span>,<span class="stringliteral">&#39;pre&#39;</span>,<span class="stringliteral">&#39;ul&#39;</span>,<span class="stringliteral">&#39;tcpdf&#39;</span>,<span class="stringliteral">&#39;table&#39;</span>,<span class="stringliteral">&#39;tr&#39;</span>,<span class="stringliteral">&#39;td&#39;</span>);</div>
<div class="line"><a name="l16422"></a><span class="lineno">16422</span>&#160;        <span class="comment">// define self-closing tags</span></div>
<div class="line"><a name="l16423"></a><span class="lineno">16423</span>&#160;        $selfclosingtags = array(<span class="stringliteral">&#39;area&#39;</span>,<span class="stringliteral">&#39;base&#39;</span>,<span class="stringliteral">&#39;basefont&#39;</span>,<span class="stringliteral">&#39;br&#39;</span>,<span class="stringliteral">&#39;hr&#39;</span>,<span class="stringliteral">&#39;input&#39;</span>,<span class="stringliteral">&#39;img&#39;</span>,<span class="stringliteral">&#39;link&#39;</span>,<span class="stringliteral">&#39;meta&#39;</span>);</div>
<div class="line"><a name="l16424"></a><span class="lineno">16424</span>&#160;        <span class="comment">// remove all unsupported tags (the line below lists all supported tags)</span></div>
<div class="line"><a name="l16425"></a><span class="lineno">16425</span>&#160;        $html = strip_tags($html, <span class="stringliteral">&#39;&lt;marker/&gt;&lt;a&gt;&lt;b&gt;&lt;blockquote&gt;&lt;body&gt;&lt;br&gt;&lt;br/&gt;&lt;dd&gt;&lt;del&gt;&lt;div&gt;&lt;dl&gt;&lt;dt&gt;&lt;em&gt;&lt;font&gt;&lt;form&gt;&lt;h1&gt;&lt;h2&gt;&lt;h3&gt;&lt;h4&gt;&lt;h5&gt;&lt;h6&gt;&lt;hr&gt;&lt;hr/&gt;&lt;i&gt;&lt;img&gt;&lt;input&gt;&lt;label&gt;&lt;li&gt;&lt;ol&gt;&lt;option&gt;&lt;p&gt;&lt;pre&gt;&lt;s&gt;&lt;select&gt;&lt;small&gt;&lt;span&gt;&lt;strike&gt;&lt;strong&gt;&lt;sub&gt;&lt;sup&gt;&lt;table&gt;&lt;tablehead&gt;&lt;tcpdf&gt;&lt;td&gt;&lt;textarea&gt;&lt;th&gt;&lt;thead&gt;&lt;tr&gt;&lt;tt&gt;&lt;u&gt;&lt;ul&gt;&#39;</span>);</div>
<div class="line"><a name="l16426"></a><span class="lineno">16426</span>&#160;        <span class="comment">//replace some blank characters</span></div>
<div class="line"><a name="l16427"></a><span class="lineno">16427</span>&#160;        $html = preg_replace(<span class="stringliteral">&#39;/&lt;pre/&#39;</span>, <span class="stringliteral">&#39;&lt;xre&#39;</span>, $html); <span class="comment">// preserve pre tag</span></div>
<div class="line"><a name="l16428"></a><span class="lineno">16428</span>&#160;        $html = preg_replace(<span class="stringliteral">&#39;/&lt;(table|tr|td|th|tcpdf|blockquote|dd|div|dl|dt|form|h1|h2|h3|h4|h5|h6|br|hr|li|ol|ul|p)([^&gt;]*)&gt;[\n\r\t]+/&#39;</span>, <span class="stringliteral">&#39;&lt;\\1\\2&gt;&#39;</span>, $html);</div>
<div class="line"><a name="l16429"></a><span class="lineno">16429</span>&#160;        $html = preg_replace(<span class="stringliteral">&#39;@(\r\n|\r)@&#39;</span>, <span class="stringliteral">&quot;\n&quot;</span>, $html);</div>
<div class="line"><a name="l16430"></a><span class="lineno">16430</span>&#160;        $repTable = array(<span class="stringliteral">&quot;\t&quot;</span> =&gt; <span class="charliteral">&#39; &#39;</span>, <span class="stringliteral">&quot;\0&quot;</span> =&gt; <span class="charliteral">&#39; &#39;</span>, <span class="stringliteral">&quot;\x0B&quot;</span> =&gt; <span class="charliteral">&#39; &#39;</span>, <span class="stringliteral">&quot;\\&quot;</span> =&gt; <span class="stringliteral">&quot;\\\\&quot;</span>);</div>
<div class="line"><a name="l16431"></a><span class="lineno">16431</span>&#160;        $html = strtr($html, $repTable);</div>
<div class="line"><a name="l16432"></a><span class="lineno">16432</span>&#160;        $offset = 0;</div>
<div class="line"><a name="l16433"></a><span class="lineno">16433</span>&#160;        <span class="keywordflow">while</span> (($offset &lt; strlen($html)) AND ($pos = strpos($html, <span class="stringliteral">&#39;&lt;/pre&gt;&#39;</span>, $offset)) !== <span class="keyword">false</span>) {</div>
<div class="line"><a name="l16434"></a><span class="lineno">16434</span>&#160;            $html_a = substr($html, 0, $offset);</div>
<div class="line"><a name="l16435"></a><span class="lineno">16435</span>&#160;            $html_b = substr($html, $offset, ($pos - $offset + 6));</div>
<div class="line"><a name="l16436"></a><span class="lineno">16436</span>&#160;            <span class="keywordflow">while</span> (preg_match(<span class="stringliteral">&quot;&#39;&lt;xre([^&gt;]*)&gt;(.*?)\n(.*?)&lt;/pre&gt;&#39;si&quot;</span>, $html_b)) {</div>
<div class="line"><a name="l16437"></a><span class="lineno">16437</span>&#160;                <span class="comment">// preserve newlines on &lt;pre&gt; tag</span></div>
<div class="line"><a name="l16438"></a><span class="lineno">16438</span>&#160;                $html_b = preg_replace(<span class="stringliteral">&quot;&#39;&lt;xre([^&gt;]*)&gt;(.*?)\n(.*?)&lt;/pre&gt;&#39;si&quot;</span>, <span class="stringliteral">&quot;&lt;xre\\1&gt;\\2&lt;br /&gt;\\3&lt;/pre&gt;&quot;</span>, $html_b);</div>
<div class="line"><a name="l16439"></a><span class="lineno">16439</span>&#160;            }</div>
<div class="line"><a name="l16440"></a><span class="lineno">16440</span>&#160;            <span class="keywordflow">while</span> (preg_match(<span class="stringliteral">&quot;&#39;&lt;xre([^&gt;]*)&gt;(.*?)&quot;</span>.$this-&gt;re_space[<span class="charliteral">&#39;p&#39;</span>].<span class="stringliteral">&quot;(.*?)&lt;/pre&gt;&#39;&quot;</span>.$this-&gt;re_space[<span class="charliteral">&#39;m&#39;</span>], $html_b)) {</div>
<div class="line"><a name="l16441"></a><span class="lineno">16441</span>&#160;                <span class="comment">// preserve spaces on &lt;pre&gt; tag</span></div>
<div class="line"><a name="l16442"></a><span class="lineno">16442</span>&#160;                $html_b = preg_replace(<span class="stringliteral">&quot;&#39;&lt;xre([^&gt;]*)&gt;(.*?)&quot;</span>.$this-&gt;re_space[<span class="charliteral">&#39;p&#39;</span>].<span class="stringliteral">&quot;(.*?)&lt;/pre&gt;&#39;&quot;</span>.$this-&gt;re_space[<span class="charliteral">&#39;m&#39;</span>], <span class="stringliteral">&quot;&lt;xre\\1&gt;\\2&amp;nbsp;\\3&lt;/pre&gt;&quot;</span>, $html_b);</div>
<div class="line"><a name="l16443"></a><span class="lineno">16443</span>&#160;            }</div>
<div class="line"><a name="l16444"></a><span class="lineno">16444</span>&#160;            $html = $html_a.$html_b.substr($html, $pos + 6);</div>
<div class="line"><a name="l16445"></a><span class="lineno">16445</span>&#160;            $offset = strlen($html_a.$html_b);</div>
<div class="line"><a name="l16446"></a><span class="lineno">16446</span>&#160;        }</div>
<div class="line"><a name="l16447"></a><span class="lineno">16447</span>&#160;        $offset = 0;</div>
<div class="line"><a name="l16448"></a><span class="lineno">16448</span>&#160;        <span class="keywordflow">while</span> (($offset &lt; strlen($html)) AND ($pos = strpos($html, <span class="stringliteral">&#39;&lt;/textarea&gt;&#39;</span>, $offset)) !== <span class="keyword">false</span>) {</div>
<div class="line"><a name="l16449"></a><span class="lineno">16449</span>&#160;            $html_a = substr($html, 0, $offset);</div>
<div class="line"><a name="l16450"></a><span class="lineno">16450</span>&#160;            $html_b = substr($html, $offset, ($pos - $offset + 11));</div>
<div class="line"><a name="l16451"></a><span class="lineno">16451</span>&#160;            <span class="keywordflow">while</span> (preg_match(<span class="stringliteral">&quot;&#39;&lt;textarea([^&gt;]*)&gt;(.*?)\n(.*?)&lt;/textarea&gt;&#39;si&quot;</span>, $html_b)) {</div>
<div class="line"><a name="l16452"></a><span class="lineno">16452</span>&#160;                <span class="comment">// preserve newlines on &lt;textarea&gt; tag</span></div>
<div class="line"><a name="l16453"></a><span class="lineno">16453</span>&#160;                $html_b = preg_replace(<span class="stringliteral">&quot;&#39;&lt;textarea([^&gt;]*)&gt;(.*?)\n(.*?)&lt;/textarea&gt;&#39;si&quot;</span>, <span class="stringliteral">&quot;&lt;textarea\\1&gt;\\2&lt;TBR&gt;\\3&lt;/textarea&gt;&quot;</span>, $html_b);</div>
<div class="line"><a name="l16454"></a><span class="lineno">16454</span>&#160;                $html_b = preg_replace(<span class="stringliteral">&quot;&#39;&lt;textarea([^&gt;]*)&gt;(.*?)[\&quot;](.*?)&lt;/textarea&gt;&#39;si&quot;</span>, <span class="stringliteral">&quot;&lt;textarea\\1&gt;\\2&#39;&#39;\\3&lt;/textarea&gt;&quot;</span>, $html_b);</div>
<div class="line"><a name="l16455"></a><span class="lineno">16455</span>&#160;            }</div>
<div class="line"><a name="l16456"></a><span class="lineno">16456</span>&#160;            $html = $html_a.$html_b.substr($html, $pos + 11);</div>
<div class="line"><a name="l16457"></a><span class="lineno">16457</span>&#160;            $offset = strlen($html_a.$html_b);</div>
<div class="line"><a name="l16458"></a><span class="lineno">16458</span>&#160;        }</div>
<div class="line"><a name="l16459"></a><span class="lineno">16459</span>&#160;        $html = preg_replace(<span class="stringliteral">&#39;/([\s]*)&lt;option/si&#39;</span>, <span class="stringliteral">&#39;&lt;option&#39;</span>, $html);</div>
<div class="line"><a name="l16460"></a><span class="lineno">16460</span>&#160;        $html = preg_replace(<span class="stringliteral">&#39;/&lt;\/option&gt;([\s]*)/si&#39;</span>, <span class="stringliteral">&#39;&lt;/option&gt;&#39;</span>, $html);</div>
<div class="line"><a name="l16461"></a><span class="lineno">16461</span>&#160;        $offset = 0;</div>
<div class="line"><a name="l16462"></a><span class="lineno">16462</span>&#160;        <span class="keywordflow">while</span> (($offset &lt; strlen($html)) AND ($pos = strpos($html, <span class="stringliteral">&#39;&lt;/option&gt;&#39;</span>, $offset)) !== <span class="keyword">false</span>) {</div>
<div class="line"><a name="l16463"></a><span class="lineno">16463</span>&#160;            $html_a = substr($html, 0, $offset);</div>
<div class="line"><a name="l16464"></a><span class="lineno">16464</span>&#160;            $html_b = substr($html, $offset, ($pos - $offset + 9));</div>
<div class="line"><a name="l16465"></a><span class="lineno">16465</span>&#160;            <span class="keywordflow">while</span> (preg_match(<span class="stringliteral">&quot;&#39;&lt;option([^&gt;]*)&gt;(.*?)&lt;/option&gt;&#39;si&quot;</span>, $html_b)) {</div>
<div class="line"><a name="l16466"></a><span class="lineno">16466</span>&#160;                $html_b = preg_replace(<span class="stringliteral">&quot;&#39;&lt;option([\s]+)value=\&quot;([^\&quot;]*)\&quot;([^&gt;]*)&gt;(.*?)&lt;/option&gt;&#39;si&quot;</span>, <span class="stringliteral">&quot;\\2#!TaB!#\\4#!NwL!#&quot;</span>, $html_b);</div>
<div class="line"><a name="l16467"></a><span class="lineno">16467</span>&#160;                $html_b = preg_replace(<span class="stringliteral">&quot;&#39;&lt;option([^&gt;]*)&gt;(.*?)&lt;/option&gt;&#39;si&quot;</span>, <span class="stringliteral">&quot;\\2#!NwL!#&quot;</span>, $html_b);</div>
<div class="line"><a name="l16468"></a><span class="lineno">16468</span>&#160;            }</div>
<div class="line"><a name="l16469"></a><span class="lineno">16469</span>&#160;            $html = $html_a.$html_b.substr($html, $pos + 9);</div>
<div class="line"><a name="l16470"></a><span class="lineno">16470</span>&#160;            $offset = strlen($html_a.$html_b);</div>
<div class="line"><a name="l16471"></a><span class="lineno">16471</span>&#160;        }</div>
<div class="line"><a name="l16472"></a><span class="lineno">16472</span>&#160;        <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&quot;&#39;&lt;/select&#39;si&quot;</span>, $html)) {</div>
<div class="line"><a name="l16473"></a><span class="lineno">16473</span>&#160;            $html = preg_replace(<span class="stringliteral">&quot;&#39;&lt;select([^&gt;]*)&gt;&#39;si&quot;</span>, <span class="stringliteral">&quot;&lt;select\\1 opt=\&quot;&quot;</span>, $html);</div>
<div class="line"><a name="l16474"></a><span class="lineno">16474</span>&#160;            $html = preg_replace(<span class="stringliteral">&quot;&#39;#!NwL!#&lt;/select&gt;&#39;si&quot;</span>, <span class="stringliteral">&quot;\&quot; /&gt;&quot;</span>, $html);</div>
<div class="line"><a name="l16475"></a><span class="lineno">16475</span>&#160;        }</div>
<div class="line"><a name="l16476"></a><span class="lineno">16476</span>&#160;        $html = str_replace(<span class="stringliteral">&quot;\n&quot;</span>, <span class="charliteral">&#39; &#39;</span>, $html);</div>
<div class="line"><a name="l16477"></a><span class="lineno">16477</span>&#160;        <span class="comment">// restore textarea newlines</span></div>
<div class="line"><a name="l16478"></a><span class="lineno">16478</span>&#160;        $html = str_replace(<span class="stringliteral">&#39;&lt;TBR&gt;&#39;</span>, <span class="stringliteral">&quot;\n&quot;</span>, $html);</div>
<div class="line"><a name="l16479"></a><span class="lineno">16479</span>&#160;        <span class="comment">// remove extra spaces from code</span></div>
<div class="line"><a name="l16480"></a><span class="lineno">16480</span>&#160;        $html = preg_replace(<span class="stringliteral">&#39;/[\s]+&lt;\/(table|tr|ul|ol|dl)&gt;/&#39;</span>, <span class="stringliteral">&#39;&lt;/\\1&gt;&#39;</span>, $html);</div>
<div class="line"><a name="l16481"></a><span class="lineno">16481</span>&#160;        $html = preg_replace(<span class="charliteral">&#39;/&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;p&#39;</span>].<span class="stringliteral">&#39;+&lt;\/(td|th|li|dt|dd)&gt;/&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;m&#39;</span>], <span class="stringliteral">&#39;&lt;/\\1&gt;&#39;</span>, $html);</div>
<div class="line"><a name="l16482"></a><span class="lineno">16482</span>&#160;        $html = preg_replace(<span class="stringliteral">&#39;/[\s]+&lt;(tr|td|th|li|dt|dd)/&#39;</span>, <span class="stringliteral">&#39;&lt;\\1&#39;</span>, $html);</div>
<div class="line"><a name="l16483"></a><span class="lineno">16483</span>&#160;        $html = preg_replace(<span class="charliteral">&#39;/&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;p&#39;</span>].<span class="stringliteral">&#39;+&lt;(ul|ol|dl|br)/&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;m&#39;</span>], <span class="stringliteral">&#39;&lt;\\1&#39;</span>, $html);</div>
<div class="line"><a name="l16484"></a><span class="lineno">16484</span>&#160;        $html = preg_replace(<span class="stringliteral">&#39;/&lt;\/(table|tr|td|th|blockquote|dd|dt|dl|div|dt|h1|h2|h3|h4|h5|h6|hr|li|ol|ul|p)&gt;[\s]+&lt;/&#39;</span>, <span class="stringliteral">&#39;&lt;/\\1&gt;&lt;&#39;</span>, $html);</div>
<div class="line"><a name="l16485"></a><span class="lineno">16485</span>&#160;        $html = preg_replace(<span class="stringliteral">&#39;/&lt;\/(td|th)&gt;/&#39;</span>, <span class="stringliteral">&#39;&lt;marker style=&quot;font-size:0&quot;/&gt;&lt;/\\1&gt;&#39;</span>, $html);</div>
<div class="line"><a name="l16486"></a><span class="lineno">16486</span>&#160;        $html = preg_replace(<span class="stringliteral">&#39;/&lt;\/table&gt;([\s]*)&lt;marker style=&quot;font-size:0&quot;\/&gt;/&#39;</span>, <span class="stringliteral">&#39;&lt;/table&gt;&#39;</span>, $html);</div>
<div class="line"><a name="l16487"></a><span class="lineno">16487</span>&#160;        $html = preg_replace(<span class="charliteral">&#39;/&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;p&#39;</span>].<span class="stringliteral">&#39;+&lt;img/&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;m&#39;</span>], chr(32).<span class="stringliteral">&#39;&lt;img&#39;</span>, $html);</div>
<div class="line"><a name="l16488"></a><span class="lineno">16488</span>&#160;        $html = preg_replace(<span class="stringliteral">&#39;/&lt;img([^&gt;]*)&gt;[\s]+([^&lt;])/xi&#39;</span>, <span class="stringliteral">&#39;&lt;img\\1&gt;&amp;nbsp;\\2&#39;</span>, $html);</div>
<div class="line"><a name="l16489"></a><span class="lineno">16489</span>&#160;        $html = preg_replace(<span class="stringliteral">&#39;/&lt;img([^&gt;]*)&gt;/xi&#39;</span>, <span class="stringliteral">&#39;&lt;img\\1&gt;&lt;span&gt;&lt;marker style=&quot;font-size:0&quot;/&gt;&lt;/span&gt;&#39;</span>, $html);</div>
<div class="line"><a name="l16490"></a><span class="lineno">16490</span>&#160;        $html = preg_replace(<span class="stringliteral">&#39;/&lt;xre/&#39;</span>, <span class="stringliteral">&#39;&lt;pre&#39;</span>, $html); <span class="comment">// restore pre tag</span></div>
<div class="line"><a name="l16491"></a><span class="lineno">16491</span>&#160;        $html = preg_replace(<span class="stringliteral">&#39;/&lt;textarea([^&gt;]*)&gt;([^&lt;]*)&lt;\/textarea&gt;/xi&#39;</span>, <span class="stringliteral">&#39;&lt;textarea\\1 value=&quot;\\2&quot; /&gt;&#39;</span>, $html);</div>
<div class="line"><a name="l16492"></a><span class="lineno">16492</span>&#160;        $html = preg_replace(<span class="stringliteral">&#39;/&lt;li([^&gt;]*)&gt;&lt;\/li&gt;/&#39;</span>, <span class="stringliteral">&#39;&lt;li\\1&gt;&amp;nbsp;&lt;/li&gt;&#39;</span>, $html);</div>
<div class="line"><a name="l16493"></a><span class="lineno">16493</span>&#160;        $html = preg_replace(<span class="stringliteral">&#39;/&lt;li([^&gt;]*)&gt;&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;p&#39;</span>].<span class="stringliteral">&#39;*&lt;img/&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;m&#39;</span>], <span class="stringliteral">&#39;&lt;li\\1&gt;&lt;font size=&quot;1&quot;&gt;&amp;nbsp;&lt;/font&gt;&lt;img&#39;</span>, $html);</div>
<div class="line"><a name="l16494"></a><span class="lineno">16494</span>&#160;        $html = preg_replace(<span class="stringliteral">&#39;/&lt;([^&gt;\/]*)&gt;[\s]/&#39;</span>, <span class="stringliteral">&#39;&lt;\\1&gt;&amp;nbsp;&#39;</span>, $html); <span class="comment">// preserve some spaces</span></div>
<div class="line"><a name="l16495"></a><span class="lineno">16495</span>&#160;        $html = preg_replace(<span class="stringliteral">&#39;/[\s]&lt;\/([^&gt;]*)&gt;/&#39;</span>, <span class="stringliteral">&#39;&amp;nbsp;&lt;/\\1&gt;&#39;</span>, $html); <span class="comment">// preserve some spaces</span></div>
<div class="line"><a name="l16496"></a><span class="lineno">16496</span>&#160;        $html = preg_replace(<span class="stringliteral">&#39;/&lt;su([bp])/&#39;</span>, <span class="stringliteral">&#39;&lt;zws/&gt;&lt;su\\1&#39;</span>, $html); <span class="comment">// fix sub/sup alignment</span></div>
<div class="line"><a name="l16497"></a><span class="lineno">16497</span>&#160;        $html = preg_replace(<span class="stringliteral">&#39;/&lt;\/su([bp])&gt;/&#39;</span>, <span class="stringliteral">&#39;&lt;/su\\1&gt;&lt;zws/&gt;&#39;</span>, $html); <span class="comment">// fix sub/sup alignment</span></div>
<div class="line"><a name="l16498"></a><span class="lineno">16498</span>&#160;        $html = preg_replace(<span class="charliteral">&#39;/&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;p&#39;</span>].<span class="stringliteral">&#39;+/&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;m&#39;</span>], chr(32), $html); <span class="comment">// replace multiple spaces with a single space</span></div>
<div class="line"><a name="l16499"></a><span class="lineno">16499</span>&#160;        <span class="comment">// trim string</span></div>
<div class="line"><a name="l16500"></a><span class="lineno">16500</span>&#160;        $html = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#abdc6aa462bc81023df2ec043742bcb4b">stringTrim</a>($html);</div>
<div class="line"><a name="l16501"></a><span class="lineno">16501</span>&#160;        <span class="comment">// fix br tag after li</span></div>
<div class="line"><a name="l16502"></a><span class="lineno">16502</span>&#160;        $html = preg_replace(<span class="stringliteral">&#39;/&lt;li&gt;&lt;br([^&gt;]*)&gt;/&#39;</span>, <span class="stringliteral">&#39;&lt;li&gt; &lt;br\\1&gt;&#39;</span>, $html);</div>
<div class="line"><a name="l16503"></a><span class="lineno">16503</span>&#160;        <span class="comment">// fix first image tag alignment</span></div>
<div class="line"><a name="l16504"></a><span class="lineno">16504</span>&#160;        $html = preg_replace(<span class="stringliteral">&#39;/^&lt;img/&#39;</span>, <span class="stringliteral">&#39;&lt;span style=&quot;font-size:0&quot;&gt;&lt;br /&gt;&lt;/span&gt; &lt;img&#39;</span>, $html, 1);</div>
<div class="line"><a name="l16505"></a><span class="lineno">16505</span>&#160;        <span class="comment">// pattern for generic tag</span></div>
<div class="line"><a name="l16506"></a><span class="lineno">16506</span>&#160;        $tagpattern = <span class="stringliteral">&#39;/(&lt;[^&gt;]+&gt;)/&#39;</span>;</div>
<div class="line"><a name="l16507"></a><span class="lineno">16507</span>&#160;        <span class="comment">// explodes the string</span></div>
<div class="line"><a name="l16508"></a><span class="lineno">16508</span>&#160;        $a = preg_split($tagpattern, $html, -1, PREG_SPLIT_DELIM_CAPTURE | PREG_SPLIT_NO_EMPTY);</div>
<div class="line"><a name="l16509"></a><span class="lineno">16509</span>&#160;        <span class="comment">// count elements</span></div>
<div class="line"><a name="l16510"></a><span class="lineno">16510</span>&#160;        $maxel = count($a);</div>
<div class="line"><a name="l16511"></a><span class="lineno">16511</span>&#160;        $elkey = 0;</div>
<div class="line"><a name="l16512"></a><span class="lineno">16512</span>&#160;        $key = 0;</div>
<div class="line"><a name="l16513"></a><span class="lineno">16513</span>&#160;        <span class="comment">// create an array of elements</span></div>
<div class="line"><a name="l16514"></a><span class="lineno">16514</span>&#160;        $dom = array();</div>
<div class="line"><a name="l16515"></a><span class="lineno">16515</span>&#160;        $dom[$key] = array();</div>
<div class="line"><a name="l16516"></a><span class="lineno">16516</span>&#160;        <span class="comment">// set inheritable properties fot the first void element</span></div>
<div class="line"><a name="l16517"></a><span class="lineno">16517</span>&#160;        <span class="comment">// possible inheritable properties are: azimuth, border-collapse, border-spacing, caption-side, color, cursor, direction, empty-cells, font, font-family, font-stretch, font-size, font-size-adjust, font-style, font-variant, font-weight, letter-spacing, line-height, list-style, list-style-image, list-style-position, list-style-type, orphans, page, page-break-inside, quotes, speak, speak-header, text-align, text-indent, text-transform, volume, white-space, widows, word-spacing</span></div>
<div class="line"><a name="l16518"></a><span class="lineno">16518</span>&#160;        $dom[$key][<span class="stringliteral">&#39;tag&#39;</span>] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l16519"></a><span class="lineno">16519</span>&#160;        $dom[$key][<span class="stringliteral">&#39;block&#39;</span>] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l16520"></a><span class="lineno">16520</span>&#160;        $dom[$key][<span class="stringliteral">&#39;value&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l16521"></a><span class="lineno">16521</span>&#160;        $dom[$key][<span class="stringliteral">&#39;parent&#39;</span>] = 0;</div>
<div class="line"><a name="l16522"></a><span class="lineno">16522</span>&#160;        $dom[$key][<span class="stringliteral">&#39;hide&#39;</span>] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l16523"></a><span class="lineno">16523</span>&#160;        $dom[$key][<span class="stringliteral">&#39;fontname&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a642c62438ec9c983283a98d5099ba7ba">$this-&gt;FontFamily</a>;</div>
<div class="line"><a name="l16524"></a><span class="lineno">16524</span>&#160;        $dom[$key][<span class="stringliteral">&#39;fontstyle&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a6fce74bcde6c138d286dce274950dff7">$this-&gt;FontStyle</a>;</div>
<div class="line"><a name="l16525"></a><span class="lineno">16525</span>&#160;        $dom[$key][<span class="stringliteral">&#39;fontsize&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a9a787786c9f1a04f54f1dec622869d4d">$this-&gt;FontSizePt</a>;</div>
<div class="line"><a name="l16526"></a><span class="lineno">16526</span>&#160;        $dom[$key][<span class="stringliteral">&#39;font-stretch&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a420a1fac2969936a7d57f4cb9c99849b">$this-&gt;font_stretching</a>;</div>
<div class="line"><a name="l16527"></a><span class="lineno">16527</span>&#160;        $dom[$key][<span class="stringliteral">&#39;letter-spacing&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a3f4d91c3489a2c62b628c347551f7adf">$this-&gt;font_spacing</a>;</div>
<div class="line"><a name="l16528"></a><span class="lineno">16528</span>&#160;        $dom[$key][<span class="stringliteral">&#39;stroke&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#acef86c1b60f2b45323f27c4dc9620922">$this-&gt;textstrokewidth</a>;</div>
<div class="line"><a name="l16529"></a><span class="lineno">16529</span>&#160;        $dom[$key][<span class="stringliteral">&#39;fill&#39;</span>] = (($this-&gt;textrendermode % 2) == 0);</div>
<div class="line"><a name="l16530"></a><span class="lineno">16530</span>&#160;        $dom[$key][<span class="stringliteral">&#39;clip&#39;</span>] = ($this-&gt;textrendermode &gt; 3);</div>
<div class="line"><a name="l16531"></a><span class="lineno">16531</span>&#160;        $dom[$key][<span class="stringliteral">&#39;line-height&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#af8cc74fe5806eb009a22791c3a4c7cce">$this-&gt;cell_height_ratio</a>;</div>
<div class="line"><a name="l16532"></a><span class="lineno">16532</span>&#160;        $dom[$key][<span class="stringliteral">&#39;bgcolor&#39;</span>] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l16533"></a><span class="lineno">16533</span>&#160;        $dom[$key][<span class="stringliteral">&#39;fgcolor&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a98585a6dd732caf2ba4c0ae2d9aa9841">$this-&gt;fgcolor</a>; <span class="comment">// color</span></div>
<div class="line"><a name="l16534"></a><span class="lineno">16534</span>&#160;        $dom[$key][<span class="stringliteral">&#39;strokecolor&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#aa24f8123d1e2d35446002d13a9715850">$this-&gt;strokecolor</a>;</div>
<div class="line"><a name="l16535"></a><span class="lineno">16535</span>&#160;        $dom[$key][<span class="stringliteral">&#39;align&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l16536"></a><span class="lineno">16536</span>&#160;        $dom[$key][<span class="stringliteral">&#39;listtype&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l16537"></a><span class="lineno">16537</span>&#160;        $dom[$key][<span class="stringliteral">&#39;text-indent&#39;</span>] = 0;</div>
<div class="line"><a name="l16538"></a><span class="lineno">16538</span>&#160;        $dom[$key][<span class="stringliteral">&#39;text-transform&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l16539"></a><span class="lineno">16539</span>&#160;        $dom[$key][<span class="stringliteral">&#39;border&#39;</span>] = array();</div>
<div class="line"><a name="l16540"></a><span class="lineno">16540</span>&#160;        $dom[$key][<span class="stringliteral">&#39;dir&#39;</span>] = $this-&gt;rtl?<span class="stringliteral">&#39;rtl&#39;</span>:<span class="stringliteral">&#39;ltr&#39;</span>;</div>
<div class="line"><a name="l16541"></a><span class="lineno">16541</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#ae7cd5ea4b0ef3a0910ed0044bea97f1d">$thead</a> = <span class="keyword">false</span>; <span class="comment">// true when we are inside the THEAD tag</span></div>
<div class="line"><a name="l16542"></a><span class="lineno">16542</span>&#160;        ++$key;</div>
<div class="line"><a name="l16543"></a><span class="lineno">16543</span>&#160;        $level = array();</div>
<div class="line"><a name="l16544"></a><span class="lineno">16544</span>&#160;        array_push($level, 0); <span class="comment">// root</span></div>
<div class="line"><a name="l16545"></a><span class="lineno">16545</span>&#160;        <span class="keywordflow">while</span> ($elkey &lt; $maxel) {</div>
<div class="line"><a name="l16546"></a><span class="lineno">16546</span>&#160;            $dom[$key] = array();</div>
<div class="line"><a name="l16547"></a><span class="lineno">16547</span>&#160;            $element = $a[$elkey];</div>
<div class="line"><a name="l16548"></a><span class="lineno">16548</span>&#160;            $dom[$key][<span class="stringliteral">&#39;elkey&#39;</span>] = $elkey;</div>
<div class="line"><a name="l16549"></a><span class="lineno">16549</span>&#160;            <span class="keywordflow">if</span> (preg_match($tagpattern, $element)) {</div>
<div class="line"><a name="l16550"></a><span class="lineno">16550</span>&#160;                <span class="comment">// html tag</span></div>
<div class="line"><a name="l16551"></a><span class="lineno">16551</span>&#160;                $element = substr($element, 1, -1);</div>
<div class="line"><a name="l16552"></a><span class="lineno">16552</span>&#160;                <span class="comment">// get tag name</span></div>
<div class="line"><a name="l16553"></a><span class="lineno">16553</span>&#160;                preg_match(<span class="stringliteral">&#39;/[\/]?([a-zA-Z0-9]*)/&#39;</span>, $element, $tag);</div>
<div class="line"><a name="l16554"></a><span class="lineno">16554</span>&#160;                $tagname = strtolower($tag[1]);</div>
<div class="line"><a name="l16555"></a><span class="lineno">16555</span>&#160;                <span class="comment">// check if we are inside a table header</span></div>
<div class="line"><a name="l16556"></a><span class="lineno">16556</span>&#160;                <span class="keywordflow">if</span> ($tagname == <span class="stringliteral">&#39;thead&#39;</span>) {</div>
<div class="line"><a name="l16557"></a><span class="lineno">16557</span>&#160;                    <span class="keywordflow">if</span> ($element[0] == <span class="charliteral">&#39;/&#39;</span>) {</div>
<div class="line"><a name="l16558"></a><span class="lineno">16558</span>&#160;                        <a class="code" href="../../d4/d40/classTCPDF.html#ae7cd5ea4b0ef3a0910ed0044bea97f1d">$thead</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l16559"></a><span class="lineno">16559</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l16560"></a><span class="lineno">16560</span>&#160;                        <a class="code" href="../../d4/d40/classTCPDF.html#ae7cd5ea4b0ef3a0910ed0044bea97f1d">$thead</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l16561"></a><span class="lineno">16561</span>&#160;                    }</div>
<div class="line"><a name="l16562"></a><span class="lineno">16562</span>&#160;                    ++$elkey;</div>
<div class="line"><a name="l16563"></a><span class="lineno">16563</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l16564"></a><span class="lineno">16564</span>&#160;                }</div>
<div class="line"><a name="l16565"></a><span class="lineno">16565</span>&#160;                $dom[$key][<span class="stringliteral">&#39;tag&#39;</span>] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l16566"></a><span class="lineno">16566</span>&#160;                $dom[$key][<span class="stringliteral">&#39;value&#39;</span>] = $tagname;</div>
<div class="line"><a name="l16567"></a><span class="lineno">16567</span>&#160;                <span class="keywordflow">if</span> (in_array($dom[$key][<span class="stringliteral">&#39;value&#39;</span>], $blocktags)) {</div>
<div class="line"><a name="l16568"></a><span class="lineno">16568</span>&#160;                    $dom[$key][<span class="stringliteral">&#39;block&#39;</span>] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l16569"></a><span class="lineno">16569</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l16570"></a><span class="lineno">16570</span>&#160;                    $dom[$key][<span class="stringliteral">&#39;block&#39;</span>] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l16571"></a><span class="lineno">16571</span>&#160;                }</div>
<div class="line"><a name="l16572"></a><span class="lineno">16572</span>&#160;                <span class="keywordflow">if</span> ($element[0] == <span class="charliteral">&#39;/&#39;</span>) {</div>
<div class="line"><a name="l16573"></a><span class="lineno">16573</span>&#160;                    <span class="comment">// *** closing html tag</span></div>
<div class="line"><a name="l16574"></a><span class="lineno">16574</span>&#160;                    $dom[$key][<span class="stringliteral">&#39;opening&#39;</span>] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l16575"></a><span class="lineno">16575</span>&#160;                    $dom[$key][<span class="stringliteral">&#39;parent&#39;</span>] = end($level);</div>
<div class="line"><a name="l16576"></a><span class="lineno">16576</span>&#160;                    array_pop($level);</div>
<div class="line"><a name="l16577"></a><span class="lineno">16577</span>&#160;                    $dom[$key][<span class="stringliteral">&#39;hide&#39;</span>] = $dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;hide&#39;</span>];</div>
<div class="line"><a name="l16578"></a><span class="lineno">16578</span>&#160;                    $dom[$key][<span class="stringliteral">&#39;fontname&#39;</span>] = $dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;fontname&#39;</span>];</div>
<div class="line"><a name="l16579"></a><span class="lineno">16579</span>&#160;                    $dom[$key][<span class="stringliteral">&#39;fontstyle&#39;</span>] = $dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;fontstyle&#39;</span>];</div>
<div class="line"><a name="l16580"></a><span class="lineno">16580</span>&#160;                    $dom[$key][<span class="stringliteral">&#39;fontsize&#39;</span>] = $dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;fontsize&#39;</span>];</div>
<div class="line"><a name="l16581"></a><span class="lineno">16581</span>&#160;                    $dom[$key][<span class="stringliteral">&#39;font-stretch&#39;</span>] = $dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;font-stretch&#39;</span>];</div>
<div class="line"><a name="l16582"></a><span class="lineno">16582</span>&#160;                    $dom[$key][<span class="stringliteral">&#39;letter-spacing&#39;</span>] = $dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;letter-spacing&#39;</span>];</div>
<div class="line"><a name="l16583"></a><span class="lineno">16583</span>&#160;                    $dom[$key][<span class="stringliteral">&#39;stroke&#39;</span>] = $dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;stroke&#39;</span>];</div>
<div class="line"><a name="l16584"></a><span class="lineno">16584</span>&#160;                    $dom[$key][<span class="stringliteral">&#39;fill&#39;</span>] = $dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;fill&#39;</span>];</div>
<div class="line"><a name="l16585"></a><span class="lineno">16585</span>&#160;                    $dom[$key][<span class="stringliteral">&#39;clip&#39;</span>] = $dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;clip&#39;</span>];</div>
<div class="line"><a name="l16586"></a><span class="lineno">16586</span>&#160;                    $dom[$key][<span class="stringliteral">&#39;line-height&#39;</span>] = $dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;line-height&#39;</span>];</div>
<div class="line"><a name="l16587"></a><span class="lineno">16587</span>&#160;                    $dom[$key][<span class="stringliteral">&#39;bgcolor&#39;</span>] = $dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;bgcolor&#39;</span>];</div>
<div class="line"><a name="l16588"></a><span class="lineno">16588</span>&#160;                    $dom[$key][<span class="stringliteral">&#39;fgcolor&#39;</span>] = $dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;fgcolor&#39;</span>];</div>
<div class="line"><a name="l16589"></a><span class="lineno">16589</span>&#160;                    $dom[$key][<span class="stringliteral">&#39;strokecolor&#39;</span>] = $dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;strokecolor&#39;</span>];</div>
<div class="line"><a name="l16590"></a><span class="lineno">16590</span>&#160;                    $dom[$key][<span class="stringliteral">&#39;align&#39;</span>] = $dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;align&#39;</span>];</div>
<div class="line"><a name="l16591"></a><span class="lineno">16591</span>&#160;                    $dom[$key][<span class="stringliteral">&#39;text-transform&#39;</span>] = $dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;text-transform&#39;</span>];</div>
<div class="line"><a name="l16592"></a><span class="lineno">16592</span>&#160;                    $dom[$key][<span class="stringliteral">&#39;dir&#39;</span>] = $dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;dir&#39;</span>];</div>
<div class="line"><a name="l16593"></a><span class="lineno">16593</span>&#160;                    <span class="keywordflow">if</span> (isset($dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;listtype&#39;</span>])) {</div>
<div class="line"><a name="l16594"></a><span class="lineno">16594</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;listtype&#39;</span>] = $dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;listtype&#39;</span>];</div>
<div class="line"><a name="l16595"></a><span class="lineno">16595</span>&#160;                    }</div>
<div class="line"><a name="l16596"></a><span class="lineno">16596</span>&#160;                    <span class="comment">// set the number of columns in table tag</span></div>
<div class="line"><a name="l16597"></a><span class="lineno">16597</span>&#160;                    <span class="keywordflow">if</span> (($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;tr&#39;</span>) AND (!isset($dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;cols&#39;</span>]))) {</div>
<div class="line"><a name="l16598"></a><span class="lineno">16598</span>&#160;                        $dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;cols&#39;</span>] = $dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;cols&#39;</span>];</div>
<div class="line"><a name="l16599"></a><span class="lineno">16599</span>&#160;                    }</div>
<div class="line"><a name="l16600"></a><span class="lineno">16600</span>&#160;                    <span class="keywordflow">if</span> (($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;td&#39;</span>) OR ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;th&#39;</span>)) {</div>
<div class="line"><a name="l16601"></a><span class="lineno">16601</span>&#160;                        $dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;content&#39;</span>] = $csstagarray;</div>
<div class="line"><a name="l16602"></a><span class="lineno">16602</span>&#160;                        <span class="keywordflow">for</span> ($i = ($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>] + 1); $i &lt; $key; ++$i) {</div>
<div class="line"><a name="l16603"></a><span class="lineno">16603</span>&#160;                            $dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;content&#39;</span>] .= $a[$dom[$i][<span class="stringliteral">&#39;elkey&#39;</span>]];</div>
<div class="line"><a name="l16604"></a><span class="lineno">16604</span>&#160;                        }</div>
<div class="line"><a name="l16605"></a><span class="lineno">16605</span>&#160;                        $key = $i;</div>
<div class="line"><a name="l16606"></a><span class="lineno">16606</span>&#160;                        <span class="comment">// mark nested tables</span></div>
<div class="line"><a name="l16607"></a><span class="lineno">16607</span>&#160;                        $dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;content&#39;</span>] = str_replace(<span class="stringliteral">&#39;&lt;table&#39;</span>, <span class="stringliteral">&#39;&lt;table nested=&quot;true&quot;&#39;</span>, $dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;content&#39;</span>]);</div>
<div class="line"><a name="l16608"></a><span class="lineno">16608</span>&#160;                        <span class="comment">// remove thead sections from nested tables</span></div>
<div class="line"><a name="l16609"></a><span class="lineno">16609</span>&#160;                        $dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;content&#39;</span>] = str_replace(<span class="stringliteral">&#39;&lt;thead&gt;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;content&#39;</span>]);</div>
<div class="line"><a name="l16610"></a><span class="lineno">16610</span>&#160;                        $dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;content&#39;</span>] = str_replace(<span class="stringliteral">&#39;&lt;/thead&gt;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;content&#39;</span>]);</div>
<div class="line"><a name="l16611"></a><span class="lineno">16611</span>&#160;                    }</div>
<div class="line"><a name="l16612"></a><span class="lineno">16612</span>&#160;                    <span class="comment">// store header rows on a new table</span></div>
<div class="line"><a name="l16613"></a><span class="lineno">16613</span>&#160;                    <span class="keywordflow">if</span> (($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;tr&#39;</span>) AND ($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;thead&#39;</span>] === <span class="keyword">true</span>)) {</div>
<div class="line"><a name="l16614"></a><span class="lineno">16614</span>&#160;                        <span class="keywordflow">if</span> (TCPDF_STATIC::empty_string($dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;thead&#39;</span>])) {</div>
<div class="line"><a name="l16615"></a><span class="lineno">16615</span>&#160;                            $dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;thead&#39;</span>] = $csstagarray.$a[$dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;elkey&#39;</span>]];</div>
<div class="line"><a name="l16616"></a><span class="lineno">16616</span>&#160;                        }</div>
<div class="line"><a name="l16617"></a><span class="lineno">16617</span>&#160;                        <span class="keywordflow">for</span> ($i = $dom[$key][<span class="stringliteral">&#39;parent&#39;</span>]; $i &lt;= $key; ++$i) {</div>
<div class="line"><a name="l16618"></a><span class="lineno">16618</span>&#160;                            $dom[($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;thead&#39;</span>] .= $a[$dom[$i][<span class="stringliteral">&#39;elkey&#39;</span>]];</div>
<div class="line"><a name="l16619"></a><span class="lineno">16619</span>&#160;                        }</div>
<div class="line"><a name="l16620"></a><span class="lineno">16620</span>&#160;                        <span class="keywordflow">if</span> (!isset($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;attribute&#39;</span>])) {</div>
<div class="line"><a name="l16621"></a><span class="lineno">16621</span>&#160;                            $dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;attribute&#39;</span>] = array();</div>
<div class="line"><a name="l16622"></a><span class="lineno">16622</span>&#160;                        }</div>
<div class="line"><a name="l16623"></a><span class="lineno">16623</span>&#160;                        <span class="comment">// header elements must be always contained in a single page</span></div>
<div class="line"><a name="l16624"></a><span class="lineno">16624</span>&#160;                        $dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;nobr&#39;</span>] = <span class="stringliteral">&#39;true&#39;</span>;</div>
<div class="line"><a name="l16625"></a><span class="lineno">16625</span>&#160;                    }</div>
<div class="line"><a name="l16626"></a><span class="lineno">16626</span>&#160;                    <span class="keywordflow">if</span> (($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;table&#39;</span>) AND (!TCPDF_STATIC::empty_string($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;thead&#39;</span>]))) {</div>
<div class="line"><a name="l16627"></a><span class="lineno">16627</span>&#160;                        <span class="comment">// remove the nobr attributes from the table header</span></div>
<div class="line"><a name="l16628"></a><span class="lineno">16628</span>&#160;                        $dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;thead&#39;</span>] = str_replace(<span class="stringliteral">&#39; nobr=&quot;true&quot;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;thead&#39;</span>]);</div>
<div class="line"><a name="l16629"></a><span class="lineno">16629</span>&#160;                        $dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;thead&#39;</span>] .= <span class="stringliteral">&#39;&lt;/tablehead&gt;&#39;</span>;</div>
<div class="line"><a name="l16630"></a><span class="lineno">16630</span>&#160;                    }</div>
<div class="line"><a name="l16631"></a><span class="lineno">16631</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l16632"></a><span class="lineno">16632</span>&#160;                    <span class="comment">// *** opening or self-closing html tag</span></div>
<div class="line"><a name="l16633"></a><span class="lineno">16633</span>&#160;                    $dom[$key][<span class="stringliteral">&#39;opening&#39;</span>] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l16634"></a><span class="lineno">16634</span>&#160;                    $dom[$key][<span class="stringliteral">&#39;parent&#39;</span>] = end($level);</div>
<div class="line"><a name="l16635"></a><span class="lineno">16635</span>&#160;                    <span class="keywordflow">if</span> ((substr($element, -1, 1) == <span class="charliteral">&#39;/&#39;</span>) OR (in_array($dom[$key][<span class="stringliteral">&#39;value&#39;</span>], $selfclosingtags))) {</div>
<div class="line"><a name="l16636"></a><span class="lineno">16636</span>&#160;                        <span class="comment">// self-closing tag</span></div>
<div class="line"><a name="l16637"></a><span class="lineno">16637</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;self&#39;</span>] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l16638"></a><span class="lineno">16638</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l16639"></a><span class="lineno">16639</span>&#160;                        <span class="comment">// opening tag</span></div>
<div class="line"><a name="l16640"></a><span class="lineno">16640</span>&#160;                        array_push($level, $key);</div>
<div class="line"><a name="l16641"></a><span class="lineno">16641</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;self&#39;</span>] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l16642"></a><span class="lineno">16642</span>&#160;                    }</div>
<div class="line"><a name="l16643"></a><span class="lineno">16643</span>&#160;                    <span class="comment">// copy some values from parent</span></div>
<div class="line"><a name="l16644"></a><span class="lineno">16644</span>&#160;                    $parentkey = 0;</div>
<div class="line"><a name="l16645"></a><span class="lineno">16645</span>&#160;                    <span class="keywordflow">if</span> ($key &gt; 0) {</div>
<div class="line"><a name="l16646"></a><span class="lineno">16646</span>&#160;                        $parentkey = $dom[$key][<span class="stringliteral">&#39;parent&#39;</span>];</div>
<div class="line"><a name="l16647"></a><span class="lineno">16647</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;hide&#39;</span>] = $dom[$parentkey][<span class="stringliteral">&#39;hide&#39;</span>];</div>
<div class="line"><a name="l16648"></a><span class="lineno">16648</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;fontname&#39;</span>] = $dom[$parentkey][<span class="stringliteral">&#39;fontname&#39;</span>];</div>
<div class="line"><a name="l16649"></a><span class="lineno">16649</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;fontstyle&#39;</span>] = $dom[$parentkey][<span class="stringliteral">&#39;fontstyle&#39;</span>];</div>
<div class="line"><a name="l16650"></a><span class="lineno">16650</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;fontsize&#39;</span>] = $dom[$parentkey][<span class="stringliteral">&#39;fontsize&#39;</span>];</div>
<div class="line"><a name="l16651"></a><span class="lineno">16651</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;font-stretch&#39;</span>] = $dom[$parentkey][<span class="stringliteral">&#39;font-stretch&#39;</span>];</div>
<div class="line"><a name="l16652"></a><span class="lineno">16652</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;letter-spacing&#39;</span>] = $dom[$parentkey][<span class="stringliteral">&#39;letter-spacing&#39;</span>];</div>
<div class="line"><a name="l16653"></a><span class="lineno">16653</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;stroke&#39;</span>] = $dom[$parentkey][<span class="stringliteral">&#39;stroke&#39;</span>];</div>
<div class="line"><a name="l16654"></a><span class="lineno">16654</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;fill&#39;</span>] = $dom[$parentkey][<span class="stringliteral">&#39;fill&#39;</span>];</div>
<div class="line"><a name="l16655"></a><span class="lineno">16655</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;clip&#39;</span>] = $dom[$parentkey][<span class="stringliteral">&#39;clip&#39;</span>];</div>
<div class="line"><a name="l16656"></a><span class="lineno">16656</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;line-height&#39;</span>] = $dom[$parentkey][<span class="stringliteral">&#39;line-height&#39;</span>];</div>
<div class="line"><a name="l16657"></a><span class="lineno">16657</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;bgcolor&#39;</span>] = $dom[$parentkey][<span class="stringliteral">&#39;bgcolor&#39;</span>];</div>
<div class="line"><a name="l16658"></a><span class="lineno">16658</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;fgcolor&#39;</span>] = $dom[$parentkey][<span class="stringliteral">&#39;fgcolor&#39;</span>];</div>
<div class="line"><a name="l16659"></a><span class="lineno">16659</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;strokecolor&#39;</span>] = $dom[$parentkey][<span class="stringliteral">&#39;strokecolor&#39;</span>];</div>
<div class="line"><a name="l16660"></a><span class="lineno">16660</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;align&#39;</span>] = $dom[$parentkey][<span class="stringliteral">&#39;align&#39;</span>];</div>
<div class="line"><a name="l16661"></a><span class="lineno">16661</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;listtype&#39;</span>] = $dom[$parentkey][<span class="stringliteral">&#39;listtype&#39;</span>];</div>
<div class="line"><a name="l16662"></a><span class="lineno">16662</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;text-indent&#39;</span>] = $dom[$parentkey][<span class="stringliteral">&#39;text-indent&#39;</span>];</div>
<div class="line"><a name="l16663"></a><span class="lineno">16663</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;text-transform&#39;</span>] = $dom[$parentkey][<span class="stringliteral">&#39;text-transform&#39;</span>];</div>
<div class="line"><a name="l16664"></a><span class="lineno">16664</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;border&#39;</span>] = array();</div>
<div class="line"><a name="l16665"></a><span class="lineno">16665</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;dir&#39;</span>] = $dom[$parentkey][<span class="stringliteral">&#39;dir&#39;</span>];</div>
<div class="line"><a name="l16666"></a><span class="lineno">16666</span>&#160;                    }</div>
<div class="line"><a name="l16667"></a><span class="lineno">16667</span>&#160;                    <span class="comment">// get attributes</span></div>
<div class="line"><a name="l16668"></a><span class="lineno">16668</span>&#160;                    preg_match_all(<span class="stringliteral">&#39;/([^=\s]*)[\s]*=[\s]*&quot;([^&quot;]*)&quot;/&#39;</span>, $element, $attr_array, PREG_PATTERN_ORDER);</div>
<div class="line"><a name="l16669"></a><span class="lineno">16669</span>&#160;                    $dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>] = array(); <span class="comment">// reset attribute array</span></div>
<div class="line"><a name="l16670"></a><span class="lineno">16670</span>&#160;                    <span class="keywordflow">while</span> (list($id, $name) = each($attr_array[1])) {</div>
<div class="line"><a name="l16671"></a><span class="lineno">16671</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][strtolower($name)] = $attr_array[2][$id];</div>
<div class="line"><a name="l16672"></a><span class="lineno">16672</span>&#160;                    }</div>
<div class="line"><a name="l16673"></a><span class="lineno">16673</span>&#160;                    <span class="keywordflow">if</span> (!empty($css)) {</div>
<div class="line"><a name="l16674"></a><span class="lineno">16674</span>&#160;                        <span class="comment">// merge CSS style to current style</span></div>
<div class="line"><a name="l16675"></a><span class="lineno">16675</span>&#160;                        list($dom[$key][<span class="stringliteral">&#39;csssel&#39;</span>], $dom[$key][<span class="stringliteral">&#39;cssdata&#39;</span>]) = TCPDF_STATIC::getCSSdataArray($dom, $key, $css);</div>
<div class="line"><a name="l16676"></a><span class="lineno">16676</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;style&#39;</span>] = TCPDF_STATIC::getTagStyleFromCSSarray($dom[$key][<span class="stringliteral">&#39;cssdata&#39;</span>]);</div>
<div class="line"><a name="l16677"></a><span class="lineno">16677</span>&#160;                    }</div>
<div class="line"><a name="l16678"></a><span class="lineno">16678</span>&#160;                    <span class="comment">// split style attributes</span></div>
<div class="line"><a name="l16679"></a><span class="lineno">16679</span>&#160;                    <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;style&#39;</span>]) AND !empty($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;style&#39;</span>])) {</div>
<div class="line"><a name="l16680"></a><span class="lineno">16680</span>&#160;                        <span class="comment">// get style attributes</span></div>
<div class="line"><a name="l16681"></a><span class="lineno">16681</span>&#160;                        preg_match_all(<span class="stringliteral">&#39;/([^;:\s]*):([^;]*)/&#39;</span>, $dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;style&#39;</span>], $style_array, PREG_PATTERN_ORDER);</div>
<div class="line"><a name="l16682"></a><span class="lineno">16682</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;style&#39;</span>] = array(); <span class="comment">// reset style attribute array</span></div>
<div class="line"><a name="l16683"></a><span class="lineno">16683</span>&#160;                        <span class="keywordflow">while</span> (list($id, $name) = each($style_array[1])) {</div>
<div class="line"><a name="l16684"></a><span class="lineno">16684</span>&#160;                            <span class="comment">// in case of duplicate attribute the last replace the previous</span></div>
<div class="line"><a name="l16685"></a><span class="lineno">16685</span>&#160;                            $dom[$key][<span class="stringliteral">&#39;style&#39;</span>][strtolower($name)] = trim($style_array[2][$id]);</div>
<div class="line"><a name="l16686"></a><span class="lineno">16686</span>&#160;                        }</div>
<div class="line"><a name="l16687"></a><span class="lineno">16687</span>&#160;                        <span class="comment">// --- get some style attributes ---</span></div>
<div class="line"><a name="l16688"></a><span class="lineno">16688</span>&#160;                        <span class="comment">// text direction</span></div>
<div class="line"><a name="l16689"></a><span class="lineno">16689</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;direction&#39;</span>])) {</div>
<div class="line"><a name="l16690"></a><span class="lineno">16690</span>&#160;                            $dom[$key][<span class="stringliteral">&#39;dir&#39;</span>] = $dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;direction&#39;</span>];</div>
<div class="line"><a name="l16691"></a><span class="lineno">16691</span>&#160;                        }</div>
<div class="line"><a name="l16692"></a><span class="lineno">16692</span>&#160;                        <span class="comment">// display</span></div>
<div class="line"><a name="l16693"></a><span class="lineno">16693</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;display&#39;</span>])) {</div>
<div class="line"><a name="l16694"></a><span class="lineno">16694</span>&#160;                            $dom[$key][<span class="stringliteral">&#39;hide&#39;</span>] = (trim(strtolower($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;display&#39;</span>])) == <span class="stringliteral">&#39;none&#39;</span>);</div>
<div class="line"><a name="l16695"></a><span class="lineno">16695</span>&#160;                        }</div>
<div class="line"><a name="l16696"></a><span class="lineno">16696</span>&#160;                        <span class="comment">// font family</span></div>
<div class="line"><a name="l16697"></a><span class="lineno">16697</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;font-family&#39;</span>])) {</div>
<div class="line"><a name="l16698"></a><span class="lineno">16698</span>&#160;                            $dom[$key][<span class="stringliteral">&#39;fontname&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1454645fa7a1e35f6f8a634c0978ed2e">getFontFamilyName</a>($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;font-family&#39;</span>]);</div>
<div class="line"><a name="l16699"></a><span class="lineno">16699</span>&#160;                        }</div>
<div class="line"><a name="l16700"></a><span class="lineno">16700</span>&#160;                        <span class="comment">// list-style-type</span></div>
<div class="line"><a name="l16701"></a><span class="lineno">16701</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;list-style-type&#39;</span>])) {</div>
<div class="line"><a name="l16702"></a><span class="lineno">16702</span>&#160;                            $dom[$key][<span class="stringliteral">&#39;listtype&#39;</span>] = trim(strtolower($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;list-style-type&#39;</span>]));</div>
<div class="line"><a name="l16703"></a><span class="lineno">16703</span>&#160;                            <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;listtype&#39;</span>] == <span class="stringliteral">&#39;inherit&#39;</span>) {</div>
<div class="line"><a name="l16704"></a><span class="lineno">16704</span>&#160;                                $dom[$key][<span class="stringliteral">&#39;listtype&#39;</span>] = $dom[$parentkey][<span class="stringliteral">&#39;listtype&#39;</span>];</div>
<div class="line"><a name="l16705"></a><span class="lineno">16705</span>&#160;                            }</div>
<div class="line"><a name="l16706"></a><span class="lineno">16706</span>&#160;                        }</div>
<div class="line"><a name="l16707"></a><span class="lineno">16707</span>&#160;                        <span class="comment">// text-indent</span></div>
<div class="line"><a name="l16708"></a><span class="lineno">16708</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;text-indent&#39;</span>])) {</div>
<div class="line"><a name="l16709"></a><span class="lineno">16709</span>&#160;                            $dom[$key][<span class="stringliteral">&#39;text-indent&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9">getHTMLUnitToUnits</a>($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;text-indent&#39;</span>]);</div>
<div class="line"><a name="l16710"></a><span class="lineno">16710</span>&#160;                            <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;text-indent&#39;</span>] == <span class="stringliteral">&#39;inherit&#39;</span>) {</div>
<div class="line"><a name="l16711"></a><span class="lineno">16711</span>&#160;                                $dom[$key][<span class="stringliteral">&#39;text-indent&#39;</span>] = $dom[$parentkey][<span class="stringliteral">&#39;text-indent&#39;</span>];</div>
<div class="line"><a name="l16712"></a><span class="lineno">16712</span>&#160;                            }</div>
<div class="line"><a name="l16713"></a><span class="lineno">16713</span>&#160;                        }</div>
<div class="line"><a name="l16714"></a><span class="lineno">16714</span>&#160;                        <span class="comment">// text-transform</span></div>
<div class="line"><a name="l16715"></a><span class="lineno">16715</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;text-transform&#39;</span>])) {</div>
<div class="line"><a name="l16716"></a><span class="lineno">16716</span>&#160;                            $dom[$key][<span class="stringliteral">&#39;text-transform&#39;</span>] = $dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;text-transform&#39;</span>];</div>
<div class="line"><a name="l16717"></a><span class="lineno">16717</span>&#160;                        }</div>
<div class="line"><a name="l16718"></a><span class="lineno">16718</span>&#160;                        <span class="comment">// font size</span></div>
<div class="line"><a name="l16719"></a><span class="lineno">16719</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;font-size&#39;</span>])) {</div>
<div class="line"><a name="l16720"></a><span class="lineno">16720</span>&#160;                            $fsize = trim($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;font-size&#39;</span>]);</div>
<div class="line"><a name="l16721"></a><span class="lineno">16721</span>&#160;                            $dom[$key][<span class="stringliteral">&#39;fontsize&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac7f2c7f76bd73f9c6874ec6b3a738a2c">getHTMLFontUnits</a>($fsize, $dom[0][<span class="stringliteral">&#39;fontsize&#39;</span>], $dom[$parentkey][<span class="stringliteral">&#39;fontsize&#39;</span>], <span class="stringliteral">&#39;pt&#39;</span>);</div>
<div class="line"><a name="l16722"></a><span class="lineno">16722</span>&#160;                        }</div>
<div class="line"><a name="l16723"></a><span class="lineno">16723</span>&#160;                        <span class="comment">// font-stretch</span></div>
<div class="line"><a name="l16724"></a><span class="lineno">16724</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;font-stretch&#39;</span>])) {</div>
<div class="line"><a name="l16725"></a><span class="lineno">16725</span>&#160;                            $dom[$key][<span class="stringliteral">&#39;font-stretch&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a0d8075a3d1489875d600e7735c790929">getCSSFontStretching</a>($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;font-stretch&#39;</span>], $dom[$parentkey][<span class="stringliteral">&#39;font-stretch&#39;</span>]);</div>
<div class="line"><a name="l16726"></a><span class="lineno">16726</span>&#160;                        }</div>
<div class="line"><a name="l16727"></a><span class="lineno">16727</span>&#160;                        <span class="comment">// letter-spacing</span></div>
<div class="line"><a name="l16728"></a><span class="lineno">16728</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;letter-spacing&#39;</span>])) {</div>
<div class="line"><a name="l16729"></a><span class="lineno">16729</span>&#160;                            $dom[$key][<span class="stringliteral">&#39;letter-spacing&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4f4b2eb6bd3ea30b0cfa58a10396736b">getCSSFontSpacing</a>($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;letter-spacing&#39;</span>], $dom[$parentkey][<span class="stringliteral">&#39;letter-spacing&#39;</span>]);</div>
<div class="line"><a name="l16730"></a><span class="lineno">16730</span>&#160;                        }</div>
<div class="line"><a name="l16731"></a><span class="lineno">16731</span>&#160;                        <span class="comment">// line-height (internally is the cell height ratio)</span></div>
<div class="line"><a name="l16732"></a><span class="lineno">16732</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;line-height&#39;</span>])) {</div>
<div class="line"><a name="l16733"></a><span class="lineno">16733</span>&#160;                            $lineheight = trim($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;line-height&#39;</span>]);</div>
<div class="line"><a name="l16734"></a><span class="lineno">16734</span>&#160;                            <span class="keywordflow">switch</span> ($lineheight) {</div>
<div class="line"><a name="l16735"></a><span class="lineno">16735</span>&#160;                                <span class="comment">// A normal line height. This is default</span></div>
<div class="line"><a name="l16736"></a><span class="lineno">16736</span>&#160;                                <span class="keywordflow">case</span> <span class="stringliteral">&#39;normal&#39;</span>: {</div>
<div class="line"><a name="l16737"></a><span class="lineno">16737</span>&#160;                                    $dom[$key][<span class="stringliteral">&#39;line-height&#39;</span>] = $dom[0][<span class="stringliteral">&#39;line-height&#39;</span>];</div>
<div class="line"><a name="l16738"></a><span class="lineno">16738</span>&#160;                                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l16739"></a><span class="lineno">16739</span>&#160;                                }</div>
<div class="line"><a name="l16740"></a><span class="lineno">16740</span>&#160;                                <span class="keywordflow">case</span> <span class="stringliteral">&#39;inherit&#39;</span>: {</div>
<div class="line"><a name="l16741"></a><span class="lineno">16741</span>&#160;                                    $dom[$key][<span class="stringliteral">&#39;line-height&#39;</span>] = $dom[$parentkey][<span class="stringliteral">&#39;line-height&#39;</span>];</div>
<div class="line"><a name="l16742"></a><span class="lineno">16742</span>&#160;                                }</div>
<div class="line"><a name="l16743"></a><span class="lineno">16743</span>&#160;                                <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l16744"></a><span class="lineno">16744</span>&#160;                                    <span class="keywordflow">if</span> (is_numeric($lineheight)) {</div>
<div class="line"><a name="l16745"></a><span class="lineno">16745</span>&#160;                                        <span class="comment">// convert to percentage of font height</span></div>
<div class="line"><a name="l16746"></a><span class="lineno">16746</span>&#160;                                        $lineheight = ($lineheight * 100).<span class="charliteral">&#39;%&#39;</span>;</div>
<div class="line"><a name="l16747"></a><span class="lineno">16747</span>&#160;                                    }</div>
<div class="line"><a name="l16748"></a><span class="lineno">16748</span>&#160;                                    $dom[$key][<span class="stringliteral">&#39;line-height&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9">getHTMLUnitToUnits</a>($lineheight, 1, <span class="charliteral">&#39;%&#39;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l16749"></a><span class="lineno">16749</span>&#160;                                    <span class="keywordflow">if</span> (substr($lineheight, -1) !== <span class="charliteral">&#39;%&#39;</span>) {</div>
<div class="line"><a name="l16750"></a><span class="lineno">16750</span>&#160;                                        <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;fontsize&#39;</span>] &lt;= 0) {</div>
<div class="line"><a name="l16751"></a><span class="lineno">16751</span>&#160;                                            $dom[$key][<span class="stringliteral">&#39;line-height&#39;</span>] = 1;</div>
<div class="line"><a name="l16752"></a><span class="lineno">16752</span>&#160;                                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l16753"></a><span class="lineno">16753</span>&#160;                                            $dom[$key][<span class="stringliteral">&#39;line-height&#39;</span>] = (($dom[$key][<span class="stringliteral">&#39;line-height&#39;</span>] - $this-&gt;cell_padding[<span class="charliteral">&#39;T&#39;</span>] - $this-&gt;cell_padding[<span class="charliteral">&#39;B&#39;</span>]) / $dom[$key][<span class="stringliteral">&#39;fontsize&#39;</span>]);</div>
<div class="line"><a name="l16754"></a><span class="lineno">16754</span>&#160;                                        }</div>
<div class="line"><a name="l16755"></a><span class="lineno">16755</span>&#160;                                    }</div>
<div class="line"><a name="l16756"></a><span class="lineno">16756</span>&#160;                                }</div>
<div class="line"><a name="l16757"></a><span class="lineno">16757</span>&#160;                            }</div>
<div class="line"><a name="l16758"></a><span class="lineno">16758</span>&#160;                        }</div>
<div class="line"><a name="l16759"></a><span class="lineno">16759</span>&#160;                        <span class="comment">// font style</span></div>
<div class="line"><a name="l16760"></a><span class="lineno">16760</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;font-weight&#39;</span>])) {</div>
<div class="line"><a name="l16761"></a><span class="lineno">16761</span>&#160;                            <span class="keywordflow">if</span> (strtolower($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;font-weight&#39;</span>][0]) == <span class="charliteral">&#39;n&#39;</span>) {</div>
<div class="line"><a name="l16762"></a><span class="lineno">16762</span>&#160;                                <span class="keywordflow">if</span> (strpos($dom[$key][<span class="stringliteral">&#39;fontstyle&#39;</span>], <span class="charliteral">&#39;B&#39;</span>) !== <span class="keyword">false</span>) {</div>
<div class="line"><a name="l16763"></a><span class="lineno">16763</span>&#160;                                    $dom[$key][<span class="stringliteral">&#39;fontstyle&#39;</span>] = str_replace(<span class="charliteral">&#39;B&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $dom[$key][<span class="stringliteral">&#39;fontstyle&#39;</span>]);</div>
<div class="line"><a name="l16764"></a><span class="lineno">16764</span>&#160;                                }</div>
<div class="line"><a name="l16765"></a><span class="lineno">16765</span>&#160;                            } elseif (strtolower($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;font-weight&#39;</span>][0]) == <span class="charliteral">&#39;b&#39;</span>) {</div>
<div class="line"><a name="l16766"></a><span class="lineno">16766</span>&#160;                                $dom[$key][<span class="stringliteral">&#39;fontstyle&#39;</span>] .= <span class="charliteral">&#39;B&#39;</span>;</div>
<div class="line"><a name="l16767"></a><span class="lineno">16767</span>&#160;                            }</div>
<div class="line"><a name="l16768"></a><span class="lineno">16768</span>&#160;                        }</div>
<div class="line"><a name="l16769"></a><span class="lineno">16769</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;font-style&#39;</span>]) AND (strtolower($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;font-style&#39;</span>][0]) == <span class="charliteral">&#39;i&#39;</span>)) {</div>
<div class="line"><a name="l16770"></a><span class="lineno">16770</span>&#160;                            $dom[$key][<span class="stringliteral">&#39;fontstyle&#39;</span>] .= <span class="charliteral">&#39;I&#39;</span>;</div>
<div class="line"><a name="l16771"></a><span class="lineno">16771</span>&#160;                        }</div>
<div class="line"><a name="l16772"></a><span class="lineno">16772</span>&#160;                        <span class="comment">// font color</span></div>
<div class="line"><a name="l16773"></a><span class="lineno">16773</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;color&#39;</span>]) AND (!TCPDF_STATIC::empty_string($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;color&#39;</span>]))) {</div>
<div class="line"><a name="l16774"></a><span class="lineno">16774</span>&#160;                            $dom[$key][<span class="stringliteral">&#39;fgcolor&#39;</span>] = TCPDF_COLORS::convertHTMLColorToDec($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;color&#39;</span>], $this-&gt;spot_colors);</div>
<div class="line"><a name="l16775"></a><span class="lineno">16775</span>&#160;                        } elseif ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="charliteral">&#39;a&#39;</span>) {</div>
<div class="line"><a name="l16776"></a><span class="lineno">16776</span>&#160;                            $dom[$key][<span class="stringliteral">&#39;fgcolor&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#ad314dda630c9467efd594d46d24abcd5">$this-&gt;htmlLinkColorArray</a>;</div>
<div class="line"><a name="l16777"></a><span class="lineno">16777</span>&#160;                        }</div>
<div class="line"><a name="l16778"></a><span class="lineno">16778</span>&#160;                        <span class="comment">// background color</span></div>
<div class="line"><a name="l16779"></a><span class="lineno">16779</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;background-color&#39;</span>]) AND (!TCPDF_STATIC::empty_string($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;background-color&#39;</span>]))) {</div>
<div class="line"><a name="l16780"></a><span class="lineno">16780</span>&#160;                            $dom[$key][<span class="stringliteral">&#39;bgcolor&#39;</span>] = TCPDF_COLORS::convertHTMLColorToDec($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;background-color&#39;</span>], $this-&gt;spot_colors);</div>
<div class="line"><a name="l16781"></a><span class="lineno">16781</span>&#160;                        }</div>
<div class="line"><a name="l16782"></a><span class="lineno">16782</span>&#160;                        <span class="comment">// text-decoration</span></div>
<div class="line"><a name="l16783"></a><span class="lineno">16783</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;text-decoration&#39;</span>])) {</div>
<div class="line"><a name="l16784"></a><span class="lineno">16784</span>&#160;                            $decors = explode(<span class="charliteral">&#39; &#39;</span>, strtolower($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;text-decoration&#39;</span>]));</div>
<div class="line"><a name="l16785"></a><span class="lineno">16785</span>&#160;                            <span class="keywordflow">foreach</span> ($decors as $dec) {</div>
<div class="line"><a name="l16786"></a><span class="lineno">16786</span>&#160;                                $dec = trim($dec);</div>
<div class="line"><a name="l16787"></a><span class="lineno">16787</span>&#160;                                <span class="keywordflow">if</span> (!TCPDF_STATIC::empty_string($dec)) {</div>
<div class="line"><a name="l16788"></a><span class="lineno">16788</span>&#160;                                    <span class="keywordflow">if</span> ($dec[0] == <span class="charliteral">&#39;u&#39;</span>) {</div>
<div class="line"><a name="l16789"></a><span class="lineno">16789</span>&#160;                                        <span class="comment">// underline</span></div>
<div class="line"><a name="l16790"></a><span class="lineno">16790</span>&#160;                                        $dom[$key][<span class="stringliteral">&#39;fontstyle&#39;</span>] .= <span class="charliteral">&#39;U&#39;</span>;</div>
<div class="line"><a name="l16791"></a><span class="lineno">16791</span>&#160;                                    } elseif ($dec[0] == <span class="charliteral">&#39;l&#39;</span>) {</div>
<div class="line"><a name="l16792"></a><span class="lineno">16792</span>&#160;                                        <span class="comment">// line-through</span></div>
<div class="line"><a name="l16793"></a><span class="lineno">16793</span>&#160;                                        $dom[$key][<span class="stringliteral">&#39;fontstyle&#39;</span>] .= <span class="charliteral">&#39;D&#39;</span>;</div>
<div class="line"><a name="l16794"></a><span class="lineno">16794</span>&#160;                                    } elseif ($dec[0] == <span class="charliteral">&#39;o&#39;</span>) {</div>
<div class="line"><a name="l16795"></a><span class="lineno">16795</span>&#160;                                        <span class="comment">// overline</span></div>
<div class="line"><a name="l16796"></a><span class="lineno">16796</span>&#160;                                        $dom[$key][<span class="stringliteral">&#39;fontstyle&#39;</span>] .= <span class="charliteral">&#39;O&#39;</span>;</div>
<div class="line"><a name="l16797"></a><span class="lineno">16797</span>&#160;                                    }</div>
<div class="line"><a name="l16798"></a><span class="lineno">16798</span>&#160;                                }</div>
<div class="line"><a name="l16799"></a><span class="lineno">16799</span>&#160;                            }</div>
<div class="line"><a name="l16800"></a><span class="lineno">16800</span>&#160;                        } elseif ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="charliteral">&#39;a&#39;</span>) {</div>
<div class="line"><a name="l16801"></a><span class="lineno">16801</span>&#160;                            $dom[$key][<span class="stringliteral">&#39;fontstyle&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a5dedfd8b2f29748200d45a186182c86c">$this-&gt;htmlLinkFontStyle</a>;</div>
<div class="line"><a name="l16802"></a><span class="lineno">16802</span>&#160;                        }</div>
<div class="line"><a name="l16803"></a><span class="lineno">16803</span>&#160;                        <span class="comment">// check for width attribute</span></div>
<div class="line"><a name="l16804"></a><span class="lineno">16804</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;width&#39;</span>])) {</div>
<div class="line"><a name="l16805"></a><span class="lineno">16805</span>&#160;                            $dom[$key][<span class="stringliteral">&#39;width&#39;</span>] = $dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;width&#39;</span>];</div>
<div class="line"><a name="l16806"></a><span class="lineno">16806</span>&#160;                        }</div>
<div class="line"><a name="l16807"></a><span class="lineno">16807</span>&#160;                        <span class="comment">// check for height attribute</span></div>
<div class="line"><a name="l16808"></a><span class="lineno">16808</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;height&#39;</span>])) {</div>
<div class="line"><a name="l16809"></a><span class="lineno">16809</span>&#160;                            $dom[$key][<span class="stringliteral">&#39;height&#39;</span>] = $dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;height&#39;</span>];</div>
<div class="line"><a name="l16810"></a><span class="lineno">16810</span>&#160;                        }</div>
<div class="line"><a name="l16811"></a><span class="lineno">16811</span>&#160;                        <span class="comment">// check for text alignment</span></div>
<div class="line"><a name="l16812"></a><span class="lineno">16812</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;text-align&#39;</span>])) {</div>
<div class="line"><a name="l16813"></a><span class="lineno">16813</span>&#160;                            $dom[$key][<span class="stringliteral">&#39;align&#39;</span>] = strtoupper($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;text-align&#39;</span>][0]);</div>
<div class="line"><a name="l16814"></a><span class="lineno">16814</span>&#160;                        }</div>
<div class="line"><a name="l16815"></a><span class="lineno">16815</span>&#160;                        <span class="comment">// check for CSS border properties</span></div>
<div class="line"><a name="l16816"></a><span class="lineno">16816</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;border&#39;</span>])) {</div>
<div class="line"><a name="l16817"></a><span class="lineno">16817</span>&#160;                            $borderstyle = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a2e65a8cc55a9b4b9c9ac01e6513d64c7">getCSSBorderStyle</a>($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;border&#39;</span>]);</div>
<div class="line"><a name="l16818"></a><span class="lineno">16818</span>&#160;                            <span class="keywordflow">if</span> (!empty($borderstyle)) {</div>
<div class="line"><a name="l16819"></a><span class="lineno">16819</span>&#160;                                $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="stringliteral">&#39;LTRB&#39;</span>] = $borderstyle;</div>
<div class="line"><a name="l16820"></a><span class="lineno">16820</span>&#160;                            }</div>
<div class="line"><a name="l16821"></a><span class="lineno">16821</span>&#160;                        }</div>
<div class="line"><a name="l16822"></a><span class="lineno">16822</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;border-color&#39;</span>])) {</div>
<div class="line"><a name="l16823"></a><span class="lineno">16823</span>&#160;                            $brd_colors = preg_split(<span class="stringliteral">&#39;/[\s]+/&#39;</span>, trim($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;border-color&#39;</span>]));</div>
<div class="line"><a name="l16824"></a><span class="lineno">16824</span>&#160;                            <span class="keywordflow">if</span> (isset($brd_colors[3])) {</div>
<div class="line"><a name="l16825"></a><span class="lineno">16825</span>&#160;                                $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;L&#39;</span>][<span class="stringliteral">&#39;color&#39;</span>] = TCPDF_COLORS::convertHTMLColorToDec($brd_colors[3], $this-&gt;spot_colors);</div>
<div class="line"><a name="l16826"></a><span class="lineno">16826</span>&#160;                            }</div>
<div class="line"><a name="l16827"></a><span class="lineno">16827</span>&#160;                            <span class="keywordflow">if</span> (isset($brd_colors[1])) {</div>
<div class="line"><a name="l16828"></a><span class="lineno">16828</span>&#160;                                $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;R&#39;</span>][<span class="stringliteral">&#39;color&#39;</span>] = TCPDF_COLORS::convertHTMLColorToDec($brd_colors[1], $this-&gt;spot_colors);</div>
<div class="line"><a name="l16829"></a><span class="lineno">16829</span>&#160;                            }</div>
<div class="line"><a name="l16830"></a><span class="lineno">16830</span>&#160;                            <span class="keywordflow">if</span> (isset($brd_colors[0])) {</div>
<div class="line"><a name="l16831"></a><span class="lineno">16831</span>&#160;                                $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;T&#39;</span>][<span class="stringliteral">&#39;color&#39;</span>] = TCPDF_COLORS::convertHTMLColorToDec($brd_colors[0], $this-&gt;spot_colors);</div>
<div class="line"><a name="l16832"></a><span class="lineno">16832</span>&#160;                            }</div>
<div class="line"><a name="l16833"></a><span class="lineno">16833</span>&#160;                            <span class="keywordflow">if</span> (isset($brd_colors[2])) {</div>
<div class="line"><a name="l16834"></a><span class="lineno">16834</span>&#160;                                $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;B&#39;</span>][<span class="stringliteral">&#39;color&#39;</span>] = TCPDF_COLORS::convertHTMLColorToDec($brd_colors[2], $this-&gt;spot_colors);</div>
<div class="line"><a name="l16835"></a><span class="lineno">16835</span>&#160;                            }</div>
<div class="line"><a name="l16836"></a><span class="lineno">16836</span>&#160;                        }</div>
<div class="line"><a name="l16837"></a><span class="lineno">16837</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;border-width&#39;</span>])) {</div>
<div class="line"><a name="l16838"></a><span class="lineno">16838</span>&#160;                            $brd_widths = preg_split(<span class="stringliteral">&#39;/[\s]+/&#39;</span>, trim($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;border-width&#39;</span>]));</div>
<div class="line"><a name="l16839"></a><span class="lineno">16839</span>&#160;                            <span class="keywordflow">if</span> (isset($brd_widths[3])) {</div>
<div class="line"><a name="l16840"></a><span class="lineno">16840</span>&#160;                                $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;L&#39;</span>][<span class="stringliteral">&#39;width&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a79695745bece08e32a7899f8217bf74d">getCSSBorderWidth</a>($brd_widths[3]);</div>
<div class="line"><a name="l16841"></a><span class="lineno">16841</span>&#160;                            }</div>
<div class="line"><a name="l16842"></a><span class="lineno">16842</span>&#160;                            <span class="keywordflow">if</span> (isset($brd_widths[1])) {</div>
<div class="line"><a name="l16843"></a><span class="lineno">16843</span>&#160;                                $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;R&#39;</span>][<span class="stringliteral">&#39;width&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a79695745bece08e32a7899f8217bf74d">getCSSBorderWidth</a>($brd_widths[1]);</div>
<div class="line"><a name="l16844"></a><span class="lineno">16844</span>&#160;                            }</div>
<div class="line"><a name="l16845"></a><span class="lineno">16845</span>&#160;                            <span class="keywordflow">if</span> (isset($brd_widths[0])) {</div>
<div class="line"><a name="l16846"></a><span class="lineno">16846</span>&#160;                                $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;T&#39;</span>][<span class="stringliteral">&#39;width&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a79695745bece08e32a7899f8217bf74d">getCSSBorderWidth</a>($brd_widths[0]);</div>
<div class="line"><a name="l16847"></a><span class="lineno">16847</span>&#160;                            }</div>
<div class="line"><a name="l16848"></a><span class="lineno">16848</span>&#160;                            <span class="keywordflow">if</span> (isset($brd_widths[2])) {</div>
<div class="line"><a name="l16849"></a><span class="lineno">16849</span>&#160;                                $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;B&#39;</span>][<span class="stringliteral">&#39;width&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a79695745bece08e32a7899f8217bf74d">getCSSBorderWidth</a>($brd_widths[2]);</div>
<div class="line"><a name="l16850"></a><span class="lineno">16850</span>&#160;                            }</div>
<div class="line"><a name="l16851"></a><span class="lineno">16851</span>&#160;                        }</div>
<div class="line"><a name="l16852"></a><span class="lineno">16852</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;border-style&#39;</span>])) {</div>
<div class="line"><a name="l16853"></a><span class="lineno">16853</span>&#160;                            $brd_styles = preg_split(<span class="stringliteral">&#39;/[\s]+/&#39;</span>, trim($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;border-style&#39;</span>]));</div>
<div class="line"><a name="l16854"></a><span class="lineno">16854</span>&#160;                            <span class="keywordflow">if</span> (isset($brd_styles[3]) AND ($brd_styles[3]!=<span class="stringliteral">&#39;none&#39;</span>)) {</div>
<div class="line"><a name="l16855"></a><span class="lineno">16855</span>&#160;                                $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;L&#39;</span>][<span class="stringliteral">&#39;cap&#39;</span>] = <span class="stringliteral">&#39;square&#39;</span>;</div>
<div class="line"><a name="l16856"></a><span class="lineno">16856</span>&#160;                                $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;L&#39;</span>][<span class="stringliteral">&#39;join&#39;</span>] = <span class="stringliteral">&#39;miter&#39;</span>;</div>
<div class="line"><a name="l16857"></a><span class="lineno">16857</span>&#160;                                $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;L&#39;</span>][<span class="stringliteral">&#39;dash&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a7cd52df1697c10362b74645261fb38f1">getCSSBorderDashStyle</a>($brd_styles[3]);</div>
<div class="line"><a name="l16858"></a><span class="lineno">16858</span>&#160;                                <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;L&#39;</span>][<span class="stringliteral">&#39;dash&#39;</span>] &lt; 0) {</div>
<div class="line"><a name="l16859"></a><span class="lineno">16859</span>&#160;                                    $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;L&#39;</span>] = array();</div>
<div class="line"><a name="l16860"></a><span class="lineno">16860</span>&#160;                                }</div>
<div class="line"><a name="l16861"></a><span class="lineno">16861</span>&#160;                            }</div>
<div class="line"><a name="l16862"></a><span class="lineno">16862</span>&#160;                            <span class="keywordflow">if</span> (isset($brd_styles[1])) {</div>
<div class="line"><a name="l16863"></a><span class="lineno">16863</span>&#160;                                $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;R&#39;</span>][<span class="stringliteral">&#39;cap&#39;</span>] = <span class="stringliteral">&#39;square&#39;</span>;</div>
<div class="line"><a name="l16864"></a><span class="lineno">16864</span>&#160;                                $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;R&#39;</span>][<span class="stringliteral">&#39;join&#39;</span>] = <span class="stringliteral">&#39;miter&#39;</span>;</div>
<div class="line"><a name="l16865"></a><span class="lineno">16865</span>&#160;                                $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;R&#39;</span>][<span class="stringliteral">&#39;dash&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a7cd52df1697c10362b74645261fb38f1">getCSSBorderDashStyle</a>($brd_styles[1]);</div>
<div class="line"><a name="l16866"></a><span class="lineno">16866</span>&#160;                                <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;R&#39;</span>][<span class="stringliteral">&#39;dash&#39;</span>] &lt; 0) {</div>
<div class="line"><a name="l16867"></a><span class="lineno">16867</span>&#160;                                    $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;R&#39;</span>] = array();</div>
<div class="line"><a name="l16868"></a><span class="lineno">16868</span>&#160;                                }</div>
<div class="line"><a name="l16869"></a><span class="lineno">16869</span>&#160;                            }</div>
<div class="line"><a name="l16870"></a><span class="lineno">16870</span>&#160;                            <span class="keywordflow">if</span> (isset($brd_styles[0])) {</div>
<div class="line"><a name="l16871"></a><span class="lineno">16871</span>&#160;                                $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;T&#39;</span>][<span class="stringliteral">&#39;cap&#39;</span>] = <span class="stringliteral">&#39;square&#39;</span>;</div>
<div class="line"><a name="l16872"></a><span class="lineno">16872</span>&#160;                                $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;T&#39;</span>][<span class="stringliteral">&#39;join&#39;</span>] = <span class="stringliteral">&#39;miter&#39;</span>;</div>
<div class="line"><a name="l16873"></a><span class="lineno">16873</span>&#160;                                $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;T&#39;</span>][<span class="stringliteral">&#39;dash&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a7cd52df1697c10362b74645261fb38f1">getCSSBorderDashStyle</a>($brd_styles[0]);</div>
<div class="line"><a name="l16874"></a><span class="lineno">16874</span>&#160;                                <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;T&#39;</span>][<span class="stringliteral">&#39;dash&#39;</span>] &lt; 0) {</div>
<div class="line"><a name="l16875"></a><span class="lineno">16875</span>&#160;                                    $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;T&#39;</span>] = array();</div>
<div class="line"><a name="l16876"></a><span class="lineno">16876</span>&#160;                                }</div>
<div class="line"><a name="l16877"></a><span class="lineno">16877</span>&#160;                            }</div>
<div class="line"><a name="l16878"></a><span class="lineno">16878</span>&#160;                            <span class="keywordflow">if</span> (isset($brd_styles[2])) {</div>
<div class="line"><a name="l16879"></a><span class="lineno">16879</span>&#160;                                $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;B&#39;</span>][<span class="stringliteral">&#39;cap&#39;</span>] = <span class="stringliteral">&#39;square&#39;</span>;</div>
<div class="line"><a name="l16880"></a><span class="lineno">16880</span>&#160;                                $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;B&#39;</span>][<span class="stringliteral">&#39;join&#39;</span>] = <span class="stringliteral">&#39;miter&#39;</span>;</div>
<div class="line"><a name="l16881"></a><span class="lineno">16881</span>&#160;                                $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;B&#39;</span>][<span class="stringliteral">&#39;dash&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a7cd52df1697c10362b74645261fb38f1">getCSSBorderDashStyle</a>($brd_styles[2]);</div>
<div class="line"><a name="l16882"></a><span class="lineno">16882</span>&#160;                                <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;B&#39;</span>][<span class="stringliteral">&#39;dash&#39;</span>] &lt; 0) {</div>
<div class="line"><a name="l16883"></a><span class="lineno">16883</span>&#160;                                    $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="charliteral">&#39;B&#39;</span>] = array();</div>
<div class="line"><a name="l16884"></a><span class="lineno">16884</span>&#160;                                }</div>
<div class="line"><a name="l16885"></a><span class="lineno">16885</span>&#160;                            }</div>
<div class="line"><a name="l16886"></a><span class="lineno">16886</span>&#160;                        }</div>
<div class="line"><a name="l16887"></a><span class="lineno">16887</span>&#160;                        $cellside = array(<span class="charliteral">&#39;L&#39;</span> =&gt; <span class="stringliteral">&#39;left&#39;</span>, <span class="charliteral">&#39;R&#39;</span> =&gt; <span class="stringliteral">&#39;right&#39;</span>, <span class="charliteral">&#39;T&#39;</span> =&gt; <span class="stringliteral">&#39;top&#39;</span>, <span class="charliteral">&#39;B&#39;</span> =&gt; <span class="stringliteral">&#39;bottom&#39;</span>);</div>
<div class="line"><a name="l16888"></a><span class="lineno">16888</span>&#160;                        <span class="keywordflow">foreach</span> ($cellside as $bsk =&gt; $bsv) {</div>
<div class="line"><a name="l16889"></a><span class="lineno">16889</span>&#160;                            <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;border-&#39;</span>.$bsv])) {</div>
<div class="line"><a name="l16890"></a><span class="lineno">16890</span>&#160;                                $borderstyle = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a2e65a8cc55a9b4b9c9ac01e6513d64c7">getCSSBorderStyle</a>($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;border-&#39;</span>.$bsv]);</div>
<div class="line"><a name="l16891"></a><span class="lineno">16891</span>&#160;                                <span class="keywordflow">if</span> (!empty($borderstyle)) {</div>
<div class="line"><a name="l16892"></a><span class="lineno">16892</span>&#160;                                    $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][$bsk] = $borderstyle;</div>
<div class="line"><a name="l16893"></a><span class="lineno">16893</span>&#160;                                }</div>
<div class="line"><a name="l16894"></a><span class="lineno">16894</span>&#160;                            }</div>
<div class="line"><a name="l16895"></a><span class="lineno">16895</span>&#160;                            <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;border-&#39;</span>.$bsv.<span class="stringliteral">&#39;-color&#39;</span>])) {</div>
<div class="line"><a name="l16896"></a><span class="lineno">16896</span>&#160;                                $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][$bsk][<span class="stringliteral">&#39;color&#39;</span>] = TCPDF_COLORS::convertHTMLColorToDec($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;border-&#39;</span>.$bsv.<span class="stringliteral">&#39;-color&#39;</span>], $this-&gt;spot_colors);</div>
<div class="line"><a name="l16897"></a><span class="lineno">16897</span>&#160;                            }</div>
<div class="line"><a name="l16898"></a><span class="lineno">16898</span>&#160;                            <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;border-&#39;</span>.$bsv.<span class="stringliteral">&#39;-width&#39;</span>])) {</div>
<div class="line"><a name="l16899"></a><span class="lineno">16899</span>&#160;                                $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][$bsk][<span class="stringliteral">&#39;width&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a79695745bece08e32a7899f8217bf74d">getCSSBorderWidth</a>($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;border-&#39;</span>.$bsv.<span class="stringliteral">&#39;-width&#39;</span>]);</div>
<div class="line"><a name="l16900"></a><span class="lineno">16900</span>&#160;                            }</div>
<div class="line"><a name="l16901"></a><span class="lineno">16901</span>&#160;                            <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;border-&#39;</span>.$bsv.<span class="stringliteral">&#39;-style&#39;</span>])) {</div>
<div class="line"><a name="l16902"></a><span class="lineno">16902</span>&#160;                                $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][$bsk][<span class="stringliteral">&#39;dash&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a7cd52df1697c10362b74645261fb38f1">getCSSBorderDashStyle</a>($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;border-&#39;</span>.$bsv.<span class="stringliteral">&#39;-style&#39;</span>]);</div>
<div class="line"><a name="l16903"></a><span class="lineno">16903</span>&#160;                                <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;border&#39;</span>][$bsk][<span class="stringliteral">&#39;dash&#39;</span>] &lt; 0) {</div>
<div class="line"><a name="l16904"></a><span class="lineno">16904</span>&#160;                                    $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][$bsk] = array();</div>
<div class="line"><a name="l16905"></a><span class="lineno">16905</span>&#160;                                }</div>
<div class="line"><a name="l16906"></a><span class="lineno">16906</span>&#160;                            }</div>
<div class="line"><a name="l16907"></a><span class="lineno">16907</span>&#160;                        }</div>
<div class="line"><a name="l16908"></a><span class="lineno">16908</span>&#160;                        <span class="comment">// check for CSS padding properties</span></div>
<div class="line"><a name="l16909"></a><span class="lineno">16909</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;padding&#39;</span>])) {</div>
<div class="line"><a name="l16910"></a><span class="lineno">16910</span>&#160;                            $dom[$key][<span class="stringliteral">&#39;padding&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#acd3d7dae873b9873302616698abafcf3">getCSSPadding</a>($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;padding&#39;</span>]);</div>
<div class="line"><a name="l16911"></a><span class="lineno">16911</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l16912"></a><span class="lineno">16912</span>&#160;                            $dom[$key][<span class="stringliteral">&#39;padding&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$this-&gt;cell_padding</a>;</div>
<div class="line"><a name="l16913"></a><span class="lineno">16913</span>&#160;                        }</div>
<div class="line"><a name="l16914"></a><span class="lineno">16914</span>&#160;                        <span class="keywordflow">foreach</span> ($cellside as $psk =&gt; $psv) {</div>
<div class="line"><a name="l16915"></a><span class="lineno">16915</span>&#160;                            <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;padding-&#39;</span>.$psv])) {</div>
<div class="line"><a name="l16916"></a><span class="lineno">16916</span>&#160;                                $dom[$key][<span class="stringliteral">&#39;padding&#39;</span>][$psk] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9">getHTMLUnitToUnits</a>($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;padding-&#39;</span>.$psv], 0, <span class="stringliteral">&#39;px&#39;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l16917"></a><span class="lineno">16917</span>&#160;                            }</div>
<div class="line"><a name="l16918"></a><span class="lineno">16918</span>&#160;                        }</div>
<div class="line"><a name="l16919"></a><span class="lineno">16919</span>&#160;                        <span class="comment">// check for CSS margin properties</span></div>
<div class="line"><a name="l16920"></a><span class="lineno">16920</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;margin&#39;</span>])) {</div>
<div class="line"><a name="l16921"></a><span class="lineno">16921</span>&#160;                            $dom[$key][<span class="stringliteral">&#39;margin&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a5667689bccca7385dc41c64040e59121">getCSSMargin</a>($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;margin&#39;</span>]);</div>
<div class="line"><a name="l16922"></a><span class="lineno">16922</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l16923"></a><span class="lineno">16923</span>&#160;                            $dom[$key][<span class="stringliteral">&#39;margin&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a6decef4569cfd79d75e47cab1315fa77">$this-&gt;cell_margin</a>;</div>
<div class="line"><a name="l16924"></a><span class="lineno">16924</span>&#160;                        }</div>
<div class="line"><a name="l16925"></a><span class="lineno">16925</span>&#160;                        <span class="keywordflow">foreach</span> ($cellside as $psk =&gt; $psv) {</div>
<div class="line"><a name="l16926"></a><span class="lineno">16926</span>&#160;                            <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;margin-&#39;</span>.$psv])) {</div>
<div class="line"><a name="l16927"></a><span class="lineno">16927</span>&#160;                                $dom[$key][<span class="stringliteral">&#39;margin&#39;</span>][$psk] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9">getHTMLUnitToUnits</a>(str_replace(<span class="stringliteral">&#39;auto&#39;</span>, <span class="charliteral">&#39;0&#39;</span>, $dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;margin-&#39;</span>.$psv]), 0, <span class="stringliteral">&#39;px&#39;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l16928"></a><span class="lineno">16928</span>&#160;                            }</div>
<div class="line"><a name="l16929"></a><span class="lineno">16929</span>&#160;                        }</div>
<div class="line"><a name="l16930"></a><span class="lineno">16930</span>&#160;                        <span class="comment">// check for CSS border-spacing properties</span></div>
<div class="line"><a name="l16931"></a><span class="lineno">16931</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;border-spacing&#39;</span>])) {</div>
<div class="line"><a name="l16932"></a><span class="lineno">16932</span>&#160;                            $dom[$key][<span class="stringliteral">&#39;border-spacing&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a7ec79640f33b5a1334632c2a893571b7">getCSSBorderMargin</a>($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;border-spacing&#39;</span>]);</div>
<div class="line"><a name="l16933"></a><span class="lineno">16933</span>&#160;                        }</div>
<div class="line"><a name="l16934"></a><span class="lineno">16934</span>&#160;                        <span class="comment">// page-break-inside</span></div>
<div class="line"><a name="l16935"></a><span class="lineno">16935</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;page-break-inside&#39;</span>]) AND ($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;page-break-inside&#39;</span>] == <span class="stringliteral">&#39;avoid&#39;</span>)) {</div>
<div class="line"><a name="l16936"></a><span class="lineno">16936</span>&#160;                            $dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;nobr&#39;</span>] = <span class="stringliteral">&#39;true&#39;</span>;</div>
<div class="line"><a name="l16937"></a><span class="lineno">16937</span>&#160;                        }</div>
<div class="line"><a name="l16938"></a><span class="lineno">16938</span>&#160;                        <span class="comment">// page-break-before</span></div>
<div class="line"><a name="l16939"></a><span class="lineno">16939</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;page-break-before&#39;</span>])) {</div>
<div class="line"><a name="l16940"></a><span class="lineno">16940</span>&#160;                            <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;page-break-before&#39;</span>] == <span class="stringliteral">&#39;always&#39;</span>) {</div>
<div class="line"><a name="l16941"></a><span class="lineno">16941</span>&#160;                                $dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;pagebreak&#39;</span>] = <span class="stringliteral">&#39;true&#39;</span>;</div>
<div class="line"><a name="l16942"></a><span class="lineno">16942</span>&#160;                            } elseif ($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;page-break-before&#39;</span>] == <span class="stringliteral">&#39;left&#39;</span>) {</div>
<div class="line"><a name="l16943"></a><span class="lineno">16943</span>&#160;                                $dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;pagebreak&#39;</span>] = <span class="stringliteral">&#39;left&#39;</span>;</div>
<div class="line"><a name="l16944"></a><span class="lineno">16944</span>&#160;                            } elseif ($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;page-break-before&#39;</span>] == <span class="stringliteral">&#39;right&#39;</span>) {</div>
<div class="line"><a name="l16945"></a><span class="lineno">16945</span>&#160;                                $dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;pagebreak&#39;</span>] = <span class="stringliteral">&#39;right&#39;</span>;</div>
<div class="line"><a name="l16946"></a><span class="lineno">16946</span>&#160;                            }</div>
<div class="line"><a name="l16947"></a><span class="lineno">16947</span>&#160;                        }</div>
<div class="line"><a name="l16948"></a><span class="lineno">16948</span>&#160;                        <span class="comment">// page-break-after</span></div>
<div class="line"><a name="l16949"></a><span class="lineno">16949</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;page-break-after&#39;</span>])) {</div>
<div class="line"><a name="l16950"></a><span class="lineno">16950</span>&#160;                            <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;page-break-after&#39;</span>] == <span class="stringliteral">&#39;always&#39;</span>) {</div>
<div class="line"><a name="l16951"></a><span class="lineno">16951</span>&#160;                                $dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;pagebreakafter&#39;</span>] = <span class="stringliteral">&#39;true&#39;</span>;</div>
<div class="line"><a name="l16952"></a><span class="lineno">16952</span>&#160;                            } elseif ($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;page-break-after&#39;</span>] == <span class="stringliteral">&#39;left&#39;</span>) {</div>
<div class="line"><a name="l16953"></a><span class="lineno">16953</span>&#160;                                $dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;pagebreakafter&#39;</span>] = <span class="stringliteral">&#39;left&#39;</span>;</div>
<div class="line"><a name="l16954"></a><span class="lineno">16954</span>&#160;                            } elseif ($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;page-break-after&#39;</span>] == <span class="stringliteral">&#39;right&#39;</span>) {</div>
<div class="line"><a name="l16955"></a><span class="lineno">16955</span>&#160;                                $dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;pagebreakafter&#39;</span>] = <span class="stringliteral">&#39;right&#39;</span>;</div>
<div class="line"><a name="l16956"></a><span class="lineno">16956</span>&#160;                            }</div>
<div class="line"><a name="l16957"></a><span class="lineno">16957</span>&#160;                        }</div>
<div class="line"><a name="l16958"></a><span class="lineno">16958</span>&#160;                    }</div>
<div class="line"><a name="l16959"></a><span class="lineno">16959</span>&#160;                    <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;display&#39;</span>])) {</div>
<div class="line"><a name="l16960"></a><span class="lineno">16960</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;hide&#39;</span>] = (trim(strtolower($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;display&#39;</span>])) == <span class="stringliteral">&#39;none&#39;</span>);</div>
<div class="line"><a name="l16961"></a><span class="lineno">16961</span>&#160;                    }</div>
<div class="line"><a name="l16962"></a><span class="lineno">16962</span>&#160;                    <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;border&#39;</span>]) AND ($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;border&#39;</span>] != 0)) {</div>
<div class="line"><a name="l16963"></a><span class="lineno">16963</span>&#160;                        $borderstyle = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a2e65a8cc55a9b4b9c9ac01e6513d64c7">getCSSBorderStyle</a>($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;border&#39;</span>].<span class="stringliteral">&#39; solid black&#39;</span>);</div>
<div class="line"><a name="l16964"></a><span class="lineno">16964</span>&#160;                        <span class="keywordflow">if</span> (!empty($borderstyle)) {</div>
<div class="line"><a name="l16965"></a><span class="lineno">16965</span>&#160;                            $dom[$key][<span class="stringliteral">&#39;border&#39;</span>][<span class="stringliteral">&#39;LTRB&#39;</span>] = $borderstyle;</div>
<div class="line"><a name="l16966"></a><span class="lineno">16966</span>&#160;                        }</div>
<div class="line"><a name="l16967"></a><span class="lineno">16967</span>&#160;                    }</div>
<div class="line"><a name="l16968"></a><span class="lineno">16968</span>&#160;                    <span class="comment">// check for font tag</span></div>
<div class="line"><a name="l16969"></a><span class="lineno">16969</span>&#160;                    <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;font&#39;</span>) {</div>
<div class="line"><a name="l16970"></a><span class="lineno">16970</span>&#160;                        <span class="comment">// font family</span></div>
<div class="line"><a name="l16971"></a><span class="lineno">16971</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;face&#39;</span>])) {</div>
<div class="line"><a name="l16972"></a><span class="lineno">16972</span>&#160;                            $dom[$key][<span class="stringliteral">&#39;fontname&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1454645fa7a1e35f6f8a634c0978ed2e">getFontFamilyName</a>($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;face&#39;</span>]);</div>
<div class="line"><a name="l16973"></a><span class="lineno">16973</span>&#160;                        }</div>
<div class="line"><a name="l16974"></a><span class="lineno">16974</span>&#160;                        <span class="comment">// font size</span></div>
<div class="line"><a name="l16975"></a><span class="lineno">16975</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;size&#39;</span>])) {</div>
<div class="line"><a name="l16976"></a><span class="lineno">16976</span>&#160;                            <span class="keywordflow">if</span> ($key &gt; 0) {</div>
<div class="line"><a name="l16977"></a><span class="lineno">16977</span>&#160;                                <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;size&#39;</span>][0] == <span class="charliteral">&#39;+&#39;</span>) {</div>
<div class="line"><a name="l16978"></a><span class="lineno">16978</span>&#160;                                    $dom[$key][<span class="stringliteral">&#39;fontsize&#39;</span>] = $dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;fontsize&#39;</span>] + intval(substr($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;size&#39;</span>], 1));</div>
<div class="line"><a name="l16979"></a><span class="lineno">16979</span>&#160;                                } elseif ($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;size&#39;</span>][0] == <span class="charliteral">&#39;-&#39;</span>) {</div>
<div class="line"><a name="l16980"></a><span class="lineno">16980</span>&#160;                                    $dom[$key][<span class="stringliteral">&#39;fontsize&#39;</span>] = $dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;fontsize&#39;</span>] - intval(substr($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;size&#39;</span>], 1));</div>
<div class="line"><a name="l16981"></a><span class="lineno">16981</span>&#160;                                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l16982"></a><span class="lineno">16982</span>&#160;                                    $dom[$key][<span class="stringliteral">&#39;fontsize&#39;</span>] = intval($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;size&#39;</span>]);</div>
<div class="line"><a name="l16983"></a><span class="lineno">16983</span>&#160;                                }</div>
<div class="line"><a name="l16984"></a><span class="lineno">16984</span>&#160;                            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l16985"></a><span class="lineno">16985</span>&#160;                                $dom[$key][<span class="stringliteral">&#39;fontsize&#39;</span>] = intval($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;size&#39;</span>]);</div>
<div class="line"><a name="l16986"></a><span class="lineno">16986</span>&#160;                            }</div>
<div class="line"><a name="l16987"></a><span class="lineno">16987</span>&#160;                        }</div>
<div class="line"><a name="l16988"></a><span class="lineno">16988</span>&#160;                    }</div>
<div class="line"><a name="l16989"></a><span class="lineno">16989</span>&#160;                    <span class="comment">// force natural alignment for lists</span></div>
<div class="line"><a name="l16990"></a><span class="lineno">16990</span>&#160;                    <span class="keywordflow">if</span> ((($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;ul&#39;</span>) OR ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;ol&#39;</span>) OR ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;dl&#39;</span>))</div>
<div class="line"><a name="l16991"></a><span class="lineno">16991</span>&#160;                        AND (!isset($dom[$key][<span class="stringliteral">&#39;align&#39;</span>]) OR TCPDF_STATIC::empty_string($dom[$key][<span class="stringliteral">&#39;align&#39;</span>]) OR ($dom[$key][<span class="stringliteral">&#39;align&#39;</span>] != <span class="charliteral">&#39;J&#39;</span>))) {</div>
<div class="line"><a name="l16992"></a><span class="lineno">16992</span>&#160;                        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l16993"></a><span class="lineno">16993</span>&#160;                            $dom[$key][<span class="stringliteral">&#39;align&#39;</span>] = <span class="charliteral">&#39;R&#39;</span>;</div>
<div class="line"><a name="l16994"></a><span class="lineno">16994</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l16995"></a><span class="lineno">16995</span>&#160;                            $dom[$key][<span class="stringliteral">&#39;align&#39;</span>] = <span class="charliteral">&#39;L&#39;</span>;</div>
<div class="line"><a name="l16996"></a><span class="lineno">16996</span>&#160;                        }</div>
<div class="line"><a name="l16997"></a><span class="lineno">16997</span>&#160;                    }</div>
<div class="line"><a name="l16998"></a><span class="lineno">16998</span>&#160;                    <span class="keywordflow">if</span> (($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;small&#39;</span>) OR ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;sup&#39;</span>) OR ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;sub&#39;</span>)) {</div>
<div class="line"><a name="l16999"></a><span class="lineno">16999</span>&#160;                        <span class="keywordflow">if</span> (!isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;size&#39;</span>]) AND !isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;font-size&#39;</span>])) {</div>
<div class="line"><a name="l17000"></a><span class="lineno">17000</span>&#160;                            $dom[$key][<span class="stringliteral">&#39;fontsize&#39;</span>] = $dom[$key][<span class="stringliteral">&#39;fontsize&#39;</span>] * <a class="code" href="../../d5/dc0/tcpdf__config_8php.html#af5215614354b049d4e070e92194b8acc">K_SMALL_RATIO</a>;</div>
<div class="line"><a name="l17001"></a><span class="lineno">17001</span>&#160;                        }</div>
<div class="line"><a name="l17002"></a><span class="lineno">17002</span>&#160;                    }</div>
<div class="line"><a name="l17003"></a><span class="lineno">17003</span>&#160;                    <span class="keywordflow">if</span> (($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;strong&#39;</span>) OR ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="charliteral">&#39;b&#39;</span>)) {</div>
<div class="line"><a name="l17004"></a><span class="lineno">17004</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;fontstyle&#39;</span>] .= <span class="charliteral">&#39;B&#39;</span>;</div>
<div class="line"><a name="l17005"></a><span class="lineno">17005</span>&#160;                    }</div>
<div class="line"><a name="l17006"></a><span class="lineno">17006</span>&#160;                    <span class="keywordflow">if</span> (($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;em&#39;</span>) OR ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="charliteral">&#39;i&#39;</span>)) {</div>
<div class="line"><a name="l17007"></a><span class="lineno">17007</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;fontstyle&#39;</span>] .= <span class="charliteral">&#39;I&#39;</span>;</div>
<div class="line"><a name="l17008"></a><span class="lineno">17008</span>&#160;                    }</div>
<div class="line"><a name="l17009"></a><span class="lineno">17009</span>&#160;                    <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="charliteral">&#39;u&#39;</span>) {</div>
<div class="line"><a name="l17010"></a><span class="lineno">17010</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;fontstyle&#39;</span>] .= <span class="charliteral">&#39;U&#39;</span>;</div>
<div class="line"><a name="l17011"></a><span class="lineno">17011</span>&#160;                    }</div>
<div class="line"><a name="l17012"></a><span class="lineno">17012</span>&#160;                    <span class="keywordflow">if</span> (($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;del&#39;</span>) OR ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="charliteral">&#39;s&#39;</span>) OR ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;strike&#39;</span>)) {</div>
<div class="line"><a name="l17013"></a><span class="lineno">17013</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;fontstyle&#39;</span>] .= <span class="charliteral">&#39;D&#39;</span>;</div>
<div class="line"><a name="l17014"></a><span class="lineno">17014</span>&#160;                    }</div>
<div class="line"><a name="l17015"></a><span class="lineno">17015</span>&#160;                    <span class="keywordflow">if</span> (!isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;text-decoration&#39;</span>]) AND ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="charliteral">&#39;a&#39;</span>)) {</div>
<div class="line"><a name="l17016"></a><span class="lineno">17016</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;fontstyle&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a5dedfd8b2f29748200d45a186182c86c">$this-&gt;htmlLinkFontStyle</a>;</div>
<div class="line"><a name="l17017"></a><span class="lineno">17017</span>&#160;                    }</div>
<div class="line"><a name="l17018"></a><span class="lineno">17018</span>&#160;                    <span class="keywordflow">if</span> (($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;pre&#39;</span>) OR ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;tt&#39;</span>)) {</div>
<div class="line"><a name="l17019"></a><span class="lineno">17019</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;fontname&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a25b565e4885c362df7211dd7f3b9c4fa">$this-&gt;default_monospaced_font</a>;</div>
<div class="line"><a name="l17020"></a><span class="lineno">17020</span>&#160;                    }</div>
<div class="line"><a name="l17021"></a><span class="lineno">17021</span>&#160;                    <span class="keywordflow">if</span> (!empty($dom[$key][<span class="stringliteral">&#39;value&#39;</span>]) AND ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>][0] == <span class="charliteral">&#39;h&#39;</span>) AND (intval($dom[$key][<span class="stringliteral">&#39;value&#39;</span>]{1}) &gt; 0) AND (intval($dom[$key][<span class="stringliteral">&#39;value&#39;</span>]{1}) &lt; 7)) {</div>
<div class="line"><a name="l17022"></a><span class="lineno">17022</span>&#160;                        <span class="comment">// headings h1, h2, h3, h4, h5, h6</span></div>
<div class="line"><a name="l17023"></a><span class="lineno">17023</span>&#160;                        <span class="keywordflow">if</span> (!isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;size&#39;</span>]) AND !isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;font-size&#39;</span>])) {</div>
<div class="line"><a name="l17024"></a><span class="lineno">17024</span>&#160;                            $headsize = (4 - intval($dom[$key][<span class="stringliteral">&#39;value&#39;</span>]{1})) * 2;</div>
<div class="line"><a name="l17025"></a><span class="lineno">17025</span>&#160;                            $dom[$key][<span class="stringliteral">&#39;fontsize&#39;</span>] = $dom[0][<span class="stringliteral">&#39;fontsize&#39;</span>] + $headsize;</div>
<div class="line"><a name="l17026"></a><span class="lineno">17026</span>&#160;                        }</div>
<div class="line"><a name="l17027"></a><span class="lineno">17027</span>&#160;                        <span class="keywordflow">if</span> (!isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;font-weight&#39;</span>])) {</div>
<div class="line"><a name="l17028"></a><span class="lineno">17028</span>&#160;                            $dom[$key][<span class="stringliteral">&#39;fontstyle&#39;</span>] .= <span class="charliteral">&#39;B&#39;</span>;</div>
<div class="line"><a name="l17029"></a><span class="lineno">17029</span>&#160;                        }</div>
<div class="line"><a name="l17030"></a><span class="lineno">17030</span>&#160;                    }</div>
<div class="line"><a name="l17031"></a><span class="lineno">17031</span>&#160;                    <span class="keywordflow">if</span> (($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;table&#39;</span>)) {</div>
<div class="line"><a name="l17032"></a><span class="lineno">17032</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;rows&#39;</span>] = 0; <span class="comment">// number of rows</span></div>
<div class="line"><a name="l17033"></a><span class="lineno">17033</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;trids&#39;</span>] = array(); <span class="comment">// IDs of TR elements</span></div>
<div class="line"><a name="l17034"></a><span class="lineno">17034</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;thead&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>; <span class="comment">// table header rows</span></div>
<div class="line"><a name="l17035"></a><span class="lineno">17035</span>&#160;                    }</div>
<div class="line"><a name="l17036"></a><span class="lineno">17036</span>&#160;                    <span class="keywordflow">if</span> (($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;tr&#39;</span>)) {</div>
<div class="line"><a name="l17037"></a><span class="lineno">17037</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;cols&#39;</span>] = 0;</div>
<div class="line"><a name="l17038"></a><span class="lineno">17038</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#ae7cd5ea4b0ef3a0910ed0044bea97f1d">$thead</a>) {</div>
<div class="line"><a name="l17039"></a><span class="lineno">17039</span>&#160;                            $dom[$key][<span class="stringliteral">&#39;thead&#39;</span>] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l17040"></a><span class="lineno">17040</span>&#160;                            <span class="comment">// rows on thead block are printed as a separate table</span></div>
<div class="line"><a name="l17041"></a><span class="lineno">17041</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l17042"></a><span class="lineno">17042</span>&#160;                            $dom[$key][<span class="stringliteral">&#39;thead&#39;</span>] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l17043"></a><span class="lineno">17043</span>&#160;                            <span class="comment">// store the number of rows on table element</span></div>
<div class="line"><a name="l17044"></a><span class="lineno">17044</span>&#160;                            ++$dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;rows&#39;</span>];</div>
<div class="line"><a name="l17045"></a><span class="lineno">17045</span>&#160;                            <span class="comment">// store the TR elements IDs on table element</span></div>
<div class="line"><a name="l17046"></a><span class="lineno">17046</span>&#160;                            array_push($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;trids&#39;</span>], $key);</div>
<div class="line"><a name="l17047"></a><span class="lineno">17047</span>&#160;                        }</div>
<div class="line"><a name="l17048"></a><span class="lineno">17048</span>&#160;                    }</div>
<div class="line"><a name="l17049"></a><span class="lineno">17049</span>&#160;                    <span class="keywordflow">if</span> (($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;th&#39;</span>) OR ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;td&#39;</span>)) {</div>
<div class="line"><a name="l17050"></a><span class="lineno">17050</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;colspan&#39;</span>])) {</div>
<div class="line"><a name="l17051"></a><span class="lineno">17051</span>&#160;                            $colspan = intval($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;colspan&#39;</span>]);</div>
<div class="line"><a name="l17052"></a><span class="lineno">17052</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l17053"></a><span class="lineno">17053</span>&#160;                            $colspan = 1;</div>
<div class="line"><a name="l17054"></a><span class="lineno">17054</span>&#160;                        }</div>
<div class="line"><a name="l17055"></a><span class="lineno">17055</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;colspan&#39;</span>] = $colspan;</div>
<div class="line"><a name="l17056"></a><span class="lineno">17056</span>&#160;                        $dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;cols&#39;</span>] += $colspan;</div>
<div class="line"><a name="l17057"></a><span class="lineno">17057</span>&#160;                    }</div>
<div class="line"><a name="l17058"></a><span class="lineno">17058</span>&#160;                    <span class="comment">// text direction</span></div>
<div class="line"><a name="l17059"></a><span class="lineno">17059</span>&#160;                    <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;dir&#39;</span>])) {</div>
<div class="line"><a name="l17060"></a><span class="lineno">17060</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;dir&#39;</span>] = $dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;dir&#39;</span>];</div>
<div class="line"><a name="l17061"></a><span class="lineno">17061</span>&#160;                    }</div>
<div class="line"><a name="l17062"></a><span class="lineno">17062</span>&#160;                    <span class="comment">// set foreground color attribute</span></div>
<div class="line"><a name="l17063"></a><span class="lineno">17063</span>&#160;                    <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;color&#39;</span>]) AND (!TCPDF_STATIC::empty_string($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;color&#39;</span>]))) {</div>
<div class="line"><a name="l17064"></a><span class="lineno">17064</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;fgcolor&#39;</span>] = TCPDF_COLORS::convertHTMLColorToDec($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;color&#39;</span>], $this-&gt;spot_colors);</div>
<div class="line"><a name="l17065"></a><span class="lineno">17065</span>&#160;                    } elseif (!isset($dom[$key][<span class="stringliteral">&#39;style&#39;</span>][<span class="stringliteral">&#39;color&#39;</span>]) AND ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="charliteral">&#39;a&#39;</span>)) {</div>
<div class="line"><a name="l17066"></a><span class="lineno">17066</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;fgcolor&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#ad314dda630c9467efd594d46d24abcd5">$this-&gt;htmlLinkColorArray</a>;</div>
<div class="line"><a name="l17067"></a><span class="lineno">17067</span>&#160;                    }</div>
<div class="line"><a name="l17068"></a><span class="lineno">17068</span>&#160;                    <span class="comment">// set background color attribute</span></div>
<div class="line"><a name="l17069"></a><span class="lineno">17069</span>&#160;                    <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;bgcolor&#39;</span>]) AND (!TCPDF_STATIC::empty_string($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;bgcolor&#39;</span>]))) {</div>
<div class="line"><a name="l17070"></a><span class="lineno">17070</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;bgcolor&#39;</span>] = TCPDF_COLORS::convertHTMLColorToDec($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;bgcolor&#39;</span>], $this-&gt;spot_colors);</div>
<div class="line"><a name="l17071"></a><span class="lineno">17071</span>&#160;                    }</div>
<div class="line"><a name="l17072"></a><span class="lineno">17072</span>&#160;                    <span class="comment">// set stroke color attribute</span></div>
<div class="line"><a name="l17073"></a><span class="lineno">17073</span>&#160;                    <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;strokecolor&#39;</span>]) AND (!TCPDF_STATIC::empty_string($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;strokecolor&#39;</span>]))) {</div>
<div class="line"><a name="l17074"></a><span class="lineno">17074</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;strokecolor&#39;</span>] = TCPDF_COLORS::convertHTMLColorToDec($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;strokecolor&#39;</span>], $this-&gt;spot_colors);</div>
<div class="line"><a name="l17075"></a><span class="lineno">17075</span>&#160;                    }</div>
<div class="line"><a name="l17076"></a><span class="lineno">17076</span>&#160;                    <span class="comment">// check for width attribute</span></div>
<div class="line"><a name="l17077"></a><span class="lineno">17077</span>&#160;                    <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;width&#39;</span>])) {</div>
<div class="line"><a name="l17078"></a><span class="lineno">17078</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;width&#39;</span>] = $dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;width&#39;</span>];</div>
<div class="line"><a name="l17079"></a><span class="lineno">17079</span>&#160;                    }</div>
<div class="line"><a name="l17080"></a><span class="lineno">17080</span>&#160;                    <span class="comment">// check for height attribute</span></div>
<div class="line"><a name="l17081"></a><span class="lineno">17081</span>&#160;                    <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;height&#39;</span>])) {</div>
<div class="line"><a name="l17082"></a><span class="lineno">17082</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;height&#39;</span>] = $dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;height&#39;</span>];</div>
<div class="line"><a name="l17083"></a><span class="lineno">17083</span>&#160;                    }</div>
<div class="line"><a name="l17084"></a><span class="lineno">17084</span>&#160;                    <span class="comment">// check for text alignment</span></div>
<div class="line"><a name="l17085"></a><span class="lineno">17085</span>&#160;                    <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;align&#39;</span>]) AND (!TCPDF_STATIC::empty_string($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;align&#39;</span>])) AND ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] !== <span class="stringliteral">&#39;img&#39;</span>)) {</div>
<div class="line"><a name="l17086"></a><span class="lineno">17086</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;align&#39;</span>] = strtoupper($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;align&#39;</span>][0]);</div>
<div class="line"><a name="l17087"></a><span class="lineno">17087</span>&#160;                    }</div>
<div class="line"><a name="l17088"></a><span class="lineno">17088</span>&#160;                    <span class="comment">// check for text rendering mode (the following attributes do not exist in HTML)</span></div>
<div class="line"><a name="l17089"></a><span class="lineno">17089</span>&#160;                    <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;stroke&#39;</span>])) {</div>
<div class="line"><a name="l17090"></a><span class="lineno">17090</span>&#160;                        <span class="comment">// font stroke width</span></div>
<div class="line"><a name="l17091"></a><span class="lineno">17091</span>&#160;                        $dom[$key][<span class="stringliteral">&#39;stroke&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9">getHTMLUnitToUnits</a>($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;stroke&#39;</span>], $dom[$key][<span class="stringliteral">&#39;fontsize&#39;</span>], <span class="stringliteral">&#39;pt&#39;</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l17092"></a><span class="lineno">17092</span>&#160;                    }</div>
<div class="line"><a name="l17093"></a><span class="lineno">17093</span>&#160;                    <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;fill&#39;</span>])) {</div>
<div class="line"><a name="l17094"></a><span class="lineno">17094</span>&#160;                        <span class="comment">// font fill</span></div>
<div class="line"><a name="l17095"></a><span class="lineno">17095</span>&#160;                        <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;fill&#39;</span>] == <span class="stringliteral">&#39;true&#39;</span>) {</div>
<div class="line"><a name="l17096"></a><span class="lineno">17096</span>&#160;                            $dom[$key][<span class="stringliteral">&#39;fill&#39;</span>] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l17097"></a><span class="lineno">17097</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l17098"></a><span class="lineno">17098</span>&#160;                            $dom[$key][<span class="stringliteral">&#39;fill&#39;</span>] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l17099"></a><span class="lineno">17099</span>&#160;                        }</div>
<div class="line"><a name="l17100"></a><span class="lineno">17100</span>&#160;                    }</div>
<div class="line"><a name="l17101"></a><span class="lineno">17101</span>&#160;                    <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;clip&#39;</span>])) {</div>
<div class="line"><a name="l17102"></a><span class="lineno">17102</span>&#160;                        <span class="comment">// clipping mode</span></div>
<div class="line"><a name="l17103"></a><span class="lineno">17103</span>&#160;                        <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;clip&#39;</span>] == <span class="stringliteral">&#39;true&#39;</span>) {</div>
<div class="line"><a name="l17104"></a><span class="lineno">17104</span>&#160;                            $dom[$key][<span class="stringliteral">&#39;clip&#39;</span>] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l17105"></a><span class="lineno">17105</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l17106"></a><span class="lineno">17106</span>&#160;                            $dom[$key][<span class="stringliteral">&#39;clip&#39;</span>] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l17107"></a><span class="lineno">17107</span>&#160;                        }</div>
<div class="line"><a name="l17108"></a><span class="lineno">17108</span>&#160;                    }</div>
<div class="line"><a name="l17109"></a><span class="lineno">17109</span>&#160;                } <span class="comment">// end opening tag</span></div>
<div class="line"><a name="l17110"></a><span class="lineno">17110</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l17111"></a><span class="lineno">17111</span>&#160;                <span class="comment">// text</span></div>
<div class="line"><a name="l17112"></a><span class="lineno">17112</span>&#160;                $dom[$key][<span class="stringliteral">&#39;tag&#39;</span>] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l17113"></a><span class="lineno">17113</span>&#160;                $dom[$key][<span class="stringliteral">&#39;block&#39;</span>] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l17114"></a><span class="lineno">17114</span>&#160;                $dom[$key][<span class="stringliteral">&#39;parent&#39;</span>] = end($level);</div>
<div class="line"><a name="l17115"></a><span class="lineno">17115</span>&#160;                $dom[$key][<span class="stringliteral">&#39;dir&#39;</span>] = $dom[$dom[$key][<span class="stringliteral">&#39;parent&#39;</span>]][<span class="stringliteral">&#39;dir&#39;</span>];</div>
<div class="line"><a name="l17116"></a><span class="lineno">17116</span>&#160;                <span class="keywordflow">if</span> (!empty($dom[$dom[$key][<span class="stringliteral">&#39;parent&#39;</span>]][<span class="stringliteral">&#39;text-transform&#39;</span>])) {</div>
<div class="line"><a name="l17117"></a><span class="lineno">17117</span>&#160;                    <span class="comment">// text-transform for unicode requires mb_convert_case (Multibyte String Functions)</span></div>
<div class="line"><a name="l17118"></a><span class="lineno">17118</span>&#160;                    <span class="keywordflow">if</span> (function_exists(<span class="stringliteral">&#39;mb_convert_case&#39;</span>)) {</div>
<div class="line"><a name="l17119"></a><span class="lineno">17119</span>&#160;                        $ttm = array(<span class="stringliteral">&#39;capitalize&#39;</span> =&gt; MB_CASE_TITLE, <span class="stringliteral">&#39;uppercase&#39;</span> =&gt; MB_CASE_UPPER, <span class="stringliteral">&#39;lowercase&#39;</span> =&gt; MB_CASE_LOWER);</div>
<div class="line"><a name="l17120"></a><span class="lineno">17120</span>&#160;                        <span class="keywordflow">if</span> (isset($ttm[$dom[$dom[$key][<span class="stringliteral">&#39;parent&#39;</span>]][<span class="stringliteral">&#39;text-transform&#39;</span>]])) {</div>
<div class="line"><a name="l17121"></a><span class="lineno">17121</span>&#160;                            $element = mb_convert_case($element, $ttm[$dom[$dom[$key][<span class="stringliteral">&#39;parent&#39;</span>]][<span class="stringliteral">&#39;text-transform&#39;</span>]], $this-&gt;encoding);</div>
<div class="line"><a name="l17122"></a><span class="lineno">17122</span>&#160;                        }</div>
<div class="line"><a name="l17123"></a><span class="lineno">17123</span>&#160;                    } elseif (!$this-&gt;isunicode) {</div>
<div class="line"><a name="l17124"></a><span class="lineno">17124</span>&#160;                        <span class="keywordflow">switch</span> ($dom[$dom[$key][<span class="stringliteral">&#39;parent&#39;</span>]][<span class="stringliteral">&#39;text-transform&#39;</span>]) {</div>
<div class="line"><a name="l17125"></a><span class="lineno">17125</span>&#160;                            <span class="keywordflow">case</span> <span class="stringliteral">&#39;capitalize&#39;</span>: {</div>
<div class="line"><a name="l17126"></a><span class="lineno">17126</span>&#160;                                $element = ucwords(strtolower($element));</div>
<div class="line"><a name="l17127"></a><span class="lineno">17127</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l17128"></a><span class="lineno">17128</span>&#160;                            }</div>
<div class="line"><a name="l17129"></a><span class="lineno">17129</span>&#160;                            <span class="keywordflow">case</span> <span class="stringliteral">&#39;uppercase&#39;</span>: {</div>
<div class="line"><a name="l17130"></a><span class="lineno">17130</span>&#160;                                $element = strtoupper($element);</div>
<div class="line"><a name="l17131"></a><span class="lineno">17131</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l17132"></a><span class="lineno">17132</span>&#160;                            }</div>
<div class="line"><a name="l17133"></a><span class="lineno">17133</span>&#160;                            <span class="keywordflow">case</span> <span class="stringliteral">&#39;lowercase&#39;</span>: {</div>
<div class="line"><a name="l17134"></a><span class="lineno">17134</span>&#160;                                $element = strtolower($element);</div>
<div class="line"><a name="l17135"></a><span class="lineno">17135</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l17136"></a><span class="lineno">17136</span>&#160;                            }</div>
<div class="line"><a name="l17137"></a><span class="lineno">17137</span>&#160;                        }</div>
<div class="line"><a name="l17138"></a><span class="lineno">17138</span>&#160;                    }</div>
<div class="line"><a name="l17139"></a><span class="lineno">17139</span>&#160;                }</div>
<div class="line"><a name="l17140"></a><span class="lineno">17140</span>&#160;                $dom[$key][<span class="stringliteral">&#39;value&#39;</span>] = stripslashes($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ae4bdb1a4c29d0a0d707caad308dcd320">unhtmlentities</a>($element));</div>
<div class="line"><a name="l17141"></a><span class="lineno">17141</span>&#160;            }</div>
<div class="line"><a name="l17142"></a><span class="lineno">17142</span>&#160;            ++$elkey;</div>
<div class="line"><a name="l17143"></a><span class="lineno">17143</span>&#160;            ++$key;</div>
<div class="line"><a name="l17144"></a><span class="lineno">17144</span>&#160;        }</div>
<div class="line"><a name="l17145"></a><span class="lineno">17145</span>&#160;        <span class="keywordflow">return</span> $dom;</div>
<div class="line"><a name="l17146"></a><span class="lineno">17146</span>&#160;    }</div>
<div class="line"><a name="l17147"></a><span class="lineno">17147</span>&#160;</div>
<div class="line"><a name="l17155"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a623785c4dc57739d845b36e810704a89">17155</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a623785c4dc57739d845b36e810704a89">getSpaceString</a>() {</div>
<div class="line"><a name="l17156"></a><span class="lineno">17156</span>&#160;        $spacestr = chr(32);</div>
<div class="line"><a name="l17157"></a><span class="lineno">17157</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a81c8257af5d6d6e40f1bb77d6b507b97">isUnicodeFont</a>()) {</div>
<div class="line"><a name="l17158"></a><span class="lineno">17158</span>&#160;            $spacestr = chr(0).chr(32);</div>
<div class="line"><a name="l17159"></a><span class="lineno">17159</span>&#160;        }</div>
<div class="line"><a name="l17160"></a><span class="lineno">17160</span>&#160;        <span class="keywordflow">return</span> $spacestr;</div>
<div class="line"><a name="l17161"></a><span class="lineno">17161</span>&#160;    }</div>
<div class="line"><a name="l17162"></a><span class="lineno">17162</span>&#160;</div>
<div class="line"><a name="l17171"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a9928801520cbb84e9f88c02bfd957b73">17171</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a9928801520cbb84e9f88c02bfd957b73">serializeTCPDFtagParameters</a>($pararray) {</div>
<div class="line"><a name="l17172"></a><span class="lineno">17172</span>&#160;        <span class="keywordflow">return</span> TCPDF_STATIC::serializeTCPDFtagParameters($pararray);</div>
<div class="line"><a name="l17173"></a><span class="lineno">17173</span>&#160;    }</div>
<div class="line"><a name="l17174"></a><span class="lineno">17174</span>&#160;</div>
<div class="line"><a name="l17197"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a8458280d15b73d3baffb28eebe2d9246">17197</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a8458280d15b73d3baffb28eebe2d9246">writeHTMLCell</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, $html=<span class="stringliteral">&#39;&#39;</span>, $border=0, $ln=0, $fill=<span class="keyword">false</span>, $reseth=<span class="keyword">true</span>, $align=<span class="stringliteral">&#39;&#39;</span>, $autopadding=<span class="keyword">true</span>) {</div>
<div class="line"><a name="l17198"></a><span class="lineno">17198</span>&#160;        <span class="keywordflow">return</span> $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa81d4b585de305c054760ec983ed3ece">MultiCell</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $html, $border, $align, $fill, $ln, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, $reseth, 0, <span class="keyword">true</span>, $autopadding, 0, <span class="charliteral">&#39;T&#39;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l17199"></a><span class="lineno">17199</span>&#160;    }</div>
<div class="line"><a name="l17200"></a><span class="lineno">17200</span>&#160;</div>
<div class="line"><a name="l17214"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ac3fdf25fcd36f1dce04f92187c621407">17214</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ac3fdf25fcd36f1dce04f92187c621407">writeHTML</a>($html, $ln=<span class="keyword">true</span>, $fill=<span class="keyword">false</span>, $reseth=<span class="keyword">false</span>, $cell=<span class="keyword">false</span>, $align=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l17215"></a><span class="lineno">17215</span>&#160;        $gvars = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a24d3c102468b6ab9d2f4859a8b01863a">getGraphicVars</a>();</div>
<div class="line"><a name="l17216"></a><span class="lineno">17216</span>&#160;        <span class="comment">// store current values</span></div>
<div class="line"><a name="l17217"></a><span class="lineno">17217</span>&#160;        $prev_cell_margin = <a class="code" href="../../d4/d40/classTCPDF.html#a6decef4569cfd79d75e47cab1315fa77">$this-&gt;cell_margin</a>;</div>
<div class="line"><a name="l17218"></a><span class="lineno">17218</span>&#160;        $prev_cell_padding = <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$this-&gt;cell_padding</a>;</div>
<div class="line"><a name="l17219"></a><span class="lineno">17219</span>&#160;        $prevPage = <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>;</div>
<div class="line"><a name="l17220"></a><span class="lineno">17220</span>&#160;        $prevlMargin = <a class="code" href="../../d4/d40/classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da">$this-&gt;lMargin</a>;</div>
<div class="line"><a name="l17221"></a><span class="lineno">17221</span>&#160;        $prevrMargin = <a class="code" href="../../d4/d40/classTCPDF.html#a44fb75b85bea40ced25fdea9d89dc8e9">$this-&gt;rMargin</a>;</div>
<div class="line"><a name="l17222"></a><span class="lineno">17222</span>&#160;        $curfontname = <a class="code" href="../../d4/d40/classTCPDF.html#a642c62438ec9c983283a98d5099ba7ba">$this-&gt;FontFamily</a>;</div>
<div class="line"><a name="l17223"></a><span class="lineno">17223</span>&#160;        $curfontstyle = <a class="code" href="../../d4/d40/classTCPDF.html#a6fce74bcde6c138d286dce274950dff7">$this-&gt;FontStyle</a>;</div>
<div class="line"><a name="l17224"></a><span class="lineno">17224</span>&#160;        $curfontsize = <a class="code" href="../../d4/d40/classTCPDF.html#a9a787786c9f1a04f54f1dec622869d4d">$this-&gt;FontSizePt</a>;</div>
<div class="line"><a name="l17225"></a><span class="lineno">17225</span>&#160;        $curfontascent = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#acf41c6c04c29e1323bb270fdea6b5a9f">getFontAscent</a>($curfontname, $curfontstyle, $curfontsize);</div>
<div class="line"><a name="l17226"></a><span class="lineno">17226</span>&#160;        $curfontdescent = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a0c8374150dbc8ca092618ca430713f70">getFontDescent</a>($curfontname, $curfontstyle, $curfontsize);</div>
<div class="line"><a name="l17227"></a><span class="lineno">17227</span>&#160;        $curfontstretcing = <a class="code" href="../../d4/d40/classTCPDF.html#a420a1fac2969936a7d57f4cb9c99849b">$this-&gt;font_stretching</a>;</div>
<div class="line"><a name="l17228"></a><span class="lineno">17228</span>&#160;        $curfonttracking = <a class="code" href="../../d4/d40/classTCPDF.html#a3f4d91c3489a2c62b628c347551f7adf">$this-&gt;font_spacing</a>;</div>
<div class="line"><a name="l17229"></a><span class="lineno">17229</span>&#160;        $this-&gt;newline = <span class="keyword">true</span>;</div>
<div class="line"><a name="l17230"></a><span class="lineno">17230</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#a505b4eabece70b8679ebdeb86964b798">$newline</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l17231"></a><span class="lineno">17231</span>&#160;        $startlinepage = <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>;</div>
<div class="line"><a name="l17232"></a><span class="lineno">17232</span>&#160;        $minstartliney = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l17233"></a><span class="lineno">17233</span>&#160;        $maxbottomliney = 0;</div>
<div class="line"><a name="l17234"></a><span class="lineno">17234</span>&#160;        $startlinex = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$this-&gt;x</a>;</div>
<div class="line"><a name="l17235"></a><span class="lineno">17235</span>&#160;        $startliney = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l17236"></a><span class="lineno">17236</span>&#160;        $yshift = 0;</div>
<div class="line"><a name="l17237"></a><span class="lineno">17237</span>&#160;        $loop = 0;</div>
<div class="line"><a name="l17238"></a><span class="lineno">17238</span>&#160;        $curpos = 0;</div>
<div class="line"><a name="l17239"></a><span class="lineno">17239</span>&#160;        $this_method_vars = array();</div>
<div class="line"><a name="l17240"></a><span class="lineno">17240</span>&#160;        $undo = <span class="keyword">false</span>;</div>
<div class="line"><a name="l17241"></a><span class="lineno">17241</span>&#160;        $fontaligned = <span class="keyword">false</span>;</div>
<div class="line"><a name="l17242"></a><span class="lineno">17242</span>&#160;        $reverse_dir = <span class="keyword">false</span>; <span class="comment">// true when the text direction is reversed</span></div>
<div class="line"><a name="l17243"></a><span class="lineno">17243</span>&#160;        $this-&gt;premode = <span class="keyword">false</span>;</div>
<div class="line"><a name="l17244"></a><span class="lineno">17244</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;inxobj) {</div>
<div class="line"><a name="l17245"></a><span class="lineno">17245</span>&#160;            <span class="comment">// we are inside an XObject template</span></div>
<div class="line"><a name="l17246"></a><span class="lineno">17246</span>&#160;            $pask = count($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;annotations&#39;</span>]);</div>
<div class="line"><a name="l17247"></a><span class="lineno">17247</span>&#160;        } elseif (isset($this-&gt;PageAnnots[$this-&gt;page])) {</div>
<div class="line"><a name="l17248"></a><span class="lineno">17248</span>&#160;            $pask = count($this-&gt;PageAnnots[$this-&gt;page]);</div>
<div class="line"><a name="l17249"></a><span class="lineno">17249</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l17250"></a><span class="lineno">17250</span>&#160;            $pask = 0;</div>
<div class="line"><a name="l17251"></a><span class="lineno">17251</span>&#160;        }</div>
<div class="line"><a name="l17252"></a><span class="lineno">17252</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;inxobj) {</div>
<div class="line"><a name="l17253"></a><span class="lineno">17253</span>&#160;            <span class="comment">// we are inside an XObject template</span></div>
<div class="line"><a name="l17254"></a><span class="lineno">17254</span>&#160;            $startlinepos = strlen($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;outdata&#39;</span>]);</div>
<div class="line"><a name="l17255"></a><span class="lineno">17255</span>&#160;        } elseif (!$this-&gt;InFooter) {</div>
<div class="line"><a name="l17256"></a><span class="lineno">17256</span>&#160;            <span class="keywordflow">if</span> (isset($this-&gt;footerlen[$this-&gt;page])) {</div>
<div class="line"><a name="l17257"></a><span class="lineno">17257</span>&#160;                $this-&gt;footerpos[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>] = $this-&gt;pagelen[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>] - $this-&gt;footerlen[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>];</div>
<div class="line"><a name="l17258"></a><span class="lineno">17258</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l17259"></a><span class="lineno">17259</span>&#160;                $this-&gt;footerpos[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>] = $this-&gt;pagelen[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>];</div>
<div class="line"><a name="l17260"></a><span class="lineno">17260</span>&#160;            }</div>
<div class="line"><a name="l17261"></a><span class="lineno">17261</span>&#160;            $startlinepos = $this-&gt;footerpos[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>];</div>
<div class="line"><a name="l17262"></a><span class="lineno">17262</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l17263"></a><span class="lineno">17263</span>&#160;            <span class="comment">// we are inside the footer</span></div>
<div class="line"><a name="l17264"></a><span class="lineno">17264</span>&#160;            $startlinepos = $this-&gt;pagelen[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>];</div>
<div class="line"><a name="l17265"></a><span class="lineno">17265</span>&#160;        }</div>
<div class="line"><a name="l17266"></a><span class="lineno">17266</span>&#160;        $lalign = $align;</div>
<div class="line"><a name="l17267"></a><span class="lineno">17267</span>&#160;        $plalign = $align;</div>
<div class="line"><a name="l17268"></a><span class="lineno">17268</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l17269"></a><span class="lineno">17269</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = $this-&gt;x - <a class="code" href="../../d4/d40/classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da">$this-&gt;lMargin</a>;</div>
<div class="line"><a name="l17270"></a><span class="lineno">17270</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l17271"></a><span class="lineno">17271</span>&#160;            <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = $this-&gt;w - $this-&gt;rMargin - <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$this-&gt;x</a>;</div>
<div class="line"><a name="l17272"></a><span class="lineno">17272</span>&#160;        }</div>
<div class="line"><a name="l17273"></a><span class="lineno">17273</span>&#160;        <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> -= ($this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>] + $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>]);</div>
<div class="line"><a name="l17274"></a><span class="lineno">17274</span>&#160;        <span class="keywordflow">if</span> ($cell) {</div>
<div class="line"><a name="l17275"></a><span class="lineno">17275</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l17276"></a><span class="lineno">17276</span>&#160;                $this-&gt;x -= $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>];</div>
<div class="line"><a name="l17277"></a><span class="lineno">17277</span>&#160;                $this-&gt;lMargin += $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>];</div>
<div class="line"><a name="l17278"></a><span class="lineno">17278</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l17279"></a><span class="lineno">17279</span>&#160;                $this-&gt;x += $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>];</div>
<div class="line"><a name="l17280"></a><span class="lineno">17280</span>&#160;                $this-&gt;rMargin += $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>];</div>
<div class="line"><a name="l17281"></a><span class="lineno">17281</span>&#160;            }</div>
<div class="line"><a name="l17282"></a><span class="lineno">17282</span>&#160;        }</div>
<div class="line"><a name="l17283"></a><span class="lineno">17283</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;customlistindent &gt;= 0) {</div>
<div class="line"><a name="l17284"></a><span class="lineno">17284</span>&#160;            $this-&gt;listindent = <a class="code" href="../../d4/d40/classTCPDF.html#a9d5b2e618c656365a57eeacc66940311">$this-&gt;customlistindent</a>;</div>
<div class="line"><a name="l17285"></a><span class="lineno">17285</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l17286"></a><span class="lineno">17286</span>&#160;            $this-&gt;listindent = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8075c1f04b6fbddc957cff786c4b16d9">GetStringWidth</a>(<span class="stringliteral">&#39;000000&#39;</span>);</div>
<div class="line"><a name="l17287"></a><span class="lineno">17287</span>&#160;        }</div>
<div class="line"><a name="l17288"></a><span class="lineno">17288</span>&#160;        $this-&gt;listindentlevel = 0;</div>
<div class="line"><a name="l17289"></a><span class="lineno">17289</span>&#160;        <span class="comment">// save previous states</span></div>
<div class="line"><a name="l17290"></a><span class="lineno">17290</span>&#160;        $prev_cell_height_ratio = <a class="code" href="../../d4/d40/classTCPDF.html#af8cc74fe5806eb009a22791c3a4c7cce">$this-&gt;cell_height_ratio</a>;</div>
<div class="line"><a name="l17291"></a><span class="lineno">17291</span>&#160;        $prev_listnum = <a class="code" href="../../d4/d40/classTCPDF.html#a92b743d472f53d5260274c7915829ff7">$this-&gt;listnum</a>;</div>
<div class="line"><a name="l17292"></a><span class="lineno">17292</span>&#160;        $prev_listordered = <a class="code" href="../../d4/d40/classTCPDF.html#add40afd65a8b5349248c69d057cb462d">$this-&gt;listordered</a>;</div>
<div class="line"><a name="l17293"></a><span class="lineno">17293</span>&#160;        $prev_listcount = <a class="code" href="../../d4/d40/classTCPDF.html#a0e0245500627af0752a6954ec348fa92">$this-&gt;listcount</a>;</div>
<div class="line"><a name="l17294"></a><span class="lineno">17294</span>&#160;        $prev_lispacer = <a class="code" href="../../d4/d40/classTCPDF.html#a91c1d0b385b593f4834a1fd3f9c4ab65">$this-&gt;lispacer</a>;</div>
<div class="line"><a name="l17295"></a><span class="lineno">17295</span>&#160;        $this-&gt;listnum = 0;</div>
<div class="line"><a name="l17296"></a><span class="lineno">17296</span>&#160;        $this-&gt;listordered = array();</div>
<div class="line"><a name="l17297"></a><span class="lineno">17297</span>&#160;        $this-&gt;listcount = array();</div>
<div class="line"><a name="l17298"></a><span class="lineno">17298</span>&#160;        $this-&gt;lispacer = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l17299"></a><span class="lineno">17299</span>&#160;        <span class="keywordflow">if</span> ((TCPDF_STATIC::empty_string($this-&gt;lasth)) OR ($reseth)) {</div>
<div class="line"><a name="l17300"></a><span class="lineno">17300</span>&#160;            <span class="comment">// reset row height</span></div>
<div class="line"><a name="l17301"></a><span class="lineno">17301</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a10215105777b306528a827f3669e936e">resetLastH</a>();</div>
<div class="line"><a name="l17302"></a><span class="lineno">17302</span>&#160;        }</div>
<div class="line"><a name="l17303"></a><span class="lineno">17303</span>&#160;        $dom = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a591ae03ca6c5202c19a36d3dccb1eb0a">getHtmlDomArray</a>($html);</div>
<div class="line"><a name="l17304"></a><span class="lineno">17304</span>&#160;        $maxel = count($dom);</div>
<div class="line"><a name="l17305"></a><span class="lineno">17305</span>&#160;        $key = 0;</div>
<div class="line"><a name="l17306"></a><span class="lineno">17306</span>&#160;        <span class="keywordflow">while</span> ($key &lt; $maxel) {</div>
<div class="line"><a name="l17307"></a><span class="lineno">17307</span>&#160;            <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;tag&#39;</span>] AND $dom[$key][<span class="stringliteral">&#39;opening&#39;</span>] AND $dom[$key][<span class="stringliteral">&#39;hide&#39;</span>]) {</div>
<div class="line"><a name="l17308"></a><span class="lineno">17308</span>&#160;                <span class="comment">// store the node key</span></div>
<div class="line"><a name="l17309"></a><span class="lineno">17309</span>&#160;                $hidden_node_key = $key;</div>
<div class="line"><a name="l17310"></a><span class="lineno">17310</span>&#160;                <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;self&#39;</span>]) {</div>
<div class="line"><a name="l17311"></a><span class="lineno">17311</span>&#160;                    <span class="comment">// skip just this self-closing tag</span></div>
<div class="line"><a name="l17312"></a><span class="lineno">17312</span>&#160;                    ++$key;</div>
<div class="line"><a name="l17313"></a><span class="lineno">17313</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l17314"></a><span class="lineno">17314</span>&#160;                    <span class="comment">// skip this and all children tags</span></div>
<div class="line"><a name="l17315"></a><span class="lineno">17315</span>&#160;                    <span class="keywordflow">while</span> (($key &lt; $maxel) AND (!$dom[$key][<span class="stringliteral">&#39;tag&#39;</span>] OR $dom[$key][<span class="stringliteral">&#39;opening&#39;</span>] OR ($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>] != $hidden_node_key))) {</div>
<div class="line"><a name="l17316"></a><span class="lineno">17316</span>&#160;                        <span class="comment">// skip hidden objects</span></div>
<div class="line"><a name="l17317"></a><span class="lineno">17317</span>&#160;                        ++$key;</div>
<div class="line"><a name="l17318"></a><span class="lineno">17318</span>&#160;                    }</div>
<div class="line"><a name="l17319"></a><span class="lineno">17319</span>&#160;                    ++$key;</div>
<div class="line"><a name="l17320"></a><span class="lineno">17320</span>&#160;                }</div>
<div class="line"><a name="l17321"></a><span class="lineno">17321</span>&#160;            }</div>
<div class="line"><a name="l17322"></a><span class="lineno">17322</span>&#160;            <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;tag&#39;</span>] AND isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;pagebreak&#39;</span>])) {</div>
<div class="line"><a name="l17323"></a><span class="lineno">17323</span>&#160;                <span class="comment">// check for pagebreak</span></div>
<div class="line"><a name="l17324"></a><span class="lineno">17324</span>&#160;                <span class="keywordflow">if</span> (($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;pagebreak&#39;</span>] == <span class="stringliteral">&#39;true&#39;</span>) OR ($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;pagebreak&#39;</span>] == <span class="stringliteral">&#39;left&#39;</span>) OR ($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;pagebreak&#39;</span>] == <span class="stringliteral">&#39;right&#39;</span>)) {</div>
<div class="line"><a name="l17325"></a><span class="lineno">17325</span>&#160;                    <span class="comment">// add a page (or trig AcceptPageBreak() for multicolumn mode)</span></div>
<div class="line"><a name="l17326"></a><span class="lineno">17326</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a9e8e4b4d75485b8f1e3aa2133a811e50">checkPageBreak</a>($this-&gt;PageBreakTrigger + 1);</div>
<div class="line"><a name="l17327"></a><span class="lineno">17327</span>&#160;                    $this-&gt;htmlvspace = ($this-&gt;PageBreakTrigger + 1);</div>
<div class="line"><a name="l17328"></a><span class="lineno">17328</span>&#160;                }</div>
<div class="line"><a name="l17329"></a><span class="lineno">17329</span>&#160;                <span class="keywordflow">if</span> ((($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;pagebreak&#39;</span>] == <span class="stringliteral">&#39;left&#39;</span>) AND (((!$this-&gt;rtl) AND (($this-&gt;page % 2) == 0)) OR (($this-&gt;rtl) AND (($this-&gt;page % 2) != 0))))</div>
<div class="line"><a name="l17330"></a><span class="lineno">17330</span>&#160;                    OR (($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;pagebreak&#39;</span>] == <span class="stringliteral">&#39;right&#39;</span>) AND (((!$this-&gt;rtl) AND (($this-&gt;page % 2) != 0)) OR (($this-&gt;rtl) AND (($this-&gt;page % 2) == 0))))) {</div>
<div class="line"><a name="l17331"></a><span class="lineno">17331</span>&#160;                    <span class="comment">// add a page (or trig AcceptPageBreak() for multicolumn mode)</span></div>
<div class="line"><a name="l17332"></a><span class="lineno">17332</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a9e8e4b4d75485b8f1e3aa2133a811e50">checkPageBreak</a>($this-&gt;PageBreakTrigger + 1);</div>
<div class="line"><a name="l17333"></a><span class="lineno">17333</span>&#160;                    $this-&gt;htmlvspace = ($this-&gt;PageBreakTrigger + 1);</div>
<div class="line"><a name="l17334"></a><span class="lineno">17334</span>&#160;                }</div>
<div class="line"><a name="l17335"></a><span class="lineno">17335</span>&#160;            }</div>
<div class="line"><a name="l17336"></a><span class="lineno">17336</span>&#160;            <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;tag&#39;</span>] AND $dom[$key][<span class="stringliteral">&#39;opening&#39;</span>] AND isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;nobr&#39;</span>]) AND ($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;nobr&#39;</span>] == <span class="stringliteral">&#39;true&#39;</span>)) {</div>
<div class="line"><a name="l17337"></a><span class="lineno">17337</span>&#160;                <span class="keywordflow">if</span> (isset($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;nobr&#39;</span>]) AND ($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;nobr&#39;</span>] == <span class="stringliteral">&#39;true&#39;</span>)) {</div>
<div class="line"><a name="l17338"></a><span class="lineno">17338</span>&#160;                    $dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;nobr&#39;</span>] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l17339"></a><span class="lineno">17339</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l17340"></a><span class="lineno">17340</span>&#160;                    <span class="comment">// store current object</span></div>
<div class="line"><a name="l17341"></a><span class="lineno">17341</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a797b9be1f9c2d031e5dce8c5b3a9e27c">startTransaction</a>();</div>
<div class="line"><a name="l17342"></a><span class="lineno">17342</span>&#160;                    <span class="comment">// save this method vars</span></div>
<div class="line"><a name="l17343"></a><span class="lineno">17343</span>&#160;                    $this_method_vars[<span class="stringliteral">&#39;html&#39;</span>] = $html;</div>
<div class="line"><a name="l17344"></a><span class="lineno">17344</span>&#160;                    $this_method_vars[<span class="stringliteral">&#39;ln&#39;</span>] = $ln;</div>
<div class="line"><a name="l17345"></a><span class="lineno">17345</span>&#160;                    $this_method_vars[<span class="stringliteral">&#39;fill&#39;</span>] = $fill;</div>
<div class="line"><a name="l17346"></a><span class="lineno">17346</span>&#160;                    $this_method_vars[<span class="stringliteral">&#39;reseth&#39;</span>] = $reseth;</div>
<div class="line"><a name="l17347"></a><span class="lineno">17347</span>&#160;                    $this_method_vars[<span class="stringliteral">&#39;cell&#39;</span>] = $cell;</div>
<div class="line"><a name="l17348"></a><span class="lineno">17348</span>&#160;                    $this_method_vars[<span class="stringliteral">&#39;align&#39;</span>] = $align;</div>
<div class="line"><a name="l17349"></a><span class="lineno">17349</span>&#160;                    $this_method_vars[<span class="stringliteral">&#39;gvars&#39;</span>] = $gvars;</div>
<div class="line"><a name="l17350"></a><span class="lineno">17350</span>&#160;                    $this_method_vars[<span class="stringliteral">&#39;prevPage&#39;</span>] = $prevPage;</div>
<div class="line"><a name="l17351"></a><span class="lineno">17351</span>&#160;                    $this_method_vars[<span class="stringliteral">&#39;prev_cell_margin&#39;</span>] = $prev_cell_margin;</div>
<div class="line"><a name="l17352"></a><span class="lineno">17352</span>&#160;                    $this_method_vars[<span class="stringliteral">&#39;prev_cell_padding&#39;</span>] = $prev_cell_padding;</div>
<div class="line"><a name="l17353"></a><span class="lineno">17353</span>&#160;                    $this_method_vars[<span class="stringliteral">&#39;prevlMargin&#39;</span>] = $prevlMargin;</div>
<div class="line"><a name="l17354"></a><span class="lineno">17354</span>&#160;                    $this_method_vars[<span class="stringliteral">&#39;prevrMargin&#39;</span>] = $prevrMargin;</div>
<div class="line"><a name="l17355"></a><span class="lineno">17355</span>&#160;                    $this_method_vars[<span class="stringliteral">&#39;curfontname&#39;</span>] = $curfontname;</div>
<div class="line"><a name="l17356"></a><span class="lineno">17356</span>&#160;                    $this_method_vars[<span class="stringliteral">&#39;curfontstyle&#39;</span>] = $curfontstyle;</div>
<div class="line"><a name="l17357"></a><span class="lineno">17357</span>&#160;                    $this_method_vars[<span class="stringliteral">&#39;curfontsize&#39;</span>] = $curfontsize;</div>
<div class="line"><a name="l17358"></a><span class="lineno">17358</span>&#160;                    $this_method_vars[<span class="stringliteral">&#39;curfontascent&#39;</span>] = $curfontascent;</div>
<div class="line"><a name="l17359"></a><span class="lineno">17359</span>&#160;                    $this_method_vars[<span class="stringliteral">&#39;curfontdescent&#39;</span>] = $curfontdescent;</div>
<div class="line"><a name="l17360"></a><span class="lineno">17360</span>&#160;                    $this_method_vars[<span class="stringliteral">&#39;curfontstretcing&#39;</span>] = $curfontstretcing;</div>
<div class="line"><a name="l17361"></a><span class="lineno">17361</span>&#160;                    $this_method_vars[<span class="stringliteral">&#39;curfonttracking&#39;</span>] = $curfonttracking;</div>
<div class="line"><a name="l17362"></a><span class="lineno">17362</span>&#160;                    $this_method_vars[<span class="stringliteral">&#39;minstartliney&#39;</span>] = $minstartliney;</div>
<div class="line"><a name="l17363"></a><span class="lineno">17363</span>&#160;                    $this_method_vars[<span class="stringliteral">&#39;maxbottomliney&#39;</span>] = $maxbottomliney;</div>
<div class="line"><a name="l17364"></a><span class="lineno">17364</span>&#160;                    $this_method_vars[<span class="stringliteral">&#39;yshift&#39;</span>] = $yshift;</div>
<div class="line"><a name="l17365"></a><span class="lineno">17365</span>&#160;                    $this_method_vars[<span class="stringliteral">&#39;startlinepage&#39;</span>] = $startlinepage;</div>
<div class="line"><a name="l17366"></a><span class="lineno">17366</span>&#160;                    $this_method_vars[<span class="stringliteral">&#39;startlinepos&#39;</span>] = $startlinepos;</div>
<div class="line"><a name="l17367"></a><span class="lineno">17367</span>&#160;                    $this_method_vars[<span class="stringliteral">&#39;startlinex&#39;</span>] = $startlinex;</div>
<div class="line"><a name="l17368"></a><span class="lineno">17368</span>&#160;                    $this_method_vars[<span class="stringliteral">&#39;startliney&#39;</span>] = $startliney;</div>
<div class="line"><a name="l17369"></a><span class="lineno">17369</span>&#160;                    $this_method_vars[<span class="stringliteral">&#39;newline&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a505b4eabece70b8679ebdeb86964b798">$newline</a>;</div>
<div class="line"><a name="l17370"></a><span class="lineno">17370</span>&#160;                    $this_method_vars[<span class="stringliteral">&#39;loop&#39;</span>] = $loop;</div>
<div class="line"><a name="l17371"></a><span class="lineno">17371</span>&#160;                    $this_method_vars[<span class="stringliteral">&#39;curpos&#39;</span>] = $curpos;</div>
<div class="line"><a name="l17372"></a><span class="lineno">17372</span>&#160;                    $this_method_vars[<span class="stringliteral">&#39;pask&#39;</span>] = $pask;</div>
<div class="line"><a name="l17373"></a><span class="lineno">17373</span>&#160;                    $this_method_vars[<span class="stringliteral">&#39;lalign&#39;</span>] = $lalign;</div>
<div class="line"><a name="l17374"></a><span class="lineno">17374</span>&#160;                    $this_method_vars[<span class="stringliteral">&#39;plalign&#39;</span>] = $plalign;</div>
<div class="line"><a name="l17375"></a><span class="lineno">17375</span>&#160;                    $this_method_vars[<span class="charliteral">&#39;w&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>;</div>
<div class="line"><a name="l17376"></a><span class="lineno">17376</span>&#160;                    $this_method_vars[<span class="stringliteral">&#39;prev_cell_height_ratio&#39;</span>] = $prev_cell_height_ratio;</div>
<div class="line"><a name="l17377"></a><span class="lineno">17377</span>&#160;                    $this_method_vars[<span class="stringliteral">&#39;prev_listnum&#39;</span>] = $prev_listnum;</div>
<div class="line"><a name="l17378"></a><span class="lineno">17378</span>&#160;                    $this_method_vars[<span class="stringliteral">&#39;prev_listordered&#39;</span>] = $prev_listordered;</div>
<div class="line"><a name="l17379"></a><span class="lineno">17379</span>&#160;                    $this_method_vars[<span class="stringliteral">&#39;prev_listcount&#39;</span>] = $prev_listcount;</div>
<div class="line"><a name="l17380"></a><span class="lineno">17380</span>&#160;                    $this_method_vars[<span class="stringliteral">&#39;prev_lispacer&#39;</span>] = $prev_lispacer;</div>
<div class="line"><a name="l17381"></a><span class="lineno">17381</span>&#160;                    $this_method_vars[<span class="stringliteral">&#39;fontaligned&#39;</span>] = $fontaligned;</div>
<div class="line"><a name="l17382"></a><span class="lineno">17382</span>&#160;                    $this_method_vars[<span class="stringliteral">&#39;key&#39;</span>] = $key;</div>
<div class="line"><a name="l17383"></a><span class="lineno">17383</span>&#160;                    $this_method_vars[<span class="stringliteral">&#39;dom&#39;</span>] = $dom;</div>
<div class="line"><a name="l17384"></a><span class="lineno">17384</span>&#160;                }</div>
<div class="line"><a name="l17385"></a><span class="lineno">17385</span>&#160;            }</div>
<div class="line"><a name="l17386"></a><span class="lineno">17386</span>&#160;            <span class="comment">// print THEAD block</span></div>
<div class="line"><a name="l17387"></a><span class="lineno">17387</span>&#160;            <span class="keywordflow">if</span> (($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;tr&#39;</span>) AND isset($dom[$key][<span class="stringliteral">&#39;thead&#39;</span>]) AND $dom[$key][<span class="stringliteral">&#39;thead&#39;</span>]) {</div>
<div class="line"><a name="l17388"></a><span class="lineno">17388</span>&#160;                <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>]) AND isset($dom[$dom[$key][<span class="stringliteral">&#39;parent&#39;</span>]][<span class="stringliteral">&#39;thead&#39;</span>]) AND !TCPDF_STATIC::empty_string($dom[$dom[$key][<span class="stringliteral">&#39;parent&#39;</span>]][<span class="stringliteral">&#39;thead&#39;</span>])) {</div>
<div class="line"><a name="l17389"></a><span class="lineno">17389</span>&#160;                    $this-&gt;inthead = <span class="keyword">true</span>;</div>
<div class="line"><a name="l17390"></a><span class="lineno">17390</span>&#160;                    <span class="comment">// print table header (thead)</span></div>
<div class="line"><a name="l17391"></a><span class="lineno">17391</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac3fdf25fcd36f1dce04f92187c621407">writeHTML</a>($this-&gt;thead, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="stringliteral">&#39;&#39;</span>);</div>
<div class="line"><a name="l17392"></a><span class="lineno">17392</span>&#160;                    <span class="comment">// check if we are on a new page or on a new column</span></div>
<div class="line"><a name="l17393"></a><span class="lineno">17393</span>&#160;                    <span class="keywordflow">if</span> (($this-&gt;y &lt; $this-&gt;start_transaction_y) OR ($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a9e8e4b4d75485b8f1e3aa2133a811e50">checkPageBreak</a>($this-&gt;lasth, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>))) {</div>
<div class="line"><a name="l17394"></a><span class="lineno">17394</span>&#160;                        <span class="comment">// we are on a new page or on a new column and the total object height is less than the available vertical space.</span></div>
<div class="line"><a name="l17395"></a><span class="lineno">17395</span>&#160;                        <span class="comment">// restore previous object</span></div>
<div class="line"><a name="l17396"></a><span class="lineno">17396</span>&#160;                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a338034ba746f7c607473207b9caa4e1f">rollbackTransaction</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l17397"></a><span class="lineno">17397</span>&#160;                        <span class="comment">// restore previous values</span></div>
<div class="line"><a name="l17398"></a><span class="lineno">17398</span>&#160;                        <span class="keywordflow">foreach</span> ($this_method_vars as $vkey =&gt; $vval) {</div>
<div class="line"><a name="l17399"></a><span class="lineno">17399</span>&#160;                            $$vkey = $vval;</div>
<div class="line"><a name="l17400"></a><span class="lineno">17400</span>&#160;                        }</div>
<div class="line"><a name="l17401"></a><span class="lineno">17401</span>&#160;                        <span class="comment">// disable table header</span></div>
<div class="line"><a name="l17402"></a><span class="lineno">17402</span>&#160;                        $tmp_thead = <a class="code" href="../../d4/d40/classTCPDF.html#ae7cd5ea4b0ef3a0910ed0044bea97f1d">$this-&gt;thead</a>;</div>
<div class="line"><a name="l17403"></a><span class="lineno">17403</span>&#160;                        $this-&gt;thead = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l17404"></a><span class="lineno">17404</span>&#160;                        <span class="comment">// add a page (or trig AcceptPageBreak() for multicolumn mode)</span></div>
<div class="line"><a name="l17405"></a><span class="lineno">17405</span>&#160;                        $pre_y = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l17406"></a><span class="lineno">17406</span>&#160;                        <span class="keywordflow">if</span> ((!$this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a9e8e4b4d75485b8f1e3aa2133a811e50">checkPageBreak</a>($this-&gt;PageBreakTrigger + 1)) AND ($this-&gt;y &lt; $pre_y)) {</div>
<div class="line"><a name="l17407"></a><span class="lineno">17407</span>&#160;                            <span class="comment">// fix for multicolumn mode</span></div>
<div class="line"><a name="l17408"></a><span class="lineno">17408</span>&#160;                            $startliney = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l17409"></a><span class="lineno">17409</span>&#160;                        }</div>
<div class="line"><a name="l17410"></a><span class="lineno">17410</span>&#160;                        $this-&gt;start_transaction_page = <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>;</div>
<div class="line"><a name="l17411"></a><span class="lineno">17411</span>&#160;                        $this-&gt;start_transaction_y = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l17412"></a><span class="lineno">17412</span>&#160;                        <span class="comment">// restore table header</span></div>
<div class="line"><a name="l17413"></a><span class="lineno">17413</span>&#160;                        $this-&gt;thead = $tmp_thead;</div>
<div class="line"><a name="l17414"></a><span class="lineno">17414</span>&#160;                        <span class="comment">// fix table border properties</span></div>
<div class="line"><a name="l17415"></a><span class="lineno">17415</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[$dom[$key][<span class="stringliteral">&#39;parent&#39;</span>]][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;cellspacing&#39;</span>])) {</div>
<div class="line"><a name="l17416"></a><span class="lineno">17416</span>&#160;                            $tmp_cellspacing = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9">getHTMLUnitToUnits</a>($dom[$dom[$key][<span class="stringliteral">&#39;parent&#39;</span>]][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;cellspacing&#39;</span>], 1, <span class="stringliteral">&#39;px&#39;</span>);</div>
<div class="line"><a name="l17417"></a><span class="lineno">17417</span>&#160;                        } elseif (isset($dom[$dom[$key][<span class="stringliteral">&#39;parent&#39;</span>]][<span class="stringliteral">&#39;border-spacing&#39;</span>])) {</div>
<div class="line"><a name="l17418"></a><span class="lineno">17418</span>&#160;                            $tmp_cellspacing = $dom[$dom[$key][<span class="stringliteral">&#39;parent&#39;</span>]][<span class="stringliteral">&#39;border-spacing&#39;</span>][<span class="charliteral">&#39;V&#39;</span>];</div>
<div class="line"><a name="l17419"></a><span class="lineno">17419</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l17420"></a><span class="lineno">17420</span>&#160;                            $tmp_cellspacing = 0;</div>
<div class="line"><a name="l17421"></a><span class="lineno">17421</span>&#160;                        }</div>
<div class="line"><a name="l17422"></a><span class="lineno">17422</span>&#160;                        $dom[$dom[$key][<span class="stringliteral">&#39;parent&#39;</span>]][<span class="stringliteral">&#39;borderposition&#39;</span>][<span class="stringliteral">&#39;page&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>;</div>
<div class="line"><a name="l17423"></a><span class="lineno">17423</span>&#160;                        $dom[$dom[$key][<span class="stringliteral">&#39;parent&#39;</span>]][<span class="stringliteral">&#39;borderposition&#39;</span>][<span class="stringliteral">&#39;column&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#aab81c25eefaf486adf004eb20bc22881">$this-&gt;current_column</a>;</div>
<div class="line"><a name="l17424"></a><span class="lineno">17424</span>&#160;                        $dom[$dom[$key][<span class="stringliteral">&#39;parent&#39;</span>]][<span class="stringliteral">&#39;borderposition&#39;</span>][<span class="charliteral">&#39;y&#39;</span>] = $this-&gt;y + $tmp_cellspacing;</div>
<div class="line"><a name="l17425"></a><span class="lineno">17425</span>&#160;                        $xoffset = ($this-&gt;x - $dom[$dom[$key][<span class="stringliteral">&#39;parent&#39;</span>]][<span class="stringliteral">&#39;borderposition&#39;</span>][<span class="charliteral">&#39;x&#39;</span>]);</div>
<div class="line"><a name="l17426"></a><span class="lineno">17426</span>&#160;                        $dom[$dom[$key][<span class="stringliteral">&#39;parent&#39;</span>]][<span class="stringliteral">&#39;borderposition&#39;</span>][<span class="charliteral">&#39;x&#39;</span>] += $xoffset;</div>
<div class="line"><a name="l17427"></a><span class="lineno">17427</span>&#160;                        $dom[$dom[$key][<span class="stringliteral">&#39;parent&#39;</span>]][<span class="stringliteral">&#39;borderposition&#39;</span>][<span class="stringliteral">&#39;xmax&#39;</span>] += $xoffset;</div>
<div class="line"><a name="l17428"></a><span class="lineno">17428</span>&#160;                        <span class="comment">// print table header (thead)</span></div>
<div class="line"><a name="l17429"></a><span class="lineno">17429</span>&#160;                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ac3fdf25fcd36f1dce04f92187c621407">writeHTML</a>($this-&gt;thead, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="stringliteral">&#39;&#39;</span>);</div>
<div class="line"><a name="l17430"></a><span class="lineno">17430</span>&#160;                    }</div>
<div class="line"><a name="l17431"></a><span class="lineno">17431</span>&#160;                }</div>
<div class="line"><a name="l17432"></a><span class="lineno">17432</span>&#160;                <span class="comment">// move $key index forward to skip THEAD block</span></div>
<div class="line"><a name="l17433"></a><span class="lineno">17433</span>&#160;                <span class="keywordflow">while</span> ( ($key &lt; $maxel) AND (!(</div>
<div class="line"><a name="l17434"></a><span class="lineno">17434</span>&#160;                    ($dom[$key][<span class="stringliteral">&#39;tag&#39;</span>] AND $dom[$key][<span class="stringliteral">&#39;opening&#39;</span>] AND ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;tr&#39;</span>) AND (!isset($dom[$key][<span class="stringliteral">&#39;thead&#39;</span>]) OR !$dom[$key][<span class="stringliteral">&#39;thead&#39;</span>]))</div>
<div class="line"><a name="l17435"></a><span class="lineno">17435</span>&#160;                    OR ($dom[$key][<span class="stringliteral">&#39;tag&#39;</span>] AND (!$dom[$key][<span class="stringliteral">&#39;opening&#39;</span>]) AND ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;table&#39;</span>))) )) {</div>
<div class="line"><a name="l17436"></a><span class="lineno">17436</span>&#160;                    ++$key;</div>
<div class="line"><a name="l17437"></a><span class="lineno">17437</span>&#160;                }</div>
<div class="line"><a name="l17438"></a><span class="lineno">17438</span>&#160;            }</div>
<div class="line"><a name="l17439"></a><span class="lineno">17439</span>&#160;            <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;tag&#39;</span>] OR ($key == 0)) {</div>
<div class="line"><a name="l17440"></a><span class="lineno">17440</span>&#160;                <span class="keywordflow">if</span> ((($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;table&#39;</span>) OR ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;tr&#39;</span>)) AND (isset($dom[$key][<span class="stringliteral">&#39;align&#39;</span>]))) {</div>
<div class="line"><a name="l17441"></a><span class="lineno">17441</span>&#160;                    $dom[$key][<span class="stringliteral">&#39;align&#39;</span>] = (<a class="code" href="../../d4/d40/classTCPDF.html#a4ccd9d69e0839838b105328953794a40">$this-&gt;rtl</a>) ? <span class="charliteral">&#39;R&#39;</span> : <span class="charliteral">&#39;L&#39;</span>;</div>
<div class="line"><a name="l17442"></a><span class="lineno">17442</span>&#160;                }</div>
<div class="line"><a name="l17443"></a><span class="lineno">17443</span>&#160;                <span class="comment">// vertically align image in line</span></div>
<div class="line"><a name="l17444"></a><span class="lineno">17444</span>&#160;                <span class="keywordflow">if</span> ((!$this-&gt;newline) AND ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;img&#39;</span>) AND (isset($dom[$key][<span class="stringliteral">&#39;height&#39;</span>])) AND ($dom[$key][<span class="stringliteral">&#39;height&#39;</span>] &gt; 0)) {</div>
<div class="line"><a name="l17445"></a><span class="lineno">17445</span>&#160;                    <span class="comment">// get image height</span></div>
<div class="line"><a name="l17446"></a><span class="lineno">17446</span>&#160;                    $imgh = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9">getHTMLUnitToUnits</a>($dom[$key][<span class="stringliteral">&#39;height&#39;</span>], ($dom[$key][<span class="stringliteral">&#39;fontsize&#39;</span>] / $this-&gt;k), <span class="stringliteral">&#39;px&#39;</span>);</div>
<div class="line"><a name="l17447"></a><span class="lineno">17447</span>&#160;                    $autolinebreak = <span class="keyword">false</span>;</div>
<div class="line"><a name="l17448"></a><span class="lineno">17448</span>&#160;                    <span class="keywordflow">if</span> (!empty($dom[$key][<span class="stringliteral">&#39;width&#39;</span>])) {</div>
<div class="line"><a name="l17449"></a><span class="lineno">17449</span>&#160;                        $imgw = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9">getHTMLUnitToUnits</a>($dom[$key][<span class="stringliteral">&#39;width&#39;</span>], ($dom[$key][<span class="stringliteral">&#39;fontsize&#39;</span>] / $this-&gt;k), <span class="stringliteral">&#39;px&#39;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l17450"></a><span class="lineno">17450</span>&#160;                        <span class="keywordflow">if</span> (($imgw &lt;= ($this-&gt;w - $this-&gt;lMargin - $this-&gt;rMargin - $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>] - $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>]))</div>
<div class="line"><a name="l17451"></a><span class="lineno">17451</span>&#160;                            AND ((($this-&gt;rtl) AND (($this-&gt;x - $imgw) &lt; ($this-&gt;lMargin + $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>])))</div>
<div class="line"><a name="l17452"></a><span class="lineno">17452</span>&#160;                            OR ((!$this-&gt;rtl) AND (($this-&gt;x + $imgw) &gt; ($this-&gt;w - $this-&gt;rMargin - $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>]))))) {</div>
<div class="line"><a name="l17453"></a><span class="lineno">17453</span>&#160;                            <span class="comment">// add automatic line break</span></div>
<div class="line"><a name="l17454"></a><span class="lineno">17454</span>&#160;                            $autolinebreak = <span class="keyword">true</span>;</div>
<div class="line"><a name="l17455"></a><span class="lineno">17455</span>&#160;                            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a00969cf629d72b3d29ee435f15906820">Ln</a>(<span class="stringliteral">&#39;&#39;</span>, $cell);</div>
<div class="line"><a name="l17456"></a><span class="lineno">17456</span>&#160;                            <span class="keywordflow">if</span> ((!$dom[($key-1)][<span class="stringliteral">&#39;tag&#39;</span>]) AND ($dom[($key-1)][<span class="stringliteral">&#39;value&#39;</span>] == <span class="charliteral">&#39; &#39;</span>)) {</div>
<div class="line"><a name="l17457"></a><span class="lineno">17457</span>&#160;                                <span class="comment">// go back to evaluate this line break</span></div>
<div class="line"><a name="l17458"></a><span class="lineno">17458</span>&#160;                                --$key;</div>
<div class="line"><a name="l17459"></a><span class="lineno">17459</span>&#160;                            }</div>
<div class="line"><a name="l17460"></a><span class="lineno">17460</span>&#160;                        }</div>
<div class="line"><a name="l17461"></a><span class="lineno">17461</span>&#160;                    }</div>
<div class="line"><a name="l17462"></a><span class="lineno">17462</span>&#160;                    <span class="keywordflow">if</span> (!$autolinebreak) {</div>
<div class="line"><a name="l17463"></a><span class="lineno">17463</span>&#160;                        <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a13f370f8e1553105eaa3553f52c3fc6c">inPageBody</a>()) {</div>
<div class="line"><a name="l17464"></a><span class="lineno">17464</span>&#160;                            $pre_y = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l17465"></a><span class="lineno">17465</span>&#160;                            <span class="comment">// check for page break</span></div>
<div class="line"><a name="l17466"></a><span class="lineno">17466</span>&#160;                            <span class="keywordflow">if</span> ((!$this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a9e8e4b4d75485b8f1e3aa2133a811e50">checkPageBreak</a>($imgh)) AND ($this-&gt;y &lt; $pre_y)) {</div>
<div class="line"><a name="l17467"></a><span class="lineno">17467</span>&#160;                                <span class="comment">// fix for multicolumn mode</span></div>
<div class="line"><a name="l17468"></a><span class="lineno">17468</span>&#160;                                $startliney = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l17469"></a><span class="lineno">17469</span>&#160;                            }</div>
<div class="line"><a name="l17470"></a><span class="lineno">17470</span>&#160;                        }</div>
<div class="line"><a name="l17471"></a><span class="lineno">17471</span>&#160;                        <span class="keywordflow">if</span> ($this-&gt;page &gt; $startlinepage) {</div>
<div class="line"><a name="l17472"></a><span class="lineno">17472</span>&#160;                            <span class="comment">// fix line splitted over two pages</span></div>
<div class="line"><a name="l17473"></a><span class="lineno">17473</span>&#160;                            <span class="keywordflow">if</span> (isset($this-&gt;footerlen[$startlinepage])) {</div>
<div class="line"><a name="l17474"></a><span class="lineno">17474</span>&#160;                                $curpos = $this-&gt;pagelen[$startlinepage] - $this-&gt;footerlen[$startlinepage];</div>
<div class="line"><a name="l17475"></a><span class="lineno">17475</span>&#160;                            }</div>
<div class="line"><a name="l17476"></a><span class="lineno">17476</span>&#160;                            <span class="comment">// line to be moved one page forward</span></div>
<div class="line"><a name="l17477"></a><span class="lineno">17477</span>&#160;                            $pagebuff = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d67b0a8681222f71fa9f9f6e65e0c56">getPageBuffer</a>($startlinepage);</div>
<div class="line"><a name="l17478"></a><span class="lineno">17478</span>&#160;                            $linebeg = substr($pagebuff, $startlinepos, ($curpos - $startlinepos));</div>
<div class="line"><a name="l17479"></a><span class="lineno">17479</span>&#160;                            $tstart = substr($pagebuff, 0, $startlinepos);</div>
<div class="line"><a name="l17480"></a><span class="lineno">17480</span>&#160;                            $tend = substr($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d67b0a8681222f71fa9f9f6e65e0c56">getPageBuffer</a>($startlinepage), $curpos);</div>
<div class="line"><a name="l17481"></a><span class="lineno">17481</span>&#160;                            <span class="comment">// remove line from previous page</span></div>
<div class="line"><a name="l17482"></a><span class="lineno">17482</span>&#160;                            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a2b85f6395de14dd40cab8839b3ce25a8">setPageBuffer</a>($startlinepage, $tstart.<span class="stringliteral">&#39;&#39;</span>.$tend);</div>
<div class="line"><a name="l17483"></a><span class="lineno">17483</span>&#160;                            $pagebuff = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d67b0a8681222f71fa9f9f6e65e0c56">getPageBuffer</a>($this-&gt;page);</div>
<div class="line"><a name="l17484"></a><span class="lineno">17484</span>&#160;                            $tstart = substr($pagebuff, 0, $this-&gt;cntmrk[$this-&gt;page]);</div>
<div class="line"><a name="l17485"></a><span class="lineno">17485</span>&#160;                            $tend = substr($pagebuff, $this-&gt;cntmrk[$this-&gt;page]);</div>
<div class="line"><a name="l17486"></a><span class="lineno">17486</span>&#160;                            <span class="comment">// add line start to current page</span></div>
<div class="line"><a name="l17487"></a><span class="lineno">17487</span>&#160;                            $yshift = ($minstartliney - <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>);</div>
<div class="line"><a name="l17488"></a><span class="lineno">17488</span>&#160;                            <span class="keywordflow">if</span> ($fontaligned) {</div>
<div class="line"><a name="l17489"></a><span class="lineno">17489</span>&#160;                                $yshift += ($curfontsize / <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>);</div>
<div class="line"><a name="l17490"></a><span class="lineno">17490</span>&#160;                            }</div>
<div class="line"><a name="l17491"></a><span class="lineno">17491</span>&#160;                            $try = sprintf(<span class="stringliteral">&#39;1 0 0 1 0 %F cm&#39;</span>, ($yshift * $this-&gt;k));</div>
<div class="line"><a name="l17492"></a><span class="lineno">17492</span>&#160;                            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a2b85f6395de14dd40cab8839b3ce25a8">setPageBuffer</a>($this-&gt;page, $tstart.<span class="stringliteral">&quot;\nq\n&quot;</span>.$try.<span class="stringliteral">&quot;\n&quot;</span>.$linebeg.<span class="stringliteral">&quot;\nQ\n&quot;</span>.$tend);</div>
<div class="line"><a name="l17493"></a><span class="lineno">17493</span>&#160;                            <span class="comment">// shift the annotations and links</span></div>
<div class="line"><a name="l17494"></a><span class="lineno">17494</span>&#160;                            <span class="keywordflow">if</span> (isset($this-&gt;PageAnnots[$this-&gt;page])) {</div>
<div class="line"><a name="l17495"></a><span class="lineno">17495</span>&#160;                                $next_pask = count($this-&gt;PageAnnots[$this-&gt;page]);</div>
<div class="line"><a name="l17496"></a><span class="lineno">17496</span>&#160;                            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l17497"></a><span class="lineno">17497</span>&#160;                                $next_pask = 0;</div>
<div class="line"><a name="l17498"></a><span class="lineno">17498</span>&#160;                            }</div>
<div class="line"><a name="l17499"></a><span class="lineno">17499</span>&#160;                            <span class="keywordflow">if</span> (isset($this-&gt;PageAnnots[$startlinepage])) {</div>
<div class="line"><a name="l17500"></a><span class="lineno">17500</span>&#160;                                <span class="keywordflow">foreach</span> ($this-&gt;PageAnnots[$startlinepage] as $pak =&gt; $pac) {</div>
<div class="line"><a name="l17501"></a><span class="lineno">17501</span>&#160;                                    <span class="keywordflow">if</span> ($pak &gt;= $pask) {</div>
<div class="line"><a name="l17502"></a><span class="lineno">17502</span>&#160;                                        $this-&gt;PageAnnots[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][] = $pac;</div>
<div class="line"><a name="l17503"></a><span class="lineno">17503</span>&#160;                                        unset($this-&gt;PageAnnots[$startlinepage][$pak]);</div>
<div class="line"><a name="l17504"></a><span class="lineno">17504</span>&#160;                                        $npak = count($this-&gt;PageAnnots[$this-&gt;page]) - 1;</div>
<div class="line"><a name="l17505"></a><span class="lineno">17505</span>&#160;                                        $this-&gt;PageAnnots[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][$npak][<span class="charliteral">&#39;y&#39;</span>] -= $yshift;</div>
<div class="line"><a name="l17506"></a><span class="lineno">17506</span>&#160;                                    }</div>
<div class="line"><a name="l17507"></a><span class="lineno">17507</span>&#160;                                }</div>
<div class="line"><a name="l17508"></a><span class="lineno">17508</span>&#160;                            }</div>
<div class="line"><a name="l17509"></a><span class="lineno">17509</span>&#160;                            $pask = $next_pask;</div>
<div class="line"><a name="l17510"></a><span class="lineno">17510</span>&#160;                            $startlinepos = $this-&gt;cntmrk[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>];</div>
<div class="line"><a name="l17511"></a><span class="lineno">17511</span>&#160;                            $startlinepage = <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>;</div>
<div class="line"><a name="l17512"></a><span class="lineno">17512</span>&#160;                            $startliney = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l17513"></a><span class="lineno">17513</span>&#160;                            $this-&gt;newline = <span class="keyword">false</span>;</div>
<div class="line"><a name="l17514"></a><span class="lineno">17514</span>&#160;                        }</div>
<div class="line"><a name="l17515"></a><span class="lineno">17515</span>&#160;                        $this-&gt;y += ($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a25c7f71b3fcb19024497ea620f885346">getCellHeight</a>($curfontsize / $this-&gt;k) - ($curfontdescent * <a class="code" href="../../d4/d40/classTCPDF.html#af8cc74fe5806eb009a22791c3a4c7cce">$this-&gt;cell_height_ratio</a>) - $imgh);</div>
<div class="line"><a name="l17516"></a><span class="lineno">17516</span>&#160;                        $minstartliney = min($this-&gt;y, $minstartliney);</div>
<div class="line"><a name="l17517"></a><span class="lineno">17517</span>&#160;                        $maxbottomliney = ($startliney + $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a25c7f71b3fcb19024497ea620f885346">getCellHeight</a>($curfontsize / $this-&gt;k));</div>
<div class="line"><a name="l17518"></a><span class="lineno">17518</span>&#160;                    }</div>
<div class="line"><a name="l17519"></a><span class="lineno">17519</span>&#160;                } elseif (isset($dom[$key][<span class="stringliteral">&#39;fontname&#39;</span>]) OR isset($dom[$key][<span class="stringliteral">&#39;fontstyle&#39;</span>]) OR isset($dom[$key][<span class="stringliteral">&#39;fontsize&#39;</span>]) OR isset($dom[$key][<span class="stringliteral">&#39;line-height&#39;</span>])) {</div>
<div class="line"><a name="l17520"></a><span class="lineno">17520</span>&#160;                    <span class="comment">// account for different font size</span></div>
<div class="line"><a name="l17521"></a><span class="lineno">17521</span>&#160;                    $pfontname = $curfontname;</div>
<div class="line"><a name="l17522"></a><span class="lineno">17522</span>&#160;                    $pfontstyle = $curfontstyle;</div>
<div class="line"><a name="l17523"></a><span class="lineno">17523</span>&#160;                    $pfontsize = $curfontsize;</div>
<div class="line"><a name="l17524"></a><span class="lineno">17524</span>&#160;                    $fontname = (isset($dom[$key][<span class="stringliteral">&#39;fontname&#39;</span>]) ? $dom[$key][<span class="stringliteral">&#39;fontname&#39;</span>] : $curfontname);</div>
<div class="line"><a name="l17525"></a><span class="lineno">17525</span>&#160;                    $fontstyle = (isset($dom[$key][<span class="stringliteral">&#39;fontstyle&#39;</span>]) ? $dom[$key][<span class="stringliteral">&#39;fontstyle&#39;</span>] : $curfontstyle);</div>
<div class="line"><a name="l17526"></a><span class="lineno">17526</span>&#160;                    $fontsize = (isset($dom[$key][<span class="stringliteral">&#39;fontsize&#39;</span>]) ? $dom[$key][<span class="stringliteral">&#39;fontsize&#39;</span>] : $curfontsize);</div>
<div class="line"><a name="l17527"></a><span class="lineno">17527</span>&#160;                    $fontascent = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#acf41c6c04c29e1323bb270fdea6b5a9f">getFontAscent</a>($fontname, $fontstyle, $fontsize);</div>
<div class="line"><a name="l17528"></a><span class="lineno">17528</span>&#160;                    $fontdescent = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a0c8374150dbc8ca092618ca430713f70">getFontDescent</a>($fontname, $fontstyle, $fontsize);</div>
<div class="line"><a name="l17529"></a><span class="lineno">17529</span>&#160;                    <span class="keywordflow">if</span> (($fontname != $curfontname) OR ($fontstyle != $curfontstyle) OR ($fontsize != $curfontsize)</div>
<div class="line"><a name="l17530"></a><span class="lineno">17530</span>&#160;                        OR ($this-&gt;cell_height_ratio != $dom[$key][<span class="stringliteral">&#39;line-height&#39;</span>])</div>
<div class="line"><a name="l17531"></a><span class="lineno">17531</span>&#160;                        OR ($dom[$key][<span class="stringliteral">&#39;tag&#39;</span>] AND $dom[$key][<span class="stringliteral">&#39;opening&#39;</span>] AND ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;li&#39;</span>)) ) {</div>
<div class="line"><a name="l17532"></a><span class="lineno">17532</span>&#160;                        <span class="keywordflow">if</span> (($key &lt; ($maxel - 1)) AND (</div>
<div class="line"><a name="l17533"></a><span class="lineno">17533</span>&#160;                                ($dom[$key][<span class="stringliteral">&#39;tag&#39;</span>] AND $dom[$key][<span class="stringliteral">&#39;opening&#39;</span>] AND ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;li&#39;</span>))</div>
<div class="line"><a name="l17534"></a><span class="lineno">17534</span>&#160;                                OR ($this-&gt;cell_height_ratio != $dom[$key][<span class="stringliteral">&#39;line-height&#39;</span>])</div>
<div class="line"><a name="l17535"></a><span class="lineno">17535</span>&#160;                                OR (!$this-&gt;newline AND is_numeric($fontsize) AND is_numeric($curfontsize)</div>
<div class="line"><a name="l17536"></a><span class="lineno">17536</span>&#160;                                AND ($fontsize &gt;= 0) AND ($curfontsize &gt;= 0)</div>
<div class="line"><a name="l17537"></a><span class="lineno">17537</span>&#160;                                AND (($fontsize != $curfontsize) OR ($fontstyle != $curfontstyle) OR ($fontname != $curfontname)))</div>
<div class="line"><a name="l17538"></a><span class="lineno">17538</span>&#160;                            )) {</div>
<div class="line"><a name="l17539"></a><span class="lineno">17539</span>&#160;                            <span class="keywordflow">if</span> ($this-&gt;page &gt; $startlinepage) {</div>
<div class="line"><a name="l17540"></a><span class="lineno">17540</span>&#160;                                <span class="comment">// fix lines splitted over two pages</span></div>
<div class="line"><a name="l17541"></a><span class="lineno">17541</span>&#160;                                <span class="keywordflow">if</span> (isset($this-&gt;footerlen[$startlinepage])) {</div>
<div class="line"><a name="l17542"></a><span class="lineno">17542</span>&#160;                                    $curpos = $this-&gt;pagelen[$startlinepage] - $this-&gt;footerlen[$startlinepage];</div>
<div class="line"><a name="l17543"></a><span class="lineno">17543</span>&#160;                                }</div>
<div class="line"><a name="l17544"></a><span class="lineno">17544</span>&#160;                                <span class="comment">// line to be moved one page forward</span></div>
<div class="line"><a name="l17545"></a><span class="lineno">17545</span>&#160;                                $pagebuff = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d67b0a8681222f71fa9f9f6e65e0c56">getPageBuffer</a>($startlinepage);</div>
<div class="line"><a name="l17546"></a><span class="lineno">17546</span>&#160;                                $linebeg = substr($pagebuff, $startlinepos, ($curpos - $startlinepos));</div>
<div class="line"><a name="l17547"></a><span class="lineno">17547</span>&#160;                                $tstart = substr($pagebuff, 0, $startlinepos);</div>
<div class="line"><a name="l17548"></a><span class="lineno">17548</span>&#160;                                $tend = substr($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d67b0a8681222f71fa9f9f6e65e0c56">getPageBuffer</a>($startlinepage), $curpos);</div>
<div class="line"><a name="l17549"></a><span class="lineno">17549</span>&#160;                                <span class="comment">// remove line start from previous page</span></div>
<div class="line"><a name="l17550"></a><span class="lineno">17550</span>&#160;                                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a2b85f6395de14dd40cab8839b3ce25a8">setPageBuffer</a>($startlinepage, $tstart.<span class="stringliteral">&#39;&#39;</span>.$tend);</div>
<div class="line"><a name="l17551"></a><span class="lineno">17551</span>&#160;                                $pagebuff = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d67b0a8681222f71fa9f9f6e65e0c56">getPageBuffer</a>($this-&gt;page);</div>
<div class="line"><a name="l17552"></a><span class="lineno">17552</span>&#160;                                $tstart = substr($pagebuff, 0, $this-&gt;cntmrk[$this-&gt;page]);</div>
<div class="line"><a name="l17553"></a><span class="lineno">17553</span>&#160;                                $tend = substr($pagebuff, $this-&gt;cntmrk[$this-&gt;page]);</div>
<div class="line"><a name="l17554"></a><span class="lineno">17554</span>&#160;                                <span class="comment">// add line start to current page</span></div>
<div class="line"><a name="l17555"></a><span class="lineno">17555</span>&#160;                                $yshift = ($minstartliney - <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>);</div>
<div class="line"><a name="l17556"></a><span class="lineno">17556</span>&#160;                                $try = sprintf(<span class="stringliteral">&#39;1 0 0 1 0 %F cm&#39;</span>, ($yshift * $this-&gt;k));</div>
<div class="line"><a name="l17557"></a><span class="lineno">17557</span>&#160;                                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a2b85f6395de14dd40cab8839b3ce25a8">setPageBuffer</a>($this-&gt;page, $tstart.<span class="stringliteral">&quot;\nq\n&quot;</span>.$try.<span class="stringliteral">&quot;\n&quot;</span>.$linebeg.<span class="stringliteral">&quot;\nQ\n&quot;</span>.$tend);</div>
<div class="line"><a name="l17558"></a><span class="lineno">17558</span>&#160;                                <span class="comment">// shift the annotations and links</span></div>
<div class="line"><a name="l17559"></a><span class="lineno">17559</span>&#160;                                <span class="keywordflow">if</span> (isset($this-&gt;PageAnnots[$this-&gt;page])) {</div>
<div class="line"><a name="l17560"></a><span class="lineno">17560</span>&#160;                                    $next_pask = count($this-&gt;PageAnnots[$this-&gt;page]);</div>
<div class="line"><a name="l17561"></a><span class="lineno">17561</span>&#160;                                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l17562"></a><span class="lineno">17562</span>&#160;                                    $next_pask = 0;</div>
<div class="line"><a name="l17563"></a><span class="lineno">17563</span>&#160;                                }</div>
<div class="line"><a name="l17564"></a><span class="lineno">17564</span>&#160;                                <span class="keywordflow">if</span> (isset($this-&gt;PageAnnots[$startlinepage])) {</div>
<div class="line"><a name="l17565"></a><span class="lineno">17565</span>&#160;                                    <span class="keywordflow">foreach</span> ($this-&gt;PageAnnots[$startlinepage] as $pak =&gt; $pac) {</div>
<div class="line"><a name="l17566"></a><span class="lineno">17566</span>&#160;                                        <span class="keywordflow">if</span> ($pak &gt;= $pask) {</div>
<div class="line"><a name="l17567"></a><span class="lineno">17567</span>&#160;                                            $this-&gt;PageAnnots[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][] = $pac;</div>
<div class="line"><a name="l17568"></a><span class="lineno">17568</span>&#160;                                            unset($this-&gt;PageAnnots[$startlinepage][$pak]);</div>
<div class="line"><a name="l17569"></a><span class="lineno">17569</span>&#160;                                            $npak = count($this-&gt;PageAnnots[$this-&gt;page]) - 1;</div>
<div class="line"><a name="l17570"></a><span class="lineno">17570</span>&#160;                                            $this-&gt;PageAnnots[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][$npak][<span class="charliteral">&#39;y&#39;</span>] -= $yshift;</div>
<div class="line"><a name="l17571"></a><span class="lineno">17571</span>&#160;                                        }</div>
<div class="line"><a name="l17572"></a><span class="lineno">17572</span>&#160;                                    }</div>
<div class="line"><a name="l17573"></a><span class="lineno">17573</span>&#160;                                }</div>
<div class="line"><a name="l17574"></a><span class="lineno">17574</span>&#160;                                $pask = $next_pask;</div>
<div class="line"><a name="l17575"></a><span class="lineno">17575</span>&#160;                                $startlinepos = $this-&gt;cntmrk[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>];</div>
<div class="line"><a name="l17576"></a><span class="lineno">17576</span>&#160;                                $startlinepage = <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>;</div>
<div class="line"><a name="l17577"></a><span class="lineno">17577</span>&#160;                                $startliney = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l17578"></a><span class="lineno">17578</span>&#160;                            }</div>
<div class="line"><a name="l17579"></a><span class="lineno">17579</span>&#160;                            <span class="keywordflow">if</span> (!isset($dom[$key][<span class="stringliteral">&#39;line-height&#39;</span>])) {</div>
<div class="line"><a name="l17580"></a><span class="lineno">17580</span>&#160;                                $dom[$key][<span class="stringliteral">&#39;line-height&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#af8cc74fe5806eb009a22791c3a4c7cce">$this-&gt;cell_height_ratio</a>;</div>
<div class="line"><a name="l17581"></a><span class="lineno">17581</span>&#160;                            }</div>
<div class="line"><a name="l17582"></a><span class="lineno">17582</span>&#160;                            <span class="keywordflow">if</span> (!$dom[$key][<span class="stringliteral">&#39;block&#39;</span>]) {</div>
<div class="line"><a name="l17583"></a><span class="lineno">17583</span>&#160;                                <span class="keywordflow">if</span> (!(isset($dom[($key + 1)]) AND $dom[($key + 1)][<span class="stringliteral">&#39;tag&#39;</span>] AND (!$dom[($key + 1)][<span class="stringliteral">&#39;opening&#39;</span>]) AND ($dom[($key + 1)][<span class="stringliteral">&#39;value&#39;</span>] != <span class="stringliteral">&#39;li&#39;</span>) AND $dom[$key][<span class="stringliteral">&#39;tag&#39;</span>] AND (!$dom[$key][<span class="stringliteral">&#39;opening&#39;</span>]))) {</div>
<div class="line"><a name="l17584"></a><span class="lineno">17584</span>&#160;                                    $this-&gt;y += (((($curfontsize * <a class="code" href="../../d4/d40/classTCPDF.html#af8cc74fe5806eb009a22791c3a4c7cce">$this-&gt;cell_height_ratio</a>) - ($fontsize * $dom[$key][<span class="stringliteral">&#39;line-height&#39;</span>])) / $this-&gt;k) + $curfontascent - $fontascent - $curfontdescent + $fontdescent) / 2;</div>
<div class="line"><a name="l17585"></a><span class="lineno">17585</span>&#160;                                }</div>
<div class="line"><a name="l17586"></a><span class="lineno">17586</span>&#160;                                <span class="keywordflow">if</span> (($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] != <span class="stringliteral">&#39;sup&#39;</span>) AND ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] != <span class="stringliteral">&#39;sub&#39;</span>)) {</div>
<div class="line"><a name="l17587"></a><span class="lineno">17587</span>&#160;                                    $current_line_align_data = array($key, $minstartliney, $maxbottomliney);</div>
<div class="line"><a name="l17588"></a><span class="lineno">17588</span>&#160;                                    <span class="keywordflow">if</span> (isset($line_align_data) AND (($line_align_data[0] == ($key - 1)) OR (($line_align_data[0] == ($key - 2)) AND (isset($dom[($key - 1)])) AND (preg_match(<span class="stringliteral">&#39;/^([\s]+)$/&#39;</span>, $dom[($key - 1)][<span class="stringliteral">&#39;value&#39;</span>]) &gt; 0)))) {</div>
<div class="line"><a name="l17589"></a><span class="lineno">17589</span>&#160;                                        $minstartliney = min($this-&gt;y, $line_align_data[1]);</div>
<div class="line"><a name="l17590"></a><span class="lineno">17590</span>&#160;                                        $maxbottomliney = max(($this-&gt;y + $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a25c7f71b3fcb19024497ea620f885346">getCellHeight</a>($fontsize / $this-&gt;k)), $line_align_data[2]);</div>
<div class="line"><a name="l17591"></a><span class="lineno">17591</span>&#160;                                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l17592"></a><span class="lineno">17592</span>&#160;                                        $minstartliney = min($this-&gt;y, $minstartliney);</div>
<div class="line"><a name="l17593"></a><span class="lineno">17593</span>&#160;                                        $maxbottomliney = max(($this-&gt;y + $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a25c7f71b3fcb19024497ea620f885346">getCellHeight</a>($fontsize / $this-&gt;k)), $maxbottomliney);</div>
<div class="line"><a name="l17594"></a><span class="lineno">17594</span>&#160;                                    }</div>
<div class="line"><a name="l17595"></a><span class="lineno">17595</span>&#160;                                    $line_align_data = $current_line_align_data;</div>
<div class="line"><a name="l17596"></a><span class="lineno">17596</span>&#160;                                }</div>
<div class="line"><a name="l17597"></a><span class="lineno">17597</span>&#160;                            }</div>
<div class="line"><a name="l17598"></a><span class="lineno">17598</span>&#160;                            $this-&gt;cell_height_ratio = $dom[$key][<span class="stringliteral">&#39;line-height&#39;</span>];</div>
<div class="line"><a name="l17599"></a><span class="lineno">17599</span>&#160;                            $fontaligned = <span class="keyword">true</span>;</div>
<div class="line"><a name="l17600"></a><span class="lineno">17600</span>&#160;                        }</div>
<div class="line"><a name="l17601"></a><span class="lineno">17601</span>&#160;                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#afd56e360c43553830d543323e81bc045">SetFont</a>($fontname, $fontstyle, $fontsize);</div>
<div class="line"><a name="l17602"></a><span class="lineno">17602</span>&#160;                        <span class="comment">// reset row height</span></div>
<div class="line"><a name="l17603"></a><span class="lineno">17603</span>&#160;                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a10215105777b306528a827f3669e936e">resetLastH</a>();</div>
<div class="line"><a name="l17604"></a><span class="lineno">17604</span>&#160;                        $curfontname = $fontname;</div>
<div class="line"><a name="l17605"></a><span class="lineno">17605</span>&#160;                        $curfontstyle = $fontstyle;</div>
<div class="line"><a name="l17606"></a><span class="lineno">17606</span>&#160;                        $curfontsize = $fontsize;</div>
<div class="line"><a name="l17607"></a><span class="lineno">17607</span>&#160;                        $curfontascent = $fontascent;</div>
<div class="line"><a name="l17608"></a><span class="lineno">17608</span>&#160;                        $curfontdescent = $fontdescent;</div>
<div class="line"><a name="l17609"></a><span class="lineno">17609</span>&#160;                    }</div>
<div class="line"><a name="l17610"></a><span class="lineno">17610</span>&#160;                }</div>
<div class="line"><a name="l17611"></a><span class="lineno">17611</span>&#160;                <span class="comment">// set text rendering mode</span></div>
<div class="line"><a name="l17612"></a><span class="lineno">17612</span>&#160;                $textstroke = isset($dom[$key][<span class="stringliteral">&#39;stroke&#39;</span>]) ? $dom[$key][<span class="stringliteral">&#39;stroke&#39;</span>] : <a class="code" href="../../d4/d40/classTCPDF.html#acef86c1b60f2b45323f27c4dc9620922">$this-&gt;textstrokewidth</a>;</div>
<div class="line"><a name="l17613"></a><span class="lineno">17613</span>&#160;                $textfill = isset($dom[$key][<span class="stringliteral">&#39;fill&#39;</span>]) ? $dom[$key][<span class="stringliteral">&#39;fill&#39;</span>] : (($this-&gt;textrendermode % 2) == 0);</div>
<div class="line"><a name="l17614"></a><span class="lineno">17614</span>&#160;                $textclip = isset($dom[$key][<span class="stringliteral">&#39;clip&#39;</span>]) ? $dom[$key][<span class="stringliteral">&#39;clip&#39;</span>] : ($this-&gt;textrendermode &gt; 3);</div>
<div class="line"><a name="l17615"></a><span class="lineno">17615</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa194abd22d0ba5e5f2c52c5e05f4e107">setTextRenderingMode</a>($textstroke, $textfill, $textclip);</div>
<div class="line"><a name="l17616"></a><span class="lineno">17616</span>&#160;                <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;font-stretch&#39;</span>]) AND ($dom[$key][<span class="stringliteral">&#39;font-stretch&#39;</span>] !== <span class="keyword">false</span>)) {</div>
<div class="line"><a name="l17617"></a><span class="lineno">17617</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ad69e13e0b99d5d72440bc95cde06dbcd">setFontStretching</a>($dom[$key][<span class="stringliteral">&#39;font-stretch&#39;</span>]);</div>
<div class="line"><a name="l17618"></a><span class="lineno">17618</span>&#160;                }</div>
<div class="line"><a name="l17619"></a><span class="lineno">17619</span>&#160;                <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;letter-spacing&#39;</span>]) AND ($dom[$key][<span class="stringliteral">&#39;letter-spacing&#39;</span>] !== <span class="keyword">false</span>)) {</div>
<div class="line"><a name="l17620"></a><span class="lineno">17620</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa9d049671275dc2a39e4654f3028544c">setFontSpacing</a>($dom[$key][<span class="stringliteral">&#39;letter-spacing&#39;</span>]);</div>
<div class="line"><a name="l17621"></a><span class="lineno">17621</span>&#160;                }</div>
<div class="line"><a name="l17622"></a><span class="lineno">17622</span>&#160;                <span class="keywordflow">if</span> (($plalign == <span class="charliteral">&#39;J&#39;</span>) AND $dom[$key][<span class="stringliteral">&#39;block&#39;</span>]) {</div>
<div class="line"><a name="l17623"></a><span class="lineno">17623</span>&#160;                    $plalign = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l17624"></a><span class="lineno">17624</span>&#160;                }</div>
<div class="line"><a name="l17625"></a><span class="lineno">17625</span>&#160;                <span class="comment">// get current position on page buffer</span></div>
<div class="line"><a name="l17626"></a><span class="lineno">17626</span>&#160;                $curpos = $this-&gt;pagelen[$startlinepage];</div>
<div class="line"><a name="l17627"></a><span class="lineno">17627</span>&#160;                <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;bgcolor&#39;</span>]) AND ($dom[$key][<span class="stringliteral">&#39;bgcolor&#39;</span>] !== <span class="keyword">false</span>)) {</div>
<div class="line"><a name="l17628"></a><span class="lineno">17628</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a850dd347f649c99548a193f2b84a502e">SetFillColorArray</a>($dom[$key][<span class="stringliteral">&#39;bgcolor&#39;</span>]);</div>
<div class="line"><a name="l17629"></a><span class="lineno">17629</span>&#160;                    $wfill = <span class="keyword">true</span>;</div>
<div class="line"><a name="l17630"></a><span class="lineno">17630</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l17631"></a><span class="lineno">17631</span>&#160;                    $wfill = $fill | <span class="keyword">false</span>;</div>
<div class="line"><a name="l17632"></a><span class="lineno">17632</span>&#160;                }</div>
<div class="line"><a name="l17633"></a><span class="lineno">17633</span>&#160;                <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;fgcolor&#39;</span>]) AND ($dom[$key][<span class="stringliteral">&#39;fgcolor&#39;</span>] !== <span class="keyword">false</span>)) {</div>
<div class="line"><a name="l17634"></a><span class="lineno">17634</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ae6e2854e4d5c71966ef5121934c24566">SetTextColorArray</a>($dom[$key][<span class="stringliteral">&#39;fgcolor&#39;</span>]);</div>
<div class="line"><a name="l17635"></a><span class="lineno">17635</span>&#160;                }</div>
<div class="line"><a name="l17636"></a><span class="lineno">17636</span>&#160;                <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;strokecolor&#39;</span>]) AND ($dom[$key][<span class="stringliteral">&#39;strokecolor&#39;</span>] !== <span class="keyword">false</span>)) {</div>
<div class="line"><a name="l17637"></a><span class="lineno">17637</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8f3481f3ce8a4fcd40ac1e1a6bd8960e">SetDrawColorArray</a>($dom[$key][<span class="stringliteral">&#39;strokecolor&#39;</span>]);</div>
<div class="line"><a name="l17638"></a><span class="lineno">17638</span>&#160;                }</div>
<div class="line"><a name="l17639"></a><span class="lineno">17639</span>&#160;                <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;align&#39;</span>])) {</div>
<div class="line"><a name="l17640"></a><span class="lineno">17640</span>&#160;                    $lalign = $dom[$key][<span class="stringliteral">&#39;align&#39;</span>];</div>
<div class="line"><a name="l17641"></a><span class="lineno">17641</span>&#160;                }</div>
<div class="line"><a name="l17642"></a><span class="lineno">17642</span>&#160;                <span class="keywordflow">if</span> (TCPDF_STATIC::empty_string($lalign)) {</div>
<div class="line"><a name="l17643"></a><span class="lineno">17643</span>&#160;                    $lalign = $align;</div>
<div class="line"><a name="l17644"></a><span class="lineno">17644</span>&#160;                }</div>
<div class="line"><a name="l17645"></a><span class="lineno">17645</span>&#160;            }</div>
<div class="line"><a name="l17646"></a><span class="lineno">17646</span>&#160;            <span class="comment">// align lines</span></div>
<div class="line"><a name="l17647"></a><span class="lineno">17647</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;newline AND (strlen($dom[$key][<span class="stringliteral">&#39;value&#39;</span>]) &gt; 0) AND ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] != <span class="stringliteral">&#39;td&#39;</span>) AND ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] != <span class="stringliteral">&#39;th&#39;</span>)) {</div>
<div class="line"><a name="l17648"></a><span class="lineno">17648</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a505b4eabece70b8679ebdeb86964b798">$newline</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l17649"></a><span class="lineno">17649</span>&#160;                $fontaligned = <span class="keyword">false</span>;</div>
<div class="line"><a name="l17650"></a><span class="lineno">17650</span>&#160;                <span class="comment">// we are at the beginning of a new line</span></div>
<div class="line"><a name="l17651"></a><span class="lineno">17651</span>&#160;                <span class="keywordflow">if</span> (isset($startlinex)) {</div>
<div class="line"><a name="l17652"></a><span class="lineno">17652</span>&#160;                    $yshift = ($minstartliney - $startliney);</div>
<div class="line"><a name="l17653"></a><span class="lineno">17653</span>&#160;                    <span class="keywordflow">if</span> (($yshift &gt; 0) OR ($this-&gt;page &gt; $startlinepage)) {</div>
<div class="line"><a name="l17654"></a><span class="lineno">17654</span>&#160;                        $yshift = 0;</div>
<div class="line"><a name="l17655"></a><span class="lineno">17655</span>&#160;                    }</div>
<div class="line"><a name="l17656"></a><span class="lineno">17656</span>&#160;                    $t_x = 0;</div>
<div class="line"><a name="l17657"></a><span class="lineno">17657</span>&#160;                    <span class="comment">// the last line must be shifted to be aligned as requested</span></div>
<div class="line"><a name="l17658"></a><span class="lineno">17658</span>&#160;                    $linew = abs($this-&gt;endlinex - $startlinex);</div>
<div class="line"><a name="l17659"></a><span class="lineno">17659</span>&#160;                    <span class="keywordflow">if</span> ($this-&gt;inxobj) {</div>
<div class="line"><a name="l17660"></a><span class="lineno">17660</span>&#160;                        <span class="comment">// we are inside an XObject template</span></div>
<div class="line"><a name="l17661"></a><span class="lineno">17661</span>&#160;                        $pstart = substr($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;outdata&#39;</span>], 0, $startlinepos);</div>
<div class="line"><a name="l17662"></a><span class="lineno">17662</span>&#160;                        <span class="keywordflow">if</span> (isset($opentagpos)) {</div>
<div class="line"><a name="l17663"></a><span class="lineno">17663</span>&#160;                            $midpos = $opentagpos;</div>
<div class="line"><a name="l17664"></a><span class="lineno">17664</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l17665"></a><span class="lineno">17665</span>&#160;                            $midpos = 0;</div>
<div class="line"><a name="l17666"></a><span class="lineno">17666</span>&#160;                        }</div>
<div class="line"><a name="l17667"></a><span class="lineno">17667</span>&#160;                        <span class="keywordflow">if</span> ($midpos &gt; 0) {</div>
<div class="line"><a name="l17668"></a><span class="lineno">17668</span>&#160;                            $pmid = substr($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;outdata&#39;</span>], $startlinepos, ($midpos - $startlinepos));</div>
<div class="line"><a name="l17669"></a><span class="lineno">17669</span>&#160;                            $pend = substr($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;outdata&#39;</span>], $midpos);</div>
<div class="line"><a name="l17670"></a><span class="lineno">17670</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l17671"></a><span class="lineno">17671</span>&#160;                            $pmid = substr($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;outdata&#39;</span>], $startlinepos);</div>
<div class="line"><a name="l17672"></a><span class="lineno">17672</span>&#160;                            $pend = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l17673"></a><span class="lineno">17673</span>&#160;                        }</div>
<div class="line"><a name="l17674"></a><span class="lineno">17674</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l17675"></a><span class="lineno">17675</span>&#160;                        $pstart = substr($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d67b0a8681222f71fa9f9f6e65e0c56">getPageBuffer</a>($startlinepage), 0, $startlinepos);</div>
<div class="line"><a name="l17676"></a><span class="lineno">17676</span>&#160;                        <span class="keywordflow">if</span> (isset($opentagpos) AND isset($this-&gt;footerlen[$startlinepage]) AND (!$this-&gt;InFooter)) {</div>
<div class="line"><a name="l17677"></a><span class="lineno">17677</span>&#160;                            $this-&gt;footerpos[$startlinepage] = $this-&gt;pagelen[$startlinepage] - $this-&gt;footerlen[$startlinepage];</div>
<div class="line"><a name="l17678"></a><span class="lineno">17678</span>&#160;                            $midpos = min($opentagpos, $this-&gt;footerpos[$startlinepage]);</div>
<div class="line"><a name="l17679"></a><span class="lineno">17679</span>&#160;                        } elseif (isset($opentagpos)) {</div>
<div class="line"><a name="l17680"></a><span class="lineno">17680</span>&#160;                            $midpos = $opentagpos;</div>
<div class="line"><a name="l17681"></a><span class="lineno">17681</span>&#160;                        } elseif (isset($this-&gt;footerlen[$startlinepage]) AND (!$this-&gt;InFooter)) {</div>
<div class="line"><a name="l17682"></a><span class="lineno">17682</span>&#160;                            $this-&gt;footerpos[$startlinepage] = $this-&gt;pagelen[$startlinepage] - $this-&gt;footerlen[$startlinepage];</div>
<div class="line"><a name="l17683"></a><span class="lineno">17683</span>&#160;                            $midpos = $this-&gt;footerpos[$startlinepage];</div>
<div class="line"><a name="l17684"></a><span class="lineno">17684</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l17685"></a><span class="lineno">17685</span>&#160;                            $midpos = 0;</div>
<div class="line"><a name="l17686"></a><span class="lineno">17686</span>&#160;                        }</div>
<div class="line"><a name="l17687"></a><span class="lineno">17687</span>&#160;                        <span class="keywordflow">if</span> ($midpos &gt; 0) {</div>
<div class="line"><a name="l17688"></a><span class="lineno">17688</span>&#160;                            $pmid = substr($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d67b0a8681222f71fa9f9f6e65e0c56">getPageBuffer</a>($startlinepage), $startlinepos, ($midpos - $startlinepos));</div>
<div class="line"><a name="l17689"></a><span class="lineno">17689</span>&#160;                            $pend = substr($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d67b0a8681222f71fa9f9f6e65e0c56">getPageBuffer</a>($startlinepage), $midpos);</div>
<div class="line"><a name="l17690"></a><span class="lineno">17690</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l17691"></a><span class="lineno">17691</span>&#160;                            $pmid = substr($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d67b0a8681222f71fa9f9f6e65e0c56">getPageBuffer</a>($startlinepage), $startlinepos);</div>
<div class="line"><a name="l17692"></a><span class="lineno">17692</span>&#160;                            $pend = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l17693"></a><span class="lineno">17693</span>&#160;                        }</div>
<div class="line"><a name="l17694"></a><span class="lineno">17694</span>&#160;                    }</div>
<div class="line"><a name="l17695"></a><span class="lineno">17695</span>&#160;                    <span class="keywordflow">if</span> ((isset($plalign) AND ((($plalign == <span class="charliteral">&#39;C&#39;</span>) OR ($plalign == <span class="charliteral">&#39;J&#39;</span>) OR (($plalign == <span class="charliteral">&#39;R&#39;</span>) AND (!$this-&gt;rtl)) OR (($plalign == <span class="charliteral">&#39;L&#39;</span>) AND ($this-&gt;rtl)))))) {</div>
<div class="line"><a name="l17696"></a><span class="lineno">17696</span>&#160;                        <span class="comment">// calculate shifting amount</span></div>
<div class="line"><a name="l17697"></a><span class="lineno">17697</span>&#160;                        $tw = <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>;</div>
<div class="line"><a name="l17698"></a><span class="lineno">17698</span>&#160;                        <span class="keywordflow">if</span> (($plalign == <span class="charliteral">&#39;J&#39;</span>) AND $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#accba6f1471acb211de74e6b34107041d">isRTLTextDir</a>() AND ($this-&gt;num_columns &gt; 1)) {</div>
<div class="line"><a name="l17699"></a><span class="lineno">17699</span>&#160;                            $tw += $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>];</div>
<div class="line"><a name="l17700"></a><span class="lineno">17700</span>&#160;                        }</div>
<div class="line"><a name="l17701"></a><span class="lineno">17701</span>&#160;                        <span class="keywordflow">if</span> ($this-&gt;lMargin != $prevlMargin) {</div>
<div class="line"><a name="l17702"></a><span class="lineno">17702</span>&#160;                            $tw += ($prevlMargin - <a class="code" href="../../d4/d40/classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da">$this-&gt;lMargin</a>);</div>
<div class="line"><a name="l17703"></a><span class="lineno">17703</span>&#160;                        }</div>
<div class="line"><a name="l17704"></a><span class="lineno">17704</span>&#160;                        <span class="keywordflow">if</span> ($this-&gt;rMargin != $prevrMargin) {</div>
<div class="line"><a name="l17705"></a><span class="lineno">17705</span>&#160;                            $tw += ($prevrMargin - <a class="code" href="../../d4/d40/classTCPDF.html#a44fb75b85bea40ced25fdea9d89dc8e9">$this-&gt;rMargin</a>);</div>
<div class="line"><a name="l17706"></a><span class="lineno">17706</span>&#160;                        }</div>
<div class="line"><a name="l17707"></a><span class="lineno">17707</span>&#160;                        $one_space_width = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8075c1f04b6fbddc957cff786c4b16d9">GetStringWidth</a>(chr(32));</div>
<div class="line"><a name="l17708"></a><span class="lineno">17708</span>&#160;                        $no = 0; <span class="comment">// number of spaces on a line contained on a single block</span></div>
<div class="line"><a name="l17709"></a><span class="lineno">17709</span>&#160;                        <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#accba6f1471acb211de74e6b34107041d">isRTLTextDir</a>()) { <span class="comment">// RTL</span></div>
<div class="line"><a name="l17710"></a><span class="lineno">17710</span>&#160;                            <span class="comment">// remove left space if exist</span></div>
<div class="line"><a name="l17711"></a><span class="lineno">17711</span>&#160;                            $pos1 = TCPDF_STATIC::revstrpos($pmid, <span class="stringliteral">&#39;[(&#39;</span>);</div>
<div class="line"><a name="l17712"></a><span class="lineno">17712</span>&#160;                            <span class="keywordflow">if</span> ($pos1 &gt; 0) {</div>
<div class="line"><a name="l17713"></a><span class="lineno">17713</span>&#160;                                $pos1 = intval($pos1);</div>
<div class="line"><a name="l17714"></a><span class="lineno">17714</span>&#160;                                <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a81c8257af5d6d6e40f1bb77d6b507b97">isUnicodeFont</a>()) {</div>
<div class="line"><a name="l17715"></a><span class="lineno">17715</span>&#160;                                    $pos2 = intval(TCPDF_STATIC::revstrpos($pmid, <span class="stringliteral">&#39;[(&#39;</span>.chr(0).chr(32)));</div>
<div class="line"><a name="l17716"></a><span class="lineno">17716</span>&#160;                                    $spacelen = 2;</div>
<div class="line"><a name="l17717"></a><span class="lineno">17717</span>&#160;                                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l17718"></a><span class="lineno">17718</span>&#160;                                    $pos2 = intval(TCPDF_STATIC::revstrpos($pmid, <span class="stringliteral">&#39;[(&#39;</span>.chr(32)));</div>
<div class="line"><a name="l17719"></a><span class="lineno">17719</span>&#160;                                    $spacelen = 1;</div>
<div class="line"><a name="l17720"></a><span class="lineno">17720</span>&#160;                                }</div>
<div class="line"><a name="l17721"></a><span class="lineno">17721</span>&#160;                                <span class="keywordflow">if</span> ($pos1 == $pos2) {</div>
<div class="line"><a name="l17722"></a><span class="lineno">17722</span>&#160;                                    $pmid = substr($pmid, 0, ($pos1 + 2)).substr($pmid, ($pos1 + 2 + $spacelen));</div>
<div class="line"><a name="l17723"></a><span class="lineno">17723</span>&#160;                                    <span class="keywordflow">if</span> (substr($pmid, $pos1, 4) == <span class="stringliteral">&#39;[()]&#39;</span>) {</div>
<div class="line"><a name="l17724"></a><span class="lineno">17724</span>&#160;                                        $linew -= $one_space_width;</div>
<div class="line"><a name="l17725"></a><span class="lineno">17725</span>&#160;                                    } elseif ($pos1 == strpos($pmid, <span class="stringliteral">&#39;[(&#39;</span>)) {</div>
<div class="line"><a name="l17726"></a><span class="lineno">17726</span>&#160;                                        $no = 1;</div>
<div class="line"><a name="l17727"></a><span class="lineno">17727</span>&#160;                                    }</div>
<div class="line"><a name="l17728"></a><span class="lineno">17728</span>&#160;                                }</div>
<div class="line"><a name="l17729"></a><span class="lineno">17729</span>&#160;                            }</div>
<div class="line"><a name="l17730"></a><span class="lineno">17730</span>&#160;                        } <span class="keywordflow">else</span> { <span class="comment">// LTR</span></div>
<div class="line"><a name="l17731"></a><span class="lineno">17731</span>&#160;                            <span class="comment">// remove right space if exist</span></div>
<div class="line"><a name="l17732"></a><span class="lineno">17732</span>&#160;                            $pos1 = TCPDF_STATIC::revstrpos($pmid, <span class="stringliteral">&#39;)]&#39;</span>);</div>
<div class="line"><a name="l17733"></a><span class="lineno">17733</span>&#160;                            <span class="keywordflow">if</span> ($pos1 &gt; 0) {</div>
<div class="line"><a name="l17734"></a><span class="lineno">17734</span>&#160;                                $pos1 = intval($pos1);</div>
<div class="line"><a name="l17735"></a><span class="lineno">17735</span>&#160;                                <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a81c8257af5d6d6e40f1bb77d6b507b97">isUnicodeFont</a>()) {</div>
<div class="line"><a name="l17736"></a><span class="lineno">17736</span>&#160;                                    $pos2 = intval(TCPDF_STATIC::revstrpos($pmid, chr(0).chr(32).<span class="stringliteral">&#39;)]&#39;</span>)) + 2;</div>
<div class="line"><a name="l17737"></a><span class="lineno">17737</span>&#160;                                    $spacelen = 2;</div>
<div class="line"><a name="l17738"></a><span class="lineno">17738</span>&#160;                                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l17739"></a><span class="lineno">17739</span>&#160;                                    $pos2 = intval(TCPDF_STATIC::revstrpos($pmid, chr(32).<span class="stringliteral">&#39;)]&#39;</span>)) + 1;</div>
<div class="line"><a name="l17740"></a><span class="lineno">17740</span>&#160;                                    $spacelen = 1;</div>
<div class="line"><a name="l17741"></a><span class="lineno">17741</span>&#160;                                }</div>
<div class="line"><a name="l17742"></a><span class="lineno">17742</span>&#160;                                <span class="keywordflow">if</span> ($pos1 == $pos2) {</div>
<div class="line"><a name="l17743"></a><span class="lineno">17743</span>&#160;                                    $pmid = substr($pmid, 0, ($pos1 - $spacelen)).substr($pmid, $pos1);</div>
<div class="line"><a name="l17744"></a><span class="lineno">17744</span>&#160;                                    $linew -= $one_space_width;</div>
<div class="line"><a name="l17745"></a><span class="lineno">17745</span>&#160;                                }</div>
<div class="line"><a name="l17746"></a><span class="lineno">17746</span>&#160;                            }</div>
<div class="line"><a name="l17747"></a><span class="lineno">17747</span>&#160;                        }</div>
<div class="line"><a name="l17748"></a><span class="lineno">17748</span>&#160;                        $mdiff = ($tw - $linew);</div>
<div class="line"><a name="l17749"></a><span class="lineno">17749</span>&#160;                        <span class="keywordflow">if</span> ($plalign == <span class="charliteral">&#39;C&#39;</span>) {</div>
<div class="line"><a name="l17750"></a><span class="lineno">17750</span>&#160;                            <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l17751"></a><span class="lineno">17751</span>&#160;                                $t_x = -($mdiff / 2);</div>
<div class="line"><a name="l17752"></a><span class="lineno">17752</span>&#160;                            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l17753"></a><span class="lineno">17753</span>&#160;                                $t_x = ($mdiff / 2);</div>
<div class="line"><a name="l17754"></a><span class="lineno">17754</span>&#160;                            }</div>
<div class="line"><a name="l17755"></a><span class="lineno">17755</span>&#160;                        } elseif ($plalign == <span class="charliteral">&#39;R&#39;</span>) {</div>
<div class="line"><a name="l17756"></a><span class="lineno">17756</span>&#160;                            <span class="comment">// right alignment on LTR document</span></div>
<div class="line"><a name="l17757"></a><span class="lineno">17757</span>&#160;                            $t_x = $mdiff;</div>
<div class="line"><a name="l17758"></a><span class="lineno">17758</span>&#160;                        } elseif ($plalign == <span class="charliteral">&#39;L&#39;</span>) {</div>
<div class="line"><a name="l17759"></a><span class="lineno">17759</span>&#160;                            <span class="comment">// left alignment on RTL document</span></div>
<div class="line"><a name="l17760"></a><span class="lineno">17760</span>&#160;                            $t_x = -$mdiff;</div>
<div class="line"><a name="l17761"></a><span class="lineno">17761</span>&#160;                        } elseif (($plalign == <span class="charliteral">&#39;J&#39;</span>) AND ($plalign == $lalign)) {</div>
<div class="line"><a name="l17762"></a><span class="lineno">17762</span>&#160;                            <span class="comment">// Justification</span></div>
<div class="line"><a name="l17763"></a><span class="lineno">17763</span>&#160;                            <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#accba6f1471acb211de74e6b34107041d">isRTLTextDir</a>()) {</div>
<div class="line"><a name="l17764"></a><span class="lineno">17764</span>&#160;                                <span class="comment">// align text on the left</span></div>
<div class="line"><a name="l17765"></a><span class="lineno">17765</span>&#160;                                $t_x = -$mdiff;</div>
<div class="line"><a name="l17766"></a><span class="lineno">17766</span>&#160;                            }</div>
<div class="line"><a name="l17767"></a><span class="lineno">17767</span>&#160;                            $ns = 0; <span class="comment">// number of spaces</span></div>
<div class="line"><a name="l17768"></a><span class="lineno">17768</span>&#160;                            $pmidtemp = $pmid;</div>
<div class="line"><a name="l17769"></a><span class="lineno">17769</span>&#160;                            <span class="comment">// escape special characters</span></div>
<div class="line"><a name="l17770"></a><span class="lineno">17770</span>&#160;                            $pmidtemp = preg_replace(<span class="stringliteral">&#39;/[\\\][\(]/x&#39;</span>, <span class="stringliteral">&#39;\\#!#OP#!#&#39;</span>, $pmidtemp);</div>
<div class="line"><a name="l17771"></a><span class="lineno">17771</span>&#160;                            $pmidtemp = preg_replace(<span class="stringliteral">&#39;/[\\\][\)]/x&#39;</span>, <span class="stringliteral">&#39;\\#!#CP#!#&#39;</span>, $pmidtemp);</div>
<div class="line"><a name="l17772"></a><span class="lineno">17772</span>&#160;                            <span class="comment">// search spaces</span></div>
<div class="line"><a name="l17773"></a><span class="lineno">17773</span>&#160;                            <span class="keywordflow">if</span> (preg_match_all(<span class="stringliteral">&#39;/\[\(([^\)]*)\)\]/x&#39;</span>, $pmidtemp, $lnstring, PREG_PATTERN_ORDER)) {</div>
<div class="line"><a name="l17774"></a><span class="lineno">17774</span>&#160;                                $spacestr = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a623785c4dc57739d845b36e810704a89">getSpaceString</a>();</div>
<div class="line"><a name="l17775"></a><span class="lineno">17775</span>&#160;                                $maxkk = count($lnstring[1]) - 1;</div>
<div class="line"><a name="l17776"></a><span class="lineno">17776</span>&#160;                                <span class="keywordflow">for</span> ($kk=0; $kk &lt;= $maxkk; ++$kk) {</div>
<div class="line"><a name="l17777"></a><span class="lineno">17777</span>&#160;                                    <span class="comment">// restore special characters</span></div>
<div class="line"><a name="l17778"></a><span class="lineno">17778</span>&#160;                                    $lnstring[1][$kk] = str_replace(<span class="stringliteral">&#39;#!#OP#!#&#39;</span>, <span class="charliteral">&#39;(&#39;</span>, $lnstring[1][$kk]);</div>
<div class="line"><a name="l17779"></a><span class="lineno">17779</span>&#160;                                    $lnstring[1][$kk] = str_replace(<span class="stringliteral">&#39;#!#CP#!#&#39;</span>, <span class="charliteral">&#39;)&#39;</span>, $lnstring[1][$kk]);</div>
<div class="line"><a name="l17780"></a><span class="lineno">17780</span>&#160;                                    <span class="comment">// store number of spaces on the strings</span></div>
<div class="line"><a name="l17781"></a><span class="lineno">17781</span>&#160;                                    $lnstring[2][$kk] = substr_count($lnstring[1][$kk], $spacestr);</div>
<div class="line"><a name="l17782"></a><span class="lineno">17782</span>&#160;                                    <span class="comment">// count total spaces on line</span></div>
<div class="line"><a name="l17783"></a><span class="lineno">17783</span>&#160;                                    $ns += $lnstring[2][$kk];</div>
<div class="line"><a name="l17784"></a><span class="lineno">17784</span>&#160;                                    $lnstring[3][$kk] = $ns;</div>
<div class="line"><a name="l17785"></a><span class="lineno">17785</span>&#160;                                }</div>
<div class="line"><a name="l17786"></a><span class="lineno">17786</span>&#160;                                <span class="keywordflow">if</span> ($ns == 0) {</div>
<div class="line"><a name="l17787"></a><span class="lineno">17787</span>&#160;                                    $ns = 1;</div>
<div class="line"><a name="l17788"></a><span class="lineno">17788</span>&#160;                                }</div>
<div class="line"><a name="l17789"></a><span class="lineno">17789</span>&#160;                                <span class="comment">// calculate additional space to add to each existing space</span></div>
<div class="line"><a name="l17790"></a><span class="lineno">17790</span>&#160;                                $spacewidth = ($mdiff / ($ns - $no)) * <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>;</div>
<div class="line"><a name="l17791"></a><span class="lineno">17791</span>&#160;                                <span class="keywordflow">if</span> ($this-&gt;FontSize &lt;= 0) {</div>
<div class="line"><a name="l17792"></a><span class="lineno">17792</span>&#160;                                    $this-&gt;FontSize = 1;</div>
<div class="line"><a name="l17793"></a><span class="lineno">17793</span>&#160;                                }</div>
<div class="line"><a name="l17794"></a><span class="lineno">17794</span>&#160;                                $spacewidthu = -1000 * ($mdiff + (($ns + $no) * $one_space_width)) / $ns / $this-&gt;FontSize;</div>
<div class="line"><a name="l17795"></a><span class="lineno">17795</span>&#160;                                <span class="keywordflow">if</span> ($this-&gt;font_spacing != 0) {</div>
<div class="line"><a name="l17796"></a><span class="lineno">17796</span>&#160;                                    <span class="comment">// fixed spacing mode</span></div>
<div class="line"><a name="l17797"></a><span class="lineno">17797</span>&#160;                                    $osw = -1000 * $this-&gt;font_spacing / <a class="code" href="../../d4/d40/classTCPDF.html#aa4460c72a6e45784dff4dad7708c372c">$this-&gt;FontSize</a>;</div>
<div class="line"><a name="l17798"></a><span class="lineno">17798</span>&#160;                                    $spacewidthu += $osw;</div>
<div class="line"><a name="l17799"></a><span class="lineno">17799</span>&#160;                                }</div>
<div class="line"><a name="l17800"></a><span class="lineno">17800</span>&#160;                                $nsmax = $ns;</div>
<div class="line"><a name="l17801"></a><span class="lineno">17801</span>&#160;                                $ns = 0;</div>
<div class="line"><a name="l17802"></a><span class="lineno">17802</span>&#160;                                reset($lnstring);</div>
<div class="line"><a name="l17803"></a><span class="lineno">17803</span>&#160;                                $offset = 0;</div>
<div class="line"><a name="l17804"></a><span class="lineno">17804</span>&#160;                                $strcount = 0;</div>
<div class="line"><a name="l17805"></a><span class="lineno">17805</span>&#160;                                $prev_epsposbeg = 0;</div>
<div class="line"><a name="l17806"></a><span class="lineno">17806</span>&#160;                                $textpos = 0;</div>
<div class="line"><a name="l17807"></a><span class="lineno">17807</span>&#160;                                <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#accba6f1471acb211de74e6b34107041d">isRTLTextDir</a>()) {</div>
<div class="line"><a name="l17808"></a><span class="lineno">17808</span>&#160;                                    $textpos = <a class="code" href="../../d4/d40/classTCPDF.html#ab5675888a7271f898545886b4c3277c3">$this-&gt;wPt</a>;</div>
<div class="line"><a name="l17809"></a><span class="lineno">17809</span>&#160;                                }</div>
<div class="line"><a name="l17810"></a><span class="lineno">17810</span>&#160;                                <span class="keywordflow">while</span> (preg_match(<span class="stringliteral">&#39;/([0-9\.\+\-]*)[\s](Td|cm|m|l|c|re)[\s]/x&#39;</span>, $pmid, $strpiece, PREG_OFFSET_CAPTURE, $offset) == 1) {</div>
<div class="line"><a name="l17811"></a><span class="lineno">17811</span>&#160;                                    <span class="comment">// check if we are inside a string section &#39;[( ... )]&#39;</span></div>
<div class="line"><a name="l17812"></a><span class="lineno">17812</span>&#160;                                    $stroffset = strpos($pmid, <span class="stringliteral">&#39;[(&#39;</span>, $offset);</div>
<div class="line"><a name="l17813"></a><span class="lineno">17813</span>&#160;                                    <span class="keywordflow">if</span> (($stroffset !== <span class="keyword">false</span>) AND ($stroffset &lt;= $strpiece[2][1])) {</div>
<div class="line"><a name="l17814"></a><span class="lineno">17814</span>&#160;                                        <span class="comment">// set offset to the end of string section</span></div>
<div class="line"><a name="l17815"></a><span class="lineno">17815</span>&#160;                                        $offset = strpos($pmid, <span class="stringliteral">&#39;)]&#39;</span>, $stroffset);</div>
<div class="line"><a name="l17816"></a><span class="lineno">17816</span>&#160;                                        <span class="keywordflow">while</span> (($offset !== <span class="keyword">false</span>) AND ($pmid[($offset - 1)] == <span class="charliteral">&#39;\\&#39;</span>)) {</div>
<div class="line"><a name="l17817"></a><span class="lineno">17817</span>&#160;                                            $offset = strpos($pmid, <span class="stringliteral">&#39;)]&#39;</span>, ($offset + 1));</div>
<div class="line"><a name="l17818"></a><span class="lineno">17818</span>&#160;                                        }</div>
<div class="line"><a name="l17819"></a><span class="lineno">17819</span>&#160;                                        <span class="keywordflow">if</span> ($offset === <span class="keyword">false</span>) {</div>
<div class="line"><a name="l17820"></a><span class="lineno">17820</span>&#160;                                            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;HTML Justification: malformed PDF code.&#39;</span>);</div>
<div class="line"><a name="l17821"></a><span class="lineno">17821</span>&#160;                                        }</div>
<div class="line"><a name="l17822"></a><span class="lineno">17822</span>&#160;                                        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l17823"></a><span class="lineno">17823</span>&#160;                                    }</div>
<div class="line"><a name="l17824"></a><span class="lineno">17824</span>&#160;                                    <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#accba6f1471acb211de74e6b34107041d">isRTLTextDir</a>()) {</div>
<div class="line"><a name="l17825"></a><span class="lineno">17825</span>&#160;                                        $spacew = ($spacewidth * ($nsmax - $ns));</div>
<div class="line"><a name="l17826"></a><span class="lineno">17826</span>&#160;                                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l17827"></a><span class="lineno">17827</span>&#160;                                        $spacew = ($spacewidth * $ns);</div>
<div class="line"><a name="l17828"></a><span class="lineno">17828</span>&#160;                                    }</div>
<div class="line"><a name="l17829"></a><span class="lineno">17829</span>&#160;                                    $offset = $strpiece[2][1] + strlen($strpiece[2][0]);</div>
<div class="line"><a name="l17830"></a><span class="lineno">17830</span>&#160;                                    $epsposend = strpos($pmid, $this-&gt;epsmarker.<span class="charliteral">&#39;Q&#39;</span>, $offset);              </div>
<div class="line"><a name="l17831"></a><span class="lineno">17831</span>&#160;                                    <span class="keywordflow">if</span> ($epsposend !== null) {</div>
<div class="line"><a name="l17832"></a><span class="lineno">17832</span>&#160;                                        $epsposend += strlen($this-&gt;epsmarker.<span class="charliteral">&#39;Q&#39;</span>);</div>
<div class="line"><a name="l17833"></a><span class="lineno">17833</span>&#160;                                        $epsposbeg = strpos($pmid, <span class="charliteral">&#39;q&#39;</span>.$this-&gt;epsmarker, $offset);</div>
<div class="line"><a name="l17834"></a><span class="lineno">17834</span>&#160;                                        <span class="keywordflow">if</span> ($epsposbeg === null) {</div>
<div class="line"><a name="l17835"></a><span class="lineno">17835</span>&#160;                                            $epsposbeg = strpos($pmid, <span class="charliteral">&#39;q&#39;</span>.$this-&gt;epsmarker, ($prev_epsposbeg - 6));</div>
<div class="line"><a name="l17836"></a><span class="lineno">17836</span>&#160;                                            $prev_epsposbeg = $epsposbeg;</div>
<div class="line"><a name="l17837"></a><span class="lineno">17837</span>&#160;                                        }</div>
<div class="line"><a name="l17838"></a><span class="lineno">17838</span>&#160;                                        <span class="keywordflow">if</span> (($epsposbeg &gt; 0) AND ($epsposend &gt; 0) AND ($offset &gt; $epsposbeg) AND ($offset &lt; $epsposend)) {</div>
<div class="line"><a name="l17839"></a><span class="lineno">17839</span>&#160;                                            <span class="comment">// shift EPS images</span></div>
<div class="line"><a name="l17840"></a><span class="lineno">17840</span>&#160;                                            $trx = sprintf(<span class="stringliteral">&#39;1 0 0 1 %F 0 cm&#39;</span>, $spacew);</div>
<div class="line"><a name="l17841"></a><span class="lineno">17841</span>&#160;                                            $pmid_b = substr($pmid, 0, $epsposbeg);</div>
<div class="line"><a name="l17842"></a><span class="lineno">17842</span>&#160;                                            $pmid_m = substr($pmid, $epsposbeg, ($epsposend - $epsposbeg));</div>
<div class="line"><a name="l17843"></a><span class="lineno">17843</span>&#160;                                            $pmid_e = substr($pmid, $epsposend);</div>
<div class="line"><a name="l17844"></a><span class="lineno">17844</span>&#160;                                            $pmid = $pmid_b.<span class="stringliteral">&quot;\nq\n&quot;</span>.$trx.<span class="stringliteral">&quot;\n&quot;</span>.$pmid_m.<span class="stringliteral">&quot;\nQ\n&quot;</span>.$pmid_e;</div>
<div class="line"><a name="l17845"></a><span class="lineno">17845</span>&#160;                                            $offset = $epsposend;</div>
<div class="line"><a name="l17846"></a><span class="lineno">17846</span>&#160;                                            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l17847"></a><span class="lineno">17847</span>&#160;                                        }</div>
<div class="line"><a name="l17848"></a><span class="lineno">17848</span>&#160;                                    }</div>
<div class="line"><a name="l17849"></a><span class="lineno">17849</span>&#160;                                    $currentxpos = 0;</div>
<div class="line"><a name="l17850"></a><span class="lineno">17850</span>&#160;                                    <span class="comment">// shift blocks of code</span></div>
<div class="line"><a name="l17851"></a><span class="lineno">17851</span>&#160;                                    <span class="keywordflow">switch</span> ($strpiece[2][0]) {</div>
<div class="line"><a name="l17852"></a><span class="lineno">17852</span>&#160;                                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;Td&#39;</span>:</div>
<div class="line"><a name="l17853"></a><span class="lineno">17853</span>&#160;                                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;cm&#39;</span>:</div>
<div class="line"><a name="l17854"></a><span class="lineno">17854</span>&#160;                                        <span class="keywordflow">case</span> <span class="charliteral">&#39;m&#39;</span>:</div>
<div class="line"><a name="l17855"></a><span class="lineno">17855</span>&#160;                                        <span class="keywordflow">case</span> <span class="charliteral">&#39;l&#39;</span>: {</div>
<div class="line"><a name="l17856"></a><span class="lineno">17856</span>&#160;                                            <span class="comment">// get current X position</span></div>
<div class="line"><a name="l17857"></a><span class="lineno">17857</span>&#160;                                            preg_match(<span class="stringliteral">&#39;/([0-9\.\+\-]*)[\s](&#39;</span>.$strpiece[1][0].<span class="stringliteral">&#39;)[\s](&#39;</span>.$strpiece[2][0].<span class="stringliteral">&#39;)([\s]*)/x&#39;</span>, $pmid, $xmatches);</div>
<div class="line"><a name="l17858"></a><span class="lineno">17858</span>&#160;                                            <span class="keywordflow">if</span> (!isset($xmatches[1])) {</div>
<div class="line"><a name="l17859"></a><span class="lineno">17859</span>&#160;                                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l17860"></a><span class="lineno">17860</span>&#160;                                            }</div>
<div class="line"><a name="l17861"></a><span class="lineno">17861</span>&#160;                                            $currentxpos = $xmatches[1];</div>
<div class="line"><a name="l17862"></a><span class="lineno">17862</span>&#160;                                            $textpos = $currentxpos;</div>
<div class="line"><a name="l17863"></a><span class="lineno">17863</span>&#160;                                            <span class="keywordflow">if</span> (($strcount &lt;= $maxkk) AND ($strpiece[2][0] == <span class="stringliteral">&#39;Td&#39;</span>)) {</div>
<div class="line"><a name="l17864"></a><span class="lineno">17864</span>&#160;                                                $ns = $lnstring[3][$strcount];</div>
<div class="line"><a name="l17865"></a><span class="lineno">17865</span>&#160;                                                <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#accba6f1471acb211de74e6b34107041d">isRTLTextDir</a>()) {</div>
<div class="line"><a name="l17866"></a><span class="lineno">17866</span>&#160;                                                    $spacew = ($spacewidth * ($nsmax - $ns));</div>
<div class="line"><a name="l17867"></a><span class="lineno">17867</span>&#160;                                                }</div>
<div class="line"><a name="l17868"></a><span class="lineno">17868</span>&#160;                                                ++$strcount;</div>
<div class="line"><a name="l17869"></a><span class="lineno">17869</span>&#160;                                            }</div>
<div class="line"><a name="l17870"></a><span class="lineno">17870</span>&#160;                                            <span class="comment">// justify block</span></div>
<div class="line"><a name="l17871"></a><span class="lineno">17871</span>&#160;                                            <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/([0-9\.\+\-]*)[\s](&#39;</span>.$strpiece[1][0].<span class="stringliteral">&#39;)[\s](&#39;</span>.$strpiece[2][0].<span class="stringliteral">&#39;)([\s]*)/x&#39;</span>, $pmid, $pmatch) == 1) {</div>
<div class="line"><a name="l17872"></a><span class="lineno">17872</span>&#160;                                                $newpmid = sprintf(<span class="stringliteral">&#39;%F&#39;</span>,(floatval($pmatch[1]) + $spacew)).<span class="charliteral">&#39; &#39;</span>.$pmatch[2].<span class="stringliteral">&#39; x*#!#*x&#39;</span>.$pmatch[3].$pmatch[4];</div>
<div class="line"><a name="l17873"></a><span class="lineno">17873</span>&#160;                                                $pmid = str_replace($pmatch[0], $newpmid, $pmid);</div>
<div class="line"><a name="l17874"></a><span class="lineno">17874</span>&#160;                                                unset($pmatch, $newpmid);</div>
<div class="line"><a name="l17875"></a><span class="lineno">17875</span>&#160;                                            }</div>
<div class="line"><a name="l17876"></a><span class="lineno">17876</span>&#160;                                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l17877"></a><span class="lineno">17877</span>&#160;                                        }</div>
<div class="line"><a name="l17878"></a><span class="lineno">17878</span>&#160;                                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;re&#39;</span>: {</div>
<div class="line"><a name="l17879"></a><span class="lineno">17879</span>&#160;                                            <span class="comment">// justify block</span></div>
<div class="line"><a name="l17880"></a><span class="lineno">17880</span>&#160;                                            <span class="keywordflow">if</span> (!TCPDF_STATIC::empty_string($this-&gt;lispacer)) {</div>
<div class="line"><a name="l17881"></a><span class="lineno">17881</span>&#160;                                                $this-&gt;lispacer = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l17882"></a><span class="lineno">17882</span>&#160;                                                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l17883"></a><span class="lineno">17883</span>&#160;                                            }</div>
<div class="line"><a name="l17884"></a><span class="lineno">17884</span>&#160;                                            preg_match(<span class="stringliteral">&#39;/([0-9\.\+\-]*)[\s]([0-9\.\+\-]*)[\s]([0-9\.\+\-]*)[\s](&#39;</span>.$strpiece[1][0].<span class="stringliteral">&#39;)[\s](re)([\s]*)/x&#39;</span>, $pmid, $xmatches);</div>
<div class="line"><a name="l17885"></a><span class="lineno">17885</span>&#160;                                            <span class="keywordflow">if</span> (!isset($xmatches[1])) {</div>
<div class="line"><a name="l17886"></a><span class="lineno">17886</span>&#160;                                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l17887"></a><span class="lineno">17887</span>&#160;                                            }</div>
<div class="line"><a name="l17888"></a><span class="lineno">17888</span>&#160;                                            $currentxpos = $xmatches[1];</div>
<div class="line"><a name="l17889"></a><span class="lineno">17889</span>&#160;                                            $x_diff = 0;</div>
<div class="line"><a name="l17890"></a><span class="lineno">17890</span>&#160;                                            $w_diff = 0;</div>
<div class="line"><a name="l17891"></a><span class="lineno">17891</span>&#160;                                            <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#accba6f1471acb211de74e6b34107041d">isRTLTextDir</a>()) { <span class="comment">// RTL</span></div>
<div class="line"><a name="l17892"></a><span class="lineno">17892</span>&#160;                                                <span class="keywordflow">if</span> ($currentxpos &lt; $textpos) {</div>
<div class="line"><a name="l17893"></a><span class="lineno">17893</span>&#160;                                                    $x_diff = ($spacewidth * ($nsmax - $lnstring[3][$strcount]));</div>
<div class="line"><a name="l17894"></a><span class="lineno">17894</span>&#160;                                                    $w_diff = ($spacewidth * $lnstring[2][$strcount]);</div>
<div class="line"><a name="l17895"></a><span class="lineno">17895</span>&#160;                                                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l17896"></a><span class="lineno">17896</span>&#160;                                                    <span class="keywordflow">if</span> ($strcount &gt; 0) {</div>
<div class="line"><a name="l17897"></a><span class="lineno">17897</span>&#160;                                                        $x_diff = ($spacewidth * ($nsmax - $lnstring[3][($strcount - 1)]));</div>
<div class="line"><a name="l17898"></a><span class="lineno">17898</span>&#160;                                                        $w_diff = ($spacewidth * $lnstring[2][($strcount - 1)]);</div>
<div class="line"><a name="l17899"></a><span class="lineno">17899</span>&#160;                                                    }</div>
<div class="line"><a name="l17900"></a><span class="lineno">17900</span>&#160;                                                }</div>
<div class="line"><a name="l17901"></a><span class="lineno">17901</span>&#160;                                            } <span class="keywordflow">else</span> { <span class="comment">// LTR</span></div>
<div class="line"><a name="l17902"></a><span class="lineno">17902</span>&#160;                                                <span class="keywordflow">if</span> ($currentxpos &gt; $textpos) {</div>
<div class="line"><a name="l17903"></a><span class="lineno">17903</span>&#160;                                                    <span class="keywordflow">if</span> ($strcount &gt; 0) {</div>
<div class="line"><a name="l17904"></a><span class="lineno">17904</span>&#160;                                                        $x_diff = ($spacewidth * $lnstring[3][($strcount - 1)]);</div>
<div class="line"><a name="l17905"></a><span class="lineno">17905</span>&#160;                                                    }</div>
<div class="line"><a name="l17906"></a><span class="lineno">17906</span>&#160;                                                    $w_diff = ($spacewidth * $lnstring[2][$strcount]);</div>
<div class="line"><a name="l17907"></a><span class="lineno">17907</span>&#160;                                                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l17908"></a><span class="lineno">17908</span>&#160;                                                    <span class="keywordflow">if</span> ($strcount &gt; 1) {</div>
<div class="line"><a name="l17909"></a><span class="lineno">17909</span>&#160;                                                        $x_diff = ($spacewidth * $lnstring[3][($strcount - 2)]);</div>
<div class="line"><a name="l17910"></a><span class="lineno">17910</span>&#160;                                                    }</div>
<div class="line"><a name="l17911"></a><span class="lineno">17911</span>&#160;                                                    <span class="keywordflow">if</span> ($strcount &gt; 0) {</div>
<div class="line"><a name="l17912"></a><span class="lineno">17912</span>&#160;                                                        $w_diff = ($spacewidth * $lnstring[2][($strcount - 1)]);</div>
<div class="line"><a name="l17913"></a><span class="lineno">17913</span>&#160;                                                    }</div>
<div class="line"><a name="l17914"></a><span class="lineno">17914</span>&#160;                                                }</div>
<div class="line"><a name="l17915"></a><span class="lineno">17915</span>&#160;                                            }</div>
<div class="line"><a name="l17916"></a><span class="lineno">17916</span>&#160;                                            <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/(&#39;</span>.$xmatches[1].<span class="stringliteral">&#39;)[\s](&#39;</span>.$xmatches[2].<span class="stringliteral">&#39;)[\s](&#39;</span>.$xmatches[3].<span class="stringliteral">&#39;)[\s](&#39;</span>.$strpiece[1][0].<span class="stringliteral">&#39;)[\s](re)([\s]*)/x&#39;</span>, $pmid, $pmatch) == 1) {</div>
<div class="line"><a name="l17917"></a><span class="lineno">17917</span>&#160;                                                $newx = sprintf(<span class="stringliteral">&#39;%F&#39;</span>,(floatval($pmatch[1]) + $x_diff));</div>
<div class="line"><a name="l17918"></a><span class="lineno">17918</span>&#160;                                                $neww = sprintf(<span class="stringliteral">&#39;%F&#39;</span>,(floatval($pmatch[3]) + $w_diff));</div>
<div class="line"><a name="l17919"></a><span class="lineno">17919</span>&#160;                                                $newpmid = $newx.<span class="charliteral">&#39; &#39;</span>.$pmatch[2].<span class="charliteral">&#39; &#39;</span>.$neww.<span class="charliteral">&#39; &#39;</span>.$pmatch[4].<span class="stringliteral">&#39; x*#!#*x&#39;</span>.$pmatch[5].$pmatch[6];</div>
<div class="line"><a name="l17920"></a><span class="lineno">17920</span>&#160;                                                $pmid = str_replace($pmatch[0], $newpmid, $pmid);</div>
<div class="line"><a name="l17921"></a><span class="lineno">17921</span>&#160;                                                unset($pmatch, $newpmid, $newx, $neww);</div>
<div class="line"><a name="l17922"></a><span class="lineno">17922</span>&#160;                                            }</div>
<div class="line"><a name="l17923"></a><span class="lineno">17923</span>&#160;                                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l17924"></a><span class="lineno">17924</span>&#160;                                        }</div>
<div class="line"><a name="l17925"></a><span class="lineno">17925</span>&#160;                                        <span class="keywordflow">case</span> <span class="charliteral">&#39;c&#39;</span>: {</div>
<div class="line"><a name="l17926"></a><span class="lineno">17926</span>&#160;                                            <span class="comment">// get current X position</span></div>
<div class="line"><a name="l17927"></a><span class="lineno">17927</span>&#160;                                            preg_match(<span class="stringliteral">&#39;/([0-9\.\+\-]*)[\s]([0-9\.\+\-]*)[\s]([0-9\.\+\-]*)[\s]([0-9\.\+\-]*)[\s]([0-9\.\+\-]*)[\s](&#39;</span>.$strpiece[1][0].<span class="stringliteral">&#39;)[\s](c)([\s]*)/x&#39;</span>, $pmid, $xmatches);</div>
<div class="line"><a name="l17928"></a><span class="lineno">17928</span>&#160;                                            <span class="keywordflow">if</span> (!isset($xmatches[1])) {</div>
<div class="line"><a name="l17929"></a><span class="lineno">17929</span>&#160;                                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l17930"></a><span class="lineno">17930</span>&#160;                                            }</div>
<div class="line"><a name="l17931"></a><span class="lineno">17931</span>&#160;                                            $currentxpos = $xmatches[1];</div>
<div class="line"><a name="l17932"></a><span class="lineno">17932</span>&#160;                                            <span class="comment">// justify block</span></div>
<div class="line"><a name="l17933"></a><span class="lineno">17933</span>&#160;                                            <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/(&#39;</span>.$xmatches[1].<span class="stringliteral">&#39;)[\s](&#39;</span>.$xmatches[2].<span class="stringliteral">&#39;)[\s](&#39;</span>.$xmatches[3].<span class="stringliteral">&#39;)[\s](&#39;</span>.$xmatches[4].<span class="stringliteral">&#39;)[\s](&#39;</span>.$xmatches[5].<span class="stringliteral">&#39;)[\s](&#39;</span>.$strpiece[1][0].<span class="stringliteral">&#39;)[\s](c)([\s]*)/x&#39;</span>, $pmid, $pmatch) == 1) {</div>
<div class="line"><a name="l17934"></a><span class="lineno">17934</span>&#160;                                                $newx1 = sprintf(<span class="stringliteral">&#39;%F&#39;</span>,(floatval($pmatch[1]) + $spacew));</div>
<div class="line"><a name="l17935"></a><span class="lineno">17935</span>&#160;                                                $newx2 = sprintf(<span class="stringliteral">&#39;%F&#39;</span>,(floatval($pmatch[3]) + $spacew));</div>
<div class="line"><a name="l17936"></a><span class="lineno">17936</span>&#160;                                                $newx3 = sprintf(<span class="stringliteral">&#39;%F&#39;</span>,(floatval($pmatch[5]) + $spacew));</div>
<div class="line"><a name="l17937"></a><span class="lineno">17937</span>&#160;                                                $newpmid = $newx1.<span class="charliteral">&#39; &#39;</span>.$pmatch[2].<span class="charliteral">&#39; &#39;</span>.$newx2.<span class="charliteral">&#39; &#39;</span>.$pmatch[4].<span class="charliteral">&#39; &#39;</span>.$newx3.<span class="charliteral">&#39; &#39;</span>.$pmatch[6].<span class="stringliteral">&#39; x*#!#*x&#39;</span>.$pmatch[7].$pmatch[8];</div>
<div class="line"><a name="l17938"></a><span class="lineno">17938</span>&#160;                                                $pmid = str_replace($pmatch[0], $newpmid, $pmid);</div>
<div class="line"><a name="l17939"></a><span class="lineno">17939</span>&#160;                                                unset($pmatch, $newpmid, $newx1, $newx2, $newx3);</div>
<div class="line"><a name="l17940"></a><span class="lineno">17940</span>&#160;                                            }</div>
<div class="line"><a name="l17941"></a><span class="lineno">17941</span>&#160;                                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l17942"></a><span class="lineno">17942</span>&#160;                                        }</div>
<div class="line"><a name="l17943"></a><span class="lineno">17943</span>&#160;                                    }</div>
<div class="line"><a name="l17944"></a><span class="lineno">17944</span>&#160;                                    <span class="comment">// shift the annotations and links</span></div>
<div class="line"><a name="l17945"></a><span class="lineno">17945</span>&#160;                                    $cxpos = ($currentxpos / <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>);</div>
<div class="line"><a name="l17946"></a><span class="lineno">17946</span>&#160;                                    $lmpos = ($this-&gt;lMargin + $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>] + <a class="code" href="../../d4/d40/classTCPDF.html#a0757c5909a61c91c055d5867c57e0d3e">$this-&gt;feps</a>);</div>
<div class="line"><a name="l17947"></a><span class="lineno">17947</span>&#160;                                    <span class="keywordflow">if</span> ($this-&gt;inxobj) {</div>
<div class="line"><a name="l17948"></a><span class="lineno">17948</span>&#160;                                        <span class="comment">// we are inside an XObject template</span></div>
<div class="line"><a name="l17949"></a><span class="lineno">17949</span>&#160;                                        <span class="keywordflow">foreach</span> ($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;annotations&#39;</span>] as $pak =&gt; $pac) {</div>
<div class="line"><a name="l17950"></a><span class="lineno">17950</span>&#160;                                            <span class="keywordflow">if</span> (($pac[<span class="charliteral">&#39;y&#39;</span>] &gt;= $minstartliney) AND (($pac[<span class="charliteral">&#39;x&#39;</span>] * $this-&gt;k) &gt;= ($currentxpos - $this-&gt;feps)) AND (($pac[<span class="charliteral">&#39;x&#39;</span>] * $this-&gt;k) &lt;= ($currentxpos + $this-&gt;feps))) {</div>
<div class="line"><a name="l17951"></a><span class="lineno">17951</span>&#160;                                                <span class="keywordflow">if</span> ($cxpos &gt; $lmpos) {</div>
<div class="line"><a name="l17952"></a><span class="lineno">17952</span>&#160;                                                    $this-&gt;xobjects[<a class="code" href="../../d4/d40/classTCPDF.html#abe4390b4e1939e10c9b61a986adfc117">$this-&gt;xobjid</a>][<span class="stringliteral">&#39;annotations&#39;</span>][$pak][<span class="charliteral">&#39;x&#39;</span>] += ($spacew / <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>);</div>
<div class="line"><a name="l17953"></a><span class="lineno">17953</span>&#160;                                                    $this-&gt;xobjects[<a class="code" href="../../d4/d40/classTCPDF.html#abe4390b4e1939e10c9b61a986adfc117">$this-&gt;xobjid</a>][<span class="stringliteral">&#39;annotations&#39;</span>][$pak][<span class="charliteral">&#39;w&#39;</span>] += (($spacewidth * $pac[<span class="stringliteral">&#39;numspaces&#39;</span>]) / $this-&gt;k);</div>
<div class="line"><a name="l17954"></a><span class="lineno">17954</span>&#160;                                                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l17955"></a><span class="lineno">17955</span>&#160;                                                    $this-&gt;xobjects[<a class="code" href="../../d4/d40/classTCPDF.html#abe4390b4e1939e10c9b61a986adfc117">$this-&gt;xobjid</a>][<span class="stringliteral">&#39;annotations&#39;</span>][$pak][<span class="charliteral">&#39;w&#39;</span>] += (($spacewidth * $pac[<span class="stringliteral">&#39;numspaces&#39;</span>]) / $this-&gt;k);</div>
<div class="line"><a name="l17956"></a><span class="lineno">17956</span>&#160;                                                }</div>
<div class="line"><a name="l17957"></a><span class="lineno">17957</span>&#160;                                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l17958"></a><span class="lineno">17958</span>&#160;                                            }</div>
<div class="line"><a name="l17959"></a><span class="lineno">17959</span>&#160;                                        }</div>
<div class="line"><a name="l17960"></a><span class="lineno">17960</span>&#160;                                    } elseif (isset($this-&gt;PageAnnots[$this-&gt;page])) {</div>
<div class="line"><a name="l17961"></a><span class="lineno">17961</span>&#160;                                        <span class="keywordflow">foreach</span> ($this-&gt;PageAnnots[$this-&gt;page] as $pak =&gt; $pac) {</div>
<div class="line"><a name="l17962"></a><span class="lineno">17962</span>&#160;                                            <span class="keywordflow">if</span> (($pac[<span class="charliteral">&#39;y&#39;</span>] &gt;= $minstartliney) AND (($pac[<span class="charliteral">&#39;x&#39;</span>] * $this-&gt;k) &gt;= ($currentxpos - $this-&gt;feps)) AND (($pac[<span class="charliteral">&#39;x&#39;</span>] * $this-&gt;k) &lt;= ($currentxpos + $this-&gt;feps))) {</div>
<div class="line"><a name="l17963"></a><span class="lineno">17963</span>&#160;                                                <span class="keywordflow">if</span> ($cxpos &gt; $lmpos) {</div>
<div class="line"><a name="l17964"></a><span class="lineno">17964</span>&#160;                                                    $this-&gt;PageAnnots[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][$pak][<span class="charliteral">&#39;x&#39;</span>] += ($spacew / <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>);</div>
<div class="line"><a name="l17965"></a><span class="lineno">17965</span>&#160;                                                    $this-&gt;PageAnnots[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][$pak][<span class="charliteral">&#39;w&#39;</span>] += (($spacewidth * $pac[<span class="stringliteral">&#39;numspaces&#39;</span>]) / $this-&gt;k);</div>
<div class="line"><a name="l17966"></a><span class="lineno">17966</span>&#160;                                                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l17967"></a><span class="lineno">17967</span>&#160;                                                    $this-&gt;PageAnnots[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][$pak][<span class="charliteral">&#39;w&#39;</span>] += (($spacewidth * $pac[<span class="stringliteral">&#39;numspaces&#39;</span>]) / $this-&gt;k);</div>
<div class="line"><a name="l17968"></a><span class="lineno">17968</span>&#160;                                                }</div>
<div class="line"><a name="l17969"></a><span class="lineno">17969</span>&#160;                                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l17970"></a><span class="lineno">17970</span>&#160;                                            }</div>
<div class="line"><a name="l17971"></a><span class="lineno">17971</span>&#160;                                        }</div>
<div class="line"><a name="l17972"></a><span class="lineno">17972</span>&#160;                                    }</div>
<div class="line"><a name="l17973"></a><span class="lineno">17973</span>&#160;                                } <span class="comment">// end of while</span></div>
<div class="line"><a name="l17974"></a><span class="lineno">17974</span>&#160;                                <span class="comment">// remove markers</span></div>
<div class="line"><a name="l17975"></a><span class="lineno">17975</span>&#160;                                $pmid = str_replace(<span class="stringliteral">&#39;x*#!#*x&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $pmid);</div>
<div class="line"><a name="l17976"></a><span class="lineno">17976</span>&#160;                                <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a81c8257af5d6d6e40f1bb77d6b507b97">isUnicodeFont</a>()) {</div>
<div class="line"><a name="l17977"></a><span class="lineno">17977</span>&#160;                                    <span class="comment">// multibyte characters</span></div>
<div class="line"><a name="l17978"></a><span class="lineno">17978</span>&#160;                                    $spacew = $spacewidthu;</div>
<div class="line"><a name="l17979"></a><span class="lineno">17979</span>&#160;                                    <span class="keywordflow">if</span> ($this-&gt;font_stretching != 100) {</div>
<div class="line"><a name="l17980"></a><span class="lineno">17980</span>&#160;                                        <span class="comment">// word spacing is affected by stretching</span></div>
<div class="line"><a name="l17981"></a><span class="lineno">17981</span>&#160;                                        $spacew /= ($this-&gt;font_stretching / 100);</div>
<div class="line"><a name="l17982"></a><span class="lineno">17982</span>&#160;                                    }</div>
<div class="line"><a name="l17983"></a><span class="lineno">17983</span>&#160;                                    <span class="comment">// escape special characters</span></div>
<div class="line"><a name="l17984"></a><span class="lineno">17984</span>&#160;                                    $pos = 0;</div>
<div class="line"><a name="l17985"></a><span class="lineno">17985</span>&#160;                                    $pmid = preg_replace(<span class="stringliteral">&#39;/[\\\][\(]/x&#39;</span>, <span class="stringliteral">&#39;\\#!#OP#!#&#39;</span>, $pmid);</div>
<div class="line"><a name="l17986"></a><span class="lineno">17986</span>&#160;                                    $pmid = preg_replace(<span class="stringliteral">&#39;/[\\\][\)]/x&#39;</span>, <span class="stringliteral">&#39;\\#!#CP#!#&#39;</span>, $pmid);</div>
<div class="line"><a name="l17987"></a><span class="lineno">17987</span>&#160;                                    <span class="keywordflow">if</span> (preg_match_all(<span class="stringliteral">&#39;/\[\(([^\)]*)\)\]/x&#39;</span>, $pmid, $pamatch) &gt; 0) {</div>
<div class="line"><a name="l17988"></a><span class="lineno">17988</span>&#160;                                        <span class="keywordflow">foreach</span>($pamatch[0] as $pk =&gt; $pmatch) {</div>
<div class="line"><a name="l17989"></a><span class="lineno">17989</span>&#160;                                            $replace = $pamatch[1][$pk];</div>
<div class="line"><a name="l17990"></a><span class="lineno">17990</span>&#160;                                            $replace = str_replace(<span class="stringliteral">&#39;#!#OP#!#&#39;</span>, <span class="charliteral">&#39;(&#39;</span>, $replace);</div>
<div class="line"><a name="l17991"></a><span class="lineno">17991</span>&#160;                                            $replace = str_replace(<span class="stringliteral">&#39;#!#CP#!#&#39;</span>, <span class="charliteral">&#39;)&#39;</span>, $replace);</div>
<div class="line"><a name="l17992"></a><span class="lineno">17992</span>&#160;                                            $newpmid = <span class="stringliteral">&#39;[(&#39;</span>.str_replace(chr(0).chr(32), <span class="stringliteral">&#39;) &#39;</span>.sprintf(<span class="stringliteral">&#39;%F&#39;</span>, $spacew).<span class="stringliteral">&#39; (&#39;</span>, $replace).<span class="stringliteral">&#39;)]&#39;</span>;</div>
<div class="line"><a name="l17993"></a><span class="lineno">17993</span>&#160;                                            $pos = strpos($pmid, $pmatch, $pos);</div>
<div class="line"><a name="l17994"></a><span class="lineno">17994</span>&#160;                                            <span class="keywordflow">if</span> ($pos !== FALSE) {</div>
<div class="line"><a name="l17995"></a><span class="lineno">17995</span>&#160;                                                $pmid = substr_replace($pmid, $newpmid, $pos, strlen($pmatch));</div>
<div class="line"><a name="l17996"></a><span class="lineno">17996</span>&#160;                                            }</div>
<div class="line"><a name="l17997"></a><span class="lineno">17997</span>&#160;                                            ++$pos;</div>
<div class="line"><a name="l17998"></a><span class="lineno">17998</span>&#160;                                        }</div>
<div class="line"><a name="l17999"></a><span class="lineno">17999</span>&#160;                                        unset($pamatch);</div>
<div class="line"><a name="l18000"></a><span class="lineno">18000</span>&#160;                                    }</div>
<div class="line"><a name="l18001"></a><span class="lineno">18001</span>&#160;                                    <span class="keywordflow">if</span> ($this-&gt;inxobj) {</div>
<div class="line"><a name="l18002"></a><span class="lineno">18002</span>&#160;                                        <span class="comment">// we are inside an XObject template</span></div>
<div class="line"><a name="l18003"></a><span class="lineno">18003</span>&#160;                                        $this-&gt;xobjects[<a class="code" href="../../d4/d40/classTCPDF.html#abe4390b4e1939e10c9b61a986adfc117">$this-&gt;xobjid</a>][<span class="stringliteral">&#39;outdata&#39;</span>] = $pstart.<span class="stringliteral">&quot;\n&quot;</span>.$pmid.<span class="stringliteral">&quot;\n&quot;</span>.$pend;</div>
<div class="line"><a name="l18004"></a><span class="lineno">18004</span>&#160;                                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18005"></a><span class="lineno">18005</span>&#160;                                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a2b85f6395de14dd40cab8839b3ce25a8">setPageBuffer</a>($startlinepage, $pstart.<span class="stringliteral">&quot;\n&quot;</span>.$pmid.<span class="stringliteral">&quot;\n&quot;</span>.$pend);</div>
<div class="line"><a name="l18006"></a><span class="lineno">18006</span>&#160;                                    }</div>
<div class="line"><a name="l18007"></a><span class="lineno">18007</span>&#160;                                    $endlinepos = strlen($pstart.<span class="stringliteral">&quot;\n&quot;</span>.$pmid.<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l18008"></a><span class="lineno">18008</span>&#160;                                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18009"></a><span class="lineno">18009</span>&#160;                                    <span class="comment">// non-unicode (single-byte characters)</span></div>
<div class="line"><a name="l18010"></a><span class="lineno">18010</span>&#160;                                    <span class="keywordflow">if</span> ($this-&gt;font_stretching != 100) {</div>
<div class="line"><a name="l18011"></a><span class="lineno">18011</span>&#160;                                        <span class="comment">// word spacing (Tw) is affected by stretching</span></div>
<div class="line"><a name="l18012"></a><span class="lineno">18012</span>&#160;                                        $spacewidth /= ($this-&gt;font_stretching / 100);</div>
<div class="line"><a name="l18013"></a><span class="lineno">18013</span>&#160;                                    }</div>
<div class="line"><a name="l18014"></a><span class="lineno">18014</span>&#160;                                    $rs = sprintf(<span class="stringliteral">&#39;%F Tw&#39;</span>, $spacewidth);</div>
<div class="line"><a name="l18015"></a><span class="lineno">18015</span>&#160;                                    $pmid = preg_replace(<span class="stringliteral">&quot;/\[\(/x&quot;</span>, $rs.<span class="stringliteral">&#39; [(&#39;</span>, $pmid);</div>
<div class="line"><a name="l18016"></a><span class="lineno">18016</span>&#160;                                    <span class="keywordflow">if</span> ($this-&gt;inxobj) {</div>
<div class="line"><a name="l18017"></a><span class="lineno">18017</span>&#160;                                        <span class="comment">// we are inside an XObject template</span></div>
<div class="line"><a name="l18018"></a><span class="lineno">18018</span>&#160;                                        $this-&gt;xobjects[<a class="code" href="../../d4/d40/classTCPDF.html#abe4390b4e1939e10c9b61a986adfc117">$this-&gt;xobjid</a>][<span class="stringliteral">&#39;outdata&#39;</span>] = $pstart.<span class="stringliteral">&quot;\n&quot;</span>.$pmid.<span class="stringliteral">&quot;\nBT 0 Tw ET\n&quot;</span>.$pend;</div>
<div class="line"><a name="l18019"></a><span class="lineno">18019</span>&#160;                                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18020"></a><span class="lineno">18020</span>&#160;                                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a2b85f6395de14dd40cab8839b3ce25a8">setPageBuffer</a>($startlinepage, $pstart.<span class="stringliteral">&quot;\n&quot;</span>.$pmid.<span class="stringliteral">&quot;\nBT 0 Tw ET\n&quot;</span>.$pend);</div>
<div class="line"><a name="l18021"></a><span class="lineno">18021</span>&#160;                                    }</div>
<div class="line"><a name="l18022"></a><span class="lineno">18022</span>&#160;                                    $endlinepos = strlen($pstart.<span class="stringliteral">&quot;\n&quot;</span>.$pmid.<span class="stringliteral">&quot;\nBT 0 Tw ET\n&quot;</span>);</div>
<div class="line"><a name="l18023"></a><span class="lineno">18023</span>&#160;                                }</div>
<div class="line"><a name="l18024"></a><span class="lineno">18024</span>&#160;                            }</div>
<div class="line"><a name="l18025"></a><span class="lineno">18025</span>&#160;                        } <span class="comment">// end of J</span></div>
<div class="line"><a name="l18026"></a><span class="lineno">18026</span>&#160;                    } <span class="comment">// end if $startlinex</span></div>
<div class="line"><a name="l18027"></a><span class="lineno">18027</span>&#160;                    <span class="keywordflow">if</span> (($t_x != 0) OR ($yshift &lt; 0)) {</div>
<div class="line"><a name="l18028"></a><span class="lineno">18028</span>&#160;                        <span class="comment">// shift the line</span></div>
<div class="line"><a name="l18029"></a><span class="lineno">18029</span>&#160;                        $trx = sprintf(<span class="stringliteral">&#39;1 0 0 1 %F %F cm&#39;</span>, ($t_x * $this-&gt;k), ($yshift * $this-&gt;k));</div>
<div class="line"><a name="l18030"></a><span class="lineno">18030</span>&#160;                        $pstart .= <span class="stringliteral">&quot;\nq\n&quot;</span>.$trx.<span class="stringliteral">&quot;\n&quot;</span>.$pmid.<span class="stringliteral">&quot;\nQ\n&quot;</span>;</div>
<div class="line"><a name="l18031"></a><span class="lineno">18031</span>&#160;                        $endlinepos = strlen($pstart);</div>
<div class="line"><a name="l18032"></a><span class="lineno">18032</span>&#160;                        <span class="keywordflow">if</span> ($this-&gt;inxobj) {</div>
<div class="line"><a name="l18033"></a><span class="lineno">18033</span>&#160;                            <span class="comment">// we are inside an XObject template</span></div>
<div class="line"><a name="l18034"></a><span class="lineno">18034</span>&#160;                            $this-&gt;xobjects[<a class="code" href="../../d4/d40/classTCPDF.html#abe4390b4e1939e10c9b61a986adfc117">$this-&gt;xobjid</a>][<span class="stringliteral">&#39;outdata&#39;</span>] = $pstart.$pend;</div>
<div class="line"><a name="l18035"></a><span class="lineno">18035</span>&#160;                            <span class="keywordflow">foreach</span> ($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;annotations&#39;</span>] as $pak =&gt; $pac) {</div>
<div class="line"><a name="l18036"></a><span class="lineno">18036</span>&#160;                                <span class="keywordflow">if</span> ($pak &gt;= $pask) {</div>
<div class="line"><a name="l18037"></a><span class="lineno">18037</span>&#160;                                    $this-&gt;xobjects[<a class="code" href="../../d4/d40/classTCPDF.html#abe4390b4e1939e10c9b61a986adfc117">$this-&gt;xobjid</a>][<span class="stringliteral">&#39;annotations&#39;</span>][$pak][<span class="charliteral">&#39;x&#39;</span>] += $t_x;</div>
<div class="line"><a name="l18038"></a><span class="lineno">18038</span>&#160;                                    $this-&gt;xobjects[<a class="code" href="../../d4/d40/classTCPDF.html#abe4390b4e1939e10c9b61a986adfc117">$this-&gt;xobjid</a>][<span class="stringliteral">&#39;annotations&#39;</span>][$pak][<span class="charliteral">&#39;y&#39;</span>] -= $yshift;</div>
<div class="line"><a name="l18039"></a><span class="lineno">18039</span>&#160;                                }</div>
<div class="line"><a name="l18040"></a><span class="lineno">18040</span>&#160;                            }</div>
<div class="line"><a name="l18041"></a><span class="lineno">18041</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18042"></a><span class="lineno">18042</span>&#160;                            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a2b85f6395de14dd40cab8839b3ce25a8">setPageBuffer</a>($startlinepage, $pstart.$pend);</div>
<div class="line"><a name="l18043"></a><span class="lineno">18043</span>&#160;                            <span class="comment">// shift the annotations and links</span></div>
<div class="line"><a name="l18044"></a><span class="lineno">18044</span>&#160;                            <span class="keywordflow">if</span> (isset($this-&gt;PageAnnots[$this-&gt;page])) {</div>
<div class="line"><a name="l18045"></a><span class="lineno">18045</span>&#160;                                <span class="keywordflow">foreach</span> ($this-&gt;PageAnnots[$this-&gt;page] as $pak =&gt; $pac) {</div>
<div class="line"><a name="l18046"></a><span class="lineno">18046</span>&#160;                                    <span class="keywordflow">if</span> ($pak &gt;= $pask) {</div>
<div class="line"><a name="l18047"></a><span class="lineno">18047</span>&#160;                                        $this-&gt;PageAnnots[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][$pak][<span class="charliteral">&#39;x&#39;</span>] += $t_x;</div>
<div class="line"><a name="l18048"></a><span class="lineno">18048</span>&#160;                                        $this-&gt;PageAnnots[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][$pak][<span class="charliteral">&#39;y&#39;</span>] -= $yshift;</div>
<div class="line"><a name="l18049"></a><span class="lineno">18049</span>&#160;                                    }</div>
<div class="line"><a name="l18050"></a><span class="lineno">18050</span>&#160;                                }</div>
<div class="line"><a name="l18051"></a><span class="lineno">18051</span>&#160;                            }</div>
<div class="line"><a name="l18052"></a><span class="lineno">18052</span>&#160;                        }</div>
<div class="line"><a name="l18053"></a><span class="lineno">18053</span>&#160;                        $this-&gt;y -= $yshift;</div>
<div class="line"><a name="l18054"></a><span class="lineno">18054</span>&#160;                    }</div>
<div class="line"><a name="l18055"></a><span class="lineno">18055</span>&#160;                }</div>
<div class="line"><a name="l18056"></a><span class="lineno">18056</span>&#160;                $pbrk = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a9e8e4b4d75485b8f1e3aa2133a811e50">checkPageBreak</a>($this-&gt;lasth);</div>
<div class="line"><a name="l18057"></a><span class="lineno">18057</span>&#160;                $this-&gt;newline = <span class="keyword">false</span>;</div>
<div class="line"><a name="l18058"></a><span class="lineno">18058</span>&#160;                $startlinex = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$this-&gt;x</a>;</div>
<div class="line"><a name="l18059"></a><span class="lineno">18059</span>&#160;                $startliney = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l18060"></a><span class="lineno">18060</span>&#160;                <span class="keywordflow">if</span> ($dom[$dom[$key][<span class="stringliteral">&#39;parent&#39;</span>]][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;sup&#39;</span>) {</div>
<div class="line"><a name="l18061"></a><span class="lineno">18061</span>&#160;                    $startliney -= ((0.3 * <a class="code" href="../../d4/d40/classTCPDF.html#a9a787786c9f1a04f54f1dec622869d4d">$this-&gt;FontSizePt</a>) / $this-&gt;k);</div>
<div class="line"><a name="l18062"></a><span class="lineno">18062</span>&#160;                } elseif ($dom[$dom[$key][<span class="stringliteral">&#39;parent&#39;</span>]][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;sub&#39;</span>) {</div>
<div class="line"><a name="l18063"></a><span class="lineno">18063</span>&#160;                    $startliney -= (($this-&gt;FontSizePt / 0.7) / <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>);</div>
<div class="line"><a name="l18064"></a><span class="lineno">18064</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18065"></a><span class="lineno">18065</span>&#160;                    $minstartliney = $startliney;</div>
<div class="line"><a name="l18066"></a><span class="lineno">18066</span>&#160;                    $maxbottomliney = ($this-&gt;y + $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a25c7f71b3fcb19024497ea620f885346">getCellHeight</a>($fontsize / $this-&gt;k));</div>
<div class="line"><a name="l18067"></a><span class="lineno">18067</span>&#160;                }</div>
<div class="line"><a name="l18068"></a><span class="lineno">18068</span>&#160;                $startlinepage = <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>;</div>
<div class="line"><a name="l18069"></a><span class="lineno">18069</span>&#160;                <span class="keywordflow">if</span> (isset($endlinepos) AND (!$pbrk)) {</div>
<div class="line"><a name="l18070"></a><span class="lineno">18070</span>&#160;                    $startlinepos = $endlinepos;</div>
<div class="line"><a name="l18071"></a><span class="lineno">18071</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18072"></a><span class="lineno">18072</span>&#160;                    <span class="keywordflow">if</span> ($this-&gt;inxobj) {</div>
<div class="line"><a name="l18073"></a><span class="lineno">18073</span>&#160;                        <span class="comment">// we are inside an XObject template</span></div>
<div class="line"><a name="l18074"></a><span class="lineno">18074</span>&#160;                        $startlinepos = strlen($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;outdata&#39;</span>]);</div>
<div class="line"><a name="l18075"></a><span class="lineno">18075</span>&#160;                    } elseif (!$this-&gt;InFooter) {</div>
<div class="line"><a name="l18076"></a><span class="lineno">18076</span>&#160;                        <span class="keywordflow">if</span> (isset($this-&gt;footerlen[$this-&gt;page])) {</div>
<div class="line"><a name="l18077"></a><span class="lineno">18077</span>&#160;                            $this-&gt;footerpos[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>] = $this-&gt;pagelen[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>] - $this-&gt;footerlen[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>];</div>
<div class="line"><a name="l18078"></a><span class="lineno">18078</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18079"></a><span class="lineno">18079</span>&#160;                            $this-&gt;footerpos[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>] = $this-&gt;pagelen[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>];</div>
<div class="line"><a name="l18080"></a><span class="lineno">18080</span>&#160;                        }</div>
<div class="line"><a name="l18081"></a><span class="lineno">18081</span>&#160;                        $startlinepos = $this-&gt;footerpos[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>];</div>
<div class="line"><a name="l18082"></a><span class="lineno">18082</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18083"></a><span class="lineno">18083</span>&#160;                        $startlinepos = $this-&gt;pagelen[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>];</div>
<div class="line"><a name="l18084"></a><span class="lineno">18084</span>&#160;                    }</div>
<div class="line"><a name="l18085"></a><span class="lineno">18085</span>&#160;                }</div>
<div class="line"><a name="l18086"></a><span class="lineno">18086</span>&#160;                unset($endlinepos);</div>
<div class="line"><a name="l18087"></a><span class="lineno">18087</span>&#160;                $plalign = $lalign;</div>
<div class="line"><a name="l18088"></a><span class="lineno">18088</span>&#160;                <span class="keywordflow">if</span> (isset($this-&gt;PageAnnots[$this-&gt;page])) {</div>
<div class="line"><a name="l18089"></a><span class="lineno">18089</span>&#160;                    $pask = count($this-&gt;PageAnnots[$this-&gt;page]);</div>
<div class="line"><a name="l18090"></a><span class="lineno">18090</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18091"></a><span class="lineno">18091</span>&#160;                    $pask = 0;</div>
<div class="line"><a name="l18092"></a><span class="lineno">18092</span>&#160;                }</div>
<div class="line"><a name="l18093"></a><span class="lineno">18093</span>&#160;                <span class="keywordflow">if</span> (!($dom[$key][<span class="stringliteral">&#39;tag&#39;</span>] AND !$dom[$key][<span class="stringliteral">&#39;opening&#39;</span>] AND ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;table&#39;</span>)</div>
<div class="line"><a name="l18094"></a><span class="lineno">18094</span>&#160;                    AND (isset($this-&gt;emptypagemrk[$this-&gt;page]))</div>
<div class="line"><a name="l18095"></a><span class="lineno">18095</span>&#160;                    AND ($this-&gt;emptypagemrk[$this-&gt;page] == $this-&gt;pagelen[$this-&gt;page]))) {</div>
<div class="line"><a name="l18096"></a><span class="lineno">18096</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#afd56e360c43553830d543323e81bc045">SetFont</a>($fontname, $fontstyle, $fontsize);</div>
<div class="line"><a name="l18097"></a><span class="lineno">18097</span>&#160;                    <span class="keywordflow">if</span> ($wfill) {</div>
<div class="line"><a name="l18098"></a><span class="lineno">18098</span>&#160;                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a850dd347f649c99548a193f2b84a502e">SetFillColorArray</a>($this-&gt;bgcolor);</div>
<div class="line"><a name="l18099"></a><span class="lineno">18099</span>&#160;                    }</div>
<div class="line"><a name="l18100"></a><span class="lineno">18100</span>&#160;                }</div>
<div class="line"><a name="l18101"></a><span class="lineno">18101</span>&#160;            } <span class="comment">// end newline</span></div>
<div class="line"><a name="l18102"></a><span class="lineno">18102</span>&#160;            <span class="keywordflow">if</span> (isset($opentagpos)) {</div>
<div class="line"><a name="l18103"></a><span class="lineno">18103</span>&#160;                unset($opentagpos);</div>
<div class="line"><a name="l18104"></a><span class="lineno">18104</span>&#160;            }</div>
<div class="line"><a name="l18105"></a><span class="lineno">18105</span>&#160;            <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;tag&#39;</span>]) {</div>
<div class="line"><a name="l18106"></a><span class="lineno">18106</span>&#160;                <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;opening&#39;</span>]) {</div>
<div class="line"><a name="l18107"></a><span class="lineno">18107</span>&#160;                    <span class="comment">// get text indentation (if any)</span></div>
<div class="line"><a name="l18108"></a><span class="lineno">18108</span>&#160;                    <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;text-indent&#39;</span>]) AND $dom[$key][<span class="stringliteral">&#39;block&#39;</span>]) {</div>
<div class="line"><a name="l18109"></a><span class="lineno">18109</span>&#160;                        $this-&gt;textindent = $dom[$key][<span class="stringliteral">&#39;text-indent&#39;</span>];</div>
<div class="line"><a name="l18110"></a><span class="lineno">18110</span>&#160;                        $this-&gt;newline = <span class="keyword">true</span>;</div>
<div class="line"><a name="l18111"></a><span class="lineno">18111</span>&#160;                    }</div>
<div class="line"><a name="l18112"></a><span class="lineno">18112</span>&#160;                    <span class="comment">// table</span></div>
<div class="line"><a name="l18113"></a><span class="lineno">18113</span>&#160;                    <span class="keywordflow">if</span> (($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;table&#39;</span>) AND isset($dom[$key][<span class="stringliteral">&#39;cols&#39;</span>]) AND ($dom[$key][<span class="stringliteral">&#39;cols&#39;</span>] &gt; 0)) {</div>
<div class="line"><a name="l18114"></a><span class="lineno">18114</span>&#160;                        <span class="comment">// available page width</span></div>
<div class="line"><a name="l18115"></a><span class="lineno">18115</span>&#160;                        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l18116"></a><span class="lineno">18116</span>&#160;                            $wtmp = $this-&gt;x - <a class="code" href="../../d4/d40/classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da">$this-&gt;lMargin</a>;</div>
<div class="line"><a name="l18117"></a><span class="lineno">18117</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18118"></a><span class="lineno">18118</span>&#160;                            $wtmp = $this-&gt;w - $this-&gt;rMargin - <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$this-&gt;x</a>;</div>
<div class="line"><a name="l18119"></a><span class="lineno">18119</span>&#160;                        }</div>
<div class="line"><a name="l18120"></a><span class="lineno">18120</span>&#160;                        <span class="comment">// get cell spacing</span></div>
<div class="line"><a name="l18121"></a><span class="lineno">18121</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;cellspacing&#39;</span>])) {</div>
<div class="line"><a name="l18122"></a><span class="lineno">18122</span>&#160;                            $clsp = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9">getHTMLUnitToUnits</a>($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;cellspacing&#39;</span>], 1, <span class="stringliteral">&#39;px&#39;</span>);</div>
<div class="line"><a name="l18123"></a><span class="lineno">18123</span>&#160;                            $cellspacing = array(<span class="charliteral">&#39;H&#39;</span> =&gt; $clsp, <span class="charliteral">&#39;V&#39;</span> =&gt; $clsp);</div>
<div class="line"><a name="l18124"></a><span class="lineno">18124</span>&#160;                        } elseif (isset($dom[$key][<span class="stringliteral">&#39;border-spacing&#39;</span>])) {</div>
<div class="line"><a name="l18125"></a><span class="lineno">18125</span>&#160;                            $cellspacing = $dom[$key][<span class="stringliteral">&#39;border-spacing&#39;</span>];</div>
<div class="line"><a name="l18126"></a><span class="lineno">18126</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18127"></a><span class="lineno">18127</span>&#160;                            $cellspacing = array(<span class="charliteral">&#39;H&#39;</span> =&gt; 0, <span class="charliteral">&#39;V&#39;</span> =&gt; 0);</div>
<div class="line"><a name="l18128"></a><span class="lineno">18128</span>&#160;                        }</div>
<div class="line"><a name="l18129"></a><span class="lineno">18129</span>&#160;                        <span class="comment">// table width</span></div>
<div class="line"><a name="l18130"></a><span class="lineno">18130</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;width&#39;</span>])) {</div>
<div class="line"><a name="l18131"></a><span class="lineno">18131</span>&#160;                            $table_width = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9">getHTMLUnitToUnits</a>($dom[$key][<span class="stringliteral">&#39;width&#39;</span>], $wtmp, <span class="stringliteral">&#39;px&#39;</span>);</div>
<div class="line"><a name="l18132"></a><span class="lineno">18132</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18133"></a><span class="lineno">18133</span>&#160;                            $table_width = $wtmp;</div>
<div class="line"><a name="l18134"></a><span class="lineno">18134</span>&#160;                        }</div>
<div class="line"><a name="l18135"></a><span class="lineno">18135</span>&#160;                        $table_width -= (2 * $cellspacing[<span class="charliteral">&#39;H&#39;</span>]);</div>
<div class="line"><a name="l18136"></a><span class="lineno">18136</span>&#160;                        <span class="keywordflow">if</span> (!$this-&gt;inthead) {</div>
<div class="line"><a name="l18137"></a><span class="lineno">18137</span>&#160;                            $this-&gt;y += $cellspacing[<span class="charliteral">&#39;V&#39;</span>];</div>
<div class="line"><a name="l18138"></a><span class="lineno">18138</span>&#160;                        }</div>
<div class="line"><a name="l18139"></a><span class="lineno">18139</span>&#160;                        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l18140"></a><span class="lineno">18140</span>&#160;                            $cellspacingx = -$cellspacing[<span class="charliteral">&#39;H&#39;</span>];</div>
<div class="line"><a name="l18141"></a><span class="lineno">18141</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18142"></a><span class="lineno">18142</span>&#160;                            $cellspacingx = $cellspacing[<span class="charliteral">&#39;H&#39;</span>];</div>
<div class="line"><a name="l18143"></a><span class="lineno">18143</span>&#160;                        }</div>
<div class="line"><a name="l18144"></a><span class="lineno">18144</span>&#160;                        <span class="comment">// total table width without cellspaces</span></div>
<div class="line"><a name="l18145"></a><span class="lineno">18145</span>&#160;                        $table_columns_width = ($table_width - ($cellspacing[<span class="charliteral">&#39;H&#39;</span>] * ($dom[$key][<span class="stringliteral">&#39;cols&#39;</span>] - 1)));</div>
<div class="line"><a name="l18146"></a><span class="lineno">18146</span>&#160;                        <span class="comment">// minimum column width</span></div>
<div class="line"><a name="l18147"></a><span class="lineno">18147</span>&#160;                        $table_min_column_width = ($table_columns_width / $dom[$key][<span class="stringliteral">&#39;cols&#39;</span>]);</div>
<div class="line"><a name="l18148"></a><span class="lineno">18148</span>&#160;                        <span class="comment">// array of custom column widths</span></div>
<div class="line"><a name="l18149"></a><span class="lineno">18149</span>&#160;                        $table_colwidths = array_fill(0, $dom[$key][<span class="stringliteral">&#39;cols&#39;</span>], $table_min_column_width);</div>
<div class="line"><a name="l18150"></a><span class="lineno">18150</span>&#160;                    }</div>
<div class="line"><a name="l18151"></a><span class="lineno">18151</span>&#160;                    <span class="comment">// table row</span></div>
<div class="line"><a name="l18152"></a><span class="lineno">18152</span>&#160;                    <span class="keywordflow">if</span> ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;tr&#39;</span>) {</div>
<div class="line"><a name="l18153"></a><span class="lineno">18153</span>&#160;                        <span class="comment">// reset column counter</span></div>
<div class="line"><a name="l18154"></a><span class="lineno">18154</span>&#160;                        $colid = 0;</div>
<div class="line"><a name="l18155"></a><span class="lineno">18155</span>&#160;                    }</div>
<div class="line"><a name="l18156"></a><span class="lineno">18156</span>&#160;                    <span class="comment">// table cell</span></div>
<div class="line"><a name="l18157"></a><span class="lineno">18157</span>&#160;                    <span class="keywordflow">if</span> (($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;td&#39;</span>) OR ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;th&#39;</span>)) {</div>
<div class="line"><a name="l18158"></a><span class="lineno">18158</span>&#160;                        $trid = $dom[$key][<span class="stringliteral">&#39;parent&#39;</span>];</div>
<div class="line"><a name="l18159"></a><span class="lineno">18159</span>&#160;                        $table_el = $dom[$trid][<span class="stringliteral">&#39;parent&#39;</span>];</div>
<div class="line"><a name="l18160"></a><span class="lineno">18160</span>&#160;                        <span class="keywordflow">if</span> (!isset($dom[$table_el][<span class="stringliteral">&#39;cols&#39;</span>])) {</div>
<div class="line"><a name="l18161"></a><span class="lineno">18161</span>&#160;                            $dom[$table_el][<span class="stringliteral">&#39;cols&#39;</span>] = $dom[$trid][<span class="stringliteral">&#39;cols&#39;</span>];</div>
<div class="line"><a name="l18162"></a><span class="lineno">18162</span>&#160;                        }</div>
<div class="line"><a name="l18163"></a><span class="lineno">18163</span>&#160;                        <span class="comment">// store border info</span></div>
<div class="line"><a name="l18164"></a><span class="lineno">18164</span>&#160;                        $tdborder = 0;</div>
<div class="line"><a name="l18165"></a><span class="lineno">18165</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;border&#39;</span>]) AND !empty($dom[$key][<span class="stringliteral">&#39;border&#39;</span>])) {</div>
<div class="line"><a name="l18166"></a><span class="lineno">18166</span>&#160;                            $tdborder = $dom[$key][<span class="stringliteral">&#39;border&#39;</span>];</div>
<div class="line"><a name="l18167"></a><span class="lineno">18167</span>&#160;                        }</div>
<div class="line"><a name="l18168"></a><span class="lineno">18168</span>&#160;                        $colspan = intval($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;colspan&#39;</span>]);</div>
<div class="line"><a name="l18169"></a><span class="lineno">18169</span>&#160;                        <span class="keywordflow">if</span> ($colspan &lt;= 0) {</div>
<div class="line"><a name="l18170"></a><span class="lineno">18170</span>&#160;                            $colspan = 1;</div>
<div class="line"><a name="l18171"></a><span class="lineno">18171</span>&#160;                        }</div>
<div class="line"><a name="l18172"></a><span class="lineno">18172</span>&#160;                        $old_cell_padding = <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$this-&gt;cell_padding</a>;</div>
<div class="line"><a name="l18173"></a><span class="lineno">18173</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[($dom[$trid][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;cellpadding&#39;</span>])) {</div>
<div class="line"><a name="l18174"></a><span class="lineno">18174</span>&#160;                            $crclpd = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9">getHTMLUnitToUnits</a>($dom[($dom[$trid][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;cellpadding&#39;</span>], 1, <span class="stringliteral">&#39;px&#39;</span>);</div>
<div class="line"><a name="l18175"></a><span class="lineno">18175</span>&#160;                            $current_cell_padding = array(<span class="charliteral">&#39;L&#39;</span> =&gt; $crclpd, <span class="charliteral">&#39;T&#39;</span> =&gt; $crclpd, <span class="charliteral">&#39;R&#39;</span> =&gt; $crclpd, <span class="charliteral">&#39;B&#39;</span> =&gt; $crclpd);</div>
<div class="line"><a name="l18176"></a><span class="lineno">18176</span>&#160;                        } elseif (isset($dom[($dom[$trid][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;padding&#39;</span>])) {</div>
<div class="line"><a name="l18177"></a><span class="lineno">18177</span>&#160;                            $current_cell_padding = $dom[($dom[$trid][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;padding&#39;</span>];</div>
<div class="line"><a name="l18178"></a><span class="lineno">18178</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18179"></a><span class="lineno">18179</span>&#160;                            $current_cell_padding = array(<span class="charliteral">&#39;L&#39;</span> =&gt; 0, <span class="charliteral">&#39;T&#39;</span> =&gt; 0, <span class="charliteral">&#39;R&#39;</span> =&gt; 0, <span class="charliteral">&#39;B&#39;</span> =&gt; 0);</div>
<div class="line"><a name="l18180"></a><span class="lineno">18180</span>&#160;                        }</div>
<div class="line"><a name="l18181"></a><span class="lineno">18181</span>&#160;                        $this-&gt;cell_padding = $current_cell_padding;</div>
<div class="line"><a name="l18182"></a><span class="lineno">18182</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;height&#39;</span>])) {</div>
<div class="line"><a name="l18183"></a><span class="lineno">18183</span>&#160;                            <span class="comment">// minimum cell height</span></div>
<div class="line"><a name="l18184"></a><span class="lineno">18184</span>&#160;                            $cellh = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9">getHTMLUnitToUnits</a>($dom[$key][<span class="stringliteral">&#39;height&#39;</span>], 0, <span class="stringliteral">&#39;px&#39;</span>);</div>
<div class="line"><a name="l18185"></a><span class="lineno">18185</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18186"></a><span class="lineno">18186</span>&#160;                            $cellh = 0;</div>
<div class="line"><a name="l18187"></a><span class="lineno">18187</span>&#160;                        }</div>
<div class="line"><a name="l18188"></a><span class="lineno">18188</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;content&#39;</span>])) {</div>
<div class="line"><a name="l18189"></a><span class="lineno">18189</span>&#160;                            $cell_content = $dom[$key][<span class="stringliteral">&#39;content&#39;</span>];</div>
<div class="line"><a name="l18190"></a><span class="lineno">18190</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18191"></a><span class="lineno">18191</span>&#160;                            $cell_content = <span class="stringliteral">&#39;&amp;nbsp;&#39;</span>;</div>
<div class="line"><a name="l18192"></a><span class="lineno">18192</span>&#160;                        }</div>
<div class="line"><a name="l18193"></a><span class="lineno">18193</span>&#160;                        $tagtype = $dom[$key][<span class="stringliteral">&#39;value&#39;</span>];</div>
<div class="line"><a name="l18194"></a><span class="lineno">18194</span>&#160;                        $parentid = $key;</div>
<div class="line"><a name="l18195"></a><span class="lineno">18195</span>&#160;                        <span class="keywordflow">while</span> (($key &lt; $maxel) AND (!(($dom[$key][<span class="stringliteral">&#39;tag&#39;</span>]) AND (!$dom[$key][<span class="stringliteral">&#39;opening&#39;</span>]) AND ($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == $tagtype) AND ($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>] == $parentid)))) {</div>
<div class="line"><a name="l18196"></a><span class="lineno">18196</span>&#160;                            <span class="comment">// move $key index forward</span></div>
<div class="line"><a name="l18197"></a><span class="lineno">18197</span>&#160;                            ++$key;</div>
<div class="line"><a name="l18198"></a><span class="lineno">18198</span>&#160;                        }</div>
<div class="line"><a name="l18199"></a><span class="lineno">18199</span>&#160;                        <span class="keywordflow">if</span> (!isset($dom[$trid][<span class="stringliteral">&#39;startpage&#39;</span>])) {</div>
<div class="line"><a name="l18200"></a><span class="lineno">18200</span>&#160;                            $dom[$trid][<span class="stringliteral">&#39;startpage&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>;</div>
<div class="line"><a name="l18201"></a><span class="lineno">18201</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18202"></a><span class="lineno">18202</span>&#160;                            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a99075a970e4fec86e1b31e8ecc923e00">setPage</a>($dom[$trid][<span class="stringliteral">&#39;startpage&#39;</span>]);</div>
<div class="line"><a name="l18203"></a><span class="lineno">18203</span>&#160;                        }</div>
<div class="line"><a name="l18204"></a><span class="lineno">18204</span>&#160;                        <span class="keywordflow">if</span> (!isset($dom[$trid][<span class="stringliteral">&#39;startcolumn&#39;</span>])) {</div>
<div class="line"><a name="l18205"></a><span class="lineno">18205</span>&#160;                            $dom[$trid][<span class="stringliteral">&#39;startcolumn&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#aab81c25eefaf486adf004eb20bc22881">$this-&gt;current_column</a>;</div>
<div class="line"><a name="l18206"></a><span class="lineno">18206</span>&#160;                        } elseif ($this-&gt;current_column != $dom[$trid][<span class="stringliteral">&#39;startcolumn&#39;</span>]) {</div>
<div class="line"><a name="l18207"></a><span class="lineno">18207</span>&#160;                            $tmpx = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$this-&gt;x</a>;</div>
<div class="line"><a name="l18208"></a><span class="lineno">18208</span>&#160;                            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4f11d769024fd07e1f663efd02d10517">selectColumn</a>($dom[$trid][<span class="stringliteral">&#39;startcolumn&#39;</span>]);</div>
<div class="line"><a name="l18209"></a><span class="lineno">18209</span>&#160;                            $this-&gt;x = $tmpx;</div>
<div class="line"><a name="l18210"></a><span class="lineno">18210</span>&#160;                        }</div>
<div class="line"><a name="l18211"></a><span class="lineno">18211</span>&#160;                        <span class="keywordflow">if</span> (!isset($dom[$trid][<span class="stringliteral">&#39;starty&#39;</span>])) {</div>
<div class="line"><a name="l18212"></a><span class="lineno">18212</span>&#160;                            $dom[$trid][<span class="stringliteral">&#39;starty&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l18213"></a><span class="lineno">18213</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18214"></a><span class="lineno">18214</span>&#160;                            $this-&gt;y = $dom[$trid][<span class="stringliteral">&#39;starty&#39;</span>];</div>
<div class="line"><a name="l18215"></a><span class="lineno">18215</span>&#160;                        }</div>
<div class="line"><a name="l18216"></a><span class="lineno">18216</span>&#160;                        <span class="keywordflow">if</span> (!isset($dom[$trid][<span class="stringliteral">&#39;startx&#39;</span>])) {</div>
<div class="line"><a name="l18217"></a><span class="lineno">18217</span>&#160;                            $dom[$trid][<span class="stringliteral">&#39;startx&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$this-&gt;x</a>;</div>
<div class="line"><a name="l18218"></a><span class="lineno">18218</span>&#160;                            $this-&gt;x += $cellspacingx;</div>
<div class="line"><a name="l18219"></a><span class="lineno">18219</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18220"></a><span class="lineno">18220</span>&#160;                            $this-&gt;x += ($cellspacingx / 2);</div>
<div class="line"><a name="l18221"></a><span class="lineno">18221</span>&#160;                        }</div>
<div class="line"><a name="l18222"></a><span class="lineno">18222</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[$parentid][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;rowspan&#39;</span>])) {</div>
<div class="line"><a name="l18223"></a><span class="lineno">18223</span>&#160;                            $rowspan = intval($dom[$parentid][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;rowspan&#39;</span>]);</div>
<div class="line"><a name="l18224"></a><span class="lineno">18224</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18225"></a><span class="lineno">18225</span>&#160;                            $rowspan = 1;</div>
<div class="line"><a name="l18226"></a><span class="lineno">18226</span>&#160;                        }</div>
<div class="line"><a name="l18227"></a><span class="lineno">18227</span>&#160;                        <span class="comment">// skip row-spanned cells started on the previous rows</span></div>
<div class="line"><a name="l18228"></a><span class="lineno">18228</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[$table_el][<span class="stringliteral">&#39;rowspans&#39;</span>])) {</div>
<div class="line"><a name="l18229"></a><span class="lineno">18229</span>&#160;                            $rsk = 0;</div>
<div class="line"><a name="l18230"></a><span class="lineno">18230</span>&#160;                            $rskmax = count($dom[$table_el][<span class="stringliteral">&#39;rowspans&#39;</span>]);</div>
<div class="line"><a name="l18231"></a><span class="lineno">18231</span>&#160;                            <span class="keywordflow">while</span> ($rsk &lt; $rskmax) {</div>
<div class="line"><a name="l18232"></a><span class="lineno">18232</span>&#160;                                $trwsp = $dom[$table_el][<span class="stringliteral">&#39;rowspans&#39;</span>][$rsk];</div>
<div class="line"><a name="l18233"></a><span class="lineno">18233</span>&#160;                                $rsstartx = $trwsp[<span class="stringliteral">&#39;startx&#39;</span>];</div>
<div class="line"><a name="l18234"></a><span class="lineno">18234</span>&#160;                                $rsendx = $trwsp[<span class="stringliteral">&#39;endx&#39;</span>];</div>
<div class="line"><a name="l18235"></a><span class="lineno">18235</span>&#160;                                <span class="comment">// account for margin changes</span></div>
<div class="line"><a name="l18236"></a><span class="lineno">18236</span>&#160;                                <span class="keywordflow">if</span> ($trwsp[<span class="stringliteral">&#39;startpage&#39;</span>] &lt; $this-&gt;page) {</div>
<div class="line"><a name="l18237"></a><span class="lineno">18237</span>&#160;                                    <span class="keywordflow">if</span> (($this-&gt;rtl) AND ($this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;orm&#39;</span>] != $this-&gt;pagedim[$trwsp[<span class="stringliteral">&#39;startpage&#39;</span>]][<span class="stringliteral">&#39;orm&#39;</span>])) {</div>
<div class="line"><a name="l18238"></a><span class="lineno">18238</span>&#160;                                        $dl = ($this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;orm&#39;</span>] - $this-&gt;pagedim[$trwsp[<span class="stringliteral">&#39;startpage&#39;</span>]][<span class="stringliteral">&#39;orm&#39;</span>]);</div>
<div class="line"><a name="l18239"></a><span class="lineno">18239</span>&#160;                                        $rsstartx -= $dl;</div>
<div class="line"><a name="l18240"></a><span class="lineno">18240</span>&#160;                                        $rsendx -= $dl;</div>
<div class="line"><a name="l18241"></a><span class="lineno">18241</span>&#160;                                    } elseif ((!$this-&gt;rtl) AND ($this-&gt;pagedim[$this-&gt;page][<span class="stringliteral">&#39;olm&#39;</span>] != $this-&gt;pagedim[$trwsp[<span class="stringliteral">&#39;startpage&#39;</span>]][<span class="stringliteral">&#39;olm&#39;</span>])) {</div>
<div class="line"><a name="l18242"></a><span class="lineno">18242</span>&#160;                                        $dl = ($this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;olm&#39;</span>] - $this-&gt;pagedim[$trwsp[<span class="stringliteral">&#39;startpage&#39;</span>]][<span class="stringliteral">&#39;olm&#39;</span>]);</div>
<div class="line"><a name="l18243"></a><span class="lineno">18243</span>&#160;                                        $rsstartx += $dl;</div>
<div class="line"><a name="l18244"></a><span class="lineno">18244</span>&#160;                                        $rsendx += $dl;</div>
<div class="line"><a name="l18245"></a><span class="lineno">18245</span>&#160;                                    }</div>
<div class="line"><a name="l18246"></a><span class="lineno">18246</span>&#160;                                }</div>
<div class="line"><a name="l18247"></a><span class="lineno">18247</span>&#160;                                <span class="keywordflow">if</span> (($trwsp[<span class="stringliteral">&#39;rowspan&#39;</span>] &gt; 0)</div>
<div class="line"><a name="l18248"></a><span class="lineno">18248</span>&#160;                                    AND ($rsstartx &gt; ($this-&gt;x - $cellspacing[<span class="charliteral">&#39;H&#39;</span>] - $current_cell_padding[<span class="charliteral">&#39;L&#39;</span>] - $this-&gt;feps))</div>
<div class="line"><a name="l18249"></a><span class="lineno">18249</span>&#160;                                    AND ($rsstartx &lt; ($this-&gt;x + $cellspacing[<span class="charliteral">&#39;H&#39;</span>] + $current_cell_padding[<span class="charliteral">&#39;R&#39;</span>] + $this-&gt;feps))</div>
<div class="line"><a name="l18250"></a><span class="lineno">18250</span>&#160;                                    AND (($trwsp[<span class="stringliteral">&#39;starty&#39;</span>] &lt; ($this-&gt;y - $this-&gt;feps)) OR ($trwsp[<span class="stringliteral">&#39;startpage&#39;</span>] &lt; $this-&gt;page) OR ($trwsp[<span class="stringliteral">&#39;startcolumn&#39;</span>] &lt; $this-&gt;current_column))) {</div>
<div class="line"><a name="l18251"></a><span class="lineno">18251</span>&#160;                                    <span class="comment">// set the starting X position of the current cell</span></div>
<div class="line"><a name="l18252"></a><span class="lineno">18252</span>&#160;                                    $this-&gt;x = $rsendx + $cellspacingx;</div>
<div class="line"><a name="l18253"></a><span class="lineno">18253</span>&#160;                                    <span class="comment">// increment column indicator</span></div>
<div class="line"><a name="l18254"></a><span class="lineno">18254</span>&#160;                                    $colid += $trwsp[<span class="stringliteral">&#39;colspan&#39;</span>];</div>
<div class="line"><a name="l18255"></a><span class="lineno">18255</span>&#160;                                    <span class="keywordflow">if</span> (($trwsp[<span class="stringliteral">&#39;rowspan&#39;</span>] == 1)</div>
<div class="line"><a name="l18256"></a><span class="lineno">18256</span>&#160;                                        AND (isset($dom[$trid][<span class="stringliteral">&#39;endy&#39;</span>]))</div>
<div class="line"><a name="l18257"></a><span class="lineno">18257</span>&#160;                                        AND (isset($dom[$trid][<span class="stringliteral">&#39;endpage&#39;</span>]))</div>
<div class="line"><a name="l18258"></a><span class="lineno">18258</span>&#160;                                        AND (isset($dom[$trid][<span class="stringliteral">&#39;endcolumn&#39;</span>]))</div>
<div class="line"><a name="l18259"></a><span class="lineno">18259</span>&#160;                                        AND ($trwsp[<span class="stringliteral">&#39;endpage&#39;</span>] == $dom[$trid][<span class="stringliteral">&#39;endpage&#39;</span>])</div>
<div class="line"><a name="l18260"></a><span class="lineno">18260</span>&#160;                                        AND ($trwsp[<span class="stringliteral">&#39;endcolumn&#39;</span>] == $dom[$trid][<span class="stringliteral">&#39;endcolumn&#39;</span>])) {</div>
<div class="line"><a name="l18261"></a><span class="lineno">18261</span>&#160;                                        <span class="comment">// set ending Y position for row</span></div>
<div class="line"><a name="l18262"></a><span class="lineno">18262</span>&#160;                                        $dom[$table_el][<span class="stringliteral">&#39;rowspans&#39;</span>][$rsk][<span class="stringliteral">&#39;endy&#39;</span>] = max($dom[$trid][<span class="stringliteral">&#39;endy&#39;</span>], $trwsp[<span class="stringliteral">&#39;endy&#39;</span>]);</div>
<div class="line"><a name="l18263"></a><span class="lineno">18263</span>&#160;                                        $dom[$trid][<span class="stringliteral">&#39;endy&#39;</span>] = $dom[$table_el][<span class="stringliteral">&#39;rowspans&#39;</span>][$rsk][<span class="stringliteral">&#39;endy&#39;</span>];</div>
<div class="line"><a name="l18264"></a><span class="lineno">18264</span>&#160;                                    }</div>
<div class="line"><a name="l18265"></a><span class="lineno">18265</span>&#160;                                    $rsk = 0;</div>
<div class="line"><a name="l18266"></a><span class="lineno">18266</span>&#160;                                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18267"></a><span class="lineno">18267</span>&#160;                                    ++$rsk;</div>
<div class="line"><a name="l18268"></a><span class="lineno">18268</span>&#160;                                }</div>
<div class="line"><a name="l18269"></a><span class="lineno">18269</span>&#160;                            }</div>
<div class="line"><a name="l18270"></a><span class="lineno">18270</span>&#160;                        }</div>
<div class="line"><a name="l18271"></a><span class="lineno">18271</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[$parentid][<span class="stringliteral">&#39;width&#39;</span>])) {</div>
<div class="line"><a name="l18272"></a><span class="lineno">18272</span>&#160;                            <span class="comment">// user specified width</span></div>
<div class="line"><a name="l18273"></a><span class="lineno">18273</span>&#160;                            $cellw = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9">getHTMLUnitToUnits</a>($dom[$parentid][<span class="stringliteral">&#39;width&#39;</span>], $table_columns_width, <span class="stringliteral">&#39;px&#39;</span>);</div>
<div class="line"><a name="l18274"></a><span class="lineno">18274</span>&#160;                            $tmpcw = ($cellw / $colspan);</div>
<div class="line"><a name="l18275"></a><span class="lineno">18275</span>&#160;                            <span class="keywordflow">for</span> ($i = 0; $i &lt; $colspan; ++$i) {</div>
<div class="line"><a name="l18276"></a><span class="lineno">18276</span>&#160;                                $table_colwidths[($colid + $i)] = $tmpcw;</div>
<div class="line"><a name="l18277"></a><span class="lineno">18277</span>&#160;                            }</div>
<div class="line"><a name="l18278"></a><span class="lineno">18278</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18279"></a><span class="lineno">18279</span>&#160;                            <span class="comment">// inherit column width</span></div>
<div class="line"><a name="l18280"></a><span class="lineno">18280</span>&#160;                            $cellw = 0;</div>
<div class="line"><a name="l18281"></a><span class="lineno">18281</span>&#160;                            <span class="keywordflow">for</span> ($i = 0; $i &lt; $colspan; ++$i) {</div>
<div class="line"><a name="l18282"></a><span class="lineno">18282</span>&#160;                                $cellw += $table_colwidths[($colid + $i)];</div>
<div class="line"><a name="l18283"></a><span class="lineno">18283</span>&#160;                            }</div>
<div class="line"><a name="l18284"></a><span class="lineno">18284</span>&#160;                        }</div>
<div class="line"><a name="l18285"></a><span class="lineno">18285</span>&#160;                        $cellw += (($colspan - 1) * $cellspacing[<span class="charliteral">&#39;H&#39;</span>]);</div>
<div class="line"><a name="l18286"></a><span class="lineno">18286</span>&#160;                        <span class="comment">// increment column indicator</span></div>
<div class="line"><a name="l18287"></a><span class="lineno">18287</span>&#160;                        $colid += $colspan;</div>
<div class="line"><a name="l18288"></a><span class="lineno">18288</span>&#160;                        <span class="comment">// add rowspan information to table element</span></div>
<div class="line"><a name="l18289"></a><span class="lineno">18289</span>&#160;                        <span class="keywordflow">if</span> ($rowspan &gt; 1) {</div>
<div class="line"><a name="l18290"></a><span class="lineno">18290</span>&#160;                            $trsid = array_push($dom[$table_el][<span class="stringliteral">&#39;rowspans&#39;</span>], array(<span class="stringliteral">&#39;trid&#39;</span> =&gt; $trid, <span class="stringliteral">&#39;rowspan&#39;</span> =&gt; $rowspan, <span class="stringliteral">&#39;mrowspan&#39;</span> =&gt; $rowspan, <span class="stringliteral">&#39;colspan&#39;</span> =&gt; $colspan, <span class="stringliteral">&#39;startpage&#39;</span> =&gt; $this-&gt;page, <span class="stringliteral">&#39;startcolumn&#39;</span> =&gt; $this-&gt;current_column, <span class="stringliteral">&#39;startx&#39;</span> =&gt; $this-&gt;x, <span class="stringliteral">&#39;starty&#39;</span> =&gt; $this-&gt;y));</div>
<div class="line"><a name="l18291"></a><span class="lineno">18291</span>&#160;                        }</div>
<div class="line"><a name="l18292"></a><span class="lineno">18292</span>&#160;                        $cellid = array_push($dom[$trid][<span class="stringliteral">&#39;cellpos&#39;</span>], array(<span class="stringliteral">&#39;startx&#39;</span> =&gt; $this-&gt;x));</div>
<div class="line"><a name="l18293"></a><span class="lineno">18293</span>&#160;                        <span class="keywordflow">if</span> ($rowspan &gt; 1) {</div>
<div class="line"><a name="l18294"></a><span class="lineno">18294</span>&#160;                            $dom[$trid][<span class="stringliteral">&#39;cellpos&#39;</span>][($cellid - 1)][<span class="stringliteral">&#39;rowspanid&#39;</span>] = ($trsid - 1);</div>
<div class="line"><a name="l18295"></a><span class="lineno">18295</span>&#160;                        }</div>
<div class="line"><a name="l18296"></a><span class="lineno">18296</span>&#160;                        <span class="comment">// push background colors</span></div>
<div class="line"><a name="l18297"></a><span class="lineno">18297</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[$parentid][<span class="stringliteral">&#39;bgcolor&#39;</span>]) AND ($dom[$parentid][<span class="stringliteral">&#39;bgcolor&#39;</span>] !== <span class="keyword">false</span>)) {</div>
<div class="line"><a name="l18298"></a><span class="lineno">18298</span>&#160;                            $dom[$trid][<span class="stringliteral">&#39;cellpos&#39;</span>][($cellid - 1)][<span class="stringliteral">&#39;bgcolor&#39;</span>] = $dom[$parentid][<span class="stringliteral">&#39;bgcolor&#39;</span>];</div>
<div class="line"><a name="l18299"></a><span class="lineno">18299</span>&#160;                        }</div>
<div class="line"><a name="l18300"></a><span class="lineno">18300</span>&#160;                        <span class="comment">// store border info</span></div>
<div class="line"><a name="l18301"></a><span class="lineno">18301</span>&#160;                        <span class="keywordflow">if</span> (isset($tdborder) AND !empty($tdborder)) {</div>
<div class="line"><a name="l18302"></a><span class="lineno">18302</span>&#160;                            $dom[$trid][<span class="stringliteral">&#39;cellpos&#39;</span>][($cellid - 1)][<span class="stringliteral">&#39;border&#39;</span>] = $tdborder;</div>
<div class="line"><a name="l18303"></a><span class="lineno">18303</span>&#160;                        }</div>
<div class="line"><a name="l18304"></a><span class="lineno">18304</span>&#160;                        $prevLastH = <a class="code" href="../../d4/d40/classTCPDF.html#a41e87b05a84dd56c2c824af49470e295">$this-&gt;lasth</a>;</div>
<div class="line"><a name="l18305"></a><span class="lineno">18305</span>&#160;                        <span class="comment">// store some info for multicolumn mode</span></div>
<div class="line"><a name="l18306"></a><span class="lineno">18306</span>&#160;                        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l18307"></a><span class="lineno">18307</span>&#160;                            $this-&gt;colxshift[<span class="charliteral">&#39;x&#39;</span>] = $this-&gt;w - $this-&gt;x - <a class="code" href="../../d4/d40/classTCPDF.html#a44fb75b85bea40ced25fdea9d89dc8e9">$this-&gt;rMargin</a>;</div>
<div class="line"><a name="l18308"></a><span class="lineno">18308</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18309"></a><span class="lineno">18309</span>&#160;                            $this-&gt;colxshift[<span class="charliteral">&#39;x&#39;</span>] = $this-&gt;x - <a class="code" href="../../d4/d40/classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da">$this-&gt;lMargin</a>;</div>
<div class="line"><a name="l18310"></a><span class="lineno">18310</span>&#160;                        }</div>
<div class="line"><a name="l18311"></a><span class="lineno">18311</span>&#160;                        $this-&gt;colxshift[<span class="charliteral">&#39;s&#39;</span>] = $cellspacing;</div>
<div class="line"><a name="l18312"></a><span class="lineno">18312</span>&#160;                        $this-&gt;colxshift[<span class="charliteral">&#39;p&#39;</span>] = $current_cell_padding;</div>
<div class="line"><a name="l18313"></a><span class="lineno">18313</span>&#160;                        <span class="comment">// ****** write the cell content ******</span></div>
<div class="line"><a name="l18314"></a><span class="lineno">18314</span>&#160;                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa81d4b585de305c054760ec983ed3ece">MultiCell</a>($cellw, $cellh, $cell_content, <span class="keyword">false</span>, $lalign, <span class="keyword">false</span>, 2, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">true</span>, 0, <span class="keyword">true</span>, <span class="keyword">true</span>, 0, <span class="charliteral">&#39;T&#39;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l18315"></a><span class="lineno">18315</span>&#160;                        <span class="comment">// restore some values</span></div>
<div class="line"><a name="l18316"></a><span class="lineno">18316</span>&#160;                        $this-&gt;colxshift = array(<span class="charliteral">&#39;x&#39;</span> =&gt; 0, <span class="charliteral">&#39;s&#39;</span> =&gt; array(<span class="charliteral">&#39;H&#39;</span> =&gt; 0, <span class="charliteral">&#39;V&#39;</span> =&gt; 0), <span class="charliteral">&#39;p&#39;</span> =&gt; array(<span class="charliteral">&#39;L&#39;</span> =&gt; 0, <span class="charliteral">&#39;T&#39;</span> =&gt; 0, <span class="charliteral">&#39;R&#39;</span> =&gt; 0, <span class="charliteral">&#39;B&#39;</span> =&gt; 0));</div>
<div class="line"><a name="l18317"></a><span class="lineno">18317</span>&#160;                        $this-&gt;lasth = $prevLastH;</div>
<div class="line"><a name="l18318"></a><span class="lineno">18318</span>&#160;                        $this-&gt;cell_padding = $old_cell_padding;</div>
<div class="line"><a name="l18319"></a><span class="lineno">18319</span>&#160;                        $dom[$trid][<span class="stringliteral">&#39;cellpos&#39;</span>][($cellid - 1)][<span class="stringliteral">&#39;endx&#39;</span>] = $this-&gt;x;</div>
<div class="line"><a name="l18320"></a><span class="lineno">18320</span>&#160;                        <span class="comment">// update the end of row position</span></div>
<div class="line"><a name="l18321"></a><span class="lineno">18321</span>&#160;                        <span class="keywordflow">if</span> ($rowspan &lt;= 1) {</div>
<div class="line"><a name="l18322"></a><span class="lineno">18322</span>&#160;                            <span class="keywordflow">if</span> (isset($dom[$trid][<span class="stringliteral">&#39;endy&#39;</span>])) {</div>
<div class="line"><a name="l18323"></a><span class="lineno">18323</span>&#160;                                <span class="keywordflow">if</span> (($this-&gt;page == $dom[$trid][<span class="stringliteral">&#39;endpage&#39;</span>]) AND ($this-&gt;current_column == $dom[$trid][<span class="stringliteral">&#39;endcolumn&#39;</span>])) {</div>
<div class="line"><a name="l18324"></a><span class="lineno">18324</span>&#160;                                    $dom[$trid][<span class="stringliteral">&#39;endy&#39;</span>] = max($this-&gt;y, $dom[$trid][<span class="stringliteral">&#39;endy&#39;</span>]);</div>
<div class="line"><a name="l18325"></a><span class="lineno">18325</span>&#160;                                } elseif (($this-&gt;page &gt; $dom[$trid][<span class="stringliteral">&#39;endpage&#39;</span>]) OR ($this-&gt;current_column &gt; $dom[$trid][<span class="stringliteral">&#39;endcolumn&#39;</span>])) {</div>
<div class="line"><a name="l18326"></a><span class="lineno">18326</span>&#160;                                    $dom[$trid][<span class="stringliteral">&#39;endy&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l18327"></a><span class="lineno">18327</span>&#160;                                }</div>
<div class="line"><a name="l18328"></a><span class="lineno">18328</span>&#160;                            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18329"></a><span class="lineno">18329</span>&#160;                                $dom[$trid][<span class="stringliteral">&#39;endy&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l18330"></a><span class="lineno">18330</span>&#160;                            }</div>
<div class="line"><a name="l18331"></a><span class="lineno">18331</span>&#160;                            <span class="keywordflow">if</span> (isset($dom[$trid][<span class="stringliteral">&#39;endpage&#39;</span>])) {</div>
<div class="line"><a name="l18332"></a><span class="lineno">18332</span>&#160;                                $dom[$trid][<span class="stringliteral">&#39;endpage&#39;</span>] = max($this-&gt;page, $dom[$trid][<span class="stringliteral">&#39;endpage&#39;</span>]);</div>
<div class="line"><a name="l18333"></a><span class="lineno">18333</span>&#160;                            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18334"></a><span class="lineno">18334</span>&#160;                                $dom[$trid][<span class="stringliteral">&#39;endpage&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>;</div>
<div class="line"><a name="l18335"></a><span class="lineno">18335</span>&#160;                            }</div>
<div class="line"><a name="l18336"></a><span class="lineno">18336</span>&#160;                            <span class="keywordflow">if</span> (isset($dom[$trid][<span class="stringliteral">&#39;endcolumn&#39;</span>])) {</div>
<div class="line"><a name="l18337"></a><span class="lineno">18337</span>&#160;                                $dom[$trid][<span class="stringliteral">&#39;endcolumn&#39;</span>] = max($this-&gt;current_column, $dom[$trid][<span class="stringliteral">&#39;endcolumn&#39;</span>]);</div>
<div class="line"><a name="l18338"></a><span class="lineno">18338</span>&#160;                            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18339"></a><span class="lineno">18339</span>&#160;                                $dom[$trid][<span class="stringliteral">&#39;endcolumn&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#aab81c25eefaf486adf004eb20bc22881">$this-&gt;current_column</a>;</div>
<div class="line"><a name="l18340"></a><span class="lineno">18340</span>&#160;                            }</div>
<div class="line"><a name="l18341"></a><span class="lineno">18341</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18342"></a><span class="lineno">18342</span>&#160;                            <span class="comment">// account for row-spanned cells</span></div>
<div class="line"><a name="l18343"></a><span class="lineno">18343</span>&#160;                            $dom[$table_el][<span class="stringliteral">&#39;rowspans&#39;</span>][($trsid - 1)][<span class="stringliteral">&#39;endx&#39;</span>] = $this-&gt;x;</div>
<div class="line"><a name="l18344"></a><span class="lineno">18344</span>&#160;                            $dom[$table_el][<span class="stringliteral">&#39;rowspans&#39;</span>][($trsid - 1)][<span class="stringliteral">&#39;endy&#39;</span>] = $this-&gt;y;</div>
<div class="line"><a name="l18345"></a><span class="lineno">18345</span>&#160;                            $dom[$table_el][<span class="stringliteral">&#39;rowspans&#39;</span>][($trsid - 1)][<span class="stringliteral">&#39;endpage&#39;</span>] = $this-&gt;page;</div>
<div class="line"><a name="l18346"></a><span class="lineno">18346</span>&#160;                            $dom[$table_el][<span class="stringliteral">&#39;rowspans&#39;</span>][($trsid - 1)][<span class="stringliteral">&#39;endcolumn&#39;</span>] = $this-&gt;current_column;</div>
<div class="line"><a name="l18347"></a><span class="lineno">18347</span>&#160;                        }</div>
<div class="line"><a name="l18348"></a><span class="lineno">18348</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[$table_el][<span class="stringliteral">&#39;rowspans&#39;</span>])) {</div>
<div class="line"><a name="l18349"></a><span class="lineno">18349</span>&#160;                            <span class="comment">// update endy and endpage on rowspanned cells</span></div>
<div class="line"><a name="l18350"></a><span class="lineno">18350</span>&#160;                            <span class="keywordflow">foreach</span> ($dom[$table_el][<span class="stringliteral">&#39;rowspans&#39;</span>] as <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a> =&gt; $trwsp) {</div>
<div class="line"><a name="l18351"></a><span class="lineno">18351</span>&#160;                                <span class="keywordflow">if</span> ($trwsp[<span class="stringliteral">&#39;rowspan&#39;</span>] &gt; 0) {</div>
<div class="line"><a name="l18352"></a><span class="lineno">18352</span>&#160;                                    <span class="keywordflow">if</span> (isset($dom[$trid][<span class="stringliteral">&#39;endpage&#39;</span>])) {</div>
<div class="line"><a name="l18353"></a><span class="lineno">18353</span>&#160;                                        <span class="keywordflow">if</span> (($trwsp[<span class="stringliteral">&#39;endpage&#39;</span>] == $dom[$trid][<span class="stringliteral">&#39;endpage&#39;</span>]) AND ($trwsp[<span class="stringliteral">&#39;endcolumn&#39;</span>] == $dom[$trid][<span class="stringliteral">&#39;endcolumn&#39;</span>])) {</div>
<div class="line"><a name="l18354"></a><span class="lineno">18354</span>&#160;                                            $dom[$table_el][<span class="stringliteral">&#39;rowspans&#39;</span>][<a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a>][<span class="stringliteral">&#39;endy&#39;</span>] = max($dom[$trid][<span class="stringliteral">&#39;endy&#39;</span>], $trwsp[<span class="stringliteral">&#39;endy&#39;</span>]);</div>
<div class="line"><a name="l18355"></a><span class="lineno">18355</span>&#160;                                        } elseif (($trwsp[<span class="stringliteral">&#39;endpage&#39;</span>] &lt; $dom[$trid][<span class="stringliteral">&#39;endpage&#39;</span>]) OR ($trwsp[<span class="stringliteral">&#39;endcolumn&#39;</span>] &lt; $dom[$trid][<span class="stringliteral">&#39;endcolumn&#39;</span>])) {</div>
<div class="line"><a name="l18356"></a><span class="lineno">18356</span>&#160;                                            $dom[$table_el][<span class="stringliteral">&#39;rowspans&#39;</span>][<a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a>][<span class="stringliteral">&#39;endy&#39;</span>] = $dom[$trid][<span class="stringliteral">&#39;endy&#39;</span>];</div>
<div class="line"><a name="l18357"></a><span class="lineno">18357</span>&#160;                                            $dom[$table_el][<span class="stringliteral">&#39;rowspans&#39;</span>][<a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a>][<span class="stringliteral">&#39;endpage&#39;</span>] = $dom[$trid][<span class="stringliteral">&#39;endpage&#39;</span>];</div>
<div class="line"><a name="l18358"></a><span class="lineno">18358</span>&#160;                                            $dom[$table_el][<span class="stringliteral">&#39;rowspans&#39;</span>][<a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$k</a>][<span class="stringliteral">&#39;endcolumn&#39;</span>] = $dom[$trid][<span class="stringliteral">&#39;endcolumn&#39;</span>];</div>
<div class="line"><a name="l18359"></a><span class="lineno">18359</span>&#160;                                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18360"></a><span class="lineno">18360</span>&#160;                                            $dom[$trid][<span class="stringliteral">&#39;endy&#39;</span>] = $this-&gt;pagedim[$dom[$trid][<span class="stringliteral">&#39;endpage&#39;</span>]][<span class="stringliteral">&#39;hk&#39;</span>] - $this-&gt;pagedim[$dom[$trid][<span class="stringliteral">&#39;endpage&#39;</span>]][<span class="stringliteral">&#39;bm&#39;</span>];</div>
<div class="line"><a name="l18361"></a><span class="lineno">18361</span>&#160;                                        }</div>
<div class="line"><a name="l18362"></a><span class="lineno">18362</span>&#160;                                    }</div>
<div class="line"><a name="l18363"></a><span class="lineno">18363</span>&#160;                                }</div>
<div class="line"><a name="l18364"></a><span class="lineno">18364</span>&#160;                            }</div>
<div class="line"><a name="l18365"></a><span class="lineno">18365</span>&#160;                        }</div>
<div class="line"><a name="l18366"></a><span class="lineno">18366</span>&#160;                        $this-&gt;x += ($cellspacingx / 2);</div>
<div class="line"><a name="l18367"></a><span class="lineno">18367</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18368"></a><span class="lineno">18368</span>&#160;                        <span class="comment">// opening tag (or self-closing tag)</span></div>
<div class="line"><a name="l18369"></a><span class="lineno">18369</span>&#160;                        <span class="keywordflow">if</span> (!isset($opentagpos)) {</div>
<div class="line"><a name="l18370"></a><span class="lineno">18370</span>&#160;                            <span class="keywordflow">if</span> ($this-&gt;inxobj) {</div>
<div class="line"><a name="l18371"></a><span class="lineno">18371</span>&#160;                                <span class="comment">// we are inside an XObject template</span></div>
<div class="line"><a name="l18372"></a><span class="lineno">18372</span>&#160;                                $opentagpos = strlen($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;outdata&#39;</span>]);</div>
<div class="line"><a name="l18373"></a><span class="lineno">18373</span>&#160;                            } elseif (!$this-&gt;InFooter) {</div>
<div class="line"><a name="l18374"></a><span class="lineno">18374</span>&#160;                                <span class="keywordflow">if</span> (isset($this-&gt;footerlen[$this-&gt;page])) {</div>
<div class="line"><a name="l18375"></a><span class="lineno">18375</span>&#160;                                    $this-&gt;footerpos[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>] = $this-&gt;pagelen[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>] - $this-&gt;footerlen[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>];</div>
<div class="line"><a name="l18376"></a><span class="lineno">18376</span>&#160;                                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18377"></a><span class="lineno">18377</span>&#160;                                    $this-&gt;footerpos[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>] = $this-&gt;pagelen[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>];</div>
<div class="line"><a name="l18378"></a><span class="lineno">18378</span>&#160;                                }</div>
<div class="line"><a name="l18379"></a><span class="lineno">18379</span>&#160;                                $opentagpos = $this-&gt;footerpos[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>];</div>
<div class="line"><a name="l18380"></a><span class="lineno">18380</span>&#160;                            }</div>
<div class="line"><a name="l18381"></a><span class="lineno">18381</span>&#160;                        }</div>
<div class="line"><a name="l18382"></a><span class="lineno">18382</span>&#160;                        $dom = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a1302c5172587123038e0c947b888b6ec">openHTMLTagHandler</a>($dom, $key, $cell);</div>
<div class="line"><a name="l18383"></a><span class="lineno">18383</span>&#160;                    }</div>
<div class="line"><a name="l18384"></a><span class="lineno">18384</span>&#160;                } <span class="keywordflow">else</span> { <span class="comment">// closing tag</span></div>
<div class="line"><a name="l18385"></a><span class="lineno">18385</span>&#160;                    $prev_numpages = <a class="code" href="../../d4/d40/classTCPDF.html#ae5dd5203ba48e26efcb24a6a6cabbb42">$this-&gt;numpages</a>;</div>
<div class="line"><a name="l18386"></a><span class="lineno">18386</span>&#160;                    $old_bordermrk = $this-&gt;bordermrk[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>];</div>
<div class="line"><a name="l18387"></a><span class="lineno">18387</span>&#160;                    $dom = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a52ace3318c0320d4059a1b969cc2eb20">closeHTMLTagHandler</a>($dom, $key, $cell, $maxbottomliney);</div>
<div class="line"><a name="l18388"></a><span class="lineno">18388</span>&#160;                    <span class="keywordflow">if</span> ($this-&gt;bordermrk[$this-&gt;page] &gt; $old_bordermrk) {</div>
<div class="line"><a name="l18389"></a><span class="lineno">18389</span>&#160;                        $startlinepos += ($this-&gt;bordermrk[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>] - $old_bordermrk);</div>
<div class="line"><a name="l18390"></a><span class="lineno">18390</span>&#160;                    }</div>
<div class="line"><a name="l18391"></a><span class="lineno">18391</span>&#160;                    <span class="keywordflow">if</span> ($prev_numpages &gt; $this-&gt;numpages) {</div>
<div class="line"><a name="l18392"></a><span class="lineno">18392</span>&#160;                        $startlinepage = <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>;</div>
<div class="line"><a name="l18393"></a><span class="lineno">18393</span>&#160;                    }</div>
<div class="line"><a name="l18394"></a><span class="lineno">18394</span>&#160;                }</div>
<div class="line"><a name="l18395"></a><span class="lineno">18395</span>&#160;            } elseif (strlen($dom[$key][<span class="stringliteral">&#39;value&#39;</span>]) &gt; 0) {</div>
<div class="line"><a name="l18396"></a><span class="lineno">18396</span>&#160;                <span class="comment">// print list-item</span></div>
<div class="line"><a name="l18397"></a><span class="lineno">18397</span>&#160;                <span class="keywordflow">if</span> (!TCPDF_STATIC::empty_string($this-&gt;lispacer) AND ($this-&gt;lispacer != <span class="charliteral">&#39;^&#39;</span>)) {</div>
<div class="line"><a name="l18398"></a><span class="lineno">18398</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#afd56e360c43553830d543323e81bc045">SetFont</a>($pfontname, $pfontstyle, $pfontsize);</div>
<div class="line"><a name="l18399"></a><span class="lineno">18399</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a10215105777b306528a827f3669e936e">resetLastH</a>();</div>
<div class="line"><a name="l18400"></a><span class="lineno">18400</span>&#160;                    $minstartliney = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l18401"></a><span class="lineno">18401</span>&#160;                    $maxbottomliney = ($startliney + $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a25c7f71b3fcb19024497ea620f885346">getCellHeight</a>($this-&gt;FontSize));</div>
<div class="line"><a name="l18402"></a><span class="lineno">18402</span>&#160;                    <span class="keywordflow">if</span> (is_numeric($pfontsize) AND ($pfontsize &gt; 0)) {</div>
<div class="line"><a name="l18403"></a><span class="lineno">18403</span>&#160;                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a2e2600620c41132dda5479a902374b5c">putHtmlListBullet</a>($this-&gt;listnum, $this-&gt;lispacer, $pfontsize);</div>
<div class="line"><a name="l18404"></a><span class="lineno">18404</span>&#160;                    }</div>
<div class="line"><a name="l18405"></a><span class="lineno">18405</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#afd56e360c43553830d543323e81bc045">SetFont</a>($curfontname, $curfontstyle, $curfontsize);</div>
<div class="line"><a name="l18406"></a><span class="lineno">18406</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a10215105777b306528a827f3669e936e">resetLastH</a>();</div>
<div class="line"><a name="l18407"></a><span class="lineno">18407</span>&#160;                    <span class="keywordflow">if</span> (is_numeric($pfontsize) AND ($pfontsize &gt; 0) AND is_numeric($curfontsize) AND ($curfontsize &gt; 0) AND ($pfontsize != $curfontsize)) {</div>
<div class="line"><a name="l18408"></a><span class="lineno">18408</span>&#160;                        $pfontascent = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#acf41c6c04c29e1323bb270fdea6b5a9f">getFontAscent</a>($pfontname, $pfontstyle, $pfontsize);</div>
<div class="line"><a name="l18409"></a><span class="lineno">18409</span>&#160;                        $pfontdescent = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a0c8374150dbc8ca092618ca430713f70">getFontDescent</a>($pfontname, $pfontstyle, $pfontsize);</div>
<div class="line"><a name="l18410"></a><span class="lineno">18410</span>&#160;                        $this-&gt;y += ($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a25c7f71b3fcb19024497ea620f885346">getCellHeight</a>(($pfontsize - $curfontsize) / $this-&gt;k) + $pfontascent - $curfontascent - $pfontdescent + $curfontdescent) / 2;</div>
<div class="line"><a name="l18411"></a><span class="lineno">18411</span>&#160;                        $minstartliney = min($this-&gt;y, $minstartliney);</div>
<div class="line"><a name="l18412"></a><span class="lineno">18412</span>&#160;                        $maxbottomliney = max(($this-&gt;y + $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a25c7f71b3fcb19024497ea620f885346">getCellHeight</a>($pfontsize / $this-&gt;k)), $maxbottomliney);</div>
<div class="line"><a name="l18413"></a><span class="lineno">18413</span>&#160;                    }</div>
<div class="line"><a name="l18414"></a><span class="lineno">18414</span>&#160;                }</div>
<div class="line"><a name="l18415"></a><span class="lineno">18415</span>&#160;                <span class="comment">// text</span></div>
<div class="line"><a name="l18416"></a><span class="lineno">18416</span>&#160;                $this-&gt;htmlvspace = 0;</div>
<div class="line"><a name="l18417"></a><span class="lineno">18417</span>&#160;                <span class="keywordflow">if</span> ((!$this-&gt;premode) AND $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#accba6f1471acb211de74e6b34107041d">isRTLTextDir</a>()) {</div>
<div class="line"><a name="l18418"></a><span class="lineno">18418</span>&#160;                    <span class="comment">// reverse spaces order</span></div>
<div class="line"><a name="l18419"></a><span class="lineno">18419</span>&#160;                    $lsp = <span class="stringliteral">&#39;&#39;</span>; <span class="comment">// left spaces</span></div>
<div class="line"><a name="l18420"></a><span class="lineno">18420</span>&#160;                    $rsp = <span class="stringliteral">&#39;&#39;</span>; <span class="comment">// right spaces</span></div>
<div class="line"><a name="l18421"></a><span class="lineno">18421</span>&#160;                    <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/^(&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;p&#39;</span>].<span class="stringliteral">&#39;+)/&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;m&#39;</span>], $dom[$key][<span class="stringliteral">&#39;value&#39;</span>], $matches)) {</div>
<div class="line"><a name="l18422"></a><span class="lineno">18422</span>&#160;                        $lsp = $matches[1];</div>
<div class="line"><a name="l18423"></a><span class="lineno">18423</span>&#160;                    }</div>
<div class="line"><a name="l18424"></a><span class="lineno">18424</span>&#160;                    <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/(&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;p&#39;</span>].<span class="stringliteral">&#39;+)$/&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;m&#39;</span>], $dom[$key][<span class="stringliteral">&#39;value&#39;</span>], $matches)) {</div>
<div class="line"><a name="l18425"></a><span class="lineno">18425</span>&#160;                        $rsp = $matches[1];</div>
<div class="line"><a name="l18426"></a><span class="lineno">18426</span>&#160;                    }</div>
<div class="line"><a name="l18427"></a><span class="lineno">18427</span>&#160;                    $dom[$key][<span class="stringliteral">&#39;value&#39;</span>] = $rsp.$this-&gt;stringTrim($dom[$key][<span class="stringliteral">&#39;value&#39;</span>]).$lsp;</div>
<div class="line"><a name="l18428"></a><span class="lineno">18428</span>&#160;                }</div>
<div class="line"><a name="l18429"></a><span class="lineno">18429</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="../../d4/d40/classTCPDF.html#a505b4eabece70b8679ebdeb86964b798">$newline</a>) {</div>
<div class="line"><a name="l18430"></a><span class="lineno">18430</span>&#160;                    <span class="keywordflow">if</span> (!$this-&gt;premode) {</div>
<div class="line"><a name="l18431"></a><span class="lineno">18431</span>&#160;                        $prelen = strlen($dom[$key][<span class="stringliteral">&#39;value&#39;</span>]);</div>
<div class="line"><a name="l18432"></a><span class="lineno">18432</span>&#160;                        <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#accba6f1471acb211de74e6b34107041d">isRTLTextDir</a>()) {</div>
<div class="line"><a name="l18433"></a><span class="lineno">18433</span>&#160;                            <span class="comment">// right trim except non-breaking space</span></div>
<div class="line"><a name="l18434"></a><span class="lineno">18434</span>&#160;                            $dom[$key][<span class="stringliteral">&#39;value&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa198175b5bdc3ed8663efa6b5286a74a">stringRightTrim</a>($dom[$key][<span class="stringliteral">&#39;value&#39;</span>]);</div>
<div class="line"><a name="l18435"></a><span class="lineno">18435</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18436"></a><span class="lineno">18436</span>&#160;                            <span class="comment">// left trim except non-breaking space</span></div>
<div class="line"><a name="l18437"></a><span class="lineno">18437</span>&#160;                            $dom[$key][<span class="stringliteral">&#39;value&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a0a25521fa461d9d52aabce5687795650">stringLeftTrim</a>($dom[$key][<span class="stringliteral">&#39;value&#39;</span>]);</div>
<div class="line"><a name="l18438"></a><span class="lineno">18438</span>&#160;                        }</div>
<div class="line"><a name="l18439"></a><span class="lineno">18439</span>&#160;                        $postlen = strlen($dom[$key][<span class="stringliteral">&#39;value&#39;</span>]);</div>
<div class="line"><a name="l18440"></a><span class="lineno">18440</span>&#160;                        <span class="keywordflow">if</span> (($postlen == 0) AND ($prelen &gt; 0)) {</div>
<div class="line"><a name="l18441"></a><span class="lineno">18441</span>&#160;                            $dom[$key][<span class="stringliteral">&#39;trimmed_space&#39;</span>] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l18442"></a><span class="lineno">18442</span>&#160;                        }</div>
<div class="line"><a name="l18443"></a><span class="lineno">18443</span>&#160;                    }</div>
<div class="line"><a name="l18444"></a><span class="lineno">18444</span>&#160;                    <a class="code" href="../../d4/d40/classTCPDF.html#a505b4eabece70b8679ebdeb86964b798">$newline</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l18445"></a><span class="lineno">18445</span>&#160;                    $firstblock = <span class="keyword">true</span>;</div>
<div class="line"><a name="l18446"></a><span class="lineno">18446</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18447"></a><span class="lineno">18447</span>&#160;                    $firstblock = <span class="keyword">false</span>;</div>
<div class="line"><a name="l18448"></a><span class="lineno">18448</span>&#160;                    <span class="comment">// replace empty multiple spaces string with a single space</span></div>
<div class="line"><a name="l18449"></a><span class="lineno">18449</span>&#160;                    $dom[$key][<span class="stringliteral">&#39;value&#39;</span>] = preg_replace(<span class="stringliteral">&#39;/^&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;p&#39;</span>].<span class="stringliteral">&#39;+$/&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;m&#39;</span>], chr(32), $dom[$key][<span class="stringliteral">&#39;value&#39;</span>]);</div>
<div class="line"><a name="l18450"></a><span class="lineno">18450</span>&#160;                }</div>
<div class="line"><a name="l18451"></a><span class="lineno">18451</span>&#160;                $strrest = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l18452"></a><span class="lineno">18452</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l18453"></a><span class="lineno">18453</span>&#160;                    $this-&gt;x -= <a class="code" href="../../d4/d40/classTCPDF.html#ade9ed50def3b504470fe4f157092e7e2">$this-&gt;textindent</a>;</div>
<div class="line"><a name="l18454"></a><span class="lineno">18454</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18455"></a><span class="lineno">18455</span>&#160;                    $this-&gt;x += <a class="code" href="../../d4/d40/classTCPDF.html#ade9ed50def3b504470fe4f157092e7e2">$this-&gt;textindent</a>;</div>
<div class="line"><a name="l18456"></a><span class="lineno">18456</span>&#160;                }</div>
<div class="line"><a name="l18457"></a><span class="lineno">18457</span>&#160;                <span class="keywordflow">if</span> (!isset($dom[$key][<span class="stringliteral">&#39;trimmed_space&#39;</span>]) OR !$dom[$key][<span class="stringliteral">&#39;trimmed_space&#39;</span>]) {</div>
<div class="line"><a name="l18458"></a><span class="lineno">18458</span>&#160;                    $strlinelen = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8075c1f04b6fbddc957cff786c4b16d9">GetStringWidth</a>($dom[$key][<span class="stringliteral">&#39;value&#39;</span>]);</div>
<div class="line"><a name="l18459"></a><span class="lineno">18459</span>&#160;                    <span class="keywordflow">if</span> (!empty($this-&gt;HREF) AND (isset($this-&gt;HREF[<span class="stringliteral">&#39;url&#39;</span>]))) {</div>
<div class="line"><a name="l18460"></a><span class="lineno">18460</span>&#160;                        <span class="comment">// HTML &lt;a&gt; Link</span></div>
<div class="line"><a name="l18461"></a><span class="lineno">18461</span>&#160;                        $hrefcolor = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l18462"></a><span class="lineno">18462</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;fgcolor&#39;</span>]) AND ($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;fgcolor&#39;</span>] !== <span class="keyword">false</span>)) {</div>
<div class="line"><a name="l18463"></a><span class="lineno">18463</span>&#160;                            $hrefcolor = $dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;fgcolor&#39;</span>];</div>
<div class="line"><a name="l18464"></a><span class="lineno">18464</span>&#160;                        }</div>
<div class="line"><a name="l18465"></a><span class="lineno">18465</span>&#160;                        $hrefstyle = -1;</div>
<div class="line"><a name="l18466"></a><span class="lineno">18466</span>&#160;                        <span class="keywordflow">if</span> (isset($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;fontstyle&#39;</span>]) AND ($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;fontstyle&#39;</span>] !== <span class="keyword">false</span>)) {</div>
<div class="line"><a name="l18467"></a><span class="lineno">18467</span>&#160;                            $hrefstyle = $dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;fontstyle&#39;</span>];</div>
<div class="line"><a name="l18468"></a><span class="lineno">18468</span>&#160;                        }</div>
<div class="line"><a name="l18469"></a><span class="lineno">18469</span>&#160;                        $strrest = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#af26dfbff2e1507f87a2fae64eebe08e1">addHtmlLink</a>($this-&gt;HREF[<span class="stringliteral">&#39;url&#39;</span>], $dom[$key][<span class="stringliteral">&#39;value&#39;</span>], $wfill, <span class="keyword">true</span>, $hrefcolor, $hrefstyle, <span class="keyword">true</span>);</div>
<div class="line"><a name="l18470"></a><span class="lineno">18470</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18471"></a><span class="lineno">18471</span>&#160;                        $wadj = 0; <span class="comment">// space to leave for block continuity</span></div>
<div class="line"><a name="l18472"></a><span class="lineno">18472</span>&#160;                        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l18473"></a><span class="lineno">18473</span>&#160;                            $cwa = ($this-&gt;x - <a class="code" href="../../d4/d40/classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da">$this-&gt;lMargin</a>);</div>
<div class="line"><a name="l18474"></a><span class="lineno">18474</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18475"></a><span class="lineno">18475</span>&#160;                            $cwa = ($this-&gt;w - $this-&gt;rMargin - <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$this-&gt;x</a>);</div>
<div class="line"><a name="l18476"></a><span class="lineno">18476</span>&#160;                        }</div>
<div class="line"><a name="l18477"></a><span class="lineno">18477</span>&#160;                        <span class="keywordflow">if</span> (($strlinelen &lt; $cwa) AND (isset($dom[($key + 1)])) AND ($dom[($key + 1)][<span class="stringliteral">&#39;tag&#39;</span>]) AND (!$dom[($key + 1)][<span class="stringliteral">&#39;block&#39;</span>])) {</div>
<div class="line"><a name="l18478"></a><span class="lineno">18478</span>&#160;                            <span class="comment">// check the next text blocks for continuity</span></div>
<div class="line"><a name="l18479"></a><span class="lineno">18479</span>&#160;                            $nkey = ($key + 1);</div>
<div class="line"><a name="l18480"></a><span class="lineno">18480</span>&#160;                            $write_block = <span class="keyword">true</span>;</div>
<div class="line"><a name="l18481"></a><span class="lineno">18481</span>&#160;                            $same_textdir = <span class="keyword">true</span>;</div>
<div class="line"><a name="l18482"></a><span class="lineno">18482</span>&#160;                            $tmp_fontname = <a class="code" href="../../d4/d40/classTCPDF.html#a642c62438ec9c983283a98d5099ba7ba">$this-&gt;FontFamily</a>;</div>
<div class="line"><a name="l18483"></a><span class="lineno">18483</span>&#160;                            $tmp_fontstyle = <a class="code" href="../../d4/d40/classTCPDF.html#a6fce74bcde6c138d286dce274950dff7">$this-&gt;FontStyle</a>;</div>
<div class="line"><a name="l18484"></a><span class="lineno">18484</span>&#160;                            $tmp_fontsize = <a class="code" href="../../d4/d40/classTCPDF.html#a9a787786c9f1a04f54f1dec622869d4d">$this-&gt;FontSizePt</a>;</div>
<div class="line"><a name="l18485"></a><span class="lineno">18485</span>&#160;                            <span class="keywordflow">while</span> ($write_block AND isset($dom[$nkey])) {</div>
<div class="line"><a name="l18486"></a><span class="lineno">18486</span>&#160;                                <span class="keywordflow">if</span> ($dom[$nkey][<span class="stringliteral">&#39;tag&#39;</span>]) {</div>
<div class="line"><a name="l18487"></a><span class="lineno">18487</span>&#160;                                    <span class="keywordflow">if</span> ($dom[$nkey][<span class="stringliteral">&#39;block&#39;</span>]) {</div>
<div class="line"><a name="l18488"></a><span class="lineno">18488</span>&#160;                                        <span class="comment">// end of block</span></div>
<div class="line"><a name="l18489"></a><span class="lineno">18489</span>&#160;                                        $write_block = <span class="keyword">false</span>;</div>
<div class="line"><a name="l18490"></a><span class="lineno">18490</span>&#160;                                    }</div>
<div class="line"><a name="l18491"></a><span class="lineno">18491</span>&#160;                                    $tmp_fontname = isset($dom[$nkey][<span class="stringliteral">&#39;fontname&#39;</span>]) ? $dom[$nkey][<span class="stringliteral">&#39;fontname&#39;</span>] : <a class="code" href="../../d4/d40/classTCPDF.html#a642c62438ec9c983283a98d5099ba7ba">$this-&gt;FontFamily</a>;</div>
<div class="line"><a name="l18492"></a><span class="lineno">18492</span>&#160;                                    $tmp_fontstyle = isset($dom[$nkey][<span class="stringliteral">&#39;fontstyle&#39;</span>]) ? $dom[$nkey][<span class="stringliteral">&#39;fontstyle&#39;</span>] : <a class="code" href="../../d4/d40/classTCPDF.html#a6fce74bcde6c138d286dce274950dff7">$this-&gt;FontStyle</a>;</div>
<div class="line"><a name="l18493"></a><span class="lineno">18493</span>&#160;                                    $tmp_fontsize = isset($dom[$nkey][<span class="stringliteral">&#39;fontsize&#39;</span>]) ? $dom[$nkey][<span class="stringliteral">&#39;fontsize&#39;</span>] : <a class="code" href="../../d4/d40/classTCPDF.html#a9a787786c9f1a04f54f1dec622869d4d">$this-&gt;FontSizePt</a>;</div>
<div class="line"><a name="l18494"></a><span class="lineno">18494</span>&#160;                                    $same_textdir = ($dom[$nkey][<span class="stringliteral">&#39;dir&#39;</span>] == $dom[$key][<span class="stringliteral">&#39;dir&#39;</span>]);</div>
<div class="line"><a name="l18495"></a><span class="lineno">18495</span>&#160;                                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18496"></a><span class="lineno">18496</span>&#160;                                    $nextstr = TCPDF_STATIC::pregSplit(<span class="charliteral">&#39;/&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;p&#39;</span>].<span class="stringliteral">&#39;+/&#39;</span>, $this-&gt;re_space[<span class="charliteral">&#39;m&#39;</span>], $dom[$nkey][<span class="stringliteral">&#39;value&#39;</span>]);</div>
<div class="line"><a name="l18497"></a><span class="lineno">18497</span>&#160;                                    <span class="keywordflow">if</span> (isset($nextstr[0]) AND $same_textdir) {</div>
<div class="line"><a name="l18498"></a><span class="lineno">18498</span>&#160;                                        $wadj += $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8075c1f04b6fbddc957cff786c4b16d9">GetStringWidth</a>($nextstr[0], $tmp_fontname, $tmp_fontstyle, $tmp_fontsize);</div>
<div class="line"><a name="l18499"></a><span class="lineno">18499</span>&#160;                                        <span class="keywordflow">if</span> (isset($nextstr[1])) {</div>
<div class="line"><a name="l18500"></a><span class="lineno">18500</span>&#160;                                            $write_block = <span class="keyword">false</span>;</div>
<div class="line"><a name="l18501"></a><span class="lineno">18501</span>&#160;                                        }</div>
<div class="line"><a name="l18502"></a><span class="lineno">18502</span>&#160;                                    }</div>
<div class="line"><a name="l18503"></a><span class="lineno">18503</span>&#160;                                }</div>
<div class="line"><a name="l18504"></a><span class="lineno">18504</span>&#160;                                ++$nkey;</div>
<div class="line"><a name="l18505"></a><span class="lineno">18505</span>&#160;                            }</div>
<div class="line"><a name="l18506"></a><span class="lineno">18506</span>&#160;                        }</div>
<div class="line"><a name="l18507"></a><span class="lineno">18507</span>&#160;                        <span class="keywordflow">if</span> (($wadj &gt; 0) AND (($strlinelen + $wadj) &gt;= $cwa)) {</div>
<div class="line"><a name="l18508"></a><span class="lineno">18508</span>&#160;                            $wadj = 0;</div>
<div class="line"><a name="l18509"></a><span class="lineno">18509</span>&#160;                            $nextstr = TCPDF_STATIC::pregSplit(<span class="charliteral">&#39;/&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;p&#39;</span>].<span class="charliteral">&#39;/&#39;</span>, $this-&gt;re_space[<span class="charliteral">&#39;m&#39;</span>], $dom[$key][<span class="stringliteral">&#39;value&#39;</span>]);</div>
<div class="line"><a name="l18510"></a><span class="lineno">18510</span>&#160;                            $numblks = count($nextstr);</div>
<div class="line"><a name="l18511"></a><span class="lineno">18511</span>&#160;                            <span class="keywordflow">if</span> ($numblks &gt; 1) {</div>
<div class="line"><a name="l18512"></a><span class="lineno">18512</span>&#160;                                <span class="comment">// try to split on blank spaces</span></div>
<div class="line"><a name="l18513"></a><span class="lineno">18513</span>&#160;                                $wadj = ($cwa - $strlinelen + $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8075c1f04b6fbddc957cff786c4b16d9">GetStringWidth</a>($nextstr[($numblks - 1)]));</div>
<div class="line"><a name="l18514"></a><span class="lineno">18514</span>&#160;                            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18515"></a><span class="lineno">18515</span>&#160;                                <span class="comment">// set the entire block on new line</span></div>
<div class="line"><a name="l18516"></a><span class="lineno">18516</span>&#160;                                $wadj = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8075c1f04b6fbddc957cff786c4b16d9">GetStringWidth</a>($nextstr[0]);</div>
<div class="line"><a name="l18517"></a><span class="lineno">18517</span>&#160;                            }</div>
<div class="line"><a name="l18518"></a><span class="lineno">18518</span>&#160;                        }</div>
<div class="line"><a name="l18519"></a><span class="lineno">18519</span>&#160;                        <span class="comment">// check for reversed text direction</span></div>
<div class="line"><a name="l18520"></a><span class="lineno">18520</span>&#160;                        <span class="keywordflow">if</span> (($wadj &gt; 0) AND (($this-&gt;rtl AND ($this-&gt;tmprtl === <span class="charliteral">&#39;L&#39;</span>)) OR (!$this-&gt;rtl AND ($this-&gt;tmprtl === <span class="charliteral">&#39;R&#39;</span>)))) {</div>
<div class="line"><a name="l18521"></a><span class="lineno">18521</span>&#160;                            <span class="comment">// LTR text on RTL direction or RTL text on LTR direction</span></div>
<div class="line"><a name="l18522"></a><span class="lineno">18522</span>&#160;                            $reverse_dir = <span class="keyword">true</span>;</div>
<div class="line"><a name="l18523"></a><span class="lineno">18523</span>&#160;                            $this-&gt;rtl = !<a class="code" href="../../d4/d40/classTCPDF.html#a4ccd9d69e0839838b105328953794a40">$this-&gt;rtl</a>;</div>
<div class="line"><a name="l18524"></a><span class="lineno">18524</span>&#160;                            $revshift = ($strlinelen + $wadj + 0.000001); <span class="comment">// add little quantity for rounding problems</span></div>
<div class="line"><a name="l18525"></a><span class="lineno">18525</span>&#160;                            <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l18526"></a><span class="lineno">18526</span>&#160;                                $this-&gt;x += $revshift;</div>
<div class="line"><a name="l18527"></a><span class="lineno">18527</span>&#160;                            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18528"></a><span class="lineno">18528</span>&#160;                                $this-&gt;x -= $revshift;</div>
<div class="line"><a name="l18529"></a><span class="lineno">18529</span>&#160;                            }</div>
<div class="line"><a name="l18530"></a><span class="lineno">18530</span>&#160;                            $xws = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$this-&gt;x</a>;</div>
<div class="line"><a name="l18531"></a><span class="lineno">18531</span>&#160;                        }</div>
<div class="line"><a name="l18532"></a><span class="lineno">18532</span>&#160;                        <span class="comment">// ****** write only until the end of the line and get the rest ******</span></div>
<div class="line"><a name="l18533"></a><span class="lineno">18533</span>&#160;                        $strrest = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a6669ae88090963e9487d0388c7577dc9">Write</a>($this-&gt;lasth, $dom[$key][<span class="stringliteral">&#39;value&#39;</span>], <span class="stringliteral">&#39;&#39;</span>, $wfill, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>, 0, <span class="keyword">true</span>, $firstblock, 0, $wadj);</div>
<div class="line"><a name="l18534"></a><span class="lineno">18534</span>&#160;                        <span class="comment">// restore default direction</span></div>
<div class="line"><a name="l18535"></a><span class="lineno">18535</span>&#160;                        <span class="keywordflow">if</span> ($reverse_dir AND ($wadj == 0)) {</div>
<div class="line"><a name="l18536"></a><span class="lineno">18536</span>&#160;                            $this-&gt;x = $xws;</div>
<div class="line"><a name="l18537"></a><span class="lineno">18537</span>&#160;                            $this-&gt;rtl = !<a class="code" href="../../d4/d40/classTCPDF.html#a4ccd9d69e0839838b105328953794a40">$this-&gt;rtl</a>;</div>
<div class="line"><a name="l18538"></a><span class="lineno">18538</span>&#160;                            $reverse_dir = <span class="keyword">false</span>;</div>
<div class="line"><a name="l18539"></a><span class="lineno">18539</span>&#160;                        }</div>
<div class="line"><a name="l18540"></a><span class="lineno">18540</span>&#160;                    }</div>
<div class="line"><a name="l18541"></a><span class="lineno">18541</span>&#160;                }</div>
<div class="line"><a name="l18542"></a><span class="lineno">18542</span>&#160;                $this-&gt;textindent = 0;</div>
<div class="line"><a name="l18543"></a><span class="lineno">18543</span>&#160;                <span class="keywordflow">if</span> (strlen($strrest) &gt; 0) {</div>
<div class="line"><a name="l18544"></a><span class="lineno">18544</span>&#160;                    <span class="comment">// store the remaining string on the previous $key position</span></div>
<div class="line"><a name="l18545"></a><span class="lineno">18545</span>&#160;                    $this-&gt;newline = <span class="keyword">true</span>;</div>
<div class="line"><a name="l18546"></a><span class="lineno">18546</span>&#160;                    <span class="keywordflow">if</span> ($strrest == $dom[$key][<span class="stringliteral">&#39;value&#39;</span>]) {</div>
<div class="line"><a name="l18547"></a><span class="lineno">18547</span>&#160;                        <span class="comment">// used to avoid infinite loop</span></div>
<div class="line"><a name="l18548"></a><span class="lineno">18548</span>&#160;                        ++$loop;</div>
<div class="line"><a name="l18549"></a><span class="lineno">18549</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18550"></a><span class="lineno">18550</span>&#160;                        $loop = 0;</div>
<div class="line"><a name="l18551"></a><span class="lineno">18551</span>&#160;                    }</div>
<div class="line"><a name="l18552"></a><span class="lineno">18552</span>&#160;                    $dom[$key][<span class="stringliteral">&#39;value&#39;</span>] = $strrest;</div>
<div class="line"><a name="l18553"></a><span class="lineno">18553</span>&#160;                    <span class="keywordflow">if</span> ($cell) {</div>
<div class="line"><a name="l18554"></a><span class="lineno">18554</span>&#160;                        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l18555"></a><span class="lineno">18555</span>&#160;                            $this-&gt;x -= $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>];</div>
<div class="line"><a name="l18556"></a><span class="lineno">18556</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18557"></a><span class="lineno">18557</span>&#160;                            $this-&gt;x += $this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>];</div>
<div class="line"><a name="l18558"></a><span class="lineno">18558</span>&#160;                        }</div>
<div class="line"><a name="l18559"></a><span class="lineno">18559</span>&#160;                    }</div>
<div class="line"><a name="l18560"></a><span class="lineno">18560</span>&#160;                    <span class="keywordflow">if</span> ($loop &lt; 3) {</div>
<div class="line"><a name="l18561"></a><span class="lineno">18561</span>&#160;                        --$key;</div>
<div class="line"><a name="l18562"></a><span class="lineno">18562</span>&#160;                    }</div>
<div class="line"><a name="l18563"></a><span class="lineno">18563</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18564"></a><span class="lineno">18564</span>&#160;                    $loop = 0;</div>
<div class="line"><a name="l18565"></a><span class="lineno">18565</span>&#160;                    <span class="comment">// add the positive font spacing of the last character (if any)</span></div>
<div class="line"><a name="l18566"></a><span class="lineno">18566</span>&#160;                     <span class="keywordflow">if</span> ($this-&gt;font_spacing &gt; 0) {</div>
<div class="line"><a name="l18567"></a><span class="lineno">18567</span>&#160;                        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l18568"></a><span class="lineno">18568</span>&#160;                            $this-&gt;x -= <a class="code" href="../../d4/d40/classTCPDF.html#a3f4d91c3489a2c62b628c347551f7adf">$this-&gt;font_spacing</a>;</div>
<div class="line"><a name="l18569"></a><span class="lineno">18569</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18570"></a><span class="lineno">18570</span>&#160;                            $this-&gt;x += <a class="code" href="../../d4/d40/classTCPDF.html#a3f4d91c3489a2c62b628c347551f7adf">$this-&gt;font_spacing</a>;</div>
<div class="line"><a name="l18571"></a><span class="lineno">18571</span>&#160;                        }</div>
<div class="line"><a name="l18572"></a><span class="lineno">18572</span>&#160;                    }</div>
<div class="line"><a name="l18573"></a><span class="lineno">18573</span>&#160;                }</div>
<div class="line"><a name="l18574"></a><span class="lineno">18574</span>&#160;            }</div>
<div class="line"><a name="l18575"></a><span class="lineno">18575</span>&#160;            ++$key;</div>
<div class="line"><a name="l18576"></a><span class="lineno">18576</span>&#160;            <span class="keywordflow">if</span> (isset($dom[$key][<span class="stringliteral">&#39;tag&#39;</span>]) AND $dom[$key][<span class="stringliteral">&#39;tag&#39;</span>] AND (!isset($dom[$key][<span class="stringliteral">&#39;opening&#39;</span>]) OR !$dom[$key][<span class="stringliteral">&#39;opening&#39;</span>]) AND isset($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;nobr&#39;</span>]) AND ($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;nobr&#39;</span>] == <span class="stringliteral">&#39;true&#39;</span>)) {</div>
<div class="line"><a name="l18577"></a><span class="lineno">18577</span>&#160;                <span class="comment">// check if we are on a new page or on a new column</span></div>
<div class="line"><a name="l18578"></a><span class="lineno">18578</span>&#160;                <span class="keywordflow">if</span> ((!$undo) AND (($this-&gt;y &lt; $this-&gt;start_transaction_y) OR (($dom[$key][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;tr&#39;</span>) AND ($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;endy&#39;</span>] &lt; $this-&gt;start_transaction_y)))) {</div>
<div class="line"><a name="l18579"></a><span class="lineno">18579</span>&#160;                    <span class="comment">// we are on a new page or on a new column and the total object height is less than the available vertical space.</span></div>
<div class="line"><a name="l18580"></a><span class="lineno">18580</span>&#160;                    <span class="comment">// restore previous object</span></div>
<div class="line"><a name="l18581"></a><span class="lineno">18581</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a338034ba746f7c607473207b9caa4e1f">rollbackTransaction</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l18582"></a><span class="lineno">18582</span>&#160;                    <span class="comment">// restore previous values</span></div>
<div class="line"><a name="l18583"></a><span class="lineno">18583</span>&#160;                    <span class="keywordflow">foreach</span> ($this_method_vars as $vkey =&gt; $vval) {</div>
<div class="line"><a name="l18584"></a><span class="lineno">18584</span>&#160;                        $$vkey = $vval;</div>
<div class="line"><a name="l18585"></a><span class="lineno">18585</span>&#160;                    }</div>
<div class="line"><a name="l18586"></a><span class="lineno">18586</span>&#160;                    <span class="keywordflow">if</span> (!empty($dom[$key][<span class="stringliteral">&#39;thead&#39;</span>])) {</div>
<div class="line"><a name="l18587"></a><span class="lineno">18587</span>&#160;                        $this-&gt;inthead = <span class="keyword">true</span>;</div>
<div class="line"><a name="l18588"></a><span class="lineno">18588</span>&#160;                    }</div>
<div class="line"><a name="l18589"></a><span class="lineno">18589</span>&#160;                    <span class="comment">// add a page (or trig AcceptPageBreak() for multicolumn mode)</span></div>
<div class="line"><a name="l18590"></a><span class="lineno">18590</span>&#160;                    $pre_y = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l18591"></a><span class="lineno">18591</span>&#160;                    <span class="keywordflow">if</span> ((!$this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a9e8e4b4d75485b8f1e3aa2133a811e50">checkPageBreak</a>($this-&gt;PageBreakTrigger + 1)) AND ($this-&gt;y &lt; $pre_y)) {</div>
<div class="line"><a name="l18592"></a><span class="lineno">18592</span>&#160;                        $startliney = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l18593"></a><span class="lineno">18593</span>&#160;                    }</div>
<div class="line"><a name="l18594"></a><span class="lineno">18594</span>&#160;                    $undo = <span class="keyword">true</span>; <span class="comment">// avoid infinite loop</span></div>
<div class="line"><a name="l18595"></a><span class="lineno">18595</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18596"></a><span class="lineno">18596</span>&#160;                    $undo = <span class="keyword">false</span>;</div>
<div class="line"><a name="l18597"></a><span class="lineno">18597</span>&#160;                }</div>
<div class="line"><a name="l18598"></a><span class="lineno">18598</span>&#160;            }</div>
<div class="line"><a name="l18599"></a><span class="lineno">18599</span>&#160;        } <span class="comment">// end for each $key</span></div>
<div class="line"><a name="l18600"></a><span class="lineno">18600</span>&#160;        <span class="comment">// align the last line</span></div>
<div class="line"><a name="l18601"></a><span class="lineno">18601</span>&#160;        <span class="keywordflow">if</span> (isset($startlinex)) {</div>
<div class="line"><a name="l18602"></a><span class="lineno">18602</span>&#160;            $yshift = ($minstartliney - $startliney);</div>
<div class="line"><a name="l18603"></a><span class="lineno">18603</span>&#160;            <span class="keywordflow">if</span> (($yshift &gt; 0) OR ($this-&gt;page &gt; $startlinepage)) {</div>
<div class="line"><a name="l18604"></a><span class="lineno">18604</span>&#160;                $yshift = 0;</div>
<div class="line"><a name="l18605"></a><span class="lineno">18605</span>&#160;            }</div>
<div class="line"><a name="l18606"></a><span class="lineno">18606</span>&#160;            $t_x = 0;</div>
<div class="line"><a name="l18607"></a><span class="lineno">18607</span>&#160;            <span class="comment">// the last line must be shifted to be aligned as requested</span></div>
<div class="line"><a name="l18608"></a><span class="lineno">18608</span>&#160;            $linew = abs($this-&gt;endlinex - $startlinex);</div>
<div class="line"><a name="l18609"></a><span class="lineno">18609</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;inxobj) {</div>
<div class="line"><a name="l18610"></a><span class="lineno">18610</span>&#160;                <span class="comment">// we are inside an XObject template</span></div>
<div class="line"><a name="l18611"></a><span class="lineno">18611</span>&#160;                $pstart = substr($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;outdata&#39;</span>], 0, $startlinepos);</div>
<div class="line"><a name="l18612"></a><span class="lineno">18612</span>&#160;                <span class="keywordflow">if</span> (isset($opentagpos)) {</div>
<div class="line"><a name="l18613"></a><span class="lineno">18613</span>&#160;                    $midpos = $opentagpos;</div>
<div class="line"><a name="l18614"></a><span class="lineno">18614</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18615"></a><span class="lineno">18615</span>&#160;                    $midpos = 0;</div>
<div class="line"><a name="l18616"></a><span class="lineno">18616</span>&#160;                }</div>
<div class="line"><a name="l18617"></a><span class="lineno">18617</span>&#160;                <span class="keywordflow">if</span> ($midpos &gt; 0) {</div>
<div class="line"><a name="l18618"></a><span class="lineno">18618</span>&#160;                    $pmid = substr($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;outdata&#39;</span>], $startlinepos, ($midpos - $startlinepos));</div>
<div class="line"><a name="l18619"></a><span class="lineno">18619</span>&#160;                    $pend = substr($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;outdata&#39;</span>], $midpos);</div>
<div class="line"><a name="l18620"></a><span class="lineno">18620</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18621"></a><span class="lineno">18621</span>&#160;                    $pmid = substr($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;outdata&#39;</span>], $startlinepos);</div>
<div class="line"><a name="l18622"></a><span class="lineno">18622</span>&#160;                    $pend = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l18623"></a><span class="lineno">18623</span>&#160;                }</div>
<div class="line"><a name="l18624"></a><span class="lineno">18624</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18625"></a><span class="lineno">18625</span>&#160;                $pstart = substr($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d67b0a8681222f71fa9f9f6e65e0c56">getPageBuffer</a>($startlinepage), 0, $startlinepos);</div>
<div class="line"><a name="l18626"></a><span class="lineno">18626</span>&#160;                <span class="keywordflow">if</span> (isset($opentagpos) AND isset($this-&gt;footerlen[$startlinepage]) AND (!$this-&gt;InFooter)) {</div>
<div class="line"><a name="l18627"></a><span class="lineno">18627</span>&#160;                    $this-&gt;footerpos[$startlinepage] = $this-&gt;pagelen[$startlinepage] - $this-&gt;footerlen[$startlinepage];</div>
<div class="line"><a name="l18628"></a><span class="lineno">18628</span>&#160;                    $midpos = min($opentagpos, $this-&gt;footerpos[$startlinepage]);</div>
<div class="line"><a name="l18629"></a><span class="lineno">18629</span>&#160;                } elseif (isset($opentagpos)) {</div>
<div class="line"><a name="l18630"></a><span class="lineno">18630</span>&#160;                    $midpos = $opentagpos;</div>
<div class="line"><a name="l18631"></a><span class="lineno">18631</span>&#160;                } elseif (isset($this-&gt;footerlen[$startlinepage]) AND (!$this-&gt;InFooter)) {</div>
<div class="line"><a name="l18632"></a><span class="lineno">18632</span>&#160;                    $this-&gt;footerpos[$startlinepage] = $this-&gt;pagelen[$startlinepage] - $this-&gt;footerlen[$startlinepage];</div>
<div class="line"><a name="l18633"></a><span class="lineno">18633</span>&#160;                    $midpos = $this-&gt;footerpos[$startlinepage];</div>
<div class="line"><a name="l18634"></a><span class="lineno">18634</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18635"></a><span class="lineno">18635</span>&#160;                    $midpos = 0;</div>
<div class="line"><a name="l18636"></a><span class="lineno">18636</span>&#160;                }</div>
<div class="line"><a name="l18637"></a><span class="lineno">18637</span>&#160;                <span class="keywordflow">if</span> ($midpos &gt; 0) {</div>
<div class="line"><a name="l18638"></a><span class="lineno">18638</span>&#160;                    $pmid = substr($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d67b0a8681222f71fa9f9f6e65e0c56">getPageBuffer</a>($startlinepage), $startlinepos, ($midpos - $startlinepos));</div>
<div class="line"><a name="l18639"></a><span class="lineno">18639</span>&#160;                    $pend = substr($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d67b0a8681222f71fa9f9f6e65e0c56">getPageBuffer</a>($startlinepage), $midpos);</div>
<div class="line"><a name="l18640"></a><span class="lineno">18640</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18641"></a><span class="lineno">18641</span>&#160;                    $pmid = substr($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d67b0a8681222f71fa9f9f6e65e0c56">getPageBuffer</a>($startlinepage), $startlinepos);</div>
<div class="line"><a name="l18642"></a><span class="lineno">18642</span>&#160;                    $pend = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l18643"></a><span class="lineno">18643</span>&#160;                }</div>
<div class="line"><a name="l18644"></a><span class="lineno">18644</span>&#160;            }</div>
<div class="line"><a name="l18645"></a><span class="lineno">18645</span>&#160;            <span class="keywordflow">if</span> ((isset($plalign) AND ((($plalign == <span class="charliteral">&#39;C&#39;</span>) OR (($plalign == <span class="charliteral">&#39;R&#39;</span>) AND (!$this-&gt;rtl)) OR (($plalign == <span class="charliteral">&#39;L&#39;</span>) AND ($this-&gt;rtl)))))) {</div>
<div class="line"><a name="l18646"></a><span class="lineno">18646</span>&#160;                <span class="comment">// calculate shifting amount</span></div>
<div class="line"><a name="l18647"></a><span class="lineno">18647</span>&#160;                $tw = <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>;</div>
<div class="line"><a name="l18648"></a><span class="lineno">18648</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;lMargin != $prevlMargin) {</div>
<div class="line"><a name="l18649"></a><span class="lineno">18649</span>&#160;                    $tw += ($prevlMargin - <a class="code" href="../../d4/d40/classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da">$this-&gt;lMargin</a>);</div>
<div class="line"><a name="l18650"></a><span class="lineno">18650</span>&#160;                }</div>
<div class="line"><a name="l18651"></a><span class="lineno">18651</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;rMargin != $prevrMargin) {</div>
<div class="line"><a name="l18652"></a><span class="lineno">18652</span>&#160;                    $tw += ($prevrMargin - <a class="code" href="../../d4/d40/classTCPDF.html#a44fb75b85bea40ced25fdea9d89dc8e9">$this-&gt;rMargin</a>);</div>
<div class="line"><a name="l18653"></a><span class="lineno">18653</span>&#160;                }</div>
<div class="line"><a name="l18654"></a><span class="lineno">18654</span>&#160;                $one_space_width = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8075c1f04b6fbddc957cff786c4b16d9">GetStringWidth</a>(chr(32));</div>
<div class="line"><a name="l18655"></a><span class="lineno">18655</span>&#160;                $no = 0; <span class="comment">// number of spaces on a line contained on a single block</span></div>
<div class="line"><a name="l18656"></a><span class="lineno">18656</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#accba6f1471acb211de74e6b34107041d">isRTLTextDir</a>()) { <span class="comment">// RTL</span></div>
<div class="line"><a name="l18657"></a><span class="lineno">18657</span>&#160;                    <span class="comment">// remove left space if exist</span></div>
<div class="line"><a name="l18658"></a><span class="lineno">18658</span>&#160;                    $pos1 = TCPDF_STATIC::revstrpos($pmid, <span class="stringliteral">&#39;[(&#39;</span>);</div>
<div class="line"><a name="l18659"></a><span class="lineno">18659</span>&#160;                    <span class="keywordflow">if</span> ($pos1 &gt; 0) {</div>
<div class="line"><a name="l18660"></a><span class="lineno">18660</span>&#160;                        $pos1 = intval($pos1);</div>
<div class="line"><a name="l18661"></a><span class="lineno">18661</span>&#160;                        <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a81c8257af5d6d6e40f1bb77d6b507b97">isUnicodeFont</a>()) {</div>
<div class="line"><a name="l18662"></a><span class="lineno">18662</span>&#160;                            $pos2 = intval(TCPDF_STATIC::revstrpos($pmid, <span class="stringliteral">&#39;[(&#39;</span>.chr(0).chr(32)));</div>
<div class="line"><a name="l18663"></a><span class="lineno">18663</span>&#160;                            $spacelen = 2;</div>
<div class="line"><a name="l18664"></a><span class="lineno">18664</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18665"></a><span class="lineno">18665</span>&#160;                            $pos2 = intval(TCPDF_STATIC::revstrpos($pmid, <span class="stringliteral">&#39;[(&#39;</span>.chr(32)));</div>
<div class="line"><a name="l18666"></a><span class="lineno">18666</span>&#160;                            $spacelen = 1;</div>
<div class="line"><a name="l18667"></a><span class="lineno">18667</span>&#160;                        }</div>
<div class="line"><a name="l18668"></a><span class="lineno">18668</span>&#160;                        <span class="keywordflow">if</span> ($pos1 == $pos2) {</div>
<div class="line"><a name="l18669"></a><span class="lineno">18669</span>&#160;                            $pmid = substr($pmid, 0, ($pos1 + 2)).substr($pmid, ($pos1 + 2 + $spacelen));</div>
<div class="line"><a name="l18670"></a><span class="lineno">18670</span>&#160;                            <span class="keywordflow">if</span> (substr($pmid, $pos1, 4) == <span class="stringliteral">&#39;[()]&#39;</span>) {</div>
<div class="line"><a name="l18671"></a><span class="lineno">18671</span>&#160;                                $linew -= $one_space_width;</div>
<div class="line"><a name="l18672"></a><span class="lineno">18672</span>&#160;                            } elseif ($pos1 == strpos($pmid, <span class="stringliteral">&#39;[(&#39;</span>)) {</div>
<div class="line"><a name="l18673"></a><span class="lineno">18673</span>&#160;                                $no = 1;</div>
<div class="line"><a name="l18674"></a><span class="lineno">18674</span>&#160;                            }</div>
<div class="line"><a name="l18675"></a><span class="lineno">18675</span>&#160;                        }</div>
<div class="line"><a name="l18676"></a><span class="lineno">18676</span>&#160;                    }</div>
<div class="line"><a name="l18677"></a><span class="lineno">18677</span>&#160;                } <span class="keywordflow">else</span> { <span class="comment">// LTR</span></div>
<div class="line"><a name="l18678"></a><span class="lineno">18678</span>&#160;                    <span class="comment">// remove right space if exist</span></div>
<div class="line"><a name="l18679"></a><span class="lineno">18679</span>&#160;                    $pos1 = TCPDF_STATIC::revstrpos($pmid, <span class="stringliteral">&#39;)]&#39;</span>);</div>
<div class="line"><a name="l18680"></a><span class="lineno">18680</span>&#160;                    <span class="keywordflow">if</span> ($pos1 &gt; 0) {</div>
<div class="line"><a name="l18681"></a><span class="lineno">18681</span>&#160;                        $pos1 = intval($pos1);</div>
<div class="line"><a name="l18682"></a><span class="lineno">18682</span>&#160;                        <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a81c8257af5d6d6e40f1bb77d6b507b97">isUnicodeFont</a>()) {</div>
<div class="line"><a name="l18683"></a><span class="lineno">18683</span>&#160;                            $pos2 = intval(TCPDF_STATIC::revstrpos($pmid, chr(0).chr(32).<span class="stringliteral">&#39;)]&#39;</span>)) + 2;</div>
<div class="line"><a name="l18684"></a><span class="lineno">18684</span>&#160;                            $spacelen = 2;</div>
<div class="line"><a name="l18685"></a><span class="lineno">18685</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18686"></a><span class="lineno">18686</span>&#160;                            $pos2 = intval(TCPDF_STATIC::revstrpos($pmid, chr(32).<span class="stringliteral">&#39;)]&#39;</span>)) + 1;</div>
<div class="line"><a name="l18687"></a><span class="lineno">18687</span>&#160;                            $spacelen = 1;</div>
<div class="line"><a name="l18688"></a><span class="lineno">18688</span>&#160;                        }</div>
<div class="line"><a name="l18689"></a><span class="lineno">18689</span>&#160;                        <span class="keywordflow">if</span> ($pos1 == $pos2) {</div>
<div class="line"><a name="l18690"></a><span class="lineno">18690</span>&#160;                            $pmid = substr($pmid, 0, ($pos1 - $spacelen)).substr($pmid, $pos1);</div>
<div class="line"><a name="l18691"></a><span class="lineno">18691</span>&#160;                            $linew -= $one_space_width;</div>
<div class="line"><a name="l18692"></a><span class="lineno">18692</span>&#160;                        }</div>
<div class="line"><a name="l18693"></a><span class="lineno">18693</span>&#160;                    }</div>
<div class="line"><a name="l18694"></a><span class="lineno">18694</span>&#160;                }</div>
<div class="line"><a name="l18695"></a><span class="lineno">18695</span>&#160;                $mdiff = ($tw - $linew);</div>
<div class="line"><a name="l18696"></a><span class="lineno">18696</span>&#160;                <span class="keywordflow">if</span> ($plalign == <span class="charliteral">&#39;C&#39;</span>) {</div>
<div class="line"><a name="l18697"></a><span class="lineno">18697</span>&#160;                    <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l18698"></a><span class="lineno">18698</span>&#160;                        $t_x = -($mdiff / 2);</div>
<div class="line"><a name="l18699"></a><span class="lineno">18699</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18700"></a><span class="lineno">18700</span>&#160;                        $t_x = ($mdiff / 2);</div>
<div class="line"><a name="l18701"></a><span class="lineno">18701</span>&#160;                    }</div>
<div class="line"><a name="l18702"></a><span class="lineno">18702</span>&#160;                } elseif ($plalign == <span class="charliteral">&#39;R&#39;</span>) {</div>
<div class="line"><a name="l18703"></a><span class="lineno">18703</span>&#160;                    <span class="comment">// right alignment on LTR document</span></div>
<div class="line"><a name="l18704"></a><span class="lineno">18704</span>&#160;                    $t_x = $mdiff;</div>
<div class="line"><a name="l18705"></a><span class="lineno">18705</span>&#160;                } elseif ($plalign == <span class="charliteral">&#39;L&#39;</span>) {</div>
<div class="line"><a name="l18706"></a><span class="lineno">18706</span>&#160;                    <span class="comment">// left alignment on RTL document</span></div>
<div class="line"><a name="l18707"></a><span class="lineno">18707</span>&#160;                    $t_x = -$mdiff;</div>
<div class="line"><a name="l18708"></a><span class="lineno">18708</span>&#160;                }</div>
<div class="line"><a name="l18709"></a><span class="lineno">18709</span>&#160;            } <span class="comment">// end if startlinex</span></div>
<div class="line"><a name="l18710"></a><span class="lineno">18710</span>&#160;            <span class="keywordflow">if</span> (($t_x != 0) OR ($yshift &lt; 0)) {</div>
<div class="line"><a name="l18711"></a><span class="lineno">18711</span>&#160;                <span class="comment">// shift the line</span></div>
<div class="line"><a name="l18712"></a><span class="lineno">18712</span>&#160;                $trx = sprintf(<span class="stringliteral">&#39;1 0 0 1 %F %F cm&#39;</span>, ($t_x * $this-&gt;k), ($yshift * $this-&gt;k));</div>
<div class="line"><a name="l18713"></a><span class="lineno">18713</span>&#160;                $pstart .= <span class="stringliteral">&quot;\nq\n&quot;</span>.$trx.<span class="stringliteral">&quot;\n&quot;</span>.$pmid.<span class="stringliteral">&quot;\nQ\n&quot;</span>;</div>
<div class="line"><a name="l18714"></a><span class="lineno">18714</span>&#160;                $endlinepos = strlen($pstart);</div>
<div class="line"><a name="l18715"></a><span class="lineno">18715</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;inxobj) {</div>
<div class="line"><a name="l18716"></a><span class="lineno">18716</span>&#160;                    <span class="comment">// we are inside an XObject template</span></div>
<div class="line"><a name="l18717"></a><span class="lineno">18717</span>&#160;                    $this-&gt;xobjects[<a class="code" href="../../d4/d40/classTCPDF.html#abe4390b4e1939e10c9b61a986adfc117">$this-&gt;xobjid</a>][<span class="stringliteral">&#39;outdata&#39;</span>] = $pstart.$pend;</div>
<div class="line"><a name="l18718"></a><span class="lineno">18718</span>&#160;                    <span class="keywordflow">foreach</span> ($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;annotations&#39;</span>] as $pak =&gt; $pac) {</div>
<div class="line"><a name="l18719"></a><span class="lineno">18719</span>&#160;                        <span class="keywordflow">if</span> ($pak &gt;= $pask) {</div>
<div class="line"><a name="l18720"></a><span class="lineno">18720</span>&#160;                            $this-&gt;xobjects[<a class="code" href="../../d4/d40/classTCPDF.html#abe4390b4e1939e10c9b61a986adfc117">$this-&gt;xobjid</a>][<span class="stringliteral">&#39;annotations&#39;</span>][$pak][<span class="charliteral">&#39;x&#39;</span>] += $t_x;</div>
<div class="line"><a name="l18721"></a><span class="lineno">18721</span>&#160;                            $this-&gt;xobjects[<a class="code" href="../../d4/d40/classTCPDF.html#abe4390b4e1939e10c9b61a986adfc117">$this-&gt;xobjid</a>][<span class="stringliteral">&#39;annotations&#39;</span>][$pak][<span class="charliteral">&#39;y&#39;</span>] -= $yshift;</div>
<div class="line"><a name="l18722"></a><span class="lineno">18722</span>&#160;                        }</div>
<div class="line"><a name="l18723"></a><span class="lineno">18723</span>&#160;                    }</div>
<div class="line"><a name="l18724"></a><span class="lineno">18724</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18725"></a><span class="lineno">18725</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a2b85f6395de14dd40cab8839b3ce25a8">setPageBuffer</a>($startlinepage, $pstart.$pend);</div>
<div class="line"><a name="l18726"></a><span class="lineno">18726</span>&#160;                    <span class="comment">// shift the annotations and links</span></div>
<div class="line"><a name="l18727"></a><span class="lineno">18727</span>&#160;                    <span class="keywordflow">if</span> (isset($this-&gt;PageAnnots[$this-&gt;page])) {</div>
<div class="line"><a name="l18728"></a><span class="lineno">18728</span>&#160;                        <span class="keywordflow">foreach</span> ($this-&gt;PageAnnots[$this-&gt;page] as $pak =&gt; $pac) {</div>
<div class="line"><a name="l18729"></a><span class="lineno">18729</span>&#160;                            <span class="keywordflow">if</span> ($pak &gt;= $pask) {</div>
<div class="line"><a name="l18730"></a><span class="lineno">18730</span>&#160;                                $this-&gt;PageAnnots[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][$pak][<span class="charliteral">&#39;x&#39;</span>] += $t_x;</div>
<div class="line"><a name="l18731"></a><span class="lineno">18731</span>&#160;                                $this-&gt;PageAnnots[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][$pak][<span class="charliteral">&#39;y&#39;</span>] -= $yshift;</div>
<div class="line"><a name="l18732"></a><span class="lineno">18732</span>&#160;                            }</div>
<div class="line"><a name="l18733"></a><span class="lineno">18733</span>&#160;                        }</div>
<div class="line"><a name="l18734"></a><span class="lineno">18734</span>&#160;                    }</div>
<div class="line"><a name="l18735"></a><span class="lineno">18735</span>&#160;                }</div>
<div class="line"><a name="l18736"></a><span class="lineno">18736</span>&#160;                $this-&gt;y -= $yshift;</div>
<div class="line"><a name="l18737"></a><span class="lineno">18737</span>&#160;                $yshift = 0;</div>
<div class="line"><a name="l18738"></a><span class="lineno">18738</span>&#160;            }</div>
<div class="line"><a name="l18739"></a><span class="lineno">18739</span>&#160;        }</div>
<div class="line"><a name="l18740"></a><span class="lineno">18740</span>&#160;        <span class="comment">// restore previous values</span></div>
<div class="line"><a name="l18741"></a><span class="lineno">18741</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a072053646725b19770a795050b3b6221">setGraphicVars</a>($gvars);</div>
<div class="line"><a name="l18742"></a><span class="lineno">18742</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;num_columns &gt; 1) {</div>
<div class="line"><a name="l18743"></a><span class="lineno">18743</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4f11d769024fd07e1f663efd02d10517">selectColumn</a>();</div>
<div class="line"><a name="l18744"></a><span class="lineno">18744</span>&#160;        } elseif ($this-&gt;page &gt; $prevPage) {</div>
<div class="line"><a name="l18745"></a><span class="lineno">18745</span>&#160;            $this-&gt;lMargin = $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;olm&#39;</span>];</div>
<div class="line"><a name="l18746"></a><span class="lineno">18746</span>&#160;            $this-&gt;rMargin = $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;orm&#39;</span>];</div>
<div class="line"><a name="l18747"></a><span class="lineno">18747</span>&#160;        }</div>
<div class="line"><a name="l18748"></a><span class="lineno">18748</span>&#160;        <span class="comment">// restore previous list state</span></div>
<div class="line"><a name="l18749"></a><span class="lineno">18749</span>&#160;        $this-&gt;cell_height_ratio = $prev_cell_height_ratio;</div>
<div class="line"><a name="l18750"></a><span class="lineno">18750</span>&#160;        $this-&gt;listnum = $prev_listnum;</div>
<div class="line"><a name="l18751"></a><span class="lineno">18751</span>&#160;        $this-&gt;listordered = $prev_listordered;</div>
<div class="line"><a name="l18752"></a><span class="lineno">18752</span>&#160;        $this-&gt;listcount = $prev_listcount;</div>
<div class="line"><a name="l18753"></a><span class="lineno">18753</span>&#160;        $this-&gt;lispacer = $prev_lispacer;</div>
<div class="line"><a name="l18754"></a><span class="lineno">18754</span>&#160;        <span class="keywordflow">if</span> ($ln AND (!($cell AND ($dom[$key-1][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;table&#39;</span>)))) {</div>
<div class="line"><a name="l18755"></a><span class="lineno">18755</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a00969cf629d72b3d29ee435f15906820">Ln</a>($this-&gt;lasth);</div>
<div class="line"><a name="l18756"></a><span class="lineno">18756</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;y &lt; $maxbottomliney) {</div>
<div class="line"><a name="l18757"></a><span class="lineno">18757</span>&#160;                $this-&gt;y = $maxbottomliney;</div>
<div class="line"><a name="l18758"></a><span class="lineno">18758</span>&#160;            }</div>
<div class="line"><a name="l18759"></a><span class="lineno">18759</span>&#160;        }</div>
<div class="line"><a name="l18760"></a><span class="lineno">18760</span>&#160;        unset($dom);</div>
<div class="line"><a name="l18761"></a><span class="lineno">18761</span>&#160;    }</div>
<div class="line"><a name="l18762"></a><span class="lineno">18762</span>&#160;</div>
<div class="line"><a name="l18771"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a1302c5172587123038e0c947b888b6ec">18771</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a1302c5172587123038e0c947b888b6ec">openHTMLTagHandler</a>($dom, $key, $cell) {</div>
<div class="line"><a name="l18772"></a><span class="lineno">18772</span>&#160;        $tag = $dom[$key];</div>
<div class="line"><a name="l18773"></a><span class="lineno">18773</span>&#160;        $parent = $dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])];</div>
<div class="line"><a name="l18774"></a><span class="lineno">18774</span>&#160;        $firsttag = ($key == 1);</div>
<div class="line"><a name="l18775"></a><span class="lineno">18775</span>&#160;        <span class="comment">// check for text direction attribute</span></div>
<div class="line"><a name="l18776"></a><span class="lineno">18776</span>&#160;        <span class="keywordflow">if</span> (isset($tag[<span class="stringliteral">&#39;dir&#39;</span>])) {</div>
<div class="line"><a name="l18777"></a><span class="lineno">18777</span>&#160;            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a6bada8d1ad88d9fa54368619de43b866">setTempRTL</a>($tag[<span class="stringliteral">&#39;dir&#39;</span>]);</div>
<div class="line"><a name="l18778"></a><span class="lineno">18778</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18779"></a><span class="lineno">18779</span>&#160;            $this-&gt;tmprtl = <span class="keyword">false</span>;</div>
<div class="line"><a name="l18780"></a><span class="lineno">18780</span>&#160;        }</div>
<div class="line"><a name="l18781"></a><span class="lineno">18781</span>&#160;        <span class="keywordflow">if</span> ($tag[<span class="stringliteral">&#39;block&#39;</span>]) {</div>
<div class="line"><a name="l18782"></a><span class="lineno">18782</span>&#160;            $hbz = 0; <span class="comment">// distance from y to line bottom</span></div>
<div class="line"><a name="l18783"></a><span class="lineno">18783</span>&#160;            $hb = 0; <span class="comment">// vertical space between block tags</span></div>
<div class="line"><a name="l18784"></a><span class="lineno">18784</span>&#160;            <span class="comment">// calculate vertical space for block tags</span></div>
<div class="line"><a name="l18785"></a><span class="lineno">18785</span>&#160;            <span class="keywordflow">if</span> (isset($this-&gt;tagvspaces[$tag[<span class="stringliteral">&#39;value&#39;</span>]][0][<span class="charliteral">&#39;h&#39;</span>]) AND ($this-&gt;tagvspaces[$tag[<span class="stringliteral">&#39;value&#39;</span>]][0][<span class="charliteral">&#39;h&#39;</span>] &gt;= 0)) {</div>
<div class="line"><a name="l18786"></a><span class="lineno">18786</span>&#160;                $cur_h = $this-&gt;tagvspaces[$tag[<span class="stringliteral">&#39;value&#39;</span>]][0][<span class="charliteral">&#39;h&#39;</span>];</div>
<div class="line"><a name="l18787"></a><span class="lineno">18787</span>&#160;            } elseif (isset($tag[<span class="stringliteral">&#39;fontsize&#39;</span>])) {</div>
<div class="line"><a name="l18788"></a><span class="lineno">18788</span>&#160;                $cur_h = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a25c7f71b3fcb19024497ea620f885346">getCellHeight</a>($tag[<span class="stringliteral">&#39;fontsize&#39;</span>] / $this-&gt;k);</div>
<div class="line"><a name="l18789"></a><span class="lineno">18789</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18790"></a><span class="lineno">18790</span>&#160;                $cur_h = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a25c7f71b3fcb19024497ea620f885346">getCellHeight</a>($this-&gt;FontSize);</div>
<div class="line"><a name="l18791"></a><span class="lineno">18791</span>&#160;            }</div>
<div class="line"><a name="l18792"></a><span class="lineno">18792</span>&#160;            <span class="keywordflow">if</span> (isset($this-&gt;tagvspaces[$tag[<span class="stringliteral">&#39;value&#39;</span>]][0][<span class="charliteral">&#39;n&#39;</span>])) {</div>
<div class="line"><a name="l18793"></a><span class="lineno">18793</span>&#160;                $on = $this-&gt;tagvspaces[$tag[<span class="stringliteral">&#39;value&#39;</span>]][0][<span class="charliteral">&#39;n&#39;</span>];</div>
<div class="line"><a name="l18794"></a><span class="lineno">18794</span>&#160;            } elseif (preg_match(<span class="stringliteral">&#39;/[h][0-9]/&#39;</span>, $tag[<span class="stringliteral">&#39;value&#39;</span>]) &gt; 0) {</div>
<div class="line"><a name="l18795"></a><span class="lineno">18795</span>&#160;                $on = 0.6;</div>
<div class="line"><a name="l18796"></a><span class="lineno">18796</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18797"></a><span class="lineno">18797</span>&#160;                $on = 1;</div>
<div class="line"><a name="l18798"></a><span class="lineno">18798</span>&#160;            }</div>
<div class="line"><a name="l18799"></a><span class="lineno">18799</span>&#160;            <span class="keywordflow">if</span> ((!isset($this-&gt;tagvspaces[$tag[<span class="stringliteral">&#39;value&#39;</span>]])) AND (in_array($tag[<span class="stringliteral">&#39;value&#39;</span>], array(<span class="stringliteral">&#39;div&#39;</span>, <span class="stringliteral">&#39;dt&#39;</span>, <span class="stringliteral">&#39;dd&#39;</span>, <span class="stringliteral">&#39;li&#39;</span>, <span class="stringliteral">&#39;br&#39;</span>, <span class="stringliteral">&#39;hr&#39;</span>)))) {</div>
<div class="line"><a name="l18800"></a><span class="lineno">18800</span>&#160;                $hb = 0;</div>
<div class="line"><a name="l18801"></a><span class="lineno">18801</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18802"></a><span class="lineno">18802</span>&#160;                $hb = ($on * $cur_h);</div>
<div class="line"><a name="l18803"></a><span class="lineno">18803</span>&#160;            }</div>
<div class="line"><a name="l18804"></a><span class="lineno">18804</span>&#160;            <span class="keywordflow">if</span> (($this-&gt;htmlvspace &lt;= 0) AND ($on &gt; 0)) {</div>
<div class="line"><a name="l18805"></a><span class="lineno">18805</span>&#160;                <span class="keywordflow">if</span> (isset($parent[<span class="stringliteral">&#39;fontsize&#39;</span>])) {</div>
<div class="line"><a name="l18806"></a><span class="lineno">18806</span>&#160;                    $hbz = (($parent[<span class="stringliteral">&#39;fontsize&#39;</span>] / <a class="code" href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">$this-&gt;k</a>) * $this-&gt;cell_height_ratio);</div>
<div class="line"><a name="l18807"></a><span class="lineno">18807</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18808"></a><span class="lineno">18808</span>&#160;                    $hbz = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a25c7f71b3fcb19024497ea620f885346">getCellHeight</a>($this-&gt;FontSize);</div>
<div class="line"><a name="l18809"></a><span class="lineno">18809</span>&#160;                }</div>
<div class="line"><a name="l18810"></a><span class="lineno">18810</span>&#160;            }</div>
<div class="line"><a name="l18811"></a><span class="lineno">18811</span>&#160;            <span class="keywordflow">if</span> (isset($dom[($key - 1)]) AND ($dom[($key - 1)][<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;table&#39;</span>)) {</div>
<div class="line"><a name="l18812"></a><span class="lineno">18812</span>&#160;                <span class="comment">// fix vertical space after table</span></div>
<div class="line"><a name="l18813"></a><span class="lineno">18813</span>&#160;                $hbz = 0;</div>
<div class="line"><a name="l18814"></a><span class="lineno">18814</span>&#160;            }</div>
<div class="line"><a name="l18815"></a><span class="lineno">18815</span>&#160;            <span class="comment">// closing vertical space</span></div>
<div class="line"><a name="l18816"></a><span class="lineno">18816</span>&#160;            $hbc = 0;</div>
<div class="line"><a name="l18817"></a><span class="lineno">18817</span>&#160;            <span class="keywordflow">if</span> (isset($this-&gt;tagvspaces[$tag[<span class="stringliteral">&#39;value&#39;</span>]][1][<span class="charliteral">&#39;h&#39;</span>]) AND ($this-&gt;tagvspaces[$tag[<span class="stringliteral">&#39;value&#39;</span>]][1][<span class="charliteral">&#39;h&#39;</span>] &gt;= 0)) {</div>
<div class="line"><a name="l18818"></a><span class="lineno">18818</span>&#160;                $pre_h = $this-&gt;tagvspaces[$tag[<span class="stringliteral">&#39;value&#39;</span>]][1][<span class="charliteral">&#39;h&#39;</span>];</div>
<div class="line"><a name="l18819"></a><span class="lineno">18819</span>&#160;            } elseif (isset($parent[<span class="stringliteral">&#39;fontsize&#39;</span>])) {</div>
<div class="line"><a name="l18820"></a><span class="lineno">18820</span>&#160;                $pre_h = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a25c7f71b3fcb19024497ea620f885346">getCellHeight</a>($parent[<span class="stringliteral">&#39;fontsize&#39;</span>] / $this-&gt;k);</div>
<div class="line"><a name="l18821"></a><span class="lineno">18821</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18822"></a><span class="lineno">18822</span>&#160;                $pre_h = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a25c7f71b3fcb19024497ea620f885346">getCellHeight</a>($this-&gt;FontSize);</div>
<div class="line"><a name="l18823"></a><span class="lineno">18823</span>&#160;            }</div>
<div class="line"><a name="l18824"></a><span class="lineno">18824</span>&#160;            <span class="keywordflow">if</span> (isset($this-&gt;tagvspaces[$tag[<span class="stringliteral">&#39;value&#39;</span>]][1][<span class="charliteral">&#39;n&#39;</span>])) {</div>
<div class="line"><a name="l18825"></a><span class="lineno">18825</span>&#160;                $cn = $this-&gt;tagvspaces[$tag[<span class="stringliteral">&#39;value&#39;</span>]][1][<span class="charliteral">&#39;n&#39;</span>];</div>
<div class="line"><a name="l18826"></a><span class="lineno">18826</span>&#160;            } elseif (preg_match(<span class="stringliteral">&#39;/[h][0-9]/&#39;</span>, $tag[<span class="stringliteral">&#39;value&#39;</span>]) &gt; 0) {</div>
<div class="line"><a name="l18827"></a><span class="lineno">18827</span>&#160;                $cn = 0.6;</div>
<div class="line"><a name="l18828"></a><span class="lineno">18828</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18829"></a><span class="lineno">18829</span>&#160;                $cn = 1;</div>
<div class="line"><a name="l18830"></a><span class="lineno">18830</span>&#160;            }</div>
<div class="line"><a name="l18831"></a><span class="lineno">18831</span>&#160;            <span class="keywordflow">if</span> (isset($this-&gt;tagvspaces[$tag[<span class="stringliteral">&#39;value&#39;</span>]][1])) {</div>
<div class="line"><a name="l18832"></a><span class="lineno">18832</span>&#160;                $hbc = ($cn * $pre_h);</div>
<div class="line"><a name="l18833"></a><span class="lineno">18833</span>&#160;            }</div>
<div class="line"><a name="l18834"></a><span class="lineno">18834</span>&#160;        }</div>
<div class="line"><a name="l18835"></a><span class="lineno">18835</span>&#160;        <span class="comment">// Opening tag</span></div>
<div class="line"><a name="l18836"></a><span class="lineno">18836</span>&#160;        <span class="keywordflow">switch</span>($tag[<span class="stringliteral">&#39;value&#39;</span>]) {</div>
<div class="line"><a name="l18837"></a><span class="lineno">18837</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;table&#39;</span>: {</div>
<div class="line"><a name="l18838"></a><span class="lineno">18838</span>&#160;                $cp = 0;</div>
<div class="line"><a name="l18839"></a><span class="lineno">18839</span>&#160;                $cs = 0;</div>
<div class="line"><a name="l18840"></a><span class="lineno">18840</span>&#160;                $dom[$key][<span class="stringliteral">&#39;rowspans&#39;</span>] = array();</div>
<div class="line"><a name="l18841"></a><span class="lineno">18841</span>&#160;                <span class="keywordflow">if</span> (!isset($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;nested&#39;</span>]) OR ($dom[$key][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;nested&#39;</span>] != <span class="stringliteral">&#39;true&#39;</span>)) {</div>
<div class="line"><a name="l18842"></a><span class="lineno">18842</span>&#160;                    $this-&gt;htmlvspace = 0;</div>
<div class="line"><a name="l18843"></a><span class="lineno">18843</span>&#160;                    <span class="comment">// set table header</span></div>
<div class="line"><a name="l18844"></a><span class="lineno">18844</span>&#160;                    <span class="keywordflow">if</span> (!TCPDF_STATIC::empty_string($dom[$key][<span class="stringliteral">&#39;thead&#39;</span>])) {</div>
<div class="line"><a name="l18845"></a><span class="lineno">18845</span>&#160;                        <span class="comment">// set table header</span></div>
<div class="line"><a name="l18846"></a><span class="lineno">18846</span>&#160;                        $this-&gt;thead = $dom[$key][<span class="stringliteral">&#39;thead&#39;</span>];</div>
<div class="line"><a name="l18847"></a><span class="lineno">18847</span>&#160;                        <span class="keywordflow">if</span> (!isset($this-&gt;theadMargins) OR (empty($this-&gt;theadMargins))) {</div>
<div class="line"><a name="l18848"></a><span class="lineno">18848</span>&#160;                            $this-&gt;theadMargins = array();</div>
<div class="line"><a name="l18849"></a><span class="lineno">18849</span>&#160;                            $this-&gt;theadMargins[<span class="stringliteral">&#39;cell_padding&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$this-&gt;cell_padding</a>;</div>
<div class="line"><a name="l18850"></a><span class="lineno">18850</span>&#160;                            $this-&gt;theadMargins[<span class="stringliteral">&#39;lmargin&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da">$this-&gt;lMargin</a>;</div>
<div class="line"><a name="l18851"></a><span class="lineno">18851</span>&#160;                            $this-&gt;theadMargins[<span class="stringliteral">&#39;rmargin&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a44fb75b85bea40ced25fdea9d89dc8e9">$this-&gt;rMargin</a>;</div>
<div class="line"><a name="l18852"></a><span class="lineno">18852</span>&#160;                            $this-&gt;theadMargins[<span class="stringliteral">&#39;page&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>;</div>
<div class="line"><a name="l18853"></a><span class="lineno">18853</span>&#160;                            $this-&gt;theadMargins[<span class="stringliteral">&#39;cell&#39;</span>] = $cell;</div>
<div class="line"><a name="l18854"></a><span class="lineno">18854</span>&#160;                            $this-&gt;theadMargins[<span class="stringliteral">&#39;gvars&#39;</span>] = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a24d3c102468b6ab9d2f4859a8b01863a">getGraphicVars</a>();</div>
<div class="line"><a name="l18855"></a><span class="lineno">18855</span>&#160;                        }</div>
<div class="line"><a name="l18856"></a><span class="lineno">18856</span>&#160;                    }</div>
<div class="line"><a name="l18857"></a><span class="lineno">18857</span>&#160;                }</div>
<div class="line"><a name="l18858"></a><span class="lineno">18858</span>&#160;                <span class="comment">// store current margins and page</span></div>
<div class="line"><a name="l18859"></a><span class="lineno">18859</span>&#160;                $dom[$key][<span class="stringliteral">&#39;old_cell_padding&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">$this-&gt;cell_padding</a>;</div>
<div class="line"><a name="l18860"></a><span class="lineno">18860</span>&#160;                <span class="keywordflow">if</span> (isset($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;cellpadding&#39;</span>])) {</div>
<div class="line"><a name="l18861"></a><span class="lineno">18861</span>&#160;                    $pad = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9">getHTMLUnitToUnits</a>($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;cellpadding&#39;</span>], 1, <span class="stringliteral">&#39;px&#39;</span>);</div>
<div class="line"><a name="l18862"></a><span class="lineno">18862</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a374b24751bf76e4ca5ba7694f87ec2c1">SetCellPadding</a>($pad);</div>
<div class="line"><a name="l18863"></a><span class="lineno">18863</span>&#160;                } elseif (isset($tag[<span class="stringliteral">&#39;padding&#39;</span>])) {</div>
<div class="line"><a name="l18864"></a><span class="lineno">18864</span>&#160;                    $this-&gt;cell_padding = $tag[<span class="stringliteral">&#39;padding&#39;</span>];</div>
<div class="line"><a name="l18865"></a><span class="lineno">18865</span>&#160;                }</div>
<div class="line"><a name="l18866"></a><span class="lineno">18866</span>&#160;                <span class="keywordflow">if</span> (isset($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;cellspacing&#39;</span>])) {</div>
<div class="line"><a name="l18867"></a><span class="lineno">18867</span>&#160;                    $cs = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9">getHTMLUnitToUnits</a>($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;cellspacing&#39;</span>], 1, <span class="stringliteral">&#39;px&#39;</span>);</div>
<div class="line"><a name="l18868"></a><span class="lineno">18868</span>&#160;                } elseif (isset($tag[<span class="stringliteral">&#39;border-spacing&#39;</span>])) {</div>
<div class="line"><a name="l18869"></a><span class="lineno">18869</span>&#160;                    $cs = $tag[<span class="stringliteral">&#39;border-spacing&#39;</span>][<span class="charliteral">&#39;V&#39;</span>];</div>
<div class="line"><a name="l18870"></a><span class="lineno">18870</span>&#160;                }</div>
<div class="line"><a name="l18871"></a><span class="lineno">18871</span>&#160;                $prev_y = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l18872"></a><span class="lineno">18872</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a9e8e4b4d75485b8f1e3aa2133a811e50">checkPageBreak</a>(((2 * $cp) + (2 * $cs) + $this-&gt;lasth), <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>) OR ($this-&gt;y &lt; $prev_y)) {</div>
<div class="line"><a name="l18873"></a><span class="lineno">18873</span>&#160;                    $this-&gt;inthead = <span class="keyword">true</span>;</div>
<div class="line"><a name="l18874"></a><span class="lineno">18874</span>&#160;                    <span class="comment">// add a page (or trig AcceptPageBreak() for multicolumn mode)</span></div>
<div class="line"><a name="l18875"></a><span class="lineno">18875</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a9e8e4b4d75485b8f1e3aa2133a811e50">checkPageBreak</a>($this-&gt;PageBreakTrigger + 1);</div>
<div class="line"><a name="l18876"></a><span class="lineno">18876</span>&#160;                }</div>
<div class="line"><a name="l18877"></a><span class="lineno">18877</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l18878"></a><span class="lineno">18878</span>&#160;            }</div>
<div class="line"><a name="l18879"></a><span class="lineno">18879</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;tr&#39;</span>: {</div>
<div class="line"><a name="l18880"></a><span class="lineno">18880</span>&#160;                <span class="comment">// array of columns positions</span></div>
<div class="line"><a name="l18881"></a><span class="lineno">18881</span>&#160;                $dom[$key][<span class="stringliteral">&#39;cellpos&#39;</span>] = array();</div>
<div class="line"><a name="l18882"></a><span class="lineno">18882</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l18883"></a><span class="lineno">18883</span>&#160;            }</div>
<div class="line"><a name="l18884"></a><span class="lineno">18884</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;hr&#39;</span>: {</div>
<div class="line"><a name="l18885"></a><span class="lineno">18885</span>&#160;                <span class="keywordflow">if</span> ((isset($tag[<span class="stringliteral">&#39;height&#39;</span>])) AND ($tag[<span class="stringliteral">&#39;height&#39;</span>] != <span class="stringliteral">&#39;&#39;</span>)) {</div>
<div class="line"><a name="l18886"></a><span class="lineno">18886</span>&#160;                    $hrHeight = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9">getHTMLUnitToUnits</a>($tag[<span class="stringliteral">&#39;height&#39;</span>], 1, <span class="stringliteral">&#39;px&#39;</span>);</div>
<div class="line"><a name="l18887"></a><span class="lineno">18887</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18888"></a><span class="lineno">18888</span>&#160;                    $hrHeight = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a9dd28e7bb04ba8f881492d06f501bce5">GetLineWidth</a>();</div>
<div class="line"><a name="l18889"></a><span class="lineno">18889</span>&#160;                }</div>
<div class="line"><a name="l18890"></a><span class="lineno">18890</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a885b5862782e1d3ff05f349f278ca664">addHTMLVertSpace</a>($hbz, max($hb, ($hrHeight / 2)), $cell, $firsttag);</div>
<div class="line"><a name="l18891"></a><span class="lineno">18891</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a415a80a301208fa77552048b27d2e0ce">GetX</a>();</div>
<div class="line"><a name="l18892"></a><span class="lineno">18892</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a> = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ae3b6169ba729309f289a5ac9680dd799">GetY</a>();</div>
<div class="line"><a name="l18893"></a><span class="lineno">18893</span>&#160;                $wtmp = $this-&gt;w - $this-&gt;lMargin - <a class="code" href="../../d4/d40/classTCPDF.html#a44fb75b85bea40ced25fdea9d89dc8e9">$this-&gt;rMargin</a>;</div>
<div class="line"><a name="l18894"></a><span class="lineno">18894</span>&#160;                <span class="keywordflow">if</span> ($cell) {</div>
<div class="line"><a name="l18895"></a><span class="lineno">18895</span>&#160;                    $wtmp -= ($this-&gt;cell_padding[<span class="charliteral">&#39;L&#39;</span>] + $this-&gt;cell_padding[<span class="charliteral">&#39;R&#39;</span>]);</div>
<div class="line"><a name="l18896"></a><span class="lineno">18896</span>&#160;                }</div>
<div class="line"><a name="l18897"></a><span class="lineno">18897</span>&#160;                <span class="keywordflow">if</span> ((isset($tag[<span class="stringliteral">&#39;width&#39;</span>])) AND ($tag[<span class="stringliteral">&#39;width&#39;</span>] != <span class="stringliteral">&#39;&#39;</span>)) {</div>
<div class="line"><a name="l18898"></a><span class="lineno">18898</span>&#160;                    $hrWidth = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9">getHTMLUnitToUnits</a>($tag[<span class="stringliteral">&#39;width&#39;</span>], $wtmp, <span class="stringliteral">&#39;px&#39;</span>);</div>
<div class="line"><a name="l18899"></a><span class="lineno">18899</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18900"></a><span class="lineno">18900</span>&#160;                    $hrWidth = $wtmp;</div>
<div class="line"><a name="l18901"></a><span class="lineno">18901</span>&#160;                }</div>
<div class="line"><a name="l18902"></a><span class="lineno">18902</span>&#160;                $prevlinewidth = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a9dd28e7bb04ba8f881492d06f501bce5">GetLineWidth</a>();</div>
<div class="line"><a name="l18903"></a><span class="lineno">18903</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a0ef34c0ce76bd8e4671da42b3588d9b6">SetLineWidth</a>($hrHeight);</div>
<div class="line"><a name="l18904"></a><span class="lineno">18904</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a89c0fac95da962719ba92b057df9c201">Line</a>(<a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>, <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a> + $hrWidth, <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$y</a>);</div>
<div class="line"><a name="l18905"></a><span class="lineno">18905</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a0ef34c0ce76bd8e4671da42b3588d9b6">SetLineWidth</a>($prevlinewidth);</div>
<div class="line"><a name="l18906"></a><span class="lineno">18906</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a885b5862782e1d3ff05f349f278ca664">addHTMLVertSpace</a>(max($hbc, ($hrHeight / 2)), 0, $cell, !isset($dom[($key + 1)]));</div>
<div class="line"><a name="l18907"></a><span class="lineno">18907</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l18908"></a><span class="lineno">18908</span>&#160;            }</div>
<div class="line"><a name="l18909"></a><span class="lineno">18909</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;a&#39;</span>: {</div>
<div class="line"><a name="l18910"></a><span class="lineno">18910</span>&#160;                <span class="keywordflow">if</span> (array_key_exists(<span class="stringliteral">&#39;href&#39;</span>, $tag[<span class="stringliteral">&#39;attribute&#39;</span>])) {</div>
<div class="line"><a name="l18911"></a><span class="lineno">18911</span>&#160;                    $this-&gt;HREF[<span class="stringliteral">&#39;url&#39;</span>] = $tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;href&#39;</span>];</div>
<div class="line"><a name="l18912"></a><span class="lineno">18912</span>&#160;                }</div>
<div class="line"><a name="l18913"></a><span class="lineno">18913</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l18914"></a><span class="lineno">18914</span>&#160;            }</div>
<div class="line"><a name="l18915"></a><span class="lineno">18915</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;img&#39;</span>: {</div>
<div class="line"><a name="l18916"></a><span class="lineno">18916</span>&#160;                <span class="keywordflow">if</span> (!empty($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;src&#39;</span>])) {</div>
<div class="line"><a name="l18917"></a><span class="lineno">18917</span>&#160;                    <span class="keywordflow">if</span> ($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;src&#39;</span>][0] === <span class="charliteral">&#39;@&#39;</span>) {</div>
<div class="line"><a name="l18918"></a><span class="lineno">18918</span>&#160;                        <span class="comment">// data stream</span></div>
<div class="line"><a name="l18919"></a><span class="lineno">18919</span>&#160;                        $tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;src&#39;</span>] = <span class="charliteral">&#39;@&#39;</span>.base64_decode(substr($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;src&#39;</span>], 1));</div>
<div class="line"><a name="l18920"></a><span class="lineno">18920</span>&#160;                        $type = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l18921"></a><span class="lineno">18921</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18922"></a><span class="lineno">18922</span>&#160;                        <span class="comment">// get image type</span></div>
<div class="line"><a name="l18923"></a><span class="lineno">18923</span>&#160;                        $type = TCPDF_IMAGES::getImageFileType($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;src&#39;</span>]);</div>
<div class="line"><a name="l18924"></a><span class="lineno">18924</span>&#160;                    }</div>
<div class="line"><a name="l18925"></a><span class="lineno">18925</span>&#160;                    <span class="keywordflow">if</span> (!isset($tag[<span class="stringliteral">&#39;width&#39;</span>])) {</div>
<div class="line"><a name="l18926"></a><span class="lineno">18926</span>&#160;                        $tag[<span class="stringliteral">&#39;width&#39;</span>] = 0;</div>
<div class="line"><a name="l18927"></a><span class="lineno">18927</span>&#160;                    }</div>
<div class="line"><a name="l18928"></a><span class="lineno">18928</span>&#160;                    <span class="keywordflow">if</span> (!isset($tag[<span class="stringliteral">&#39;height&#39;</span>])) {</div>
<div class="line"><a name="l18929"></a><span class="lineno">18929</span>&#160;                        $tag[<span class="stringliteral">&#39;height&#39;</span>] = 0;</div>
<div class="line"><a name="l18930"></a><span class="lineno">18930</span>&#160;                    }</div>
<div class="line"><a name="l18931"></a><span class="lineno">18931</span>&#160;                    <span class="comment">//if (!isset($tag[&#39;attribute&#39;][&#39;align&#39;])) {</span></div>
<div class="line"><a name="l18932"></a><span class="lineno">18932</span>&#160;                        <span class="comment">// the only alignment supported is &quot;bottom&quot;</span></div>
<div class="line"><a name="l18933"></a><span class="lineno">18933</span>&#160;                        <span class="comment">// further development is required for other modes.</span></div>
<div class="line"><a name="l18934"></a><span class="lineno">18934</span>&#160;                        $tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;align&#39;</span>] = <span class="stringliteral">&#39;bottom&#39;</span>;</div>
<div class="line"><a name="l18935"></a><span class="lineno">18935</span>&#160;                    <span class="comment">//}</span></div>
<div class="line"><a name="l18936"></a><span class="lineno">18936</span>&#160;                    <span class="keywordflow">switch</span>($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;align&#39;</span>]) {</div>
<div class="line"><a name="l18937"></a><span class="lineno">18937</span>&#160;                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;top&#39;</span>: {</div>
<div class="line"><a name="l18938"></a><span class="lineno">18938</span>&#160;                            $align = <span class="charliteral">&#39;T&#39;</span>;</div>
<div class="line"><a name="l18939"></a><span class="lineno">18939</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l18940"></a><span class="lineno">18940</span>&#160;                        }</div>
<div class="line"><a name="l18941"></a><span class="lineno">18941</span>&#160;                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;middle&#39;</span>: {</div>
<div class="line"><a name="l18942"></a><span class="lineno">18942</span>&#160;                            $align = <span class="charliteral">&#39;M&#39;</span>;</div>
<div class="line"><a name="l18943"></a><span class="lineno">18943</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l18944"></a><span class="lineno">18944</span>&#160;                        }</div>
<div class="line"><a name="l18945"></a><span class="lineno">18945</span>&#160;                        <span class="keywordflow">case</span> <span class="stringliteral">&#39;bottom&#39;</span>: {</div>
<div class="line"><a name="l18946"></a><span class="lineno">18946</span>&#160;                            $align = <span class="charliteral">&#39;B&#39;</span>;</div>
<div class="line"><a name="l18947"></a><span class="lineno">18947</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l18948"></a><span class="lineno">18948</span>&#160;                        }</div>
<div class="line"><a name="l18949"></a><span class="lineno">18949</span>&#160;                        <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l18950"></a><span class="lineno">18950</span>&#160;                            $align = <span class="charliteral">&#39;B&#39;</span>;</div>
<div class="line"><a name="l18951"></a><span class="lineno">18951</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l18952"></a><span class="lineno">18952</span>&#160;                        }</div>
<div class="line"><a name="l18953"></a><span class="lineno">18953</span>&#160;                    }</div>
<div class="line"><a name="l18954"></a><span class="lineno">18954</span>&#160;                    $prevy = <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l18955"></a><span class="lineno">18955</span>&#160;                    $xpos = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$this-&gt;x</a>;</div>
<div class="line"><a name="l18956"></a><span class="lineno">18956</span>&#160;                    $imglink = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l18957"></a><span class="lineno">18957</span>&#160;                    <span class="keywordflow">if</span> (isset($this-&gt;HREF[<span class="stringliteral">&#39;url&#39;</span>]) AND !TCPDF_STATIC::empty_string($this-&gt;HREF[<span class="stringliteral">&#39;url&#39;</span>])) {</div>
<div class="line"><a name="l18958"></a><span class="lineno">18958</span>&#160;                        $imglink = $this-&gt;HREF[<span class="stringliteral">&#39;url&#39;</span>];</div>
<div class="line"><a name="l18959"></a><span class="lineno">18959</span>&#160;                        <span class="keywordflow">if</span> ($imglink[0] == <span class="charliteral">&#39;#&#39;</span>) {</div>
<div class="line"><a name="l18960"></a><span class="lineno">18960</span>&#160;                            <span class="comment">// convert url to internal link</span></div>
<div class="line"><a name="l18961"></a><span class="lineno">18961</span>&#160;                            $lnkdata = explode(<span class="charliteral">&#39;,&#39;</span>, $imglink);</div>
<div class="line"><a name="l18962"></a><span class="lineno">18962</span>&#160;                            <span class="keywordflow">if</span> (isset($lnkdata[0])) {</div>
<div class="line"><a name="l18963"></a><span class="lineno">18963</span>&#160;                                <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a> = intval(substr($lnkdata[0], 1));</div>
<div class="line"><a name="l18964"></a><span class="lineno">18964</span>&#160;                                <span class="keywordflow">if</span> (empty(<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>) OR (<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a> &lt;= 0)) {</div>
<div class="line"><a name="l18965"></a><span class="lineno">18965</span>&#160;                                    <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a> = <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>;</div>
<div class="line"><a name="l18966"></a><span class="lineno">18966</span>&#160;                                }</div>
<div class="line"><a name="l18967"></a><span class="lineno">18967</span>&#160;                                <span class="keywordflow">if</span> (isset($lnkdata[1]) AND (strlen($lnkdata[1]) &gt; 0)) {</div>
<div class="line"><a name="l18968"></a><span class="lineno">18968</span>&#160;                                    $lnky = floatval($lnkdata[1]);</div>
<div class="line"><a name="l18969"></a><span class="lineno">18969</span>&#160;                                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18970"></a><span class="lineno">18970</span>&#160;                                    $lnky = 0;</div>
<div class="line"><a name="l18971"></a><span class="lineno">18971</span>&#160;                                }</div>
<div class="line"><a name="l18972"></a><span class="lineno">18972</span>&#160;                                $imglink = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a749522038ed7786c3e1701435dcb891e">AddLink</a>();</div>
<div class="line"><a name="l18973"></a><span class="lineno">18973</span>&#160;                                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ace5be60e7857953ea5e2b89cb90df0ae">SetLink</a>($imglink, $lnky, <a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>);</div>
<div class="line"><a name="l18974"></a><span class="lineno">18974</span>&#160;                            }</div>
<div class="line"><a name="l18975"></a><span class="lineno">18975</span>&#160;                        }</div>
<div class="line"><a name="l18976"></a><span class="lineno">18976</span>&#160;                    }</div>
<div class="line"><a name="l18977"></a><span class="lineno">18977</span>&#160;                    $border = 0;</div>
<div class="line"><a name="l18978"></a><span class="lineno">18978</span>&#160;                    <span class="keywordflow">if</span> (isset($tag[<span class="stringliteral">&#39;border&#39;</span>]) AND !empty($tag[<span class="stringliteral">&#39;border&#39;</span>])) {</div>
<div class="line"><a name="l18979"></a><span class="lineno">18979</span>&#160;                        <span class="comment">// currently only support 1 (frame) or a combination of &#39;LTRB&#39;</span></div>
<div class="line"><a name="l18980"></a><span class="lineno">18980</span>&#160;                        $border = $tag[<span class="stringliteral">&#39;border&#39;</span>];</div>
<div class="line"><a name="l18981"></a><span class="lineno">18981</span>&#160;                    }</div>
<div class="line"><a name="l18982"></a><span class="lineno">18982</span>&#160;                    $iw = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l18983"></a><span class="lineno">18983</span>&#160;                    <span class="keywordflow">if</span> (isset($tag[<span class="stringliteral">&#39;width&#39;</span>])) {</div>
<div class="line"><a name="l18984"></a><span class="lineno">18984</span>&#160;                        $iw = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9">getHTMLUnitToUnits</a>($tag[<span class="stringliteral">&#39;width&#39;</span>], ($tag[<span class="stringliteral">&#39;fontsize&#39;</span>] / $this-&gt;k), <span class="stringliteral">&#39;px&#39;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l18985"></a><span class="lineno">18985</span>&#160;                    }</div>
<div class="line"><a name="l18986"></a><span class="lineno">18986</span>&#160;                    $ih = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l18987"></a><span class="lineno">18987</span>&#160;                    <span class="keywordflow">if</span> (isset($tag[<span class="stringliteral">&#39;height&#39;</span>])) {</div>
<div class="line"><a name="l18988"></a><span class="lineno">18988</span>&#160;                        $ih = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9">getHTMLUnitToUnits</a>($tag[<span class="stringliteral">&#39;height&#39;</span>], ($tag[<span class="stringliteral">&#39;fontsize&#39;</span>] / $this-&gt;k), <span class="stringliteral">&#39;px&#39;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l18989"></a><span class="lineno">18989</span>&#160;                    }</div>
<div class="line"><a name="l18990"></a><span class="lineno">18990</span>&#160;                    <span class="keywordflow">if</span> (($type == <span class="stringliteral">&#39;eps&#39;</span>) OR ($type == <span class="stringliteral">&#39;ai&#39;</span>)) {</div>
<div class="line"><a name="l18991"></a><span class="lineno">18991</span>&#160;                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ace0583441eed657b827420fcfb37a3bd">ImageEps</a>($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;src&#39;</span>], $xpos, $this-&gt;y, $iw, $ih, $imglink, <span class="keyword">true</span>, $align, <span class="stringliteral">&#39;&#39;</span>, $border, <span class="keyword">true</span>);</div>
<div class="line"><a name="l18992"></a><span class="lineno">18992</span>&#160;                    } elseif ($type == <span class="stringliteral">&#39;svg&#39;</span>) {</div>
<div class="line"><a name="l18993"></a><span class="lineno">18993</span>&#160;                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a56536508fb1b5aede7d2ed27f56c2353">ImageSVG</a>($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;src&#39;</span>], $xpos, $this-&gt;y, $iw, $ih, $imglink, $align, <span class="stringliteral">&#39;&#39;</span>, $border, <span class="keyword">true</span>);</div>
<div class="line"><a name="l18994"></a><span class="lineno">18994</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l18995"></a><span class="lineno">18995</span>&#160;                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a714c2bee7d6b39d4d6d304540c761352">Image</a>($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;src&#39;</span>], $xpos, $this-&gt;y, $iw, $ih, <span class="stringliteral">&#39;&#39;</span>, $imglink, $align, <span class="keyword">false</span>, 300, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, $border, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l18996"></a><span class="lineno">18996</span>&#160;                    }</div>
<div class="line"><a name="l18997"></a><span class="lineno">18997</span>&#160;                    <span class="keywordflow">switch</span>($align) {</div>
<div class="line"><a name="l18998"></a><span class="lineno">18998</span>&#160;                        <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>: {</div>
<div class="line"><a name="l18999"></a><span class="lineno">18999</span>&#160;                            $this-&gt;y = $prevy;</div>
<div class="line"><a name="l19000"></a><span class="lineno">19000</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19001"></a><span class="lineno">19001</span>&#160;                        }</div>
<div class="line"><a name="l19002"></a><span class="lineno">19002</span>&#160;                        <span class="keywordflow">case</span> <span class="charliteral">&#39;M&#39;</span>: {</div>
<div class="line"><a name="l19003"></a><span class="lineno">19003</span>&#160;                            $this-&gt;y = (($this-&gt;img_rb_y + $prevy - ($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a25c7f71b3fcb19024497ea620f885346">getCellHeight</a>($tag[<span class="stringliteral">&#39;fontsize&#39;</span>] / $this-&gt;k))) / 2);</div>
<div class="line"><a name="l19004"></a><span class="lineno">19004</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19005"></a><span class="lineno">19005</span>&#160;                        }</div>
<div class="line"><a name="l19006"></a><span class="lineno">19006</span>&#160;                        <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>: {</div>
<div class="line"><a name="l19007"></a><span class="lineno">19007</span>&#160;                            $this-&gt;y = $this-&gt;img_rb_y - ($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a25c7f71b3fcb19024497ea620f885346">getCellHeight</a>($tag[<span class="stringliteral">&#39;fontsize&#39;</span>] / $this-&gt;k) - ($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a0c8374150dbc8ca092618ca430713f70">getFontDescent</a>($tag[<span class="stringliteral">&#39;fontname&#39;</span>], $tag[<span class="stringliteral">&#39;fontstyle&#39;</span>], $tag[<span class="stringliteral">&#39;fontsize&#39;</span>]) * <a class="code" href="../../d4/d40/classTCPDF.html#af8cc74fe5806eb009a22791c3a4c7cce">$this-&gt;cell_height_ratio</a>));</div>
<div class="line"><a name="l19008"></a><span class="lineno">19008</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19009"></a><span class="lineno">19009</span>&#160;                        }</div>
<div class="line"><a name="l19010"></a><span class="lineno">19010</span>&#160;                    }</div>
<div class="line"><a name="l19011"></a><span class="lineno">19011</span>&#160;                }</div>
<div class="line"><a name="l19012"></a><span class="lineno">19012</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19013"></a><span class="lineno">19013</span>&#160;            }</div>
<div class="line"><a name="l19014"></a><span class="lineno">19014</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;dl&#39;</span>: {</div>
<div class="line"><a name="l19015"></a><span class="lineno">19015</span>&#160;                ++<a class="code" href="../../d4/d40/classTCPDF.html#a92b743d472f53d5260274c7915829ff7">$this-&gt;listnum</a>;</div>
<div class="line"><a name="l19016"></a><span class="lineno">19016</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;listnum == 1) {</div>
<div class="line"><a name="l19017"></a><span class="lineno">19017</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a885b5862782e1d3ff05f349f278ca664">addHTMLVertSpace</a>($hbz, $hb, $cell, $firsttag);</div>
<div class="line"><a name="l19018"></a><span class="lineno">19018</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l19019"></a><span class="lineno">19019</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a885b5862782e1d3ff05f349f278ca664">addHTMLVertSpace</a>(0, 0, $cell, $firsttag);</div>
<div class="line"><a name="l19020"></a><span class="lineno">19020</span>&#160;                }</div>
<div class="line"><a name="l19021"></a><span class="lineno">19021</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19022"></a><span class="lineno">19022</span>&#160;            }</div>
<div class="line"><a name="l19023"></a><span class="lineno">19023</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;dt&#39;</span>: {</div>
<div class="line"><a name="l19024"></a><span class="lineno">19024</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a885b5862782e1d3ff05f349f278ca664">addHTMLVertSpace</a>($hbz, $hb, $cell, $firsttag);</div>
<div class="line"><a name="l19025"></a><span class="lineno">19025</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19026"></a><span class="lineno">19026</span>&#160;            }</div>
<div class="line"><a name="l19027"></a><span class="lineno">19027</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;dd&#39;</span>: {</div>
<div class="line"><a name="l19028"></a><span class="lineno">19028</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l19029"></a><span class="lineno">19029</span>&#160;                    $this-&gt;rMargin += <a class="code" href="../../d4/d40/classTCPDF.html#a66ab086d27a31dd0a7a7c69ea87b3767">$this-&gt;listindent</a>;</div>
<div class="line"><a name="l19030"></a><span class="lineno">19030</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l19031"></a><span class="lineno">19031</span>&#160;                    $this-&gt;lMargin += <a class="code" href="../../d4/d40/classTCPDF.html#a66ab086d27a31dd0a7a7c69ea87b3767">$this-&gt;listindent</a>;</div>
<div class="line"><a name="l19032"></a><span class="lineno">19032</span>&#160;                }</div>
<div class="line"><a name="l19033"></a><span class="lineno">19033</span>&#160;                ++<a class="code" href="../../d4/d40/classTCPDF.html#a1f87a9ca1927053aed6c3188edeb1d28">$this-&gt;listindentlevel</a>;</div>
<div class="line"><a name="l19034"></a><span class="lineno">19034</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a885b5862782e1d3ff05f349f278ca664">addHTMLVertSpace</a>($hbz, $hb, $cell, $firsttag);</div>
<div class="line"><a name="l19035"></a><span class="lineno">19035</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19036"></a><span class="lineno">19036</span>&#160;            }</div>
<div class="line"><a name="l19037"></a><span class="lineno">19037</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;ul&#39;</span>:</div>
<div class="line"><a name="l19038"></a><span class="lineno">19038</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;ol&#39;</span>: {</div>
<div class="line"><a name="l19039"></a><span class="lineno">19039</span>&#160;                ++<a class="code" href="../../d4/d40/classTCPDF.html#a92b743d472f53d5260274c7915829ff7">$this-&gt;listnum</a>;</div>
<div class="line"><a name="l19040"></a><span class="lineno">19040</span>&#160;                <span class="keywordflow">if</span> ($tag[<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;ol&#39;</span>) {</div>
<div class="line"><a name="l19041"></a><span class="lineno">19041</span>&#160;                    $this-&gt;listordered[<a class="code" href="../../d4/d40/classTCPDF.html#a92b743d472f53d5260274c7915829ff7">$this-&gt;listnum</a>] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l19042"></a><span class="lineno">19042</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l19043"></a><span class="lineno">19043</span>&#160;                    $this-&gt;listordered[<a class="code" href="../../d4/d40/classTCPDF.html#a92b743d472f53d5260274c7915829ff7">$this-&gt;listnum</a>] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l19044"></a><span class="lineno">19044</span>&#160;                }</div>
<div class="line"><a name="l19045"></a><span class="lineno">19045</span>&#160;                <span class="keywordflow">if</span> (isset($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;start&#39;</span>])) {</div>
<div class="line"><a name="l19046"></a><span class="lineno">19046</span>&#160;                    $this-&gt;listcount[<a class="code" href="../../d4/d40/classTCPDF.html#a92b743d472f53d5260274c7915829ff7">$this-&gt;listnum</a>] = intval($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;start&#39;</span>]) - 1;</div>
<div class="line"><a name="l19047"></a><span class="lineno">19047</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l19048"></a><span class="lineno">19048</span>&#160;                    $this-&gt;listcount[<a class="code" href="../../d4/d40/classTCPDF.html#a92b743d472f53d5260274c7915829ff7">$this-&gt;listnum</a>] = 0;</div>
<div class="line"><a name="l19049"></a><span class="lineno">19049</span>&#160;                }</div>
<div class="line"><a name="l19050"></a><span class="lineno">19050</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l19051"></a><span class="lineno">19051</span>&#160;                    $this-&gt;rMargin += <a class="code" href="../../d4/d40/classTCPDF.html#a66ab086d27a31dd0a7a7c69ea87b3767">$this-&gt;listindent</a>;</div>
<div class="line"><a name="l19052"></a><span class="lineno">19052</span>&#160;                    $this-&gt;x -= <a class="code" href="../../d4/d40/classTCPDF.html#a66ab086d27a31dd0a7a7c69ea87b3767">$this-&gt;listindent</a>;</div>
<div class="line"><a name="l19053"></a><span class="lineno">19053</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l19054"></a><span class="lineno">19054</span>&#160;                    $this-&gt;lMargin += <a class="code" href="../../d4/d40/classTCPDF.html#a66ab086d27a31dd0a7a7c69ea87b3767">$this-&gt;listindent</a>;</div>
<div class="line"><a name="l19055"></a><span class="lineno">19055</span>&#160;                    $this-&gt;x += <a class="code" href="../../d4/d40/classTCPDF.html#a66ab086d27a31dd0a7a7c69ea87b3767">$this-&gt;listindent</a>;</div>
<div class="line"><a name="l19056"></a><span class="lineno">19056</span>&#160;                }</div>
<div class="line"><a name="l19057"></a><span class="lineno">19057</span>&#160;                ++<a class="code" href="../../d4/d40/classTCPDF.html#a1f87a9ca1927053aed6c3188edeb1d28">$this-&gt;listindentlevel</a>;</div>
<div class="line"><a name="l19058"></a><span class="lineno">19058</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;listnum == 1) {</div>
<div class="line"><a name="l19059"></a><span class="lineno">19059</span>&#160;                    <span class="keywordflow">if</span> ($key &gt; 1) {</div>
<div class="line"><a name="l19060"></a><span class="lineno">19060</span>&#160;                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a885b5862782e1d3ff05f349f278ca664">addHTMLVertSpace</a>($hbz, $hb, $cell, $firsttag);</div>
<div class="line"><a name="l19061"></a><span class="lineno">19061</span>&#160;                    }</div>
<div class="line"><a name="l19062"></a><span class="lineno">19062</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l19063"></a><span class="lineno">19063</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a885b5862782e1d3ff05f349f278ca664">addHTMLVertSpace</a>(0, 0, $cell, $firsttag);</div>
<div class="line"><a name="l19064"></a><span class="lineno">19064</span>&#160;                }</div>
<div class="line"><a name="l19065"></a><span class="lineno">19065</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19066"></a><span class="lineno">19066</span>&#160;            }</div>
<div class="line"><a name="l19067"></a><span class="lineno">19067</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;li&#39;</span>: {</div>
<div class="line"><a name="l19068"></a><span class="lineno">19068</span>&#160;                <span class="keywordflow">if</span> ($key &gt; 2) {</div>
<div class="line"><a name="l19069"></a><span class="lineno">19069</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a885b5862782e1d3ff05f349f278ca664">addHTMLVertSpace</a>($hbz, $hb, $cell, $firsttag);</div>
<div class="line"><a name="l19070"></a><span class="lineno">19070</span>&#160;                }</div>
<div class="line"><a name="l19071"></a><span class="lineno">19071</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;listordered[$this-&gt;listnum]) {</div>
<div class="line"><a name="l19072"></a><span class="lineno">19072</span>&#160;                    <span class="comment">// ordered item</span></div>
<div class="line"><a name="l19073"></a><span class="lineno">19073</span>&#160;                    <span class="keywordflow">if</span> (isset($parent[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;type&#39;</span>]) AND !TCPDF_STATIC::empty_string($parent[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;type&#39;</span>])) {</div>
<div class="line"><a name="l19074"></a><span class="lineno">19074</span>&#160;                        $this-&gt;lispacer = $parent[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;type&#39;</span>];</div>
<div class="line"><a name="l19075"></a><span class="lineno">19075</span>&#160;                    } elseif (isset($parent[<span class="stringliteral">&#39;listtype&#39;</span>]) AND !TCPDF_STATIC::empty_string($parent[<span class="stringliteral">&#39;listtype&#39;</span>])) {</div>
<div class="line"><a name="l19076"></a><span class="lineno">19076</span>&#160;                        $this-&gt;lispacer = $parent[<span class="stringliteral">&#39;listtype&#39;</span>];</div>
<div class="line"><a name="l19077"></a><span class="lineno">19077</span>&#160;                    } elseif (isset($this-&gt;lisymbol) AND !TCPDF_STATIC::empty_string($this-&gt;lisymbol)) {</div>
<div class="line"><a name="l19078"></a><span class="lineno">19078</span>&#160;                        $this-&gt;lispacer = <a class="code" href="../../d4/d40/classTCPDF.html#a0e77f99c65a62b6af3d07419e4750bc5">$this-&gt;lisymbol</a>;</div>
<div class="line"><a name="l19079"></a><span class="lineno">19079</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l19080"></a><span class="lineno">19080</span>&#160;                        $this-&gt;lispacer = <span class="charliteral">&#39;#&#39;</span>;</div>
<div class="line"><a name="l19081"></a><span class="lineno">19081</span>&#160;                    }</div>
<div class="line"><a name="l19082"></a><span class="lineno">19082</span>&#160;                    ++$this-&gt;listcount[<a class="code" href="../../d4/d40/classTCPDF.html#a92b743d472f53d5260274c7915829ff7">$this-&gt;listnum</a>];</div>
<div class="line"><a name="l19083"></a><span class="lineno">19083</span>&#160;                    <span class="keywordflow">if</span> (isset($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;value&#39;</span>])) {</div>
<div class="line"><a name="l19084"></a><span class="lineno">19084</span>&#160;                        $this-&gt;listcount[<a class="code" href="../../d4/d40/classTCPDF.html#a92b743d472f53d5260274c7915829ff7">$this-&gt;listnum</a>] = intval($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;value&#39;</span>]);</div>
<div class="line"><a name="l19085"></a><span class="lineno">19085</span>&#160;                    }</div>
<div class="line"><a name="l19086"></a><span class="lineno">19086</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l19087"></a><span class="lineno">19087</span>&#160;                    <span class="comment">// unordered item</span></div>
<div class="line"><a name="l19088"></a><span class="lineno">19088</span>&#160;                    <span class="keywordflow">if</span> (isset($parent[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;type&#39;</span>]) AND !TCPDF_STATIC::empty_string($parent[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;type&#39;</span>])) {</div>
<div class="line"><a name="l19089"></a><span class="lineno">19089</span>&#160;                        $this-&gt;lispacer = $parent[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;type&#39;</span>];</div>
<div class="line"><a name="l19090"></a><span class="lineno">19090</span>&#160;                    } elseif (isset($parent[<span class="stringliteral">&#39;listtype&#39;</span>]) AND !TCPDF_STATIC::empty_string($parent[<span class="stringliteral">&#39;listtype&#39;</span>])) {</div>
<div class="line"><a name="l19091"></a><span class="lineno">19091</span>&#160;                        $this-&gt;lispacer = $parent[<span class="stringliteral">&#39;listtype&#39;</span>];</div>
<div class="line"><a name="l19092"></a><span class="lineno">19092</span>&#160;                    } elseif (isset($this-&gt;lisymbol) AND !TCPDF_STATIC::empty_string($this-&gt;lisymbol)) {</div>
<div class="line"><a name="l19093"></a><span class="lineno">19093</span>&#160;                        $this-&gt;lispacer = <a class="code" href="../../d4/d40/classTCPDF.html#a0e77f99c65a62b6af3d07419e4750bc5">$this-&gt;lisymbol</a>;</div>
<div class="line"><a name="l19094"></a><span class="lineno">19094</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l19095"></a><span class="lineno">19095</span>&#160;                        $this-&gt;lispacer = <span class="charliteral">&#39;!&#39;</span>;</div>
<div class="line"><a name="l19096"></a><span class="lineno">19096</span>&#160;                    }</div>
<div class="line"><a name="l19097"></a><span class="lineno">19097</span>&#160;                }</div>
<div class="line"><a name="l19098"></a><span class="lineno">19098</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19099"></a><span class="lineno">19099</span>&#160;            }</div>
<div class="line"><a name="l19100"></a><span class="lineno">19100</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;blockquote&#39;</span>: {</div>
<div class="line"><a name="l19101"></a><span class="lineno">19101</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l19102"></a><span class="lineno">19102</span>&#160;                    $this-&gt;rMargin += <a class="code" href="../../d4/d40/classTCPDF.html#a66ab086d27a31dd0a7a7c69ea87b3767">$this-&gt;listindent</a>;</div>
<div class="line"><a name="l19103"></a><span class="lineno">19103</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l19104"></a><span class="lineno">19104</span>&#160;                    $this-&gt;lMargin += <a class="code" href="../../d4/d40/classTCPDF.html#a66ab086d27a31dd0a7a7c69ea87b3767">$this-&gt;listindent</a>;</div>
<div class="line"><a name="l19105"></a><span class="lineno">19105</span>&#160;                }</div>
<div class="line"><a name="l19106"></a><span class="lineno">19106</span>&#160;                ++<a class="code" href="../../d4/d40/classTCPDF.html#a1f87a9ca1927053aed6c3188edeb1d28">$this-&gt;listindentlevel</a>;</div>
<div class="line"><a name="l19107"></a><span class="lineno">19107</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a885b5862782e1d3ff05f349f278ca664">addHTMLVertSpace</a>($hbz, $hb, $cell, $firsttag);</div>
<div class="line"><a name="l19108"></a><span class="lineno">19108</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19109"></a><span class="lineno">19109</span>&#160;            }</div>
<div class="line"><a name="l19110"></a><span class="lineno">19110</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;br&#39;</span>: {</div>
<div class="line"><a name="l19111"></a><span class="lineno">19111</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a885b5862782e1d3ff05f349f278ca664">addHTMLVertSpace</a>($hbz, $hb, $cell, $firsttag);</div>
<div class="line"><a name="l19112"></a><span class="lineno">19112</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19113"></a><span class="lineno">19113</span>&#160;            }</div>
<div class="line"><a name="l19114"></a><span class="lineno">19114</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;div&#39;</span>: {</div>
<div class="line"><a name="l19115"></a><span class="lineno">19115</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a885b5862782e1d3ff05f349f278ca664">addHTMLVertSpace</a>($hbz, $hb, $cell, $firsttag);</div>
<div class="line"><a name="l19116"></a><span class="lineno">19116</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19117"></a><span class="lineno">19117</span>&#160;            }</div>
<div class="line"><a name="l19118"></a><span class="lineno">19118</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;p&#39;</span>: {</div>
<div class="line"><a name="l19119"></a><span class="lineno">19119</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a885b5862782e1d3ff05f349f278ca664">addHTMLVertSpace</a>($hbz, $hb, $cell, $firsttag);</div>
<div class="line"><a name="l19120"></a><span class="lineno">19120</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19121"></a><span class="lineno">19121</span>&#160;            }</div>
<div class="line"><a name="l19122"></a><span class="lineno">19122</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;pre&#39;</span>: {</div>
<div class="line"><a name="l19123"></a><span class="lineno">19123</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a885b5862782e1d3ff05f349f278ca664">addHTMLVertSpace</a>($hbz, $hb, $cell, $firsttag);</div>
<div class="line"><a name="l19124"></a><span class="lineno">19124</span>&#160;                $this-&gt;premode = <span class="keyword">true</span>;</div>
<div class="line"><a name="l19125"></a><span class="lineno">19125</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19126"></a><span class="lineno">19126</span>&#160;            }</div>
<div class="line"><a name="l19127"></a><span class="lineno">19127</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;sup&#39;</span>: {</div>
<div class="line"><a name="l19128"></a><span class="lineno">19128</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a00ec13928f57b17c21040acc881fe482">SetXY</a>($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a415a80a301208fa77552048b27d2e0ce">GetX</a>(), $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ae3b6169ba729309f289a5ac9680dd799">GetY</a>() - ((0.7 * $this-&gt;FontSizePt) / $this-&gt;k));</div>
<div class="line"><a name="l19129"></a><span class="lineno">19129</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19130"></a><span class="lineno">19130</span>&#160;            }</div>
<div class="line"><a name="l19131"></a><span class="lineno">19131</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;sub&#39;</span>: {</div>
<div class="line"><a name="l19132"></a><span class="lineno">19132</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a00ec13928f57b17c21040acc881fe482">SetXY</a>($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a415a80a301208fa77552048b27d2e0ce">GetX</a>(), $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ae3b6169ba729309f289a5ac9680dd799">GetY</a>() + ((0.3 * $this-&gt;FontSizePt) / $this-&gt;k));</div>
<div class="line"><a name="l19133"></a><span class="lineno">19133</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19134"></a><span class="lineno">19134</span>&#160;            }</div>
<div class="line"><a name="l19135"></a><span class="lineno">19135</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;h1&#39;</span>:</div>
<div class="line"><a name="l19136"></a><span class="lineno">19136</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;h2&#39;</span>:</div>
<div class="line"><a name="l19137"></a><span class="lineno">19137</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;h3&#39;</span>:</div>
<div class="line"><a name="l19138"></a><span class="lineno">19138</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;h4&#39;</span>:</div>
<div class="line"><a name="l19139"></a><span class="lineno">19139</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;h5&#39;</span>:</div>
<div class="line"><a name="l19140"></a><span class="lineno">19140</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;h6&#39;</span>: {</div>
<div class="line"><a name="l19141"></a><span class="lineno">19141</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a885b5862782e1d3ff05f349f278ca664">addHTMLVertSpace</a>($hbz, $hb, $cell, $firsttag);</div>
<div class="line"><a name="l19142"></a><span class="lineno">19142</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19143"></a><span class="lineno">19143</span>&#160;            }</div>
<div class="line"><a name="l19144"></a><span class="lineno">19144</span>&#160;            <span class="comment">// Form fields (since 4.8.000 - 2009-09-07)</span></div>
<div class="line"><a name="l19145"></a><span class="lineno">19145</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;form&#39;</span>: {</div>
<div class="line"><a name="l19146"></a><span class="lineno">19146</span>&#160;                <span class="keywordflow">if</span> (isset($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;action&#39;</span>])) {</div>
<div class="line"><a name="l19147"></a><span class="lineno">19147</span>&#160;                    $this-&gt;form_action = $tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;action&#39;</span>];</div>
<div class="line"><a name="l19148"></a><span class="lineno">19148</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l19149"></a><span class="lineno">19149</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">Error</a>(<span class="stringliteral">&#39;Please explicitly set action attribute path!&#39;</span>);</div>
<div class="line"><a name="l19150"></a><span class="lineno">19150</span>&#160;                }</div>
<div class="line"><a name="l19151"></a><span class="lineno">19151</span>&#160;                <span class="keywordflow">if</span> (isset($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;enctype&#39;</span>])) {</div>
<div class="line"><a name="l19152"></a><span class="lineno">19152</span>&#160;                    $this-&gt;form_enctype = $tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;enctype&#39;</span>];</div>
<div class="line"><a name="l19153"></a><span class="lineno">19153</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l19154"></a><span class="lineno">19154</span>&#160;                    $this-&gt;form_enctype = <span class="stringliteral">&#39;application/x-www-form-urlencoded&#39;</span>;</div>
<div class="line"><a name="l19155"></a><span class="lineno">19155</span>&#160;                }</div>
<div class="line"><a name="l19156"></a><span class="lineno">19156</span>&#160;                <span class="keywordflow">if</span> (isset($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;method&#39;</span>])) {</div>
<div class="line"><a name="l19157"></a><span class="lineno">19157</span>&#160;                    $this-&gt;form_mode = $tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;method&#39;</span>];</div>
<div class="line"><a name="l19158"></a><span class="lineno">19158</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l19159"></a><span class="lineno">19159</span>&#160;                    $this-&gt;form_mode = <span class="stringliteral">&#39;post&#39;</span>;</div>
<div class="line"><a name="l19160"></a><span class="lineno">19160</span>&#160;                }</div>
<div class="line"><a name="l19161"></a><span class="lineno">19161</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19162"></a><span class="lineno">19162</span>&#160;            }</div>
<div class="line"><a name="l19163"></a><span class="lineno">19163</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;input&#39;</span>: {</div>
<div class="line"><a name="l19164"></a><span class="lineno">19164</span>&#160;                <span class="keywordflow">if</span> (isset($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;name&#39;</span>]) AND !TCPDF_STATIC::empty_string($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;name&#39;</span>])) {</div>
<div class="line"><a name="l19165"></a><span class="lineno">19165</span>&#160;                    $name = $tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;name&#39;</span>];</div>
<div class="line"><a name="l19166"></a><span class="lineno">19166</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l19167"></a><span class="lineno">19167</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19168"></a><span class="lineno">19168</span>&#160;                }</div>
<div class="line"><a name="l19169"></a><span class="lineno">19169</span>&#160;                $prop = array();</div>
<div class="line"><a name="l19170"></a><span class="lineno">19170</span>&#160;                $opt = array();</div>
<div class="line"><a name="l19171"></a><span class="lineno">19171</span>&#160;                <span class="keywordflow">if</span> (isset($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;readonly&#39;</span>]) AND !TCPDF_STATIC::empty_string($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;readonly&#39;</span>])) {</div>
<div class="line"><a name="l19172"></a><span class="lineno">19172</span>&#160;                    $prop[<span class="stringliteral">&#39;readonly&#39;</span>] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l19173"></a><span class="lineno">19173</span>&#160;                }</div>
<div class="line"><a name="l19174"></a><span class="lineno">19174</span>&#160;                <span class="keywordflow">if</span> (isset($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;value&#39;</span>]) AND !TCPDF_STATIC::empty_string($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;value&#39;</span>])) {</div>
<div class="line"><a name="l19175"></a><span class="lineno">19175</span>&#160;                    $value = $tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;value&#39;</span>];</div>
<div class="line"><a name="l19176"></a><span class="lineno">19176</span>&#160;                }</div>
<div class="line"><a name="l19177"></a><span class="lineno">19177</span>&#160;                <span class="keywordflow">if</span> (isset($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;maxlength&#39;</span>]) AND !TCPDF_STATIC::empty_string($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;maxlength&#39;</span>])) {</div>
<div class="line"><a name="l19178"></a><span class="lineno">19178</span>&#160;                    $opt[<span class="stringliteral">&#39;maxlen&#39;</span>] = intval($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;maxlength&#39;</span>]);</div>
<div class="line"><a name="l19179"></a><span class="lineno">19179</span>&#160;                }</div>
<div class="line"><a name="l19180"></a><span class="lineno">19180</span>&#160;                <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a25c7f71b3fcb19024497ea620f885346">getCellHeight</a>($this-&gt;FontSize);</div>
<div class="line"><a name="l19181"></a><span class="lineno">19181</span>&#160;                <span class="keywordflow">if</span> (isset($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;size&#39;</span>]) AND !TCPDF_STATIC::empty_string($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;size&#39;</span>])) {</div>
<div class="line"><a name="l19182"></a><span class="lineno">19182</span>&#160;                    <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = intval($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;size&#39;</span>]) * $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8075c1f04b6fbddc957cff786c4b16d9">GetStringWidth</a>(chr(32)) * 2;</div>
<div class="line"><a name="l19183"></a><span class="lineno">19183</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l19184"></a><span class="lineno">19184</span>&#160;                    <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>;</div>
<div class="line"><a name="l19185"></a><span class="lineno">19185</span>&#160;                }</div>
<div class="line"><a name="l19186"></a><span class="lineno">19186</span>&#160;                <span class="keywordflow">if</span> (isset($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>]) AND (($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>] == <span class="stringliteral">&#39;checked&#39;</span>) OR ($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;checked&#39;</span>] == <span class="stringliteral">&#39;true&#39;</span>))) {</div>
<div class="line"><a name="l19187"></a><span class="lineno">19187</span>&#160;                    $checked = <span class="keyword">true</span>;</div>
<div class="line"><a name="l19188"></a><span class="lineno">19188</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l19189"></a><span class="lineno">19189</span>&#160;                    $checked = <span class="keyword">false</span>;</div>
<div class="line"><a name="l19190"></a><span class="lineno">19190</span>&#160;                }</div>
<div class="line"><a name="l19191"></a><span class="lineno">19191</span>&#160;                <span class="keywordflow">if</span> (isset($tag[<span class="stringliteral">&#39;align&#39;</span>])) {</div>
<div class="line"><a name="l19192"></a><span class="lineno">19192</span>&#160;                    <span class="keywordflow">switch</span> ($tag[<span class="stringliteral">&#39;align&#39;</span>]) {</div>
<div class="line"><a name="l19193"></a><span class="lineno">19193</span>&#160;                        <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>: {</div>
<div class="line"><a name="l19194"></a><span class="lineno">19194</span>&#160;                            $opt[<span class="charliteral">&#39;q&#39;</span>] = 1;</div>
<div class="line"><a name="l19195"></a><span class="lineno">19195</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19196"></a><span class="lineno">19196</span>&#160;                        }</div>
<div class="line"><a name="l19197"></a><span class="lineno">19197</span>&#160;                        <span class="keywordflow">case</span> <span class="charliteral">&#39;R&#39;</span>: {</div>
<div class="line"><a name="l19198"></a><span class="lineno">19198</span>&#160;                            $opt[<span class="charliteral">&#39;q&#39;</span>] = 2;</div>
<div class="line"><a name="l19199"></a><span class="lineno">19199</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19200"></a><span class="lineno">19200</span>&#160;                        }</div>
<div class="line"><a name="l19201"></a><span class="lineno">19201</span>&#160;                        <span class="keywordflow">case</span> <span class="charliteral">&#39;L&#39;</span>:</div>
<div class="line"><a name="l19202"></a><span class="lineno">19202</span>&#160;                        <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l19203"></a><span class="lineno">19203</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19204"></a><span class="lineno">19204</span>&#160;                        }</div>
<div class="line"><a name="l19205"></a><span class="lineno">19205</span>&#160;                    }</div>
<div class="line"><a name="l19206"></a><span class="lineno">19206</span>&#160;                }</div>
<div class="line"><a name="l19207"></a><span class="lineno">19207</span>&#160;                <span class="keywordflow">switch</span> ($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;type&#39;</span>]) {</div>
<div class="line"><a name="l19208"></a><span class="lineno">19208</span>&#160;                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;text&#39;</span>: {</div>
<div class="line"><a name="l19209"></a><span class="lineno">19209</span>&#160;                        <span class="keywordflow">if</span> (isset($value)) {</div>
<div class="line"><a name="l19210"></a><span class="lineno">19210</span>&#160;                            $opt[<span class="charliteral">&#39;v&#39;</span>] = $value;</div>
<div class="line"><a name="l19211"></a><span class="lineno">19211</span>&#160;                        }</div>
<div class="line"><a name="l19212"></a><span class="lineno">19212</span>&#160;                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a71d382a4356e7fb3f9fa72e53642c09c">TextField</a>($name, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $prop, $opt, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l19213"></a><span class="lineno">19213</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19214"></a><span class="lineno">19214</span>&#160;                    }</div>
<div class="line"><a name="l19215"></a><span class="lineno">19215</span>&#160;                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;password&#39;</span>: {</div>
<div class="line"><a name="l19216"></a><span class="lineno">19216</span>&#160;                        <span class="keywordflow">if</span> (isset($value)) {</div>
<div class="line"><a name="l19217"></a><span class="lineno">19217</span>&#160;                            $opt[<span class="charliteral">&#39;v&#39;</span>] = $value;</div>
<div class="line"><a name="l19218"></a><span class="lineno">19218</span>&#160;                        }</div>
<div class="line"><a name="l19219"></a><span class="lineno">19219</span>&#160;                        $prop[<span class="stringliteral">&#39;password&#39;</span>] = <span class="stringliteral">&#39;true&#39;</span>;</div>
<div class="line"><a name="l19220"></a><span class="lineno">19220</span>&#160;                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a71d382a4356e7fb3f9fa72e53642c09c">TextField</a>($name, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $prop, $opt, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l19221"></a><span class="lineno">19221</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19222"></a><span class="lineno">19222</span>&#160;                    }</div>
<div class="line"><a name="l19223"></a><span class="lineno">19223</span>&#160;                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;checkbox&#39;</span>: {</div>
<div class="line"><a name="l19224"></a><span class="lineno">19224</span>&#160;                        <span class="keywordflow">if</span> (!isset($value)) {</div>
<div class="line"><a name="l19225"></a><span class="lineno">19225</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19226"></a><span class="lineno">19226</span>&#160;                        }</div>
<div class="line"><a name="l19227"></a><span class="lineno">19227</span>&#160;                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a9237608d2579943f4bb2428617bfb73c">CheckBox</a>($name, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, $checked, $prop, $opt, $value, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l19228"></a><span class="lineno">19228</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19229"></a><span class="lineno">19229</span>&#160;                    }</div>
<div class="line"><a name="l19230"></a><span class="lineno">19230</span>&#160;                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;radio&#39;</span>: {</div>
<div class="line"><a name="l19231"></a><span class="lineno">19231</span>&#160;                        <span class="keywordflow">if</span> (!isset($value)) {</div>
<div class="line"><a name="l19232"></a><span class="lineno">19232</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19233"></a><span class="lineno">19233</span>&#160;                        }</div>
<div class="line"><a name="l19234"></a><span class="lineno">19234</span>&#160;                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8a1af14cce3111886a7ec8024a02bbbc">RadioButton</a>($name, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, $prop, $opt, $value, $checked, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l19235"></a><span class="lineno">19235</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19236"></a><span class="lineno">19236</span>&#160;                    }</div>
<div class="line"><a name="l19237"></a><span class="lineno">19237</span>&#160;                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;submit&#39;</span>: {</div>
<div class="line"><a name="l19238"></a><span class="lineno">19238</span>&#160;                        <span class="keywordflow">if</span> (!isset($value)) {</div>
<div class="line"><a name="l19239"></a><span class="lineno">19239</span>&#160;                            $value = <span class="stringliteral">&#39;submit&#39;</span>;</div>
<div class="line"><a name="l19240"></a><span class="lineno">19240</span>&#160;                        }</div>
<div class="line"><a name="l19241"></a><span class="lineno">19241</span>&#160;                        <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8075c1f04b6fbddc957cff786c4b16d9">GetStringWidth</a>($value) * 1.5;</div>
<div class="line"><a name="l19242"></a><span class="lineno">19242</span>&#160;                        <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> *= 1.6;</div>
<div class="line"><a name="l19243"></a><span class="lineno">19243</span>&#160;                        $prop = array(<span class="stringliteral">&#39;lineWidth&#39;</span>=&gt;1, <span class="stringliteral">&#39;borderStyle&#39;</span>=&gt;<span class="stringliteral">&#39;beveled&#39;</span>, <span class="stringliteral">&#39;fillColor&#39;</span>=&gt;array(196, 196, 196), <span class="stringliteral">&#39;strokeColor&#39;</span>=&gt;array(255, 255, 255));</div>
<div class="line"><a name="l19244"></a><span class="lineno">19244</span>&#160;                        $action = array();</div>
<div class="line"><a name="l19245"></a><span class="lineno">19245</span>&#160;                        $action[<span class="charliteral">&#39;S&#39;</span>] = <span class="stringliteral">&#39;SubmitForm&#39;</span>;</div>
<div class="line"><a name="l19246"></a><span class="lineno">19246</span>&#160;                        $action[<span class="charliteral">&#39;F&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#a1302a2cfd195515184e2baab0ab20c7e">$this-&gt;form_action</a>;</div>
<div class="line"><a name="l19247"></a><span class="lineno">19247</span>&#160;                        <span class="keywordflow">if</span> ($this-&gt;form_enctype != <span class="stringliteral">&#39;FDF&#39;</span>) {</div>
<div class="line"><a name="l19248"></a><span class="lineno">19248</span>&#160;                            $action[<span class="stringliteral">&#39;Flags&#39;</span>] = array(<span class="stringliteral">&#39;ExportFormat&#39;</span>);</div>
<div class="line"><a name="l19249"></a><span class="lineno">19249</span>&#160;                        }</div>
<div class="line"><a name="l19250"></a><span class="lineno">19250</span>&#160;                        <span class="keywordflow">if</span> ($this-&gt;form_mode == <span class="stringliteral">&#39;get&#39;</span>) {</div>
<div class="line"><a name="l19251"></a><span class="lineno">19251</span>&#160;                            $action[<span class="stringliteral">&#39;Flags&#39;</span>] = array(<span class="stringliteral">&#39;GetMethod&#39;</span>);</div>
<div class="line"><a name="l19252"></a><span class="lineno">19252</span>&#160;                        }</div>
<div class="line"><a name="l19253"></a><span class="lineno">19253</span>&#160;                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a93f18d686b7db10133a76317bfbb0d59">Button</a>($name, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $value, $action, $prop, $opt, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l19254"></a><span class="lineno">19254</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19255"></a><span class="lineno">19255</span>&#160;                    }</div>
<div class="line"><a name="l19256"></a><span class="lineno">19256</span>&#160;                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;reset&#39;</span>: {</div>
<div class="line"><a name="l19257"></a><span class="lineno">19257</span>&#160;                        <span class="keywordflow">if</span> (!isset($value)) {</div>
<div class="line"><a name="l19258"></a><span class="lineno">19258</span>&#160;                            $value = <span class="stringliteral">&#39;reset&#39;</span>;</div>
<div class="line"><a name="l19259"></a><span class="lineno">19259</span>&#160;                        }</div>
<div class="line"><a name="l19260"></a><span class="lineno">19260</span>&#160;                        <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8075c1f04b6fbddc957cff786c4b16d9">GetStringWidth</a>($value) * 1.5;</div>
<div class="line"><a name="l19261"></a><span class="lineno">19261</span>&#160;                        <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> *= 1.6;</div>
<div class="line"><a name="l19262"></a><span class="lineno">19262</span>&#160;                        $prop = array(<span class="stringliteral">&#39;lineWidth&#39;</span>=&gt;1, <span class="stringliteral">&#39;borderStyle&#39;</span>=&gt;<span class="stringliteral">&#39;beveled&#39;</span>, <span class="stringliteral">&#39;fillColor&#39;</span>=&gt;array(196, 196, 196), <span class="stringliteral">&#39;strokeColor&#39;</span>=&gt;array(255, 255, 255));</div>
<div class="line"><a name="l19263"></a><span class="lineno">19263</span>&#160;                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a93f18d686b7db10133a76317bfbb0d59">Button</a>($name, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $value, array(<span class="charliteral">&#39;S&#39;</span>=&gt;<span class="stringliteral">&#39;ResetForm&#39;</span>), $prop, $opt, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l19264"></a><span class="lineno">19264</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19265"></a><span class="lineno">19265</span>&#160;                    }</div>
<div class="line"><a name="l19266"></a><span class="lineno">19266</span>&#160;                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;file&#39;</span>: {</div>
<div class="line"><a name="l19267"></a><span class="lineno">19267</span>&#160;                        $prop[<span class="stringliteral">&#39;fileSelect&#39;</span>] = <span class="stringliteral">&#39;true&#39;</span>;</div>
<div class="line"><a name="l19268"></a><span class="lineno">19268</span>&#160;                        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a71d382a4356e7fb3f9fa72e53642c09c">TextField</a>($name, <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, $prop, $opt, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l19269"></a><span class="lineno">19269</span>&#160;                        <span class="keywordflow">if</span> (!isset($value)) {</div>
<div class="line"><a name="l19270"></a><span class="lineno">19270</span>&#160;                            $value = <span class="charliteral">&#39;*&#39;</span>;</div>
<div class="line"><a name="l19271"></a><span class="lineno">19271</span>&#160;                        }</div>
<div class="line"><a name="l19272"></a><span class="lineno">19272</span>&#160;                        <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a> = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a8075c1f04b6fbddc957cff786c4b16d9">GetStringWidth</a>($value) * 2;</div>
<div class="line"><a name="l19273"></a><span class="lineno">19273</span>&#160;                        <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> *= 1.2;</div>
<div class="line"><a name="l19274"></a><span class="lineno">19274</span>&#160;                        $prop = array(<span class="stringliteral">&#39;lineWidth&#39;</span>=&gt;1, <span class="stringliteral">&#39;borderStyle&#39;</span>=&gt;<span class="stringliteral">&#39;beveled&#39;</span>, <span class="stringliteral">&#39;fillColor&#39;</span>=&gt;array(196, 196, 196), <span class="stringliteral">&#39;strokeColor&#39;</span>=&gt;array(255, 255, 255));</div>
<div class="line"><a name="l19275"></a><span class="lineno">19275</span>&#160;                        $jsaction = <span class="stringliteral">&#39;var f=this.getField(\&#39;&#39;</span>.$name.<span class="charliteral">&#39;\&#39;</span>); f.browseForFileToSubmit();<span class="stringliteral">&#39;;</span></div>
<div class="line"><a name="l19276"></a><span class="lineno">19276</span>&#160;<span class="stringliteral">                        $this-&gt;Button(&#39;</span>FB_<span class="stringliteral">&#39;.$name, $w, $h, $value, $jsaction, $prop, $opt, &#39;</span><span class="stringliteral">&#39;, &#39;</span><span class="stringliteral">&#39;, false);</span></div>
<div class="line"><a name="l19277"></a><span class="lineno">19277</span>&#160;<span class="stringliteral">                        break;</span></div>
<div class="line"><a name="l19278"></a><span class="lineno">19278</span>&#160;<span class="stringliteral">                    }</span></div>
<div class="line"><a name="l19279"></a><span class="lineno">19279</span>&#160;<span class="stringliteral">                    case &#39;</span>hidden<span class="stringliteral">&#39;: {</span></div>
<div class="line"><a name="l19280"></a><span class="lineno">19280</span>&#160;<span class="stringliteral">                        if (isset($value)) {</span></div>
<div class="line"><a name="l19281"></a><span class="lineno">19281</span>&#160;<span class="stringliteral">                            $opt[&#39;</span>v<span class="stringliteral">&#39;] = $value;</span></div>
<div class="line"><a name="l19282"></a><span class="lineno">19282</span>&#160;<span class="stringliteral">                        }</span></div>
<div class="line"><a name="l19283"></a><span class="lineno">19283</span>&#160;<span class="stringliteral">                        $opt[&#39;</span>f<span class="stringliteral">&#39;] = array(&#39;</span>invisible<span class="stringliteral">&#39;, &#39;</span>hidden<span class="stringliteral">&#39;);</span></div>
<div class="line"><a name="l19284"></a><span class="lineno">19284</span>&#160;<span class="stringliteral">                        $this-&gt;TextField($name, 0, 0, $prop, $opt, &#39;</span><span class="stringliteral">&#39;, &#39;</span><span class="stringliteral">&#39;, false);</span></div>
<div class="line"><a name="l19285"></a><span class="lineno">19285</span>&#160;<span class="stringliteral">                        break;</span></div>
<div class="line"><a name="l19286"></a><span class="lineno">19286</span>&#160;<span class="stringliteral">                    }</span></div>
<div class="line"><a name="l19287"></a><span class="lineno">19287</span>&#160;<span class="stringliteral">                    case &#39;</span>image<span class="stringliteral">&#39;: {</span></div>
<div class="line"><a name="l19288"></a><span class="lineno">19288</span>&#160;<span class="stringliteral">                        // THIS TYPE MUST BE FIXED</span></div>
<div class="line"><a name="l19289"></a><span class="lineno">19289</span>&#160;<span class="stringliteral">                        if (isset($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>src<span class="stringliteral">&#39;]) AND !TCPDF_STATIC::empty_string($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>src<span class="stringliteral">&#39;])) {</span></div>
<div class="line"><a name="l19290"></a><span class="lineno">19290</span>&#160;<span class="stringliteral">                            $img = $tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>src<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l19291"></a><span class="lineno">19291</span>&#160;<span class="stringliteral">                        } else {</span></div>
<div class="line"><a name="l19292"></a><span class="lineno">19292</span>&#160;<span class="stringliteral">                            break;</span></div>
<div class="line"><a name="l19293"></a><span class="lineno">19293</span>&#160;<span class="stringliteral">                        }</span></div>
<div class="line"><a name="l19294"></a><span class="lineno">19294</span>&#160;<span class="stringliteral">                        $value = &#39;</span>img<span class="stringliteral">&#39;;</span></div>
<div class="line"><a name="l19295"></a><span class="lineno">19295</span>&#160;<span class="stringliteral">                        //$opt[&#39;</span>mk<span class="stringliteral">&#39;] = array(&#39;</span>i<span class="stringliteral">&#39;=&gt;$img, &#39;</span>tp<span class="stringliteral">&#39;=&gt;1, &#39;</span><span class="keywordflow">if</span><span class="stringliteral">&#39;=&gt;array(&#39;</span>sw<span class="stringliteral">&#39;=&gt;&#39;</span>A<span class="stringliteral">&#39;, &#39;</span>s<span class="stringliteral">&#39;=&gt;&#39;</span>A<span class="stringliteral">&#39;, &#39;</span>fb<span class="stringliteral">&#39;=&gt;false));</span></div>
<div class="line"><a name="l19296"></a><span class="lineno">19296</span>&#160;<span class="stringliteral">                        if (isset($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>onclick<span class="stringliteral">&#39;]) AND !empty($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>onclick<span class="stringliteral">&#39;])) {</span></div>
<div class="line"><a name="l19297"></a><span class="lineno">19297</span>&#160;<span class="stringliteral">                            $jsaction = $tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>onclick<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l19298"></a><span class="lineno">19298</span>&#160;<span class="stringliteral">                        } else {</span></div>
<div class="line"><a name="l19299"></a><span class="lineno">19299</span>&#160;<span class="stringliteral">                            $jsaction = &#39;</span><span class="stringliteral">&#39;;</span></div>
<div class="line"><a name="l19300"></a><span class="lineno">19300</span>&#160;<span class="stringliteral">                        }</span></div>
<div class="line"><a name="l19301"></a><span class="lineno">19301</span>&#160;<span class="stringliteral">                        $this-&gt;Button($name, $w, $h, $value, $jsaction, $prop, $opt, &#39;</span><span class="stringliteral">&#39;, &#39;</span><span class="stringliteral">&#39;, false);</span></div>
<div class="line"><a name="l19302"></a><span class="lineno">19302</span>&#160;<span class="stringliteral">                        break;</span></div>
<div class="line"><a name="l19303"></a><span class="lineno">19303</span>&#160;<span class="stringliteral">                    }</span></div>
<div class="line"><a name="l19304"></a><span class="lineno">19304</span>&#160;<span class="stringliteral">                    case &#39;</span>button<span class="stringliteral">&#39;: {</span></div>
<div class="line"><a name="l19305"></a><span class="lineno">19305</span>&#160;<span class="stringliteral">                        if (!isset($value)) {</span></div>
<div class="line"><a name="l19306"></a><span class="lineno">19306</span>&#160;<span class="stringliteral">                            $value = &#39;</span> <span class="stringliteral">&#39;;</span></div>
<div class="line"><a name="l19307"></a><span class="lineno">19307</span>&#160;<span class="stringliteral">                        }</span></div>
<div class="line"><a name="l19308"></a><span class="lineno">19308</span>&#160;<span class="stringliteral">                        $w = $this-&gt;GetStringWidth($value) * 1.5;</span></div>
<div class="line"><a name="l19309"></a><span class="lineno">19309</span>&#160;<span class="stringliteral">                        $h *= 1.6;</span></div>
<div class="line"><a name="l19310"></a><span class="lineno">19310</span>&#160;<span class="stringliteral">                        $prop = array(&#39;</span>lineWidth<span class="stringliteral">&#39;=&gt;1, &#39;</span>borderStyle<span class="stringliteral">&#39;=&gt;&#39;</span>beveled<span class="stringliteral">&#39;, &#39;</span>fillColor<span class="stringliteral">&#39;=&gt;array(196, 196, 196), &#39;</span>strokeColor<span class="stringliteral">&#39;=&gt;array(255, 255, 255));</span></div>
<div class="line"><a name="l19311"></a><span class="lineno">19311</span>&#160;<span class="stringliteral">                        if (isset($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>onclick<span class="stringliteral">&#39;]) AND !empty($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>onclick<span class="stringliteral">&#39;])) {</span></div>
<div class="line"><a name="l19312"></a><span class="lineno">19312</span>&#160;<span class="stringliteral">                            $jsaction = $tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>onclick<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l19313"></a><span class="lineno">19313</span>&#160;<span class="stringliteral">                        } else {</span></div>
<div class="line"><a name="l19314"></a><span class="lineno">19314</span>&#160;<span class="stringliteral">                            $jsaction = &#39;</span><span class="stringliteral">&#39;;</span></div>
<div class="line"><a name="l19315"></a><span class="lineno">19315</span>&#160;<span class="stringliteral">                        }</span></div>
<div class="line"><a name="l19316"></a><span class="lineno">19316</span>&#160;<span class="stringliteral">                        $this-&gt;Button($name, $w, $h, $value, $jsaction, $prop, $opt, &#39;</span><span class="stringliteral">&#39;, &#39;</span><span class="stringliteral">&#39;, false);</span></div>
<div class="line"><a name="l19317"></a><span class="lineno">19317</span>&#160;<span class="stringliteral">                        break;</span></div>
<div class="line"><a name="l19318"></a><span class="lineno">19318</span>&#160;<span class="stringliteral">                    }</span></div>
<div class="line"><a name="l19319"></a><span class="lineno">19319</span>&#160;<span class="stringliteral">                }</span></div>
<div class="line"><a name="l19320"></a><span class="lineno">19320</span>&#160;<span class="stringliteral">                break;</span></div>
<div class="line"><a name="l19321"></a><span class="lineno">19321</span>&#160;<span class="stringliteral">            }</span></div>
<div class="line"><a name="l19322"></a><span class="lineno">19322</span>&#160;<span class="stringliteral">            case &#39;</span>textarea<span class="stringliteral">&#39;: {</span></div>
<div class="line"><a name="l19323"></a><span class="lineno">19323</span>&#160;<span class="stringliteral">                $prop = array();</span></div>
<div class="line"><a name="l19324"></a><span class="lineno">19324</span>&#160;<span class="stringliteral">                $opt = array();</span></div>
<div class="line"><a name="l19325"></a><span class="lineno">19325</span>&#160;<span class="stringliteral">                if (isset($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>readonly<span class="stringliteral">&#39;]) AND !TCPDF_STATIC::empty_string($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>readonly<span class="stringliteral">&#39;])) {</span></div>
<div class="line"><a name="l19326"></a><span class="lineno">19326</span>&#160;<span class="stringliteral">                    $prop[&#39;</span>readonly<span class="stringliteral">&#39;] = true;</span></div>
<div class="line"><a name="l19327"></a><span class="lineno">19327</span>&#160;<span class="stringliteral">                }</span></div>
<div class="line"><a name="l19328"></a><span class="lineno">19328</span>&#160;<span class="stringliteral">                if (isset($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>name<span class="stringliteral">&#39;]) AND !TCPDF_STATIC::empty_string($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>name<span class="stringliteral">&#39;])) {</span></div>
<div class="line"><a name="l19329"></a><span class="lineno">19329</span>&#160;<span class="stringliteral">                    $name = $tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>name<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l19330"></a><span class="lineno">19330</span>&#160;<span class="stringliteral">                } else {</span></div>
<div class="line"><a name="l19331"></a><span class="lineno">19331</span>&#160;<span class="stringliteral">                    break;</span></div>
<div class="line"><a name="l19332"></a><span class="lineno">19332</span>&#160;<span class="stringliteral">                }</span></div>
<div class="line"><a name="l19333"></a><span class="lineno">19333</span>&#160;<span class="stringliteral">                if (isset($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>value<span class="stringliteral">&#39;]) AND !TCPDF_STATIC::empty_string($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>value<span class="stringliteral">&#39;])) {</span></div>
<div class="line"><a name="l19334"></a><span class="lineno">19334</span>&#160;<span class="stringliteral">                    $opt[&#39;</span>v<span class="stringliteral">&#39;] = $tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>value<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l19335"></a><span class="lineno">19335</span>&#160;<span class="stringliteral">                }</span></div>
<div class="line"><a name="l19336"></a><span class="lineno">19336</span>&#160;<span class="stringliteral">                if (isset($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>cols<span class="stringliteral">&#39;]) AND !TCPDF_STATIC::empty_string($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>cols<span class="stringliteral">&#39;])) {</span></div>
<div class="line"><a name="l19337"></a><span class="lineno">19337</span>&#160;<span class="stringliteral">                    $w = intval($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>cols<span class="stringliteral">&#39;]) * $this-&gt;GetStringWidth(chr(32)) * 2;</span></div>
<div class="line"><a name="l19338"></a><span class="lineno">19338</span>&#160;<span class="stringliteral">                } else {</span></div>
<div class="line"><a name="l19339"></a><span class="lineno">19339</span>&#160;<span class="stringliteral">                    $w = 40;</span></div>
<div class="line"><a name="l19340"></a><span class="lineno">19340</span>&#160;<span class="stringliteral">                }</span></div>
<div class="line"><a name="l19341"></a><span class="lineno">19341</span>&#160;<span class="stringliteral">                if (isset($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>rows<span class="stringliteral">&#39;]) AND !TCPDF_STATIC::empty_string($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>rows<span class="stringliteral">&#39;])) {</span></div>
<div class="line"><a name="l19342"></a><span class="lineno">19342</span>&#160;<span class="stringliteral">                    $h = intval($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>rows<span class="stringliteral">&#39;]) * $this-&gt;getCellHeight($this-&gt;FontSize);</span></div>
<div class="line"><a name="l19343"></a><span class="lineno">19343</span>&#160;<span class="stringliteral">                } else {</span></div>
<div class="line"><a name="l19344"></a><span class="lineno">19344</span>&#160;<span class="stringliteral">                    $h = 10;</span></div>
<div class="line"><a name="l19345"></a><span class="lineno">19345</span>&#160;<span class="stringliteral">                }</span></div>
<div class="line"><a name="l19346"></a><span class="lineno">19346</span>&#160;<span class="stringliteral">                $prop[&#39;</span>multiline<span class="stringliteral">&#39;] = &#39;</span><span class="keyword">true</span><span class="stringliteral">&#39;;</span></div>
<div class="line"><a name="l19347"></a><span class="lineno">19347</span>&#160;<span class="stringliteral">                $this-&gt;TextField($name, $w, $h, $prop, $opt, &#39;</span><span class="stringliteral">&#39;, &#39;</span><span class="stringliteral">&#39;, false);</span></div>
<div class="line"><a name="l19348"></a><span class="lineno">19348</span>&#160;<span class="stringliteral">                break;</span></div>
<div class="line"><a name="l19349"></a><span class="lineno">19349</span>&#160;<span class="stringliteral">            }</span></div>
<div class="line"><a name="l19350"></a><span class="lineno">19350</span>&#160;<span class="stringliteral">            case &#39;</span>select<span class="stringliteral">&#39;: {</span></div>
<div class="line"><a name="l19351"></a><span class="lineno">19351</span>&#160;<span class="stringliteral">                $h = $this-&gt;getCellHeight($this-&gt;FontSize);</span></div>
<div class="line"><a name="l19352"></a><span class="lineno">19352</span>&#160;<span class="stringliteral">                if (isset($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>size<span class="stringliteral">&#39;]) AND !TCPDF_STATIC::empty_string($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>size<span class="stringliteral">&#39;])) {</span></div>
<div class="line"><a name="l19353"></a><span class="lineno">19353</span>&#160;<span class="stringliteral">                    $h *= ($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>size<span class="stringliteral">&#39;] + 1);</span></div>
<div class="line"><a name="l19354"></a><span class="lineno">19354</span>&#160;<span class="stringliteral">                }</span></div>
<div class="line"><a name="l19355"></a><span class="lineno">19355</span>&#160;<span class="stringliteral">                $prop = array();</span></div>
<div class="line"><a name="l19356"></a><span class="lineno">19356</span>&#160;<span class="stringliteral">                $opt = array();</span></div>
<div class="line"><a name="l19357"></a><span class="lineno">19357</span>&#160;<span class="stringliteral">                if (isset($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>name<span class="stringliteral">&#39;]) AND !TCPDF_STATIC::empty_string($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>name<span class="stringliteral">&#39;])) {</span></div>
<div class="line"><a name="l19358"></a><span class="lineno">19358</span>&#160;<span class="stringliteral">                    $name = $tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>name<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l19359"></a><span class="lineno">19359</span>&#160;<span class="stringliteral">                } else {</span></div>
<div class="line"><a name="l19360"></a><span class="lineno">19360</span>&#160;<span class="stringliteral">                    break;</span></div>
<div class="line"><a name="l19361"></a><span class="lineno">19361</span>&#160;<span class="stringliteral">                }</span></div>
<div class="line"><a name="l19362"></a><span class="lineno">19362</span>&#160;<span class="stringliteral">                $w = 0;</span></div>
<div class="line"><a name="l19363"></a><span class="lineno">19363</span>&#160;<span class="stringliteral">                if (isset($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>opt<span class="stringliteral">&#39;]) AND !TCPDF_STATIC::empty_string($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>opt<span class="stringliteral">&#39;])) {</span></div>
<div class="line"><a name="l19364"></a><span class="lineno">19364</span>&#160;<span class="stringliteral">                    $options = explode(&#39;</span>#!NwL!#<span class="stringliteral">&#39;, $tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>opt<span class="stringliteral">&#39;]);</span></div>
<div class="line"><a name="l19365"></a><span class="lineno">19365</span>&#160;<span class="stringliteral">                    $values = array();</span></div>
<div class="line"><a name="l19366"></a><span class="lineno">19366</span>&#160;<span class="stringliteral">                    foreach ($options as $val) {</span></div>
<div class="line"><a name="l19367"></a><span class="lineno">19367</span>&#160;<span class="stringliteral">                        if (strpos($val, &#39;</span>#!TaB!#<span class="stringliteral">&#39;) !== false) {</span></div>
<div class="line"><a name="l19368"></a><span class="lineno">19368</span>&#160;<span class="stringliteral">                            $opts = explode(&#39;</span>#!TaB!#<span class="stringliteral">&#39;, $val);</span></div>
<div class="line"><a name="l19369"></a><span class="lineno">19369</span>&#160;<span class="stringliteral">                            $values[] = $opts;</span></div>
<div class="line"><a name="l19370"></a><span class="lineno">19370</span>&#160;<span class="stringliteral">                            $w = max($w, $this-&gt;GetStringWidth($opts[1]));</span></div>
<div class="line"><a name="l19371"></a><span class="lineno">19371</span>&#160;<span class="stringliteral">                        } else {</span></div>
<div class="line"><a name="l19372"></a><span class="lineno">19372</span>&#160;<span class="stringliteral">                            $values[] = $val;</span></div>
<div class="line"><a name="l19373"></a><span class="lineno">19373</span>&#160;<span class="stringliteral">                            $w = max($w, $this-&gt;GetStringWidth($val));</span></div>
<div class="line"><a name="l19374"></a><span class="lineno">19374</span>&#160;<span class="stringliteral">                        }</span></div>
<div class="line"><a name="l19375"></a><span class="lineno">19375</span>&#160;<span class="stringliteral">                    }</span></div>
<div class="line"><a name="l19376"></a><span class="lineno">19376</span>&#160;<span class="stringliteral">                } else {</span></div>
<div class="line"><a name="l19377"></a><span class="lineno">19377</span>&#160;<span class="stringliteral">                    break;</span></div>
<div class="line"><a name="l19378"></a><span class="lineno">19378</span>&#160;<span class="stringliteral">                }</span></div>
<div class="line"><a name="l19379"></a><span class="lineno">19379</span>&#160;<span class="stringliteral">                $w *= 2;</span></div>
<div class="line"><a name="l19380"></a><span class="lineno">19380</span>&#160;<span class="stringliteral">                if (isset($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>multiple<span class="stringliteral">&#39;]) AND ($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>multiple<span class="stringliteral">&#39;]=&#39;</span>multiple<span class="stringliteral">&#39;)) {</span></div>
<div class="line"><a name="l19381"></a><span class="lineno">19381</span>&#160;<span class="stringliteral">                    $prop[&#39;</span>multipleSelection<span class="stringliteral">&#39;] = &#39;</span><span class="keyword">true</span><span class="stringliteral">&#39;;</span></div>
<div class="line"><a name="l19382"></a><span class="lineno">19382</span>&#160;<span class="stringliteral">                    $this-&gt;ListBox($name, $w, $h, $values, $prop, $opt, &#39;</span><span class="stringliteral">&#39;, &#39;</span><span class="stringliteral">&#39;, false);</span></div>
<div class="line"><a name="l19383"></a><span class="lineno">19383</span>&#160;<span class="stringliteral">                } else {</span></div>
<div class="line"><a name="l19384"></a><span class="lineno">19384</span>&#160;<span class="stringliteral">                    $this-&gt;ComboBox($name, $w, $h, $values, $prop, $opt, &#39;</span><span class="stringliteral">&#39;, &#39;</span><span class="stringliteral">&#39;, false);</span></div>
<div class="line"><a name="l19385"></a><span class="lineno">19385</span>&#160;<span class="stringliteral">                }</span></div>
<div class="line"><a name="l19386"></a><span class="lineno">19386</span>&#160;<span class="stringliteral">                break;</span></div>
<div class="line"><a name="l19387"></a><span class="lineno">19387</span>&#160;<span class="stringliteral">            }</span></div>
<div class="line"><a name="l19388"></a><span class="lineno">19388</span>&#160;<span class="stringliteral">            case &#39;</span>tcpdf<span class="stringliteral">&#39;: {</span></div>
<div class="line"><a name="l19389"></a><span class="lineno">19389</span>&#160;<span class="stringliteral">                if (defined(&#39;</span><a class="code" href="../../d5/dc0/tcpdf__config_8php.html#a2caf7ac30acb5a1d373ad91fadd6b0df">K_TCPDF_CALLS_IN_HTML</a><span class="stringliteral">&#39;) AND (K_TCPDF_CALLS_IN_HTML === true)) {</span></div>
<div class="line"><a name="l19390"></a><span class="lineno">19390</span>&#160;<span class="stringliteral">                    // Special tag used to call TCPDF methods</span></div>
<div class="line"><a name="l19391"></a><span class="lineno">19391</span>&#160;<span class="stringliteral">                    if (isset($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>method<span class="stringliteral">&#39;])) {</span></div>
<div class="line"><a name="l19392"></a><span class="lineno">19392</span>&#160;<span class="stringliteral">                        $tcpdf_method = $tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>method<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l19393"></a><span class="lineno">19393</span>&#160;<span class="stringliteral">                        if (method_exists($this, $tcpdf_method)) {</span></div>
<div class="line"><a name="l19394"></a><span class="lineno">19394</span>&#160;<span class="stringliteral">                            if (isset($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>params<span class="stringliteral">&#39;]) AND (!empty($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>params<span class="stringliteral">&#39;]))) {</span></div>
<div class="line"><a name="l19395"></a><span class="lineno">19395</span>&#160;<span class="stringliteral">                                $params = TCPDF_STATIC::unserializeTCPDFtagParameters($tag[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>params<span class="stringliteral">&#39;]);</span></div>
<div class="line"><a name="l19396"></a><span class="lineno">19396</span>&#160;<span class="stringliteral">                                call_user_func_array(array($this, $tcpdf_method), $params);</span></div>
<div class="line"><a name="l19397"></a><span class="lineno">19397</span>&#160;<span class="stringliteral">                            } else {</span></div>
<div class="line"><a name="l19398"></a><span class="lineno">19398</span>&#160;<span class="stringliteral">                                $this-&gt;$tcpdf_method();</span></div>
<div class="line"><a name="l19399"></a><span class="lineno">19399</span>&#160;<span class="stringliteral">                            }</span></div>
<div class="line"><a name="l19400"></a><span class="lineno">19400</span>&#160;<span class="stringliteral">                            $this-&gt;newline = true;</span></div>
<div class="line"><a name="l19401"></a><span class="lineno">19401</span>&#160;<span class="stringliteral">                        }</span></div>
<div class="line"><a name="l19402"></a><span class="lineno">19402</span>&#160;<span class="stringliteral">                    }</span></div>
<div class="line"><a name="l19403"></a><span class="lineno">19403</span>&#160;<span class="stringliteral">                }</span></div>
<div class="line"><a name="l19404"></a><span class="lineno">19404</span>&#160;<span class="stringliteral">                break;</span></div>
<div class="line"><a name="l19405"></a><span class="lineno">19405</span>&#160;<span class="stringliteral">            }</span></div>
<div class="line"><a name="l19406"></a><span class="lineno">19406</span>&#160;<span class="stringliteral">            default: {</span></div>
<div class="line"><a name="l19407"></a><span class="lineno">19407</span>&#160;<span class="stringliteral">                break;</span></div>
<div class="line"><a name="l19408"></a><span class="lineno">19408</span>&#160;<span class="stringliteral">            }</span></div>
<div class="line"><a name="l19409"></a><span class="lineno">19409</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l19410"></a><span class="lineno">19410</span>&#160;<span class="stringliteral">        // define tags that support borders and background colors</span></div>
<div class="line"><a name="l19411"></a><span class="lineno">19411</span>&#160;<span class="stringliteral">        $bordertags = array(&#39;</span>blockquote<span class="charliteral">&#39;,&#39;</span>br<span class="charliteral">&#39;,&#39;</span>dd<span class="charliteral">&#39;,&#39;</span>dl<span class="charliteral">&#39;,&#39;</span>div<span class="charliteral">&#39;,&#39;</span>dt<span class="charliteral">&#39;,&#39;</span>h1<span class="charliteral">&#39;,&#39;</span>h2<span class="charliteral">&#39;,&#39;</span>h3<span class="charliteral">&#39;,&#39;</span>h4<span class="charliteral">&#39;,&#39;</span>h5<span class="charliteral">&#39;,&#39;</span>h6<span class="charliteral">&#39;,&#39;</span>hr<span class="charliteral">&#39;,&#39;</span>li<span class="charliteral">&#39;,&#39;</span>ol<span class="charliteral">&#39;,&#39;</span>p<span class="charliteral">&#39;,&#39;</span>pre<span class="charliteral">&#39;,&#39;</span>ul<span class="charliteral">&#39;,&#39;</span>tcpdf<span class="charliteral">&#39;,&#39;</span>table<span class="stringliteral">&#39;);</span></div>
<div class="line"><a name="l19412"></a><span class="lineno">19412</span>&#160;<span class="stringliteral">        if (in_array($tag[&#39;</span>value<span class="stringliteral">&#39;], $bordertags)) {</span></div>
<div class="line"><a name="l19413"></a><span class="lineno">19413</span>&#160;<span class="stringliteral">            // set border</span></div>
<div class="line"><a name="l19414"></a><span class="lineno">19414</span>&#160;<span class="stringliteral">            $dom[$key][&#39;</span>borderposition<span class="stringliteral">&#39;] = $this-&gt;getBorderStartPosition();</span></div>
<div class="line"><a name="l19415"></a><span class="lineno">19415</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l19416"></a><span class="lineno">19416</span>&#160;<span class="stringliteral">        if ($dom[$key][&#39;</span><span class="keyword">self</span><span class="stringliteral">&#39;] AND isset($dom[$key][&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>pagebreakafter<span class="stringliteral">&#39;])) {</span></div>
<div class="line"><a name="l19417"></a><span class="lineno">19417</span>&#160;<span class="stringliteral">            $pba = $dom[$key][&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>pagebreakafter<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l19418"></a><span class="lineno">19418</span>&#160;<span class="stringliteral">            // check for pagebreak</span></div>
<div class="line"><a name="l19419"></a><span class="lineno">19419</span>&#160;<span class="stringliteral">            if (($pba == &#39;</span><span class="keyword">true</span><span class="stringliteral">&#39;) OR ($pba == &#39;</span>left<span class="stringliteral">&#39;) OR ($pba == &#39;</span>right<span class="stringliteral">&#39;)) {</span></div>
<div class="line"><a name="l19420"></a><span class="lineno">19420</span>&#160;<span class="stringliteral">                // add a page (or trig AcceptPageBreak() for multicolumn mode)</span></div>
<div class="line"><a name="l19421"></a><span class="lineno">19421</span>&#160;<span class="stringliteral">                $this-&gt;checkPageBreak($this-&gt;PageBreakTrigger + 1);</span></div>
<div class="line"><a name="l19422"></a><span class="lineno">19422</span>&#160;<span class="stringliteral">            }</span></div>
<div class="line"><a name="l19423"></a><span class="lineno">19423</span>&#160;<span class="stringliteral">            if ((($pba == &#39;</span>left<span class="stringliteral">&#39;) AND (((!$this-&gt;rtl) AND (($this-&gt;page % 2) == 0)) OR (($this-&gt;rtl) AND (($this-&gt;page % 2) != 0))))</span></div>
<div class="line"><a name="l19424"></a><span class="lineno">19424</span>&#160;<span class="stringliteral">                OR (($pba == &#39;</span>right<span class="stringliteral">&#39;) AND (((!$this-&gt;rtl) AND (($this-&gt;page % 2) != 0)) OR (($this-&gt;rtl) AND (($this-&gt;page % 2) == 0))))) {</span></div>
<div class="line"><a name="l19425"></a><span class="lineno">19425</span>&#160;<span class="stringliteral">                // add a page (or trig AcceptPageBreak() for multicolumn mode)</span></div>
<div class="line"><a name="l19426"></a><span class="lineno">19426</span>&#160;<span class="stringliteral">                $this-&gt;checkPageBreak($this-&gt;PageBreakTrigger + 1);</span></div>
<div class="line"><a name="l19427"></a><span class="lineno">19427</span>&#160;<span class="stringliteral">            }</span></div>
<div class="line"><a name="l19428"></a><span class="lineno">19428</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l19429"></a><span class="lineno">19429</span>&#160;<span class="stringliteral">        return $dom;</span></div>
<div class="line"><a name="l19430"></a><span class="lineno">19430</span>&#160;<span class="stringliteral">    }</span></div>
<div class="line"><a name="l19431"></a><span class="lineno">19431</span>&#160;<span class="stringliteral"></span></div>
<div class="line"><a name="l19441"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a52ace3318c0320d4059a1b969cc2eb20">19441</a></span>&#160;<span class="stringliteral">    protected function closeHTMLTagHandler($dom, $key, $cell, $maxbottomliney=0) {</span></div>
<div class="line"><a name="l19442"></a><span class="lineno">19442</span>&#160;<span class="stringliteral">        $tag = $dom[$key];</span></div>
<div class="line"><a name="l19443"></a><span class="lineno">19443</span>&#160;<span class="stringliteral">        $parent = $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])];</span></div>
<div class="line"><a name="l19444"></a><span class="lineno">19444</span>&#160;<span class="stringliteral">        $lasttag = ((!isset($dom[($key + 1)])) OR ((!isset($dom[($key + 2)])) AND ($dom[($key + 1)][&#39;</span>value<span class="stringliteral">&#39;] == &#39;</span>marker<span class="stringliteral">&#39;)));</span></div>
<div class="line"><a name="l19445"></a><span class="lineno">19445</span>&#160;<span class="stringliteral">        $in_table_head = false;</span></div>
<div class="line"><a name="l19446"></a><span class="lineno">19446</span>&#160;<span class="stringliteral">        // maximum x position (used to draw borders)</span></div>
<div class="line"><a name="l19447"></a><span class="lineno">19447</span>&#160;<span class="stringliteral">        if ($this-&gt;rtl) {</span></div>
<div class="line"><a name="l19448"></a><span class="lineno">19448</span>&#160;<span class="stringliteral">            $xmax = $this-&gt;w;</span></div>
<div class="line"><a name="l19449"></a><span class="lineno">19449</span>&#160;<span class="stringliteral">        } else {</span></div>
<div class="line"><a name="l19450"></a><span class="lineno">19450</span>&#160;<span class="stringliteral">            $xmax = 0;</span></div>
<div class="line"><a name="l19451"></a><span class="lineno">19451</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l19452"></a><span class="lineno">19452</span>&#160;<span class="stringliteral">        if ($tag[&#39;</span>block<span class="stringliteral">&#39;]) {</span></div>
<div class="line"><a name="l19453"></a><span class="lineno">19453</span>&#160;<span class="stringliteral">            $hbz = 0; // distance from y to line bottom</span></div>
<div class="line"><a name="l19454"></a><span class="lineno">19454</span>&#160;<span class="stringliteral">            $hb = 0; // vertical space between block tags</span></div>
<div class="line"><a name="l19455"></a><span class="lineno">19455</span>&#160;<span class="stringliteral">            // calculate vertical space for block tags</span></div>
<div class="line"><a name="l19456"></a><span class="lineno">19456</span>&#160;<span class="stringliteral">            if (isset($this-&gt;tagvspaces[$tag[&#39;</span>value<span class="stringliteral">&#39;]][1][&#39;</span>h<span class="stringliteral">&#39;]) AND ($this-&gt;tagvspaces[$tag[&#39;</span>value<span class="stringliteral">&#39;]][1][&#39;</span>h<span class="stringliteral">&#39;] &gt;= 0)) {</span></div>
<div class="line"><a name="l19457"></a><span class="lineno">19457</span>&#160;<span class="stringliteral">                $pre_h = $this-&gt;tagvspaces[$tag[&#39;</span>value<span class="stringliteral">&#39;]][1][&#39;</span>h<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l19458"></a><span class="lineno">19458</span>&#160;<span class="stringliteral">            } elseif (isset($parent[&#39;</span>fontsize<span class="stringliteral">&#39;])) {</span></div>
<div class="line"><a name="l19459"></a><span class="lineno">19459</span>&#160;<span class="stringliteral">                $pre_h = $this-&gt;getCellHeight($parent[&#39;</span>fontsize<span class="stringliteral">&#39;] / $this-&gt;k);</span></div>
<div class="line"><a name="l19460"></a><span class="lineno">19460</span>&#160;<span class="stringliteral">            } else {</span></div>
<div class="line"><a name="l19461"></a><span class="lineno">19461</span>&#160;<span class="stringliteral">                $pre_h = $this-&gt;getCellHeight($this-&gt;FontSize);</span></div>
<div class="line"><a name="l19462"></a><span class="lineno">19462</span>&#160;<span class="stringliteral">            }</span></div>
<div class="line"><a name="l19463"></a><span class="lineno">19463</span>&#160;<span class="stringliteral">            if (isset($this-&gt;tagvspaces[$tag[&#39;</span>value<span class="stringliteral">&#39;]][1][&#39;</span>n<span class="stringliteral">&#39;])) {</span></div>
<div class="line"><a name="l19464"></a><span class="lineno">19464</span>&#160;<span class="stringliteral">                $cn = $this-&gt;tagvspaces[$tag[&#39;</span>value<span class="stringliteral">&#39;]][1][&#39;</span>n<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l19465"></a><span class="lineno">19465</span>&#160;<span class="stringliteral">            } elseif (preg_match(&#39;</span>/[h][0-9]/<span class="stringliteral">&#39;, $tag[&#39;</span>value<span class="stringliteral">&#39;]) &gt; 0) {</span></div>
<div class="line"><a name="l19466"></a><span class="lineno">19466</span>&#160;<span class="stringliteral">                $cn = 0.6;</span></div>
<div class="line"><a name="l19467"></a><span class="lineno">19467</span>&#160;<span class="stringliteral">            } else {</span></div>
<div class="line"><a name="l19468"></a><span class="lineno">19468</span>&#160;<span class="stringliteral">                $cn = 1;</span></div>
<div class="line"><a name="l19469"></a><span class="lineno">19469</span>&#160;<span class="stringliteral">            }</span></div>
<div class="line"><a name="l19470"></a><span class="lineno">19470</span>&#160;<span class="stringliteral">            if ((!isset($this-&gt;tagvspaces[$tag[&#39;</span>value<span class="stringliteral">&#39;]])) AND ($tag[&#39;</span>value<span class="stringliteral">&#39;] == &#39;</span>div<span class="stringliteral">&#39;)) {</span></div>
<div class="line"><a name="l19471"></a><span class="lineno">19471</span>&#160;<span class="stringliteral">                $hb = 0;</span></div>
<div class="line"><a name="l19472"></a><span class="lineno">19472</span>&#160;<span class="stringliteral">            } else {</span></div>
<div class="line"><a name="l19473"></a><span class="lineno">19473</span>&#160;<span class="stringliteral">                $hb = ($cn * $pre_h);</span></div>
<div class="line"><a name="l19474"></a><span class="lineno">19474</span>&#160;<span class="stringliteral">            }</span></div>
<div class="line"><a name="l19475"></a><span class="lineno">19475</span>&#160;<span class="stringliteral">            if ($maxbottomliney &gt; $this-&gt;PageBreakTrigger) {</span></div>
<div class="line"><a name="l19476"></a><span class="lineno">19476</span>&#160;<span class="stringliteral">                $hbz = $this-&gt;getCellHeight($this-&gt;FontSize);</span></div>
<div class="line"><a name="l19477"></a><span class="lineno">19477</span>&#160;<span class="stringliteral">            } elseif ($this-&gt;y &lt; $maxbottomliney) {</span></div>
<div class="line"><a name="l19478"></a><span class="lineno">19478</span>&#160;<span class="stringliteral">                $hbz = ($maxbottomliney - $this-&gt;y);</span></div>
<div class="line"><a name="l19479"></a><span class="lineno">19479</span>&#160;<span class="stringliteral">            }</span></div>
<div class="line"><a name="l19480"></a><span class="lineno">19480</span>&#160;<span class="stringliteral">        }</span></div>
<div class="line"><a name="l19481"></a><span class="lineno">19481</span>&#160;<span class="stringliteral">        // Closing tag</span></div>
<div class="line"><a name="l19482"></a><span class="lineno">19482</span>&#160;<span class="stringliteral">        switch($tag[&#39;</span>value<span class="stringliteral">&#39;]) {</span></div>
<div class="line"><a name="l19483"></a><span class="lineno">19483</span>&#160;<span class="stringliteral">            case &#39;</span>tr<span class="stringliteral">&#39;: {</span></div>
<div class="line"><a name="l19484"></a><span class="lineno">19484</span>&#160;<span class="stringliteral">                $table_el = $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>parent<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l19485"></a><span class="lineno">19485</span>&#160;<span class="stringliteral">                if (!isset($parent[&#39;</span>endy<span class="stringliteral">&#39;])) {</span></div>
<div class="line"><a name="l19486"></a><span class="lineno">19486</span>&#160;<span class="stringliteral">                    $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>endy<span class="stringliteral">&#39;] = $this-&gt;y;</span></div>
<div class="line"><a name="l19487"></a><span class="lineno">19487</span>&#160;<span class="stringliteral">                    $parent[&#39;</span>endy<span class="stringliteral">&#39;] = $this-&gt;y;</span></div>
<div class="line"><a name="l19488"></a><span class="lineno">19488</span>&#160;<span class="stringliteral">                }</span></div>
<div class="line"><a name="l19489"></a><span class="lineno">19489</span>&#160;<span class="stringliteral">                if (!isset($parent[&#39;</span>endpage<span class="stringliteral">&#39;])) {</span></div>
<div class="line"><a name="l19490"></a><span class="lineno">19490</span>&#160;<span class="stringliteral">                    $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>endpage<span class="stringliteral">&#39;] = $this-&gt;page;</span></div>
<div class="line"><a name="l19491"></a><span class="lineno">19491</span>&#160;<span class="stringliteral">                    $parent[&#39;</span>endpage<span class="stringliteral">&#39;] = $this-&gt;page;</span></div>
<div class="line"><a name="l19492"></a><span class="lineno">19492</span>&#160;<span class="stringliteral">                }</span></div>
<div class="line"><a name="l19493"></a><span class="lineno">19493</span>&#160;<span class="stringliteral">                if (!isset($parent[&#39;</span>endcolumn<span class="stringliteral">&#39;])) {</span></div>
<div class="line"><a name="l19494"></a><span class="lineno">19494</span>&#160;<span class="stringliteral">                    $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>endcolumn<span class="stringliteral">&#39;] = $this-&gt;current_column;</span></div>
<div class="line"><a name="l19495"></a><span class="lineno">19495</span>&#160;<span class="stringliteral">                    $parent[&#39;</span>endcolumn<span class="stringliteral">&#39;] = $this-&gt;current_column;</span></div>
<div class="line"><a name="l19496"></a><span class="lineno">19496</span>&#160;<span class="stringliteral">                }</span></div>
<div class="line"><a name="l19497"></a><span class="lineno">19497</span>&#160;<span class="stringliteral">                // update row-spanned cells</span></div>
<div class="line"><a name="l19498"></a><span class="lineno">19498</span>&#160;<span class="stringliteral">                if (isset($dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;])) {</span></div>
<div class="line"><a name="l19499"></a><span class="lineno">19499</span>&#160;<span class="stringliteral">                    foreach ($dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;] as $k =&gt; $trwsp) {</span></div>
<div class="line"><a name="l19500"></a><span class="lineno">19500</span>&#160;<span class="stringliteral">                        $dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>rowspan<span class="stringliteral">&#39;] -= 1;</span></div>
<div class="line"><a name="l19501"></a><span class="lineno">19501</span>&#160;<span class="stringliteral">                        if ($dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>rowspan<span class="stringliteral">&#39;] == 0) {</span></div>
<div class="line"><a name="l19502"></a><span class="lineno">19502</span>&#160;<span class="stringliteral">                            if (($dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>endpage<span class="stringliteral">&#39;] == $parent[&#39;</span>endpage<span class="stringliteral">&#39;]) AND ($dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>endcolumn<span class="stringliteral">&#39;] == $parent[&#39;</span>endcolumn<span class="stringliteral">&#39;])) {</span></div>
<div class="line"><a name="l19503"></a><span class="lineno">19503</span>&#160;<span class="stringliteral">                                $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>endy<span class="stringliteral">&#39;] = max($dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>endy<span class="stringliteral">&#39;], $parent[&#39;</span>endy<span class="stringliteral">&#39;]);</span></div>
<div class="line"><a name="l19504"></a><span class="lineno">19504</span>&#160;<span class="stringliteral">                            } elseif (($dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>endpage<span class="stringliteral">&#39;] &gt; $parent[&#39;</span>endpage<span class="stringliteral">&#39;]) OR ($dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>endcolumn<span class="stringliteral">&#39;] &gt; $parent[&#39;</span>endcolumn<span class="stringliteral">&#39;])) {</span></div>
<div class="line"><a name="l19505"></a><span class="lineno">19505</span>&#160;<span class="stringliteral">                                $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>endy<span class="stringliteral">&#39;] = $dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>endy<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l19506"></a><span class="lineno">19506</span>&#160;<span class="stringliteral">                                $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>endpage<span class="stringliteral">&#39;] = $dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>endpage<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l19507"></a><span class="lineno">19507</span>&#160;<span class="stringliteral">                                $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>endcolumn<span class="stringliteral">&#39;] = $dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>endcolumn<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l19508"></a><span class="lineno">19508</span>&#160;<span class="stringliteral">                            }</span></div>
<div class="line"><a name="l19509"></a><span class="lineno">19509</span>&#160;<span class="stringliteral">                        }</span></div>
<div class="line"><a name="l19510"></a><span class="lineno">19510</span>&#160;<span class="stringliteral">                    }</span></div>
<div class="line"><a name="l19511"></a><span class="lineno">19511</span>&#160;<span class="stringliteral">                    // report new endy and endpage to the rowspanned cells</span></div>
<div class="line"><a name="l19512"></a><span class="lineno">19512</span>&#160;<span class="stringliteral">                    foreach ($dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;] as $k =&gt; $trwsp) {</span></div>
<div class="line"><a name="l19513"></a><span class="lineno">19513</span>&#160;<span class="stringliteral">                        if ($dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>rowspan<span class="stringliteral">&#39;] == 0) {</span></div>
<div class="line"><a name="l19514"></a><span class="lineno">19514</span>&#160;<span class="stringliteral">                            $dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>endpage<span class="stringliteral">&#39;] = max($dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>endpage<span class="stringliteral">&#39;], $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>endpage<span class="stringliteral">&#39;]);</span></div>
<div class="line"><a name="l19515"></a><span class="lineno">19515</span>&#160;<span class="stringliteral">                            $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>endpage<span class="stringliteral">&#39;] = $dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>endpage<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l19516"></a><span class="lineno">19516</span>&#160;<span class="stringliteral">                            $dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>endcolumn<span class="stringliteral">&#39;] = max($dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>endcolumn<span class="stringliteral">&#39;], $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>endcolumn<span class="stringliteral">&#39;]);</span></div>
<div class="line"><a name="l19517"></a><span class="lineno">19517</span>&#160;<span class="stringliteral">                            $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>endcolumn<span class="stringliteral">&#39;] = $dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>endcolumn<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l19518"></a><span class="lineno">19518</span>&#160;<span class="stringliteral">                            $dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>endy<span class="stringliteral">&#39;] = max($dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>endy<span class="stringliteral">&#39;], $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>endy<span class="stringliteral">&#39;]);</span></div>
<div class="line"><a name="l19519"></a><span class="lineno">19519</span>&#160;<span class="stringliteral">                            $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>endy<span class="stringliteral">&#39;] = $dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>endy<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l19520"></a><span class="lineno">19520</span>&#160;<span class="stringliteral">                        }</span></div>
<div class="line"><a name="l19521"></a><span class="lineno">19521</span>&#160;<span class="stringliteral">                    }</span></div>
<div class="line"><a name="l19522"></a><span class="lineno">19522</span>&#160;<span class="stringliteral">                    // update remaining rowspanned cells</span></div>
<div class="line"><a name="l19523"></a><span class="lineno">19523</span>&#160;<span class="stringliteral">                    foreach ($dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;] as $k =&gt; $trwsp) {</span></div>
<div class="line"><a name="l19524"></a><span class="lineno">19524</span>&#160;<span class="stringliteral">                        if ($dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>rowspan<span class="stringliteral">&#39;] == 0) {</span></div>
<div class="line"><a name="l19525"></a><span class="lineno">19525</span>&#160;<span class="stringliteral">                            $dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>endpage<span class="stringliteral">&#39;] = $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>endpage<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l19526"></a><span class="lineno">19526</span>&#160;<span class="stringliteral">                            $dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>endcolumn<span class="stringliteral">&#39;] = $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>endcolumn<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l19527"></a><span class="lineno">19527</span>&#160;<span class="stringliteral">                            $dom[$table_el][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>endy<span class="stringliteral">&#39;] = $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>endy<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l19528"></a><span class="lineno">19528</span>&#160;<span class="stringliteral">                        }</span></div>
<div class="line"><a name="l19529"></a><span class="lineno">19529</span>&#160;<span class="stringliteral">                    }</span></div>
<div class="line"><a name="l19530"></a><span class="lineno">19530</span>&#160;<span class="stringliteral">                }</span></div>
<div class="line"><a name="l19531"></a><span class="lineno">19531</span>&#160;<span class="stringliteral">                $prev_page = $this-&gt;page;</span></div>
<div class="line"><a name="l19532"></a><span class="lineno">19532</span>&#160;<span class="stringliteral">                $this-&gt;setPage($dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>endpage<span class="stringliteral">&#39;]);</span></div>
<div class="line"><a name="l19533"></a><span class="lineno">19533</span>&#160;<span class="stringliteral">                if ($this-&gt;num_columns &gt; 1) {</span></div>
<div class="line"><a name="l19534"></a><span class="lineno">19534</span>&#160;<span class="stringliteral">                    if ((($this-&gt;current_column == 0) AND ($dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>endcolumn<span class="stringliteral">&#39;] == ($this-&gt;num_columns - 1)))</span></div>
<div class="line"><a name="l19535"></a><span class="lineno">19535</span>&#160;<span class="stringliteral">                        OR (($this-&gt;current_column == $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>endcolumn<span class="stringliteral">&#39;]) AND ($prev_page &lt; $this-&gt;page))) {</span></div>
<div class="line"><a name="l19536"></a><span class="lineno">19536</span>&#160;<span class="stringliteral">                        // page jump</span></div>
<div class="line"><a name="l19537"></a><span class="lineno">19537</span>&#160;<span class="stringliteral">                        $this-&gt;selectColumn(0);</span></div>
<div class="line"><a name="l19538"></a><span class="lineno">19538</span>&#160;<span class="stringliteral">                        $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>endcolumn<span class="stringliteral">&#39;] = 0;</span></div>
<div class="line"><a name="l19539"></a><span class="lineno">19539</span>&#160;<span class="stringliteral">                        $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>endy<span class="stringliteral">&#39;] = $this-&gt;y;</span></div>
<div class="line"><a name="l19540"></a><span class="lineno">19540</span>&#160;<span class="stringliteral">                    } else {</span></div>
<div class="line"><a name="l19541"></a><span class="lineno">19541</span>&#160;<span class="stringliteral">                        $this-&gt;selectColumn($dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>endcolumn<span class="stringliteral">&#39;]);</span></div>
<div class="line"><a name="l19542"></a><span class="lineno">19542</span>&#160;<span class="stringliteral">                        $this-&gt;y = $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>endy<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l19543"></a><span class="lineno">19543</span>&#160;<span class="stringliteral">                    }</span></div>
<div class="line"><a name="l19544"></a><span class="lineno">19544</span>&#160;<span class="stringliteral">                } else {</span></div>
<div class="line"><a name="l19545"></a><span class="lineno">19545</span>&#160;<span class="stringliteral">                    $this-&gt;y = $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>endy<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l19546"></a><span class="lineno">19546</span>&#160;<span class="stringliteral">                }</span></div>
<div class="line"><a name="l19547"></a><span class="lineno">19547</span>&#160;<span class="stringliteral">                if (isset($dom[$table_el][&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>cellspacing<span class="stringliteral">&#39;])) {</span></div>
<div class="line"><a name="l19548"></a><span class="lineno">19548</span>&#160;<span class="stringliteral">                    $this-&gt;y += $this-&gt;getHTMLUnitToUnits($dom[$table_el][&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>cellspacing<span class="stringliteral">&#39;], 1, &#39;</span>px<span class="stringliteral">&#39;);</span></div>
<div class="line"><a name="l19549"></a><span class="lineno">19549</span>&#160;<span class="stringliteral">                } elseif (isset($dom[$table_el][&#39;</span>border-spacing<span class="stringliteral">&#39;])) {</span></div>
<div class="line"><a name="l19550"></a><span class="lineno">19550</span>&#160;<span class="stringliteral">                    $this-&gt;y += $dom[$table_el][&#39;</span>border-spacing<span class="stringliteral">&#39;][&#39;</span>V<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l19551"></a><span class="lineno">19551</span>&#160;<span class="stringliteral">                }</span></div>
<div class="line"><a name="l19552"></a><span class="lineno">19552</span>&#160;<span class="stringliteral">                $this-&gt;Ln(0, $cell);</span></div>
<div class="line"><a name="l19553"></a><span class="lineno">19553</span>&#160;<span class="stringliteral">                if ($this-&gt;current_column == $parent[&#39;</span>startcolumn<span class="stringliteral">&#39;]) {</span></div>
<div class="line"><a name="l19554"></a><span class="lineno">19554</span>&#160;<span class="stringliteral">                    $this-&gt;x = $parent[&#39;</span>startx<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l19555"></a><span class="lineno">19555</span>&#160;<span class="stringliteral">                }</span></div>
<div class="line"><a name="l19556"></a><span class="lineno">19556</span>&#160;<span class="stringliteral">                // account for booklet mode</span></div>
<div class="line"><a name="l19557"></a><span class="lineno">19557</span>&#160;<span class="stringliteral">                if ($this-&gt;page &gt; $parent[&#39;</span>startpage<span class="stringliteral">&#39;]) {</span></div>
<div class="line"><a name="l19558"></a><span class="lineno">19558</span>&#160;<span class="stringliteral">                    if (($this-&gt;rtl) AND ($this-&gt;pagedim[$this-&gt;page][&#39;</span>orm<span class="stringliteral">&#39;] != $this-&gt;pagedim[$parent[&#39;</span>startpage<span class="stringliteral">&#39;]][&#39;</span>orm<span class="stringliteral">&#39;])) {</span></div>
<div class="line"><a name="l19559"></a><span class="lineno">19559</span>&#160;<span class="stringliteral">                        $this-&gt;x -= ($this-&gt;pagedim[$this-&gt;page][&#39;</span>orm<span class="stringliteral">&#39;] - $this-&gt;pagedim[$parent[&#39;</span>startpage<span class="stringliteral">&#39;]][&#39;</span>orm<span class="stringliteral">&#39;]);</span></div>
<div class="line"><a name="l19560"></a><span class="lineno">19560</span>&#160;<span class="stringliteral">                    } elseif ((!$this-&gt;rtl) AND ($this-&gt;pagedim[$this-&gt;page][&#39;</span>olm<span class="stringliteral">&#39;] != $this-&gt;pagedim[$parent[&#39;</span>startpage<span class="stringliteral">&#39;]][&#39;</span>olm<span class="stringliteral">&#39;])) {</span></div>
<div class="line"><a name="l19561"></a><span class="lineno">19561</span>&#160;<span class="stringliteral">                        $this-&gt;x += ($this-&gt;pagedim[$this-&gt;page][&#39;</span>olm<span class="stringliteral">&#39;] - $this-&gt;pagedim[$parent[&#39;</span>startpage<span class="stringliteral">&#39;]][&#39;</span>olm<span class="stringliteral">&#39;]);</span></div>
<div class="line"><a name="l19562"></a><span class="lineno">19562</span>&#160;<span class="stringliteral">                    }</span></div>
<div class="line"><a name="l19563"></a><span class="lineno">19563</span>&#160;<span class="stringliteral">                }</span></div>
<div class="line"><a name="l19564"></a><span class="lineno">19564</span>&#160;<span class="stringliteral">                break;</span></div>
<div class="line"><a name="l19565"></a><span class="lineno">19565</span>&#160;<span class="stringliteral">            }</span></div>
<div class="line"><a name="l19566"></a><span class="lineno">19566</span>&#160;<span class="stringliteral">            case &#39;</span>tablehead<span class="stringliteral">&#39;:</span></div>
<div class="line"><a name="l19567"></a><span class="lineno">19567</span>&#160;<span class="stringliteral">                // closing tag used for the thead part</span></div>
<div class="line"><a name="l19568"></a><span class="lineno">19568</span>&#160;<span class="stringliteral">                $in_table_head = true;</span></div>
<div class="line"><a name="l19569"></a><span class="lineno">19569</span>&#160;<span class="stringliteral">                $this-&gt;inthead = false;</span></div>
<div class="line"><a name="l19570"></a><span class="lineno">19570</span>&#160;<span class="stringliteral">            case &#39;</span>table<span class="stringliteral">&#39;: {</span></div>
<div class="line"><a name="l19571"></a><span class="lineno">19571</span>&#160;<span class="stringliteral">                $table_el = $parent;</span></div>
<div class="line"><a name="l19572"></a><span class="lineno">19572</span>&#160;<span class="stringliteral">                // set default border</span></div>
<div class="line"><a name="l19573"></a><span class="lineno">19573</span>&#160;<span class="stringliteral">                if (isset($table_el[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>border<span class="stringliteral">&#39;]) AND ($table_el[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>border<span class="stringliteral">&#39;] &gt; 0)) {</span></div>
<div class="line"><a name="l19574"></a><span class="lineno">19574</span>&#160;<span class="stringliteral">                    // set default border</span></div>
<div class="line"><a name="l19575"></a><span class="lineno">19575</span>&#160;<span class="stringliteral">                    $border = array(&#39;</span>LTRB<span class="stringliteral">&#39; =&gt; array(&#39;</span>width<span class="stringliteral">&#39; =&gt; $this-&gt;getCSSBorderWidth($table_el[&#39;</span>attribute<span class="stringliteral">&#39;][&#39;</span>border<span class="stringliteral">&#39;]), &#39;</span>cap<span class="stringliteral">&#39;=&gt;&#39;</span>square<span class="stringliteral">&#39;, &#39;</span>join<span class="stringliteral">&#39;=&gt;&#39;</span>miter<span class="stringliteral">&#39;, &#39;</span>dash<span class="stringliteral">&#39;=&gt; 0, &#39;</span>color<span class="stringliteral">&#39;=&gt;array(0,0,0)));</span></div>
<div class="line"><a name="l19576"></a><span class="lineno">19576</span>&#160;<span class="stringliteral">                } else {</span></div>
<div class="line"><a name="l19577"></a><span class="lineno">19577</span>&#160;<span class="stringliteral">                    $border = 0;</span></div>
<div class="line"><a name="l19578"></a><span class="lineno">19578</span>&#160;<span class="stringliteral">                }</span></div>
<div class="line"><a name="l19579"></a><span class="lineno">19579</span>&#160;<span class="stringliteral">                $default_border = $border;</span></div>
<div class="line"><a name="l19580"></a><span class="lineno">19580</span>&#160;<span class="stringliteral">                // fix bottom line alignment of last line before page break</span></div>
<div class="line"><a name="l19581"></a><span class="lineno">19581</span>&#160;<span class="stringliteral">                foreach ($dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>trids<span class="stringliteral">&#39;] as $j =&gt; $trkey) {</span></div>
<div class="line"><a name="l19582"></a><span class="lineno">19582</span>&#160;<span class="stringliteral">                    // update row-spanned cells</span></div>
<div class="line"><a name="l19583"></a><span class="lineno">19583</span>&#160;<span class="stringliteral">                    if (isset($dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>rowspans<span class="stringliteral">&#39;])) {</span></div>
<div class="line"><a name="l19584"></a><span class="lineno">19584</span>&#160;<span class="stringliteral">                        foreach ($dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>rowspans<span class="stringliteral">&#39;] as $k =&gt; $trwsp) {</span></div>
<div class="line"><a name="l19585"></a><span class="lineno">19585</span>&#160;<span class="stringliteral">                            if (isset($prevtrkey) AND ($trwsp[&#39;</span>trid<span class="stringliteral">&#39;] == $prevtrkey) AND ($trwsp[&#39;</span>mrowspan<span class="stringliteral">&#39;] &gt; 0)) {</span></div>
<div class="line"><a name="l19586"></a><span class="lineno">19586</span>&#160;<span class="stringliteral">                                $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>trid<span class="stringliteral">&#39;] = $trkey;</span></div>
<div class="line"><a name="l19587"></a><span class="lineno">19587</span>&#160;<span class="stringliteral">                            }</span></div>
<div class="line"><a name="l19588"></a><span class="lineno">19588</span>&#160;<span class="stringliteral">                            if ($dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>trid<span class="stringliteral">&#39;] == $trkey) {</span></div>
<div class="line"><a name="l19589"></a><span class="lineno">19589</span>&#160;<span class="stringliteral">                                $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>mrowspan<span class="stringliteral">&#39;] -= 1;</span></div>
<div class="line"><a name="l19590"></a><span class="lineno">19590</span>&#160;<span class="stringliteral">                            }</span></div>
<div class="line"><a name="l19591"></a><span class="lineno">19591</span>&#160;<span class="stringliteral">                        }</span></div>
<div class="line"><a name="l19592"></a><span class="lineno">19592</span>&#160;<span class="stringliteral">                    }</span></div>
<div class="line"><a name="l19593"></a><span class="lineno">19593</span>&#160;<span class="stringliteral">                    if (isset($prevtrkey) AND ($dom[$trkey][&#39;</span>startpage<span class="stringliteral">&#39;] &gt; $dom[$prevtrkey][&#39;</span>endpage<span class="stringliteral">&#39;])) {</span></div>
<div class="line"><a name="l19594"></a><span class="lineno">19594</span>&#160;<span class="stringliteral">                        $pgendy = $this-&gt;pagedim[$dom[$prevtrkey][&#39;</span>endpage<span class="stringliteral">&#39;]][&#39;</span>hk<span class="stringliteral">&#39;] - $this-&gt;pagedim[$dom[$prevtrkey][&#39;</span>endpage<span class="stringliteral">&#39;]][&#39;</span>bm<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l19595"></a><span class="lineno">19595</span>&#160;<span class="stringliteral">                        $dom[$prevtrkey][&#39;</span>endy<span class="stringliteral">&#39;] = $pgendy;</span></div>
<div class="line"><a name="l19596"></a><span class="lineno">19596</span>&#160;<span class="stringliteral">                        // update row-spanned cells</span></div>
<div class="line"><a name="l19597"></a><span class="lineno">19597</span>&#160;<span class="stringliteral">                        if (isset($dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>rowspans<span class="stringliteral">&#39;])) {</span></div>
<div class="line"><a name="l19598"></a><span class="lineno">19598</span>&#160;<span class="stringliteral">                            foreach ($dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>rowspans<span class="stringliteral">&#39;] as $k =&gt; $trwsp) {</span></div>
<div class="line"><a name="l19599"></a><span class="lineno">19599</span>&#160;<span class="stringliteral">                                if (($trwsp[&#39;</span>trid<span class="stringliteral">&#39;] == $prevtrkey) AND ($trwsp[&#39;</span>mrowspan<span class="stringliteral">&#39;] &gt;= 0) AND ($trwsp[&#39;</span>endpage<span class="stringliteral">&#39;] == $dom[$prevtrkey][&#39;</span>endpage<span class="stringliteral">&#39;])) {</span></div>
<div class="line"><a name="l19600"></a><span class="lineno">19600</span>&#160;<span class="stringliteral">                                    $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>endy<span class="stringliteral">&#39;] = $pgendy;</span></div>
<div class="line"><a name="l19601"></a><span class="lineno">19601</span>&#160;<span class="stringliteral">                                    $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])][&#39;</span>rowspans<span class="stringliteral">&#39;][$k][&#39;</span>mrowspan<span class="stringliteral">&#39;] = -1;</span></div>
<div class="line"><a name="l19602"></a><span class="lineno">19602</span>&#160;<span class="stringliteral">                                }</span></div>
<div class="line"><a name="l19603"></a><span class="lineno">19603</span>&#160;<span class="stringliteral">                            }</span></div>
<div class="line"><a name="l19604"></a><span class="lineno">19604</span>&#160;<span class="stringliteral">                        }</span></div>
<div class="line"><a name="l19605"></a><span class="lineno">19605</span>&#160;<span class="stringliteral">                    }</span></div>
<div class="line"><a name="l19606"></a><span class="lineno">19606</span>&#160;<span class="stringliteral">                    $prevtrkey = $trkey;</span></div>
<div class="line"><a name="l19607"></a><span class="lineno">19607</span>&#160;<span class="stringliteral">                    $table_el = $dom[($dom[$key][&#39;</span>parent<span class="stringliteral">&#39;])];</span></div>
<div class="line"><a name="l19608"></a><span class="lineno">19608</span>&#160;<span class="stringliteral">                }</span></div>
<div class="line"><a name="l19609"></a><span class="lineno">19609</span>&#160;<span class="stringliteral">                // for each row</span></div>
<div class="line"><a name="l19610"></a><span class="lineno">19610</span>&#160;<span class="stringliteral">                if (count($table_el[&#39;</span>trids<span class="stringliteral">&#39;]) &gt; 0) {</span></div>
<div class="line"><a name="l19611"></a><span class="lineno">19611</span>&#160;<span class="stringliteral">                    unset($xmax);</span></div>
<div class="line"><a name="l19612"></a><span class="lineno">19612</span>&#160;<span class="stringliteral">                }</span></div>
<div class="line"><a name="l19613"></a><span class="lineno">19613</span>&#160;<span class="stringliteral">                foreach ($table_el[&#39;</span>trids<span class="stringliteral">&#39;] as $j =&gt; $trkey) {</span></div>
<div class="line"><a name="l19614"></a><span class="lineno">19614</span>&#160;<span class="stringliteral">                    $parent = $dom[$trkey];</span></div>
<div class="line"><a name="l19615"></a><span class="lineno">19615</span>&#160;<span class="stringliteral">                    if (!isset($xmax)) {</span></div>
<div class="line"><a name="l19616"></a><span class="lineno">19616</span>&#160;<span class="stringliteral">                        $xmax = $parent[&#39;</span>cellpos<span class="stringliteral">&#39;][(count($parent[&#39;</span>cellpos<span class="stringliteral">&#39;]) - 1)][&#39;</span>endx<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l19617"></a><span class="lineno">19617</span>&#160;<span class="stringliteral">                    }</span></div>
<div class="line"><a name="l19618"></a><span class="lineno">19618</span>&#160;<span class="stringliteral">                    // for each cell on the row</span></div>
<div class="line"><a name="l19619"></a><span class="lineno">19619</span>&#160;<span class="stringliteral">                    foreach ($parent[&#39;</span>cellpos<span class="stringliteral">&#39;] as $k =&gt; $cellpos) {</span></div>
<div class="line"><a name="l19620"></a><span class="lineno">19620</span>&#160;<span class="stringliteral">                        if (isset($cellpos[&#39;</span>rowspanid<span class="stringliteral">&#39;]) AND ($cellpos[&#39;</span>rowspanid<span class="stringliteral">&#39;] &gt;= 0)) {</span></div>
<div class="line"><a name="l19621"></a><span class="lineno">19621</span>&#160;<span class="stringliteral">                            $cellpos[&#39;</span>startx<span class="stringliteral">&#39;] = $table_el[&#39;</span>rowspans<span class="stringliteral">&#39;][($cellpos[&#39;</span>rowspanid<span class="stringliteral">&#39;])][&#39;</span>startx<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l19622"></a><span class="lineno">19622</span>&#160;<span class="stringliteral">                            $cellpos[&#39;</span>endx<span class="stringliteral">&#39;] = $table_el[&#39;</span>rowspans<span class="stringliteral">&#39;][($cellpos[&#39;</span>rowspanid<span class="stringliteral">&#39;])][&#39;</span>endx<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l19623"></a><span class="lineno">19623</span>&#160;<span class="stringliteral">                            $endy = $table_el[&#39;</span>rowspans<span class="stringliteral">&#39;][($cellpos[&#39;</span>rowspanid<span class="stringliteral">&#39;])][&#39;</span>endy<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l19624"></a><span class="lineno">19624</span>&#160;<span class="stringliteral">                            $startpage = $table_el[&#39;</span>rowspans<span class="stringliteral">&#39;][($cellpos[&#39;</span>rowspanid<span class="stringliteral">&#39;])][&#39;</span>startpage<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l19625"></a><span class="lineno">19625</span>&#160;<span class="stringliteral">                            $endpage = $table_el[&#39;</span>rowspans<span class="stringliteral">&#39;][($cellpos[&#39;</span>rowspanid<span class="stringliteral">&#39;])][&#39;</span>endpage<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l19626"></a><span class="lineno">19626</span>&#160;<span class="stringliteral">                            $startcolumn = $table_el[&#39;</span>rowspans<span class="stringliteral">&#39;][($cellpos[&#39;</span>rowspanid<span class="stringliteral">&#39;])][&#39;</span>startcolumn<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l19627"></a><span class="lineno">19627</span>&#160;<span class="stringliteral">                            $endcolumn = $table_el[&#39;</span>rowspans<span class="stringliteral">&#39;][($cellpos[&#39;</span>rowspanid<span class="stringliteral">&#39;])][&#39;</span>endcolumn<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l19628"></a><span class="lineno">19628</span>&#160;<span class="stringliteral">                        } else {</span></div>
<div class="line"><a name="l19629"></a><span class="lineno">19629</span>&#160;<span class="stringliteral">                            $endy = $parent[&#39;</span>endy<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l19630"></a><span class="lineno">19630</span>&#160;<span class="stringliteral">                            $startpage = $parent[&#39;</span>startpage<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l19631"></a><span class="lineno">19631</span>&#160;<span class="stringliteral">                            $endpage = $parent[&#39;</span>endpage<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l19632"></a><span class="lineno">19632</span>&#160;<span class="stringliteral">                            $startcolumn = $parent[&#39;</span>startcolumn<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l19633"></a><span class="lineno">19633</span>&#160;<span class="stringliteral">                            $endcolumn = $parent[&#39;</span>endcolumn<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l19634"></a><span class="lineno">19634</span>&#160;<span class="stringliteral">                        }</span></div>
<div class="line"><a name="l19635"></a><span class="lineno">19635</span>&#160;<span class="stringliteral">                        if ($this-&gt;num_columns == 0) {</span></div>
<div class="line"><a name="l19636"></a><span class="lineno">19636</span>&#160;<span class="stringliteral">                            $this-&gt;num_columns = 1;</span></div>
<div class="line"><a name="l19637"></a><span class="lineno">19637</span>&#160;<span class="stringliteral">                        }</span></div>
<div class="line"><a name="l19638"></a><span class="lineno">19638</span>&#160;<span class="stringliteral">                        if (isset($cellpos[&#39;</span>border<span class="stringliteral">&#39;])) {</span></div>
<div class="line"><a name="l19639"></a><span class="lineno">19639</span>&#160;<span class="stringliteral">                            $border = $cellpos[&#39;</span>border<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l19640"></a><span class="lineno">19640</span>&#160;<span class="stringliteral">                        }</span></div>
<div class="line"><a name="l19641"></a><span class="lineno">19641</span>&#160;<span class="stringliteral">                        if (isset($cellpos[&#39;</span>bgcolor<span class="stringliteral">&#39;]) AND ($cellpos[&#39;</span>bgcolor<span class="stringliteral">&#39;]) !== false) {</span></div>
<div class="line"><a name="l19642"></a><span class="lineno">19642</span>&#160;<span class="stringliteral">                            $this-&gt;SetFillColorArray($cellpos[&#39;</span>bgcolor<span class="stringliteral">&#39;]);</span></div>
<div class="line"><a name="l19643"></a><span class="lineno">19643</span>&#160;<span class="stringliteral">                            $fill = true;</span></div>
<div class="line"><a name="l19644"></a><span class="lineno">19644</span>&#160;<span class="stringliteral">                        } else {</span></div>
<div class="line"><a name="l19645"></a><span class="lineno">19645</span>&#160;<span class="stringliteral">                            $fill = false;</span></div>
<div class="line"><a name="l19646"></a><span class="lineno">19646</span>&#160;<span class="stringliteral">                        }</span></div>
<div class="line"><a name="l19647"></a><span class="lineno">19647</span>&#160;<span class="stringliteral">                        $x = $cellpos[&#39;</span>startx<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l19648"></a><span class="lineno">19648</span>&#160;<span class="stringliteral">                        $y = $parent[&#39;</span>starty<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l19649"></a><span class="lineno">19649</span>&#160;<span class="stringliteral">                        $starty = $y;</span></div>
<div class="line"><a name="l19650"></a><span class="lineno">19650</span>&#160;<span class="stringliteral">                        $w = abs($cellpos[&#39;</span>endx<span class="stringliteral">&#39;] - $cellpos[&#39;</span>startx<span class="stringliteral">&#39;]);</span></div>
<div class="line"><a name="l19651"></a><span class="lineno">19651</span>&#160;<span class="stringliteral">                        // get border modes</span></div>
<div class="line"><a name="l19652"></a><span class="lineno">19652</span>&#160;<span class="stringliteral">                        $border_start = TCPDF_STATIC::getBorderMode($border, $position=&#39;</span>start<span class="stringliteral">&#39;, $this-&gt;opencell);</span></div>
<div class="line"><a name="l19653"></a><span class="lineno">19653</span>&#160;<span class="stringliteral">                        $border_end = TCPDF_STATIC::getBorderMode($border, $position=&#39;</span>end<span class="stringliteral">&#39;, $this-&gt;opencell);</span></div>
<div class="line"><a name="l19654"></a><span class="lineno">19654</span>&#160;<span class="stringliteral">                        $border_middle = TCPDF_STATIC::getBorderMode($border, $position=&#39;</span>middle<span class="stringliteral">&#39;, $this-&gt;opencell);</span></div>
<div class="line"><a name="l19655"></a><span class="lineno">19655</span>&#160;<span class="stringliteral">                        // design borders around HTML cells.</span></div>
<div class="line"><a name="l19656"></a><span class="lineno">19656</span>&#160;<span class="stringliteral">                        for ($page = $startpage; $page &lt;= $endpage; ++$page) { // for each page</span></div>
<div class="line"><a name="l19657"></a><span class="lineno">19657</span>&#160;<span class="stringliteral">                            $ccode = &#39;</span><span class="stringliteral">&#39;;</span></div>
<div class="line"><a name="l19658"></a><span class="lineno">19658</span>&#160;<span class="stringliteral">                            $this-&gt;setPage($page);</span></div>
<div class="line"><a name="l19659"></a><span class="lineno">19659</span>&#160;<span class="stringliteral">                            if ($this-&gt;num_columns &lt; 2) {</span></div>
<div class="line"><a name="l19660"></a><span class="lineno">19660</span>&#160;<span class="stringliteral">                                // single-column mode</span></div>
<div class="line"><a name="l19661"></a><span class="lineno">19661</span>&#160;<span class="stringliteral">                                $this-&gt;x = $x;</span></div>
<div class="line"><a name="l19662"></a><span class="lineno">19662</span>&#160;<span class="stringliteral">                                $this-&gt;y = $this-&gt;tMargin;</span></div>
<div class="line"><a name="l19663"></a><span class="lineno">19663</span>&#160;<span class="stringliteral">                            }</span></div>
<div class="line"><a name="l19664"></a><span class="lineno">19664</span>&#160;<span class="stringliteral">                            // account for margin changes</span></div>
<div class="line"><a name="l19665"></a><span class="lineno">19665</span>&#160;<span class="stringliteral">                            if ($page &gt; $startpage) {</span></div>
<div class="line"><a name="l19666"></a><span class="lineno">19666</span>&#160;<span class="stringliteral">                                if (($this-&gt;rtl) AND ($this-&gt;pagedim[$page][&#39;</span>orm<span class="stringliteral">&#39;] != $this-&gt;pagedim[$startpage][&#39;</span>orm<span class="stringliteral">&#39;])) {</span></div>
<div class="line"><a name="l19667"></a><span class="lineno">19667</span>&#160;<span class="stringliteral">                                    $this-&gt;x -= ($this-&gt;pagedim[$page][&#39;</span>orm<span class="stringliteral">&#39;] - $this-&gt;pagedim[$startpage][&#39;</span>orm<span class="stringliteral">&#39;]);</span></div>
<div class="line"><a name="l19668"></a><span class="lineno">19668</span>&#160;<span class="stringliteral">                                } elseif ((!$this-&gt;rtl) AND ($this-&gt;pagedim[$page][&#39;</span>olm<span class="stringliteral">&#39;] != $this-&gt;pagedim[$startpage][&#39;</span>olm<span class="stringliteral">&#39;])) {</span></div>
<div class="line"><a name="l19669"></a><span class="lineno">19669</span>&#160;<span class="stringliteral">                                    $this-&gt;x += ($this-&gt;pagedim[$page][&#39;</span>olm<span class="stringliteral">&#39;] - $this-&gt;pagedim[$startpage][&#39;</span>olm<span class="stringliteral">&#39;]);</span></div>
<div class="line"><a name="l19670"></a><span class="lineno">19670</span>&#160;<span class="stringliteral">                                }</span></div>
<div class="line"><a name="l19671"></a><span class="lineno">19671</span>&#160;<span class="stringliteral">                            }</span></div>
<div class="line"><a name="l19672"></a><span class="lineno">19672</span>&#160;<span class="stringliteral">                            if ($startpage == $endpage) { // single page</span></div>
<div class="line"><a name="l19673"></a><span class="lineno">19673</span>&#160;<span class="stringliteral">                                $deltacol = 0;</span></div>
<div class="line"><a name="l19674"></a><span class="lineno">19674</span>&#160;<span class="stringliteral">                                $deltath = 0;</span></div>
<div class="line"><a name="l19675"></a><span class="lineno">19675</span>&#160;<span class="stringliteral">                                for ($column = $startcolumn; $column &lt;= $endcolumn; ++$column) { // for each column</span></div>
<div class="line"><a name="l19676"></a><span class="lineno">19676</span>&#160;<span class="stringliteral">                                    $this-&gt;selectColumn($column);</span></div>
<div class="line"><a name="l19677"></a><span class="lineno">19677</span>&#160;<span class="stringliteral">                                    if ($startcolumn == $endcolumn) { // single column</span></div>
<div class="line"><a name="l19678"></a><span class="lineno">19678</span>&#160;<span class="stringliteral">                                        $cborder = $border;</span></div>
<div class="line"><a name="l19679"></a><span class="lineno">19679</span>&#160;<span class="stringliteral">                                        $h = $endy - $parent[&#39;</span>starty<span class="stringliteral">&#39;];</span></div>
<div class="line"><a name="l19680"></a><span class="lineno">19680</span>&#160;<span class="stringliteral">                                        $this-&gt;y = $y;</span></div>
<div class="line"><a name="l19681"></a><span class="lineno">19681</span>&#160;<span class="stringliteral">                                        $this-&gt;x = $x;</span></div>
<div class="line"><a name="l19682"></a><span class="lineno">19682</span>&#160;<span class="stringliteral">                                    } elseif ($column == $startcolumn) { // first column</span></div>
<div class="line"><a name="l19683"></a><span class="lineno">19683</span>&#160;<span class="stringliteral">                                        $cborder = $border_start;</span></div>
<div class="line"><a name="l19684"></a><span class="lineno">19684</span>&#160;<span class="stringliteral">                                        $this-&gt;y = $starty;</span></div>
<div class="line"><a name="l19685"></a><span class="lineno">19685</span>&#160;<span class="stringliteral">                                        $this-&gt;x = $x;</span></div>
<div class="line"><a name="l19686"></a><span class="lineno">19686</span>&#160;<span class="stringliteral">                                        $h = $this-&gt;h - $this-&gt;y - $this-&gt;bMargin;</span></div>
<div class="line"><a name="l19687"></a><span class="lineno">19687</span>&#160;<span class="stringliteral">                                        if ($this-&gt;rtl) {</span></div>
<div class="line"><a name="l19688"></a><span class="lineno">19688</span>&#160;<span class="stringliteral">                                            $deltacol = $this-&gt;x + $this-&gt;rMargin - $this-&gt;w;</span></div>
<div class="line"><a name="l19689"></a><span class="lineno">19689</span>&#160;<span class="stringliteral">                                        } else {</span></div>
<div class="line"><a name="l19690"></a><span class="lineno">19690</span>&#160;<span class="stringliteral">                                            $deltacol = $this-&gt;x - $this-&gt;lMargin;</span></div>
<div class="line"><a name="l19691"></a><span class="lineno">19691</span>&#160;<span class="stringliteral">                                        }</span></div>
<div class="line"><a name="l19692"></a><span class="lineno">19692</span>&#160;<span class="stringliteral">                                    } elseif ($column == $endcolumn) { // end column</span></div>
<div class="line"><a name="l19693"></a><span class="lineno">19693</span>&#160;<span class="stringliteral">                                        $cborder = $border_end;</span></div>
<div class="line"><a name="l19694"></a><span class="lineno">19694</span>&#160;<span class="stringliteral">                                        if (isset($this-&gt;columns[$column][&#39;</span>th<span class="stringliteral">&#39;][&#39;</span>\<span class="stringliteral">&#39;&#39;</span>.$page.<span class="charliteral">&#39;\&#39;&#39;</span>])) {</div>
<div class="line"><a name="l19695"></a><span class="lineno">19695</span>&#160;                                            $this-&gt;y = $this-&gt;columns[$column][<span class="stringliteral">&#39;th&#39;</span>][<span class="charliteral">&#39;\&#39;&#39;</span>.$page.<span class="charliteral">&#39;\&#39;&#39;</span>];</div>
<div class="line"><a name="l19696"></a><span class="lineno">19696</span>&#160;                                        }</div>
<div class="line"><a name="l19697"></a><span class="lineno">19697</span>&#160;                                        $this-&gt;x += $deltacol;</div>
<div class="line"><a name="l19698"></a><span class="lineno">19698</span>&#160;                                        <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> = $endy - <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l19699"></a><span class="lineno">19699</span>&#160;                                    } <span class="keywordflow">else</span> { <span class="comment">// middle column</span></div>
<div class="line"><a name="l19700"></a><span class="lineno">19700</span>&#160;                                        $cborder = $border_middle;</div>
<div class="line"><a name="l19701"></a><span class="lineno">19701</span>&#160;                                        <span class="keywordflow">if</span> (isset($this-&gt;columns[$column][<span class="stringliteral">&#39;th&#39;</span>][<span class="charliteral">&#39;\&#39;&#39;</span>.<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>.<span class="charliteral">&#39;\&#39;&#39;</span>])) {</div>
<div class="line"><a name="l19702"></a><span class="lineno">19702</span>&#160;                                            $this-&gt;y = $this-&gt;columns[$column][<span class="stringliteral">&#39;th&#39;</span>][<span class="charliteral">&#39;\&#39;&#39;</span>.$page.<span class="charliteral">&#39;\&#39;&#39;</span>];</div>
<div class="line"><a name="l19703"></a><span class="lineno">19703</span>&#160;                                        }</div>
<div class="line"><a name="l19704"></a><span class="lineno">19704</span>&#160;                                        $this-&gt;x += $deltacol;</div>
<div class="line"><a name="l19705"></a><span class="lineno">19705</span>&#160;                                        <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> = $this-&gt;h - $this-&gt;y - <a class="code" href="../../d4/d40/classTCPDF.html#acfe6c98519acb01dd53aa153c12bf79b">$this-&gt;bMargin</a>;</div>
<div class="line"><a name="l19706"></a><span class="lineno">19706</span>&#160;                                    }</div>
<div class="line"><a name="l19707"></a><span class="lineno">19707</span>&#160;                                    $ccode .= $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa064c22c3ff653664433fc4e05fa8efc">getCellCode</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, <span class="stringliteral">&#39;&#39;</span>, $cborder, 1, <span class="stringliteral">&#39;&#39;</span>, $fill, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="keyword">true</span>).<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l19708"></a><span class="lineno">19708</span>&#160;                                } <span class="comment">// end for each column</span></div>
<div class="line"><a name="l19709"></a><span class="lineno">19709</span>&#160;                            } elseif (<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a> == $startpage) { <span class="comment">// first page</span></div>
<div class="line"><a name="l19710"></a><span class="lineno">19710</span>&#160;                                $deltacol = 0;</div>
<div class="line"><a name="l19711"></a><span class="lineno">19711</span>&#160;                                $deltath = 0;</div>
<div class="line"><a name="l19712"></a><span class="lineno">19712</span>&#160;                                <span class="keywordflow">for</span> ($column = $startcolumn; $column &lt; <a class="code" href="../../d4/d40/classTCPDF.html#aea769a906ed606706e862bd7576e9a34">$this-&gt;num_columns</a>; ++$column) { <span class="comment">// for each column</span></div>
<div class="line"><a name="l19713"></a><span class="lineno">19713</span>&#160;                                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4f11d769024fd07e1f663efd02d10517">selectColumn</a>($column);</div>
<div class="line"><a name="l19714"></a><span class="lineno">19714</span>&#160;                                    <span class="keywordflow">if</span> ($column == $startcolumn) { <span class="comment">// first column</span></div>
<div class="line"><a name="l19715"></a><span class="lineno">19715</span>&#160;                                        $cborder = $border_start;</div>
<div class="line"><a name="l19716"></a><span class="lineno">19716</span>&#160;                                        $this-&gt;y = $starty;</div>
<div class="line"><a name="l19717"></a><span class="lineno">19717</span>&#160;                                        $this-&gt;x = <a class="code" href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">$x</a>;</div>
<div class="line"><a name="l19718"></a><span class="lineno">19718</span>&#160;                                        <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> = $this-&gt;h - $this-&gt;y - <a class="code" href="../../d4/d40/classTCPDF.html#acfe6c98519acb01dd53aa153c12bf79b">$this-&gt;bMargin</a>;</div>
<div class="line"><a name="l19719"></a><span class="lineno">19719</span>&#160;                                        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l19720"></a><span class="lineno">19720</span>&#160;                                            $deltacol = $this-&gt;x + $this-&gt;rMargin - <a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$this-&gt;w</a>;</div>
<div class="line"><a name="l19721"></a><span class="lineno">19721</span>&#160;                                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l19722"></a><span class="lineno">19722</span>&#160;                                            $deltacol = $this-&gt;x - <a class="code" href="../../d4/d40/classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da">$this-&gt;lMargin</a>;</div>
<div class="line"><a name="l19723"></a><span class="lineno">19723</span>&#160;                                        }</div>
<div class="line"><a name="l19724"></a><span class="lineno">19724</span>&#160;                                    } <span class="keywordflow">else</span> { <span class="comment">// middle column</span></div>
<div class="line"><a name="l19725"></a><span class="lineno">19725</span>&#160;                                        $cborder = $border_middle;</div>
<div class="line"><a name="l19726"></a><span class="lineno">19726</span>&#160;                                        <span class="keywordflow">if</span> (isset($this-&gt;columns[$column][<span class="stringliteral">&#39;th&#39;</span>][<span class="charliteral">&#39;\&#39;&#39;</span>.<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>.<span class="charliteral">&#39;\&#39;&#39;</span>])) {</div>
<div class="line"><a name="l19727"></a><span class="lineno">19727</span>&#160;                                            $this-&gt;y = $this-&gt;columns[$column][<span class="stringliteral">&#39;th&#39;</span>][<span class="charliteral">&#39;\&#39;&#39;</span>.$page.<span class="charliteral">&#39;\&#39;&#39;</span>];</div>
<div class="line"><a name="l19728"></a><span class="lineno">19728</span>&#160;                                        }</div>
<div class="line"><a name="l19729"></a><span class="lineno">19729</span>&#160;                                        $this-&gt;x += $deltacol;</div>
<div class="line"><a name="l19730"></a><span class="lineno">19730</span>&#160;                                        <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> = $this-&gt;h - $this-&gt;y - <a class="code" href="../../d4/d40/classTCPDF.html#acfe6c98519acb01dd53aa153c12bf79b">$this-&gt;bMargin</a>;</div>
<div class="line"><a name="l19731"></a><span class="lineno">19731</span>&#160;                                    }</div>
<div class="line"><a name="l19732"></a><span class="lineno">19732</span>&#160;                                    $ccode .= $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa064c22c3ff653664433fc4e05fa8efc">getCellCode</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, <span class="stringliteral">&#39;&#39;</span>, $cborder, 1, <span class="stringliteral">&#39;&#39;</span>, $fill, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="keyword">true</span>).<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l19733"></a><span class="lineno">19733</span>&#160;                                } <span class="comment">// end for each column</span></div>
<div class="line"><a name="l19734"></a><span class="lineno">19734</span>&#160;                            } elseif (<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a> == $endpage) { <span class="comment">// last page</span></div>
<div class="line"><a name="l19735"></a><span class="lineno">19735</span>&#160;                                $deltacol = 0;</div>
<div class="line"><a name="l19736"></a><span class="lineno">19736</span>&#160;                                $deltath = 0;</div>
<div class="line"><a name="l19737"></a><span class="lineno">19737</span>&#160;                                <span class="keywordflow">for</span> ($column = 0; $column &lt;= $endcolumn; ++$column) { <span class="comment">// for each column</span></div>
<div class="line"><a name="l19738"></a><span class="lineno">19738</span>&#160;                                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4f11d769024fd07e1f663efd02d10517">selectColumn</a>($column);</div>
<div class="line"><a name="l19739"></a><span class="lineno">19739</span>&#160;                                    <span class="keywordflow">if</span> ($column == $endcolumn) { <span class="comment">// end column</span></div>
<div class="line"><a name="l19740"></a><span class="lineno">19740</span>&#160;                                        $cborder = $border_end;</div>
<div class="line"><a name="l19741"></a><span class="lineno">19741</span>&#160;                                        <span class="keywordflow">if</span> (isset($this-&gt;columns[$column][<span class="stringliteral">&#39;th&#39;</span>][<span class="charliteral">&#39;\&#39;&#39;</span>.<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>.<span class="charliteral">&#39;\&#39;&#39;</span>])) {</div>
<div class="line"><a name="l19742"></a><span class="lineno">19742</span>&#160;                                            $this-&gt;y = $this-&gt;columns[$column][<span class="stringliteral">&#39;th&#39;</span>][<span class="charliteral">&#39;\&#39;&#39;</span>.$page.<span class="charliteral">&#39;\&#39;&#39;</span>];</div>
<div class="line"><a name="l19743"></a><span class="lineno">19743</span>&#160;                                        }</div>
<div class="line"><a name="l19744"></a><span class="lineno">19744</span>&#160;                                        $this-&gt;x += $deltacol;</div>
<div class="line"><a name="l19745"></a><span class="lineno">19745</span>&#160;                                        <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> = $endy - <a class="code" href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">$this-&gt;y</a>;</div>
<div class="line"><a name="l19746"></a><span class="lineno">19746</span>&#160;                                    } <span class="keywordflow">else</span> { <span class="comment">// middle column</span></div>
<div class="line"><a name="l19747"></a><span class="lineno">19747</span>&#160;                                        $cborder = $border_middle;</div>
<div class="line"><a name="l19748"></a><span class="lineno">19748</span>&#160;                                        <span class="keywordflow">if</span> (isset($this-&gt;columns[$column][<span class="stringliteral">&#39;th&#39;</span>][<span class="charliteral">&#39;\&#39;&#39;</span>.<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>.<span class="charliteral">&#39;\&#39;&#39;</span>])) {</div>
<div class="line"><a name="l19749"></a><span class="lineno">19749</span>&#160;                                            $this-&gt;y = $this-&gt;columns[$column][<span class="stringliteral">&#39;th&#39;</span>][<span class="charliteral">&#39;\&#39;&#39;</span>.$page.<span class="charliteral">&#39;\&#39;&#39;</span>];</div>
<div class="line"><a name="l19750"></a><span class="lineno">19750</span>&#160;                                        }</div>
<div class="line"><a name="l19751"></a><span class="lineno">19751</span>&#160;                                        $this-&gt;x += $deltacol;</div>
<div class="line"><a name="l19752"></a><span class="lineno">19752</span>&#160;                                        <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> = $this-&gt;h - $this-&gt;y - <a class="code" href="../../d4/d40/classTCPDF.html#acfe6c98519acb01dd53aa153c12bf79b">$this-&gt;bMargin</a>;</div>
<div class="line"><a name="l19753"></a><span class="lineno">19753</span>&#160;                                    }</div>
<div class="line"><a name="l19754"></a><span class="lineno">19754</span>&#160;                                    $ccode .= $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa064c22c3ff653664433fc4e05fa8efc">getCellCode</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, <span class="stringliteral">&#39;&#39;</span>, $cborder, 1, <span class="stringliteral">&#39;&#39;</span>, $fill, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="keyword">true</span>).<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l19755"></a><span class="lineno">19755</span>&#160;                                } <span class="comment">// end for each column</span></div>
<div class="line"><a name="l19756"></a><span class="lineno">19756</span>&#160;                            } <span class="keywordflow">else</span> { <span class="comment">// middle page</span></div>
<div class="line"><a name="l19757"></a><span class="lineno">19757</span>&#160;                                $deltacol = 0;</div>
<div class="line"><a name="l19758"></a><span class="lineno">19758</span>&#160;                                $deltath = 0;</div>
<div class="line"><a name="l19759"></a><span class="lineno">19759</span>&#160;                                <span class="keywordflow">for</span> ($column = 0; $column &lt; <a class="code" href="../../d4/d40/classTCPDF.html#aea769a906ed606706e862bd7576e9a34">$this-&gt;num_columns</a>; ++$column) { <span class="comment">// for each column</span></div>
<div class="line"><a name="l19760"></a><span class="lineno">19760</span>&#160;                                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4f11d769024fd07e1f663efd02d10517">selectColumn</a>($column);</div>
<div class="line"><a name="l19761"></a><span class="lineno">19761</span>&#160;                                    $cborder = $border_middle;</div>
<div class="line"><a name="l19762"></a><span class="lineno">19762</span>&#160;                                    <span class="keywordflow">if</span> (isset($this-&gt;columns[$column][<span class="stringliteral">&#39;th&#39;</span>][<span class="charliteral">&#39;\&#39;&#39;</span>.<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$page</a>.<span class="charliteral">&#39;\&#39;&#39;</span>])) {</div>
<div class="line"><a name="l19763"></a><span class="lineno">19763</span>&#160;                                        $this-&gt;y = $this-&gt;columns[$column][<span class="stringliteral">&#39;th&#39;</span>][<span class="charliteral">&#39;\&#39;&#39;</span>.$page.<span class="charliteral">&#39;\&#39;&#39;</span>];</div>
<div class="line"><a name="l19764"></a><span class="lineno">19764</span>&#160;                                    }</div>
<div class="line"><a name="l19765"></a><span class="lineno">19765</span>&#160;                                    $this-&gt;x += $deltacol;</div>
<div class="line"><a name="l19766"></a><span class="lineno">19766</span>&#160;                                    <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a> = $this-&gt;h - $this-&gt;y - <a class="code" href="../../d4/d40/classTCPDF.html#acfe6c98519acb01dd53aa153c12bf79b">$this-&gt;bMargin</a>;</div>
<div class="line"><a name="l19767"></a><span class="lineno">19767</span>&#160;                                    $ccode .= $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#aa064c22c3ff653664433fc4e05fa8efc">getCellCode</a>(<a class="code" href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">$w</a>, <a class="code" href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">$h</a>, <span class="stringliteral">&#39;&#39;</span>, $cborder, 1, <span class="stringliteral">&#39;&#39;</span>, $fill, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="keyword">true</span>).<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l19768"></a><span class="lineno">19768</span>&#160;                                } <span class="comment">// end for each column</span></div>
<div class="line"><a name="l19769"></a><span class="lineno">19769</span>&#160;                            }</div>
<div class="line"><a name="l19770"></a><span class="lineno">19770</span>&#160;                            <span class="keywordflow">if</span> (!empty($cborder) OR !empty($fill)) {</div>
<div class="line"><a name="l19771"></a><span class="lineno">19771</span>&#160;                                $offsetlen = strlen($ccode);</div>
<div class="line"><a name="l19772"></a><span class="lineno">19772</span>&#160;                                <span class="comment">// draw border and fill</span></div>
<div class="line"><a name="l19773"></a><span class="lineno">19773</span>&#160;                                <span class="keywordflow">if</span> ($this-&gt;inxobj) {</div>
<div class="line"><a name="l19774"></a><span class="lineno">19774</span>&#160;                                    <span class="comment">// we are inside an XObject template</span></div>
<div class="line"><a name="l19775"></a><span class="lineno">19775</span>&#160;                                    <span class="keywordflow">if</span> (end($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;transfmrk&#39;</span>]) !== <span class="keyword">false</span>) {</div>
<div class="line"><a name="l19776"></a><span class="lineno">19776</span>&#160;                                        $pagemarkkey = key($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;transfmrk&#39;</span>]);</div>
<div class="line"><a name="l19777"></a><span class="lineno">19777</span>&#160;                                        $pagemark = $this-&gt;xobjects[<a class="code" href="../../d4/d40/classTCPDF.html#abe4390b4e1939e10c9b61a986adfc117">$this-&gt;xobjid</a>][<span class="stringliteral">&#39;transfmrk&#39;</span>][$pagemarkkey];</div>
<div class="line"><a name="l19778"></a><span class="lineno">19778</span>&#160;                                        $this-&gt;xobjects[<a class="code" href="../../d4/d40/classTCPDF.html#abe4390b4e1939e10c9b61a986adfc117">$this-&gt;xobjid</a>][<span class="stringliteral">&#39;transfmrk&#39;</span>][$pagemarkkey] += $offsetlen;</div>
<div class="line"><a name="l19779"></a><span class="lineno">19779</span>&#160;                                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l19780"></a><span class="lineno">19780</span>&#160;                                        $pagemark = $this-&gt;xobjects[<a class="code" href="../../d4/d40/classTCPDF.html#abe4390b4e1939e10c9b61a986adfc117">$this-&gt;xobjid</a>][<span class="stringliteral">&#39;intmrk&#39;</span>];</div>
<div class="line"><a name="l19781"></a><span class="lineno">19781</span>&#160;                                        $this-&gt;xobjects[<a class="code" href="../../d4/d40/classTCPDF.html#abe4390b4e1939e10c9b61a986adfc117">$this-&gt;xobjid</a>][<span class="stringliteral">&#39;intmrk&#39;</span>] += $offsetlen;</div>
<div class="line"><a name="l19782"></a><span class="lineno">19782</span>&#160;                                    }</div>
<div class="line"><a name="l19783"></a><span class="lineno">19783</span>&#160;                                    $pagebuff = $this-&gt;xobjects[<a class="code" href="../../d4/d40/classTCPDF.html#abe4390b4e1939e10c9b61a986adfc117">$this-&gt;xobjid</a>][<span class="stringliteral">&#39;outdata&#39;</span>];</div>
<div class="line"><a name="l19784"></a><span class="lineno">19784</span>&#160;                                    $pstart = substr($pagebuff, 0, $pagemark);</div>
<div class="line"><a name="l19785"></a><span class="lineno">19785</span>&#160;                                    $pend = substr($pagebuff, $pagemark);</div>
<div class="line"><a name="l19786"></a><span class="lineno">19786</span>&#160;                                    $this-&gt;xobjects[<a class="code" href="../../d4/d40/classTCPDF.html#abe4390b4e1939e10c9b61a986adfc117">$this-&gt;xobjid</a>][<span class="stringliteral">&#39;outdata&#39;</span>] = $pstart.$ccode.$pend;</div>
<div class="line"><a name="l19787"></a><span class="lineno">19787</span>&#160;                                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l19788"></a><span class="lineno">19788</span>&#160;                                    <span class="comment">// draw border and fill</span></div>
<div class="line"><a name="l19789"></a><span class="lineno">19789</span>&#160;                                    <span class="keywordflow">if</span> (end($this-&gt;transfmrk[$this-&gt;page]) !== <span class="keyword">false</span>) {</div>
<div class="line"><a name="l19790"></a><span class="lineno">19790</span>&#160;                                        $pagemarkkey = key($this-&gt;transfmrk[$this-&gt;page]);</div>
<div class="line"><a name="l19791"></a><span class="lineno">19791</span>&#160;                                        $pagemark = $this-&gt;transfmrk[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][$pagemarkkey];</div>
<div class="line"><a name="l19792"></a><span class="lineno">19792</span>&#160;                                    } elseif ($this-&gt;InFooter) {</div>
<div class="line"><a name="l19793"></a><span class="lineno">19793</span>&#160;                                        $pagemark = $this-&gt;footerpos[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>];</div>
<div class="line"><a name="l19794"></a><span class="lineno">19794</span>&#160;                                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l19795"></a><span class="lineno">19795</span>&#160;                                        $pagemark = $this-&gt;intmrk[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>];</div>
<div class="line"><a name="l19796"></a><span class="lineno">19796</span>&#160;                                    }</div>
<div class="line"><a name="l19797"></a><span class="lineno">19797</span>&#160;                                    $pagebuff = $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d67b0a8681222f71fa9f9f6e65e0c56">getPageBuffer</a>($this-&gt;page);</div>
<div class="line"><a name="l19798"></a><span class="lineno">19798</span>&#160;                                    $pstart = substr($pagebuff, 0, $pagemark);</div>
<div class="line"><a name="l19799"></a><span class="lineno">19799</span>&#160;                                    $pend = substr($pagebuff, $pagemark);</div>
<div class="line"><a name="l19800"></a><span class="lineno">19800</span>&#160;                                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a2b85f6395de14dd40cab8839b3ce25a8">setPageBuffer</a>($this-&gt;page, $pstart.$ccode.$pend);</div>
<div class="line"><a name="l19801"></a><span class="lineno">19801</span>&#160;                                }</div>
<div class="line"><a name="l19802"></a><span class="lineno">19802</span>&#160;                            }</div>
<div class="line"><a name="l19803"></a><span class="lineno">19803</span>&#160;                        } <span class="comment">// end for each page</span></div>
<div class="line"><a name="l19804"></a><span class="lineno">19804</span>&#160;                        <span class="comment">// restore default border</span></div>
<div class="line"><a name="l19805"></a><span class="lineno">19805</span>&#160;                        $border = $default_border;</div>
<div class="line"><a name="l19806"></a><span class="lineno">19806</span>&#160;                    } <span class="comment">// end for each cell on the row</span></div>
<div class="line"><a name="l19807"></a><span class="lineno">19807</span>&#160;                    <span class="keywordflow">if</span> (isset($table_el[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;cellspacing&#39;</span>])) {</div>
<div class="line"><a name="l19808"></a><span class="lineno">19808</span>&#160;                        $this-&gt;y += $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9">getHTMLUnitToUnits</a>($table_el[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;cellspacing&#39;</span>], 1, <span class="stringliteral">&#39;px&#39;</span>);</div>
<div class="line"><a name="l19809"></a><span class="lineno">19809</span>&#160;                    } elseif (isset($table_el[<span class="stringliteral">&#39;border-spacing&#39;</span>])) {</div>
<div class="line"><a name="l19810"></a><span class="lineno">19810</span>&#160;                        $this-&gt;y += $table_el[<span class="stringliteral">&#39;border-spacing&#39;</span>][<span class="charliteral">&#39;V&#39;</span>];</div>
<div class="line"><a name="l19811"></a><span class="lineno">19811</span>&#160;                    }</div>
<div class="line"><a name="l19812"></a><span class="lineno">19812</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a00969cf629d72b3d29ee435f15906820">Ln</a>(0, $cell);</div>
<div class="line"><a name="l19813"></a><span class="lineno">19813</span>&#160;                    $this-&gt;x = $parent[<span class="stringliteral">&#39;startx&#39;</span>];</div>
<div class="line"><a name="l19814"></a><span class="lineno">19814</span>&#160;                    <span class="keywordflow">if</span> ($endpage &gt; $startpage) {</div>
<div class="line"><a name="l19815"></a><span class="lineno">19815</span>&#160;                        <span class="keywordflow">if</span> (($this-&gt;rtl) AND ($this-&gt;pagedim[$endpage][<span class="stringliteral">&#39;orm&#39;</span>] != $this-&gt;pagedim[$startpage][<span class="stringliteral">&#39;orm&#39;</span>])) {</div>
<div class="line"><a name="l19816"></a><span class="lineno">19816</span>&#160;                            $this-&gt;x += ($this-&gt;pagedim[$endpage][<span class="stringliteral">&#39;orm&#39;</span>] - $this-&gt;pagedim[$startpage][<span class="stringliteral">&#39;orm&#39;</span>]);</div>
<div class="line"><a name="l19817"></a><span class="lineno">19817</span>&#160;                        } elseif ((!$this-&gt;rtl) AND ($this-&gt;pagedim[$endpage][<span class="stringliteral">&#39;olm&#39;</span>] != $this-&gt;pagedim[$startpage][<span class="stringliteral">&#39;olm&#39;</span>])) {</div>
<div class="line"><a name="l19818"></a><span class="lineno">19818</span>&#160;                            $this-&gt;x += ($this-&gt;pagedim[$endpage][<span class="stringliteral">&#39;olm&#39;</span>] - $this-&gt;pagedim[$startpage][<span class="stringliteral">&#39;olm&#39;</span>]);</div>
<div class="line"><a name="l19819"></a><span class="lineno">19819</span>&#160;                        }</div>
<div class="line"><a name="l19820"></a><span class="lineno">19820</span>&#160;                    }</div>
<div class="line"><a name="l19821"></a><span class="lineno">19821</span>&#160;                }</div>
<div class="line"><a name="l19822"></a><span class="lineno">19822</span>&#160;                <span class="keywordflow">if</span> (!$in_table_head) { <span class="comment">// we are not inside a thead section</span></div>
<div class="line"><a name="l19823"></a><span class="lineno">19823</span>&#160;                    $this-&gt;cell_padding = $table_el[<span class="stringliteral">&#39;old_cell_padding&#39;</span>];</div>
<div class="line"><a name="l19824"></a><span class="lineno">19824</span>&#160;                    <span class="comment">// reset row height</span></div>
<div class="line"><a name="l19825"></a><span class="lineno">19825</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a10215105777b306528a827f3669e936e">resetLastH</a>();</div>
<div class="line"><a name="l19826"></a><span class="lineno">19826</span>&#160;                    <span class="keywordflow">if</span> (($this-&gt;page == ($this-&gt;numpages - 1)) AND ($this-&gt;pageopen[$this-&gt;numpages])) {</div>
<div class="line"><a name="l19827"></a><span class="lineno">19827</span>&#160;                        $plendiff = ($this-&gt;pagelen[<a class="code" href="../../d4/d40/classTCPDF.html#ae5dd5203ba48e26efcb24a6a6cabbb42">$this-&gt;numpages</a>] - $this-&gt;emptypagemrk[<a class="code" href="../../d4/d40/classTCPDF.html#ae5dd5203ba48e26efcb24a6a6cabbb42">$this-&gt;numpages</a>]);</div>
<div class="line"><a name="l19828"></a><span class="lineno">19828</span>&#160;                        <span class="keywordflow">if</span> (($plendiff &gt; 0) AND ($plendiff &lt; 60)) {</div>
<div class="line"><a name="l19829"></a><span class="lineno">19829</span>&#160;                            $pagediff = substr($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a4d67b0a8681222f71fa9f9f6e65e0c56">getPageBuffer</a>($this-&gt;numpages), $this-&gt;emptypagemrk[$this-&gt;numpages], $plendiff);</div>
<div class="line"><a name="l19830"></a><span class="lineno">19830</span>&#160;                            <span class="keywordflow">if</span> (substr($pagediff, 0, 5) == <span class="stringliteral">&#39;BT /F&#39;</span>) {</div>
<div class="line"><a name="l19831"></a><span class="lineno">19831</span>&#160;                                <span class="comment">// the difference is only a font setting</span></div>
<div class="line"><a name="l19832"></a><span class="lineno">19832</span>&#160;                                $plendiff = 0;</div>
<div class="line"><a name="l19833"></a><span class="lineno">19833</span>&#160;                            }</div>
<div class="line"><a name="l19834"></a><span class="lineno">19834</span>&#160;                        }</div>
<div class="line"><a name="l19835"></a><span class="lineno">19835</span>&#160;                        <span class="keywordflow">if</span> ($plendiff == 0) {</div>
<div class="line"><a name="l19836"></a><span class="lineno">19836</span>&#160;                            <span class="comment">// remove last blank page</span></div>
<div class="line"><a name="l19837"></a><span class="lineno">19837</span>&#160;                            $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a33ce8521d553c47b685d61d82bffbb5c">deletePage</a>($this-&gt;numpages);</div>
<div class="line"><a name="l19838"></a><span class="lineno">19838</span>&#160;                        }</div>
<div class="line"><a name="l19839"></a><span class="lineno">19839</span>&#160;                    }</div>
<div class="line"><a name="l19840"></a><span class="lineno">19840</span>&#160;                    <span class="keywordflow">if</span> (isset($this-&gt;theadMargins[<span class="stringliteral">&#39;top&#39;</span>])) {</div>
<div class="line"><a name="l19841"></a><span class="lineno">19841</span>&#160;                        <span class="comment">// restore top margin</span></div>
<div class="line"><a name="l19842"></a><span class="lineno">19842</span>&#160;                        $this-&gt;tMargin = $this-&gt;theadMargins[<span class="stringliteral">&#39;top&#39;</span>];</div>
<div class="line"><a name="l19843"></a><span class="lineno">19843</span>&#160;                    }</div>
<div class="line"><a name="l19844"></a><span class="lineno">19844</span>&#160;                    <span class="keywordflow">if</span> (!isset($table_el[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;nested&#39;</span>]) OR ($table_el[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;nested&#39;</span>] != <span class="stringliteral">&#39;true&#39;</span>)) {</div>
<div class="line"><a name="l19845"></a><span class="lineno">19845</span>&#160;                        <span class="comment">// reset main table header</span></div>
<div class="line"><a name="l19846"></a><span class="lineno">19846</span>&#160;                        $this-&gt;thead = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l19847"></a><span class="lineno">19847</span>&#160;                        $this-&gt;theadMargins = array();</div>
<div class="line"><a name="l19848"></a><span class="lineno">19848</span>&#160;                        $this-&gt;pagedim[<a class="code" href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">$this-&gt;page</a>][<span class="stringliteral">&#39;tm&#39;</span>] = <a class="code" href="../../d4/d40/classTCPDF.html#ace8343242b398fd16a4acb1926b6efa7">$this-&gt;tMargin</a>;</div>
<div class="line"><a name="l19849"></a><span class="lineno">19849</span>&#160;                    }</div>
<div class="line"><a name="l19850"></a><span class="lineno">19850</span>&#160;                }</div>
<div class="line"><a name="l19851"></a><span class="lineno">19851</span>&#160;                $parent = $table_el;</div>
<div class="line"><a name="l19852"></a><span class="lineno">19852</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19853"></a><span class="lineno">19853</span>&#160;            }</div>
<div class="line"><a name="l19854"></a><span class="lineno">19854</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;a&#39;</span>: {</div>
<div class="line"><a name="l19855"></a><span class="lineno">19855</span>&#160;                $this-&gt;HREF = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l19856"></a><span class="lineno">19856</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19857"></a><span class="lineno">19857</span>&#160;            }</div>
<div class="line"><a name="l19858"></a><span class="lineno">19858</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;sup&#39;</span>: {</div>
<div class="line"><a name="l19859"></a><span class="lineno">19859</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a00ec13928f57b17c21040acc881fe482">SetXY</a>($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a415a80a301208fa77552048b27d2e0ce">GetX</a>(), $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ae3b6169ba729309f289a5ac9680dd799">GetY</a>() + ((0.7 * $parent[<span class="stringliteral">&#39;fontsize&#39;</span>]) / $this-&gt;k));</div>
<div class="line"><a name="l19860"></a><span class="lineno">19860</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19861"></a><span class="lineno">19861</span>&#160;            }</div>
<div class="line"><a name="l19862"></a><span class="lineno">19862</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;sub&#39;</span>: {</div>
<div class="line"><a name="l19863"></a><span class="lineno">19863</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a00ec13928f57b17c21040acc881fe482">SetXY</a>($this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a415a80a301208fa77552048b27d2e0ce">GetX</a>(), $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#ae3b6169ba729309f289a5ac9680dd799">GetY</a>() - ((0.3 * $parent[<span class="stringliteral">&#39;fontsize&#39;</span>]) / $this-&gt;k));</div>
<div class="line"><a name="l19864"></a><span class="lineno">19864</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19865"></a><span class="lineno">19865</span>&#160;            }</div>
<div class="line"><a name="l19866"></a><span class="lineno">19866</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;div&#39;</span>: {</div>
<div class="line"><a name="l19867"></a><span class="lineno">19867</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a885b5862782e1d3ff05f349f278ca664">addHTMLVertSpace</a>($hbz, $hb, $cell, <span class="keyword">false</span>, $lasttag);</div>
<div class="line"><a name="l19868"></a><span class="lineno">19868</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19869"></a><span class="lineno">19869</span>&#160;            }</div>
<div class="line"><a name="l19870"></a><span class="lineno">19870</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;blockquote&#39;</span>: {</div>
<div class="line"><a name="l19871"></a><span class="lineno">19871</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l19872"></a><span class="lineno">19872</span>&#160;                    $this-&gt;rMargin -= <a class="code" href="../../d4/d40/classTCPDF.html#a66ab086d27a31dd0a7a7c69ea87b3767">$this-&gt;listindent</a>;</div>
<div class="line"><a name="l19873"></a><span class="lineno">19873</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l19874"></a><span class="lineno">19874</span>&#160;                    $this-&gt;lMargin -= <a class="code" href="../../d4/d40/classTCPDF.html#a66ab086d27a31dd0a7a7c69ea87b3767">$this-&gt;listindent</a>;</div>
<div class="line"><a name="l19875"></a><span class="lineno">19875</span>&#160;                }</div>
<div class="line"><a name="l19876"></a><span class="lineno">19876</span>&#160;                --<a class="code" href="../../d4/d40/classTCPDF.html#a1f87a9ca1927053aed6c3188edeb1d28">$this-&gt;listindentlevel</a>;</div>
<div class="line"><a name="l19877"></a><span class="lineno">19877</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a885b5862782e1d3ff05f349f278ca664">addHTMLVertSpace</a>($hbz, $hb, $cell, <span class="keyword">false</span>, $lasttag);</div>
<div class="line"><a name="l19878"></a><span class="lineno">19878</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19879"></a><span class="lineno">19879</span>&#160;            }</div>
<div class="line"><a name="l19880"></a><span class="lineno">19880</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;p&#39;</span>: {</div>
<div class="line"><a name="l19881"></a><span class="lineno">19881</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a885b5862782e1d3ff05f349f278ca664">addHTMLVertSpace</a>($hbz, $hb, $cell, <span class="keyword">false</span>, $lasttag);</div>
<div class="line"><a name="l19882"></a><span class="lineno">19882</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19883"></a><span class="lineno">19883</span>&#160;            }</div>
<div class="line"><a name="l19884"></a><span class="lineno">19884</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;pre&#39;</span>: {</div>
<div class="line"><a name="l19885"></a><span class="lineno">19885</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a885b5862782e1d3ff05f349f278ca664">addHTMLVertSpace</a>($hbz, $hb, $cell, <span class="keyword">false</span>, $lasttag);</div>
<div class="line"><a name="l19886"></a><span class="lineno">19886</span>&#160;                $this-&gt;premode = <span class="keyword">false</span>;</div>
<div class="line"><a name="l19887"></a><span class="lineno">19887</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19888"></a><span class="lineno">19888</span>&#160;            }</div>
<div class="line"><a name="l19889"></a><span class="lineno">19889</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;dl&#39;</span>: {</div>
<div class="line"><a name="l19890"></a><span class="lineno">19890</span>&#160;                --<a class="code" href="../../d4/d40/classTCPDF.html#a92b743d472f53d5260274c7915829ff7">$this-&gt;listnum</a>;</div>
<div class="line"><a name="l19891"></a><span class="lineno">19891</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;listnum &lt;= 0) {</div>
<div class="line"><a name="l19892"></a><span class="lineno">19892</span>&#160;                    $this-&gt;listnum = 0;</div>
<div class="line"><a name="l19893"></a><span class="lineno">19893</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a885b5862782e1d3ff05f349f278ca664">addHTMLVertSpace</a>($hbz, $hb, $cell, <span class="keyword">false</span>, $lasttag);</div>
<div class="line"><a name="l19894"></a><span class="lineno">19894</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l19895"></a><span class="lineno">19895</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a885b5862782e1d3ff05f349f278ca664">addHTMLVertSpace</a>(0, 0, $cell, <span class="keyword">false</span>, $lasttag);</div>
<div class="line"><a name="l19896"></a><span class="lineno">19896</span>&#160;                }</div>
<div class="line"><a name="l19897"></a><span class="lineno">19897</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a10215105777b306528a827f3669e936e">resetLastH</a>();</div>
<div class="line"><a name="l19898"></a><span class="lineno">19898</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19899"></a><span class="lineno">19899</span>&#160;            }</div>
<div class="line"><a name="l19900"></a><span class="lineno">19900</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;dt&#39;</span>: {</div>
<div class="line"><a name="l19901"></a><span class="lineno">19901</span>&#160;                $this-&gt;lispacer = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l19902"></a><span class="lineno">19902</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a885b5862782e1d3ff05f349f278ca664">addHTMLVertSpace</a>(0, 0, $cell, <span class="keyword">false</span>, $lasttag);</div>
<div class="line"><a name="l19903"></a><span class="lineno">19903</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19904"></a><span class="lineno">19904</span>&#160;            }</div>
<div class="line"><a name="l19905"></a><span class="lineno">19905</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;dd&#39;</span>: {</div>
<div class="line"><a name="l19906"></a><span class="lineno">19906</span>&#160;                $this-&gt;lispacer = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l19907"></a><span class="lineno">19907</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l19908"></a><span class="lineno">19908</span>&#160;                    $this-&gt;rMargin -= <a class="code" href="../../d4/d40/classTCPDF.html#a66ab086d27a31dd0a7a7c69ea87b3767">$this-&gt;listindent</a>;</div>
<div class="line"><a name="l19909"></a><span class="lineno">19909</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l19910"></a><span class="lineno">19910</span>&#160;                    $this-&gt;lMargin -= <a class="code" href="../../d4/d40/classTCPDF.html#a66ab086d27a31dd0a7a7c69ea87b3767">$this-&gt;listindent</a>;</div>
<div class="line"><a name="l19911"></a><span class="lineno">19911</span>&#160;                }</div>
<div class="line"><a name="l19912"></a><span class="lineno">19912</span>&#160;                --<a class="code" href="../../d4/d40/classTCPDF.html#a1f87a9ca1927053aed6c3188edeb1d28">$this-&gt;listindentlevel</a>;</div>
<div class="line"><a name="l19913"></a><span class="lineno">19913</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a885b5862782e1d3ff05f349f278ca664">addHTMLVertSpace</a>(0, 0, $cell, <span class="keyword">false</span>, $lasttag);</div>
<div class="line"><a name="l19914"></a><span class="lineno">19914</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19915"></a><span class="lineno">19915</span>&#160;            }</div>
<div class="line"><a name="l19916"></a><span class="lineno">19916</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;ul&#39;</span>:</div>
<div class="line"><a name="l19917"></a><span class="lineno">19917</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;ol&#39;</span>: {</div>
<div class="line"><a name="l19918"></a><span class="lineno">19918</span>&#160;                --<a class="code" href="../../d4/d40/classTCPDF.html#a92b743d472f53d5260274c7915829ff7">$this-&gt;listnum</a>;</div>
<div class="line"><a name="l19919"></a><span class="lineno">19919</span>&#160;                $this-&gt;lispacer = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l19920"></a><span class="lineno">19920</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l19921"></a><span class="lineno">19921</span>&#160;                    $this-&gt;rMargin -= <a class="code" href="../../d4/d40/classTCPDF.html#a66ab086d27a31dd0a7a7c69ea87b3767">$this-&gt;listindent</a>;</div>
<div class="line"><a name="l19922"></a><span class="lineno">19922</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l19923"></a><span class="lineno">19923</span>&#160;                    $this-&gt;lMargin -= <a class="code" href="../../d4/d40/classTCPDF.html#a66ab086d27a31dd0a7a7c69ea87b3767">$this-&gt;listindent</a>;</div>
<div class="line"><a name="l19924"></a><span class="lineno">19924</span>&#160;                }</div>
<div class="line"><a name="l19925"></a><span class="lineno">19925</span>&#160;                --<a class="code" href="../../d4/d40/classTCPDF.html#a1f87a9ca1927053aed6c3188edeb1d28">$this-&gt;listindentlevel</a>;</div>
<div class="line"><a name="l19926"></a><span class="lineno">19926</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;listnum &lt;= 0) {</div>
<div class="line"><a name="l19927"></a><span class="lineno">19927</span>&#160;                    $this-&gt;listnum = 0;</div>
<div class="line"><a name="l19928"></a><span class="lineno">19928</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a885b5862782e1d3ff05f349f278ca664">addHTMLVertSpace</a>($hbz, $hb, $cell, <span class="keyword">false</span>, $lasttag);</div>
<div class="line"><a name="l19929"></a><span class="lineno">19929</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l19930"></a><span class="lineno">19930</span>&#160;                    $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a885b5862782e1d3ff05f349f278ca664">addHTMLVertSpace</a>(0, 0, $cell, <span class="keyword">false</span>, $lasttag);</div>
<div class="line"><a name="l19931"></a><span class="lineno">19931</span>&#160;                }</div>
<div class="line"><a name="l19932"></a><span class="lineno">19932</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a10215105777b306528a827f3669e936e">resetLastH</a>();</div>
<div class="line"><a name="l19933"></a><span class="lineno">19933</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19934"></a><span class="lineno">19934</span>&#160;            }</div>
<div class="line"><a name="l19935"></a><span class="lineno">19935</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;li&#39;</span>: {</div>
<div class="line"><a name="l19936"></a><span class="lineno">19936</span>&#160;                $this-&gt;lispacer = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l19937"></a><span class="lineno">19937</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a885b5862782e1d3ff05f349f278ca664">addHTMLVertSpace</a>(0, 0, $cell, <span class="keyword">false</span>, $lasttag);</div>
<div class="line"><a name="l19938"></a><span class="lineno">19938</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19939"></a><span class="lineno">19939</span>&#160;            }</div>
<div class="line"><a name="l19940"></a><span class="lineno">19940</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;h1&#39;</span>:</div>
<div class="line"><a name="l19941"></a><span class="lineno">19941</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;h2&#39;</span>:</div>
<div class="line"><a name="l19942"></a><span class="lineno">19942</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;h3&#39;</span>:</div>
<div class="line"><a name="l19943"></a><span class="lineno">19943</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;h4&#39;</span>:</div>
<div class="line"><a name="l19944"></a><span class="lineno">19944</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;h5&#39;</span>:</div>
<div class="line"><a name="l19945"></a><span class="lineno">19945</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;h6&#39;</span>: {</div>
<div class="line"><a name="l19946"></a><span class="lineno">19946</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a885b5862782e1d3ff05f349f278ca664">addHTMLVertSpace</a>($hbz, $hb, $cell, <span class="keyword">false</span>, $lasttag);</div>
<div class="line"><a name="l19947"></a><span class="lineno">19947</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19948"></a><span class="lineno">19948</span>&#160;            }</div>
<div class="line"><a name="l19949"></a><span class="lineno">19949</span>&#160;            <span class="comment">// Form fields (since 4.8.000 - 2009-09-07)</span></div>
<div class="line"><a name="l19950"></a><span class="lineno">19950</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;form&#39;</span>: {</div>
<div class="line"><a name="l19951"></a><span class="lineno">19951</span>&#160;                $this-&gt;form_action = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l19952"></a><span class="lineno">19952</span>&#160;                $this-&gt;form_enctype = <span class="stringliteral">&#39;application/x-www-form-urlencoded&#39;</span>;</div>
<div class="line"><a name="l19953"></a><span class="lineno">19953</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19954"></a><span class="lineno">19954</span>&#160;            }</div>
<div class="line"><a name="l19955"></a><span class="lineno">19955</span>&#160;            <span class="keywordflow">default</span> : {</div>
<div class="line"><a name="l19956"></a><span class="lineno">19956</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l19957"></a><span class="lineno">19957</span>&#160;            }</div>
<div class="line"><a name="l19958"></a><span class="lineno">19958</span>&#160;        }</div>
<div class="line"><a name="l19959"></a><span class="lineno">19959</span>&#160;        <span class="comment">// draw border and background (if any)</span></div>
<div class="line"><a name="l19960"></a><span class="lineno">19960</span>&#160;        $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a87afce48ac2a2849fbb1f5e923e75c0b">drawHTMLTagBorder</a>($parent, $xmax);</div>
<div class="line"><a name="l19961"></a><span class="lineno">19961</span>&#160;        <span class="keywordflow">if</span> (isset($dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;pagebreakafter&#39;</span>])) {</div>
<div class="line"><a name="l19962"></a><span class="lineno">19962</span>&#160;            $pba = $dom[($dom[$key][<span class="stringliteral">&#39;parent&#39;</span>])][<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;pagebreakafter&#39;</span>];</div>
<div class="line"><a name="l19963"></a><span class="lineno">19963</span>&#160;            <span class="comment">// check for pagebreak</span></div>
<div class="line"><a name="l19964"></a><span class="lineno">19964</span>&#160;            <span class="keywordflow">if</span> (($pba == <span class="stringliteral">&#39;true&#39;</span>) OR ($pba == <span class="stringliteral">&#39;left&#39;</span>) OR ($pba == &#39;right&#39;)) {</div>
<div class="line"><a name="l19965"></a><span class="lineno">19965</span>&#160;                <span class="comment">// add a page (or trig AcceptPageBreak() for multicolumn mode)</span></div>
<div class="line"><a name="l19966"></a><span class="lineno">19966</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a9e8e4b4d75485b8f1e3aa2133a811e50">checkPageBreak</a>($this-&gt;PageBreakTrigger + 1);</div>
<div class="line"><a name="l19967"></a><span class="lineno">19967</span>&#160;            }</div>
<div class="line"><a name="l19968"></a><span class="lineno">19968</span>&#160;            <span class="keywordflow">if</span> ((($pba == <span class="stringliteral">&#39;left&#39;</span>) AND (((!$this-&gt;rtl) AND (($this-&gt;page % 2) == 0)) OR (($this-&gt;rtl) AND (($this-&gt;page % 2) != 0))))</div>
<div class="line"><a name="l19969"></a><span class="lineno">19969</span>&#160;                OR (($pba == <span class="stringliteral">&#39;right&#39;</span>) AND (((!$this-&gt;rtl) AND (($this-&gt;page % 2) != 0)) OR (($this-&gt;rtl) AND (($this-&gt;page % 2) == 0))))) {</div>
<div class="line"><a name="l19970"></a><span class="lineno">19970</span>&#160;                <span class="comment">// add a page (or trig AcceptPageBreak() for multicolumn mode)</span></div>
<div class="line"><a name="l19971"></a><span class="lineno">19971</span>&#160;                $this-&gt;<a class="code" href="../../d4/d40/classTCPDF.html#a9e8e4b4d75485b8f1e3aa2133a811e50">checkPageBreak</a>($this-&gt;PageBreakTrigger + 1);</div>
<div class="line"><a name="l19972"></a><span class="lineno">19972</span>&#160;            }</div>
<div class="line"><a name="l19973"></a><span class="lineno">19973</span>&#160;        }</div>
<div class="line"><a name="l19974"></a><span class="lineno">19974</span>&#160;        $this-&gt;tmprtl = <span class="keyword">false</span>;</div>
<div class="line"><a name="l19975"></a><span class="lineno">19975</span>&#160;        <span class="keywordflow">return</span> $dom;</div>
<div class="line"><a name="l19976"></a><span class="lineno">19976</span>&#160;    }</div>
<div class="line"><a name="l19977"></a><span class="lineno">19977</span>&#160;</div>
<div class="line"><a name="l19987"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a885b5862782e1d3ff05f349f278ca664">19987</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a885b5862782e1d3ff05f349f278ca664">addHTMLVertSpace</a>($hbz=0, $hb=0, $cell=<span class="keyword">false</span>, $firsttag=<span class="keyword">false</span>, $lasttag=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l19988"></a><span class="lineno">19988</span>&#160;        <span class="keywordflow">if</span> ($firsttag) {</div>
<div class="line"><a name="l19989"></a><span class="lineno">19989</span>&#160;            $this-&gt;Ln(0, $cell);</div>
<div class="line"><a name="l19990"></a><span class="lineno">19990</span>&#160;            $this-&gt;htmlvspace = 0;</div>
<div class="line"><a name="l19991"></a><span class="lineno">19991</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l19992"></a><span class="lineno">19992</span>&#160;        }</div>
<div class="line"><a name="l19993"></a><span class="lineno">19993</span>&#160;        <span class="keywordflow">if</span> ($lasttag) {</div>
<div class="line"><a name="l19994"></a><span class="lineno">19994</span>&#160;            $this-&gt;Ln($hbz, $cell);</div>
<div class="line"><a name="l19995"></a><span class="lineno">19995</span>&#160;            $this-&gt;htmlvspace = 0;</div>
<div class="line"><a name="l19996"></a><span class="lineno">19996</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l19997"></a><span class="lineno">19997</span>&#160;        }</div>
<div class="line"><a name="l19998"></a><span class="lineno">19998</span>&#160;        <span class="keywordflow">if</span> ($hb &lt; $this-&gt;htmlvspace) {</div>
<div class="line"><a name="l19999"></a><span class="lineno">19999</span>&#160;            $hd = 0;</div>
<div class="line"><a name="l20000"></a><span class="lineno">20000</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l20001"></a><span class="lineno">20001</span>&#160;            $hd = $hb - $this-&gt;htmlvspace;</div>
<div class="line"><a name="l20002"></a><span class="lineno">20002</span>&#160;            $this-&gt;htmlvspace = $hb;</div>
<div class="line"><a name="l20003"></a><span class="lineno">20003</span>&#160;        }</div>
<div class="line"><a name="l20004"></a><span class="lineno">20004</span>&#160;        $this-&gt;Ln(($hbz + $hd), $cell);</div>
<div class="line"><a name="l20005"></a><span class="lineno">20005</span>&#160;    }</div>
<div class="line"><a name="l20006"></a><span class="lineno">20006</span>&#160;</div>
<div class="line"><a name="l20013"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a5ff1d1bb3ba604c5cadff4388962432e">20013</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a5ff1d1bb3ba604c5cadff4388962432e">getBorderStartPosition</a>() {</div>
<div class="line"><a name="l20014"></a><span class="lineno">20014</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l20015"></a><span class="lineno">20015</span>&#160;            $xmax = $this-&gt;lMargin;</div>
<div class="line"><a name="l20016"></a><span class="lineno">20016</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l20017"></a><span class="lineno">20017</span>&#160;            $xmax = $this-&gt;w - $this-&gt;rMargin;</div>
<div class="line"><a name="l20018"></a><span class="lineno">20018</span>&#160;        }</div>
<div class="line"><a name="l20019"></a><span class="lineno">20019</span>&#160;        <span class="keywordflow">return</span> array(<span class="stringliteral">&#39;page&#39;</span> =&gt; $this-&gt;page, <span class="stringliteral">&#39;column&#39;</span> =&gt; $this-&gt;current_column, <span class="charliteral">&#39;x&#39;</span> =&gt; $this-&gt;x, <span class="charliteral">&#39;y&#39;</span> =&gt; $this-&gt;y, <span class="stringliteral">&#39;xmax&#39;</span> =&gt; $xmax);</div>
<div class="line"><a name="l20020"></a><span class="lineno">20020</span>&#160;    }</div>
<div class="line"><a name="l20021"></a><span class="lineno">20021</span>&#160;</div>
<div class="line"><a name="l20029"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a87afce48ac2a2849fbb1f5e923e75c0b">20029</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a87afce48ac2a2849fbb1f5e923e75c0b">drawHTMLTagBorder</a>($tag, $xmax) {</div>
<div class="line"><a name="l20030"></a><span class="lineno">20030</span>&#160;        <span class="keywordflow">if</span> (!isset($tag[<span class="stringliteral">&#39;borderposition&#39;</span>])) {</div>
<div class="line"><a name="l20031"></a><span class="lineno">20031</span>&#160;            <span class="comment">// nothing to draw</span></div>
<div class="line"><a name="l20032"></a><span class="lineno">20032</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l20033"></a><span class="lineno">20033</span>&#160;        }</div>
<div class="line"><a name="l20034"></a><span class="lineno">20034</span>&#160;        $prev_x = $this-&gt;x;</div>
<div class="line"><a name="l20035"></a><span class="lineno">20035</span>&#160;        $prev_y = $this-&gt;y;</div>
<div class="line"><a name="l20036"></a><span class="lineno">20036</span>&#160;        $prev_lasth = $this-&gt;lasth;</div>
<div class="line"><a name="l20037"></a><span class="lineno">20037</span>&#160;        $border = 0;</div>
<div class="line"><a name="l20038"></a><span class="lineno">20038</span>&#160;        $fill = <span class="keyword">false</span>;</div>
<div class="line"><a name="l20039"></a><span class="lineno">20039</span>&#160;        $this-&gt;lasth = 0;</div>
<div class="line"><a name="l20040"></a><span class="lineno">20040</span>&#160;        <span class="keywordflow">if</span> (isset($tag[<span class="stringliteral">&#39;border&#39;</span>]) AND !empty($tag[<span class="stringliteral">&#39;border&#39;</span>])) {</div>
<div class="line"><a name="l20041"></a><span class="lineno">20041</span>&#160;            <span class="comment">// get border style</span></div>
<div class="line"><a name="l20042"></a><span class="lineno">20042</span>&#160;            $border = $tag[<span class="stringliteral">&#39;border&#39;</span>];</div>
<div class="line"><a name="l20043"></a><span class="lineno">20043</span>&#160;            <span class="keywordflow">if</span> (!TCPDF_STATIC::empty_string($this-&gt;thead) AND (!$this-&gt;inthead)) {</div>
<div class="line"><a name="l20044"></a><span class="lineno">20044</span>&#160;                <span class="comment">// border for table header</span></div>
<div class="line"><a name="l20045"></a><span class="lineno">20045</span>&#160;                $border = TCPDF_STATIC::getBorderMode($border, $position=<span class="stringliteral">&#39;middle&#39;</span>, $this-&gt;opencell);</div>
<div class="line"><a name="l20046"></a><span class="lineno">20046</span>&#160;            }</div>
<div class="line"><a name="l20047"></a><span class="lineno">20047</span>&#160;        }</div>
<div class="line"><a name="l20048"></a><span class="lineno">20048</span>&#160;        <span class="keywordflow">if</span> (isset($tag[<span class="stringliteral">&#39;bgcolor&#39;</span>]) AND ($tag[<span class="stringliteral">&#39;bgcolor&#39;</span>] !== <span class="keyword">false</span>)) {</div>
<div class="line"><a name="l20049"></a><span class="lineno">20049</span>&#160;            <span class="comment">// get background color</span></div>
<div class="line"><a name="l20050"></a><span class="lineno">20050</span>&#160;            $old_bgcolor = $this-&gt;bgcolor;</div>
<div class="line"><a name="l20051"></a><span class="lineno">20051</span>&#160;            $this-&gt;SetFillColorArray($tag[<span class="stringliteral">&#39;bgcolor&#39;</span>]);</div>
<div class="line"><a name="l20052"></a><span class="lineno">20052</span>&#160;            $fill = <span class="keyword">true</span>;</div>
<div class="line"><a name="l20053"></a><span class="lineno">20053</span>&#160;        }</div>
<div class="line"><a name="l20054"></a><span class="lineno">20054</span>&#160;        <span class="keywordflow">if</span> (!$border AND !$fill) {</div>
<div class="line"><a name="l20055"></a><span class="lineno">20055</span>&#160;            <span class="comment">// nothing to draw</span></div>
<div class="line"><a name="l20056"></a><span class="lineno">20056</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l20057"></a><span class="lineno">20057</span>&#160;        }</div>
<div class="line"><a name="l20058"></a><span class="lineno">20058</span>&#160;        <span class="keywordflow">if</span> (isset($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;cellspacing&#39;</span>])) {</div>
<div class="line"><a name="l20059"></a><span class="lineno">20059</span>&#160;            $clsp = $this-&gt;getHTMLUnitToUnits($tag[<span class="stringliteral">&#39;attribute&#39;</span>][<span class="stringliteral">&#39;cellspacing&#39;</span>], 1, <span class="stringliteral">&#39;px&#39;</span>);</div>
<div class="line"><a name="l20060"></a><span class="lineno">20060</span>&#160;            $cellspacing = array(<span class="charliteral">&#39;H&#39;</span> =&gt; $clsp, <span class="charliteral">&#39;V&#39;</span> =&gt; $clsp);</div>
<div class="line"><a name="l20061"></a><span class="lineno">20061</span>&#160;        } elseif (isset($tag[<span class="stringliteral">&#39;border-spacing&#39;</span>])) {</div>
<div class="line"><a name="l20062"></a><span class="lineno">20062</span>&#160;            $cellspacing = $tag[<span class="stringliteral">&#39;border-spacing&#39;</span>];</div>
<div class="line"><a name="l20063"></a><span class="lineno">20063</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l20064"></a><span class="lineno">20064</span>&#160;            $cellspacing = array(<span class="charliteral">&#39;H&#39;</span> =&gt; 0, <span class="charliteral">&#39;V&#39;</span> =&gt; 0);</div>
<div class="line"><a name="l20065"></a><span class="lineno">20065</span>&#160;        }</div>
<div class="line"><a name="l20066"></a><span class="lineno">20066</span>&#160;        <span class="keywordflow">if</span> (($tag[<span class="stringliteral">&#39;value&#39;</span>] != <span class="stringliteral">&#39;table&#39;</span>) AND (is_array($border)) AND (!empty($border))) {</div>
<div class="line"><a name="l20067"></a><span class="lineno">20067</span>&#160;            <span class="comment">// draw the border externally respect the sqare edge.</span></div>
<div class="line"><a name="l20068"></a><span class="lineno">20068</span>&#160;            $border[<span class="stringliteral">&#39;mode&#39;</span>] = <span class="stringliteral">&#39;ext&#39;</span>;</div>
<div class="line"><a name="l20069"></a><span class="lineno">20069</span>&#160;        }</div>
<div class="line"><a name="l20070"></a><span class="lineno">20070</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l20071"></a><span class="lineno">20071</span>&#160;            <span class="keywordflow">if</span> ($xmax &gt;= $tag[<span class="stringliteral">&#39;borderposition&#39;</span>][<span class="charliteral">&#39;x&#39;</span>]) {</div>
<div class="line"><a name="l20072"></a><span class="lineno">20072</span>&#160;                $xmax = $tag[<span class="stringliteral">&#39;borderposition&#39;</span>][<span class="stringliteral">&#39;xmax&#39;</span>];</div>
<div class="line"><a name="l20073"></a><span class="lineno">20073</span>&#160;            }</div>
<div class="line"><a name="l20074"></a><span class="lineno">20074</span>&#160;            $w = ($tag[<span class="stringliteral">&#39;borderposition&#39;</span>][<span class="charliteral">&#39;x&#39;</span>] - $xmax);</div>
<div class="line"><a name="l20075"></a><span class="lineno">20075</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l20076"></a><span class="lineno">20076</span>&#160;            <span class="keywordflow">if</span> ($xmax &lt;= $tag[<span class="stringliteral">&#39;borderposition&#39;</span>][<span class="charliteral">&#39;x&#39;</span>]) {</div>
<div class="line"><a name="l20077"></a><span class="lineno">20077</span>&#160;                $xmax = $tag[<span class="stringliteral">&#39;borderposition&#39;</span>][<span class="stringliteral">&#39;xmax&#39;</span>];</div>
<div class="line"><a name="l20078"></a><span class="lineno">20078</span>&#160;            }</div>
<div class="line"><a name="l20079"></a><span class="lineno">20079</span>&#160;            $w = ($xmax - $tag[<span class="stringliteral">&#39;borderposition&#39;</span>][<span class="charliteral">&#39;x&#39;</span>]);</div>
<div class="line"><a name="l20080"></a><span class="lineno">20080</span>&#160;        }</div>
<div class="line"><a name="l20081"></a><span class="lineno">20081</span>&#160;        <span class="keywordflow">if</span> ($w &lt;= 0) {</div>
<div class="line"><a name="l20082"></a><span class="lineno">20082</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l20083"></a><span class="lineno">20083</span>&#160;        }</div>
<div class="line"><a name="l20084"></a><span class="lineno">20084</span>&#160;        $w += $cellspacing[<span class="charliteral">&#39;H&#39;</span>];</div>
<div class="line"><a name="l20085"></a><span class="lineno">20085</span>&#160;        $startpage = $tag[<span class="stringliteral">&#39;borderposition&#39;</span>][<span class="stringliteral">&#39;page&#39;</span>];</div>
<div class="line"><a name="l20086"></a><span class="lineno">20086</span>&#160;        $startcolumn = $tag[<span class="stringliteral">&#39;borderposition&#39;</span>][<span class="stringliteral">&#39;column&#39;</span>];</div>
<div class="line"><a name="l20087"></a><span class="lineno">20087</span>&#160;        $x = $tag[<span class="stringliteral">&#39;borderposition&#39;</span>][<span class="charliteral">&#39;x&#39;</span>];</div>
<div class="line"><a name="l20088"></a><span class="lineno">20088</span>&#160;        $y = $tag[<span class="stringliteral">&#39;borderposition&#39;</span>][<span class="charliteral">&#39;y&#39;</span>];</div>
<div class="line"><a name="l20089"></a><span class="lineno">20089</span>&#160;        $endpage = $this-&gt;page;</div>
<div class="line"><a name="l20090"></a><span class="lineno">20090</span>&#160;        $starty = $tag[<span class="stringliteral">&#39;borderposition&#39;</span>][<span class="charliteral">&#39;y&#39;</span>] - $cellspacing[<span class="charliteral">&#39;V&#39;</span>];</div>
<div class="line"><a name="l20091"></a><span class="lineno">20091</span>&#160;        $currentY = $this-&gt;y;</div>
<div class="line"><a name="l20092"></a><span class="lineno">20092</span>&#160;        $this-&gt;x = $x;</div>
<div class="line"><a name="l20093"></a><span class="lineno">20093</span>&#160;        <span class="comment">// get latest column</span></div>
<div class="line"><a name="l20094"></a><span class="lineno">20094</span>&#160;        $endcolumn = $this-&gt;current_column;</div>
<div class="line"><a name="l20095"></a><span class="lineno">20095</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;num_columns == 0) {</div>
<div class="line"><a name="l20096"></a><span class="lineno">20096</span>&#160;            $this-&gt;num_columns = 1;</div>
<div class="line"><a name="l20097"></a><span class="lineno">20097</span>&#160;        }</div>
<div class="line"><a name="l20098"></a><span class="lineno">20098</span>&#160;        <span class="comment">// get border modes</span></div>
<div class="line"><a name="l20099"></a><span class="lineno">20099</span>&#160;        $border_start = TCPDF_STATIC::getBorderMode($border, $position=<span class="stringliteral">&#39;start&#39;</span>, $this-&gt;opencell);</div>
<div class="line"><a name="l20100"></a><span class="lineno">20100</span>&#160;        $border_end = TCPDF_STATIC::getBorderMode($border, $position=<span class="stringliteral">&#39;end&#39;</span>, $this-&gt;opencell);</div>
<div class="line"><a name="l20101"></a><span class="lineno">20101</span>&#160;        $border_middle = TCPDF_STATIC::getBorderMode($border, $position=<span class="stringliteral">&#39;middle&#39;</span>, $this-&gt;opencell);</div>
<div class="line"><a name="l20102"></a><span class="lineno">20102</span>&#160;        <span class="comment">// temporary disable page regions</span></div>
<div class="line"><a name="l20103"></a><span class="lineno">20103</span>&#160;        $temp_page_regions = $this-&gt;page_regions;</div>
<div class="line"><a name="l20104"></a><span class="lineno">20104</span>&#160;        $this-&gt;page_regions = array();</div>
<div class="line"><a name="l20105"></a><span class="lineno">20105</span>&#160;        <span class="comment">// design borders around HTML cells.</span></div>
<div class="line"><a name="l20106"></a><span class="lineno">20106</span>&#160;        <span class="keywordflow">for</span> ($page = $startpage; $page &lt;= $endpage; ++$page) { <span class="comment">// for each page</span></div>
<div class="line"><a name="l20107"></a><span class="lineno">20107</span>&#160;            $ccode = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l20108"></a><span class="lineno">20108</span>&#160;            $this-&gt;setPage($page);</div>
<div class="line"><a name="l20109"></a><span class="lineno">20109</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;num_columns &lt; 2) {</div>
<div class="line"><a name="l20110"></a><span class="lineno">20110</span>&#160;                <span class="comment">// single-column mode</span></div>
<div class="line"><a name="l20111"></a><span class="lineno">20111</span>&#160;                $this-&gt;x = $x;</div>
<div class="line"><a name="l20112"></a><span class="lineno">20112</span>&#160;                $this-&gt;y = $this-&gt;tMargin;</div>
<div class="line"><a name="l20113"></a><span class="lineno">20113</span>&#160;            }</div>
<div class="line"><a name="l20114"></a><span class="lineno">20114</span>&#160;            <span class="comment">// account for margin changes</span></div>
<div class="line"><a name="l20115"></a><span class="lineno">20115</span>&#160;            <span class="keywordflow">if</span> ($page &gt; $startpage) {</div>
<div class="line"><a name="l20116"></a><span class="lineno">20116</span>&#160;                <span class="keywordflow">if</span> (($this-&gt;rtl) AND ($this-&gt;pagedim[$page][<span class="stringliteral">&#39;orm&#39;</span>] != $this-&gt;pagedim[$startpage][<span class="stringliteral">&#39;orm&#39;</span>])) {</div>
<div class="line"><a name="l20117"></a><span class="lineno">20117</span>&#160;                    $this-&gt;x -= ($this-&gt;pagedim[$page][<span class="stringliteral">&#39;orm&#39;</span>] - $this-&gt;pagedim[$startpage][<span class="stringliteral">&#39;orm&#39;</span>]);</div>
<div class="line"><a name="l20118"></a><span class="lineno">20118</span>&#160;                } elseif ((!$this-&gt;rtl) AND ($this-&gt;pagedim[$page][<span class="stringliteral">&#39;olm&#39;</span>] != $this-&gt;pagedim[$startpage][<span class="stringliteral">&#39;olm&#39;</span>])) {</div>
<div class="line"><a name="l20119"></a><span class="lineno">20119</span>&#160;                    $this-&gt;x += ($this-&gt;pagedim[$page][<span class="stringliteral">&#39;olm&#39;</span>] - $this-&gt;pagedim[$startpage][<span class="stringliteral">&#39;olm&#39;</span>]);</div>
<div class="line"><a name="l20120"></a><span class="lineno">20120</span>&#160;                }</div>
<div class="line"><a name="l20121"></a><span class="lineno">20121</span>&#160;            }</div>
<div class="line"><a name="l20122"></a><span class="lineno">20122</span>&#160;            <span class="keywordflow">if</span> ($startpage == $endpage) {</div>
<div class="line"><a name="l20123"></a><span class="lineno">20123</span>&#160;                <span class="comment">// single page</span></div>
<div class="line"><a name="l20124"></a><span class="lineno">20124</span>&#160;                <span class="keywordflow">for</span> ($column = $startcolumn; $column &lt;= $endcolumn; ++$column) { <span class="comment">// for each column</span></div>
<div class="line"><a name="l20125"></a><span class="lineno">20125</span>&#160;                    $this-&gt;selectColumn($column);</div>
<div class="line"><a name="l20126"></a><span class="lineno">20126</span>&#160;                    <span class="keywordflow">if</span> ($startcolumn == $endcolumn) { <span class="comment">// single column</span></div>
<div class="line"><a name="l20127"></a><span class="lineno">20127</span>&#160;                        $cborder = $border;</div>
<div class="line"><a name="l20128"></a><span class="lineno">20128</span>&#160;                        $h = ($currentY - $y) + $cellspacing[<span class="charliteral">&#39;V&#39;</span>];</div>
<div class="line"><a name="l20129"></a><span class="lineno">20129</span>&#160;                        $this-&gt;y = $starty;</div>
<div class="line"><a name="l20130"></a><span class="lineno">20130</span>&#160;                    } elseif ($column == $startcolumn) { <span class="comment">// first column</span></div>
<div class="line"><a name="l20131"></a><span class="lineno">20131</span>&#160;                        $cborder = $border_start;</div>
<div class="line"><a name="l20132"></a><span class="lineno">20132</span>&#160;                        $this-&gt;y = $starty;</div>
<div class="line"><a name="l20133"></a><span class="lineno">20133</span>&#160;                        $h = $this-&gt;h - $this-&gt;y - $this-&gt;bMargin;</div>
<div class="line"><a name="l20134"></a><span class="lineno">20134</span>&#160;                    } elseif ($column == $endcolumn) { <span class="comment">// end column</span></div>
<div class="line"><a name="l20135"></a><span class="lineno">20135</span>&#160;                        $cborder = $border_end;</div>
<div class="line"><a name="l20136"></a><span class="lineno">20136</span>&#160;                        $h = $currentY - $this-&gt;y;</div>
<div class="line"><a name="l20137"></a><span class="lineno">20137</span>&#160;                    } <span class="keywordflow">else</span> { <span class="comment">// middle column</span></div>
<div class="line"><a name="l20138"></a><span class="lineno">20138</span>&#160;                        $cborder = $border_middle;</div>
<div class="line"><a name="l20139"></a><span class="lineno">20139</span>&#160;                        $h = $this-&gt;h - $this-&gt;y - $this-&gt;bMargin;</div>
<div class="line"><a name="l20140"></a><span class="lineno">20140</span>&#160;                    }</div>
<div class="line"><a name="l20141"></a><span class="lineno">20141</span>&#160;                    $ccode .= $this-&gt;getCellCode($w, $h, <span class="stringliteral">&#39;&#39;</span>, $cborder, 1, <span class="stringliteral">&#39;&#39;</span>, $fill, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="keyword">true</span>).<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l20142"></a><span class="lineno">20142</span>&#160;                } <span class="comment">// end for each column</span></div>
<div class="line"><a name="l20143"></a><span class="lineno">20143</span>&#160;            } elseif ($page == $startpage) { <span class="comment">// first page</span></div>
<div class="line"><a name="l20144"></a><span class="lineno">20144</span>&#160;                <span class="keywordflow">for</span> ($column = $startcolumn; $column &lt; $this-&gt;num_columns; ++$column) { <span class="comment">// for each column</span></div>
<div class="line"><a name="l20145"></a><span class="lineno">20145</span>&#160;                    $this-&gt;selectColumn($column);</div>
<div class="line"><a name="l20146"></a><span class="lineno">20146</span>&#160;                    <span class="keywordflow">if</span> ($column == $startcolumn) { <span class="comment">// first column</span></div>
<div class="line"><a name="l20147"></a><span class="lineno">20147</span>&#160;                        $cborder = $border_start;</div>
<div class="line"><a name="l20148"></a><span class="lineno">20148</span>&#160;                        $this-&gt;y = $starty;</div>
<div class="line"><a name="l20149"></a><span class="lineno">20149</span>&#160;                        $h = $this-&gt;h - $this-&gt;y - $this-&gt;bMargin;</div>
<div class="line"><a name="l20150"></a><span class="lineno">20150</span>&#160;                    } <span class="keywordflow">else</span> { <span class="comment">// middle column</span></div>
<div class="line"><a name="l20151"></a><span class="lineno">20151</span>&#160;                        $cborder = $border_middle;</div>
<div class="line"><a name="l20152"></a><span class="lineno">20152</span>&#160;                        $h = $this-&gt;h - $this-&gt;y - $this-&gt;bMargin;</div>
<div class="line"><a name="l20153"></a><span class="lineno">20153</span>&#160;                    }</div>
<div class="line"><a name="l20154"></a><span class="lineno">20154</span>&#160;                    $ccode .= $this-&gt;getCellCode($w, $h, <span class="stringliteral">&#39;&#39;</span>, $cborder, 1, <span class="stringliteral">&#39;&#39;</span>, $fill, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="keyword">true</span>).<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l20155"></a><span class="lineno">20155</span>&#160;                } <span class="comment">// end for each column</span></div>
<div class="line"><a name="l20156"></a><span class="lineno">20156</span>&#160;            } elseif ($page == $endpage) { <span class="comment">// last page</span></div>
<div class="line"><a name="l20157"></a><span class="lineno">20157</span>&#160;                <span class="keywordflow">for</span> ($column = 0; $column &lt;= $endcolumn; ++$column) { <span class="comment">// for each column</span></div>
<div class="line"><a name="l20158"></a><span class="lineno">20158</span>&#160;                    $this-&gt;selectColumn($column);</div>
<div class="line"><a name="l20159"></a><span class="lineno">20159</span>&#160;                    <span class="keywordflow">if</span> ($column == $endcolumn) {</div>
<div class="line"><a name="l20160"></a><span class="lineno">20160</span>&#160;                        <span class="comment">// end column</span></div>
<div class="line"><a name="l20161"></a><span class="lineno">20161</span>&#160;                        $cborder = $border_end;</div>
<div class="line"><a name="l20162"></a><span class="lineno">20162</span>&#160;                        $h = $currentY - $this-&gt;y;</div>
<div class="line"><a name="l20163"></a><span class="lineno">20163</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l20164"></a><span class="lineno">20164</span>&#160;                        <span class="comment">// middle column</span></div>
<div class="line"><a name="l20165"></a><span class="lineno">20165</span>&#160;                        $cborder = $border_middle;</div>
<div class="line"><a name="l20166"></a><span class="lineno">20166</span>&#160;                        $h = $this-&gt;h - $this-&gt;y - $this-&gt;bMargin;</div>
<div class="line"><a name="l20167"></a><span class="lineno">20167</span>&#160;                    }</div>
<div class="line"><a name="l20168"></a><span class="lineno">20168</span>&#160;                    $ccode .= $this-&gt;getCellCode($w, $h, <span class="stringliteral">&#39;&#39;</span>, $cborder, 1, <span class="stringliteral">&#39;&#39;</span>, $fill, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="keyword">true</span>).<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l20169"></a><span class="lineno">20169</span>&#160;                } <span class="comment">// end for each column</span></div>
<div class="line"><a name="l20170"></a><span class="lineno">20170</span>&#160;            } <span class="keywordflow">else</span> { <span class="comment">// middle page</span></div>
<div class="line"><a name="l20171"></a><span class="lineno">20171</span>&#160;                <span class="keywordflow">for</span> ($column = 0; $column &lt; $this-&gt;num_columns; ++$column) { <span class="comment">// for each column</span></div>
<div class="line"><a name="l20172"></a><span class="lineno">20172</span>&#160;                    $this-&gt;selectColumn($column);</div>
<div class="line"><a name="l20173"></a><span class="lineno">20173</span>&#160;                    $cborder = $border_middle;</div>
<div class="line"><a name="l20174"></a><span class="lineno">20174</span>&#160;                    $h = $this-&gt;h - $this-&gt;y - $this-&gt;bMargin;</div>
<div class="line"><a name="l20175"></a><span class="lineno">20175</span>&#160;                    $ccode .= $this-&gt;getCellCode($w, $h, <span class="stringliteral">&#39;&#39;</span>, $cborder, 1, <span class="stringliteral">&#39;&#39;</span>, $fill, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="keyword">true</span>).<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l20176"></a><span class="lineno">20176</span>&#160;                } <span class="comment">// end for each column</span></div>
<div class="line"><a name="l20177"></a><span class="lineno">20177</span>&#160;            }</div>
<div class="line"><a name="l20178"></a><span class="lineno">20178</span>&#160;            <span class="keywordflow">if</span> ($cborder OR $fill) {</div>
<div class="line"><a name="l20179"></a><span class="lineno">20179</span>&#160;                $offsetlen = strlen($ccode);</div>
<div class="line"><a name="l20180"></a><span class="lineno">20180</span>&#160;                <span class="comment">// draw border and fill</span></div>
<div class="line"><a name="l20181"></a><span class="lineno">20181</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;inxobj) {</div>
<div class="line"><a name="l20182"></a><span class="lineno">20182</span>&#160;                    <span class="comment">// we are inside an XObject template</span></div>
<div class="line"><a name="l20183"></a><span class="lineno">20183</span>&#160;                    <span class="keywordflow">if</span> (end($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;transfmrk&#39;</span>]) !== <span class="keyword">false</span>) {</div>
<div class="line"><a name="l20184"></a><span class="lineno">20184</span>&#160;                        $pagemarkkey = key($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;transfmrk&#39;</span>]);</div>
<div class="line"><a name="l20185"></a><span class="lineno">20185</span>&#160;                        $pagemark = $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;transfmrk&#39;</span>][$pagemarkkey];</div>
<div class="line"><a name="l20186"></a><span class="lineno">20186</span>&#160;                        $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;transfmrk&#39;</span>][$pagemarkkey] += $offsetlen;</div>
<div class="line"><a name="l20187"></a><span class="lineno">20187</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l20188"></a><span class="lineno">20188</span>&#160;                        $pagemark = $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;intmrk&#39;</span>];</div>
<div class="line"><a name="l20189"></a><span class="lineno">20189</span>&#160;                        $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;intmrk&#39;</span>] += $offsetlen;</div>
<div class="line"><a name="l20190"></a><span class="lineno">20190</span>&#160;                    }</div>
<div class="line"><a name="l20191"></a><span class="lineno">20191</span>&#160;                    $pagebuff = $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;outdata&#39;</span>];</div>
<div class="line"><a name="l20192"></a><span class="lineno">20192</span>&#160;                    $pstart = substr($pagebuff, 0, $pagemark);</div>
<div class="line"><a name="l20193"></a><span class="lineno">20193</span>&#160;                    $pend = substr($pagebuff, $pagemark);</div>
<div class="line"><a name="l20194"></a><span class="lineno">20194</span>&#160;                    $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;outdata&#39;</span>] = $pstart.$ccode.$pend;</div>
<div class="line"><a name="l20195"></a><span class="lineno">20195</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l20196"></a><span class="lineno">20196</span>&#160;                    <span class="keywordflow">if</span> (end($this-&gt;transfmrk[$this-&gt;page]) !== <span class="keyword">false</span>) {</div>
<div class="line"><a name="l20197"></a><span class="lineno">20197</span>&#160;                        $pagemarkkey = key($this-&gt;transfmrk[$this-&gt;page]);</div>
<div class="line"><a name="l20198"></a><span class="lineno">20198</span>&#160;                        $pagemark = $this-&gt;transfmrk[$this-&gt;page][$pagemarkkey];</div>
<div class="line"><a name="l20199"></a><span class="lineno">20199</span>&#160;                    } elseif ($this-&gt;InFooter) {</div>
<div class="line"><a name="l20200"></a><span class="lineno">20200</span>&#160;                        $pagemark = $this-&gt;footerpos[$this-&gt;page];</div>
<div class="line"><a name="l20201"></a><span class="lineno">20201</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l20202"></a><span class="lineno">20202</span>&#160;                        $pagemark = $this-&gt;intmrk[$this-&gt;page];</div>
<div class="line"><a name="l20203"></a><span class="lineno">20203</span>&#160;                    }</div>
<div class="line"><a name="l20204"></a><span class="lineno">20204</span>&#160;                    $pagebuff = $this-&gt;getPageBuffer($this-&gt;page);</div>
<div class="line"><a name="l20205"></a><span class="lineno">20205</span>&#160;                    $pstart = substr($pagebuff, 0, $pagemark);</div>
<div class="line"><a name="l20206"></a><span class="lineno">20206</span>&#160;                    $pend = substr($pagebuff, $pagemark);</div>
<div class="line"><a name="l20207"></a><span class="lineno">20207</span>&#160;                    $this-&gt;setPageBuffer($this-&gt;page, $pstart.$ccode.$pend);</div>
<div class="line"><a name="l20208"></a><span class="lineno">20208</span>&#160;                    $this-&gt;bordermrk[$this-&gt;page] += $offsetlen;</div>
<div class="line"><a name="l20209"></a><span class="lineno">20209</span>&#160;                    $this-&gt;cntmrk[$this-&gt;page] += $offsetlen;</div>
<div class="line"><a name="l20210"></a><span class="lineno">20210</span>&#160;                }</div>
<div class="line"><a name="l20211"></a><span class="lineno">20211</span>&#160;            }</div>
<div class="line"><a name="l20212"></a><span class="lineno">20212</span>&#160;        } <span class="comment">// end for each page</span></div>
<div class="line"><a name="l20213"></a><span class="lineno">20213</span>&#160;        <span class="comment">// restore page regions</span></div>
<div class="line"><a name="l20214"></a><span class="lineno">20214</span>&#160;        $this-&gt;page_regions = $temp_page_regions;</div>
<div class="line"><a name="l20215"></a><span class="lineno">20215</span>&#160;        <span class="keywordflow">if</span> (isset($old_bgcolor)) {</div>
<div class="line"><a name="l20216"></a><span class="lineno">20216</span>&#160;            <span class="comment">// restore background color</span></div>
<div class="line"><a name="l20217"></a><span class="lineno">20217</span>&#160;            $this-&gt;SetFillColorArray($old_bgcolor);</div>
<div class="line"><a name="l20218"></a><span class="lineno">20218</span>&#160;        }</div>
<div class="line"><a name="l20219"></a><span class="lineno">20219</span>&#160;        <span class="comment">// restore pointer position</span></div>
<div class="line"><a name="l20220"></a><span class="lineno">20220</span>&#160;        $this-&gt;x = $prev_x;</div>
<div class="line"><a name="l20221"></a><span class="lineno">20221</span>&#160;        $this-&gt;y = $prev_y;</div>
<div class="line"><a name="l20222"></a><span class="lineno">20222</span>&#160;        $this-&gt;lasth = $prev_lasth;</div>
<div class="line"><a name="l20223"></a><span class="lineno">20223</span>&#160;    }</div>
<div class="line"><a name="l20224"></a><span class="lineno">20224</span>&#160;</div>
<div class="line"><a name="l20231"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#af38b4f69c334a8662ce586597fdad151">20231</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#af38b4f69c334a8662ce586597fdad151">setLIsymbol</a>($symbol=<span class="charliteral">&#39;!&#39;</span>) {</div>
<div class="line"><a name="l20232"></a><span class="lineno">20232</span>&#160;        <span class="comment">// check for custom image symbol</span></div>
<div class="line"><a name="l20233"></a><span class="lineno">20233</span>&#160;        <span class="keywordflow">if</span> (substr($symbol, 0, 4) == <span class="stringliteral">&#39;img|&#39;</span>) {</div>
<div class="line"><a name="l20234"></a><span class="lineno">20234</span>&#160;            $this-&gt;lisymbol = $symbol;</div>
<div class="line"><a name="l20235"></a><span class="lineno">20235</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l20236"></a><span class="lineno">20236</span>&#160;        }</div>
<div class="line"><a name="l20237"></a><span class="lineno">20237</span>&#160;        $symbol = strtolower($symbol);</div>
<div class="line"><a name="l20238"></a><span class="lineno">20238</span>&#160;        $valid_symbols = array(<span class="charliteral">&#39;!&#39;</span>, <span class="charliteral">&#39;#&#39;</span>, <span class="stringliteral">&#39;disc&#39;</span>, <span class="stringliteral">&#39;circle&#39;</span>, <span class="stringliteral">&#39;square&#39;</span>, <span class="charliteral">&#39;1&#39;</span>, <span class="stringliteral">&#39;decimal&#39;</span>, <span class="stringliteral">&#39;decimal-leading-zero&#39;</span>, <span class="charliteral">&#39;i&#39;</span>, <span class="stringliteral">&#39;lower-roman&#39;</span>, <span class="charliteral">&#39;I&#39;</span>, <span class="stringliteral">&#39;upper-roman&#39;</span>, <span class="charliteral">&#39;a&#39;</span>, <span class="stringliteral">&#39;lower-alpha&#39;</span>, <span class="stringliteral">&#39;lower-latin&#39;</span>, <span class="charliteral">&#39;A&#39;</span>, <span class="stringliteral">&#39;upper-alpha&#39;</span>, <span class="stringliteral">&#39;upper-latin&#39;</span>, <span class="stringliteral">&#39;lower-greek&#39;</span>);</div>
<div class="line"><a name="l20239"></a><span class="lineno">20239</span>&#160;        <span class="keywordflow">if</span> (in_array($symbol, $valid_symbols)) {</div>
<div class="line"><a name="l20240"></a><span class="lineno">20240</span>&#160;            $this-&gt;lisymbol = $symbol;</div>
<div class="line"><a name="l20241"></a><span class="lineno">20241</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l20242"></a><span class="lineno">20242</span>&#160;            $this-&gt;lisymbol = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l20243"></a><span class="lineno">20243</span>&#160;        }</div>
<div class="line"><a name="l20244"></a><span class="lineno">20244</span>&#160;    }</div>
<div class="line"><a name="l20245"></a><span class="lineno">20245</span>&#160;</div>
<div class="line"><a name="l20254"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#af57416c0d1b618b2af389b7c651756be">20254</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#af57416c0d1b618b2af389b7c651756be">SetBooklet</a>($booklet=<span class="keyword">true</span>, $inner=-1, $outer=-1) {</div>
<div class="line"><a name="l20255"></a><span class="lineno">20255</span>&#160;        $this-&gt;booklet = $booklet;</div>
<div class="line"><a name="l20256"></a><span class="lineno">20256</span>&#160;        <span class="keywordflow">if</span> ($inner &gt;= 0) {</div>
<div class="line"><a name="l20257"></a><span class="lineno">20257</span>&#160;            $this-&gt;lMargin = $inner;</div>
<div class="line"><a name="l20258"></a><span class="lineno">20258</span>&#160;        }</div>
<div class="line"><a name="l20259"></a><span class="lineno">20259</span>&#160;        <span class="keywordflow">if</span> ($outer &gt;= 0) {</div>
<div class="line"><a name="l20260"></a><span class="lineno">20260</span>&#160;            $this-&gt;rMargin = $outer;</div>
<div class="line"><a name="l20261"></a><span class="lineno">20261</span>&#160;        }</div>
<div class="line"><a name="l20262"></a><span class="lineno">20262</span>&#160;    }</div>
<div class="line"><a name="l20263"></a><span class="lineno">20263</span>&#160;</div>
<div class="line"><a name="l20270"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aae16fb109eb4f3aaa9ba860cfb1cf1f2">20270</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#aae16fb109eb4f3aaa9ba860cfb1cf1f2">swapMargins</a>($reverse=<span class="keyword">true</span>) {</div>
<div class="line"><a name="l20271"></a><span class="lineno">20271</span>&#160;        <span class="keywordflow">if</span> ($reverse) {</div>
<div class="line"><a name="l20272"></a><span class="lineno">20272</span>&#160;            <span class="comment">// swap left and right margins</span></div>
<div class="line"><a name="l20273"></a><span class="lineno">20273</span>&#160;            $mtemp = $this-&gt;original_lMargin;</div>
<div class="line"><a name="l20274"></a><span class="lineno">20274</span>&#160;            $this-&gt;original_lMargin = $this-&gt;original_rMargin;</div>
<div class="line"><a name="l20275"></a><span class="lineno">20275</span>&#160;            $this-&gt;original_rMargin = $mtemp;</div>
<div class="line"><a name="l20276"></a><span class="lineno">20276</span>&#160;            $deltam = $this-&gt;original_lMargin - $this-&gt;original_rMargin;</div>
<div class="line"><a name="l20277"></a><span class="lineno">20277</span>&#160;            $this-&gt;lMargin += $deltam;</div>
<div class="line"><a name="l20278"></a><span class="lineno">20278</span>&#160;            $this-&gt;rMargin -= $deltam;</div>
<div class="line"><a name="l20279"></a><span class="lineno">20279</span>&#160;        }</div>
<div class="line"><a name="l20280"></a><span class="lineno">20280</span>&#160;    }</div>
<div class="line"><a name="l20281"></a><span class="lineno">20281</span>&#160;</div>
<div class="line"><a name="l20294"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a71cec8b4c54a78429640e4767648e73e">20294</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a71cec8b4c54a78429640e4767648e73e">setHtmlVSpace</a>($tagvs) {</div>
<div class="line"><a name="l20295"></a><span class="lineno">20295</span>&#160;        $this-&gt;tagvspaces = $tagvs;</div>
<div class="line"><a name="l20296"></a><span class="lineno">20296</span>&#160;    }</div>
<div class="line"><a name="l20297"></a><span class="lineno">20297</span>&#160;</div>
<div class="line"><a name="l20304"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a1d8b1b2420194c155de303fac195264f">20304</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a1d8b1b2420194c155de303fac195264f">setListIndentWidth</a>($width) {</div>
<div class="line"><a name="l20305"></a><span class="lineno">20305</span>&#160;        <span class="keywordflow">return</span> $this-&gt;customlistindent = floatval($width);</div>
<div class="line"><a name="l20306"></a><span class="lineno">20306</span>&#160;    }</div>
<div class="line"><a name="l20307"></a><span class="lineno">20307</span>&#160;</div>
<div class="line"><a name="l20314"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a71afe1786fa1c806b0e64b516c715b03">20314</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a71afe1786fa1c806b0e64b516c715b03">setOpenCell</a>($isopen) {</div>
<div class="line"><a name="l20315"></a><span class="lineno">20315</span>&#160;        $this-&gt;opencell = $isopen;</div>
<div class="line"><a name="l20316"></a><span class="lineno">20316</span>&#160;    }</div>
<div class="line"><a name="l20317"></a><span class="lineno">20317</span>&#160;</div>
<div class="line"><a name="l20325"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a8689e059bc8cb0f8436b77d07c7ab32c">20325</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a8689e059bc8cb0f8436b77d07c7ab32c">setHtmlLinksStyle</a>($color=array(0,0,255), $fontstyle=<span class="charliteral">&#39;U&#39;</span>) {</div>
<div class="line"><a name="l20326"></a><span class="lineno">20326</span>&#160;        $this-&gt;htmlLinkColorArray = $color;</div>
<div class="line"><a name="l20327"></a><span class="lineno">20327</span>&#160;        $this-&gt;htmlLinkFontStyle = $fontstyle;</div>
<div class="line"><a name="l20328"></a><span class="lineno">20328</span>&#160;    }</div>
<div class="line"><a name="l20329"></a><span class="lineno">20329</span>&#160;</div>
<div class="line"><a name="l20340"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9">20340</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9">getHTMLUnitToUnits</a>($htmlval, $refsize=1, $defaultunit=<span class="stringliteral">&#39;px&#39;</span>, $points=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l20341"></a><span class="lineno">20341</span>&#160;        $supportedunits = array(<span class="charliteral">&#39;%&#39;</span>, <span class="stringliteral">&#39;em&#39;</span>, <span class="stringliteral">&#39;ex&#39;</span>, <span class="stringliteral">&#39;px&#39;</span>, <span class="stringliteral">&#39;in&#39;</span>, <span class="stringliteral">&#39;cm&#39;</span>, <span class="stringliteral">&#39;mm&#39;</span>, <span class="stringliteral">&#39;pc&#39;</span>, <span class="stringliteral">&#39;pt&#39;</span>);</div>
<div class="line"><a name="l20342"></a><span class="lineno">20342</span>&#160;        $retval = 0;</div>
<div class="line"><a name="l20343"></a><span class="lineno">20343</span>&#160;        $value = 0;</div>
<div class="line"><a name="l20344"></a><span class="lineno">20344</span>&#160;        $unit = <span class="stringliteral">&#39;px&#39;</span>;</div>
<div class="line"><a name="l20345"></a><span class="lineno">20345</span>&#160;        <span class="keywordflow">if</span> ($points) {</div>
<div class="line"><a name="l20346"></a><span class="lineno">20346</span>&#160;            $k = 1;</div>
<div class="line"><a name="l20347"></a><span class="lineno">20347</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l20348"></a><span class="lineno">20348</span>&#160;            $k = $this-&gt;k;</div>
<div class="line"><a name="l20349"></a><span class="lineno">20349</span>&#160;        }</div>
<div class="line"><a name="l20350"></a><span class="lineno">20350</span>&#160;        <span class="keywordflow">if</span> (in_array($defaultunit, $supportedunits)) {</div>
<div class="line"><a name="l20351"></a><span class="lineno">20351</span>&#160;            $unit = $defaultunit;</div>
<div class="line"><a name="l20352"></a><span class="lineno">20352</span>&#160;        }</div>
<div class="line"><a name="l20353"></a><span class="lineno">20353</span>&#160;        <span class="keywordflow">if</span> (is_numeric($htmlval)) {</div>
<div class="line"><a name="l20354"></a><span class="lineno">20354</span>&#160;            $value = floatval($htmlval);</div>
<div class="line"><a name="l20355"></a><span class="lineno">20355</span>&#160;        } elseif (preg_match(<span class="stringliteral">&#39;/([0-9\.\-\+]+)/&#39;</span>, $htmlval, $mnum)) {</div>
<div class="line"><a name="l20356"></a><span class="lineno">20356</span>&#160;            $value = floatval($mnum[1]);</div>
<div class="line"><a name="l20357"></a><span class="lineno">20357</span>&#160;            <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/([a-z%]+)/&#39;</span>, $htmlval, $munit)) {</div>
<div class="line"><a name="l20358"></a><span class="lineno">20358</span>&#160;                <span class="keywordflow">if</span> (in_array($munit[1], $supportedunits)) {</div>
<div class="line"><a name="l20359"></a><span class="lineno">20359</span>&#160;                    $unit = $munit[1];</div>
<div class="line"><a name="l20360"></a><span class="lineno">20360</span>&#160;                }</div>
<div class="line"><a name="l20361"></a><span class="lineno">20361</span>&#160;            }</div>
<div class="line"><a name="l20362"></a><span class="lineno">20362</span>&#160;        }</div>
<div class="line"><a name="l20363"></a><span class="lineno">20363</span>&#160;        <span class="keywordflow">switch</span> ($unit) {</div>
<div class="line"><a name="l20364"></a><span class="lineno">20364</span>&#160;            <span class="comment">// percentage</span></div>
<div class="line"><a name="l20365"></a><span class="lineno">20365</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;%&#39;</span>: {</div>
<div class="line"><a name="l20366"></a><span class="lineno">20366</span>&#160;                $retval = (($value * $refsize) / 100);</div>
<div class="line"><a name="l20367"></a><span class="lineno">20367</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l20368"></a><span class="lineno">20368</span>&#160;            }</div>
<div class="line"><a name="l20369"></a><span class="lineno">20369</span>&#160;            <span class="comment">// relative-size</span></div>
<div class="line"><a name="l20370"></a><span class="lineno">20370</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;em&#39;</span>: {</div>
<div class="line"><a name="l20371"></a><span class="lineno">20371</span>&#160;                $retval = ($value * $refsize);</div>
<div class="line"><a name="l20372"></a><span class="lineno">20372</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l20373"></a><span class="lineno">20373</span>&#160;            }</div>
<div class="line"><a name="l20374"></a><span class="lineno">20374</span>&#160;            <span class="comment">// height of lower case &#39;x&#39; (about half the font-size)</span></div>
<div class="line"><a name="l20375"></a><span class="lineno">20375</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;ex&#39;</span>: {</div>
<div class="line"><a name="l20376"></a><span class="lineno">20376</span>&#160;                $retval = ($value * ($refsize / 2));</div>
<div class="line"><a name="l20377"></a><span class="lineno">20377</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l20378"></a><span class="lineno">20378</span>&#160;            }</div>
<div class="line"><a name="l20379"></a><span class="lineno">20379</span>&#160;            <span class="comment">// absolute-size</span></div>
<div class="line"><a name="l20380"></a><span class="lineno">20380</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;in&#39;</span>: {</div>
<div class="line"><a name="l20381"></a><span class="lineno">20381</span>&#160;                $retval = (($value * $this-&gt;dpi) / $k);</div>
<div class="line"><a name="l20382"></a><span class="lineno">20382</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l20383"></a><span class="lineno">20383</span>&#160;            }</div>
<div class="line"><a name="l20384"></a><span class="lineno">20384</span>&#160;            <span class="comment">// centimeters</span></div>
<div class="line"><a name="l20385"></a><span class="lineno">20385</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;cm&#39;</span>: {</div>
<div class="line"><a name="l20386"></a><span class="lineno">20386</span>&#160;                $retval = (($value / 2.54 * $this-&gt;dpi) / $k);</div>
<div class="line"><a name="l20387"></a><span class="lineno">20387</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l20388"></a><span class="lineno">20388</span>&#160;            }</div>
<div class="line"><a name="l20389"></a><span class="lineno">20389</span>&#160;            <span class="comment">// millimeters</span></div>
<div class="line"><a name="l20390"></a><span class="lineno">20390</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;mm&#39;</span>: {</div>
<div class="line"><a name="l20391"></a><span class="lineno">20391</span>&#160;                $retval = (($value / 25.4 * $this-&gt;dpi) / $k);</div>
<div class="line"><a name="l20392"></a><span class="lineno">20392</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l20393"></a><span class="lineno">20393</span>&#160;            }</div>
<div class="line"><a name="l20394"></a><span class="lineno">20394</span>&#160;            <span class="comment">// one pica is 12 points</span></div>
<div class="line"><a name="l20395"></a><span class="lineno">20395</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;pc&#39;</span>: {</div>
<div class="line"><a name="l20396"></a><span class="lineno">20396</span>&#160;                $retval = (($value * 12) / $k);</div>
<div class="line"><a name="l20397"></a><span class="lineno">20397</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l20398"></a><span class="lineno">20398</span>&#160;            }</div>
<div class="line"><a name="l20399"></a><span class="lineno">20399</span>&#160;            <span class="comment">// points</span></div>
<div class="line"><a name="l20400"></a><span class="lineno">20400</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;pt&#39;</span>: {</div>
<div class="line"><a name="l20401"></a><span class="lineno">20401</span>&#160;                $retval = ($value / $k);</div>
<div class="line"><a name="l20402"></a><span class="lineno">20402</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l20403"></a><span class="lineno">20403</span>&#160;            }</div>
<div class="line"><a name="l20404"></a><span class="lineno">20404</span>&#160;            <span class="comment">// pixels</span></div>
<div class="line"><a name="l20405"></a><span class="lineno">20405</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;px&#39;</span>: {</div>
<div class="line"><a name="l20406"></a><span class="lineno">20406</span>&#160;                $retval = $this-&gt;pixelsToUnits($value);</div>
<div class="line"><a name="l20407"></a><span class="lineno">20407</span>&#160;                <span class="keywordflow">if</span> ($points) {</div>
<div class="line"><a name="l20408"></a><span class="lineno">20408</span>&#160;                    $retval *= $this-&gt;k;</div>
<div class="line"><a name="l20409"></a><span class="lineno">20409</span>&#160;                }</div>
<div class="line"><a name="l20410"></a><span class="lineno">20410</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l20411"></a><span class="lineno">20411</span>&#160;            }</div>
<div class="line"><a name="l20412"></a><span class="lineno">20412</span>&#160;        }</div>
<div class="line"><a name="l20413"></a><span class="lineno">20413</span>&#160;        <span class="keywordflow">return</span> $retval;</div>
<div class="line"><a name="l20414"></a><span class="lineno">20414</span>&#160;    }</div>
<div class="line"><a name="l20415"></a><span class="lineno">20415</span>&#160;</div>
<div class="line"><a name="l20424"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a2e2600620c41132dda5479a902374b5c">20424</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a2e2600620c41132dda5479a902374b5c">putHtmlListBullet</a>($listdepth, $listtype=<span class="stringliteral">&#39;&#39;</span>, $size=10) {</div>
<div class="line"><a name="l20425"></a><span class="lineno">20425</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;state != 2) {</div>
<div class="line"><a name="l20426"></a><span class="lineno">20426</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l20427"></a><span class="lineno">20427</span>&#160;        }</div>
<div class="line"><a name="l20428"></a><span class="lineno">20428</span>&#160;        $size /= $this-&gt;k;</div>
<div class="line"><a name="l20429"></a><span class="lineno">20429</span>&#160;        $fill = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l20430"></a><span class="lineno">20430</span>&#160;        $bgcolor = $this-&gt;bgcolor;</div>
<div class="line"><a name="l20431"></a><span class="lineno">20431</span>&#160;        $color = $this-&gt;fgcolor;</div>
<div class="line"><a name="l20432"></a><span class="lineno">20432</span>&#160;        $strokecolor = $this-&gt;strokecolor;</div>
<div class="line"><a name="l20433"></a><span class="lineno">20433</span>&#160;        $width = 0;</div>
<div class="line"><a name="l20434"></a><span class="lineno">20434</span>&#160;        $textitem = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l20435"></a><span class="lineno">20435</span>&#160;        $tmpx = $this-&gt;x;</div>
<div class="line"><a name="l20436"></a><span class="lineno">20436</span>&#160;        $lspace = $this-&gt;GetStringWidth(<span class="stringliteral">&#39;  &#39;</span>);</div>
<div class="line"><a name="l20437"></a><span class="lineno">20437</span>&#160;        <span class="keywordflow">if</span> ($listtype == <span class="charliteral">&#39;^&#39;</span>) {</div>
<div class="line"><a name="l20438"></a><span class="lineno">20438</span>&#160;            <span class="comment">// special symbol used for avoid justification of rect bullet</span></div>
<div class="line"><a name="l20439"></a><span class="lineno">20439</span>&#160;            $this-&gt;lispacer = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l20440"></a><span class="lineno">20440</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l20441"></a><span class="lineno">20441</span>&#160;        } elseif ($listtype == <span class="charliteral">&#39;!&#39;</span>) {</div>
<div class="line"><a name="l20442"></a><span class="lineno">20442</span>&#160;            <span class="comment">// set default list type for unordered list</span></div>
<div class="line"><a name="l20443"></a><span class="lineno">20443</span>&#160;            $deftypes = array(<span class="stringliteral">&#39;disc&#39;</span>, <span class="stringliteral">&#39;circle&#39;</span>, <span class="stringliteral">&#39;square&#39;</span>);</div>
<div class="line"><a name="l20444"></a><span class="lineno">20444</span>&#160;            $listtype = $deftypes[($listdepth - 1) % 3];</div>
<div class="line"><a name="l20445"></a><span class="lineno">20445</span>&#160;        } elseif ($listtype == <span class="charliteral">&#39;#&#39;</span>) {</div>
<div class="line"><a name="l20446"></a><span class="lineno">20446</span>&#160;            <span class="comment">// set default list type for ordered list</span></div>
<div class="line"><a name="l20447"></a><span class="lineno">20447</span>&#160;            $listtype = <span class="stringliteral">&#39;decimal&#39;</span>;</div>
<div class="line"><a name="l20448"></a><span class="lineno">20448</span>&#160;        } elseif (substr($listtype, 0, 4) == <span class="stringliteral">&#39;img|&#39;</span>) {</div>
<div class="line"><a name="l20449"></a><span class="lineno">20449</span>&#160;            <span class="comment">// custom image type (&#39;img|type|width|height|image.ext&#39;)</span></div>
<div class="line"><a name="l20450"></a><span class="lineno">20450</span>&#160;            $img = explode(<span class="charliteral">&#39;|&#39;</span>, $listtype);</div>
<div class="line"><a name="l20451"></a><span class="lineno">20451</span>&#160;            $listtype = <span class="stringliteral">&#39;img&#39;</span>;</div>
<div class="line"><a name="l20452"></a><span class="lineno">20452</span>&#160;        }</div>
<div class="line"><a name="l20453"></a><span class="lineno">20453</span>&#160;        <span class="keywordflow">switch</span> ($listtype) {</div>
<div class="line"><a name="l20454"></a><span class="lineno">20454</span>&#160;            <span class="comment">// unordered types</span></div>
<div class="line"><a name="l20455"></a><span class="lineno">20455</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;none&#39;</span>: {</div>
<div class="line"><a name="l20456"></a><span class="lineno">20456</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l20457"></a><span class="lineno">20457</span>&#160;            }</div>
<div class="line"><a name="l20458"></a><span class="lineno">20458</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;disc&#39;</span>: {</div>
<div class="line"><a name="l20459"></a><span class="lineno">20459</span>&#160;                $r = $size / 6;</div>
<div class="line"><a name="l20460"></a><span class="lineno">20460</span>&#160;                $lspace += (2 * $r);</div>
<div class="line"><a name="l20461"></a><span class="lineno">20461</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l20462"></a><span class="lineno">20462</span>&#160;                    $this-&gt;x += $lspace;</div>
<div class="line"><a name="l20463"></a><span class="lineno">20463</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l20464"></a><span class="lineno">20464</span>&#160;                    $this-&gt;x -= $lspace;</div>
<div class="line"><a name="l20465"></a><span class="lineno">20465</span>&#160;                }</div>
<div class="line"><a name="l20466"></a><span class="lineno">20466</span>&#160;                $this-&gt;Circle(($this-&gt;x + $r), ($this-&gt;y + ($this-&gt;lasth / 2)), $r, 0, 360, <span class="charliteral">&#39;F&#39;</span>, array(), $color, 8);</div>
<div class="line"><a name="l20467"></a><span class="lineno">20467</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l20468"></a><span class="lineno">20468</span>&#160;            }</div>
<div class="line"><a name="l20469"></a><span class="lineno">20469</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;circle&#39;</span>: {</div>
<div class="line"><a name="l20470"></a><span class="lineno">20470</span>&#160;                $r = $size / 6;</div>
<div class="line"><a name="l20471"></a><span class="lineno">20471</span>&#160;                $lspace += (2 * $r);</div>
<div class="line"><a name="l20472"></a><span class="lineno">20472</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l20473"></a><span class="lineno">20473</span>&#160;                    $this-&gt;x += $lspace;</div>
<div class="line"><a name="l20474"></a><span class="lineno">20474</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l20475"></a><span class="lineno">20475</span>&#160;                    $this-&gt;x -= $lspace;</div>
<div class="line"><a name="l20476"></a><span class="lineno">20476</span>&#160;                }</div>
<div class="line"><a name="l20477"></a><span class="lineno">20477</span>&#160;                $prev_line_style = $this-&gt;linestyleWidth.<span class="charliteral">&#39; &#39;</span>.$this-&gt;linestyleCap.<span class="charliteral">&#39; &#39;</span>.$this-&gt;linestyleJoin.<span class="charliteral">&#39; &#39;</span>.$this-&gt;linestyleDash.<span class="charliteral">&#39; &#39;</span>.$this-&gt;DrawColor;</div>
<div class="line"><a name="l20478"></a><span class="lineno">20478</span>&#160;                $new_line_style = array(<span class="stringliteral">&#39;width&#39;</span> =&gt; ($r / 3), <span class="stringliteral">&#39;cap&#39;</span> =&gt; <span class="stringliteral">&#39;butt&#39;</span>, <span class="stringliteral">&#39;join&#39;</span> =&gt; <span class="stringliteral">&#39;miter&#39;</span>, <span class="stringliteral">&#39;dash&#39;</span> =&gt; 0, <span class="stringliteral">&#39;phase&#39;</span> =&gt; 0, <span class="stringliteral">&#39;color&#39;</span>=&gt;$color);</div>
<div class="line"><a name="l20479"></a><span class="lineno">20479</span>&#160;                $this-&gt;Circle(($this-&gt;x + $r), ($this-&gt;y + ($this-&gt;lasth / 2)), ($r * (1 - (1/6))), 0, 360, <span class="charliteral">&#39;D&#39;</span>, $new_line_style, array(), 8);</div>
<div class="line"><a name="l20480"></a><span class="lineno">20480</span>&#160;                $this-&gt;_out($prev_line_style); <span class="comment">// restore line settings</span></div>
<div class="line"><a name="l20481"></a><span class="lineno">20481</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l20482"></a><span class="lineno">20482</span>&#160;            }</div>
<div class="line"><a name="l20483"></a><span class="lineno">20483</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;square&#39;</span>: {</div>
<div class="line"><a name="l20484"></a><span class="lineno">20484</span>&#160;                $l = $size / 3;</div>
<div class="line"><a name="l20485"></a><span class="lineno">20485</span>&#160;                $lspace += $l;</div>
<div class="line"><a name="l20486"></a><span class="lineno">20486</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;rtl) {;</div>
<div class="line"><a name="l20487"></a><span class="lineno">20487</span>&#160;                    $this-&gt;x += $lspace;</div>
<div class="line"><a name="l20488"></a><span class="lineno">20488</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l20489"></a><span class="lineno">20489</span>&#160;                    $this-&gt;x -= $lspace;</div>
<div class="line"><a name="l20490"></a><span class="lineno">20490</span>&#160;                }</div>
<div class="line"><a name="l20491"></a><span class="lineno">20491</span>&#160;                $this-&gt;Rect($this-&gt;x, ($this-&gt;y + (($this-&gt;lasth - $l) / 2)), $l, $l, <span class="charliteral">&#39;F&#39;</span>, array(), $color);</div>
<div class="line"><a name="l20492"></a><span class="lineno">20492</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l20493"></a><span class="lineno">20493</span>&#160;            }</div>
<div class="line"><a name="l20494"></a><span class="lineno">20494</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;img&#39;</span>: {</div>
<div class="line"><a name="l20495"></a><span class="lineno">20495</span>&#160;                <span class="comment">// 1=&gt;type, 2=&gt;width, 3=&gt;height, 4=&gt;image.ext</span></div>
<div class="line"><a name="l20496"></a><span class="lineno">20496</span>&#160;                $lspace += $img[2];</div>
<div class="line"><a name="l20497"></a><span class="lineno">20497</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;rtl) {;</div>
<div class="line"><a name="l20498"></a><span class="lineno">20498</span>&#160;                    $this-&gt;x += $lspace;</div>
<div class="line"><a name="l20499"></a><span class="lineno">20499</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l20500"></a><span class="lineno">20500</span>&#160;                    $this-&gt;x -= $lspace;</div>
<div class="line"><a name="l20501"></a><span class="lineno">20501</span>&#160;                }</div>
<div class="line"><a name="l20502"></a><span class="lineno">20502</span>&#160;                $imgtype = strtolower($img[1]);</div>
<div class="line"><a name="l20503"></a><span class="lineno">20503</span>&#160;                $prev_y = $this-&gt;y;</div>
<div class="line"><a name="l20504"></a><span class="lineno">20504</span>&#160;                <span class="keywordflow">switch</span> ($imgtype) {</div>
<div class="line"><a name="l20505"></a><span class="lineno">20505</span>&#160;                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;svg&#39;</span>: {</div>
<div class="line"><a name="l20506"></a><span class="lineno">20506</span>&#160;                        $this-&gt;ImageSVG($img[4], $this-&gt;x, ($this-&gt;y + (($this-&gt;lasth - $img[3]) / 2)), $img[2], $img[3], <span class="stringliteral">&#39;&#39;</span>, <span class="charliteral">&#39;T&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="keyword">false</span>);</div>
<div class="line"><a name="l20507"></a><span class="lineno">20507</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l20508"></a><span class="lineno">20508</span>&#160;                    }</div>
<div class="line"><a name="l20509"></a><span class="lineno">20509</span>&#160;                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;ai&#39;</span>:</div>
<div class="line"><a name="l20510"></a><span class="lineno">20510</span>&#160;                    <span class="keywordflow">case</span> <span class="stringliteral">&#39;eps&#39;</span>: {</div>
<div class="line"><a name="l20511"></a><span class="lineno">20511</span>&#160;                        $this-&gt;ImageEps($img[4], $this-&gt;x, ($this-&gt;y + (($this-&gt;lasth - $img[3]) / 2)), $img[2], $img[3], <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">true</span>, <span class="charliteral">&#39;T&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="keyword">false</span>);</div>
<div class="line"><a name="l20512"></a><span class="lineno">20512</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l20513"></a><span class="lineno">20513</span>&#160;                    }</div>
<div class="line"><a name="l20514"></a><span class="lineno">20514</span>&#160;                    <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l20515"></a><span class="lineno">20515</span>&#160;                        $this-&gt;Image($img[4], $this-&gt;x, ($this-&gt;y + (($this-&gt;lasth - $img[3]) / 2)), $img[2], $img[3], $img[1], <span class="stringliteral">&#39;&#39;</span>, <span class="charliteral">&#39;T&#39;</span>, <span class="keyword">false</span>, 300, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, 0, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l20516"></a><span class="lineno">20516</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l20517"></a><span class="lineno">20517</span>&#160;                    }</div>
<div class="line"><a name="l20518"></a><span class="lineno">20518</span>&#160;                }</div>
<div class="line"><a name="l20519"></a><span class="lineno">20519</span>&#160;                $this-&gt;y = $prev_y;</div>
<div class="line"><a name="l20520"></a><span class="lineno">20520</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l20521"></a><span class="lineno">20521</span>&#160;            }</div>
<div class="line"><a name="l20522"></a><span class="lineno">20522</span>&#160;            <span class="comment">// ordered types</span></div>
<div class="line"><a name="l20523"></a><span class="lineno">20523</span>&#160;            <span class="comment">// $this-&gt;listcount[$this-&gt;listnum];</span></div>
<div class="line"><a name="l20524"></a><span class="lineno">20524</span>&#160;            <span class="comment">// $textitem</span></div>
<div class="line"><a name="l20525"></a><span class="lineno">20525</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;1&#39;</span>:</div>
<div class="line"><a name="l20526"></a><span class="lineno">20526</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;decimal&#39;</span>: {</div>
<div class="line"><a name="l20527"></a><span class="lineno">20527</span>&#160;                $textitem = $this-&gt;listcount[$this-&gt;listnum];</div>
<div class="line"><a name="l20528"></a><span class="lineno">20528</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l20529"></a><span class="lineno">20529</span>&#160;            }</div>
<div class="line"><a name="l20530"></a><span class="lineno">20530</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;decimal-leading-zero&#39;</span>: {</div>
<div class="line"><a name="l20531"></a><span class="lineno">20531</span>&#160;                $textitem = sprintf(<span class="stringliteral">&#39;%02d&#39;</span>, $this-&gt;listcount[$this-&gt;listnum]);</div>
<div class="line"><a name="l20532"></a><span class="lineno">20532</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l20533"></a><span class="lineno">20533</span>&#160;            }</div>
<div class="line"><a name="l20534"></a><span class="lineno">20534</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;i&#39;</span>:</div>
<div class="line"><a name="l20535"></a><span class="lineno">20535</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;lower-roman&#39;</span>: {</div>
<div class="line"><a name="l20536"></a><span class="lineno">20536</span>&#160;                $textitem = strtolower(TCPDF_STATIC::intToRoman($this-&gt;listcount[$this-&gt;listnum]));</div>
<div class="line"><a name="l20537"></a><span class="lineno">20537</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l20538"></a><span class="lineno">20538</span>&#160;            }</div>
<div class="line"><a name="l20539"></a><span class="lineno">20539</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;I&#39;</span>:</div>
<div class="line"><a name="l20540"></a><span class="lineno">20540</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;upper-roman&#39;</span>: {</div>
<div class="line"><a name="l20541"></a><span class="lineno">20541</span>&#160;                $textitem = TCPDF_STATIC::intToRoman($this-&gt;listcount[$this-&gt;listnum]);</div>
<div class="line"><a name="l20542"></a><span class="lineno">20542</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l20543"></a><span class="lineno">20543</span>&#160;            }</div>
<div class="line"><a name="l20544"></a><span class="lineno">20544</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;a&#39;</span>:</div>
<div class="line"><a name="l20545"></a><span class="lineno">20545</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;lower-alpha&#39;</span>:</div>
<div class="line"><a name="l20546"></a><span class="lineno">20546</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;lower-latin&#39;</span>: {</div>
<div class="line"><a name="l20547"></a><span class="lineno">20547</span>&#160;                $textitem = chr(97 + $this-&gt;listcount[$this-&gt;listnum] - 1);</div>
<div class="line"><a name="l20548"></a><span class="lineno">20548</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l20549"></a><span class="lineno">20549</span>&#160;            }</div>
<div class="line"><a name="l20550"></a><span class="lineno">20550</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;A&#39;</span>:</div>
<div class="line"><a name="l20551"></a><span class="lineno">20551</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;upper-alpha&#39;</span>:</div>
<div class="line"><a name="l20552"></a><span class="lineno">20552</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;upper-latin&#39;</span>: {</div>
<div class="line"><a name="l20553"></a><span class="lineno">20553</span>&#160;                $textitem = chr(65 + $this-&gt;listcount[$this-&gt;listnum] - 1);</div>
<div class="line"><a name="l20554"></a><span class="lineno">20554</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l20555"></a><span class="lineno">20555</span>&#160;            }</div>
<div class="line"><a name="l20556"></a><span class="lineno">20556</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;lower-greek&#39;</span>: {</div>
<div class="line"><a name="l20557"></a><span class="lineno">20557</span>&#160;                $textitem = TCPDF_FONTS::unichr((945 + $this-&gt;listcount[$this-&gt;listnum] - 1), $this-&gt;isunicode);</div>
<div class="line"><a name="l20558"></a><span class="lineno">20558</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l20559"></a><span class="lineno">20559</span>&#160;            }</div>
<div class="line"><a name="l20560"></a><span class="lineno">20560</span>&#160;            <span class="comment">/*</span></div>
<div class="line"><a name="l20561"></a><span class="lineno">20561</span>&#160;<span class="comment">            // Types to be implemented (special handling)</span></div>
<div class="line"><a name="l20562"></a><span class="lineno">20562</span>&#160;<span class="comment">            case &#39;hebrew&#39;: {</span></div>
<div class="line"><a name="l20563"></a><span class="lineno">20563</span>&#160;<span class="comment">                break;</span></div>
<div class="line"><a name="l20564"></a><span class="lineno">20564</span>&#160;<span class="comment">            }</span></div>
<div class="line"><a name="l20565"></a><span class="lineno">20565</span>&#160;<span class="comment">            case &#39;armenian&#39;: {</span></div>
<div class="line"><a name="l20566"></a><span class="lineno">20566</span>&#160;<span class="comment">                break;</span></div>
<div class="line"><a name="l20567"></a><span class="lineno">20567</span>&#160;<span class="comment">            }</span></div>
<div class="line"><a name="l20568"></a><span class="lineno">20568</span>&#160;<span class="comment">            case &#39;georgian&#39;: {</span></div>
<div class="line"><a name="l20569"></a><span class="lineno">20569</span>&#160;<span class="comment">                break;</span></div>
<div class="line"><a name="l20570"></a><span class="lineno">20570</span>&#160;<span class="comment">            }</span></div>
<div class="line"><a name="l20571"></a><span class="lineno">20571</span>&#160;<span class="comment">            case &#39;cjk-ideographic&#39;: {</span></div>
<div class="line"><a name="l20572"></a><span class="lineno">20572</span>&#160;<span class="comment">                break;</span></div>
<div class="line"><a name="l20573"></a><span class="lineno">20573</span>&#160;<span class="comment">            }</span></div>
<div class="line"><a name="l20574"></a><span class="lineno">20574</span>&#160;<span class="comment">            case &#39;hiragana&#39;: {</span></div>
<div class="line"><a name="l20575"></a><span class="lineno">20575</span>&#160;<span class="comment">                break;</span></div>
<div class="line"><a name="l20576"></a><span class="lineno">20576</span>&#160;<span class="comment">            }</span></div>
<div class="line"><a name="l20577"></a><span class="lineno">20577</span>&#160;<span class="comment">            case &#39;katakana&#39;: {</span></div>
<div class="line"><a name="l20578"></a><span class="lineno">20578</span>&#160;<span class="comment">                break;</span></div>
<div class="line"><a name="l20579"></a><span class="lineno">20579</span>&#160;<span class="comment">            }</span></div>
<div class="line"><a name="l20580"></a><span class="lineno">20580</span>&#160;<span class="comment">            case &#39;hiragana-iroha&#39;: {</span></div>
<div class="line"><a name="l20581"></a><span class="lineno">20581</span>&#160;<span class="comment">                break;</span></div>
<div class="line"><a name="l20582"></a><span class="lineno">20582</span>&#160;<span class="comment">            }</span></div>
<div class="line"><a name="l20583"></a><span class="lineno">20583</span>&#160;<span class="comment">            case &#39;katakana-iroha&#39;: {</span></div>
<div class="line"><a name="l20584"></a><span class="lineno">20584</span>&#160;<span class="comment">                break;</span></div>
<div class="line"><a name="l20585"></a><span class="lineno">20585</span>&#160;<span class="comment">            }</span></div>
<div class="line"><a name="l20586"></a><span class="lineno">20586</span>&#160;<span class="comment">            */</span></div>
<div class="line"><a name="l20587"></a><span class="lineno">20587</span>&#160;            <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l20588"></a><span class="lineno">20588</span>&#160;                $textitem = $this-&gt;listcount[$this-&gt;listnum];</div>
<div class="line"><a name="l20589"></a><span class="lineno">20589</span>&#160;            }</div>
<div class="line"><a name="l20590"></a><span class="lineno">20590</span>&#160;        }</div>
<div class="line"><a name="l20591"></a><span class="lineno">20591</span>&#160;        <span class="keywordflow">if</span> (!TCPDF_STATIC::empty_string($textitem)) {</div>
<div class="line"><a name="l20592"></a><span class="lineno">20592</span>&#160;            <span class="comment">// Check whether we need a new page or new column</span></div>
<div class="line"><a name="l20593"></a><span class="lineno">20593</span>&#160;            $prev_y = $this-&gt;y;</div>
<div class="line"><a name="l20594"></a><span class="lineno">20594</span>&#160;            $h = $this-&gt;getCellHeight($this-&gt;FontSize);</div>
<div class="line"><a name="l20595"></a><span class="lineno">20595</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;checkPageBreak($h) OR ($this-&gt;y &lt; $prev_y)) {</div>
<div class="line"><a name="l20596"></a><span class="lineno">20596</span>&#160;                $tmpx = $this-&gt;x;</div>
<div class="line"><a name="l20597"></a><span class="lineno">20597</span>&#160;            }</div>
<div class="line"><a name="l20598"></a><span class="lineno">20598</span>&#160;            <span class="comment">// print ordered item</span></div>
<div class="line"><a name="l20599"></a><span class="lineno">20599</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l20600"></a><span class="lineno">20600</span>&#160;                $textitem = <span class="charliteral">&#39;.&#39;</span>.$textitem;</div>
<div class="line"><a name="l20601"></a><span class="lineno">20601</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l20602"></a><span class="lineno">20602</span>&#160;                $textitem = $textitem.<span class="charliteral">&#39;.&#39;</span>;</div>
<div class="line"><a name="l20603"></a><span class="lineno">20603</span>&#160;            }</div>
<div class="line"><a name="l20604"></a><span class="lineno">20604</span>&#160;            $lspace += $this-&gt;GetStringWidth($textitem);</div>
<div class="line"><a name="l20605"></a><span class="lineno">20605</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l20606"></a><span class="lineno">20606</span>&#160;                $this-&gt;x += $lspace;</div>
<div class="line"><a name="l20607"></a><span class="lineno">20607</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l20608"></a><span class="lineno">20608</span>&#160;                $this-&gt;x -= $lspace;</div>
<div class="line"><a name="l20609"></a><span class="lineno">20609</span>&#160;            }</div>
<div class="line"><a name="l20610"></a><span class="lineno">20610</span>&#160;            $this-&gt;Write($this-&gt;lasth, $textitem, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>, 0, <span class="keyword">false</span>);</div>
<div class="line"><a name="l20611"></a><span class="lineno">20611</span>&#160;        }</div>
<div class="line"><a name="l20612"></a><span class="lineno">20612</span>&#160;        $this-&gt;x = $tmpx;</div>
<div class="line"><a name="l20613"></a><span class="lineno">20613</span>&#160;        $this-&gt;lispacer = <span class="charliteral">&#39;^&#39;</span>;</div>
<div class="line"><a name="l20614"></a><span class="lineno">20614</span>&#160;        <span class="comment">// restore colors</span></div>
<div class="line"><a name="l20615"></a><span class="lineno">20615</span>&#160;        $this-&gt;SetFillColorArray($bgcolor);</div>
<div class="line"><a name="l20616"></a><span class="lineno">20616</span>&#160;        $this-&gt;SetDrawColorArray($strokecolor);</div>
<div class="line"><a name="l20617"></a><span class="lineno">20617</span>&#160;        $this-&gt;SettextColorArray($color);</div>
<div class="line"><a name="l20618"></a><span class="lineno">20618</span>&#160;    }</div>
<div class="line"><a name="l20619"></a><span class="lineno">20619</span>&#160;</div>
<div class="line"><a name="l20626"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a24d3c102468b6ab9d2f4859a8b01863a">20626</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a24d3c102468b6ab9d2f4859a8b01863a">getGraphicVars</a>() {</div>
<div class="line"><a name="l20627"></a><span class="lineno">20627</span>&#160;        $grapvars = array(</div>
<div class="line"><a name="l20628"></a><span class="lineno">20628</span>&#160;            <span class="stringliteral">&#39;FontFamily&#39;</span> =&gt; $this-&gt;FontFamily,</div>
<div class="line"><a name="l20629"></a><span class="lineno">20629</span>&#160;            <span class="stringliteral">&#39;FontStyle&#39;</span> =&gt; $this-&gt;FontStyle,</div>
<div class="line"><a name="l20630"></a><span class="lineno">20630</span>&#160;            <span class="stringliteral">&#39;FontSizePt&#39;</span> =&gt; $this-&gt;FontSizePt,</div>
<div class="line"><a name="l20631"></a><span class="lineno">20631</span>&#160;            <span class="stringliteral">&#39;rMargin&#39;</span> =&gt; $this-&gt;rMargin,</div>
<div class="line"><a name="l20632"></a><span class="lineno">20632</span>&#160;            <span class="stringliteral">&#39;lMargin&#39;</span> =&gt; $this-&gt;lMargin,</div>
<div class="line"><a name="l20633"></a><span class="lineno">20633</span>&#160;            <span class="stringliteral">&#39;cell_padding&#39;</span> =&gt; $this-&gt;cell_padding,</div>
<div class="line"><a name="l20634"></a><span class="lineno">20634</span>&#160;            <span class="stringliteral">&#39;cell_margin&#39;</span> =&gt; $this-&gt;cell_margin,</div>
<div class="line"><a name="l20635"></a><span class="lineno">20635</span>&#160;            <span class="stringliteral">&#39;LineWidth&#39;</span> =&gt; $this-&gt;LineWidth,</div>
<div class="line"><a name="l20636"></a><span class="lineno">20636</span>&#160;            <span class="stringliteral">&#39;linestyleWidth&#39;</span> =&gt; $this-&gt;linestyleWidth,</div>
<div class="line"><a name="l20637"></a><span class="lineno">20637</span>&#160;            <span class="stringliteral">&#39;linestyleCap&#39;</span> =&gt; $this-&gt;linestyleCap,</div>
<div class="line"><a name="l20638"></a><span class="lineno">20638</span>&#160;            <span class="stringliteral">&#39;linestyleJoin&#39;</span> =&gt; $this-&gt;linestyleJoin,</div>
<div class="line"><a name="l20639"></a><span class="lineno">20639</span>&#160;            <span class="stringliteral">&#39;linestyleDash&#39;</span> =&gt; $this-&gt;linestyleDash,</div>
<div class="line"><a name="l20640"></a><span class="lineno">20640</span>&#160;            <span class="stringliteral">&#39;textrendermode&#39;</span> =&gt; $this-&gt;textrendermode,</div>
<div class="line"><a name="l20641"></a><span class="lineno">20641</span>&#160;            <span class="stringliteral">&#39;textstrokewidth&#39;</span> =&gt; $this-&gt;textstrokewidth,</div>
<div class="line"><a name="l20642"></a><span class="lineno">20642</span>&#160;            <span class="stringliteral">&#39;DrawColor&#39;</span> =&gt; $this-&gt;DrawColor,</div>
<div class="line"><a name="l20643"></a><span class="lineno">20643</span>&#160;            <span class="stringliteral">&#39;FillColor&#39;</span> =&gt; $this-&gt;FillColor,</div>
<div class="line"><a name="l20644"></a><span class="lineno">20644</span>&#160;            <span class="stringliteral">&#39;TextColor&#39;</span> =&gt; $this-&gt;TextColor,</div>
<div class="line"><a name="l20645"></a><span class="lineno">20645</span>&#160;            <span class="stringliteral">&#39;ColorFlag&#39;</span> =&gt; $this-&gt;ColorFlag,</div>
<div class="line"><a name="l20646"></a><span class="lineno">20646</span>&#160;            <span class="stringliteral">&#39;bgcolor&#39;</span> =&gt; $this-&gt;bgcolor,</div>
<div class="line"><a name="l20647"></a><span class="lineno">20647</span>&#160;            <span class="stringliteral">&#39;fgcolor&#39;</span> =&gt; $this-&gt;fgcolor,</div>
<div class="line"><a name="l20648"></a><span class="lineno">20648</span>&#160;            <span class="stringliteral">&#39;htmlvspace&#39;</span> =&gt; $this-&gt;htmlvspace,</div>
<div class="line"><a name="l20649"></a><span class="lineno">20649</span>&#160;            <span class="stringliteral">&#39;listindent&#39;</span> =&gt; $this-&gt;listindent,</div>
<div class="line"><a name="l20650"></a><span class="lineno">20650</span>&#160;            <span class="stringliteral">&#39;listindentlevel&#39;</span> =&gt; $this-&gt;listindentlevel,</div>
<div class="line"><a name="l20651"></a><span class="lineno">20651</span>&#160;            <span class="stringliteral">&#39;listnum&#39;</span> =&gt; $this-&gt;listnum,</div>
<div class="line"><a name="l20652"></a><span class="lineno">20652</span>&#160;            <span class="stringliteral">&#39;listordered&#39;</span> =&gt; $this-&gt;listordered,</div>
<div class="line"><a name="l20653"></a><span class="lineno">20653</span>&#160;            <span class="stringliteral">&#39;listcount&#39;</span> =&gt; $this-&gt;listcount,</div>
<div class="line"><a name="l20654"></a><span class="lineno">20654</span>&#160;            <span class="stringliteral">&#39;lispacer&#39;</span> =&gt; $this-&gt;lispacer,</div>
<div class="line"><a name="l20655"></a><span class="lineno">20655</span>&#160;            <span class="stringliteral">&#39;cell_height_ratio&#39;</span> =&gt; $this-&gt;cell_height_ratio,</div>
<div class="line"><a name="l20656"></a><span class="lineno">20656</span>&#160;            <span class="stringliteral">&#39;font_stretching&#39;</span> =&gt; $this-&gt;font_stretching,</div>
<div class="line"><a name="l20657"></a><span class="lineno">20657</span>&#160;            <span class="stringliteral">&#39;font_spacing&#39;</span> =&gt; $this-&gt;font_spacing,</div>
<div class="line"><a name="l20658"></a><span class="lineno">20658</span>&#160;            <span class="stringliteral">&#39;alpha&#39;</span> =&gt; $this-&gt;alpha,</div>
<div class="line"><a name="l20659"></a><span class="lineno">20659</span>&#160;            <span class="comment">// extended</span></div>
<div class="line"><a name="l20660"></a><span class="lineno">20660</span>&#160;            <span class="stringliteral">&#39;lasth&#39;</span> =&gt; $this-&gt;lasth,</div>
<div class="line"><a name="l20661"></a><span class="lineno">20661</span>&#160;            <span class="stringliteral">&#39;tMargin&#39;</span> =&gt; $this-&gt;tMargin,</div>
<div class="line"><a name="l20662"></a><span class="lineno">20662</span>&#160;            <span class="stringliteral">&#39;bMargin&#39;</span> =&gt; $this-&gt;bMargin,</div>
<div class="line"><a name="l20663"></a><span class="lineno">20663</span>&#160;            <span class="stringliteral">&#39;AutoPageBreak&#39;</span> =&gt; $this-&gt;AutoPageBreak,</div>
<div class="line"><a name="l20664"></a><span class="lineno">20664</span>&#160;            <span class="stringliteral">&#39;PageBreakTrigger&#39;</span> =&gt; $this-&gt;PageBreakTrigger,</div>
<div class="line"><a name="l20665"></a><span class="lineno">20665</span>&#160;            <span class="charliteral">&#39;x&#39;</span> =&gt; $this-&gt;x,</div>
<div class="line"><a name="l20666"></a><span class="lineno">20666</span>&#160;            <span class="charliteral">&#39;y&#39;</span> =&gt; $this-&gt;y,</div>
<div class="line"><a name="l20667"></a><span class="lineno">20667</span>&#160;            <span class="charliteral">&#39;w&#39;</span> =&gt; $this-&gt;w,</div>
<div class="line"><a name="l20668"></a><span class="lineno">20668</span>&#160;            <span class="charliteral">&#39;h&#39;</span> =&gt; $this-&gt;h,</div>
<div class="line"><a name="l20669"></a><span class="lineno">20669</span>&#160;            <span class="stringliteral">&#39;wPt&#39;</span> =&gt; $this-&gt;wPt,</div>
<div class="line"><a name="l20670"></a><span class="lineno">20670</span>&#160;            <span class="stringliteral">&#39;hPt&#39;</span> =&gt; $this-&gt;hPt,</div>
<div class="line"><a name="l20671"></a><span class="lineno">20671</span>&#160;            <span class="stringliteral">&#39;fwPt&#39;</span> =&gt; $this-&gt;fwPt,</div>
<div class="line"><a name="l20672"></a><span class="lineno">20672</span>&#160;            <span class="stringliteral">&#39;fhPt&#39;</span> =&gt; $this-&gt;fhPt,</div>
<div class="line"><a name="l20673"></a><span class="lineno">20673</span>&#160;            <span class="stringliteral">&#39;page&#39;</span> =&gt; $this-&gt;page,</div>
<div class="line"><a name="l20674"></a><span class="lineno">20674</span>&#160;            <span class="stringliteral">&#39;current_column&#39;</span> =&gt; $this-&gt;current_column,</div>
<div class="line"><a name="l20675"></a><span class="lineno">20675</span>&#160;            <span class="stringliteral">&#39;num_columns&#39;</span> =&gt; $this-&gt;num_columns</div>
<div class="line"><a name="l20676"></a><span class="lineno">20676</span>&#160;            );</div>
<div class="line"><a name="l20677"></a><span class="lineno">20677</span>&#160;        <span class="keywordflow">return</span> $grapvars;</div>
<div class="line"><a name="l20678"></a><span class="lineno">20678</span>&#160;    }</div>
<div class="line"><a name="l20679"></a><span class="lineno">20679</span>&#160;</div>
<div class="line"><a name="l20687"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a072053646725b19770a795050b3b6221">20687</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a072053646725b19770a795050b3b6221">setGraphicVars</a>($gvars, $extended=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l20688"></a><span class="lineno">20688</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;state != 2) {</div>
<div class="line"><a name="l20689"></a><span class="lineno">20689</span>&#160;             <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l20690"></a><span class="lineno">20690</span>&#160;        }</div>
<div class="line"><a name="l20691"></a><span class="lineno">20691</span>&#160;        $this-&gt;FontFamily = $gvars[<span class="stringliteral">&#39;FontFamily&#39;</span>];</div>
<div class="line"><a name="l20692"></a><span class="lineno">20692</span>&#160;        $this-&gt;FontStyle = $gvars[<span class="stringliteral">&#39;FontStyle&#39;</span>];</div>
<div class="line"><a name="l20693"></a><span class="lineno">20693</span>&#160;        $this-&gt;FontSizePt = $gvars[<span class="stringliteral">&#39;FontSizePt&#39;</span>];</div>
<div class="line"><a name="l20694"></a><span class="lineno">20694</span>&#160;        $this-&gt;rMargin = $gvars[<span class="stringliteral">&#39;rMargin&#39;</span>];</div>
<div class="line"><a name="l20695"></a><span class="lineno">20695</span>&#160;        $this-&gt;lMargin = $gvars[<span class="stringliteral">&#39;lMargin&#39;</span>];</div>
<div class="line"><a name="l20696"></a><span class="lineno">20696</span>&#160;        $this-&gt;cell_padding = $gvars[<span class="stringliteral">&#39;cell_padding&#39;</span>];</div>
<div class="line"><a name="l20697"></a><span class="lineno">20697</span>&#160;        $this-&gt;cell_margin = $gvars[<span class="stringliteral">&#39;cell_margin&#39;</span>];</div>
<div class="line"><a name="l20698"></a><span class="lineno">20698</span>&#160;        $this-&gt;LineWidth = $gvars[<span class="stringliteral">&#39;LineWidth&#39;</span>];</div>
<div class="line"><a name="l20699"></a><span class="lineno">20699</span>&#160;        $this-&gt;linestyleWidth = $gvars[<span class="stringliteral">&#39;linestyleWidth&#39;</span>];</div>
<div class="line"><a name="l20700"></a><span class="lineno">20700</span>&#160;        $this-&gt;linestyleCap = $gvars[<span class="stringliteral">&#39;linestyleCap&#39;</span>];</div>
<div class="line"><a name="l20701"></a><span class="lineno">20701</span>&#160;        $this-&gt;linestyleJoin = $gvars[<span class="stringliteral">&#39;linestyleJoin&#39;</span>];</div>
<div class="line"><a name="l20702"></a><span class="lineno">20702</span>&#160;        $this-&gt;linestyleDash = $gvars[<span class="stringliteral">&#39;linestyleDash&#39;</span>];</div>
<div class="line"><a name="l20703"></a><span class="lineno">20703</span>&#160;        $this-&gt;textrendermode = $gvars[<span class="stringliteral">&#39;textrendermode&#39;</span>];</div>
<div class="line"><a name="l20704"></a><span class="lineno">20704</span>&#160;        $this-&gt;textstrokewidth = $gvars[<span class="stringliteral">&#39;textstrokewidth&#39;</span>];</div>
<div class="line"><a name="l20705"></a><span class="lineno">20705</span>&#160;        $this-&gt;DrawColor = $gvars[<span class="stringliteral">&#39;DrawColor&#39;</span>];</div>
<div class="line"><a name="l20706"></a><span class="lineno">20706</span>&#160;        $this-&gt;FillColor = $gvars[<span class="stringliteral">&#39;FillColor&#39;</span>];</div>
<div class="line"><a name="l20707"></a><span class="lineno">20707</span>&#160;        $this-&gt;TextColor = $gvars[<span class="stringliteral">&#39;TextColor&#39;</span>];</div>
<div class="line"><a name="l20708"></a><span class="lineno">20708</span>&#160;        $this-&gt;ColorFlag = $gvars[<span class="stringliteral">&#39;ColorFlag&#39;</span>];</div>
<div class="line"><a name="l20709"></a><span class="lineno">20709</span>&#160;        $this-&gt;bgcolor = $gvars[<span class="stringliteral">&#39;bgcolor&#39;</span>];</div>
<div class="line"><a name="l20710"></a><span class="lineno">20710</span>&#160;        $this-&gt;fgcolor = $gvars[<span class="stringliteral">&#39;fgcolor&#39;</span>];</div>
<div class="line"><a name="l20711"></a><span class="lineno">20711</span>&#160;        $this-&gt;htmlvspace = $gvars[<span class="stringliteral">&#39;htmlvspace&#39;</span>];</div>
<div class="line"><a name="l20712"></a><span class="lineno">20712</span>&#160;        $this-&gt;listindent = $gvars[<span class="stringliteral">&#39;listindent&#39;</span>];</div>
<div class="line"><a name="l20713"></a><span class="lineno">20713</span>&#160;        $this-&gt;listindentlevel = $gvars[<span class="stringliteral">&#39;listindentlevel&#39;</span>];</div>
<div class="line"><a name="l20714"></a><span class="lineno">20714</span>&#160;        $this-&gt;listnum = $gvars[<span class="stringliteral">&#39;listnum&#39;</span>];</div>
<div class="line"><a name="l20715"></a><span class="lineno">20715</span>&#160;        $this-&gt;listordered = $gvars[<span class="stringliteral">&#39;listordered&#39;</span>];</div>
<div class="line"><a name="l20716"></a><span class="lineno">20716</span>&#160;        $this-&gt;listcount = $gvars[<span class="stringliteral">&#39;listcount&#39;</span>];</div>
<div class="line"><a name="l20717"></a><span class="lineno">20717</span>&#160;        $this-&gt;lispacer = $gvars[<span class="stringliteral">&#39;lispacer&#39;</span>];</div>
<div class="line"><a name="l20718"></a><span class="lineno">20718</span>&#160;        $this-&gt;cell_height_ratio = $gvars[<span class="stringliteral">&#39;cell_height_ratio&#39;</span>];</div>
<div class="line"><a name="l20719"></a><span class="lineno">20719</span>&#160;        $this-&gt;font_stretching = $gvars[<span class="stringliteral">&#39;font_stretching&#39;</span>];</div>
<div class="line"><a name="l20720"></a><span class="lineno">20720</span>&#160;        $this-&gt;font_spacing = $gvars[<span class="stringliteral">&#39;font_spacing&#39;</span>];</div>
<div class="line"><a name="l20721"></a><span class="lineno">20721</span>&#160;        $this-&gt;alpha = $gvars[<span class="stringliteral">&#39;alpha&#39;</span>];</div>
<div class="line"><a name="l20722"></a><span class="lineno">20722</span>&#160;        <span class="keywordflow">if</span> ($extended) {</div>
<div class="line"><a name="l20723"></a><span class="lineno">20723</span>&#160;            <span class="comment">// restore extended values</span></div>
<div class="line"><a name="l20724"></a><span class="lineno">20724</span>&#160;            $this-&gt;lasth = $gvars[<span class="stringliteral">&#39;lasth&#39;</span>];</div>
<div class="line"><a name="l20725"></a><span class="lineno">20725</span>&#160;            $this-&gt;tMargin = $gvars[<span class="stringliteral">&#39;tMargin&#39;</span>];</div>
<div class="line"><a name="l20726"></a><span class="lineno">20726</span>&#160;            $this-&gt;bMargin = $gvars[<span class="stringliteral">&#39;bMargin&#39;</span>];</div>
<div class="line"><a name="l20727"></a><span class="lineno">20727</span>&#160;            $this-&gt;AutoPageBreak = $gvars[<span class="stringliteral">&#39;AutoPageBreak&#39;</span>];</div>
<div class="line"><a name="l20728"></a><span class="lineno">20728</span>&#160;            $this-&gt;PageBreakTrigger = $gvars[<span class="stringliteral">&#39;PageBreakTrigger&#39;</span>];</div>
<div class="line"><a name="l20729"></a><span class="lineno">20729</span>&#160;            $this-&gt;x = $gvars[<span class="charliteral">&#39;x&#39;</span>];</div>
<div class="line"><a name="l20730"></a><span class="lineno">20730</span>&#160;            $this-&gt;y = $gvars[<span class="charliteral">&#39;y&#39;</span>];</div>
<div class="line"><a name="l20731"></a><span class="lineno">20731</span>&#160;            $this-&gt;w = $gvars[<span class="charliteral">&#39;w&#39;</span>];</div>
<div class="line"><a name="l20732"></a><span class="lineno">20732</span>&#160;            $this-&gt;h = $gvars[<span class="charliteral">&#39;h&#39;</span>];</div>
<div class="line"><a name="l20733"></a><span class="lineno">20733</span>&#160;            $this-&gt;wPt = $gvars[<span class="stringliteral">&#39;wPt&#39;</span>];</div>
<div class="line"><a name="l20734"></a><span class="lineno">20734</span>&#160;            $this-&gt;hPt = $gvars[<span class="stringliteral">&#39;hPt&#39;</span>];</div>
<div class="line"><a name="l20735"></a><span class="lineno">20735</span>&#160;            $this-&gt;fwPt = $gvars[<span class="stringliteral">&#39;fwPt&#39;</span>];</div>
<div class="line"><a name="l20736"></a><span class="lineno">20736</span>&#160;            $this-&gt;fhPt = $gvars[<span class="stringliteral">&#39;fhPt&#39;</span>];</div>
<div class="line"><a name="l20737"></a><span class="lineno">20737</span>&#160;            $this-&gt;page = $gvars[<span class="stringliteral">&#39;page&#39;</span>];</div>
<div class="line"><a name="l20738"></a><span class="lineno">20738</span>&#160;            $this-&gt;current_column = $gvars[<span class="stringliteral">&#39;current_column&#39;</span>];</div>
<div class="line"><a name="l20739"></a><span class="lineno">20739</span>&#160;            $this-&gt;num_columns = $gvars[<span class="stringliteral">&#39;num_columns&#39;</span>];</div>
<div class="line"><a name="l20740"></a><span class="lineno">20740</span>&#160;        }</div>
<div class="line"><a name="l20741"></a><span class="lineno">20741</span>&#160;        $this-&gt;_out(<span class="stringliteral">&#39;&#39;</span>.$this-&gt;linestyleWidth.<span class="charliteral">&#39; &#39;</span>.$this-&gt;linestyleCap.<span class="charliteral">&#39; &#39;</span>.$this-&gt;linestyleJoin.<span class="charliteral">&#39; &#39;</span>.$this-&gt;linestyleDash.<span class="charliteral">&#39; &#39;</span>.$this-&gt;DrawColor.<span class="charliteral">&#39; &#39;</span>.$this-&gt;FillColor.<span class="stringliteral">&#39;&#39;</span>);</div>
<div class="line"><a name="l20742"></a><span class="lineno">20742</span>&#160;        <span class="keywordflow">if</span> (!TCPDF_STATIC::empty_string($this-&gt;FontFamily)) {</div>
<div class="line"><a name="l20743"></a><span class="lineno">20743</span>&#160;            $this-&gt;SetFont($this-&gt;FontFamily, $this-&gt;FontStyle, $this-&gt;FontSizePt);</div>
<div class="line"><a name="l20744"></a><span class="lineno">20744</span>&#160;        }</div>
<div class="line"><a name="l20745"></a><span class="lineno">20745</span>&#160;    }</div>
<div class="line"><a name="l20746"></a><span class="lineno">20746</span>&#160;</div>
<div class="line"><a name="l20751"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aa316f47dbdd13a6dd2897d6be347cbbb">20751</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#aa316f47dbdd13a6dd2897d6be347cbbb">_outSaveGraphicsState</a>() {</div>
<div class="line"><a name="l20752"></a><span class="lineno">20752</span>&#160;        $this-&gt;_out(<span class="charliteral">&#39;q&#39;</span>);</div>
<div class="line"><a name="l20753"></a><span class="lineno">20753</span>&#160;    }</div>
<div class="line"><a name="l20754"></a><span class="lineno">20754</span>&#160;</div>
<div class="line"><a name="l20759"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#af623eface3ce63b2bc1709d47c84ab69">20759</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#af623eface3ce63b2bc1709d47c84ab69">_outRestoreGraphicsState</a>() {</div>
<div class="line"><a name="l20760"></a><span class="lineno">20760</span>&#160;        $this-&gt;_out(<span class="charliteral">&#39;Q&#39;</span>);</div>
<div class="line"><a name="l20761"></a><span class="lineno">20761</span>&#160;    }</div>
<div class="line"><a name="l20762"></a><span class="lineno">20762</span>&#160;</div>
<div class="line"><a name="l20772"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a2b53ae6043ae30ed4c80fd0e7542160b">20772</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a2b53ae6043ae30ed4c80fd0e7542160b">writeDiskCache</a>($filename, $data, $append=<span class="keyword">false</span>, $serialize=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l20773"></a><span class="lineno">20773</span>&#160;        <span class="keywordflow">if</span> ($append) {</div>
<div class="line"><a name="l20774"></a><span class="lineno">20774</span>&#160;            $fmode = <span class="stringliteral">&#39;ab+&#39;</span>;</div>
<div class="line"><a name="l20775"></a><span class="lineno">20775</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l20776"></a><span class="lineno">20776</span>&#160;            $fmode = <span class="stringliteral">&#39;wb+&#39;</span>;</div>
<div class="line"><a name="l20777"></a><span class="lineno">20777</span>&#160;        }</div>
<div class="line"><a name="l20778"></a><span class="lineno">20778</span>&#160;        $f = @fopen($filename, $fmode);</div>
<div class="line"><a name="l20779"></a><span class="lineno">20779</span>&#160;        <span class="keywordflow">if</span> (!$f) {</div>
<div class="line"><a name="l20780"></a><span class="lineno">20780</span>&#160;            $this-&gt;Error(<span class="stringliteral">&#39;Unable to write cache file: &#39;</span>.$filename);</div>
<div class="line"><a name="l20781"></a><span class="lineno">20781</span>&#160;        }</div>
<div class="line"><a name="l20782"></a><span class="lineno">20782</span>&#160;        <span class="keywordflow">if</span> ($serialize) {</div>
<div class="line"><a name="l20783"></a><span class="lineno">20783</span>&#160;            $data = $this-&gt;file_id.serialize($data);</div>
<div class="line"><a name="l20784"></a><span class="lineno">20784</span>&#160;        }</div>
<div class="line"><a name="l20785"></a><span class="lineno">20785</span>&#160;        fwrite($f, $data);</div>
<div class="line"><a name="l20786"></a><span class="lineno">20786</span>&#160;        fclose($f);</div>
<div class="line"><a name="l20787"></a><span class="lineno">20787</span>&#160;        <span class="comment">// update file length (needed for transactions)</span></div>
<div class="line"><a name="l20788"></a><span class="lineno">20788</span>&#160;        <span class="keywordflow">if</span> (!isset($this-&gt;cache_file_length[<span class="charliteral">&#39;_&#39;</span>.$filename])) {</div>
<div class="line"><a name="l20789"></a><span class="lineno">20789</span>&#160;            $this-&gt;cache_file_length[<span class="charliteral">&#39;_&#39;</span>.$filename] = strlen($data);</div>
<div class="line"><a name="l20790"></a><span class="lineno">20790</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l20791"></a><span class="lineno">20791</span>&#160;            $this-&gt;cache_file_length[<span class="charliteral">&#39;_&#39;</span>.$filename] += strlen($data);</div>
<div class="line"><a name="l20792"></a><span class="lineno">20792</span>&#160;        }</div>
<div class="line"><a name="l20793"></a><span class="lineno">20793</span>&#160;    }</div>
<div class="line"><a name="l20794"></a><span class="lineno">20794</span>&#160;</div>
<div class="line"><a name="l20803"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a01ab8d5030f2862528e88607174f5fee">20803</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a01ab8d5030f2862528e88607174f5fee">readDiskCache</a>($filename, $unserialize=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l20804"></a><span class="lineno">20804</span>&#160;        $data = file_get_contents($filename);</div>
<div class="line"><a name="l20805"></a><span class="lineno">20805</span>&#160;        <span class="keywordflow">if</span> ($data === FALSE) {</div>
<div class="line"><a name="l20806"></a><span class="lineno">20806</span>&#160;            $this-&gt;Error(<span class="stringliteral">&#39;Unable to read the file: &#39;</span>.$filename);</div>
<div class="line"><a name="l20807"></a><span class="lineno">20807</span>&#160;        }</div>
<div class="line"><a name="l20808"></a><span class="lineno">20808</span>&#160;        <span class="keywordflow">if</span> ($unserialize) {</div>
<div class="line"><a name="l20809"></a><span class="lineno">20809</span>&#160;            <span class="keywordflow">if</span> (substr($data, 0, 32) != $this-&gt;file_id) {</div>
<div class="line"><a name="l20810"></a><span class="lineno">20810</span>&#160;                $this-&gt;Error(<span class="stringliteral">&#39;Invalid cache file: &#39;</span>.$filename);</div>
<div class="line"><a name="l20811"></a><span class="lineno">20811</span>&#160;            }</div>
<div class="line"><a name="l20812"></a><span class="lineno">20812</span>&#160;            $data = unserialize(substr($data, 32));</div>
<div class="line"><a name="l20813"></a><span class="lineno">20813</span>&#160;        }</div>
<div class="line"><a name="l20814"></a><span class="lineno">20814</span>&#160;        <span class="keywordflow">return</span> $data;</div>
<div class="line"><a name="l20815"></a><span class="lineno">20815</span>&#160;    }</div>
<div class="line"><a name="l20816"></a><span class="lineno">20816</span>&#160;</div>
<div class="line"><a name="l20823"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a7a19b2f2308c1f3a4ddb97447cb5ee90">20823</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a7a19b2f2308c1f3a4ddb97447cb5ee90">setBuffer</a>($data) {</div>
<div class="line"><a name="l20824"></a><span class="lineno">20824</span>&#160;        $this-&gt;bufferlen += strlen($data);</div>
<div class="line"><a name="l20825"></a><span class="lineno">20825</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;diskcache) {</div>
<div class="line"><a name="l20826"></a><span class="lineno">20826</span>&#160;            <span class="keywordflow">if</span> (!isset($this-&gt;buffer) OR TCPDF_STATIC::empty_string($this-&gt;buffer)) {</div>
<div class="line"><a name="l20827"></a><span class="lineno">20827</span>&#160;                $this-&gt;buffer = TCPDF_STATIC::getObjFilename(<span class="stringliteral">&#39;buf&#39;</span>);</div>
<div class="line"><a name="l20828"></a><span class="lineno">20828</span>&#160;            }</div>
<div class="line"><a name="l20829"></a><span class="lineno">20829</span>&#160;            $this-&gt;writeDiskCache($this-&gt;buffer, $data, <span class="keyword">true</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l20830"></a><span class="lineno">20830</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l20831"></a><span class="lineno">20831</span>&#160;            $this-&gt;buffer .= $data;</div>
<div class="line"><a name="l20832"></a><span class="lineno">20832</span>&#160;        }</div>
<div class="line"><a name="l20833"></a><span class="lineno">20833</span>&#160;    }</div>
<div class="line"><a name="l20834"></a><span class="lineno">20834</span>&#160;</div>
<div class="line"><a name="l20841"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#abbcad4f482db857c9068d1d4846081ba">20841</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#abbcad4f482db857c9068d1d4846081ba">replaceBuffer</a>($data) {</div>
<div class="line"><a name="l20842"></a><span class="lineno">20842</span>&#160;        $this-&gt;bufferlen = strlen($data);</div>
<div class="line"><a name="l20843"></a><span class="lineno">20843</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;diskcache) {</div>
<div class="line"><a name="l20844"></a><span class="lineno">20844</span>&#160;            <span class="keywordflow">if</span> (!isset($this-&gt;buffer) OR TCPDF_STATIC::empty_string($this-&gt;buffer)) {</div>
<div class="line"><a name="l20845"></a><span class="lineno">20845</span>&#160;                $this-&gt;buffer = TCPDF_STATIC::getObjFilename(<span class="stringliteral">&#39;buf&#39;</span>);</div>
<div class="line"><a name="l20846"></a><span class="lineno">20846</span>&#160;            }</div>
<div class="line"><a name="l20847"></a><span class="lineno">20847</span>&#160;            $this-&gt;writeDiskCache($this-&gt;buffer, $data, <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l20848"></a><span class="lineno">20848</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l20849"></a><span class="lineno">20849</span>&#160;            $this-&gt;buffer = $data;</div>
<div class="line"><a name="l20850"></a><span class="lineno">20850</span>&#160;        }</div>
<div class="line"><a name="l20851"></a><span class="lineno">20851</span>&#160;    }</div>
<div class="line"><a name="l20852"></a><span class="lineno">20852</span>&#160;</div>
<div class="line"><a name="l20859"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a24b714e8e56b4f8672886180e5037cd7">20859</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a24b714e8e56b4f8672886180e5037cd7">getBuffer</a>() {</div>
<div class="line"><a name="l20860"></a><span class="lineno">20860</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;diskcache) {</div>
<div class="line"><a name="l20861"></a><span class="lineno">20861</span>&#160;            <span class="keywordflow">return</span> $this-&gt;readDiskCache($this-&gt;buffer, <span class="keyword">false</span>);</div>
<div class="line"><a name="l20862"></a><span class="lineno">20862</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l20863"></a><span class="lineno">20863</span>&#160;            <span class="keywordflow">return</span> $this-&gt;buffer;</div>
<div class="line"><a name="l20864"></a><span class="lineno">20864</span>&#160;        }</div>
<div class="line"><a name="l20865"></a><span class="lineno">20865</span>&#160;    }</div>
<div class="line"><a name="l20866"></a><span class="lineno">20866</span>&#160;</div>
<div class="line"><a name="l20875"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a2b85f6395de14dd40cab8839b3ce25a8">20875</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a2b85f6395de14dd40cab8839b3ce25a8">setPageBuffer</a>($page, $data, $append=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l20876"></a><span class="lineno">20876</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;diskcache) {</div>
<div class="line"><a name="l20877"></a><span class="lineno">20877</span>&#160;            <span class="keywordflow">if</span> (!isset($this-&gt;pages[$page])) {</div>
<div class="line"><a name="l20878"></a><span class="lineno">20878</span>&#160;                $this-&gt;pages[$page] = TCPDF_STATIC::getObjFilename(<span class="stringliteral">&#39;page&#39;</span>);</div>
<div class="line"><a name="l20879"></a><span class="lineno">20879</span>&#160;            }</div>
<div class="line"><a name="l20880"></a><span class="lineno">20880</span>&#160;            $this-&gt;writeDiskCache($this-&gt;pages[$page], $data, $append, <span class="keyword">false</span>);</div>
<div class="line"><a name="l20881"></a><span class="lineno">20881</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l20882"></a><span class="lineno">20882</span>&#160;            <span class="keywordflow">if</span> ($append) {</div>
<div class="line"><a name="l20883"></a><span class="lineno">20883</span>&#160;                $this-&gt;pages[$page] .= $data;</div>
<div class="line"><a name="l20884"></a><span class="lineno">20884</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l20885"></a><span class="lineno">20885</span>&#160;                $this-&gt;pages[$page] = $data;</div>
<div class="line"><a name="l20886"></a><span class="lineno">20886</span>&#160;            }</div>
<div class="line"><a name="l20887"></a><span class="lineno">20887</span>&#160;        }</div>
<div class="line"><a name="l20888"></a><span class="lineno">20888</span>&#160;        <span class="keywordflow">if</span> ($append AND isset($this-&gt;pagelen[$page])) {</div>
<div class="line"><a name="l20889"></a><span class="lineno">20889</span>&#160;            $this-&gt;pagelen[$page] += strlen($data);</div>
<div class="line"><a name="l20890"></a><span class="lineno">20890</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l20891"></a><span class="lineno">20891</span>&#160;            $this-&gt;pagelen[$page] = strlen($data);</div>
<div class="line"><a name="l20892"></a><span class="lineno">20892</span>&#160;        }</div>
<div class="line"><a name="l20893"></a><span class="lineno">20893</span>&#160;    }</div>
<div class="line"><a name="l20894"></a><span class="lineno">20894</span>&#160;</div>
<div class="line"><a name="l20902"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a4d67b0a8681222f71fa9f9f6e65e0c56">20902</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a4d67b0a8681222f71fa9f9f6e65e0c56">getPageBuffer</a>($page) {</div>
<div class="line"><a name="l20903"></a><span class="lineno">20903</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;diskcache) {</div>
<div class="line"><a name="l20904"></a><span class="lineno">20904</span>&#160;            <span class="keywordflow">return</span> $this-&gt;readDiskCache($this-&gt;pages[$page], <span class="keyword">false</span>);</div>
<div class="line"><a name="l20905"></a><span class="lineno">20905</span>&#160;        } elseif (isset($this-&gt;pages[$page])) {</div>
<div class="line"><a name="l20906"></a><span class="lineno">20906</span>&#160;            <span class="keywordflow">return</span> $this-&gt;pages[$page];</div>
<div class="line"><a name="l20907"></a><span class="lineno">20907</span>&#160;        }</div>
<div class="line"><a name="l20908"></a><span class="lineno">20908</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l20909"></a><span class="lineno">20909</span>&#160;    }</div>
<div class="line"><a name="l20910"></a><span class="lineno">20910</span>&#160;</div>
<div class="line"><a name="l20919"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a68092d68b3e4947ea283efe0a990e7d9">20919</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a68092d68b3e4947ea283efe0a990e7d9">setImageBuffer</a>($image, $data) {</div>
<div class="line"><a name="l20920"></a><span class="lineno">20920</span>&#160;        <span class="keywordflow">if</span> (($data[<span class="charliteral">&#39;i&#39;</span>] = array_search($image, $this-&gt;imagekeys)) === FALSE) {</div>
<div class="line"><a name="l20921"></a><span class="lineno">20921</span>&#160;            $this-&gt;imagekeys[$this-&gt;numimages] = $image;</div>
<div class="line"><a name="l20922"></a><span class="lineno">20922</span>&#160;            $data[<span class="charliteral">&#39;i&#39;</span>] = $this-&gt;numimages;</div>
<div class="line"><a name="l20923"></a><span class="lineno">20923</span>&#160;            ++$this-&gt;numimages;</div>
<div class="line"><a name="l20924"></a><span class="lineno">20924</span>&#160;        }</div>
<div class="line"><a name="l20925"></a><span class="lineno">20925</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;diskcache) {</div>
<div class="line"><a name="l20926"></a><span class="lineno">20926</span>&#160;            <span class="keywordflow">if</span> (!isset($this-&gt;images[$image])) {</div>
<div class="line"><a name="l20927"></a><span class="lineno">20927</span>&#160;                $this-&gt;images[$image] = TCPDF_STATIC::getObjFilename(<span class="stringliteral">&#39;img&#39;</span>);</div>
<div class="line"><a name="l20928"></a><span class="lineno">20928</span>&#160;            }</div>
<div class="line"><a name="l20929"></a><span class="lineno">20929</span>&#160;            $this-&gt;writeDiskCache($this-&gt;images[$image], $data, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l20930"></a><span class="lineno">20930</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l20931"></a><span class="lineno">20931</span>&#160;            $this-&gt;images[$image] = $data;</div>
<div class="line"><a name="l20932"></a><span class="lineno">20932</span>&#160;        }</div>
<div class="line"><a name="l20933"></a><span class="lineno">20933</span>&#160;        <span class="keywordflow">return</span> $data[<span class="charliteral">&#39;i&#39;</span>];</div>
<div class="line"><a name="l20934"></a><span class="lineno">20934</span>&#160;    }</div>
<div class="line"><a name="l20935"></a><span class="lineno">20935</span>&#160;</div>
<div class="line"><a name="l20944"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a7f6c277af6ed456e709c6b397cf34c51">20944</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a7f6c277af6ed456e709c6b397cf34c51">setImageSubBuffer</a>($image, $key, $data) {</div>
<div class="line"><a name="l20945"></a><span class="lineno">20945</span>&#160;        <span class="keywordflow">if</span> (!isset($this-&gt;images[$image])) {</div>
<div class="line"><a name="l20946"></a><span class="lineno">20946</span>&#160;            $this-&gt;setImageBuffer($image, array());</div>
<div class="line"><a name="l20947"></a><span class="lineno">20947</span>&#160;        }</div>
<div class="line"><a name="l20948"></a><span class="lineno">20948</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;diskcache) {</div>
<div class="line"><a name="l20949"></a><span class="lineno">20949</span>&#160;            $tmpimg = $this-&gt;getImageBuffer($image);</div>
<div class="line"><a name="l20950"></a><span class="lineno">20950</span>&#160;            $tmpimg[$key] = $data;</div>
<div class="line"><a name="l20951"></a><span class="lineno">20951</span>&#160;            $this-&gt;writeDiskCache($this-&gt;images[$image], $tmpimg, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l20952"></a><span class="lineno">20952</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l20953"></a><span class="lineno">20953</span>&#160;            $this-&gt;images[$image][$key] = $data;</div>
<div class="line"><a name="l20954"></a><span class="lineno">20954</span>&#160;        }</div>
<div class="line"><a name="l20955"></a><span class="lineno">20955</span>&#160;    }</div>
<div class="line"><a name="l20956"></a><span class="lineno">20956</span>&#160;</div>
<div class="line"><a name="l20964"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a1a003edf69be144993c85c07a220315c">20964</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a1a003edf69be144993c85c07a220315c">getImageBuffer</a>($image) {</div>
<div class="line"><a name="l20965"></a><span class="lineno">20965</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;diskcache AND isset($this-&gt;images[$image])) {</div>
<div class="line"><a name="l20966"></a><span class="lineno">20966</span>&#160;            <span class="keywordflow">return</span> $this-&gt;readDiskCache($this-&gt;images[$image], <span class="keyword">true</span>);</div>
<div class="line"><a name="l20967"></a><span class="lineno">20967</span>&#160;        } elseif (isset($this-&gt;images[$image])) {</div>
<div class="line"><a name="l20968"></a><span class="lineno">20968</span>&#160;            <span class="keywordflow">return</span> $this-&gt;images[$image];</div>
<div class="line"><a name="l20969"></a><span class="lineno">20969</span>&#160;        }</div>
<div class="line"><a name="l20970"></a><span class="lineno">20970</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l20971"></a><span class="lineno">20971</span>&#160;    }</div>
<div class="line"><a name="l20972"></a><span class="lineno">20972</span>&#160;</div>
<div class="line"><a name="l20980"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aa9eb763490acb3dfdf3f0cf445e83ca6">20980</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#aa9eb763490acb3dfdf3f0cf445e83ca6">setFontBuffer</a>($font, $data) {</div>
<div class="line"><a name="l20981"></a><span class="lineno">20981</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;diskcache) {</div>
<div class="line"><a name="l20982"></a><span class="lineno">20982</span>&#160;            <span class="keywordflow">if</span> (!isset($this-&gt;fonts[$font])) {</div>
<div class="line"><a name="l20983"></a><span class="lineno">20983</span>&#160;                $this-&gt;fonts[$font] = TCPDF_STATIC::getObjFilename(<span class="stringliteral">&#39;font&#39;</span>);</div>
<div class="line"><a name="l20984"></a><span class="lineno">20984</span>&#160;            }</div>
<div class="line"><a name="l20985"></a><span class="lineno">20985</span>&#160;            $this-&gt;writeDiskCache($this-&gt;fonts[$font], $data, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l20986"></a><span class="lineno">20986</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l20987"></a><span class="lineno">20987</span>&#160;            $this-&gt;fonts[$font] = $data;</div>
<div class="line"><a name="l20988"></a><span class="lineno">20988</span>&#160;        }</div>
<div class="line"><a name="l20989"></a><span class="lineno">20989</span>&#160;        <span class="keywordflow">if</span> (!in_array($font, $this-&gt;fontkeys)) {</div>
<div class="line"><a name="l20990"></a><span class="lineno">20990</span>&#160;            $this-&gt;fontkeys[] = $font;</div>
<div class="line"><a name="l20991"></a><span class="lineno">20991</span>&#160;            <span class="comment">// store object ID for current font</span></div>
<div class="line"><a name="l20992"></a><span class="lineno">20992</span>&#160;            ++$this-&gt;n;</div>
<div class="line"><a name="l20993"></a><span class="lineno">20993</span>&#160;            $this-&gt;font_obj_ids[$font] = $this-&gt;n;</div>
<div class="line"><a name="l20994"></a><span class="lineno">20994</span>&#160;            $this-&gt;setFontSubBuffer($font, <span class="charliteral">&#39;n&#39;</span>, $this-&gt;n);</div>
<div class="line"><a name="l20995"></a><span class="lineno">20995</span>&#160;        }</div>
<div class="line"><a name="l20996"></a><span class="lineno">20996</span>&#160;    }</div>
<div class="line"><a name="l20997"></a><span class="lineno">20997</span>&#160;</div>
<div class="line"><a name="l21006"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ac6009bf1f27a31ee208d9687cb4b91eb">21006</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ac6009bf1f27a31ee208d9687cb4b91eb">setFontSubBuffer</a>($font, $key, $data) {</div>
<div class="line"><a name="l21007"></a><span class="lineno">21007</span>&#160;        <span class="keywordflow">if</span> (!isset($this-&gt;fonts[$font])) {</div>
<div class="line"><a name="l21008"></a><span class="lineno">21008</span>&#160;            $this-&gt;setFontBuffer($font, array());</div>
<div class="line"><a name="l21009"></a><span class="lineno">21009</span>&#160;        }</div>
<div class="line"><a name="l21010"></a><span class="lineno">21010</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;diskcache) {</div>
<div class="line"><a name="l21011"></a><span class="lineno">21011</span>&#160;            $tmpfont = $this-&gt;getFontBuffer($font);</div>
<div class="line"><a name="l21012"></a><span class="lineno">21012</span>&#160;            $tmpfont[$key] = $data;</div>
<div class="line"><a name="l21013"></a><span class="lineno">21013</span>&#160;            $this-&gt;writeDiskCache($this-&gt;fonts[$font], $tmpfont, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l21014"></a><span class="lineno">21014</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l21015"></a><span class="lineno">21015</span>&#160;            $this-&gt;fonts[$font][$key] = $data;</div>
<div class="line"><a name="l21016"></a><span class="lineno">21016</span>&#160;        }</div>
<div class="line"><a name="l21017"></a><span class="lineno">21017</span>&#160;    }</div>
<div class="line"><a name="l21018"></a><span class="lineno">21018</span>&#160;</div>
<div class="line"><a name="l21026"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ac63fff093a17846764bbcc09af7c8640">21026</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ac63fff093a17846764bbcc09af7c8640">getFontBuffer</a>($font) {</div>
<div class="line"><a name="l21027"></a><span class="lineno">21027</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;diskcache AND isset($this-&gt;fonts[$font])) {</div>
<div class="line"><a name="l21028"></a><span class="lineno">21028</span>&#160;            <span class="keywordflow">return</span> $this-&gt;readDiskCache($this-&gt;fonts[$font], <span class="keyword">true</span>);</div>
<div class="line"><a name="l21029"></a><span class="lineno">21029</span>&#160;        } elseif (isset($this-&gt;fonts[$font])) {</div>
<div class="line"><a name="l21030"></a><span class="lineno">21030</span>&#160;            <span class="keywordflow">return</span> $this-&gt;fonts[$font];</div>
<div class="line"><a name="l21031"></a><span class="lineno">21031</span>&#160;        }</div>
<div class="line"><a name="l21032"></a><span class="lineno">21032</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l21033"></a><span class="lineno">21033</span>&#160;    }</div>
<div class="line"><a name="l21034"></a><span class="lineno">21034</span>&#160;</div>
<div class="line"><a name="l21043"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a3ca50045ed09382a1ed2877778dce3a9">21043</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a3ca50045ed09382a1ed2877778dce3a9">movePage</a>($frompage, $topage) {</div>
<div class="line"><a name="l21044"></a><span class="lineno">21044</span>&#160;        <span class="keywordflow">if</span> (($frompage &gt; $this-&gt;numpages) OR ($frompage &lt;= $topage)) {</div>
<div class="line"><a name="l21045"></a><span class="lineno">21045</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l21046"></a><span class="lineno">21046</span>&#160;        }</div>
<div class="line"><a name="l21047"></a><span class="lineno">21047</span>&#160;        <span class="keywordflow">if</span> ($frompage == $this-&gt;page) {</div>
<div class="line"><a name="l21048"></a><span class="lineno">21048</span>&#160;            <span class="comment">// close the page before moving it</span></div>
<div class="line"><a name="l21049"></a><span class="lineno">21049</span>&#160;            $this-&gt;endPage();</div>
<div class="line"><a name="l21050"></a><span class="lineno">21050</span>&#160;        }</div>
<div class="line"><a name="l21051"></a><span class="lineno">21051</span>&#160;        <span class="comment">// move all page-related states</span></div>
<div class="line"><a name="l21052"></a><span class="lineno">21052</span>&#160;        $tmppage = $this-&gt;getPageBuffer($frompage);</div>
<div class="line"><a name="l21053"></a><span class="lineno">21053</span>&#160;        $tmppagedim = $this-&gt;pagedim[$frompage];</div>
<div class="line"><a name="l21054"></a><span class="lineno">21054</span>&#160;        $tmppagelen = $this-&gt;pagelen[$frompage];</div>
<div class="line"><a name="l21055"></a><span class="lineno">21055</span>&#160;        $tmpintmrk = $this-&gt;intmrk[$frompage];</div>
<div class="line"><a name="l21056"></a><span class="lineno">21056</span>&#160;        $tmpbordermrk = $this-&gt;bordermrk[$frompage];</div>
<div class="line"><a name="l21057"></a><span class="lineno">21057</span>&#160;        $tmpcntmrk = $this-&gt;cntmrk[$frompage];</div>
<div class="line"><a name="l21058"></a><span class="lineno">21058</span>&#160;        $tmppageobjects = $this-&gt;pageobjects[$frompage];</div>
<div class="line"><a name="l21059"></a><span class="lineno">21059</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;footerpos[$frompage])) {</div>
<div class="line"><a name="l21060"></a><span class="lineno">21060</span>&#160;            $tmpfooterpos = $this-&gt;footerpos[$frompage];</div>
<div class="line"><a name="l21061"></a><span class="lineno">21061</span>&#160;        }</div>
<div class="line"><a name="l21062"></a><span class="lineno">21062</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;footerlen[$frompage])) {</div>
<div class="line"><a name="l21063"></a><span class="lineno">21063</span>&#160;            $tmpfooterlen = $this-&gt;footerlen[$frompage];</div>
<div class="line"><a name="l21064"></a><span class="lineno">21064</span>&#160;        }</div>
<div class="line"><a name="l21065"></a><span class="lineno">21065</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;transfmrk[$frompage])) {</div>
<div class="line"><a name="l21066"></a><span class="lineno">21066</span>&#160;            $tmptransfmrk = $this-&gt;transfmrk[$frompage];</div>
<div class="line"><a name="l21067"></a><span class="lineno">21067</span>&#160;        }</div>
<div class="line"><a name="l21068"></a><span class="lineno">21068</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;PageAnnots[$frompage])) {</div>
<div class="line"><a name="l21069"></a><span class="lineno">21069</span>&#160;            $tmpannots = $this-&gt;PageAnnots[$frompage];</div>
<div class="line"><a name="l21070"></a><span class="lineno">21070</span>&#160;        }</div>
<div class="line"><a name="l21071"></a><span class="lineno">21071</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;newpagegroup) AND !empty($this-&gt;newpagegroup)) {</div>
<div class="line"><a name="l21072"></a><span class="lineno">21072</span>&#160;            <span class="keywordflow">for</span> ($i = $frompage; $i &gt; $topage; --$i) {</div>
<div class="line"><a name="l21073"></a><span class="lineno">21073</span>&#160;                <span class="keywordflow">if</span> (isset($this-&gt;newpagegroup[$i]) AND (($i + $this-&gt;pagegroups[$this-&gt;newpagegroup[$i]]) &gt; $frompage)) {</div>
<div class="line"><a name="l21074"></a><span class="lineno">21074</span>&#160;                    --$this-&gt;pagegroups[$this-&gt;newpagegroup[$i]];</div>
<div class="line"><a name="l21075"></a><span class="lineno">21075</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l21076"></a><span class="lineno">21076</span>&#160;                }</div>
<div class="line"><a name="l21077"></a><span class="lineno">21077</span>&#160;            }</div>
<div class="line"><a name="l21078"></a><span class="lineno">21078</span>&#160;            <span class="keywordflow">for</span> ($i = $topage; $i &gt; 0; --$i) {</div>
<div class="line"><a name="l21079"></a><span class="lineno">21079</span>&#160;                <span class="keywordflow">if</span> (isset($this-&gt;newpagegroup[$i]) AND (($i + $this-&gt;pagegroups[$this-&gt;newpagegroup[$i]]) &gt; $topage)) {</div>
<div class="line"><a name="l21080"></a><span class="lineno">21080</span>&#160;                    ++$this-&gt;pagegroups[$this-&gt;newpagegroup[$i]];</div>
<div class="line"><a name="l21081"></a><span class="lineno">21081</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l21082"></a><span class="lineno">21082</span>&#160;                }</div>
<div class="line"><a name="l21083"></a><span class="lineno">21083</span>&#160;            }</div>
<div class="line"><a name="l21084"></a><span class="lineno">21084</span>&#160;        }</div>
<div class="line"><a name="l21085"></a><span class="lineno">21085</span>&#160;        <span class="keywordflow">for</span> ($i = $frompage; $i &gt; $topage; --$i) {</div>
<div class="line"><a name="l21086"></a><span class="lineno">21086</span>&#160;            $j = $i - 1;</div>
<div class="line"><a name="l21087"></a><span class="lineno">21087</span>&#160;            <span class="comment">// shift pages down</span></div>
<div class="line"><a name="l21088"></a><span class="lineno">21088</span>&#160;            $this-&gt;setPageBuffer($i, $this-&gt;getPageBuffer($j));</div>
<div class="line"><a name="l21089"></a><span class="lineno">21089</span>&#160;            $this-&gt;pagedim[$i] = $this-&gt;pagedim[$j];</div>
<div class="line"><a name="l21090"></a><span class="lineno">21090</span>&#160;            $this-&gt;pagelen[$i] = $this-&gt;pagelen[$j];</div>
<div class="line"><a name="l21091"></a><span class="lineno">21091</span>&#160;            $this-&gt;intmrk[$i] = $this-&gt;intmrk[$j];</div>
<div class="line"><a name="l21092"></a><span class="lineno">21092</span>&#160;            $this-&gt;bordermrk[$i] = $this-&gt;bordermrk[$j];</div>
<div class="line"><a name="l21093"></a><span class="lineno">21093</span>&#160;            $this-&gt;cntmrk[$i] = $this-&gt;cntmrk[$j];</div>
<div class="line"><a name="l21094"></a><span class="lineno">21094</span>&#160;            $this-&gt;pageobjects[$i] = $this-&gt;pageobjects[$j];</div>
<div class="line"><a name="l21095"></a><span class="lineno">21095</span>&#160;            <span class="keywordflow">if</span> (isset($this-&gt;footerpos[$j])) {</div>
<div class="line"><a name="l21096"></a><span class="lineno">21096</span>&#160;                $this-&gt;footerpos[$i] = $this-&gt;footerpos[$j];</div>
<div class="line"><a name="l21097"></a><span class="lineno">21097</span>&#160;            } elseif (isset($this-&gt;footerpos[$i])) {</div>
<div class="line"><a name="l21098"></a><span class="lineno">21098</span>&#160;                unset($this-&gt;footerpos[$i]);</div>
<div class="line"><a name="l21099"></a><span class="lineno">21099</span>&#160;            }</div>
<div class="line"><a name="l21100"></a><span class="lineno">21100</span>&#160;            <span class="keywordflow">if</span> (isset($this-&gt;footerlen[$j])) {</div>
<div class="line"><a name="l21101"></a><span class="lineno">21101</span>&#160;                $this-&gt;footerlen[$i] = $this-&gt;footerlen[$j];</div>
<div class="line"><a name="l21102"></a><span class="lineno">21102</span>&#160;            } elseif (isset($this-&gt;footerlen[$i])) {</div>
<div class="line"><a name="l21103"></a><span class="lineno">21103</span>&#160;                unset($this-&gt;footerlen[$i]);</div>
<div class="line"><a name="l21104"></a><span class="lineno">21104</span>&#160;            }</div>
<div class="line"><a name="l21105"></a><span class="lineno">21105</span>&#160;            <span class="keywordflow">if</span> (isset($this-&gt;transfmrk[$j])) {</div>
<div class="line"><a name="l21106"></a><span class="lineno">21106</span>&#160;                $this-&gt;transfmrk[$i] = $this-&gt;transfmrk[$j];</div>
<div class="line"><a name="l21107"></a><span class="lineno">21107</span>&#160;            } elseif (isset($this-&gt;transfmrk[$i])) {</div>
<div class="line"><a name="l21108"></a><span class="lineno">21108</span>&#160;                unset($this-&gt;transfmrk[$i]);</div>
<div class="line"><a name="l21109"></a><span class="lineno">21109</span>&#160;            }</div>
<div class="line"><a name="l21110"></a><span class="lineno">21110</span>&#160;            <span class="keywordflow">if</span> (isset($this-&gt;PageAnnots[$j])) {</div>
<div class="line"><a name="l21111"></a><span class="lineno">21111</span>&#160;                $this-&gt;PageAnnots[$i] = $this-&gt;PageAnnots[$j];</div>
<div class="line"><a name="l21112"></a><span class="lineno">21112</span>&#160;            } elseif (isset($this-&gt;PageAnnots[$i])) {</div>
<div class="line"><a name="l21113"></a><span class="lineno">21113</span>&#160;                unset($this-&gt;PageAnnots[$i]);</div>
<div class="line"><a name="l21114"></a><span class="lineno">21114</span>&#160;            }</div>
<div class="line"><a name="l21115"></a><span class="lineno">21115</span>&#160;            <span class="keywordflow">if</span> (isset($this-&gt;newpagegroup[$j])) {</div>
<div class="line"><a name="l21116"></a><span class="lineno">21116</span>&#160;                $this-&gt;newpagegroup[$i] = $this-&gt;newpagegroup[$j];</div>
<div class="line"><a name="l21117"></a><span class="lineno">21117</span>&#160;                unset($this-&gt;newpagegroup[$j]);</div>
<div class="line"><a name="l21118"></a><span class="lineno">21118</span>&#160;            }</div>
<div class="line"><a name="l21119"></a><span class="lineno">21119</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;currpagegroup == $j) {</div>
<div class="line"><a name="l21120"></a><span class="lineno">21120</span>&#160;                $this-&gt;currpagegroup = $i;</div>
<div class="line"><a name="l21121"></a><span class="lineno">21121</span>&#160;            }</div>
<div class="line"><a name="l21122"></a><span class="lineno">21122</span>&#160;        }</div>
<div class="line"><a name="l21123"></a><span class="lineno">21123</span>&#160;        $this-&gt;setPageBuffer($topage, $tmppage);</div>
<div class="line"><a name="l21124"></a><span class="lineno">21124</span>&#160;        $this-&gt;pagedim[$topage] = $tmppagedim;</div>
<div class="line"><a name="l21125"></a><span class="lineno">21125</span>&#160;        $this-&gt;pagelen[$topage] = $tmppagelen;</div>
<div class="line"><a name="l21126"></a><span class="lineno">21126</span>&#160;        $this-&gt;intmrk[$topage] = $tmpintmrk;</div>
<div class="line"><a name="l21127"></a><span class="lineno">21127</span>&#160;        $this-&gt;bordermrk[$topage] = $tmpbordermrk;</div>
<div class="line"><a name="l21128"></a><span class="lineno">21128</span>&#160;        $this-&gt;cntmrk[$topage] = $tmpcntmrk;</div>
<div class="line"><a name="l21129"></a><span class="lineno">21129</span>&#160;        $this-&gt;pageobjects[$topage] = $tmppageobjects;</div>
<div class="line"><a name="l21130"></a><span class="lineno">21130</span>&#160;        <span class="keywordflow">if</span> (isset($tmpfooterpos)) {</div>
<div class="line"><a name="l21131"></a><span class="lineno">21131</span>&#160;            $this-&gt;footerpos[$topage] = $tmpfooterpos;</div>
<div class="line"><a name="l21132"></a><span class="lineno">21132</span>&#160;        } elseif (isset($this-&gt;footerpos[$topage])) {</div>
<div class="line"><a name="l21133"></a><span class="lineno">21133</span>&#160;            unset($this-&gt;footerpos[$topage]);</div>
<div class="line"><a name="l21134"></a><span class="lineno">21134</span>&#160;        }</div>
<div class="line"><a name="l21135"></a><span class="lineno">21135</span>&#160;        <span class="keywordflow">if</span> (isset($tmpfooterlen)) {</div>
<div class="line"><a name="l21136"></a><span class="lineno">21136</span>&#160;            $this-&gt;footerlen[$topage] = $tmpfooterlen;</div>
<div class="line"><a name="l21137"></a><span class="lineno">21137</span>&#160;        } elseif (isset($this-&gt;footerlen[$topage])) {</div>
<div class="line"><a name="l21138"></a><span class="lineno">21138</span>&#160;            unset($this-&gt;footerlen[$topage]);</div>
<div class="line"><a name="l21139"></a><span class="lineno">21139</span>&#160;        }</div>
<div class="line"><a name="l21140"></a><span class="lineno">21140</span>&#160;        <span class="keywordflow">if</span> (isset($tmptransfmrk)) {</div>
<div class="line"><a name="l21141"></a><span class="lineno">21141</span>&#160;            $this-&gt;transfmrk[$topage] = $tmptransfmrk;</div>
<div class="line"><a name="l21142"></a><span class="lineno">21142</span>&#160;        } elseif (isset($this-&gt;transfmrk[$topage])) {</div>
<div class="line"><a name="l21143"></a><span class="lineno">21143</span>&#160;            unset($this-&gt;transfmrk[$topage]);</div>
<div class="line"><a name="l21144"></a><span class="lineno">21144</span>&#160;        }</div>
<div class="line"><a name="l21145"></a><span class="lineno">21145</span>&#160;        <span class="keywordflow">if</span> (isset($tmpannots)) {</div>
<div class="line"><a name="l21146"></a><span class="lineno">21146</span>&#160;            $this-&gt;PageAnnots[$topage] = $tmpannots;</div>
<div class="line"><a name="l21147"></a><span class="lineno">21147</span>&#160;        } elseif (isset($this-&gt;PageAnnots[$topage])) {</div>
<div class="line"><a name="l21148"></a><span class="lineno">21148</span>&#160;            unset($this-&gt;PageAnnots[$topage]);</div>
<div class="line"><a name="l21149"></a><span class="lineno">21149</span>&#160;        }</div>
<div class="line"><a name="l21150"></a><span class="lineno">21150</span>&#160;        <span class="comment">// adjust outlines</span></div>
<div class="line"><a name="l21151"></a><span class="lineno">21151</span>&#160;        $tmpoutlines = $this-&gt;outlines;</div>
<div class="line"><a name="l21152"></a><span class="lineno">21152</span>&#160;        <span class="keywordflow">foreach</span> ($tmpoutlines as $key =&gt; $outline) {</div>
<div class="line"><a name="l21153"></a><span class="lineno">21153</span>&#160;            <span class="keywordflow">if</span> (!$outline[<span class="charliteral">&#39;f&#39;</span>]) {</div>
<div class="line"><a name="l21154"></a><span class="lineno">21154</span>&#160;                <span class="keywordflow">if</span> (($outline[<span class="charliteral">&#39;p&#39;</span>] &gt;= $topage) AND ($outline[<span class="charliteral">&#39;p&#39;</span>] &lt; $frompage)) {</div>
<div class="line"><a name="l21155"></a><span class="lineno">21155</span>&#160;                    $this-&gt;outlines[$key][<span class="charliteral">&#39;p&#39;</span>] = ($outline[<span class="charliteral">&#39;p&#39;</span>] + 1);</div>
<div class="line"><a name="l21156"></a><span class="lineno">21156</span>&#160;                } elseif ($outline[<span class="charliteral">&#39;p&#39;</span>] == $frompage) {</div>
<div class="line"><a name="l21157"></a><span class="lineno">21157</span>&#160;                    $this-&gt;outlines[$key][<span class="charliteral">&#39;p&#39;</span>] = $topage;</div>
<div class="line"><a name="l21158"></a><span class="lineno">21158</span>&#160;                }</div>
<div class="line"><a name="l21159"></a><span class="lineno">21159</span>&#160;            }</div>
<div class="line"><a name="l21160"></a><span class="lineno">21160</span>&#160;        }</div>
<div class="line"><a name="l21161"></a><span class="lineno">21161</span>&#160;        <span class="comment">// adjust dests</span></div>
<div class="line"><a name="l21162"></a><span class="lineno">21162</span>&#160;        $tmpdests = $this-&gt;dests;</div>
<div class="line"><a name="l21163"></a><span class="lineno">21163</span>&#160;        <span class="keywordflow">foreach</span> ($tmpdests as $key =&gt; $dest) {</div>
<div class="line"><a name="l21164"></a><span class="lineno">21164</span>&#160;            <span class="keywordflow">if</span> (!$dest[<span class="charliteral">&#39;f&#39;</span>]) {</div>
<div class="line"><a name="l21165"></a><span class="lineno">21165</span>&#160;                <span class="keywordflow">if</span> (($dest[<span class="charliteral">&#39;p&#39;</span>] &gt;= $topage) AND ($dest[<span class="charliteral">&#39;p&#39;</span>] &lt; $frompage)) {</div>
<div class="line"><a name="l21166"></a><span class="lineno">21166</span>&#160;                    $this-&gt;dests[$key][<span class="charliteral">&#39;p&#39;</span>] = ($dest[<span class="charliteral">&#39;p&#39;</span>] + 1);</div>
<div class="line"><a name="l21167"></a><span class="lineno">21167</span>&#160;                } elseif ($dest[<span class="charliteral">&#39;p&#39;</span>] == $frompage) {</div>
<div class="line"><a name="l21168"></a><span class="lineno">21168</span>&#160;                    $this-&gt;dests[$key][<span class="charliteral">&#39;p&#39;</span>] = $topage;</div>
<div class="line"><a name="l21169"></a><span class="lineno">21169</span>&#160;                }</div>
<div class="line"><a name="l21170"></a><span class="lineno">21170</span>&#160;            }</div>
<div class="line"><a name="l21171"></a><span class="lineno">21171</span>&#160;        }</div>
<div class="line"><a name="l21172"></a><span class="lineno">21172</span>&#160;        <span class="comment">// adjust links</span></div>
<div class="line"><a name="l21173"></a><span class="lineno">21173</span>&#160;        $tmplinks = $this-&gt;links;</div>
<div class="line"><a name="l21174"></a><span class="lineno">21174</span>&#160;        <span class="keywordflow">foreach</span> ($tmplinks as $key =&gt; $link) {</div>
<div class="line"><a name="l21175"></a><span class="lineno">21175</span>&#160;            <span class="keywordflow">if</span> (!$link[<span class="charliteral">&#39;f&#39;</span>]) {</div>
<div class="line"><a name="l21176"></a><span class="lineno">21176</span>&#160;                <span class="keywordflow">if</span> (($link[<span class="charliteral">&#39;p&#39;</span>] &gt;= $topage) AND ($link[<span class="charliteral">&#39;p&#39;</span>] &lt; $frompage)) {</div>
<div class="line"><a name="l21177"></a><span class="lineno">21177</span>&#160;                    $this-&gt;links[$key][<span class="charliteral">&#39;p&#39;</span>] = ($link[<span class="charliteral">&#39;p&#39;</span>] + 1);</div>
<div class="line"><a name="l21178"></a><span class="lineno">21178</span>&#160;                } elseif ($link[<span class="charliteral">&#39;p&#39;</span>] == $frompage) {</div>
<div class="line"><a name="l21179"></a><span class="lineno">21179</span>&#160;                    $this-&gt;links[$key][<span class="charliteral">&#39;p&#39;</span>] = $topage;</div>
<div class="line"><a name="l21180"></a><span class="lineno">21180</span>&#160;                }</div>
<div class="line"><a name="l21181"></a><span class="lineno">21181</span>&#160;            }</div>
<div class="line"><a name="l21182"></a><span class="lineno">21182</span>&#160;        }</div>
<div class="line"><a name="l21183"></a><span class="lineno">21183</span>&#160;        <span class="comment">// adjust javascript</span></div>
<div class="line"><a name="l21184"></a><span class="lineno">21184</span>&#160;        $jfrompage = $frompage;</div>
<div class="line"><a name="l21185"></a><span class="lineno">21185</span>&#160;        $jtopage = $topage;</div>
<div class="line"><a name="l21186"></a><span class="lineno">21186</span>&#160;        <span class="keywordflow">if</span> (preg_match_all(<span class="stringliteral">&#39;/this\.addField\(\&#39;([^\&#39;]*)\&#39;,\&#39;([^\&#39;]*)\&#39;,([0-9]+)/&#39;</span>, $this-&gt;javascript, $pamatch) &gt; 0) {</div>
<div class="line"><a name="l21187"></a><span class="lineno">21187</span>&#160;            <span class="keywordflow">foreach</span>($pamatch[0] as $pk =&gt; $pmatch) {</div>
<div class="line"><a name="l21188"></a><span class="lineno">21188</span>&#160;                $pagenum = intval($pamatch[3][$pk]) + 1;</div>
<div class="line"><a name="l21189"></a><span class="lineno">21189</span>&#160;                <span class="keywordflow">if</span> (($pagenum &gt;= $jtopage) AND ($pagenum &lt; $jfrompage)) {</div>
<div class="line"><a name="l21190"></a><span class="lineno">21190</span>&#160;                    $newpage = ($pagenum + 1);</div>
<div class="line"><a name="l21191"></a><span class="lineno">21191</span>&#160;                } elseif ($pagenum == $jfrompage) {</div>
<div class="line"><a name="l21192"></a><span class="lineno">21192</span>&#160;                    $newpage = $jtopage;</div>
<div class="line"><a name="l21193"></a><span class="lineno">21193</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l21194"></a><span class="lineno">21194</span>&#160;                    $newpage = $pagenum;</div>
<div class="line"><a name="l21195"></a><span class="lineno">21195</span>&#160;                }</div>
<div class="line"><a name="l21196"></a><span class="lineno">21196</span>&#160;                --$newpage;</div>
<div class="line"><a name="l21197"></a><span class="lineno">21197</span>&#160;                $newjs = <span class="stringliteral">&quot;this.addField(\&#39;&quot;</span>.$pamatch[1][$pk].<span class="stringliteral">&quot;\&#39;,\&#39;&quot;</span>.$pamatch[2][$pk].<span class="stringliteral">&quot;\&#39;,&quot;</span>.$newpage;</div>
<div class="line"><a name="l21198"></a><span class="lineno">21198</span>&#160;                $this-&gt;javascript = str_replace($pmatch, $newjs, $this-&gt;javascript);</div>
<div class="line"><a name="l21199"></a><span class="lineno">21199</span>&#160;            }</div>
<div class="line"><a name="l21200"></a><span class="lineno">21200</span>&#160;            unset($pamatch);</div>
<div class="line"><a name="l21201"></a><span class="lineno">21201</span>&#160;        }</div>
<div class="line"><a name="l21202"></a><span class="lineno">21202</span>&#160;        <span class="comment">// return to last page</span></div>
<div class="line"><a name="l21203"></a><span class="lineno">21203</span>&#160;        $this-&gt;lastPage(<span class="keyword">true</span>);</div>
<div class="line"><a name="l21204"></a><span class="lineno">21204</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l21205"></a><span class="lineno">21205</span>&#160;    }</div>
<div class="line"><a name="l21206"></a><span class="lineno">21206</span>&#160;</div>
<div class="line"><a name="l21214"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a33ce8521d553c47b685d61d82bffbb5c">21214</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a33ce8521d553c47b685d61d82bffbb5c">deletePage</a>($page) {</div>
<div class="line"><a name="l21215"></a><span class="lineno">21215</span>&#160;        <span class="keywordflow">if</span> (($page &lt; 1) OR ($page &gt; $this-&gt;numpages)) {</div>
<div class="line"><a name="l21216"></a><span class="lineno">21216</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l21217"></a><span class="lineno">21217</span>&#160;        }</div>
<div class="line"><a name="l21218"></a><span class="lineno">21218</span>&#160;        <span class="comment">// delete current page</span></div>
<div class="line"><a name="l21219"></a><span class="lineno">21219</span>&#160;        unset($this-&gt;pages[$page]);</div>
<div class="line"><a name="l21220"></a><span class="lineno">21220</span>&#160;        unset($this-&gt;pagedim[$page]);</div>
<div class="line"><a name="l21221"></a><span class="lineno">21221</span>&#160;        unset($this-&gt;pagelen[$page]);</div>
<div class="line"><a name="l21222"></a><span class="lineno">21222</span>&#160;        unset($this-&gt;intmrk[$page]);</div>
<div class="line"><a name="l21223"></a><span class="lineno">21223</span>&#160;        unset($this-&gt;bordermrk[$page]);</div>
<div class="line"><a name="l21224"></a><span class="lineno">21224</span>&#160;        unset($this-&gt;cntmrk[$page]);</div>
<div class="line"><a name="l21225"></a><span class="lineno">21225</span>&#160;        <span class="keywordflow">foreach</span> ($this-&gt;pageobjects[$page] as $oid) {</div>
<div class="line"><a name="l21226"></a><span class="lineno">21226</span>&#160;            <span class="keywordflow">if</span> (isset($this-&gt;offsets[$oid])){</div>
<div class="line"><a name="l21227"></a><span class="lineno">21227</span>&#160;                unset($this-&gt;offsets[$oid]);</div>
<div class="line"><a name="l21228"></a><span class="lineno">21228</span>&#160;            }</div>
<div class="line"><a name="l21229"></a><span class="lineno">21229</span>&#160;        }</div>
<div class="line"><a name="l21230"></a><span class="lineno">21230</span>&#160;        unset($this-&gt;pageobjects[$page]);</div>
<div class="line"><a name="l21231"></a><span class="lineno">21231</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;footerpos[$page])) {</div>
<div class="line"><a name="l21232"></a><span class="lineno">21232</span>&#160;            unset($this-&gt;footerpos[$page]);</div>
<div class="line"><a name="l21233"></a><span class="lineno">21233</span>&#160;        }</div>
<div class="line"><a name="l21234"></a><span class="lineno">21234</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;footerlen[$page])) {</div>
<div class="line"><a name="l21235"></a><span class="lineno">21235</span>&#160;            unset($this-&gt;footerlen[$page]);</div>
<div class="line"><a name="l21236"></a><span class="lineno">21236</span>&#160;        }</div>
<div class="line"><a name="l21237"></a><span class="lineno">21237</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;transfmrk[$page])) {</div>
<div class="line"><a name="l21238"></a><span class="lineno">21238</span>&#160;            unset($this-&gt;transfmrk[$page]);</div>
<div class="line"><a name="l21239"></a><span class="lineno">21239</span>&#160;        }</div>
<div class="line"><a name="l21240"></a><span class="lineno">21240</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;PageAnnots[$page])) {</div>
<div class="line"><a name="l21241"></a><span class="lineno">21241</span>&#160;            unset($this-&gt;PageAnnots[$page]);</div>
<div class="line"><a name="l21242"></a><span class="lineno">21242</span>&#160;        }</div>
<div class="line"><a name="l21243"></a><span class="lineno">21243</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;newpagegroup) AND !empty($this-&gt;newpagegroup)) {</div>
<div class="line"><a name="l21244"></a><span class="lineno">21244</span>&#160;            <span class="keywordflow">for</span> ($i = $page; $i &gt; 0; --$i) {</div>
<div class="line"><a name="l21245"></a><span class="lineno">21245</span>&#160;                <span class="keywordflow">if</span> (isset($this-&gt;newpagegroup[$i]) AND (($i + $this-&gt;pagegroups[$this-&gt;newpagegroup[$i]]) &gt; $page)) {</div>
<div class="line"><a name="l21246"></a><span class="lineno">21246</span>&#160;                    --$this-&gt;pagegroups[$this-&gt;newpagegroup[$i]];</div>
<div class="line"><a name="l21247"></a><span class="lineno">21247</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l21248"></a><span class="lineno">21248</span>&#160;                }</div>
<div class="line"><a name="l21249"></a><span class="lineno">21249</span>&#160;            }</div>
<div class="line"><a name="l21250"></a><span class="lineno">21250</span>&#160;        }</div>
<div class="line"><a name="l21251"></a><span class="lineno">21251</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;pageopen[$page])) {</div>
<div class="line"><a name="l21252"></a><span class="lineno">21252</span>&#160;            unset($this-&gt;pageopen[$page]);</div>
<div class="line"><a name="l21253"></a><span class="lineno">21253</span>&#160;        }</div>
<div class="line"><a name="l21254"></a><span class="lineno">21254</span>&#160;        <span class="keywordflow">if</span> ($page &lt; $this-&gt;numpages) {</div>
<div class="line"><a name="l21255"></a><span class="lineno">21255</span>&#160;            <span class="comment">// update remaining pages</span></div>
<div class="line"><a name="l21256"></a><span class="lineno">21256</span>&#160;            <span class="keywordflow">for</span> ($i = $page; $i &lt; $this-&gt;numpages; ++$i) {</div>
<div class="line"><a name="l21257"></a><span class="lineno">21257</span>&#160;                $j = $i + 1;</div>
<div class="line"><a name="l21258"></a><span class="lineno">21258</span>&#160;                <span class="comment">// shift pages</span></div>
<div class="line"><a name="l21259"></a><span class="lineno">21259</span>&#160;                $this-&gt;setPageBuffer($i, $this-&gt;getPageBuffer($j));</div>
<div class="line"><a name="l21260"></a><span class="lineno">21260</span>&#160;                $this-&gt;pagedim[$i] = $this-&gt;pagedim[$j];</div>
<div class="line"><a name="l21261"></a><span class="lineno">21261</span>&#160;                $this-&gt;pagelen[$i] = $this-&gt;pagelen[$j];</div>
<div class="line"><a name="l21262"></a><span class="lineno">21262</span>&#160;                $this-&gt;intmrk[$i] = $this-&gt;intmrk[$j];</div>
<div class="line"><a name="l21263"></a><span class="lineno">21263</span>&#160;                $this-&gt;bordermrk[$i] = $this-&gt;bordermrk[$j];</div>
<div class="line"><a name="l21264"></a><span class="lineno">21264</span>&#160;                $this-&gt;cntmrk[$i] = $this-&gt;cntmrk[$j];</div>
<div class="line"><a name="l21265"></a><span class="lineno">21265</span>&#160;                $this-&gt;pageobjects[$i] = $this-&gt;pageobjects[$j];</div>
<div class="line"><a name="l21266"></a><span class="lineno">21266</span>&#160;                <span class="keywordflow">if</span> (isset($this-&gt;footerpos[$j])) {</div>
<div class="line"><a name="l21267"></a><span class="lineno">21267</span>&#160;                    $this-&gt;footerpos[$i] = $this-&gt;footerpos[$j];</div>
<div class="line"><a name="l21268"></a><span class="lineno">21268</span>&#160;                } elseif (isset($this-&gt;footerpos[$i])) {</div>
<div class="line"><a name="l21269"></a><span class="lineno">21269</span>&#160;                    unset($this-&gt;footerpos[$i]);</div>
<div class="line"><a name="l21270"></a><span class="lineno">21270</span>&#160;                }</div>
<div class="line"><a name="l21271"></a><span class="lineno">21271</span>&#160;                <span class="keywordflow">if</span> (isset($this-&gt;footerlen[$j])) {</div>
<div class="line"><a name="l21272"></a><span class="lineno">21272</span>&#160;                    $this-&gt;footerlen[$i] = $this-&gt;footerlen[$j];</div>
<div class="line"><a name="l21273"></a><span class="lineno">21273</span>&#160;                } elseif (isset($this-&gt;footerlen[$i])) {</div>
<div class="line"><a name="l21274"></a><span class="lineno">21274</span>&#160;                    unset($this-&gt;footerlen[$i]);</div>
<div class="line"><a name="l21275"></a><span class="lineno">21275</span>&#160;                }</div>
<div class="line"><a name="l21276"></a><span class="lineno">21276</span>&#160;                <span class="keywordflow">if</span> (isset($this-&gt;transfmrk[$j])) {</div>
<div class="line"><a name="l21277"></a><span class="lineno">21277</span>&#160;                    $this-&gt;transfmrk[$i] = $this-&gt;transfmrk[$j];</div>
<div class="line"><a name="l21278"></a><span class="lineno">21278</span>&#160;                } elseif (isset($this-&gt;transfmrk[$i])) {</div>
<div class="line"><a name="l21279"></a><span class="lineno">21279</span>&#160;                    unset($this-&gt;transfmrk[$i]);</div>
<div class="line"><a name="l21280"></a><span class="lineno">21280</span>&#160;                }</div>
<div class="line"><a name="l21281"></a><span class="lineno">21281</span>&#160;                <span class="keywordflow">if</span> (isset($this-&gt;PageAnnots[$j])) {</div>
<div class="line"><a name="l21282"></a><span class="lineno">21282</span>&#160;                    $this-&gt;PageAnnots[$i] = $this-&gt;PageAnnots[$j];</div>
<div class="line"><a name="l21283"></a><span class="lineno">21283</span>&#160;                } elseif (isset($this-&gt;PageAnnots[$i])) {</div>
<div class="line"><a name="l21284"></a><span class="lineno">21284</span>&#160;                    unset($this-&gt;PageAnnots[$i]);</div>
<div class="line"><a name="l21285"></a><span class="lineno">21285</span>&#160;                }</div>
<div class="line"><a name="l21286"></a><span class="lineno">21286</span>&#160;                <span class="keywordflow">if</span> (isset($this-&gt;newpagegroup[$j])) {</div>
<div class="line"><a name="l21287"></a><span class="lineno">21287</span>&#160;                    $this-&gt;newpagegroup[$i] = $this-&gt;newpagegroup[$j];</div>
<div class="line"><a name="l21288"></a><span class="lineno">21288</span>&#160;                    unset($this-&gt;newpagegroup[$j]);</div>
<div class="line"><a name="l21289"></a><span class="lineno">21289</span>&#160;                }</div>
<div class="line"><a name="l21290"></a><span class="lineno">21290</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;currpagegroup == $j) {</div>
<div class="line"><a name="l21291"></a><span class="lineno">21291</span>&#160;                    $this-&gt;currpagegroup = $i;</div>
<div class="line"><a name="l21292"></a><span class="lineno">21292</span>&#160;                }</div>
<div class="line"><a name="l21293"></a><span class="lineno">21293</span>&#160;                <span class="keywordflow">if</span> (isset($this-&gt;pageopen[$j])) {</div>
<div class="line"><a name="l21294"></a><span class="lineno">21294</span>&#160;                    $this-&gt;pageopen[$i] = $this-&gt;pageopen[$j];</div>
<div class="line"><a name="l21295"></a><span class="lineno">21295</span>&#160;                } elseif (isset($this-&gt;pageopen[$i])) {</div>
<div class="line"><a name="l21296"></a><span class="lineno">21296</span>&#160;                    unset($this-&gt;pageopen[$i]);</div>
<div class="line"><a name="l21297"></a><span class="lineno">21297</span>&#160;                }</div>
<div class="line"><a name="l21298"></a><span class="lineno">21298</span>&#160;            }</div>
<div class="line"><a name="l21299"></a><span class="lineno">21299</span>&#160;            <span class="comment">// remove last page</span></div>
<div class="line"><a name="l21300"></a><span class="lineno">21300</span>&#160;            unset($this-&gt;pages[$this-&gt;numpages]);</div>
<div class="line"><a name="l21301"></a><span class="lineno">21301</span>&#160;            unset($this-&gt;pagedim[$this-&gt;numpages]);</div>
<div class="line"><a name="l21302"></a><span class="lineno">21302</span>&#160;            unset($this-&gt;pagelen[$this-&gt;numpages]);</div>
<div class="line"><a name="l21303"></a><span class="lineno">21303</span>&#160;            unset($this-&gt;intmrk[$this-&gt;numpages]);</div>
<div class="line"><a name="l21304"></a><span class="lineno">21304</span>&#160;            unset($this-&gt;bordermrk[$this-&gt;numpages]);</div>
<div class="line"><a name="l21305"></a><span class="lineno">21305</span>&#160;            unset($this-&gt;cntmrk[$this-&gt;numpages]);</div>
<div class="line"><a name="l21306"></a><span class="lineno">21306</span>&#160;            <span class="keywordflow">foreach</span> ($this-&gt;pageobjects[$this-&gt;numpages] as $oid) {</div>
<div class="line"><a name="l21307"></a><span class="lineno">21307</span>&#160;                <span class="keywordflow">if</span> (isset($this-&gt;offsets[$oid])){</div>
<div class="line"><a name="l21308"></a><span class="lineno">21308</span>&#160;                    unset($this-&gt;offsets[$oid]);</div>
<div class="line"><a name="l21309"></a><span class="lineno">21309</span>&#160;                }</div>
<div class="line"><a name="l21310"></a><span class="lineno">21310</span>&#160;            }</div>
<div class="line"><a name="l21311"></a><span class="lineno">21311</span>&#160;            unset($this-&gt;pageobjects[$this-&gt;numpages]);</div>
<div class="line"><a name="l21312"></a><span class="lineno">21312</span>&#160;            <span class="keywordflow">if</span> (isset($this-&gt;footerpos[$this-&gt;numpages])) {</div>
<div class="line"><a name="l21313"></a><span class="lineno">21313</span>&#160;                unset($this-&gt;footerpos[$this-&gt;numpages]);</div>
<div class="line"><a name="l21314"></a><span class="lineno">21314</span>&#160;            }</div>
<div class="line"><a name="l21315"></a><span class="lineno">21315</span>&#160;            <span class="keywordflow">if</span> (isset($this-&gt;footerlen[$this-&gt;numpages])) {</div>
<div class="line"><a name="l21316"></a><span class="lineno">21316</span>&#160;                unset($this-&gt;footerlen[$this-&gt;numpages]);</div>
<div class="line"><a name="l21317"></a><span class="lineno">21317</span>&#160;            }</div>
<div class="line"><a name="l21318"></a><span class="lineno">21318</span>&#160;            <span class="keywordflow">if</span> (isset($this-&gt;transfmrk[$this-&gt;numpages])) {</div>
<div class="line"><a name="l21319"></a><span class="lineno">21319</span>&#160;                unset($this-&gt;transfmrk[$this-&gt;numpages]);</div>
<div class="line"><a name="l21320"></a><span class="lineno">21320</span>&#160;            }</div>
<div class="line"><a name="l21321"></a><span class="lineno">21321</span>&#160;            <span class="keywordflow">if</span> (isset($this-&gt;PageAnnots[$this-&gt;numpages])) {</div>
<div class="line"><a name="l21322"></a><span class="lineno">21322</span>&#160;                unset($this-&gt;PageAnnots[$this-&gt;numpages]);</div>
<div class="line"><a name="l21323"></a><span class="lineno">21323</span>&#160;            }</div>
<div class="line"><a name="l21324"></a><span class="lineno">21324</span>&#160;            <span class="keywordflow">if</span> (isset($this-&gt;newpagegroup[$this-&gt;numpages])) {</div>
<div class="line"><a name="l21325"></a><span class="lineno">21325</span>&#160;                unset($this-&gt;newpagegroup[$this-&gt;numpages]);</div>
<div class="line"><a name="l21326"></a><span class="lineno">21326</span>&#160;            }</div>
<div class="line"><a name="l21327"></a><span class="lineno">21327</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;currpagegroup == $this-&gt;numpages) {</div>
<div class="line"><a name="l21328"></a><span class="lineno">21328</span>&#160;                $this-&gt;currpagegroup = ($this-&gt;numpages - 1);</div>
<div class="line"><a name="l21329"></a><span class="lineno">21329</span>&#160;            }</div>
<div class="line"><a name="l21330"></a><span class="lineno">21330</span>&#160;            <span class="keywordflow">if</span> (isset($this-&gt;pagegroups[$this-&gt;numpages])) {</div>
<div class="line"><a name="l21331"></a><span class="lineno">21331</span>&#160;                unset($this-&gt;pagegroups[$this-&gt;numpages]);</div>
<div class="line"><a name="l21332"></a><span class="lineno">21332</span>&#160;            }</div>
<div class="line"><a name="l21333"></a><span class="lineno">21333</span>&#160;            <span class="keywordflow">if</span> (isset($this-&gt;pageopen[$this-&gt;numpages])) {</div>
<div class="line"><a name="l21334"></a><span class="lineno">21334</span>&#160;                unset($this-&gt;pageopen[$this-&gt;numpages]);</div>
<div class="line"><a name="l21335"></a><span class="lineno">21335</span>&#160;            }</div>
<div class="line"><a name="l21336"></a><span class="lineno">21336</span>&#160;        }</div>
<div class="line"><a name="l21337"></a><span class="lineno">21337</span>&#160;        --$this-&gt;numpages;</div>
<div class="line"><a name="l21338"></a><span class="lineno">21338</span>&#160;        $this-&gt;page = $this-&gt;numpages;</div>
<div class="line"><a name="l21339"></a><span class="lineno">21339</span>&#160;        <span class="comment">// adjust outlines</span></div>
<div class="line"><a name="l21340"></a><span class="lineno">21340</span>&#160;        $tmpoutlines = $this-&gt;outlines;</div>
<div class="line"><a name="l21341"></a><span class="lineno">21341</span>&#160;        <span class="keywordflow">foreach</span> ($tmpoutlines as $key =&gt; $outline) {</div>
<div class="line"><a name="l21342"></a><span class="lineno">21342</span>&#160;            <span class="keywordflow">if</span> (!$outline[<span class="charliteral">&#39;f&#39;</span>]) {</div>
<div class="line"><a name="l21343"></a><span class="lineno">21343</span>&#160;                <span class="keywordflow">if</span> ($outline[<span class="charliteral">&#39;p&#39;</span>] &gt; $page) {</div>
<div class="line"><a name="l21344"></a><span class="lineno">21344</span>&#160;                    $this-&gt;outlines[$key][<span class="charliteral">&#39;p&#39;</span>] = $outline[<span class="charliteral">&#39;p&#39;</span>] - 1;</div>
<div class="line"><a name="l21345"></a><span class="lineno">21345</span>&#160;                } elseif ($outline[<span class="charliteral">&#39;p&#39;</span>] == $page) {</div>
<div class="line"><a name="l21346"></a><span class="lineno">21346</span>&#160;                    unset($this-&gt;outlines[$key]);</div>
<div class="line"><a name="l21347"></a><span class="lineno">21347</span>&#160;                }</div>
<div class="line"><a name="l21348"></a><span class="lineno">21348</span>&#160;            }</div>
<div class="line"><a name="l21349"></a><span class="lineno">21349</span>&#160;        }</div>
<div class="line"><a name="l21350"></a><span class="lineno">21350</span>&#160;        <span class="comment">// adjust dests</span></div>
<div class="line"><a name="l21351"></a><span class="lineno">21351</span>&#160;        $tmpdests = $this-&gt;dests;</div>
<div class="line"><a name="l21352"></a><span class="lineno">21352</span>&#160;        <span class="keywordflow">foreach</span> ($tmpdests as $key =&gt; $dest) {</div>
<div class="line"><a name="l21353"></a><span class="lineno">21353</span>&#160;            <span class="keywordflow">if</span> (!$dest[<span class="charliteral">&#39;f&#39;</span>]) {</div>
<div class="line"><a name="l21354"></a><span class="lineno">21354</span>&#160;                <span class="keywordflow">if</span> ($dest[<span class="charliteral">&#39;p&#39;</span>] &gt; $page) {</div>
<div class="line"><a name="l21355"></a><span class="lineno">21355</span>&#160;                    $this-&gt;dests[$key][<span class="charliteral">&#39;p&#39;</span>] = $dest[<span class="charliteral">&#39;p&#39;</span>] - 1;</div>
<div class="line"><a name="l21356"></a><span class="lineno">21356</span>&#160;                } elseif ($dest[<span class="charliteral">&#39;p&#39;</span>] == $page) {</div>
<div class="line"><a name="l21357"></a><span class="lineno">21357</span>&#160;                    unset($this-&gt;dests[$key]);</div>
<div class="line"><a name="l21358"></a><span class="lineno">21358</span>&#160;                }</div>
<div class="line"><a name="l21359"></a><span class="lineno">21359</span>&#160;            }</div>
<div class="line"><a name="l21360"></a><span class="lineno">21360</span>&#160;        }</div>
<div class="line"><a name="l21361"></a><span class="lineno">21361</span>&#160;        <span class="comment">// adjust links</span></div>
<div class="line"><a name="l21362"></a><span class="lineno">21362</span>&#160;        $tmplinks = $this-&gt;links;</div>
<div class="line"><a name="l21363"></a><span class="lineno">21363</span>&#160;        <span class="keywordflow">foreach</span> ($tmplinks as $key =&gt; $link) {</div>
<div class="line"><a name="l21364"></a><span class="lineno">21364</span>&#160;            <span class="keywordflow">if</span> (!$link[<span class="charliteral">&#39;f&#39;</span>]) {</div>
<div class="line"><a name="l21365"></a><span class="lineno">21365</span>&#160;                <span class="keywordflow">if</span> ($link[<span class="charliteral">&#39;p&#39;</span>] &gt; $page) {</div>
<div class="line"><a name="l21366"></a><span class="lineno">21366</span>&#160;                    $this-&gt;links[$key][<span class="charliteral">&#39;p&#39;</span>] = $link[<span class="charliteral">&#39;p&#39;</span>] - 1;</div>
<div class="line"><a name="l21367"></a><span class="lineno">21367</span>&#160;                } elseif ($link[<span class="charliteral">&#39;p&#39;</span>] == $page) {</div>
<div class="line"><a name="l21368"></a><span class="lineno">21368</span>&#160;                    unset($this-&gt;links[$key]);</div>
<div class="line"><a name="l21369"></a><span class="lineno">21369</span>&#160;                }</div>
<div class="line"><a name="l21370"></a><span class="lineno">21370</span>&#160;            }</div>
<div class="line"><a name="l21371"></a><span class="lineno">21371</span>&#160;        }</div>
<div class="line"><a name="l21372"></a><span class="lineno">21372</span>&#160;        <span class="comment">// adjust javascript</span></div>
<div class="line"><a name="l21373"></a><span class="lineno">21373</span>&#160;        $jpage = $page;</div>
<div class="line"><a name="l21374"></a><span class="lineno">21374</span>&#160;        <span class="keywordflow">if</span> (preg_match_all(<span class="stringliteral">&#39;/this\.addField\(\&#39;([^\&#39;]*)\&#39;,\&#39;([^\&#39;]*)\&#39;,([0-9]+)/&#39;</span>, $this-&gt;javascript, $pamatch) &gt; 0) {</div>
<div class="line"><a name="l21375"></a><span class="lineno">21375</span>&#160;            <span class="keywordflow">foreach</span>($pamatch[0] as $pk =&gt; $pmatch) {</div>
<div class="line"><a name="l21376"></a><span class="lineno">21376</span>&#160;                $pagenum = intval($pamatch[3][$pk]) + 1;</div>
<div class="line"><a name="l21377"></a><span class="lineno">21377</span>&#160;                <span class="keywordflow">if</span> ($pagenum &gt;= $jpage) {</div>
<div class="line"><a name="l21378"></a><span class="lineno">21378</span>&#160;                    $newpage = ($pagenum - 1);</div>
<div class="line"><a name="l21379"></a><span class="lineno">21379</span>&#160;                } elseif ($pagenum == $jpage) {</div>
<div class="line"><a name="l21380"></a><span class="lineno">21380</span>&#160;                    $newpage = 1;</div>
<div class="line"><a name="l21381"></a><span class="lineno">21381</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l21382"></a><span class="lineno">21382</span>&#160;                    $newpage = $pagenum;</div>
<div class="line"><a name="l21383"></a><span class="lineno">21383</span>&#160;                }</div>
<div class="line"><a name="l21384"></a><span class="lineno">21384</span>&#160;                --$newpage;</div>
<div class="line"><a name="l21385"></a><span class="lineno">21385</span>&#160;                $newjs = <span class="stringliteral">&quot;this.addField(\&#39;&quot;</span>.$pamatch[1][$pk].<span class="stringliteral">&quot;\&#39;,\&#39;&quot;</span>.$pamatch[2][$pk].<span class="stringliteral">&quot;\&#39;,&quot;</span>.$newpage;</div>
<div class="line"><a name="l21386"></a><span class="lineno">21386</span>&#160;                $this-&gt;javascript = str_replace($pmatch, $newjs, $this-&gt;javascript);</div>
<div class="line"><a name="l21387"></a><span class="lineno">21387</span>&#160;            }</div>
<div class="line"><a name="l21388"></a><span class="lineno">21388</span>&#160;            unset($pamatch);</div>
<div class="line"><a name="l21389"></a><span class="lineno">21389</span>&#160;        }</div>
<div class="line"><a name="l21390"></a><span class="lineno">21390</span>&#160;        <span class="comment">// return to last page</span></div>
<div class="line"><a name="l21391"></a><span class="lineno">21391</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;numpages &gt; 0) {</div>
<div class="line"><a name="l21392"></a><span class="lineno">21392</span>&#160;            $this-&gt;lastPage(<span class="keyword">true</span>);</div>
<div class="line"><a name="l21393"></a><span class="lineno">21393</span>&#160;        }</div>
<div class="line"><a name="l21394"></a><span class="lineno">21394</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l21395"></a><span class="lineno">21395</span>&#160;    }</div>
<div class="line"><a name="l21396"></a><span class="lineno">21396</span>&#160;</div>
<div class="line"><a name="l21404"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a2e1b92a30f94f161fe51c8ce232885d2">21404</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a2e1b92a30f94f161fe51c8ce232885d2">copyPage</a>($page=0) {</div>
<div class="line"><a name="l21405"></a><span class="lineno">21405</span>&#160;        <span class="keywordflow">if</span> ($page == 0) {</div>
<div class="line"><a name="l21406"></a><span class="lineno">21406</span>&#160;            <span class="comment">// default value</span></div>
<div class="line"><a name="l21407"></a><span class="lineno">21407</span>&#160;            $page = $this-&gt;page;</div>
<div class="line"><a name="l21408"></a><span class="lineno">21408</span>&#160;        }</div>
<div class="line"><a name="l21409"></a><span class="lineno">21409</span>&#160;        <span class="keywordflow">if</span> (($page &lt; 1) OR ($page &gt; $this-&gt;numpages)) {</div>
<div class="line"><a name="l21410"></a><span class="lineno">21410</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l21411"></a><span class="lineno">21411</span>&#160;        }</div>
<div class="line"><a name="l21412"></a><span class="lineno">21412</span>&#160;        <span class="comment">// close the last page</span></div>
<div class="line"><a name="l21413"></a><span class="lineno">21413</span>&#160;        $this-&gt;endPage();</div>
<div class="line"><a name="l21414"></a><span class="lineno">21414</span>&#160;        <span class="comment">// copy all page-related states</span></div>
<div class="line"><a name="l21415"></a><span class="lineno">21415</span>&#160;        ++$this-&gt;numpages;</div>
<div class="line"><a name="l21416"></a><span class="lineno">21416</span>&#160;        $this-&gt;page = $this-&gt;numpages;</div>
<div class="line"><a name="l21417"></a><span class="lineno">21417</span>&#160;        $this-&gt;setPageBuffer($this-&gt;page, $this-&gt;getPageBuffer($page));</div>
<div class="line"><a name="l21418"></a><span class="lineno">21418</span>&#160;        $this-&gt;pagedim[$this-&gt;page] = $this-&gt;pagedim[$page];</div>
<div class="line"><a name="l21419"></a><span class="lineno">21419</span>&#160;        $this-&gt;pagelen[$this-&gt;page] = $this-&gt;pagelen[$page];</div>
<div class="line"><a name="l21420"></a><span class="lineno">21420</span>&#160;        $this-&gt;intmrk[$this-&gt;page] = $this-&gt;intmrk[$page];</div>
<div class="line"><a name="l21421"></a><span class="lineno">21421</span>&#160;        $this-&gt;bordermrk[$this-&gt;page] = $this-&gt;bordermrk[$page];</div>
<div class="line"><a name="l21422"></a><span class="lineno">21422</span>&#160;        $this-&gt;cntmrk[$this-&gt;page] = $this-&gt;cntmrk[$page];</div>
<div class="line"><a name="l21423"></a><span class="lineno">21423</span>&#160;        $this-&gt;pageobjects[$this-&gt;page] = $this-&gt;pageobjects[$page];</div>
<div class="line"><a name="l21424"></a><span class="lineno">21424</span>&#160;        $this-&gt;pageopen[$this-&gt;page] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l21425"></a><span class="lineno">21425</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;footerpos[$page])) {</div>
<div class="line"><a name="l21426"></a><span class="lineno">21426</span>&#160;            $this-&gt;footerpos[$this-&gt;page] = $this-&gt;footerpos[$page];</div>
<div class="line"><a name="l21427"></a><span class="lineno">21427</span>&#160;        }</div>
<div class="line"><a name="l21428"></a><span class="lineno">21428</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;footerlen[$page])) {</div>
<div class="line"><a name="l21429"></a><span class="lineno">21429</span>&#160;            $this-&gt;footerlen[$this-&gt;page] = $this-&gt;footerlen[$page];</div>
<div class="line"><a name="l21430"></a><span class="lineno">21430</span>&#160;        }</div>
<div class="line"><a name="l21431"></a><span class="lineno">21431</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;transfmrk[$page])) {</div>
<div class="line"><a name="l21432"></a><span class="lineno">21432</span>&#160;            $this-&gt;transfmrk[$this-&gt;page] = $this-&gt;transfmrk[$page];</div>
<div class="line"><a name="l21433"></a><span class="lineno">21433</span>&#160;        }</div>
<div class="line"><a name="l21434"></a><span class="lineno">21434</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;PageAnnots[$page])) {</div>
<div class="line"><a name="l21435"></a><span class="lineno">21435</span>&#160;            $this-&gt;PageAnnots[$this-&gt;page] = $this-&gt;PageAnnots[$page];</div>
<div class="line"><a name="l21436"></a><span class="lineno">21436</span>&#160;        }</div>
<div class="line"><a name="l21437"></a><span class="lineno">21437</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;newpagegroup[$page])) {</div>
<div class="line"><a name="l21438"></a><span class="lineno">21438</span>&#160;            <span class="comment">// start a new group</span></div>
<div class="line"><a name="l21439"></a><span class="lineno">21439</span>&#160;            $this-&gt;newpagegroup[$this-&gt;page] = <span class="keyword">sizeof</span>($this-&gt;newpagegroup) + 1;</div>
<div class="line"><a name="l21440"></a><span class="lineno">21440</span>&#160;            $this-&gt;currpagegroup = $this-&gt;newpagegroup[$this-&gt;page];</div>
<div class="line"><a name="l21441"></a><span class="lineno">21441</span>&#160;            $this-&gt;pagegroups[$this-&gt;currpagegroup] = 1;</div>
<div class="line"><a name="l21442"></a><span class="lineno">21442</span>&#160;        } elseif (isset($this-&gt;currpagegroup) AND ($this-&gt;currpagegroup &gt; 0)) {</div>
<div class="line"><a name="l21443"></a><span class="lineno">21443</span>&#160;            ++$this-&gt;pagegroups[$this-&gt;currpagegroup];</div>
<div class="line"><a name="l21444"></a><span class="lineno">21444</span>&#160;        }</div>
<div class="line"><a name="l21445"></a><span class="lineno">21445</span>&#160;        <span class="comment">// copy outlines</span></div>
<div class="line"><a name="l21446"></a><span class="lineno">21446</span>&#160;        $tmpoutlines = $this-&gt;outlines;</div>
<div class="line"><a name="l21447"></a><span class="lineno">21447</span>&#160;        <span class="keywordflow">foreach</span> ($tmpoutlines as $key =&gt; $outline) {</div>
<div class="line"><a name="l21448"></a><span class="lineno">21448</span>&#160;            <span class="keywordflow">if</span> ($outline[<span class="charliteral">&#39;p&#39;</span>] == $page) {</div>
<div class="line"><a name="l21449"></a><span class="lineno">21449</span>&#160;                $this-&gt;outlines[] = array(<span class="charliteral">&#39;t&#39;</span> =&gt; $outline[<span class="charliteral">&#39;t&#39;</span>], <span class="charliteral">&#39;l&#39;</span> =&gt; $outline[<span class="charliteral">&#39;l&#39;</span>], <span class="charliteral">&#39;x&#39;</span> =&gt; $outline[<span class="charliteral">&#39;x&#39;</span>], <span class="charliteral">&#39;y&#39;</span> =&gt; $outline[<span class="charliteral">&#39;y&#39;</span>], <span class="charliteral">&#39;p&#39;</span> =&gt; $this-&gt;page, <span class="charliteral">&#39;f&#39;</span> =&gt; $outline[<span class="charliteral">&#39;f&#39;</span>], <span class="charliteral">&#39;s&#39;</span> =&gt; $outline[<span class="charliteral">&#39;s&#39;</span>], <span class="charliteral">&#39;c&#39;</span> =&gt; $outline[<span class="charliteral">&#39;c&#39;</span>]);</div>
<div class="line"><a name="l21450"></a><span class="lineno">21450</span>&#160;            }</div>
<div class="line"><a name="l21451"></a><span class="lineno">21451</span>&#160;        }</div>
<div class="line"><a name="l21452"></a><span class="lineno">21452</span>&#160;        <span class="comment">// copy links</span></div>
<div class="line"><a name="l21453"></a><span class="lineno">21453</span>&#160;        $tmplinks = $this-&gt;links;</div>
<div class="line"><a name="l21454"></a><span class="lineno">21454</span>&#160;        <span class="keywordflow">foreach</span> ($tmplinks as $key =&gt; $link) {</div>
<div class="line"><a name="l21455"></a><span class="lineno">21455</span>&#160;            <span class="keywordflow">if</span> ($link[<span class="charliteral">&#39;p&#39;</span>] == $page) {</div>
<div class="line"><a name="l21456"></a><span class="lineno">21456</span>&#160;                $this-&gt;links[] = array(<span class="charliteral">&#39;p&#39;</span> =&gt; $this-&gt;page, <span class="charliteral">&#39;y&#39;</span> =&gt; $link[<span class="charliteral">&#39;y&#39;</span>], <span class="charliteral">&#39;f&#39;</span> =&gt; $link[<span class="charliteral">&#39;f&#39;</span>]);</div>
<div class="line"><a name="l21457"></a><span class="lineno">21457</span>&#160;            }</div>
<div class="line"><a name="l21458"></a><span class="lineno">21458</span>&#160;        }</div>
<div class="line"><a name="l21459"></a><span class="lineno">21459</span>&#160;        <span class="comment">// return to last page</span></div>
<div class="line"><a name="l21460"></a><span class="lineno">21460</span>&#160;        $this-&gt;lastPage(<span class="keyword">true</span>);</div>
<div class="line"><a name="l21461"></a><span class="lineno">21461</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l21462"></a><span class="lineno">21462</span>&#160;    }</div>
<div class="line"><a name="l21463"></a><span class="lineno">21463</span>&#160;</div>
<div class="line"><a name="l21481"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ae6ad7850d488bb6c9b32a688f7b4c241">21481</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ae6ad7850d488bb6c9b32a688f7b4c241">addTOC</a>($page=<span class="stringliteral">&#39;&#39;</span>, $numbersfont=<span class="stringliteral">&#39;&#39;</span>, $filler=<span class="charliteral">&#39;.&#39;</span>, $toc_name=<span class="stringliteral">&#39;TOC&#39;</span>, $style=<span class="stringliteral">&#39;&#39;</span>, $color=array(0,0,0)) {</div>
<div class="line"><a name="l21482"></a><span class="lineno">21482</span>&#160;        $fontsize = $this-&gt;FontSizePt;</div>
<div class="line"><a name="l21483"></a><span class="lineno">21483</span>&#160;        $fontfamily = $this-&gt;FontFamily;</div>
<div class="line"><a name="l21484"></a><span class="lineno">21484</span>&#160;        $fontstyle = $this-&gt;FontStyle;</div>
<div class="line"><a name="l21485"></a><span class="lineno">21485</span>&#160;        $w = $this-&gt;w - $this-&gt;lMargin - $this-&gt;rMargin;</div>
<div class="line"><a name="l21486"></a><span class="lineno">21486</span>&#160;        $spacer = $this-&gt;GetStringWidth(chr(32)) * 4;</div>
<div class="line"><a name="l21487"></a><span class="lineno">21487</span>&#160;        $lmargin = $this-&gt;lMargin;</div>
<div class="line"><a name="l21488"></a><span class="lineno">21488</span>&#160;        $rmargin = $this-&gt;rMargin;</div>
<div class="line"><a name="l21489"></a><span class="lineno">21489</span>&#160;        $x_start = $this-&gt;GetX();</div>
<div class="line"><a name="l21490"></a><span class="lineno">21490</span>&#160;        $page_first = $this-&gt;page;</div>
<div class="line"><a name="l21491"></a><span class="lineno">21491</span>&#160;        $current_page = $this-&gt;page;</div>
<div class="line"><a name="l21492"></a><span class="lineno">21492</span>&#160;        $page_fill_start = <span class="keyword">false</span>;</div>
<div class="line"><a name="l21493"></a><span class="lineno">21493</span>&#160;        $page_fill_end = <span class="keyword">false</span>;</div>
<div class="line"><a name="l21494"></a><span class="lineno">21494</span>&#160;        $current_column = $this-&gt;current_column;</div>
<div class="line"><a name="l21495"></a><span class="lineno">21495</span>&#160;        <span class="keywordflow">if</span> (TCPDF_STATIC::empty_string($numbersfont)) {</div>
<div class="line"><a name="l21496"></a><span class="lineno">21496</span>&#160;            $numbersfont = $this-&gt;default_monospaced_font;</div>
<div class="line"><a name="l21497"></a><span class="lineno">21497</span>&#160;        }</div>
<div class="line"><a name="l21498"></a><span class="lineno">21498</span>&#160;        <span class="keywordflow">if</span> (TCPDF_STATIC::empty_string($filler)) {</div>
<div class="line"><a name="l21499"></a><span class="lineno">21499</span>&#160;            $filler = <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l21500"></a><span class="lineno">21500</span>&#160;        }</div>
<div class="line"><a name="l21501"></a><span class="lineno">21501</span>&#160;        <span class="keywordflow">if</span> (TCPDF_STATIC::empty_string($page)) {</div>
<div class="line"><a name="l21502"></a><span class="lineno">21502</span>&#160;            $gap = <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l21503"></a><span class="lineno">21503</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l21504"></a><span class="lineno">21504</span>&#160;            $gap = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l21505"></a><span class="lineno">21505</span>&#160;            <span class="keywordflow">if</span> ($page &lt; 1) {</div>
<div class="line"><a name="l21506"></a><span class="lineno">21506</span>&#160;                $page = 1;</div>
<div class="line"><a name="l21507"></a><span class="lineno">21507</span>&#160;            }</div>
<div class="line"><a name="l21508"></a><span class="lineno">21508</span>&#160;        }</div>
<div class="line"><a name="l21509"></a><span class="lineno">21509</span>&#160;        $this-&gt;SetFont($numbersfont, $fontstyle, $fontsize);</div>
<div class="line"><a name="l21510"></a><span class="lineno">21510</span>&#160;        $numwidth = $this-&gt;GetStringWidth(<span class="stringliteral">&#39;00000&#39;</span>);</div>
<div class="line"><a name="l21511"></a><span class="lineno">21511</span>&#160;        $maxpage = 0; <span class="comment">//used for pages on attached documents</span></div>
<div class="line"><a name="l21512"></a><span class="lineno">21512</span>&#160;        <span class="keywordflow">foreach</span> ($this-&gt;outlines as $key =&gt; $outline) {</div>
<div class="line"><a name="l21513"></a><span class="lineno">21513</span>&#160;            <span class="comment">// check for extra pages (used for attachments)</span></div>
<div class="line"><a name="l21514"></a><span class="lineno">21514</span>&#160;            <span class="keywordflow">if</span> (($this-&gt;page &gt; $page_first) AND ($outline[<span class="charliteral">&#39;p&#39;</span>] &gt;= $this-&gt;numpages)) {</div>
<div class="line"><a name="l21515"></a><span class="lineno">21515</span>&#160;                $outline[<span class="charliteral">&#39;p&#39;</span>] += ($this-&gt;page - $page_first);</div>
<div class="line"><a name="l21516"></a><span class="lineno">21516</span>&#160;            }</div>
<div class="line"><a name="l21517"></a><span class="lineno">21517</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l21518"></a><span class="lineno">21518</span>&#160;                $aligntext = <span class="charliteral">&#39;R&#39;</span>;</div>
<div class="line"><a name="l21519"></a><span class="lineno">21519</span>&#160;                $alignnum = <span class="charliteral">&#39;L&#39;</span>;</div>
<div class="line"><a name="l21520"></a><span class="lineno">21520</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l21521"></a><span class="lineno">21521</span>&#160;                $aligntext = <span class="charliteral">&#39;L&#39;</span>;</div>
<div class="line"><a name="l21522"></a><span class="lineno">21522</span>&#160;                $alignnum = <span class="charliteral">&#39;R&#39;</span>;</div>
<div class="line"><a name="l21523"></a><span class="lineno">21523</span>&#160;            }</div>
<div class="line"><a name="l21524"></a><span class="lineno">21524</span>&#160;            <span class="keywordflow">if</span> ($outline[<span class="charliteral">&#39;l&#39;</span>] == 0) {</div>
<div class="line"><a name="l21525"></a><span class="lineno">21525</span>&#160;                $this-&gt;SetFont($fontfamily, $outline[<span class="charliteral">&#39;s&#39;</span>].<span class="charliteral">&#39;B&#39;</span>, $fontsize);</div>
<div class="line"><a name="l21526"></a><span class="lineno">21526</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l21527"></a><span class="lineno">21527</span>&#160;                $this-&gt;SetFont($fontfamily, $outline[<span class="charliteral">&#39;s&#39;</span>], $fontsize - $outline[<span class="charliteral">&#39;l&#39;</span>]);</div>
<div class="line"><a name="l21528"></a><span class="lineno">21528</span>&#160;            }</div>
<div class="line"><a name="l21529"></a><span class="lineno">21529</span>&#160;            $this-&gt;SetTextColorArray($outline[<span class="charliteral">&#39;c&#39;</span>]);</div>
<div class="line"><a name="l21530"></a><span class="lineno">21530</span>&#160;            <span class="comment">// check for page break</span></div>
<div class="line"><a name="l21531"></a><span class="lineno">21531</span>&#160;            $this-&gt;checkPageBreak(2 * $this-&gt;getCellHeight($this-&gt;FontSize));</div>
<div class="line"><a name="l21532"></a><span class="lineno">21532</span>&#160;            <span class="comment">// set margins and X position</span></div>
<div class="line"><a name="l21533"></a><span class="lineno">21533</span>&#160;            <span class="keywordflow">if</span> (($this-&gt;page == $current_page) AND ($this-&gt;current_column == $current_column)) {</div>
<div class="line"><a name="l21534"></a><span class="lineno">21534</span>&#160;                $this-&gt;lMargin = $lmargin;</div>
<div class="line"><a name="l21535"></a><span class="lineno">21535</span>&#160;                $this-&gt;rMargin = $rmargin;</div>
<div class="line"><a name="l21536"></a><span class="lineno">21536</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l21537"></a><span class="lineno">21537</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;current_column != $current_column) {</div>
<div class="line"><a name="l21538"></a><span class="lineno">21538</span>&#160;                    <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l21539"></a><span class="lineno">21539</span>&#160;                        $x_start = $this-&gt;w - $this-&gt;columns[$this-&gt;current_column][<span class="charliteral">&#39;x&#39;</span>];</div>
<div class="line"><a name="l21540"></a><span class="lineno">21540</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l21541"></a><span class="lineno">21541</span>&#160;                        $x_start = $this-&gt;columns[$this-&gt;current_column][<span class="charliteral">&#39;x&#39;</span>];</div>
<div class="line"><a name="l21542"></a><span class="lineno">21542</span>&#160;                    }</div>
<div class="line"><a name="l21543"></a><span class="lineno">21543</span>&#160;                }</div>
<div class="line"><a name="l21544"></a><span class="lineno">21544</span>&#160;                $lmargin = $this-&gt;lMargin;</div>
<div class="line"><a name="l21545"></a><span class="lineno">21545</span>&#160;                $rmargin = $this-&gt;rMargin;</div>
<div class="line"><a name="l21546"></a><span class="lineno">21546</span>&#160;                $current_page = $this-&gt;page;</div>
<div class="line"><a name="l21547"></a><span class="lineno">21547</span>&#160;                $current_column = $this-&gt;current_column;</div>
<div class="line"><a name="l21548"></a><span class="lineno">21548</span>&#160;            }</div>
<div class="line"><a name="l21549"></a><span class="lineno">21549</span>&#160;            $this-&gt;SetX($x_start);</div>
<div class="line"><a name="l21550"></a><span class="lineno">21550</span>&#160;            $indent = ($spacer * $outline[<span class="charliteral">&#39;l&#39;</span>]);</div>
<div class="line"><a name="l21551"></a><span class="lineno">21551</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l21552"></a><span class="lineno">21552</span>&#160;                $this-&gt;x -= $indent;</div>
<div class="line"><a name="l21553"></a><span class="lineno">21553</span>&#160;                $this-&gt;rMargin = $this-&gt;w - $this-&gt;x;</div>
<div class="line"><a name="l21554"></a><span class="lineno">21554</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l21555"></a><span class="lineno">21555</span>&#160;                $this-&gt;x += $indent;</div>
<div class="line"><a name="l21556"></a><span class="lineno">21556</span>&#160;                $this-&gt;lMargin = $this-&gt;x;</div>
<div class="line"><a name="l21557"></a><span class="lineno">21557</span>&#160;            }</div>
<div class="line"><a name="l21558"></a><span class="lineno">21558</span>&#160;            $link = $this-&gt;AddLink();</div>
<div class="line"><a name="l21559"></a><span class="lineno">21559</span>&#160;            $this-&gt;SetLink($link, $outline[<span class="charliteral">&#39;y&#39;</span>], $outline[<span class="charliteral">&#39;p&#39;</span>]);</div>
<div class="line"><a name="l21560"></a><span class="lineno">21560</span>&#160;            <span class="comment">// write the text</span></div>
<div class="line"><a name="l21561"></a><span class="lineno">21561</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l21562"></a><span class="lineno">21562</span>&#160;                $txt = <span class="charliteral">&#39; &#39;</span>.$outline[<span class="charliteral">&#39;t&#39;</span>];</div>
<div class="line"><a name="l21563"></a><span class="lineno">21563</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l21564"></a><span class="lineno">21564</span>&#160;                $txt = $outline[<span class="charliteral">&#39;t&#39;</span>].<span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l21565"></a><span class="lineno">21565</span>&#160;            }</div>
<div class="line"><a name="l21566"></a><span class="lineno">21566</span>&#160;            $this-&gt;Write(0, $txt, $link, <span class="keyword">false</span>, $aligntext, <span class="keyword">false</span>, 0, <span class="keyword">false</span>, <span class="keyword">false</span>, 0, $numwidth, <span class="stringliteral">&#39;&#39;</span>);</div>
<div class="line"><a name="l21567"></a><span class="lineno">21567</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l21568"></a><span class="lineno">21568</span>&#160;                $tw = $this-&gt;x - $this-&gt;lMargin;</div>
<div class="line"><a name="l21569"></a><span class="lineno">21569</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l21570"></a><span class="lineno">21570</span>&#160;                $tw = $this-&gt;w - $this-&gt;rMargin - $this-&gt;x;</div>
<div class="line"><a name="l21571"></a><span class="lineno">21571</span>&#160;            }</div>
<div class="line"><a name="l21572"></a><span class="lineno">21572</span>&#160;            $this-&gt;SetFont($numbersfont, $fontstyle, $fontsize);</div>
<div class="line"><a name="l21573"></a><span class="lineno">21573</span>&#160;            <span class="keywordflow">if</span> (TCPDF_STATIC::empty_string($page)) {</div>
<div class="line"><a name="l21574"></a><span class="lineno">21574</span>&#160;                $pagenum = $outline[<span class="charliteral">&#39;p&#39;</span>];</div>
<div class="line"><a name="l21575"></a><span class="lineno">21575</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l21576"></a><span class="lineno">21576</span>&#160;                <span class="comment">// placemark to be replaced with the correct number</span></div>
<div class="line"><a name="l21577"></a><span class="lineno">21577</span>&#160;                $pagenum = <span class="stringliteral">&#39;{#&#39;</span>.($outline[<span class="charliteral">&#39;p&#39;</span>]).<span class="charliteral">&#39;}&#39;</span>;</div>
<div class="line"><a name="l21578"></a><span class="lineno">21578</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;isUnicodeFont()) {</div>
<div class="line"><a name="l21579"></a><span class="lineno">21579</span>&#160;                    $pagenum = <span class="charliteral">&#39;{&#39;</span>.$pagenum.<span class="charliteral">&#39;}&#39;</span>;</div>
<div class="line"><a name="l21580"></a><span class="lineno">21580</span>&#160;                }</div>
<div class="line"><a name="l21581"></a><span class="lineno">21581</span>&#160;                $maxpage = max($maxpage, $outline[<span class="charliteral">&#39;p&#39;</span>]);</div>
<div class="line"><a name="l21582"></a><span class="lineno">21582</span>&#160;            }</div>
<div class="line"><a name="l21583"></a><span class="lineno">21583</span>&#160;            $fw = ($tw - $this-&gt;GetStringWidth($pagenum.$filler));</div>
<div class="line"><a name="l21584"></a><span class="lineno">21584</span>&#160;            $wfiller = $this-&gt;GetStringWidth($filler);</div>
<div class="line"><a name="l21585"></a><span class="lineno">21585</span>&#160;            <span class="keywordflow">if</span> ($wfiller &gt; 0) {</div>
<div class="line"><a name="l21586"></a><span class="lineno">21586</span>&#160;                $numfills = floor($fw / $wfiller);</div>
<div class="line"><a name="l21587"></a><span class="lineno">21587</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l21588"></a><span class="lineno">21588</span>&#160;                $numfills = 0;</div>
<div class="line"><a name="l21589"></a><span class="lineno">21589</span>&#160;            }</div>
<div class="line"><a name="l21590"></a><span class="lineno">21590</span>&#160;            <span class="keywordflow">if</span> ($numfills &gt; 0) {</div>
<div class="line"><a name="l21591"></a><span class="lineno">21591</span>&#160;                $rowfill = str_repeat($filler, $numfills);</div>
<div class="line"><a name="l21592"></a><span class="lineno">21592</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l21593"></a><span class="lineno">21593</span>&#160;                $rowfill = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l21594"></a><span class="lineno">21594</span>&#160;            }</div>
<div class="line"><a name="l21595"></a><span class="lineno">21595</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l21596"></a><span class="lineno">21596</span>&#160;                $pagenum = $pagenum.$gap.$rowfill;</div>
<div class="line"><a name="l21597"></a><span class="lineno">21597</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l21598"></a><span class="lineno">21598</span>&#160;                $pagenum = $rowfill.$gap.$pagenum;</div>
<div class="line"><a name="l21599"></a><span class="lineno">21599</span>&#160;            }</div>
<div class="line"><a name="l21600"></a><span class="lineno">21600</span>&#160;            <span class="comment">// write the number</span></div>
<div class="line"><a name="l21601"></a><span class="lineno">21601</span>&#160;            $this-&gt;Cell($tw, 0, $pagenum, 0, 1, $alignnum, 0, $link, 0);</div>
<div class="line"><a name="l21602"></a><span class="lineno">21602</span>&#160;        }</div>
<div class="line"><a name="l21603"></a><span class="lineno">21603</span>&#160;        $page_last = $this-&gt;getPage();</div>
<div class="line"><a name="l21604"></a><span class="lineno">21604</span>&#160;        $numpages = ($page_last - $page_first + 1);</div>
<div class="line"><a name="l21605"></a><span class="lineno">21605</span>&#160;        <span class="comment">// account for booklet mode</span></div>
<div class="line"><a name="l21606"></a><span class="lineno">21606</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;booklet) {</div>
<div class="line"><a name="l21607"></a><span class="lineno">21607</span>&#160;            <span class="comment">// check if a blank page is required before TOC</span></div>
<div class="line"><a name="l21608"></a><span class="lineno">21608</span>&#160;            $page_fill_start = ((($page_first % 2) == 0) XOR (($page % 2) == 0));</div>
<div class="line"><a name="l21609"></a><span class="lineno">21609</span>&#160;            $page_fill_end = (!((($numpages % 2) == 0) XOR ($page_fill_start)));</div>
<div class="line"><a name="l21610"></a><span class="lineno">21610</span>&#160;            <span class="keywordflow">if</span> ($page_fill_start) {</div>
<div class="line"><a name="l21611"></a><span class="lineno">21611</span>&#160;                <span class="comment">// add a page at the end (to be moved before TOC)</span></div>
<div class="line"><a name="l21612"></a><span class="lineno">21612</span>&#160;                $this-&gt;addPage();</div>
<div class="line"><a name="l21613"></a><span class="lineno">21613</span>&#160;                ++$page_last;</div>
<div class="line"><a name="l21614"></a><span class="lineno">21614</span>&#160;                ++$numpages;</div>
<div class="line"><a name="l21615"></a><span class="lineno">21615</span>&#160;            }</div>
<div class="line"><a name="l21616"></a><span class="lineno">21616</span>&#160;            <span class="keywordflow">if</span> ($page_fill_end) {</div>
<div class="line"><a name="l21617"></a><span class="lineno">21617</span>&#160;                <span class="comment">// add a page at the end</span></div>
<div class="line"><a name="l21618"></a><span class="lineno">21618</span>&#160;                $this-&gt;addPage();</div>
<div class="line"><a name="l21619"></a><span class="lineno">21619</span>&#160;                ++$page_last;</div>
<div class="line"><a name="l21620"></a><span class="lineno">21620</span>&#160;                ++$numpages;</div>
<div class="line"><a name="l21621"></a><span class="lineno">21621</span>&#160;            }</div>
<div class="line"><a name="l21622"></a><span class="lineno">21622</span>&#160;        }</div>
<div class="line"><a name="l21623"></a><span class="lineno">21623</span>&#160;        $maxpage = max($maxpage, $page_last);</div>
<div class="line"><a name="l21624"></a><span class="lineno">21624</span>&#160;        <span class="keywordflow">if</span> (!TCPDF_STATIC::empty_string($page)) {</div>
<div class="line"><a name="l21625"></a><span class="lineno">21625</span>&#160;            <span class="keywordflow">for</span> ($p = $page_first; $p &lt;= $page_last; ++$p) {</div>
<div class="line"><a name="l21626"></a><span class="lineno">21626</span>&#160;                <span class="comment">// get page data</span></div>
<div class="line"><a name="l21627"></a><span class="lineno">21627</span>&#160;                $temppage = $this-&gt;getPageBuffer($p);</div>
<div class="line"><a name="l21628"></a><span class="lineno">21628</span>&#160;                <span class="keywordflow">for</span> ($n = 1; $n &lt;= $maxpage; ++$n) {</div>
<div class="line"><a name="l21629"></a><span class="lineno">21629</span>&#160;                    <span class="comment">// update page numbers</span></div>
<div class="line"><a name="l21630"></a><span class="lineno">21630</span>&#160;                    $a = <span class="stringliteral">&#39;{#&#39;</span>.$n.<span class="charliteral">&#39;}&#39;</span>;</div>
<div class="line"><a name="l21631"></a><span class="lineno">21631</span>&#160;                    <span class="comment">// get page number aliases</span></div>
<div class="line"><a name="l21632"></a><span class="lineno">21632</span>&#160;                    $pnalias = $this-&gt;getInternalPageNumberAliases($a);</div>
<div class="line"><a name="l21633"></a><span class="lineno">21633</span>&#160;                    <span class="comment">// calculate replacement number</span></div>
<div class="line"><a name="l21634"></a><span class="lineno">21634</span>&#160;                    <span class="keywordflow">if</span> (($n &gt;= $page) AND ($n &lt;= $this-&gt;numpages)) {</div>
<div class="line"><a name="l21635"></a><span class="lineno">21635</span>&#160;                        $np = $n + $numpages;</div>
<div class="line"><a name="l21636"></a><span class="lineno">21636</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l21637"></a><span class="lineno">21637</span>&#160;                        $np = $n;</div>
<div class="line"><a name="l21638"></a><span class="lineno">21638</span>&#160;                    }</div>
<div class="line"><a name="l21639"></a><span class="lineno">21639</span>&#160;                    $na = TCPDF_STATIC::formatTOCPageNumber(($this-&gt;starting_page_number + $np - 1));</div>
<div class="line"><a name="l21640"></a><span class="lineno">21640</span>&#160;                    $nu = TCPDF_FONTS::UTF8ToUTF16BE($na, <span class="keyword">false</span>, $this-&gt;isunicode, $this-&gt;CurrentFont);</div>
<div class="line"><a name="l21641"></a><span class="lineno">21641</span>&#160;                    <span class="comment">// replace aliases with numbers</span></div>
<div class="line"><a name="l21642"></a><span class="lineno">21642</span>&#160;                    <span class="keywordflow">foreach</span> ($pnalias[<span class="charliteral">&#39;u&#39;</span>] as $u) {</div>
<div class="line"><a name="l21643"></a><span class="lineno">21643</span>&#160;                        $sfill = str_repeat($filler, max(0, (strlen($u) - strlen($nu.<span class="charliteral">&#39; &#39;</span>))));</div>
<div class="line"><a name="l21644"></a><span class="lineno">21644</span>&#160;                        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l21645"></a><span class="lineno">21645</span>&#160;                            $nr = $nu.TCPDF_FONTS::UTF8ToUTF16BE(<span class="charliteral">&#39; &#39;</span>.$sfill, <span class="keyword">false</span>, $this-&gt;isunicode, $this-&gt;CurrentFont);</div>
<div class="line"><a name="l21646"></a><span class="lineno">21646</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l21647"></a><span class="lineno">21647</span>&#160;                            $nr = TCPDF_FONTS::UTF8ToUTF16BE($sfill.<span class="charliteral">&#39; &#39;</span>, <span class="keyword">false</span>, $this-&gt;isunicode, $this-&gt;CurrentFont).$nu;</div>
<div class="line"><a name="l21648"></a><span class="lineno">21648</span>&#160;                        }</div>
<div class="line"><a name="l21649"></a><span class="lineno">21649</span>&#160;                        $temppage = str_replace($u, $nr, $temppage);</div>
<div class="line"><a name="l21650"></a><span class="lineno">21650</span>&#160;                    }</div>
<div class="line"><a name="l21651"></a><span class="lineno">21651</span>&#160;                    <span class="keywordflow">foreach</span> ($pnalias[<span class="charliteral">&#39;a&#39;</span>] as $a) {</div>
<div class="line"><a name="l21652"></a><span class="lineno">21652</span>&#160;                        $sfill = str_repeat($filler, max(0, (strlen($a) - strlen($na.<span class="charliteral">&#39; &#39;</span>))));</div>
<div class="line"><a name="l21653"></a><span class="lineno">21653</span>&#160;                        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l21654"></a><span class="lineno">21654</span>&#160;                            $nr = $na.<span class="charliteral">&#39; &#39;</span>.$sfill;</div>
<div class="line"><a name="l21655"></a><span class="lineno">21655</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l21656"></a><span class="lineno">21656</span>&#160;                            $nr = $sfill.<span class="charliteral">&#39; &#39;</span>.$na;</div>
<div class="line"><a name="l21657"></a><span class="lineno">21657</span>&#160;                        }</div>
<div class="line"><a name="l21658"></a><span class="lineno">21658</span>&#160;                        $temppage = str_replace($a, $nr, $temppage);</div>
<div class="line"><a name="l21659"></a><span class="lineno">21659</span>&#160;                    }</div>
<div class="line"><a name="l21660"></a><span class="lineno">21660</span>&#160;                }</div>
<div class="line"><a name="l21661"></a><span class="lineno">21661</span>&#160;                <span class="comment">// save changes</span></div>
<div class="line"><a name="l21662"></a><span class="lineno">21662</span>&#160;                $this-&gt;setPageBuffer($p, $temppage);</div>
<div class="line"><a name="l21663"></a><span class="lineno">21663</span>&#160;            }</div>
<div class="line"><a name="l21664"></a><span class="lineno">21664</span>&#160;            <span class="comment">// move pages</span></div>
<div class="line"><a name="l21665"></a><span class="lineno">21665</span>&#160;            $this-&gt;Bookmark($toc_name, 0, 0, $page_first, $style, $color);</div>
<div class="line"><a name="l21666"></a><span class="lineno">21666</span>&#160;            <span class="keywordflow">if</span> ($page_fill_start) {</div>
<div class="line"><a name="l21667"></a><span class="lineno">21667</span>&#160;                $this-&gt;movePage($page_last, $page_first);</div>
<div class="line"><a name="l21668"></a><span class="lineno">21668</span>&#160;            }</div>
<div class="line"><a name="l21669"></a><span class="lineno">21669</span>&#160;            <span class="keywordflow">for</span> ($i = 0; $i &lt; $numpages; ++$i) {</div>
<div class="line"><a name="l21670"></a><span class="lineno">21670</span>&#160;                $this-&gt;movePage($page_last, $page);</div>
<div class="line"><a name="l21671"></a><span class="lineno">21671</span>&#160;            }</div>
<div class="line"><a name="l21672"></a><span class="lineno">21672</span>&#160;        }</div>
<div class="line"><a name="l21673"></a><span class="lineno">21673</span>&#160;    }</div>
<div class="line"><a name="l21674"></a><span class="lineno">21674</span>&#160;</div>
<div class="line"><a name="l21691"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a137bd1e5f930eda5324ce99afb9d1e40">21691</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a137bd1e5f930eda5324ce99afb9d1e40">addHTMLTOC</a>($page=<span class="stringliteral">&#39;&#39;</span>, $toc_name=<span class="stringliteral">&#39;TOC&#39;</span>, $templates=array(), $correct_align=<span class="keyword">true</span>, $style=<span class="stringliteral">&#39;&#39;</span>, $color=array(0,0,0)) {</div>
<div class="line"><a name="l21692"></a><span class="lineno">21692</span>&#160;        $filler = <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l21693"></a><span class="lineno">21693</span>&#160;        $prev_htmlLinkColorArray = $this-&gt;htmlLinkColorArray;</div>
<div class="line"><a name="l21694"></a><span class="lineno">21694</span>&#160;        $prev_htmlLinkFontStyle = $this-&gt;htmlLinkFontStyle;</div>
<div class="line"><a name="l21695"></a><span class="lineno">21695</span>&#160;        <span class="comment">// set new style for link</span></div>
<div class="line"><a name="l21696"></a><span class="lineno">21696</span>&#160;        $this-&gt;htmlLinkColorArray = array();</div>
<div class="line"><a name="l21697"></a><span class="lineno">21697</span>&#160;        $this-&gt;htmlLinkFontStyle = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l21698"></a><span class="lineno">21698</span>&#160;        $page_first = $this-&gt;getPage();</div>
<div class="line"><a name="l21699"></a><span class="lineno">21699</span>&#160;        $page_fill_start = <span class="keyword">false</span>;</div>
<div class="line"><a name="l21700"></a><span class="lineno">21700</span>&#160;        $page_fill_end = <span class="keyword">false</span>;</div>
<div class="line"><a name="l21701"></a><span class="lineno">21701</span>&#160;        <span class="comment">// get the font type used for numbers in each template</span></div>
<div class="line"><a name="l21702"></a><span class="lineno">21702</span>&#160;        $current_font = $this-&gt;FontFamily;</div>
<div class="line"><a name="l21703"></a><span class="lineno">21703</span>&#160;        <span class="keywordflow">foreach</span> ($templates as $level =&gt; $html) {</div>
<div class="line"><a name="l21704"></a><span class="lineno">21704</span>&#160;            $dom = $this-&gt;getHtmlDomArray($html);</div>
<div class="line"><a name="l21705"></a><span class="lineno">21705</span>&#160;            <span class="keywordflow">foreach</span> ($dom as $key =&gt; $value) {</div>
<div class="line"><a name="l21706"></a><span class="lineno">21706</span>&#160;                <span class="keywordflow">if</span> ($value[<span class="stringliteral">&#39;value&#39;</span>] == <span class="stringliteral">&#39;#TOC_PAGE_NUMBER#&#39;</span>) {</div>
<div class="line"><a name="l21707"></a><span class="lineno">21707</span>&#160;                    $this-&gt;SetFont($dom[($key - 1)][<span class="stringliteral">&#39;fontname&#39;</span>]);</div>
<div class="line"><a name="l21708"></a><span class="lineno">21708</span>&#160;                    $templates[<span class="charliteral">&#39;F&#39;</span>.$level] = $this-&gt;isUnicodeFont();</div>
<div class="line"><a name="l21709"></a><span class="lineno">21709</span>&#160;                }</div>
<div class="line"><a name="l21710"></a><span class="lineno">21710</span>&#160;            }</div>
<div class="line"><a name="l21711"></a><span class="lineno">21711</span>&#160;        }</div>
<div class="line"><a name="l21712"></a><span class="lineno">21712</span>&#160;        $this-&gt;SetFont($current_font);</div>
<div class="line"><a name="l21713"></a><span class="lineno">21713</span>&#160;        $maxpage = 0; <span class="comment">//used for pages on attached documents</span></div>
<div class="line"><a name="l21714"></a><span class="lineno">21714</span>&#160;        <span class="keywordflow">foreach</span> ($this-&gt;outlines as $key =&gt; $outline) {</div>
<div class="line"><a name="l21715"></a><span class="lineno">21715</span>&#160;            <span class="comment">// get HTML template</span></div>
<div class="line"><a name="l21716"></a><span class="lineno">21716</span>&#160;            $row = $templates[$outline[<span class="charliteral">&#39;l&#39;</span>]];</div>
<div class="line"><a name="l21717"></a><span class="lineno">21717</span>&#160;            <span class="keywordflow">if</span> (TCPDF_STATIC::empty_string($page)) {</div>
<div class="line"><a name="l21718"></a><span class="lineno">21718</span>&#160;                $pagenum = $outline[<span class="charliteral">&#39;p&#39;</span>];</div>
<div class="line"><a name="l21719"></a><span class="lineno">21719</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l21720"></a><span class="lineno">21720</span>&#160;                <span class="comment">// placemark to be replaced with the correct number</span></div>
<div class="line"><a name="l21721"></a><span class="lineno">21721</span>&#160;                $pagenum = <span class="stringliteral">&#39;{#&#39;</span>.($outline[<span class="charliteral">&#39;p&#39;</span>]).<span class="charliteral">&#39;}&#39;</span>;</div>
<div class="line"><a name="l21722"></a><span class="lineno">21722</span>&#160;                <span class="keywordflow">if</span> ($templates[<span class="charliteral">&#39;F&#39;</span>.$outline[<span class="charliteral">&#39;l&#39;</span>]]) {</div>
<div class="line"><a name="l21723"></a><span class="lineno">21723</span>&#160;                    $pagenum = <span class="charliteral">&#39;{&#39;</span>.$pagenum.<span class="charliteral">&#39;}&#39;</span>;</div>
<div class="line"><a name="l21724"></a><span class="lineno">21724</span>&#160;                }</div>
<div class="line"><a name="l21725"></a><span class="lineno">21725</span>&#160;                $maxpage = max($maxpage, $outline[<span class="charliteral">&#39;p&#39;</span>]);</div>
<div class="line"><a name="l21726"></a><span class="lineno">21726</span>&#160;            }</div>
<div class="line"><a name="l21727"></a><span class="lineno">21727</span>&#160;            <span class="comment">// replace templates with current values</span></div>
<div class="line"><a name="l21728"></a><span class="lineno">21728</span>&#160;            $row = str_replace(<span class="stringliteral">&#39;#TOC_DESCRIPTION#&#39;</span>, $outline[<span class="charliteral">&#39;t&#39;</span>], $row);</div>
<div class="line"><a name="l21729"></a><span class="lineno">21729</span>&#160;            $row = str_replace(<span class="stringliteral">&#39;#TOC_PAGE_NUMBER#&#39;</span>, $pagenum, $row);</div>
<div class="line"><a name="l21730"></a><span class="lineno">21730</span>&#160;            <span class="comment">// add link to page</span></div>
<div class="line"><a name="l21731"></a><span class="lineno">21731</span>&#160;            $row = <span class="stringliteral">&#39;&lt;a href=&quot;#&#39;</span>.$outline[<span class="charliteral">&#39;p&#39;</span>].<span class="charliteral">&#39;,&#39;</span>.$outline[<span class="charliteral">&#39;y&#39;</span>].<span class="stringliteral">&#39;&quot;&gt;&#39;</span>.$row.<span class="stringliteral">&#39;&lt;/a&gt;&#39;</span>;</div>
<div class="line"><a name="l21732"></a><span class="lineno">21732</span>&#160;            <span class="comment">// write bookmark entry</span></div>
<div class="line"><a name="l21733"></a><span class="lineno">21733</span>&#160;            $this-&gt;writeHTML($row, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>, <span class="keyword">false</span>, <span class="stringliteral">&#39;&#39;</span>);</div>
<div class="line"><a name="l21734"></a><span class="lineno">21734</span>&#160;        }</div>
<div class="line"><a name="l21735"></a><span class="lineno">21735</span>&#160;        <span class="comment">// restore link styles</span></div>
<div class="line"><a name="l21736"></a><span class="lineno">21736</span>&#160;        $this-&gt;htmlLinkColorArray = $prev_htmlLinkColorArray;</div>
<div class="line"><a name="l21737"></a><span class="lineno">21737</span>&#160;        $this-&gt;htmlLinkFontStyle = $prev_htmlLinkFontStyle;</div>
<div class="line"><a name="l21738"></a><span class="lineno">21738</span>&#160;        <span class="comment">// move TOC page and replace numbers</span></div>
<div class="line"><a name="l21739"></a><span class="lineno">21739</span>&#160;        $page_last = $this-&gt;getPage();</div>
<div class="line"><a name="l21740"></a><span class="lineno">21740</span>&#160;        $numpages = ($page_last - $page_first + 1);</div>
<div class="line"><a name="l21741"></a><span class="lineno">21741</span>&#160;        <span class="comment">// account for booklet mode</span></div>
<div class="line"><a name="l21742"></a><span class="lineno">21742</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;booklet) {</div>
<div class="line"><a name="l21743"></a><span class="lineno">21743</span>&#160;            <span class="comment">// check if a blank page is required before TOC</span></div>
<div class="line"><a name="l21744"></a><span class="lineno">21744</span>&#160;            $page_fill_start = ((($page_first % 2) == 0) XOR (($page % 2) == 0));</div>
<div class="line"><a name="l21745"></a><span class="lineno">21745</span>&#160;            $page_fill_end = (!((($numpages % 2) == 0) XOR ($page_fill_start)));</div>
<div class="line"><a name="l21746"></a><span class="lineno">21746</span>&#160;            <span class="keywordflow">if</span> ($page_fill_start) {</div>
<div class="line"><a name="l21747"></a><span class="lineno">21747</span>&#160;                <span class="comment">// add a page at the end (to be moved before TOC)</span></div>
<div class="line"><a name="l21748"></a><span class="lineno">21748</span>&#160;                $this-&gt;addPage();</div>
<div class="line"><a name="l21749"></a><span class="lineno">21749</span>&#160;                ++$page_last;</div>
<div class="line"><a name="l21750"></a><span class="lineno">21750</span>&#160;                ++$numpages;</div>
<div class="line"><a name="l21751"></a><span class="lineno">21751</span>&#160;            }</div>
<div class="line"><a name="l21752"></a><span class="lineno">21752</span>&#160;            <span class="keywordflow">if</span> ($page_fill_end) {</div>
<div class="line"><a name="l21753"></a><span class="lineno">21753</span>&#160;                <span class="comment">// add a page at the end</span></div>
<div class="line"><a name="l21754"></a><span class="lineno">21754</span>&#160;                $this-&gt;addPage();</div>
<div class="line"><a name="l21755"></a><span class="lineno">21755</span>&#160;                ++$page_last;</div>
<div class="line"><a name="l21756"></a><span class="lineno">21756</span>&#160;                ++$numpages;</div>
<div class="line"><a name="l21757"></a><span class="lineno">21757</span>&#160;            }</div>
<div class="line"><a name="l21758"></a><span class="lineno">21758</span>&#160;        }</div>
<div class="line"><a name="l21759"></a><span class="lineno">21759</span>&#160;        $maxpage = max($maxpage, $page_last);</div>
<div class="line"><a name="l21760"></a><span class="lineno">21760</span>&#160;        <span class="keywordflow">if</span> (!TCPDF_STATIC::empty_string($page)) {</div>
<div class="line"><a name="l21761"></a><span class="lineno">21761</span>&#160;            <span class="keywordflow">for</span> ($p = $page_first; $p &lt;= $page_last; ++$p) {</div>
<div class="line"><a name="l21762"></a><span class="lineno">21762</span>&#160;                <span class="comment">// get page data</span></div>
<div class="line"><a name="l21763"></a><span class="lineno">21763</span>&#160;                $temppage = $this-&gt;getPageBuffer($p);</div>
<div class="line"><a name="l21764"></a><span class="lineno">21764</span>&#160;                <span class="keywordflow">for</span> ($n = 1; $n &lt;= $maxpage; ++$n) {</div>
<div class="line"><a name="l21765"></a><span class="lineno">21765</span>&#160;                    <span class="comment">// update page numbers</span></div>
<div class="line"><a name="l21766"></a><span class="lineno">21766</span>&#160;                    $a = <span class="stringliteral">&#39;{#&#39;</span>.$n.<span class="charliteral">&#39;}&#39;</span>;</div>
<div class="line"><a name="l21767"></a><span class="lineno">21767</span>&#160;                    <span class="comment">// get page number aliases</span></div>
<div class="line"><a name="l21768"></a><span class="lineno">21768</span>&#160;                    $pnalias = $this-&gt;getInternalPageNumberAliases($a);</div>
<div class="line"><a name="l21769"></a><span class="lineno">21769</span>&#160;                    <span class="comment">// calculate replacement number</span></div>
<div class="line"><a name="l21770"></a><span class="lineno">21770</span>&#160;                    <span class="keywordflow">if</span> ($n &gt;= $page) {</div>
<div class="line"><a name="l21771"></a><span class="lineno">21771</span>&#160;                        $np = $n + $numpages;</div>
<div class="line"><a name="l21772"></a><span class="lineno">21772</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l21773"></a><span class="lineno">21773</span>&#160;                        $np = $n;</div>
<div class="line"><a name="l21774"></a><span class="lineno">21774</span>&#160;                    }</div>
<div class="line"><a name="l21775"></a><span class="lineno">21775</span>&#160;                    $na = TCPDF_STATIC::formatTOCPageNumber(($this-&gt;starting_page_number + $np - 1));</div>
<div class="line"><a name="l21776"></a><span class="lineno">21776</span>&#160;                    $nu = TCPDF_FONTS::UTF8ToUTF16BE($na, <span class="keyword">false</span>, $this-&gt;isunicode, $this-&gt;CurrentFont);</div>
<div class="line"><a name="l21777"></a><span class="lineno">21777</span>&#160;                    <span class="comment">// replace aliases with numbers</span></div>
<div class="line"><a name="l21778"></a><span class="lineno">21778</span>&#160;                    <span class="keywordflow">foreach</span> ($pnalias[<span class="charliteral">&#39;u&#39;</span>] as $u) {</div>
<div class="line"><a name="l21779"></a><span class="lineno">21779</span>&#160;                        <span class="keywordflow">if</span> ($correct_align) {</div>
<div class="line"><a name="l21780"></a><span class="lineno">21780</span>&#160;                            $sfill = str_repeat($filler, (strlen($u) - strlen($nu.<span class="charliteral">&#39; &#39;</span>)));</div>
<div class="line"><a name="l21781"></a><span class="lineno">21781</span>&#160;                            <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l21782"></a><span class="lineno">21782</span>&#160;                                $nr = $nu.TCPDF_FONTS::UTF8ToUTF16BE(<span class="charliteral">&#39; &#39;</span>.$sfill, <span class="keyword">false</span>, $this-&gt;isunicode, $this-&gt;CurrentFont);</div>
<div class="line"><a name="l21783"></a><span class="lineno">21783</span>&#160;                            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l21784"></a><span class="lineno">21784</span>&#160;                                $nr = TCPDF_FONTS::UTF8ToUTF16BE($sfill.<span class="charliteral">&#39; &#39;</span>, <span class="keyword">false</span>, $this-&gt;isunicode, $this-&gt;CurrentFont).$nu;</div>
<div class="line"><a name="l21785"></a><span class="lineno">21785</span>&#160;                            }</div>
<div class="line"><a name="l21786"></a><span class="lineno">21786</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l21787"></a><span class="lineno">21787</span>&#160;                            $nr = $nu;</div>
<div class="line"><a name="l21788"></a><span class="lineno">21788</span>&#160;                        }</div>
<div class="line"><a name="l21789"></a><span class="lineno">21789</span>&#160;                        $temppage = str_replace($u, $nr, $temppage);</div>
<div class="line"><a name="l21790"></a><span class="lineno">21790</span>&#160;                    }</div>
<div class="line"><a name="l21791"></a><span class="lineno">21791</span>&#160;                    <span class="keywordflow">foreach</span> ($pnalias[<span class="charliteral">&#39;a&#39;</span>] as $a) {</div>
<div class="line"><a name="l21792"></a><span class="lineno">21792</span>&#160;                        <span class="keywordflow">if</span> ($correct_align) {</div>
<div class="line"><a name="l21793"></a><span class="lineno">21793</span>&#160;                            $sfill = str_repeat($filler, (strlen($a) - strlen($na.<span class="charliteral">&#39; &#39;</span>)));</div>
<div class="line"><a name="l21794"></a><span class="lineno">21794</span>&#160;                            <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l21795"></a><span class="lineno">21795</span>&#160;                                $nr = $na.<span class="charliteral">&#39; &#39;</span>.$sfill;</div>
<div class="line"><a name="l21796"></a><span class="lineno">21796</span>&#160;                            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l21797"></a><span class="lineno">21797</span>&#160;                                $nr = $sfill.<span class="charliteral">&#39; &#39;</span>.$na;</div>
<div class="line"><a name="l21798"></a><span class="lineno">21798</span>&#160;                            }</div>
<div class="line"><a name="l21799"></a><span class="lineno">21799</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l21800"></a><span class="lineno">21800</span>&#160;                            $nr = $na;</div>
<div class="line"><a name="l21801"></a><span class="lineno">21801</span>&#160;                        }</div>
<div class="line"><a name="l21802"></a><span class="lineno">21802</span>&#160;                        $temppage = str_replace($a, $nr, $temppage);</div>
<div class="line"><a name="l21803"></a><span class="lineno">21803</span>&#160;                    }</div>
<div class="line"><a name="l21804"></a><span class="lineno">21804</span>&#160;                }</div>
<div class="line"><a name="l21805"></a><span class="lineno">21805</span>&#160;                <span class="comment">// save changes</span></div>
<div class="line"><a name="l21806"></a><span class="lineno">21806</span>&#160;                $this-&gt;setPageBuffer($p, $temppage);</div>
<div class="line"><a name="l21807"></a><span class="lineno">21807</span>&#160;            }</div>
<div class="line"><a name="l21808"></a><span class="lineno">21808</span>&#160;            <span class="comment">// move pages</span></div>
<div class="line"><a name="l21809"></a><span class="lineno">21809</span>&#160;            $this-&gt;Bookmark($toc_name, 0, 0, $page_first, $style, $color);</div>
<div class="line"><a name="l21810"></a><span class="lineno">21810</span>&#160;            <span class="keywordflow">if</span> ($page_fill_start) {</div>
<div class="line"><a name="l21811"></a><span class="lineno">21811</span>&#160;                $this-&gt;movePage($page_last, $page_first);</div>
<div class="line"><a name="l21812"></a><span class="lineno">21812</span>&#160;            }</div>
<div class="line"><a name="l21813"></a><span class="lineno">21813</span>&#160;            <span class="keywordflow">for</span> ($i = 0; $i &lt; $numpages; ++$i) {</div>
<div class="line"><a name="l21814"></a><span class="lineno">21814</span>&#160;                $this-&gt;movePage($page_last, $page);</div>
<div class="line"><a name="l21815"></a><span class="lineno">21815</span>&#160;            }</div>
<div class="line"><a name="l21816"></a><span class="lineno">21816</span>&#160;        }</div>
<div class="line"><a name="l21817"></a><span class="lineno">21817</span>&#160;    }</div>
<div class="line"><a name="l21818"></a><span class="lineno">21818</span>&#160;</div>
<div class="line"><a name="l21824"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a797b9be1f9c2d031e5dce8c5b3a9e27c">21824</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a797b9be1f9c2d031e5dce8c5b3a9e27c">startTransaction</a>() {</div>
<div class="line"><a name="l21825"></a><span class="lineno">21825</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;objcopy)) {</div>
<div class="line"><a name="l21826"></a><span class="lineno">21826</span>&#160;            <span class="comment">// remove previous copy</span></div>
<div class="line"><a name="l21827"></a><span class="lineno">21827</span>&#160;            $this-&gt;commitTransaction();</div>
<div class="line"><a name="l21828"></a><span class="lineno">21828</span>&#160;        }</div>
<div class="line"><a name="l21829"></a><span class="lineno">21829</span>&#160;        <span class="comment">// record current page number and Y position</span></div>
<div class="line"><a name="l21830"></a><span class="lineno">21830</span>&#160;        $this-&gt;start_transaction_page = $this-&gt;page;</div>
<div class="line"><a name="l21831"></a><span class="lineno">21831</span>&#160;        $this-&gt;start_transaction_y = $this-&gt;y;</div>
<div class="line"><a name="l21832"></a><span class="lineno">21832</span>&#160;        <span class="comment">// clone current object</span></div>
<div class="line"><a name="l21833"></a><span class="lineno">21833</span>&#160;        $this-&gt;objcopy = TCPDF_STATIC::objclone($this);</div>
<div class="line"><a name="l21834"></a><span class="lineno">21834</span>&#160;    }</div>
<div class="line"><a name="l21835"></a><span class="lineno">21835</span>&#160;</div>
<div class="line"><a name="l21841"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a8f5242efde7c458dd3ec011f52010503">21841</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a8f5242efde7c458dd3ec011f52010503">commitTransaction</a>() {</div>
<div class="line"><a name="l21842"></a><span class="lineno">21842</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;objcopy)) {</div>
<div class="line"><a name="l21843"></a><span class="lineno">21843</span>&#160;            $this-&gt;objcopy-&gt;_destroy(<span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l21844"></a><span class="lineno">21844</span>&#160;            unset($this-&gt;objcopy);</div>
<div class="line"><a name="l21845"></a><span class="lineno">21845</span>&#160;        }</div>
<div class="line"><a name="l21846"></a><span class="lineno">21846</span>&#160;    }</div>
<div class="line"><a name="l21847"></a><span class="lineno">21847</span>&#160;</div>
<div class="line"><a name="l21855"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a338034ba746f7c607473207b9caa4e1f">21855</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a338034ba746f7c607473207b9caa4e1f">rollbackTransaction</a>($self=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l21856"></a><span class="lineno">21856</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;objcopy)) {</div>
<div class="line"><a name="l21857"></a><span class="lineno">21857</span>&#160;            <span class="keywordflow">if</span> (isset($this-&gt;objcopy-&gt;diskcache) AND $this-&gt;objcopy-&gt;diskcache) {</div>
<div class="line"><a name="l21858"></a><span class="lineno">21858</span>&#160;                <span class="comment">// truncate files to previous values</span></div>
<div class="line"><a name="l21859"></a><span class="lineno">21859</span>&#160;                <span class="keywordflow">foreach</span> ($this-&gt;objcopy-&gt;cache_file_length as $file =&gt; $length) {</div>
<div class="line"><a name="l21860"></a><span class="lineno">21860</span>&#160;                    $file = substr($file, 1);</div>
<div class="line"><a name="l21861"></a><span class="lineno">21861</span>&#160;                    $handle = fopen($file, <span class="stringliteral">&#39;r+&#39;</span>);</div>
<div class="line"><a name="l21862"></a><span class="lineno">21862</span>&#160;                    ftruncate($handle, $length);</div>
<div class="line"><a name="l21863"></a><span class="lineno">21863</span>&#160;                }</div>
<div class="line"><a name="l21864"></a><span class="lineno">21864</span>&#160;            }</div>
<div class="line"><a name="l21865"></a><span class="lineno">21865</span>&#160;            $this-&gt;_destroy(<span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l21866"></a><span class="lineno">21866</span>&#160;            <span class="keywordflow">if</span> ($self) {</div>
<div class="line"><a name="l21867"></a><span class="lineno">21867</span>&#160;                $objvars = get_object_vars($this-&gt;objcopy);</div>
<div class="line"><a name="l21868"></a><span class="lineno">21868</span>&#160;                <span class="keywordflow">foreach</span> ($objvars as $key =&gt; $value) {</div>
<div class="line"><a name="l21869"></a><span class="lineno">21869</span>&#160;                    $this-&gt;$key = $value;</div>
<div class="line"><a name="l21870"></a><span class="lineno">21870</span>&#160;                }</div>
<div class="line"><a name="l21871"></a><span class="lineno">21871</span>&#160;            }</div>
<div class="line"><a name="l21872"></a><span class="lineno">21872</span>&#160;            <span class="keywordflow">return</span> $this-&gt;objcopy;</div>
<div class="line"><a name="l21873"></a><span class="lineno">21873</span>&#160;        }</div>
<div class="line"><a name="l21874"></a><span class="lineno">21874</span>&#160;        <span class="keywordflow">return</span> $this;</div>
<div class="line"><a name="l21875"></a><span class="lineno">21875</span>&#160;    }</div>
<div class="line"><a name="l21876"></a><span class="lineno">21876</span>&#160;</div>
<div class="line"><a name="l21877"></a><span class="lineno">21877</span>&#160;    <span class="comment">// --- MULTI COLUMNS METHODS -----------------------</span></div>
<div class="line"><a name="l21878"></a><span class="lineno">21878</span>&#160;</div>
<div class="line"><a name="l21887"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aeb84582f37f9d68c1a9f5723849d0009">21887</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#aeb84582f37f9d68c1a9f5723849d0009">setEqualColumns</a>($numcols=0, $width=0, $y=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l21888"></a><span class="lineno">21888</span>&#160;        $this-&gt;columns = array();</div>
<div class="line"><a name="l21889"></a><span class="lineno">21889</span>&#160;        <span class="keywordflow">if</span> ($numcols &lt; 2) {</div>
<div class="line"><a name="l21890"></a><span class="lineno">21890</span>&#160;            $numcols = 0;</div>
<div class="line"><a name="l21891"></a><span class="lineno">21891</span>&#160;            $this-&gt;columns = array();</div>
<div class="line"><a name="l21892"></a><span class="lineno">21892</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l21893"></a><span class="lineno">21893</span>&#160;            <span class="comment">// maximum column width</span></div>
<div class="line"><a name="l21894"></a><span class="lineno">21894</span>&#160;            $maxwidth = ($this-&gt;w - $this-&gt;original_lMargin - $this-&gt;original_rMargin) / $numcols;</div>
<div class="line"><a name="l21895"></a><span class="lineno">21895</span>&#160;            <span class="keywordflow">if</span> (($width == 0) OR ($width &gt; $maxwidth)) {</div>
<div class="line"><a name="l21896"></a><span class="lineno">21896</span>&#160;                $width = $maxwidth;</div>
<div class="line"><a name="l21897"></a><span class="lineno">21897</span>&#160;            }</div>
<div class="line"><a name="l21898"></a><span class="lineno">21898</span>&#160;            <span class="keywordflow">if</span> (TCPDF_STATIC::empty_string($y)) {</div>
<div class="line"><a name="l21899"></a><span class="lineno">21899</span>&#160;                $y = $this-&gt;y;</div>
<div class="line"><a name="l21900"></a><span class="lineno">21900</span>&#160;            }</div>
<div class="line"><a name="l21901"></a><span class="lineno">21901</span>&#160;            <span class="comment">// space between columns</span></div>
<div class="line"><a name="l21902"></a><span class="lineno">21902</span>&#160;            $space = (($this-&gt;w - $this-&gt;original_lMargin - $this-&gt;original_rMargin - ($numcols * $width)) / ($numcols - 1));</div>
<div class="line"><a name="l21903"></a><span class="lineno">21903</span>&#160;            <span class="comment">// fill the columns array (with, space, starting Y position)</span></div>
<div class="line"><a name="l21904"></a><span class="lineno">21904</span>&#160;            <span class="keywordflow">for</span> ($i = 0; $i &lt; $numcols; ++$i) {</div>
<div class="line"><a name="l21905"></a><span class="lineno">21905</span>&#160;                $this-&gt;columns[$i] = array(<span class="charliteral">&#39;w&#39;</span> =&gt; $width, <span class="charliteral">&#39;s&#39;</span> =&gt; $space, <span class="charliteral">&#39;y&#39;</span> =&gt; $y);</div>
<div class="line"><a name="l21906"></a><span class="lineno">21906</span>&#160;            }</div>
<div class="line"><a name="l21907"></a><span class="lineno">21907</span>&#160;        }</div>
<div class="line"><a name="l21908"></a><span class="lineno">21908</span>&#160;        $this-&gt;num_columns = $numcols;</div>
<div class="line"><a name="l21909"></a><span class="lineno">21909</span>&#160;        $this-&gt;current_column = 0;</div>
<div class="line"><a name="l21910"></a><span class="lineno">21910</span>&#160;        $this-&gt;column_start_page = $this-&gt;page;</div>
<div class="line"><a name="l21911"></a><span class="lineno">21911</span>&#160;        $this-&gt;selectColumn(0);</div>
<div class="line"><a name="l21912"></a><span class="lineno">21912</span>&#160;    }</div>
<div class="line"><a name="l21913"></a><span class="lineno">21913</span>&#160;</div>
<div class="line"><a name="l21919"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ae0f4faf05227d82fa7ed924ba9044da7">21919</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ae0f4faf05227d82fa7ed924ba9044da7">resetColumns</a>() {</div>
<div class="line"><a name="l21920"></a><span class="lineno">21920</span>&#160;        $this-&gt;lMargin = $this-&gt;original_lMargin;</div>
<div class="line"><a name="l21921"></a><span class="lineno">21921</span>&#160;        $this-&gt;rMargin = $this-&gt;original_rMargin;</div>
<div class="line"><a name="l21922"></a><span class="lineno">21922</span>&#160;        $this-&gt;setEqualColumns();</div>
<div class="line"><a name="l21923"></a><span class="lineno">21923</span>&#160;    }</div>
<div class="line"><a name="l21924"></a><span class="lineno">21924</span>&#160;</div>
<div class="line"><a name="l21932"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a475b483b9b8f649582c3237af5fb03d4">21932</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a475b483b9b8f649582c3237af5fb03d4">setColumnsArray</a>($columns) {</div>
<div class="line"><a name="l21933"></a><span class="lineno">21933</span>&#160;        $this-&gt;columns = $columns;</div>
<div class="line"><a name="l21934"></a><span class="lineno">21934</span>&#160;        $this-&gt;num_columns = count($columns);</div>
<div class="line"><a name="l21935"></a><span class="lineno">21935</span>&#160;        $this-&gt;current_column = 0;</div>
<div class="line"><a name="l21936"></a><span class="lineno">21936</span>&#160;        $this-&gt;column_start_page = $this-&gt;page;</div>
<div class="line"><a name="l21937"></a><span class="lineno">21937</span>&#160;        $this-&gt;selectColumn(0);</div>
<div class="line"><a name="l21938"></a><span class="lineno">21938</span>&#160;    }</div>
<div class="line"><a name="l21939"></a><span class="lineno">21939</span>&#160;</div>
<div class="line"><a name="l21946"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a4f11d769024fd07e1f663efd02d10517">21946</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a4f11d769024fd07e1f663efd02d10517">selectColumn</a>($col=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l21947"></a><span class="lineno">21947</span>&#160;        <span class="keywordflow">if</span> (is_string($col)) {</div>
<div class="line"><a name="l21948"></a><span class="lineno">21948</span>&#160;            $col = $this-&gt;current_column;</div>
<div class="line"><a name="l21949"></a><span class="lineno">21949</span>&#160;        } elseif ($col &gt;= $this-&gt;num_columns) {</div>
<div class="line"><a name="l21950"></a><span class="lineno">21950</span>&#160;            $col = 0;</div>
<div class="line"><a name="l21951"></a><span class="lineno">21951</span>&#160;        }</div>
<div class="line"><a name="l21952"></a><span class="lineno">21952</span>&#160;        $xshift = array(<span class="charliteral">&#39;x&#39;</span> =&gt; 0, <span class="charliteral">&#39;s&#39;</span> =&gt; array(<span class="charliteral">&#39;H&#39;</span> =&gt; 0, <span class="charliteral">&#39;V&#39;</span> =&gt; 0), <span class="charliteral">&#39;p&#39;</span> =&gt; array(<span class="charliteral">&#39;L&#39;</span> =&gt; 0, <span class="charliteral">&#39;T&#39;</span> =&gt; 0, <span class="charliteral">&#39;R&#39;</span> =&gt; 0, <span class="charliteral">&#39;B&#39;</span> =&gt; 0));</div>
<div class="line"><a name="l21953"></a><span class="lineno">21953</span>&#160;        $enable_thead = <span class="keyword">false</span>;</div>
<div class="line"><a name="l21954"></a><span class="lineno">21954</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;num_columns &gt; 1) {</div>
<div class="line"><a name="l21955"></a><span class="lineno">21955</span>&#160;            <span class="keywordflow">if</span> ($col != $this-&gt;current_column) {</div>
<div class="line"><a name="l21956"></a><span class="lineno">21956</span>&#160;                <span class="comment">// move Y pointer at the top of the column</span></div>
<div class="line"><a name="l21957"></a><span class="lineno">21957</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;column_start_page == $this-&gt;page) {</div>
<div class="line"><a name="l21958"></a><span class="lineno">21958</span>&#160;                    $this-&gt;y = $this-&gt;columns[$col][<span class="charliteral">&#39;y&#39;</span>];</div>
<div class="line"><a name="l21959"></a><span class="lineno">21959</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l21960"></a><span class="lineno">21960</span>&#160;                    $this-&gt;y = $this-&gt;tMargin;</div>
<div class="line"><a name="l21961"></a><span class="lineno">21961</span>&#160;                }</div>
<div class="line"><a name="l21962"></a><span class="lineno">21962</span>&#160;                <span class="comment">// Avoid to write table headers more than once</span></div>
<div class="line"><a name="l21963"></a><span class="lineno">21963</span>&#160;                <span class="keywordflow">if</span> (($this-&gt;page &gt; $this-&gt;maxselcol[<span class="stringliteral">&#39;page&#39;</span>]) OR (($this-&gt;page == $this-&gt;maxselcol[<span class="stringliteral">&#39;page&#39;</span>]) AND ($col &gt; $this-&gt;maxselcol[<span class="stringliteral">&#39;column&#39;</span>]))) {</div>
<div class="line"><a name="l21964"></a><span class="lineno">21964</span>&#160;                    $enable_thead = <span class="keyword">true</span>;</div>
<div class="line"><a name="l21965"></a><span class="lineno">21965</span>&#160;                    $this-&gt;maxselcol[<span class="stringliteral">&#39;page&#39;</span>] = $this-&gt;page;</div>
<div class="line"><a name="l21966"></a><span class="lineno">21966</span>&#160;                    $this-&gt;maxselcol[<span class="stringliteral">&#39;column&#39;</span>] = $col;</div>
<div class="line"><a name="l21967"></a><span class="lineno">21967</span>&#160;                }</div>
<div class="line"><a name="l21968"></a><span class="lineno">21968</span>&#160;            }</div>
<div class="line"><a name="l21969"></a><span class="lineno">21969</span>&#160;            $xshift = $this-&gt;colxshift;</div>
<div class="line"><a name="l21970"></a><span class="lineno">21970</span>&#160;            <span class="comment">// set X position of the current column by case</span></div>
<div class="line"><a name="l21971"></a><span class="lineno">21971</span>&#160;            $listindent = ($this-&gt;listindentlevel * $this-&gt;listindent);</div>
<div class="line"><a name="l21972"></a><span class="lineno">21972</span>&#160;            <span class="comment">// calculate column X position</span></div>
<div class="line"><a name="l21973"></a><span class="lineno">21973</span>&#160;            $colpos = 0;</div>
<div class="line"><a name="l21974"></a><span class="lineno">21974</span>&#160;            <span class="keywordflow">for</span> ($i = 0; $i &lt; $col; ++$i) {</div>
<div class="line"><a name="l21975"></a><span class="lineno">21975</span>&#160;                $colpos += ($this-&gt;columns[$i][<span class="charliteral">&#39;w&#39;</span>] + $this-&gt;columns[$i][<span class="charliteral">&#39;s&#39;</span>]);</div>
<div class="line"><a name="l21976"></a><span class="lineno">21976</span>&#160;            }</div>
<div class="line"><a name="l21977"></a><span class="lineno">21977</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l21978"></a><span class="lineno">21978</span>&#160;                $x = $this-&gt;w - $this-&gt;original_rMargin - $colpos;</div>
<div class="line"><a name="l21979"></a><span class="lineno">21979</span>&#160;                $this-&gt;rMargin = ($this-&gt;w - $x + $listindent);</div>
<div class="line"><a name="l21980"></a><span class="lineno">21980</span>&#160;                $this-&gt;lMargin = ($x - $this-&gt;columns[$col][<span class="charliteral">&#39;w&#39;</span>]);</div>
<div class="line"><a name="l21981"></a><span class="lineno">21981</span>&#160;                $this-&gt;x = $x - $listindent;</div>
<div class="line"><a name="l21982"></a><span class="lineno">21982</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l21983"></a><span class="lineno">21983</span>&#160;                $x = $this-&gt;original_lMargin + $colpos;</div>
<div class="line"><a name="l21984"></a><span class="lineno">21984</span>&#160;                $this-&gt;lMargin = ($x + $listindent);</div>
<div class="line"><a name="l21985"></a><span class="lineno">21985</span>&#160;                $this-&gt;rMargin = ($this-&gt;w - $x - $this-&gt;columns[$col][<span class="charliteral">&#39;w&#39;</span>]);</div>
<div class="line"><a name="l21986"></a><span class="lineno">21986</span>&#160;                $this-&gt;x = $x + $listindent;</div>
<div class="line"><a name="l21987"></a><span class="lineno">21987</span>&#160;            }</div>
<div class="line"><a name="l21988"></a><span class="lineno">21988</span>&#160;            $this-&gt;columns[$col][<span class="charliteral">&#39;x&#39;</span>] = $x;</div>
<div class="line"><a name="l21989"></a><span class="lineno">21989</span>&#160;        }</div>
<div class="line"><a name="l21990"></a><span class="lineno">21990</span>&#160;        $this-&gt;current_column = $col;</div>
<div class="line"><a name="l21991"></a><span class="lineno">21991</span>&#160;        <span class="comment">// fix for HTML mode</span></div>
<div class="line"><a name="l21992"></a><span class="lineno">21992</span>&#160;        $this-&gt;newline = <span class="keyword">true</span>;</div>
<div class="line"><a name="l21993"></a><span class="lineno">21993</span>&#160;        <span class="comment">// print HTML table header (if any)</span></div>
<div class="line"><a name="l21994"></a><span class="lineno">21994</span>&#160;        <span class="keywordflow">if</span> ((!TCPDF_STATIC::empty_string($this-&gt;thead)) AND (!$this-&gt;inthead)) {</div>
<div class="line"><a name="l21995"></a><span class="lineno">21995</span>&#160;            <span class="keywordflow">if</span> ($enable_thead) {</div>
<div class="line"><a name="l21996"></a><span class="lineno">21996</span>&#160;                <span class="comment">// print table header</span></div>
<div class="line"><a name="l21997"></a><span class="lineno">21997</span>&#160;                $this-&gt;writeHTML($this-&gt;thead, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="stringliteral">&#39;&#39;</span>);</div>
<div class="line"><a name="l21998"></a><span class="lineno">21998</span>&#160;                $this-&gt;y += $xshift[<span class="charliteral">&#39;s&#39;</span>][<span class="charliteral">&#39;V&#39;</span>];</div>
<div class="line"><a name="l21999"></a><span class="lineno">21999</span>&#160;                <span class="comment">// store end of header position</span></div>
<div class="line"><a name="l22000"></a><span class="lineno">22000</span>&#160;                <span class="keywordflow">if</span> (!isset($this-&gt;columns[$col][<span class="stringliteral">&#39;th&#39;</span>])) {</div>
<div class="line"><a name="l22001"></a><span class="lineno">22001</span>&#160;                    $this-&gt;columns[$col][<span class="stringliteral">&#39;th&#39;</span>] = array();</div>
<div class="line"><a name="l22002"></a><span class="lineno">22002</span>&#160;                }</div>
<div class="line"><a name="l22003"></a><span class="lineno">22003</span>&#160;                $this-&gt;columns[$col][<span class="stringliteral">&#39;th&#39;</span>][<span class="charliteral">&#39;\&#39;&#39;</span>.$this-&gt;page.<span class="charliteral">&#39;\&#39;&#39;</span>] = $this-&gt;y;</div>
<div class="line"><a name="l22004"></a><span class="lineno">22004</span>&#160;                $this-&gt;lasth = 0;</div>
<div class="line"><a name="l22005"></a><span class="lineno">22005</span>&#160;            } elseif (isset($this-&gt;columns[$col][<span class="stringliteral">&#39;th&#39;</span>][<span class="charliteral">&#39;\&#39;&#39;</span>.$this-&gt;page.<span class="charliteral">&#39;\&#39;&#39;</span>])) {</div>
<div class="line"><a name="l22006"></a><span class="lineno">22006</span>&#160;                $this-&gt;y = $this-&gt;columns[$col][<span class="stringliteral">&#39;th&#39;</span>][<span class="charliteral">&#39;\&#39;&#39;</span>.$this-&gt;page.<span class="charliteral">&#39;\&#39;&#39;</span>];</div>
<div class="line"><a name="l22007"></a><span class="lineno">22007</span>&#160;            }</div>
<div class="line"><a name="l22008"></a><span class="lineno">22008</span>&#160;        }</div>
<div class="line"><a name="l22009"></a><span class="lineno">22009</span>&#160;        <span class="comment">// account for an html table cell over multiple columns</span></div>
<div class="line"><a name="l22010"></a><span class="lineno">22010</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l22011"></a><span class="lineno">22011</span>&#160;            $this-&gt;rMargin += $xshift[<span class="charliteral">&#39;x&#39;</span>];</div>
<div class="line"><a name="l22012"></a><span class="lineno">22012</span>&#160;            $this-&gt;x -= ($xshift[<span class="charliteral">&#39;x&#39;</span>] + $xshift[<span class="charliteral">&#39;p&#39;</span>][<span class="charliteral">&#39;R&#39;</span>]);</div>
<div class="line"><a name="l22013"></a><span class="lineno">22013</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l22014"></a><span class="lineno">22014</span>&#160;            $this-&gt;lMargin += $xshift[<span class="charliteral">&#39;x&#39;</span>];</div>
<div class="line"><a name="l22015"></a><span class="lineno">22015</span>&#160;            $this-&gt;x += $xshift[<span class="charliteral">&#39;x&#39;</span>] + $xshift[<span class="charliteral">&#39;p&#39;</span>][<span class="charliteral">&#39;L&#39;</span>];</div>
<div class="line"><a name="l22016"></a><span class="lineno">22016</span>&#160;        }</div>
<div class="line"><a name="l22017"></a><span class="lineno">22017</span>&#160;    }</div>
<div class="line"><a name="l22018"></a><span class="lineno">22018</span>&#160;</div>
<div class="line"><a name="l22025"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a7db0d9878a041a04273e251228540b56">22025</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a7db0d9878a041a04273e251228540b56">getColumn</a>() {</div>
<div class="line"><a name="l22026"></a><span class="lineno">22026</span>&#160;        <span class="keywordflow">return</span> $this-&gt;current_column;</div>
<div class="line"><a name="l22027"></a><span class="lineno">22027</span>&#160;    }</div>
<div class="line"><a name="l22028"></a><span class="lineno">22028</span>&#160;</div>
<div class="line"><a name="l22035"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a32dee1790e5a2b68404a76c117872b57">22035</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a32dee1790e5a2b68404a76c117872b57">getNumberOfColumns</a>() {</div>
<div class="line"><a name="l22036"></a><span class="lineno">22036</span>&#160;        <span class="keywordflow">return</span> $this-&gt;num_columns;</div>
<div class="line"><a name="l22037"></a><span class="lineno">22037</span>&#160;    }</div>
<div class="line"><a name="l22038"></a><span class="lineno">22038</span>&#160;</div>
<div class="line"><a name="l22047"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aa194abd22d0ba5e5f2c52c5e05f4e107">22047</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#aa194abd22d0ba5e5f2c52c5e05f4e107">setTextRenderingMode</a>($stroke=0, $fill=<span class="keyword">true</span>, $clip=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l22048"></a><span class="lineno">22048</span>&#160;        <span class="comment">// Ref.: PDF 32000-1:2008 - 9.3.6 Text Rendering Mode</span></div>
<div class="line"><a name="l22049"></a><span class="lineno">22049</span>&#160;        <span class="comment">// convert text rendering parameters</span></div>
<div class="line"><a name="l22050"></a><span class="lineno">22050</span>&#160;        <span class="keywordflow">if</span> ($stroke &lt; 0) {</div>
<div class="line"><a name="l22051"></a><span class="lineno">22051</span>&#160;            $stroke = 0;</div>
<div class="line"><a name="l22052"></a><span class="lineno">22052</span>&#160;        }</div>
<div class="line"><a name="l22053"></a><span class="lineno">22053</span>&#160;        <span class="keywordflow">if</span> ($fill === <span class="keyword">true</span>) {</div>
<div class="line"><a name="l22054"></a><span class="lineno">22054</span>&#160;            <span class="keywordflow">if</span> ($stroke &gt; 0) {</div>
<div class="line"><a name="l22055"></a><span class="lineno">22055</span>&#160;                <span class="keywordflow">if</span> ($clip === <span class="keyword">true</span>) {</div>
<div class="line"><a name="l22056"></a><span class="lineno">22056</span>&#160;                    <span class="comment">// Fill, then stroke text and add to path for clipping</span></div>
<div class="line"><a name="l22057"></a><span class="lineno">22057</span>&#160;                    $textrendermode = 6;</div>
<div class="line"><a name="l22058"></a><span class="lineno">22058</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l22059"></a><span class="lineno">22059</span>&#160;                    <span class="comment">// Fill, then stroke text</span></div>
<div class="line"><a name="l22060"></a><span class="lineno">22060</span>&#160;                    $textrendermode = 2;</div>
<div class="line"><a name="l22061"></a><span class="lineno">22061</span>&#160;                }</div>
<div class="line"><a name="l22062"></a><span class="lineno">22062</span>&#160;                $textstrokewidth = $stroke;</div>
<div class="line"><a name="l22063"></a><span class="lineno">22063</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l22064"></a><span class="lineno">22064</span>&#160;                <span class="keywordflow">if</span> ($clip === <span class="keyword">true</span>) {</div>
<div class="line"><a name="l22065"></a><span class="lineno">22065</span>&#160;                    <span class="comment">// Fill text and add to path for clipping</span></div>
<div class="line"><a name="l22066"></a><span class="lineno">22066</span>&#160;                    $textrendermode = 4;</div>
<div class="line"><a name="l22067"></a><span class="lineno">22067</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l22068"></a><span class="lineno">22068</span>&#160;                    <span class="comment">// Fill text</span></div>
<div class="line"><a name="l22069"></a><span class="lineno">22069</span>&#160;                    $textrendermode = 0;</div>
<div class="line"><a name="l22070"></a><span class="lineno">22070</span>&#160;                }</div>
<div class="line"><a name="l22071"></a><span class="lineno">22071</span>&#160;            }</div>
<div class="line"><a name="l22072"></a><span class="lineno">22072</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l22073"></a><span class="lineno">22073</span>&#160;            <span class="keywordflow">if</span> ($stroke &gt; 0) {</div>
<div class="line"><a name="l22074"></a><span class="lineno">22074</span>&#160;                <span class="keywordflow">if</span> ($clip === <span class="keyword">true</span>) {</div>
<div class="line"><a name="l22075"></a><span class="lineno">22075</span>&#160;                    <span class="comment">// Stroke text and add to path for clipping</span></div>
<div class="line"><a name="l22076"></a><span class="lineno">22076</span>&#160;                    $textrendermode = 5;</div>
<div class="line"><a name="l22077"></a><span class="lineno">22077</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l22078"></a><span class="lineno">22078</span>&#160;                    <span class="comment">// Stroke text</span></div>
<div class="line"><a name="l22079"></a><span class="lineno">22079</span>&#160;                    $textrendermode = 1;</div>
<div class="line"><a name="l22080"></a><span class="lineno">22080</span>&#160;                }</div>
<div class="line"><a name="l22081"></a><span class="lineno">22081</span>&#160;                $textstrokewidth = $stroke;</div>
<div class="line"><a name="l22082"></a><span class="lineno">22082</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l22083"></a><span class="lineno">22083</span>&#160;                <span class="keywordflow">if</span> ($clip === <span class="keyword">true</span>) {</div>
<div class="line"><a name="l22084"></a><span class="lineno">22084</span>&#160;                    <span class="comment">// Add text to path for clipping</span></div>
<div class="line"><a name="l22085"></a><span class="lineno">22085</span>&#160;                    $textrendermode = 7;</div>
<div class="line"><a name="l22086"></a><span class="lineno">22086</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l22087"></a><span class="lineno">22087</span>&#160;                    <span class="comment">// Neither fill nor stroke text (invisible)</span></div>
<div class="line"><a name="l22088"></a><span class="lineno">22088</span>&#160;                    $textrendermode = 3;</div>
<div class="line"><a name="l22089"></a><span class="lineno">22089</span>&#160;                }</div>
<div class="line"><a name="l22090"></a><span class="lineno">22090</span>&#160;            }</div>
<div class="line"><a name="l22091"></a><span class="lineno">22091</span>&#160;        }</div>
<div class="line"><a name="l22092"></a><span class="lineno">22092</span>&#160;        $this-&gt;textrendermode = $textrendermode;</div>
<div class="line"><a name="l22093"></a><span class="lineno">22093</span>&#160;        $this-&gt;textstrokewidth = $stroke;</div>
<div class="line"><a name="l22094"></a><span class="lineno">22094</span>&#160;    }</div>
<div class="line"><a name="l22095"></a><span class="lineno">22095</span>&#160;</div>
<div class="line"><a name="l22102"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a7db5d71deb95779481ed9e99fcf3d19a">22102</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a7db5d71deb95779481ed9e99fcf3d19a">setTextShadow</a>($params=array(<span class="stringliteral">&#39;enabled&#39;</span>=&gt;<span class="keyword">false</span>, <span class="stringliteral">&#39;depth_w&#39;</span>=&gt;0, <span class="stringliteral">&#39;depth_h&#39;</span>=&gt;0, <span class="stringliteral">&#39;color&#39;</span>=&gt;<span class="keyword">false</span>, <span class="stringliteral">&#39;opacity&#39;</span>=&gt;1, <span class="stringliteral">&#39;blend_mode&#39;</span>=&gt;<span class="stringliteral">&#39;Normal&#39;</span>)) {</div>
<div class="line"><a name="l22103"></a><span class="lineno">22103</span>&#160;        <span class="keywordflow">if</span> (isset($params[<span class="stringliteral">&#39;enabled&#39;</span>])) {</div>
<div class="line"><a name="l22104"></a><span class="lineno">22104</span>&#160;            $this-&gt;txtshadow[<span class="stringliteral">&#39;enabled&#39;</span>] = $params[<span class="stringliteral">&#39;enabled&#39;</span>]?<span class="keyword">true</span>:<span class="keyword">false</span>;</div>
<div class="line"><a name="l22105"></a><span class="lineno">22105</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l22106"></a><span class="lineno">22106</span>&#160;            $this-&gt;txtshadow[<span class="stringliteral">&#39;enabled&#39;</span>] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l22107"></a><span class="lineno">22107</span>&#160;        }</div>
<div class="line"><a name="l22108"></a><span class="lineno">22108</span>&#160;        <span class="keywordflow">if</span> (isset($params[<span class="stringliteral">&#39;depth_w&#39;</span>])) {</div>
<div class="line"><a name="l22109"></a><span class="lineno">22109</span>&#160;            $this-&gt;txtshadow[<span class="stringliteral">&#39;depth_w&#39;</span>] = floatval($params[<span class="stringliteral">&#39;depth_w&#39;</span>]);</div>
<div class="line"><a name="l22110"></a><span class="lineno">22110</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l22111"></a><span class="lineno">22111</span>&#160;            $this-&gt;txtshadow[<span class="stringliteral">&#39;depth_w&#39;</span>] = 0;</div>
<div class="line"><a name="l22112"></a><span class="lineno">22112</span>&#160;        }</div>
<div class="line"><a name="l22113"></a><span class="lineno">22113</span>&#160;        <span class="keywordflow">if</span> (isset($params[<span class="stringliteral">&#39;depth_h&#39;</span>])) {</div>
<div class="line"><a name="l22114"></a><span class="lineno">22114</span>&#160;            $this-&gt;txtshadow[<span class="stringliteral">&#39;depth_h&#39;</span>] = floatval($params[<span class="stringliteral">&#39;depth_h&#39;</span>]);</div>
<div class="line"><a name="l22115"></a><span class="lineno">22115</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l22116"></a><span class="lineno">22116</span>&#160;            $this-&gt;txtshadow[<span class="stringliteral">&#39;depth_h&#39;</span>] = 0;</div>
<div class="line"><a name="l22117"></a><span class="lineno">22117</span>&#160;        }</div>
<div class="line"><a name="l22118"></a><span class="lineno">22118</span>&#160;        <span class="keywordflow">if</span> (isset($params[<span class="stringliteral">&#39;color&#39;</span>]) AND ($params[<span class="stringliteral">&#39;color&#39;</span>] !== <span class="keyword">false</span>) AND is_array($params[<span class="stringliteral">&#39;color&#39;</span>])) {</div>
<div class="line"><a name="l22119"></a><span class="lineno">22119</span>&#160;            $this-&gt;txtshadow[<span class="stringliteral">&#39;color&#39;</span>] = $params[<span class="stringliteral">&#39;color&#39;</span>];</div>
<div class="line"><a name="l22120"></a><span class="lineno">22120</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l22121"></a><span class="lineno">22121</span>&#160;            $this-&gt;txtshadow[<span class="stringliteral">&#39;color&#39;</span>] = $this-&gt;strokecolor;</div>
<div class="line"><a name="l22122"></a><span class="lineno">22122</span>&#160;        }</div>
<div class="line"><a name="l22123"></a><span class="lineno">22123</span>&#160;        <span class="keywordflow">if</span> (isset($params[<span class="stringliteral">&#39;opacity&#39;</span>])) {</div>
<div class="line"><a name="l22124"></a><span class="lineno">22124</span>&#160;            $this-&gt;txtshadow[<span class="stringliteral">&#39;opacity&#39;</span>] = min(1, max(0, floatval($params[<span class="stringliteral">&#39;opacity&#39;</span>])));</div>
<div class="line"><a name="l22125"></a><span class="lineno">22125</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l22126"></a><span class="lineno">22126</span>&#160;            $this-&gt;txtshadow[<span class="stringliteral">&#39;opacity&#39;</span>] = 1;</div>
<div class="line"><a name="l22127"></a><span class="lineno">22127</span>&#160;        }</div>
<div class="line"><a name="l22128"></a><span class="lineno">22128</span>&#160;        <span class="keywordflow">if</span> (isset($params[<span class="stringliteral">&#39;blend_mode&#39;</span>]) AND in_array($params[<span class="stringliteral">&#39;blend_mode&#39;</span>], array(<span class="stringliteral">&#39;Normal&#39;</span>, <span class="stringliteral">&#39;Multiply&#39;</span>, <span class="stringliteral">&#39;Screen&#39;</span>, <span class="stringliteral">&#39;Overlay&#39;</span>, <span class="stringliteral">&#39;Darken&#39;</span>, <span class="stringliteral">&#39;Lighten&#39;</span>, <span class="stringliteral">&#39;ColorDodge&#39;</span>, <span class="stringliteral">&#39;ColorBurn&#39;</span>, <span class="stringliteral">&#39;HardLight&#39;</span>, <span class="stringliteral">&#39;SoftLight&#39;</span>, <span class="stringliteral">&#39;Difference&#39;</span>, <span class="stringliteral">&#39;Exclusion&#39;</span>, <span class="stringliteral">&#39;Hue&#39;</span>, <span class="stringliteral">&#39;Saturation&#39;</span>, <span class="stringliteral">&#39;Color&#39;</span>, <span class="stringliteral">&#39;Luminosity&#39;</span>))) {</div>
<div class="line"><a name="l22129"></a><span class="lineno">22129</span>&#160;            $this-&gt;txtshadow[<span class="stringliteral">&#39;blend_mode&#39;</span>] = $params[<span class="stringliteral">&#39;blend_mode&#39;</span>];</div>
<div class="line"><a name="l22130"></a><span class="lineno">22130</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l22131"></a><span class="lineno">22131</span>&#160;            $this-&gt;txtshadow[<span class="stringliteral">&#39;blend_mode&#39;</span>] = <span class="stringliteral">&#39;Normal&#39;</span>;</div>
<div class="line"><a name="l22132"></a><span class="lineno">22132</span>&#160;        }</div>
<div class="line"><a name="l22133"></a><span class="lineno">22133</span>&#160;        <span class="keywordflow">if</span> ((($this-&gt;txtshadow[<span class="stringliteral">&#39;depth_w&#39;</span>] == 0) AND ($this-&gt;txtshadow[<span class="stringliteral">&#39;depth_h&#39;</span>] == 0)) OR ($this-&gt;txtshadow[<span class="stringliteral">&#39;opacity&#39;</span>] == 0)) {</div>
<div class="line"><a name="l22134"></a><span class="lineno">22134</span>&#160;            $this-&gt;txtshadow[<span class="stringliteral">&#39;enabled&#39;</span>] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l22135"></a><span class="lineno">22135</span>&#160;        }</div>
<div class="line"><a name="l22136"></a><span class="lineno">22136</span>&#160;    }</div>
<div class="line"><a name="l22137"></a><span class="lineno">22137</span>&#160;</div>
<div class="line"><a name="l22144"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aaabaabe0dbda7572c99b84af46a64a36">22144</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#aaabaabe0dbda7572c99b84af46a64a36">getTextShadow</a>() {</div>
<div class="line"><a name="l22145"></a><span class="lineno">22145</span>&#160;        <span class="keywordflow">return</span> $this-&gt;txtshadow;</div>
<div class="line"><a name="l22146"></a><span class="lineno">22146</span>&#160;    }</div>
<div class="line"><a name="l22147"></a><span class="lineno">22147</span>&#160;</div>
<div class="line"><a name="l22162"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a39aa922f08cdbb517438aaaef43e9cb5">22162</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a39aa922f08cdbb517438aaaef43e9cb5">hyphenateWord</a>($word, $patterns, $dictionary=array(), $leftmin=1, $rightmin=2, $charmin=1, $charmax=8) {</div>
<div class="line"><a name="l22163"></a><span class="lineno">22163</span>&#160;        $hyphenword = array(); <span class="comment">// hyphens positions</span></div>
<div class="line"><a name="l22164"></a><span class="lineno">22164</span>&#160;        $numchars = count($word);</div>
<div class="line"><a name="l22165"></a><span class="lineno">22165</span>&#160;        <span class="keywordflow">if</span> ($numchars &lt;= $charmin) {</div>
<div class="line"><a name="l22166"></a><span class="lineno">22166</span>&#160;            <span class="keywordflow">return</span> $word;</div>
<div class="line"><a name="l22167"></a><span class="lineno">22167</span>&#160;        }</div>
<div class="line"><a name="l22168"></a><span class="lineno">22168</span>&#160;        $word_string = TCPDF_FONTS::UTF8ArrSubString($word, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $this-&gt;isunicode);</div>
<div class="line"><a name="l22169"></a><span class="lineno">22169</span>&#160;        <span class="comment">// some words will be returned as-is</span></div>
<div class="line"><a name="l22170"></a><span class="lineno">22170</span>&#160;        $pattern = <span class="stringliteral">&#39;/^([a-zA-Z0-9_\.\-]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([a-zA-Z0-9\-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/&#39;</span>;</div>
<div class="line"><a name="l22171"></a><span class="lineno">22171</span>&#160;        <span class="keywordflow">if</span> (preg_match($pattern, $word_string) &gt; 0) {</div>
<div class="line"><a name="l22172"></a><span class="lineno">22172</span>&#160;            <span class="comment">// email</span></div>
<div class="line"><a name="l22173"></a><span class="lineno">22173</span>&#160;            <span class="keywordflow">return</span> $word;</div>
<div class="line"><a name="l22174"></a><span class="lineno">22174</span>&#160;        }</div>
<div class="line"><a name="l22175"></a><span class="lineno">22175</span>&#160;        $pattern = <span class="stringliteral">&#39;/(([a-zA-Z0-9\-]+\.)?)((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([a-zA-Z0-9\-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/&#39;</span>;</div>
<div class="line"><a name="l22176"></a><span class="lineno">22176</span>&#160;        <span class="keywordflow">if</span> (preg_match($pattern, $word_string) &gt; 0) {</div>
<div class="line"><a name="l22177"></a><span class="lineno">22177</span>&#160;            <span class="comment">// URL</span></div>
<div class="line"><a name="l22178"></a><span class="lineno">22178</span>&#160;            <span class="keywordflow">return</span> $word;</div>
<div class="line"><a name="l22179"></a><span class="lineno">22179</span>&#160;        }</div>
<div class="line"><a name="l22180"></a><span class="lineno">22180</span>&#160;        <span class="keywordflow">if</span> (isset($dictionary[$word_string])) {</div>
<div class="line"><a name="l22181"></a><span class="lineno">22181</span>&#160;            <span class="keywordflow">return</span> TCPDF_FONTS::UTF8StringToArray($dictionary[$word_string], $this-&gt;isunicode, $this-&gt;CurrentFont);</div>
<div class="line"><a name="l22182"></a><span class="lineno">22182</span>&#160;        }</div>
<div class="line"><a name="l22183"></a><span class="lineno">22183</span>&#160;        <span class="comment">// surround word with &#39;_&#39; characters</span></div>
<div class="line"><a name="l22184"></a><span class="lineno">22184</span>&#160;        $tmpword = array_merge(array(46), $word, array(46));</div>
<div class="line"><a name="l22185"></a><span class="lineno">22185</span>&#160;        $tmpnumchars = $numchars + 2;</div>
<div class="line"><a name="l22186"></a><span class="lineno">22186</span>&#160;        $maxpos = $tmpnumchars - 1;</div>
<div class="line"><a name="l22187"></a><span class="lineno">22187</span>&#160;        <span class="keywordflow">for</span> ($pos = 0; $pos &lt; $maxpos; ++$pos) {</div>
<div class="line"><a name="l22188"></a><span class="lineno">22188</span>&#160;            $imax = min(($tmpnumchars - $pos), $charmax);</div>
<div class="line"><a name="l22189"></a><span class="lineno">22189</span>&#160;            <span class="keywordflow">for</span> ($i = 1; $i &lt;= $imax; ++$i) {</div>
<div class="line"><a name="l22190"></a><span class="lineno">22190</span>&#160;                $subword = strtolower(TCPDF_FONTS::UTF8ArrSubString($tmpword, $pos, ($pos + $i), $this-&gt;isunicode));</div>
<div class="line"><a name="l22191"></a><span class="lineno">22191</span>&#160;                <span class="keywordflow">if</span> (isset($patterns[$subword])) {</div>
<div class="line"><a name="l22192"></a><span class="lineno">22192</span>&#160;                    $pattern = TCPDF_FONTS::UTF8StringToArray($patterns[$subword], $this-&gt;isunicode, $this-&gt;CurrentFont);</div>
<div class="line"><a name="l22193"></a><span class="lineno">22193</span>&#160;                    $pattern_length = count($pattern);</div>
<div class="line"><a name="l22194"></a><span class="lineno">22194</span>&#160;                    $digits = 1;</div>
<div class="line"><a name="l22195"></a><span class="lineno">22195</span>&#160;                    <span class="keywordflow">for</span> ($j = 0; $j &lt; $pattern_length; ++$j) {</div>
<div class="line"><a name="l22196"></a><span class="lineno">22196</span>&#160;                        <span class="comment">// check if $pattern[$j] is a number = hyphenation level (only numbers from 1 to 5 are valid)</span></div>
<div class="line"><a name="l22197"></a><span class="lineno">22197</span>&#160;                        <span class="keywordflow">if</span> (($pattern[$j] &gt;= 48) AND ($pattern[$j] &lt;= 57)) {</div>
<div class="line"><a name="l22198"></a><span class="lineno">22198</span>&#160;                            <span class="keywordflow">if</span> ($j == 0) {</div>
<div class="line"><a name="l22199"></a><span class="lineno">22199</span>&#160;                                $zero = $pos - 1;</div>
<div class="line"><a name="l22200"></a><span class="lineno">22200</span>&#160;                            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l22201"></a><span class="lineno">22201</span>&#160;                                $zero = $pos + $j - $digits;</div>
<div class="line"><a name="l22202"></a><span class="lineno">22202</span>&#160;                            }</div>
<div class="line"><a name="l22203"></a><span class="lineno">22203</span>&#160;                            <span class="comment">// get hyphenation level</span></div>
<div class="line"><a name="l22204"></a><span class="lineno">22204</span>&#160;                            $level = ($pattern[$j] - 48);</div>
<div class="line"><a name="l22205"></a><span class="lineno">22205</span>&#160;                            <span class="comment">// if two levels from two different patterns match at the same point, the higher one is selected.</span></div>
<div class="line"><a name="l22206"></a><span class="lineno">22206</span>&#160;                            <span class="keywordflow">if</span> (!isset($hyphenword[$zero]) OR ($hyphenword[$zero] &lt; $level)) {</div>
<div class="line"><a name="l22207"></a><span class="lineno">22207</span>&#160;                                $hyphenword[$zero] = $level;</div>
<div class="line"><a name="l22208"></a><span class="lineno">22208</span>&#160;                            }</div>
<div class="line"><a name="l22209"></a><span class="lineno">22209</span>&#160;                            ++$digits;</div>
<div class="line"><a name="l22210"></a><span class="lineno">22210</span>&#160;                        }</div>
<div class="line"><a name="l22211"></a><span class="lineno">22211</span>&#160;                    }</div>
<div class="line"><a name="l22212"></a><span class="lineno">22212</span>&#160;                }</div>
<div class="line"><a name="l22213"></a><span class="lineno">22213</span>&#160;            }</div>
<div class="line"><a name="l22214"></a><span class="lineno">22214</span>&#160;        }</div>
<div class="line"><a name="l22215"></a><span class="lineno">22215</span>&#160;        $inserted = 0;</div>
<div class="line"><a name="l22216"></a><span class="lineno">22216</span>&#160;        $maxpos = $numchars - $rightmin;</div>
<div class="line"><a name="l22217"></a><span class="lineno">22217</span>&#160;        <span class="keywordflow">for</span> ($i = $leftmin; $i &lt;= $maxpos; ++$i) {</div>
<div class="line"><a name="l22218"></a><span class="lineno">22218</span>&#160;            <span class="comment">// only odd levels indicate allowed hyphenation points</span></div>
<div class="line"><a name="l22219"></a><span class="lineno">22219</span>&#160;            <span class="keywordflow">if</span> (isset($hyphenword[$i]) AND (($hyphenword[$i] % 2) != 0)) {</div>
<div class="line"><a name="l22220"></a><span class="lineno">22220</span>&#160;                <span class="comment">// 173 = soft hyphen character</span></div>
<div class="line"><a name="l22221"></a><span class="lineno">22221</span>&#160;                array_splice($word, $i + $inserted, 0, 173);</div>
<div class="line"><a name="l22222"></a><span class="lineno">22222</span>&#160;                ++$inserted;</div>
<div class="line"><a name="l22223"></a><span class="lineno">22223</span>&#160;            }</div>
<div class="line"><a name="l22224"></a><span class="lineno">22224</span>&#160;        }</div>
<div class="line"><a name="l22225"></a><span class="lineno">22225</span>&#160;        <span class="keywordflow">return</span> $word;</div>
<div class="line"><a name="l22226"></a><span class="lineno">22226</span>&#160;    }</div>
<div class="line"><a name="l22227"></a><span class="lineno">22227</span>&#160;</div>
<div class="line"><a name="l22242"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a8f7b75b709d2a2c58b569f33cfedf180">22242</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a8f7b75b709d2a2c58b569f33cfedf180">hyphenateText</a>($text, $patterns, $dictionary=array(), $leftmin=1, $rightmin=2, $charmin=1, $charmax=8) {</div>
<div class="line"><a name="l22243"></a><span class="lineno">22243</span>&#160;        $text = $this-&gt;unhtmlentities($text);</div>
<div class="line"><a name="l22244"></a><span class="lineno">22244</span>&#160;        $word = array(); <span class="comment">// last word</span></div>
<div class="line"><a name="l22245"></a><span class="lineno">22245</span>&#160;        $txtarr = array(); <span class="comment">// text to be returned</span></div>
<div class="line"><a name="l22246"></a><span class="lineno">22246</span>&#160;        $intag = <span class="keyword">false</span>; <span class="comment">// true if we are inside an HTML tag</span></div>
<div class="line"><a name="l22247"></a><span class="lineno">22247</span>&#160;        $skip = <span class="keyword">false</span>; <span class="comment">// true to skip hyphenation</span></div>
<div class="line"><a name="l22248"></a><span class="lineno">22248</span>&#160;        <span class="keywordflow">if</span> (!is_array($patterns)) {</div>
<div class="line"><a name="l22249"></a><span class="lineno">22249</span>&#160;            $patterns = TCPDF_STATIC::getHyphenPatternsFromTEX($patterns);</div>
<div class="line"><a name="l22250"></a><span class="lineno">22250</span>&#160;        }</div>
<div class="line"><a name="l22251"></a><span class="lineno">22251</span>&#160;        <span class="comment">// get array of characters</span></div>
<div class="line"><a name="l22252"></a><span class="lineno">22252</span>&#160;        $unichars = TCPDF_FONTS::UTF8StringToArray($text, $this-&gt;isunicode, $this-&gt;CurrentFont);</div>
<div class="line"><a name="l22253"></a><span class="lineno">22253</span>&#160;        <span class="comment">// for each char</span></div>
<div class="line"><a name="l22254"></a><span class="lineno">22254</span>&#160;        <span class="keywordflow">foreach</span> ($unichars as $char) {</div>
<div class="line"><a name="l22255"></a><span class="lineno">22255</span>&#160;            <span class="keywordflow">if</span> ((!$intag) AND (!$skip) AND TCPDF_FONT_DATA::$uni_type[$char] == <span class="charliteral">&#39;L&#39;</span>) {</div>
<div class="line"><a name="l22256"></a><span class="lineno">22256</span>&#160;                <span class="comment">// letter character</span></div>
<div class="line"><a name="l22257"></a><span class="lineno">22257</span>&#160;                $word[] = $char;</div>
<div class="line"><a name="l22258"></a><span class="lineno">22258</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l22259"></a><span class="lineno">22259</span>&#160;                <span class="comment">// other type of character</span></div>
<div class="line"><a name="l22260"></a><span class="lineno">22260</span>&#160;                <span class="keywordflow">if</span> (!TCPDF_STATIC::empty_string($word)) {</div>
<div class="line"><a name="l22261"></a><span class="lineno">22261</span>&#160;                    <span class="comment">// hypenate the word</span></div>
<div class="line"><a name="l22262"></a><span class="lineno">22262</span>&#160;                    $txtarr = array_merge($txtarr, $this-&gt;hyphenateWord($word, $patterns, $dictionary, $leftmin, $rightmin, $charmin, $charmax));</div>
<div class="line"><a name="l22263"></a><span class="lineno">22263</span>&#160;                    $word = array();</div>
<div class="line"><a name="l22264"></a><span class="lineno">22264</span>&#160;                }</div>
<div class="line"><a name="l22265"></a><span class="lineno">22265</span>&#160;                $txtarr[] = $char;</div>
<div class="line"><a name="l22266"></a><span class="lineno">22266</span>&#160;                <span class="keywordflow">if</span> (chr($char) == <span class="charliteral">&#39;&lt;&#39;</span>) {</div>
<div class="line"><a name="l22267"></a><span class="lineno">22267</span>&#160;                    <span class="comment">// we are inside an HTML tag</span></div>
<div class="line"><a name="l22268"></a><span class="lineno">22268</span>&#160;                    $intag = <span class="keyword">true</span>;</div>
<div class="line"><a name="l22269"></a><span class="lineno">22269</span>&#160;                } elseif ($intag AND (chr($char) == <span class="charliteral">&#39;&gt;&#39;</span>)) {</div>
<div class="line"><a name="l22270"></a><span class="lineno">22270</span>&#160;                    <span class="comment">// end of HTML tag</span></div>
<div class="line"><a name="l22271"></a><span class="lineno">22271</span>&#160;                    $intag = <span class="keyword">false</span>;</div>
<div class="line"><a name="l22272"></a><span class="lineno">22272</span>&#160;                    <span class="comment">// check for style tag</span></div>
<div class="line"><a name="l22273"></a><span class="lineno">22273</span>&#160;                    $expected = array(115, 116, 121, 108, 101); <span class="comment">// = &#39;style&#39;</span></div>
<div class="line"><a name="l22274"></a><span class="lineno">22274</span>&#160;                    $current = array_slice($txtarr, -6, 5); <span class="comment">// last 5 chars</span></div>
<div class="line"><a name="l22275"></a><span class="lineno">22275</span>&#160;                    $compare = array_diff($expected, $current);</div>
<div class="line"><a name="l22276"></a><span class="lineno">22276</span>&#160;                    <span class="keywordflow">if</span> (empty($compare)) {</div>
<div class="line"><a name="l22277"></a><span class="lineno">22277</span>&#160;                        <span class="comment">// check if it is a closing tag</span></div>
<div class="line"><a name="l22278"></a><span class="lineno">22278</span>&#160;                        $expected = array(47); <span class="comment">// = &#39;/&#39;</span></div>
<div class="line"><a name="l22279"></a><span class="lineno">22279</span>&#160;                        $current = array_slice($txtarr, -7, 1);</div>
<div class="line"><a name="l22280"></a><span class="lineno">22280</span>&#160;                        $compare = array_diff($expected, $current);</div>
<div class="line"><a name="l22281"></a><span class="lineno">22281</span>&#160;                        <span class="keywordflow">if</span> (empty($compare)) {</div>
<div class="line"><a name="l22282"></a><span class="lineno">22282</span>&#160;                            <span class="comment">// closing style tag</span></div>
<div class="line"><a name="l22283"></a><span class="lineno">22283</span>&#160;                            $skip = <span class="keyword">false</span>;</div>
<div class="line"><a name="l22284"></a><span class="lineno">22284</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l22285"></a><span class="lineno">22285</span>&#160;                            <span class="comment">// opening style tag</span></div>
<div class="line"><a name="l22286"></a><span class="lineno">22286</span>&#160;                            $skip = <span class="keyword">true</span>;</div>
<div class="line"><a name="l22287"></a><span class="lineno">22287</span>&#160;                        }</div>
<div class="line"><a name="l22288"></a><span class="lineno">22288</span>&#160;                    }</div>
<div class="line"><a name="l22289"></a><span class="lineno">22289</span>&#160;                }</div>
<div class="line"><a name="l22290"></a><span class="lineno">22290</span>&#160;            }</div>
<div class="line"><a name="l22291"></a><span class="lineno">22291</span>&#160;        }</div>
<div class="line"><a name="l22292"></a><span class="lineno">22292</span>&#160;        <span class="keywordflow">if</span> (!TCPDF_STATIC::empty_string($word)) {</div>
<div class="line"><a name="l22293"></a><span class="lineno">22293</span>&#160;            <span class="comment">// hypenate the word</span></div>
<div class="line"><a name="l22294"></a><span class="lineno">22294</span>&#160;            $txtarr = array_merge($txtarr, $this-&gt;hyphenateWord($word, $patterns, $dictionary, $leftmin, $rightmin, $charmin, $charmax));</div>
<div class="line"><a name="l22295"></a><span class="lineno">22295</span>&#160;        }</div>
<div class="line"><a name="l22296"></a><span class="lineno">22296</span>&#160;        <span class="comment">// convert char array to string and return</span></div>
<div class="line"><a name="l22297"></a><span class="lineno">22297</span>&#160;        <span class="keywordflow">return</span> TCPDF_FONTS::UTF8ArrSubString($txtarr, <span class="stringliteral">&#39;&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $this-&gt;isunicode);</div>
<div class="line"><a name="l22298"></a><span class="lineno">22298</span>&#160;    }</div>
<div class="line"><a name="l22299"></a><span class="lineno">22299</span>&#160;</div>
<div class="line"><a name="l22306"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a568b961f0419fcc3edd28f9bb50bab86">22306</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a568b961f0419fcc3edd28f9bb50bab86">setRasterizeVectorImages</a>($mode) {</div>
<div class="line"><a name="l22307"></a><span class="lineno">22307</span>&#160;        $this-&gt;rasterize_vector_images = $mode;</div>
<div class="line"><a name="l22308"></a><span class="lineno">22308</span>&#160;    }</div>
<div class="line"><a name="l22309"></a><span class="lineno">22309</span>&#160;</div>
<div class="line"><a name="l22317"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a08aec0a405ab1a1a311bf20aacc5b36d">22317</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a08aec0a405ab1a1a311bf20aacc5b36d">setFontSubsetting</a>($enable=<span class="keyword">true</span>) {</div>
<div class="line"><a name="l22318"></a><span class="lineno">22318</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;pdfa_mode) {</div>
<div class="line"><a name="l22319"></a><span class="lineno">22319</span>&#160;            $this-&gt;font_subsetting = <span class="keyword">false</span>;</div>
<div class="line"><a name="l22320"></a><span class="lineno">22320</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l22321"></a><span class="lineno">22321</span>&#160;            $this-&gt;font_subsetting = $enable ? <span class="keyword">true</span> : <span class="keyword">false</span>;</div>
<div class="line"><a name="l22322"></a><span class="lineno">22322</span>&#160;        }</div>
<div class="line"><a name="l22323"></a><span class="lineno">22323</span>&#160;    }</div>
<div class="line"><a name="l22324"></a><span class="lineno">22324</span>&#160;</div>
<div class="line"><a name="l22332"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ad00f8a524481e110dd8b6da59934252c">22332</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ad00f8a524481e110dd8b6da59934252c">getFontSubsetting</a>() {</div>
<div class="line"><a name="l22333"></a><span class="lineno">22333</span>&#160;        <span class="keywordflow">return</span> $this-&gt;font_subsetting;</div>
<div class="line"><a name="l22334"></a><span class="lineno">22334</span>&#160;    }</div>
<div class="line"><a name="l22335"></a><span class="lineno">22335</span>&#160;</div>
<div class="line"><a name="l22345"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a0a25521fa461d9d52aabce5687795650">22345</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a0a25521fa461d9d52aabce5687795650">stringLeftTrim</a>($str, $replace=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l22346"></a><span class="lineno">22346</span>&#160;        <span class="keywordflow">return</span> preg_replace(<span class="stringliteral">&#39;/^&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;p&#39;</span>].<span class="stringliteral">&#39;+/&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;m&#39;</span>], $replace, $str);</div>
<div class="line"><a name="l22347"></a><span class="lineno">22347</span>&#160;    }</div>
<div class="line"><a name="l22348"></a><span class="lineno">22348</span>&#160;</div>
<div class="line"><a name="l22358"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aa198175b5bdc3ed8663efa6b5286a74a">22358</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#aa198175b5bdc3ed8663efa6b5286a74a">stringRightTrim</a>($str, $replace=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l22359"></a><span class="lineno">22359</span>&#160;        <span class="keywordflow">return</span> preg_replace(<span class="charliteral">&#39;/&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;p&#39;</span>].<span class="stringliteral">&#39;+$/&#39;</span>.$this-&gt;re_space[<span class="charliteral">&#39;m&#39;</span>], $replace, $str);</div>
<div class="line"><a name="l22360"></a><span class="lineno">22360</span>&#160;    }</div>
<div class="line"><a name="l22361"></a><span class="lineno">22361</span>&#160;</div>
<div class="line"><a name="l22371"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#abdc6aa462bc81023df2ec043742bcb4b">22371</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#abdc6aa462bc81023df2ec043742bcb4b">stringTrim</a>($str, $replace=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l22372"></a><span class="lineno">22372</span>&#160;        $str = $this-&gt;stringLeftTrim($str, $replace);</div>
<div class="line"><a name="l22373"></a><span class="lineno">22373</span>&#160;        $str = $this-&gt;stringRightTrim($str, $replace);</div>
<div class="line"><a name="l22374"></a><span class="lineno">22374</span>&#160;        <span class="keywordflow">return</span> $str;</div>
<div class="line"><a name="l22375"></a><span class="lineno">22375</span>&#160;    }</div>
<div class="line"><a name="l22376"></a><span class="lineno">22376</span>&#160;</div>
<div class="line"><a name="l22384"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a81c8257af5d6d6e40f1bb77d6b507b97">22384</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a81c8257af5d6d6e40f1bb77d6b507b97">isUnicodeFont</a>() {</div>
<div class="line"><a name="l22385"></a><span class="lineno">22385</span>&#160;        <span class="keywordflow">return</span> (($this-&gt;CurrentFont[<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;TrueTypeUnicode&#39;</span>) OR ($this-&gt;CurrentFont[<span class="stringliteral">&#39;type&#39;</span>] == <span class="stringliteral">&#39;cidfont0&#39;</span>));</div>
<div class="line"><a name="l22386"></a><span class="lineno">22386</span>&#160;    }</div>
<div class="line"><a name="l22387"></a><span class="lineno">22387</span>&#160;</div>
<div class="line"><a name="l22396"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a1454645fa7a1e35f6f8a634c0978ed2e">22396</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a1454645fa7a1e35f6f8a634c0978ed2e">getFontFamilyName</a>($fontfamily) {</div>
<div class="line"><a name="l22397"></a><span class="lineno">22397</span>&#160;        <span class="comment">// remove spaces and symbols</span></div>
<div class="line"><a name="l22398"></a><span class="lineno">22398</span>&#160;        $fontfamily = preg_replace(<span class="stringliteral">&#39;/[^a-z0-9_\,]/&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, strtolower($fontfamily));</div>
<div class="line"><a name="l22399"></a><span class="lineno">22399</span>&#160;        <span class="comment">// extract all font names</span></div>
<div class="line"><a name="l22400"></a><span class="lineno">22400</span>&#160;        $fontslist = preg_split(<span class="stringliteral">&#39;/[,]/&#39;</span>, $fontfamily);</div>
<div class="line"><a name="l22401"></a><span class="lineno">22401</span>&#160;        <span class="comment">// find first valid font name</span></div>
<div class="line"><a name="l22402"></a><span class="lineno">22402</span>&#160;        <span class="keywordflow">foreach</span> ($fontslist as $font) {</div>
<div class="line"><a name="l22403"></a><span class="lineno">22403</span>&#160;            <span class="comment">// replace font variations</span></div>
<div class="line"><a name="l22404"></a><span class="lineno">22404</span>&#160;            $font = preg_replace(<span class="stringliteral">&#39;/regular$/&#39;</span>, <span class="stringliteral">&#39;&#39;</span>, $font);</div>
<div class="line"><a name="l22405"></a><span class="lineno">22405</span>&#160;            $font = preg_replace(<span class="stringliteral">&#39;/italic$/&#39;</span>, <span class="charliteral">&#39;I&#39;</span>, $font);</div>
<div class="line"><a name="l22406"></a><span class="lineno">22406</span>&#160;            $font = preg_replace(<span class="stringliteral">&#39;/oblique$/&#39;</span>, <span class="charliteral">&#39;I&#39;</span>, $font);</div>
<div class="line"><a name="l22407"></a><span class="lineno">22407</span>&#160;            $font = preg_replace(<span class="stringliteral">&#39;/bold([I]?)$/&#39;</span>, <span class="stringliteral">&#39;B\\1&#39;</span>, $font);</div>
<div class="line"><a name="l22408"></a><span class="lineno">22408</span>&#160;            <span class="comment">// replace common family names and core fonts</span></div>
<div class="line"><a name="l22409"></a><span class="lineno">22409</span>&#160;            $pattern = array();</div>
<div class="line"><a name="l22410"></a><span class="lineno">22410</span>&#160;            $replacement = array();</div>
<div class="line"><a name="l22411"></a><span class="lineno">22411</span>&#160;            $pattern[] = <span class="stringliteral">&#39;/^serif|^cursive|^fantasy|^timesnewroman/&#39;</span>;</div>
<div class="line"><a name="l22412"></a><span class="lineno">22412</span>&#160;            $replacement[] = <span class="stringliteral">&#39;times&#39;</span>;</div>
<div class="line"><a name="l22413"></a><span class="lineno">22413</span>&#160;            $pattern[] = <span class="stringliteral">&#39;/^sansserif/&#39;</span>;</div>
<div class="line"><a name="l22414"></a><span class="lineno">22414</span>&#160;            $replacement[] = <span class="stringliteral">&#39;helvetica&#39;</span>;</div>
<div class="line"><a name="l22415"></a><span class="lineno">22415</span>&#160;            $pattern[] = <span class="stringliteral">&#39;/^monospace/&#39;</span>;</div>
<div class="line"><a name="l22416"></a><span class="lineno">22416</span>&#160;            $replacement[] = <span class="stringliteral">&#39;courier&#39;</span>;</div>
<div class="line"><a name="l22417"></a><span class="lineno">22417</span>&#160;            $font = preg_replace($pattern, $replacement, $font);</div>
<div class="line"><a name="l22418"></a><span class="lineno">22418</span>&#160;            <span class="keywordflow">if</span> (in_array(strtolower($font), $this-&gt;fontlist) OR in_array($font, $this-&gt;fontkeys)) {</div>
<div class="line"><a name="l22419"></a><span class="lineno">22419</span>&#160;                <span class="keywordflow">return</span> $font;</div>
<div class="line"><a name="l22420"></a><span class="lineno">22420</span>&#160;            }</div>
<div class="line"><a name="l22421"></a><span class="lineno">22421</span>&#160;        }</div>
<div class="line"><a name="l22422"></a><span class="lineno">22422</span>&#160;        <span class="comment">// return current font as default</span></div>
<div class="line"><a name="l22423"></a><span class="lineno">22423</span>&#160;        <span class="keywordflow">return</span> $this-&gt;CurrentFont[<span class="stringliteral">&#39;fontkey&#39;</span>];</div>
<div class="line"><a name="l22424"></a><span class="lineno">22424</span>&#160;    }</div>
<div class="line"><a name="l22425"></a><span class="lineno">22425</span>&#160;</div>
<div class="line"><a name="l22440"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a7eae5df3511dac591b5b76ab5d8b9a68">22440</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a7eae5df3511dac591b5b76ab5d8b9a68">startTemplate</a>($w=0, $h=0, $group=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l22441"></a><span class="lineno">22441</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;inxobj) {</div>
<div class="line"><a name="l22442"></a><span class="lineno">22442</span>&#160;            <span class="comment">// we are already inside an XObject template</span></div>
<div class="line"><a name="l22443"></a><span class="lineno">22443</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l22444"></a><span class="lineno">22444</span>&#160;        }</div>
<div class="line"><a name="l22445"></a><span class="lineno">22445</span>&#160;        $this-&gt;inxobj = <span class="keyword">true</span>;</div>
<div class="line"><a name="l22446"></a><span class="lineno">22446</span>&#160;        ++$this-&gt;n;</div>
<div class="line"><a name="l22447"></a><span class="lineno">22447</span>&#160;        <span class="comment">// XObject ID</span></div>
<div class="line"><a name="l22448"></a><span class="lineno">22448</span>&#160;        $this-&gt;xobjid = <span class="stringliteral">&#39;XT&#39;</span>.$this-&gt;n;</div>
<div class="line"><a name="l22449"></a><span class="lineno">22449</span>&#160;        <span class="comment">// object ID</span></div>
<div class="line"><a name="l22450"></a><span class="lineno">22450</span>&#160;        $this-&gt;xobjects[$this-&gt;xobjid] = array(<span class="charliteral">&#39;n&#39;</span> =&gt; $this-&gt;n);</div>
<div class="line"><a name="l22451"></a><span class="lineno">22451</span>&#160;        <span class="comment">// store current graphic state</span></div>
<div class="line"><a name="l22452"></a><span class="lineno">22452</span>&#160;        $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;gvars&#39;</span>] = $this-&gt;getGraphicVars();</div>
<div class="line"><a name="l22453"></a><span class="lineno">22453</span>&#160;        <span class="comment">// initialize data</span></div>
<div class="line"><a name="l22454"></a><span class="lineno">22454</span>&#160;        $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;intmrk&#39;</span>] = 0;</div>
<div class="line"><a name="l22455"></a><span class="lineno">22455</span>&#160;        $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;transfmrk&#39;</span>] = array();</div>
<div class="line"><a name="l22456"></a><span class="lineno">22456</span>&#160;        $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;outdata&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l22457"></a><span class="lineno">22457</span>&#160;        $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;xobjects&#39;</span>] = array();</div>
<div class="line"><a name="l22458"></a><span class="lineno">22458</span>&#160;        $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;images&#39;</span>] = array();</div>
<div class="line"><a name="l22459"></a><span class="lineno">22459</span>&#160;        $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;fonts&#39;</span>] = array();</div>
<div class="line"><a name="l22460"></a><span class="lineno">22460</span>&#160;        $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;annotations&#39;</span>] = array();</div>
<div class="line"><a name="l22461"></a><span class="lineno">22461</span>&#160;        $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;extgstates&#39;</span>] = array();</div>
<div class="line"><a name="l22462"></a><span class="lineno">22462</span>&#160;        $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;gradients&#39;</span>] = array();</div>
<div class="line"><a name="l22463"></a><span class="lineno">22463</span>&#160;        $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;spot_colors&#39;</span>] = array();</div>
<div class="line"><a name="l22464"></a><span class="lineno">22464</span>&#160;        <span class="comment">// set new environment</span></div>
<div class="line"><a name="l22465"></a><span class="lineno">22465</span>&#160;        $this-&gt;num_columns = 1;</div>
<div class="line"><a name="l22466"></a><span class="lineno">22466</span>&#160;        $this-&gt;current_column = 0;</div>
<div class="line"><a name="l22467"></a><span class="lineno">22467</span>&#160;        $this-&gt;SetAutoPageBreak(<span class="keyword">false</span>);</div>
<div class="line"><a name="l22468"></a><span class="lineno">22468</span>&#160;        <span class="keywordflow">if</span> (($w === <span class="stringliteral">&#39;&#39;</span>) OR ($w &lt;= 0)) {</div>
<div class="line"><a name="l22469"></a><span class="lineno">22469</span>&#160;            $w = $this-&gt;w - $this-&gt;lMargin - $this-&gt;rMargin;</div>
<div class="line"><a name="l22470"></a><span class="lineno">22470</span>&#160;        }</div>
<div class="line"><a name="l22471"></a><span class="lineno">22471</span>&#160;        <span class="keywordflow">if</span> (($h === <span class="stringliteral">&#39;&#39;</span>) OR ($h &lt;= 0)) {</div>
<div class="line"><a name="l22472"></a><span class="lineno">22472</span>&#160;            $h = $this-&gt;h - $this-&gt;tMargin - $this-&gt;bMargin;</div>
<div class="line"><a name="l22473"></a><span class="lineno">22473</span>&#160;        }</div>
<div class="line"><a name="l22474"></a><span class="lineno">22474</span>&#160;        $this-&gt;xobjects[$this-&gt;xobjid][<span class="charliteral">&#39;x&#39;</span>] = 0;</div>
<div class="line"><a name="l22475"></a><span class="lineno">22475</span>&#160;        $this-&gt;xobjects[$this-&gt;xobjid][<span class="charliteral">&#39;y&#39;</span>] = 0;</div>
<div class="line"><a name="l22476"></a><span class="lineno">22476</span>&#160;        $this-&gt;xobjects[$this-&gt;xobjid][<span class="charliteral">&#39;w&#39;</span>] = $w;</div>
<div class="line"><a name="l22477"></a><span class="lineno">22477</span>&#160;        $this-&gt;xobjects[$this-&gt;xobjid][<span class="charliteral">&#39;h&#39;</span>] = $h;</div>
<div class="line"><a name="l22478"></a><span class="lineno">22478</span>&#160;        $this-&gt;w = $w;</div>
<div class="line"><a name="l22479"></a><span class="lineno">22479</span>&#160;        $this-&gt;h = $h;</div>
<div class="line"><a name="l22480"></a><span class="lineno">22480</span>&#160;        $this-&gt;wPt = $this-&gt;w * $this-&gt;k;</div>
<div class="line"><a name="l22481"></a><span class="lineno">22481</span>&#160;        $this-&gt;hPt = $this-&gt;h * $this-&gt;k;</div>
<div class="line"><a name="l22482"></a><span class="lineno">22482</span>&#160;        $this-&gt;fwPt = $this-&gt;wPt;</div>
<div class="line"><a name="l22483"></a><span class="lineno">22483</span>&#160;        $this-&gt;fhPt = $this-&gt;hPt;</div>
<div class="line"><a name="l22484"></a><span class="lineno">22484</span>&#160;        $this-&gt;x = 0;</div>
<div class="line"><a name="l22485"></a><span class="lineno">22485</span>&#160;        $this-&gt;y = 0;</div>
<div class="line"><a name="l22486"></a><span class="lineno">22486</span>&#160;        $this-&gt;lMargin = 0;</div>
<div class="line"><a name="l22487"></a><span class="lineno">22487</span>&#160;        $this-&gt;rMargin = 0;</div>
<div class="line"><a name="l22488"></a><span class="lineno">22488</span>&#160;        $this-&gt;tMargin = 0;</div>
<div class="line"><a name="l22489"></a><span class="lineno">22489</span>&#160;        $this-&gt;bMargin = 0;</div>
<div class="line"><a name="l22490"></a><span class="lineno">22490</span>&#160;        <span class="comment">// set group mode</span></div>
<div class="line"><a name="l22491"></a><span class="lineno">22491</span>&#160;        $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;group&#39;</span>] = $group;</div>
<div class="line"><a name="l22492"></a><span class="lineno">22492</span>&#160;        <span class="keywordflow">return</span> $this-&gt;xobjid;</div>
<div class="line"><a name="l22493"></a><span class="lineno">22493</span>&#160;    }</div>
<div class="line"><a name="l22494"></a><span class="lineno">22494</span>&#160;</div>
<div class="line"><a name="l22505"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a0b98de81d99a1a0e983dd0016e30fc75">22505</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a0b98de81d99a1a0e983dd0016e30fc75">endTemplate</a>() {</div>
<div class="line"><a name="l22506"></a><span class="lineno">22506</span>&#160;        <span class="keywordflow">if</span> (!$this-&gt;inxobj) {</div>
<div class="line"><a name="l22507"></a><span class="lineno">22507</span>&#160;            <span class="comment">// we are not inside a template</span></div>
<div class="line"><a name="l22508"></a><span class="lineno">22508</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l22509"></a><span class="lineno">22509</span>&#160;        }</div>
<div class="line"><a name="l22510"></a><span class="lineno">22510</span>&#160;        $this-&gt;inxobj = <span class="keyword">false</span>;</div>
<div class="line"><a name="l22511"></a><span class="lineno">22511</span>&#160;        <span class="comment">// restore previous graphic state</span></div>
<div class="line"><a name="l22512"></a><span class="lineno">22512</span>&#160;        $this-&gt;setGraphicVars($this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;gvars&#39;</span>], <span class="keyword">true</span>);</div>
<div class="line"><a name="l22513"></a><span class="lineno">22513</span>&#160;        <span class="keywordflow">return</span> $this-&gt;xobjid;</div>
<div class="line"><a name="l22514"></a><span class="lineno">22514</span>&#160;    }</div>
<div class="line"><a name="l22515"></a><span class="lineno">22515</span>&#160;</div>
<div class="line"><a name="l22534"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a3a58677c9c6a6e9e7702fcb3041b7253">22534</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a3a58677c9c6a6e9e7702fcb3041b7253">printTemplate</a>($id, $x=<span class="stringliteral">&#39;&#39;</span>, $y=<span class="stringliteral">&#39;&#39;</span>, $w=0, $h=0, $align=<span class="stringliteral">&#39;&#39;</span>, $palign=<span class="stringliteral">&#39;&#39;</span>, $fitonpage=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l22535"></a><span class="lineno">22535</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;state != 2) {</div>
<div class="line"><a name="l22536"></a><span class="lineno">22536</span>&#160;             <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l22537"></a><span class="lineno">22537</span>&#160;        }</div>
<div class="line"><a name="l22538"></a><span class="lineno">22538</span>&#160;        <span class="keywordflow">if</span> (!isset($this-&gt;xobjects[$id])) {</div>
<div class="line"><a name="l22539"></a><span class="lineno">22539</span>&#160;            $this-&gt;Error(<span class="stringliteral">&#39;The XObject Template \&#39;&#39;</span>.$id.<span class="charliteral">&#39;\&#39;</span> doesn\<span class="stringliteral">&#39;t exist!&#39;</span>);</div>
<div class="line"><a name="l22540"></a><span class="lineno">22540</span>&#160;        }</div>
<div class="line"><a name="l22541"></a><span class="lineno">22541</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;inxobj) {</div>
<div class="line"><a name="l22542"></a><span class="lineno">22542</span>&#160;            <span class="keywordflow">if</span> ($id == $this-&gt;xobjid) {</div>
<div class="line"><a name="l22543"></a><span class="lineno">22543</span>&#160;                <span class="comment">// close current template</span></div>
<div class="line"><a name="l22544"></a><span class="lineno">22544</span>&#160;                $this-&gt;endTemplate();</div>
<div class="line"><a name="l22545"></a><span class="lineno">22545</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l22546"></a><span class="lineno">22546</span>&#160;                <span class="comment">// use the template as resource for the template currently opened</span></div>
<div class="line"><a name="l22547"></a><span class="lineno">22547</span>&#160;                $this-&gt;xobjects[$this-&gt;xobjid][<span class="stringliteral">&#39;xobjects&#39;</span>][$id] = $this-&gt;xobjects[$id];</div>
<div class="line"><a name="l22548"></a><span class="lineno">22548</span>&#160;            }</div>
<div class="line"><a name="l22549"></a><span class="lineno">22549</span>&#160;        }</div>
<div class="line"><a name="l22550"></a><span class="lineno">22550</span>&#160;        <span class="comment">// set default values</span></div>
<div class="line"><a name="l22551"></a><span class="lineno">22551</span>&#160;        <span class="keywordflow">if</span> ($x === <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l22552"></a><span class="lineno">22552</span>&#160;            $x = $this-&gt;x;</div>
<div class="line"><a name="l22553"></a><span class="lineno">22553</span>&#160;        }</div>
<div class="line"><a name="l22554"></a><span class="lineno">22554</span>&#160;        <span class="keywordflow">if</span> ($y === <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l22555"></a><span class="lineno">22555</span>&#160;            $y = $this-&gt;y;</div>
<div class="line"><a name="l22556"></a><span class="lineno">22556</span>&#160;        }</div>
<div class="line"><a name="l22557"></a><span class="lineno">22557</span>&#160;        <span class="comment">// check page for no-write regions and adapt page margins if necessary</span></div>
<div class="line"><a name="l22558"></a><span class="lineno">22558</span>&#160;        list($x, $y) = $this-&gt;checkPageRegions($h, $x, $y);</div>
<div class="line"><a name="l22559"></a><span class="lineno">22559</span>&#160;        $ow = $this-&gt;xobjects[$id][<span class="charliteral">&#39;w&#39;</span>];</div>
<div class="line"><a name="l22560"></a><span class="lineno">22560</span>&#160;        <span class="keywordflow">if</span> ($ow &lt;= 0) {</div>
<div class="line"><a name="l22561"></a><span class="lineno">22561</span>&#160;            $ow = 1;</div>
<div class="line"><a name="l22562"></a><span class="lineno">22562</span>&#160;        }</div>
<div class="line"><a name="l22563"></a><span class="lineno">22563</span>&#160;        $oh = $this-&gt;xobjects[$id][<span class="charliteral">&#39;h&#39;</span>];</div>
<div class="line"><a name="l22564"></a><span class="lineno">22564</span>&#160;        <span class="keywordflow">if</span> ($oh &lt;= 0) {</div>
<div class="line"><a name="l22565"></a><span class="lineno">22565</span>&#160;            $oh = 1;</div>
<div class="line"><a name="l22566"></a><span class="lineno">22566</span>&#160;        }</div>
<div class="line"><a name="l22567"></a><span class="lineno">22567</span>&#160;        <span class="comment">// calculate template width and height on document</span></div>
<div class="line"><a name="l22568"></a><span class="lineno">22568</span>&#160;        <span class="keywordflow">if</span> (($w &lt;= 0) AND ($h &lt;= 0)) {</div>
<div class="line"><a name="l22569"></a><span class="lineno">22569</span>&#160;            $w = $ow;</div>
<div class="line"><a name="l22570"></a><span class="lineno">22570</span>&#160;            $h = $oh;</div>
<div class="line"><a name="l22571"></a><span class="lineno">22571</span>&#160;        } elseif ($w &lt;= 0) {</div>
<div class="line"><a name="l22572"></a><span class="lineno">22572</span>&#160;            $w = $h * $ow / $oh;</div>
<div class="line"><a name="l22573"></a><span class="lineno">22573</span>&#160;        } elseif ($h &lt;= 0) {</div>
<div class="line"><a name="l22574"></a><span class="lineno">22574</span>&#160;            $h = $w * $oh / $ow;</div>
<div class="line"><a name="l22575"></a><span class="lineno">22575</span>&#160;        }</div>
<div class="line"><a name="l22576"></a><span class="lineno">22576</span>&#160;        <span class="comment">// fit the template on available space</span></div>
<div class="line"><a name="l22577"></a><span class="lineno">22577</span>&#160;        list($w, $h, $x, $y) = $this-&gt;fitBlock($w, $h, $x, $y, $fitonpage);</div>
<div class="line"><a name="l22578"></a><span class="lineno">22578</span>&#160;        <span class="comment">// set page alignment</span></div>
<div class="line"><a name="l22579"></a><span class="lineno">22579</span>&#160;        $rb_y = $y + $h;</div>
<div class="line"><a name="l22580"></a><span class="lineno">22580</span>&#160;        <span class="comment">// set alignment</span></div>
<div class="line"><a name="l22581"></a><span class="lineno">22581</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l22582"></a><span class="lineno">22582</span>&#160;            <span class="keywordflow">if</span> ($palign == <span class="charliteral">&#39;L&#39;</span>) {</div>
<div class="line"><a name="l22583"></a><span class="lineno">22583</span>&#160;                $xt = $this-&gt;lMargin;</div>
<div class="line"><a name="l22584"></a><span class="lineno">22584</span>&#160;            } elseif ($palign == <span class="charliteral">&#39;C&#39;</span>) {</div>
<div class="line"><a name="l22585"></a><span class="lineno">22585</span>&#160;                $xt = ($this-&gt;w + $this-&gt;lMargin - $this-&gt;rMargin - $w) / 2;</div>
<div class="line"><a name="l22586"></a><span class="lineno">22586</span>&#160;            } elseif ($palign == <span class="charliteral">&#39;R&#39;</span>) {</div>
<div class="line"><a name="l22587"></a><span class="lineno">22587</span>&#160;                $xt = $this-&gt;w - $this-&gt;rMargin - $w;</div>
<div class="line"><a name="l22588"></a><span class="lineno">22588</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l22589"></a><span class="lineno">22589</span>&#160;                $xt = $x - $w;</div>
<div class="line"><a name="l22590"></a><span class="lineno">22590</span>&#160;            }</div>
<div class="line"><a name="l22591"></a><span class="lineno">22591</span>&#160;            $rb_x = $xt;</div>
<div class="line"><a name="l22592"></a><span class="lineno">22592</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l22593"></a><span class="lineno">22593</span>&#160;            <span class="keywordflow">if</span> ($palign == <span class="charliteral">&#39;L&#39;</span>) {</div>
<div class="line"><a name="l22594"></a><span class="lineno">22594</span>&#160;                $xt = $this-&gt;lMargin;</div>
<div class="line"><a name="l22595"></a><span class="lineno">22595</span>&#160;            } elseif ($palign == <span class="charliteral">&#39;C&#39;</span>) {</div>
<div class="line"><a name="l22596"></a><span class="lineno">22596</span>&#160;                $xt = ($this-&gt;w + $this-&gt;lMargin - $this-&gt;rMargin - $w) / 2;</div>
<div class="line"><a name="l22597"></a><span class="lineno">22597</span>&#160;            } elseif ($palign == <span class="charliteral">&#39;R&#39;</span>) {</div>
<div class="line"><a name="l22598"></a><span class="lineno">22598</span>&#160;                $xt = $this-&gt;w - $this-&gt;rMargin - $w;</div>
<div class="line"><a name="l22599"></a><span class="lineno">22599</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l22600"></a><span class="lineno">22600</span>&#160;                $xt = $x;</div>
<div class="line"><a name="l22601"></a><span class="lineno">22601</span>&#160;            }</div>
<div class="line"><a name="l22602"></a><span class="lineno">22602</span>&#160;            $rb_x = $xt + $w;</div>
<div class="line"><a name="l22603"></a><span class="lineno">22603</span>&#160;        }</div>
<div class="line"><a name="l22604"></a><span class="lineno">22604</span>&#160;        <span class="comment">// print XObject Template + Transformation matrix</span></div>
<div class="line"><a name="l22605"></a><span class="lineno">22605</span>&#160;        $this-&gt;StartTransform();</div>
<div class="line"><a name="l22606"></a><span class="lineno">22606</span>&#160;        <span class="comment">// translate and scale</span></div>
<div class="line"><a name="l22607"></a><span class="lineno">22607</span>&#160;        $sx = ($w / $ow);</div>
<div class="line"><a name="l22608"></a><span class="lineno">22608</span>&#160;        $sy = ($h / $oh);</div>
<div class="line"><a name="l22609"></a><span class="lineno">22609</span>&#160;        $tm = array();</div>
<div class="line"><a name="l22610"></a><span class="lineno">22610</span>&#160;        $tm[0] = $sx;</div>
<div class="line"><a name="l22611"></a><span class="lineno">22611</span>&#160;        $tm[1] = 0;</div>
<div class="line"><a name="l22612"></a><span class="lineno">22612</span>&#160;        $tm[2] = 0;</div>
<div class="line"><a name="l22613"></a><span class="lineno">22613</span>&#160;        $tm[3] = $sy;</div>
<div class="line"><a name="l22614"></a><span class="lineno">22614</span>&#160;        $tm[4] = $xt * $this-&gt;k;</div>
<div class="line"><a name="l22615"></a><span class="lineno">22615</span>&#160;        $tm[5] = ($this-&gt;h - $h - $y) * $this-&gt;k;</div>
<div class="line"><a name="l22616"></a><span class="lineno">22616</span>&#160;        $this-&gt;Transform($tm);</div>
<div class="line"><a name="l22617"></a><span class="lineno">22617</span>&#160;        <span class="comment">// set object</span></div>
<div class="line"><a name="l22618"></a><span class="lineno">22618</span>&#160;        $this-&gt;_out(<span class="charliteral">&#39;/&#39;</span>.$id.<span class="stringliteral">&#39; Do&#39;</span>);</div>
<div class="line"><a name="l22619"></a><span class="lineno">22619</span>&#160;        $this-&gt;StopTransform();</div>
<div class="line"><a name="l22620"></a><span class="lineno">22620</span>&#160;        <span class="comment">// add annotations</span></div>
<div class="line"><a name="l22621"></a><span class="lineno">22621</span>&#160;        <span class="keywordflow">if</span> (!empty($this-&gt;xobjects[$id][<span class="stringliteral">&#39;annotations&#39;</span>])) {</div>
<div class="line"><a name="l22622"></a><span class="lineno">22622</span>&#160;            <span class="keywordflow">foreach</span> ($this-&gt;xobjects[$id][<span class="stringliteral">&#39;annotations&#39;</span>] as $annot) {</div>
<div class="line"><a name="l22623"></a><span class="lineno">22623</span>&#160;                <span class="comment">// transform original coordinates</span></div>
<div class="line"><a name="l22624"></a><span class="lineno">22624</span>&#160;                $coordlt = TCPDF_STATIC::getTransformationMatrixProduct($tm, array(1, 0, 0, 1, ($annot[<span class="charliteral">&#39;x&#39;</span>] * $this-&gt;k), (-$annot[<span class="charliteral">&#39;y&#39;</span>] * $this-&gt;k)));</div>
<div class="line"><a name="l22625"></a><span class="lineno">22625</span>&#160;                $ax = ($coordlt[4] / $this-&gt;k);</div>
<div class="line"><a name="l22626"></a><span class="lineno">22626</span>&#160;                $ay = ($this-&gt;h - $h - ($coordlt[5] / $this-&gt;k));</div>
<div class="line"><a name="l22627"></a><span class="lineno">22627</span>&#160;                $coordrb = TCPDF_STATIC::getTransformationMatrixProduct($tm, array(1, 0, 0, 1, (($annot[<span class="charliteral">&#39;x&#39;</span>] + $annot[<span class="charliteral">&#39;w&#39;</span>]) * $this-&gt;k), ((-$annot[<span class="charliteral">&#39;y&#39;</span>] - $annot[<span class="charliteral">&#39;h&#39;</span>]) * $this-&gt;k)));</div>
<div class="line"><a name="l22628"></a><span class="lineno">22628</span>&#160;                $aw = ($coordrb[4] / $this-&gt;k) - $ax;</div>
<div class="line"><a name="l22629"></a><span class="lineno">22629</span>&#160;                $ah = ($this-&gt;h - $h - ($coordrb[5] / $this-&gt;k)) - $ay;</div>
<div class="line"><a name="l22630"></a><span class="lineno">22630</span>&#160;                $this-&gt;Annotation($ax, $ay, $aw, $ah, $annot[<span class="stringliteral">&#39;text&#39;</span>], $annot[<span class="stringliteral">&#39;opt&#39;</span>], $annot[<span class="stringliteral">&#39;spaces&#39;</span>]);</div>
<div class="line"><a name="l22631"></a><span class="lineno">22631</span>&#160;            }</div>
<div class="line"><a name="l22632"></a><span class="lineno">22632</span>&#160;        }</div>
<div class="line"><a name="l22633"></a><span class="lineno">22633</span>&#160;        <span class="comment">// set pointer to align the next text/objects</span></div>
<div class="line"><a name="l22634"></a><span class="lineno">22634</span>&#160;        <span class="keywordflow">switch</span>($align) {</div>
<div class="line"><a name="l22635"></a><span class="lineno">22635</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>: {</div>
<div class="line"><a name="l22636"></a><span class="lineno">22636</span>&#160;                $this-&gt;y = $y;</div>
<div class="line"><a name="l22637"></a><span class="lineno">22637</span>&#160;                $this-&gt;x = $rb_x;</div>
<div class="line"><a name="l22638"></a><span class="lineno">22638</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l22639"></a><span class="lineno">22639</span>&#160;            }</div>
<div class="line"><a name="l22640"></a><span class="lineno">22640</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;M&#39;</span>: {</div>
<div class="line"><a name="l22641"></a><span class="lineno">22641</span>&#160;                $this-&gt;y = $y + round($h/2);</div>
<div class="line"><a name="l22642"></a><span class="lineno">22642</span>&#160;                $this-&gt;x = $rb_x;</div>
<div class="line"><a name="l22643"></a><span class="lineno">22643</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l22644"></a><span class="lineno">22644</span>&#160;            }</div>
<div class="line"><a name="l22645"></a><span class="lineno">22645</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>: {</div>
<div class="line"><a name="l22646"></a><span class="lineno">22646</span>&#160;                $this-&gt;y = $rb_y;</div>
<div class="line"><a name="l22647"></a><span class="lineno">22647</span>&#160;                $this-&gt;x = $rb_x;</div>
<div class="line"><a name="l22648"></a><span class="lineno">22648</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l22649"></a><span class="lineno">22649</span>&#160;            }</div>
<div class="line"><a name="l22650"></a><span class="lineno">22650</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;N&#39;</span>: {</div>
<div class="line"><a name="l22651"></a><span class="lineno">22651</span>&#160;                $this-&gt;SetY($rb_y);</div>
<div class="line"><a name="l22652"></a><span class="lineno">22652</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l22653"></a><span class="lineno">22653</span>&#160;            }</div>
<div class="line"><a name="l22654"></a><span class="lineno">22654</span>&#160;            <span class="keywordflow">default</span>:{</div>
<div class="line"><a name="l22655"></a><span class="lineno">22655</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l22656"></a><span class="lineno">22656</span>&#160;            }</div>
<div class="line"><a name="l22657"></a><span class="lineno">22657</span>&#160;        }</div>
<div class="line"><a name="l22658"></a><span class="lineno">22658</span>&#160;    }</div>
<div class="line"><a name="l22659"></a><span class="lineno">22659</span>&#160;</div>
<div class="line"><a name="l22667"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ad69e13e0b99d5d72440bc95cde06dbcd">22667</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ad69e13e0b99d5d72440bc95cde06dbcd">setFontStretching</a>($perc=100) {</div>
<div class="line"><a name="l22668"></a><span class="lineno">22668</span>&#160;        $this-&gt;font_stretching = $perc;</div>
<div class="line"><a name="l22669"></a><span class="lineno">22669</span>&#160;    }</div>
<div class="line"><a name="l22670"></a><span class="lineno">22670</span>&#160;</div>
<div class="line"><a name="l22678"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a6765cafbc343aeacdcbd0a97c6c90ca5">22678</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a6765cafbc343aeacdcbd0a97c6c90ca5">getFontStretching</a>() {</div>
<div class="line"><a name="l22679"></a><span class="lineno">22679</span>&#160;        <span class="keywordflow">return</span> $this-&gt;font_stretching;</div>
<div class="line"><a name="l22680"></a><span class="lineno">22680</span>&#160;    }</div>
<div class="line"><a name="l22681"></a><span class="lineno">22681</span>&#160;</div>
<div class="line"><a name="l22689"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aa9d049671275dc2a39e4654f3028544c">22689</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#aa9d049671275dc2a39e4654f3028544c">setFontSpacing</a>($spacing=0) {</div>
<div class="line"><a name="l22690"></a><span class="lineno">22690</span>&#160;        $this-&gt;font_spacing = $spacing;</div>
<div class="line"><a name="l22691"></a><span class="lineno">22691</span>&#160;    }</div>
<div class="line"><a name="l22692"></a><span class="lineno">22692</span>&#160;</div>
<div class="line"><a name="l22700"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a917bed78601b25201a9c507d841fc538">22700</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a917bed78601b25201a9c507d841fc538">getFontSpacing</a>() {</div>
<div class="line"><a name="l22701"></a><span class="lineno">22701</span>&#160;        <span class="keywordflow">return</span> $this-&gt;font_spacing;</div>
<div class="line"><a name="l22702"></a><span class="lineno">22702</span>&#160;    }</div>
<div class="line"><a name="l22703"></a><span class="lineno">22703</span>&#160;</div>
<div class="line"><a name="l22712"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#aca0a3c26e95c17b68bd0a5420f88629b">22712</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#aca0a3c26e95c17b68bd0a5420f88629b">getPageRegions</a>() {</div>
<div class="line"><a name="l22713"></a><span class="lineno">22713</span>&#160;        <span class="keywordflow">return</span> $this-&gt;page_regions;</div>
<div class="line"><a name="l22714"></a><span class="lineno">22714</span>&#160;    }</div>
<div class="line"><a name="l22715"></a><span class="lineno">22715</span>&#160;</div>
<div class="line"><a name="l22727"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a996483e91d4c2567d354e3c4a755d4bc">22727</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a996483e91d4c2567d354e3c4a755d4bc">setPageRegions</a>($regions=array()) {</div>
<div class="line"><a name="l22728"></a><span class="lineno">22728</span>&#160;        <span class="comment">// empty current regions array</span></div>
<div class="line"><a name="l22729"></a><span class="lineno">22729</span>&#160;        $this-&gt;page_regions = array();</div>
<div class="line"><a name="l22730"></a><span class="lineno">22730</span>&#160;        <span class="comment">// add regions</span></div>
<div class="line"><a name="l22731"></a><span class="lineno">22731</span>&#160;        <span class="keywordflow">foreach</span> ($regions as $data) {</div>
<div class="line"><a name="l22732"></a><span class="lineno">22732</span>&#160;            $this-&gt;addPageRegion($data);</div>
<div class="line"><a name="l22733"></a><span class="lineno">22733</span>&#160;        }</div>
<div class="line"><a name="l22734"></a><span class="lineno">22734</span>&#160;    }</div>
<div class="line"><a name="l22735"></a><span class="lineno">22735</span>&#160;</div>
<div class="line"><a name="l22747"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a7416404adf787407cc9c87effbbb8d1e">22747</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a7416404adf787407cc9c87effbbb8d1e">addPageRegion</a>($region) {</div>
<div class="line"><a name="l22748"></a><span class="lineno">22748</span>&#160;        <span class="keywordflow">if</span> (!isset($region[<span class="stringliteral">&#39;page&#39;</span>]) OR empty($region[<span class="stringliteral">&#39;page&#39;</span>])) {</div>
<div class="line"><a name="l22749"></a><span class="lineno">22749</span>&#160;            $region[<span class="stringliteral">&#39;page&#39;</span>] = $this-&gt;page;</div>
<div class="line"><a name="l22750"></a><span class="lineno">22750</span>&#160;        }</div>
<div class="line"><a name="l22751"></a><span class="lineno">22751</span>&#160;        <span class="keywordflow">if</span> (isset($region[<span class="stringliteral">&#39;xt&#39;</span>]) AND isset($region[<span class="stringliteral">&#39;xb&#39;</span>]) AND ($region[<span class="stringliteral">&#39;xt&#39;</span>] &gt; 0) AND ($region[<span class="stringliteral">&#39;xb&#39;</span>] &gt; 0)</div>
<div class="line"><a name="l22752"></a><span class="lineno">22752</span>&#160;            AND isset($region[<span class="stringliteral">&#39;yt&#39;</span>])  AND isset($region[<span class="stringliteral">&#39;yb&#39;</span>]) AND ($region[<span class="stringliteral">&#39;yt&#39;</span>] &gt;= 0) AND ($region[<span class="stringliteral">&#39;yt&#39;</span>] &lt; $region[<span class="stringliteral">&#39;yb&#39;</span>])</div>
<div class="line"><a name="l22753"></a><span class="lineno">22753</span>&#160;            AND isset($region[<span class="stringliteral">&#39;side&#39;</span>]) AND (($region[<span class="stringliteral">&#39;side&#39;</span>] == <span class="charliteral">&#39;L&#39;</span>) OR ($region[<span class="stringliteral">&#39;side&#39;</span>] == <span class="charliteral">&#39;R&#39;</span>))) {</div>
<div class="line"><a name="l22754"></a><span class="lineno">22754</span>&#160;            $this-&gt;page_regions[] = $region;</div>
<div class="line"><a name="l22755"></a><span class="lineno">22755</span>&#160;        }</div>
<div class="line"><a name="l22756"></a><span class="lineno">22756</span>&#160;    }</div>
<div class="line"><a name="l22757"></a><span class="lineno">22757</span>&#160;</div>
<div class="line"><a name="l22766"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a2a5521c59a12125acade8485634c04ec">22766</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a2a5521c59a12125acade8485634c04ec">removePageRegion</a>($key) {</div>
<div class="line"><a name="l22767"></a><span class="lineno">22767</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;page_regions[$key])) {</div>
<div class="line"><a name="l22768"></a><span class="lineno">22768</span>&#160;            unset($this-&gt;page_regions[$key]);</div>
<div class="line"><a name="l22769"></a><span class="lineno">22769</span>&#160;        }</div>
<div class="line"><a name="l22770"></a><span class="lineno">22770</span>&#160;    }</div>
<div class="line"><a name="l22771"></a><span class="lineno">22771</span>&#160;</div>
<div class="line"><a name="l22784"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a1d99e81697a90efb13a6734001427f40">22784</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a1d99e81697a90efb13a6734001427f40">checkPageRegions</a>($h, $x, $y) {</div>
<div class="line"><a name="l22785"></a><span class="lineno">22785</span>&#160;        <span class="comment">// set default values</span></div>
<div class="line"><a name="l22786"></a><span class="lineno">22786</span>&#160;        <span class="keywordflow">if</span> ($x === <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l22787"></a><span class="lineno">22787</span>&#160;            $x = $this-&gt;x;</div>
<div class="line"><a name="l22788"></a><span class="lineno">22788</span>&#160;        }</div>
<div class="line"><a name="l22789"></a><span class="lineno">22789</span>&#160;        <span class="keywordflow">if</span> ($y === <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l22790"></a><span class="lineno">22790</span>&#160;            $y = $this-&gt;y;</div>
<div class="line"><a name="l22791"></a><span class="lineno">22791</span>&#160;        }</div>
<div class="line"><a name="l22792"></a><span class="lineno">22792</span>&#160;        <span class="keywordflow">if</span> (!$this-&gt;check_page_regions OR empty($this-&gt;page_regions)) {</div>
<div class="line"><a name="l22793"></a><span class="lineno">22793</span>&#160;            <span class="comment">// no page regions defined</span></div>
<div class="line"><a name="l22794"></a><span class="lineno">22794</span>&#160;            <span class="keywordflow">return</span> array($x, $y);</div>
<div class="line"><a name="l22795"></a><span class="lineno">22795</span>&#160;        }</div>
<div class="line"><a name="l22796"></a><span class="lineno">22796</span>&#160;        <span class="keywordflow">if</span> (empty($h)) {</div>
<div class="line"><a name="l22797"></a><span class="lineno">22797</span>&#160;            $h = $this-&gt;getCellHeight($this-&gt;FontSize);</div>
<div class="line"><a name="l22798"></a><span class="lineno">22798</span>&#160;        }</div>
<div class="line"><a name="l22799"></a><span class="lineno">22799</span>&#160;        <span class="comment">// check for page break</span></div>
<div class="line"><a name="l22800"></a><span class="lineno">22800</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;checkPageBreak($h, $y)) {</div>
<div class="line"><a name="l22801"></a><span class="lineno">22801</span>&#160;            <span class="comment">// the content will be printed on a new page</span></div>
<div class="line"><a name="l22802"></a><span class="lineno">22802</span>&#160;            $x = $this-&gt;x;</div>
<div class="line"><a name="l22803"></a><span class="lineno">22803</span>&#160;            $y = $this-&gt;y;</div>
<div class="line"><a name="l22804"></a><span class="lineno">22804</span>&#160;        }</div>
<div class="line"><a name="l22805"></a><span class="lineno">22805</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;num_columns &gt; 1) {</div>
<div class="line"><a name="l22806"></a><span class="lineno">22806</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l22807"></a><span class="lineno">22807</span>&#160;                $this-&gt;lMargin = ($this-&gt;columns[$this-&gt;current_column][<span class="charliteral">&#39;x&#39;</span>] - $this-&gt;columns[$this-&gt;current_column][<span class="charliteral">&#39;w&#39;</span>]);</div>
<div class="line"><a name="l22808"></a><span class="lineno">22808</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l22809"></a><span class="lineno">22809</span>&#160;                $this-&gt;rMargin = ($this-&gt;w - $this-&gt;columns[$this-&gt;current_column][<span class="charliteral">&#39;x&#39;</span>] - $this-&gt;columns[$this-&gt;current_column][<span class="charliteral">&#39;w&#39;</span>]);</div>
<div class="line"><a name="l22810"></a><span class="lineno">22810</span>&#160;            }</div>
<div class="line"><a name="l22811"></a><span class="lineno">22811</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l22812"></a><span class="lineno">22812</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l22813"></a><span class="lineno">22813</span>&#160;                $this-&gt;lMargin = max($this-&gt;clMargin, $this-&gt;original_lMargin);</div>
<div class="line"><a name="l22814"></a><span class="lineno">22814</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l22815"></a><span class="lineno">22815</span>&#160;                $this-&gt;rMargin = max($this-&gt;crMargin, $this-&gt;original_rMargin);</div>
<div class="line"><a name="l22816"></a><span class="lineno">22816</span>&#160;            }</div>
<div class="line"><a name="l22817"></a><span class="lineno">22817</span>&#160;        }</div>
<div class="line"><a name="l22818"></a><span class="lineno">22818</span>&#160;        <span class="comment">// adjust coordinates and page margins</span></div>
<div class="line"><a name="l22819"></a><span class="lineno">22819</span>&#160;        <span class="keywordflow">foreach</span> ($this-&gt;page_regions as $regid =&gt; $regdata) {</div>
<div class="line"><a name="l22820"></a><span class="lineno">22820</span>&#160;            <span class="keywordflow">if</span> ($regdata[<span class="stringliteral">&#39;page&#39;</span>] == $this-&gt;page) {</div>
<div class="line"><a name="l22821"></a><span class="lineno">22821</span>&#160;                <span class="comment">// check region boundaries</span></div>
<div class="line"><a name="l22822"></a><span class="lineno">22822</span>&#160;                <span class="keywordflow">if</span> (($y &gt; ($regdata[<span class="stringliteral">&#39;yt&#39;</span>] - $h)) AND ($y &lt;= $regdata[<span class="stringliteral">&#39;yb&#39;</span>])) {</div>
<div class="line"><a name="l22823"></a><span class="lineno">22823</span>&#160;                    <span class="comment">// Y is inside the region</span></div>
<div class="line"><a name="l22824"></a><span class="lineno">22824</span>&#160;                    $minv = ($regdata[<span class="stringliteral">&#39;xb&#39;</span>] - $regdata[<span class="stringliteral">&#39;xt&#39;</span>]) / ($regdata[<span class="stringliteral">&#39;yb&#39;</span>] - $regdata[<span class="stringliteral">&#39;yt&#39;</span>]); <span class="comment">// inverse of angular coefficient</span></div>
<div class="line"><a name="l22825"></a><span class="lineno">22825</span>&#160;                    $yt = max($y, $regdata[<span class="stringliteral">&#39;yt&#39;</span>]);</div>
<div class="line"><a name="l22826"></a><span class="lineno">22826</span>&#160;                    $yb = min(($yt + $h), $regdata[<span class="stringliteral">&#39;yb&#39;</span>]);</div>
<div class="line"><a name="l22827"></a><span class="lineno">22827</span>&#160;                    $xt = (($yt - $regdata[<span class="stringliteral">&#39;yt&#39;</span>]) * $minv) + $regdata[<span class="stringliteral">&#39;xt&#39;</span>];</div>
<div class="line"><a name="l22828"></a><span class="lineno">22828</span>&#160;                    $xb = (($yb - $regdata[<span class="stringliteral">&#39;yt&#39;</span>]) * $minv) + $regdata[<span class="stringliteral">&#39;xt&#39;</span>];</div>
<div class="line"><a name="l22829"></a><span class="lineno">22829</span>&#160;                    <span class="keywordflow">if</span> ($regdata[<span class="stringliteral">&#39;side&#39;</span>] == <span class="charliteral">&#39;L&#39;</span>) { <span class="comment">// left side</span></div>
<div class="line"><a name="l22830"></a><span class="lineno">22830</span>&#160;                        $new_margin = max($xt, $xb);</div>
<div class="line"><a name="l22831"></a><span class="lineno">22831</span>&#160;                        <span class="keywordflow">if</span> ($this-&gt;lMargin &lt; $new_margin) {</div>
<div class="line"><a name="l22832"></a><span class="lineno">22832</span>&#160;                            <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l22833"></a><span class="lineno">22833</span>&#160;                                <span class="comment">// adjust left page margin</span></div>
<div class="line"><a name="l22834"></a><span class="lineno">22834</span>&#160;                                $this-&gt;lMargin = max(0, $new_margin);</div>
<div class="line"><a name="l22835"></a><span class="lineno">22835</span>&#160;                            }</div>
<div class="line"><a name="l22836"></a><span class="lineno">22836</span>&#160;                            <span class="keywordflow">if</span> ($x &lt; $new_margin) {</div>
<div class="line"><a name="l22837"></a><span class="lineno">22837</span>&#160;                                <span class="comment">// adjust x position</span></div>
<div class="line"><a name="l22838"></a><span class="lineno">22838</span>&#160;                                $x = $new_margin;</div>
<div class="line"><a name="l22839"></a><span class="lineno">22839</span>&#160;                                <span class="keywordflow">if</span> ($new_margin &gt; ($this-&gt;w - $this-&gt;rMargin)) {</div>
<div class="line"><a name="l22840"></a><span class="lineno">22840</span>&#160;                                    <span class="comment">// adjust y position</span></div>
<div class="line"><a name="l22841"></a><span class="lineno">22841</span>&#160;                                    $y = $regdata[<span class="stringliteral">&#39;yb&#39;</span>] - $h;</div>
<div class="line"><a name="l22842"></a><span class="lineno">22842</span>&#160;                                }</div>
<div class="line"><a name="l22843"></a><span class="lineno">22843</span>&#160;                            }</div>
<div class="line"><a name="l22844"></a><span class="lineno">22844</span>&#160;                        }</div>
<div class="line"><a name="l22845"></a><span class="lineno">22845</span>&#160;                    } elseif ($regdata[<span class="stringliteral">&#39;side&#39;</span>] == <span class="charliteral">&#39;R&#39;</span>) { <span class="comment">// right side</span></div>
<div class="line"><a name="l22846"></a><span class="lineno">22846</span>&#160;                        $new_margin = min($xt, $xb);</div>
<div class="line"><a name="l22847"></a><span class="lineno">22847</span>&#160;                        <span class="keywordflow">if</span> (($this-&gt;w - $this-&gt;rMargin) &gt; $new_margin) {</div>
<div class="line"><a name="l22848"></a><span class="lineno">22848</span>&#160;                            <span class="keywordflow">if</span> (!$this-&gt;rtl) {</div>
<div class="line"><a name="l22849"></a><span class="lineno">22849</span>&#160;                                <span class="comment">// adjust right page margin</span></div>
<div class="line"><a name="l22850"></a><span class="lineno">22850</span>&#160;                                $this-&gt;rMargin = max(0, ($this-&gt;w - $new_margin));</div>
<div class="line"><a name="l22851"></a><span class="lineno">22851</span>&#160;                            }</div>
<div class="line"><a name="l22852"></a><span class="lineno">22852</span>&#160;                            <span class="keywordflow">if</span> ($x &gt; $new_margin) {</div>
<div class="line"><a name="l22853"></a><span class="lineno">22853</span>&#160;                                <span class="comment">// adjust x position</span></div>
<div class="line"><a name="l22854"></a><span class="lineno">22854</span>&#160;                                $x = $new_margin;</div>
<div class="line"><a name="l22855"></a><span class="lineno">22855</span>&#160;                                <span class="keywordflow">if</span> ($new_margin &gt; $this-&gt;lMargin) {</div>
<div class="line"><a name="l22856"></a><span class="lineno">22856</span>&#160;                                    <span class="comment">// adjust y position</span></div>
<div class="line"><a name="l22857"></a><span class="lineno">22857</span>&#160;                                    $y = $regdata[<span class="stringliteral">&#39;yb&#39;</span>] - $h;</div>
<div class="line"><a name="l22858"></a><span class="lineno">22858</span>&#160;                                }</div>
<div class="line"><a name="l22859"></a><span class="lineno">22859</span>&#160;                            }</div>
<div class="line"><a name="l22860"></a><span class="lineno">22860</span>&#160;                        }</div>
<div class="line"><a name="l22861"></a><span class="lineno">22861</span>&#160;                    }</div>
<div class="line"><a name="l22862"></a><span class="lineno">22862</span>&#160;                }</div>
<div class="line"><a name="l22863"></a><span class="lineno">22863</span>&#160;            }</div>
<div class="line"><a name="l22864"></a><span class="lineno">22864</span>&#160;        }</div>
<div class="line"><a name="l22865"></a><span class="lineno">22865</span>&#160;        <span class="keywordflow">return</span> array($x, $y);</div>
<div class="line"><a name="l22866"></a><span class="lineno">22866</span>&#160;    }</div>
<div class="line"><a name="l22867"></a><span class="lineno">22867</span>&#160;</div>
<div class="line"><a name="l22868"></a><span class="lineno">22868</span>&#160;    <span class="comment">// --- SVG METHODS ---------------------------------------------------------</span></div>
<div class="line"><a name="l22869"></a><span class="lineno">22869</span>&#160;</div>
<div class="line"><a name="l22887"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a56536508fb1b5aede7d2ed27f56c2353">22887</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a56536508fb1b5aede7d2ed27f56c2353">ImageSVG</a>($file, $x=<span class="stringliteral">&#39;&#39;</span>, $y=<span class="stringliteral">&#39;&#39;</span>, $w=0, $h=0, $link=<span class="stringliteral">&#39;&#39;</span>, $align=<span class="stringliteral">&#39;&#39;</span>, $palign=<span class="stringliteral">&#39;&#39;</span>, $border=0, $fitonpage=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l22888"></a><span class="lineno">22888</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;state != 2) {</div>
<div class="line"><a name="l22889"></a><span class="lineno">22889</span>&#160;             <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l22890"></a><span class="lineno">22890</span>&#160;        }</div>
<div class="line"><a name="l22891"></a><span class="lineno">22891</span>&#160;        <span class="comment">// reseet SVG vars</span></div>
<div class="line"><a name="l22892"></a><span class="lineno">22892</span>&#160;        $this-&gt;svggradients = array();</div>
<div class="line"><a name="l22893"></a><span class="lineno">22893</span>&#160;        $this-&gt;svggradientid = 0;</div>
<div class="line"><a name="l22894"></a><span class="lineno">22894</span>&#160;        $this-&gt;svgdefsmode = <span class="keyword">false</span>;</div>
<div class="line"><a name="l22895"></a><span class="lineno">22895</span>&#160;        $this-&gt;svgdefs = array();</div>
<div class="line"><a name="l22896"></a><span class="lineno">22896</span>&#160;        $this-&gt;svgclipmode = <span class="keyword">false</span>;</div>
<div class="line"><a name="l22897"></a><span class="lineno">22897</span>&#160;        $this-&gt;svgclippaths = array();</div>
<div class="line"><a name="l22898"></a><span class="lineno">22898</span>&#160;        $this-&gt;svgcliptm = array();</div>
<div class="line"><a name="l22899"></a><span class="lineno">22899</span>&#160;        $this-&gt;svgclipid = 0;</div>
<div class="line"><a name="l22900"></a><span class="lineno">22900</span>&#160;        $this-&gt;svgtext = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l22901"></a><span class="lineno">22901</span>&#160;        $this-&gt;svgtextmode = array();</div>
<div class="line"><a name="l22902"></a><span class="lineno">22902</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;rasterize_vector_images AND ($w &gt; 0) AND ($h &gt; 0)) {</div>
<div class="line"><a name="l22903"></a><span class="lineno">22903</span>&#160;            <span class="comment">// convert SVG to raster image using GD or ImageMagick libraries</span></div>
<div class="line"><a name="l22904"></a><span class="lineno">22904</span>&#160;            <span class="keywordflow">return</span> $this-&gt;Image($file, $x, $y, $w, $h, <span class="stringliteral">&#39;SVG&#39;</span>, $link, $align, <span class="keyword">true</span>, 300, $palign, <span class="keyword">false</span>, <span class="keyword">false</span>, $border, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l22905"></a><span class="lineno">22905</span>&#160;        }</div>
<div class="line"><a name="l22906"></a><span class="lineno">22906</span>&#160;        <span class="keywordflow">if</span> ($file[0] === <span class="charliteral">&#39;@&#39;</span>) { <span class="comment">// image from string</span></div>
<div class="line"><a name="l22907"></a><span class="lineno">22907</span>&#160;            $this-&gt;svgdir = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l22908"></a><span class="lineno">22908</span>&#160;            $svgdata = substr($file, 1);</div>
<div class="line"><a name="l22909"></a><span class="lineno">22909</span>&#160;        } <span class="keywordflow">else</span> { <span class="comment">// SVG file</span></div>
<div class="line"><a name="l22910"></a><span class="lineno">22910</span>&#160;            $this-&gt;svgdir = dirname($file);</div>
<div class="line"><a name="l22911"></a><span class="lineno">22911</span>&#160;            $svgdata = TCPDF_STATIC::fileGetContents($file);</div>
<div class="line"><a name="l22912"></a><span class="lineno">22912</span>&#160;        }</div>
<div class="line"><a name="l22913"></a><span class="lineno">22913</span>&#160;        <span class="keywordflow">if</span> ($svgdata === FALSE) {</div>
<div class="line"><a name="l22914"></a><span class="lineno">22914</span>&#160;            $this-&gt;Error(<span class="stringliteral">&#39;SVG file not found: &#39;</span>.$file);</div>
<div class="line"><a name="l22915"></a><span class="lineno">22915</span>&#160;        }</div>
<div class="line"><a name="l22916"></a><span class="lineno">22916</span>&#160;        <span class="keywordflow">if</span> ($x === <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l22917"></a><span class="lineno">22917</span>&#160;            $x = $this-&gt;x;</div>
<div class="line"><a name="l22918"></a><span class="lineno">22918</span>&#160;        }</div>
<div class="line"><a name="l22919"></a><span class="lineno">22919</span>&#160;        <span class="keywordflow">if</span> ($y === <span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l22920"></a><span class="lineno">22920</span>&#160;            $y = $this-&gt;y;</div>
<div class="line"><a name="l22921"></a><span class="lineno">22921</span>&#160;        }</div>
<div class="line"><a name="l22922"></a><span class="lineno">22922</span>&#160;        <span class="comment">// check page for no-write regions and adapt page margins if necessary</span></div>
<div class="line"><a name="l22923"></a><span class="lineno">22923</span>&#160;        list($x, $y) = $this-&gt;checkPageRegions($h, $x, $y);</div>
<div class="line"><a name="l22924"></a><span class="lineno">22924</span>&#160;        $k = $this-&gt;k;</div>
<div class="line"><a name="l22925"></a><span class="lineno">22925</span>&#160;        $ox = 0;</div>
<div class="line"><a name="l22926"></a><span class="lineno">22926</span>&#160;        $oy = 0;</div>
<div class="line"><a name="l22927"></a><span class="lineno">22927</span>&#160;        $ow = $w;</div>
<div class="line"><a name="l22928"></a><span class="lineno">22928</span>&#160;        $oh = $h;</div>
<div class="line"><a name="l22929"></a><span class="lineno">22929</span>&#160;        $aspect_ratio_align = <span class="stringliteral">&#39;xMidYMid&#39;</span>;</div>
<div class="line"><a name="l22930"></a><span class="lineno">22930</span>&#160;        $aspect_ratio_ms = <span class="stringliteral">&#39;meet&#39;</span>;</div>
<div class="line"><a name="l22931"></a><span class="lineno">22931</span>&#160;        $regs = array();</div>
<div class="line"><a name="l22932"></a><span class="lineno">22932</span>&#160;        <span class="comment">// get original image width and height</span></div>
<div class="line"><a name="l22933"></a><span class="lineno">22933</span>&#160;        preg_match(<span class="stringliteral">&#39;/&lt;svg([^&gt;]*)&gt;/si&#39;</span>, $svgdata, $regs);</div>
<div class="line"><a name="l22934"></a><span class="lineno">22934</span>&#160;        <span class="keywordflow">if</span> (isset($regs[1]) AND !empty($regs[1])) {</div>
<div class="line"><a name="l22935"></a><span class="lineno">22935</span>&#160;            $tmp = array();</div>
<div class="line"><a name="l22936"></a><span class="lineno">22936</span>&#160;            <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/[\s]+x[\s]*=[\s]*&quot;([^&quot;]*)&quot;/si&#39;</span>, $regs[1], $tmp)) {</div>
<div class="line"><a name="l22937"></a><span class="lineno">22937</span>&#160;                $ox = $this-&gt;getHTMLUnitToUnits($tmp[1], 0, $this-&gt;svgunit, <span class="keyword">false</span>);</div>
<div class="line"><a name="l22938"></a><span class="lineno">22938</span>&#160;            }</div>
<div class="line"><a name="l22939"></a><span class="lineno">22939</span>&#160;            $tmp = array();</div>
<div class="line"><a name="l22940"></a><span class="lineno">22940</span>&#160;            <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/[\s]+y[\s]*=[\s]*&quot;([^&quot;]*)&quot;/si&#39;</span>, $regs[1], $tmp)) {</div>
<div class="line"><a name="l22941"></a><span class="lineno">22941</span>&#160;                $oy = $this-&gt;getHTMLUnitToUnits($tmp[1], 0, $this-&gt;svgunit, <span class="keyword">false</span>);</div>
<div class="line"><a name="l22942"></a><span class="lineno">22942</span>&#160;            }</div>
<div class="line"><a name="l22943"></a><span class="lineno">22943</span>&#160;            $tmp = array();</div>
<div class="line"><a name="l22944"></a><span class="lineno">22944</span>&#160;            <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/[\s]+width[\s]*=[\s]*&quot;([^&quot;]*)&quot;/si&#39;</span>, $regs[1], $tmp)) {</div>
<div class="line"><a name="l22945"></a><span class="lineno">22945</span>&#160;                $ow = $this-&gt;getHTMLUnitToUnits($tmp[1], 1, $this-&gt;svgunit, <span class="keyword">false</span>);</div>
<div class="line"><a name="l22946"></a><span class="lineno">22946</span>&#160;            }</div>
<div class="line"><a name="l22947"></a><span class="lineno">22947</span>&#160;            $tmp = array();</div>
<div class="line"><a name="l22948"></a><span class="lineno">22948</span>&#160;            <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/[\s]+height[\s]*=[\s]*&quot;([^&quot;]*)&quot;/si&#39;</span>, $regs[1], $tmp)) {</div>
<div class="line"><a name="l22949"></a><span class="lineno">22949</span>&#160;                $oh = $this-&gt;getHTMLUnitToUnits($tmp[1], 1, $this-&gt;svgunit, <span class="keyword">false</span>);</div>
<div class="line"><a name="l22950"></a><span class="lineno">22950</span>&#160;            }</div>
<div class="line"><a name="l22951"></a><span class="lineno">22951</span>&#160;            $tmp = array();</div>
<div class="line"><a name="l22952"></a><span class="lineno">22952</span>&#160;            $view_box = array();</div>
<div class="line"><a name="l22953"></a><span class="lineno">22953</span>&#160;            <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/[\s]+viewBox[\s]*=[\s]*&quot;[\s]*([0-9\.\-]+)[\s]+([0-9\.\-]+)[\s]+([0-9\.]+)[\s]+([0-9\.]+)[\s]*&quot;/si&#39;</span>, $regs[1], $tmp)) {</div>
<div class="line"><a name="l22954"></a><span class="lineno">22954</span>&#160;                <span class="keywordflow">if</span> (count($tmp) == 5) {</div>
<div class="line"><a name="l22955"></a><span class="lineno">22955</span>&#160;                    array_shift($tmp);</div>
<div class="line"><a name="l22956"></a><span class="lineno">22956</span>&#160;                    <span class="keywordflow">foreach</span> ($tmp as $key =&gt; $val) {</div>
<div class="line"><a name="l22957"></a><span class="lineno">22957</span>&#160;                        $view_box[$key] = $this-&gt;getHTMLUnitToUnits($val, 0, $this-&gt;svgunit, <span class="keyword">false</span>);</div>
<div class="line"><a name="l22958"></a><span class="lineno">22958</span>&#160;                    }</div>
<div class="line"><a name="l22959"></a><span class="lineno">22959</span>&#160;                    $ox = $view_box[0];</div>
<div class="line"><a name="l22960"></a><span class="lineno">22960</span>&#160;                    $oy = $view_box[1];</div>
<div class="line"><a name="l22961"></a><span class="lineno">22961</span>&#160;                }</div>
<div class="line"><a name="l22962"></a><span class="lineno">22962</span>&#160;                <span class="comment">// get aspect ratio</span></div>
<div class="line"><a name="l22963"></a><span class="lineno">22963</span>&#160;                $tmp = array();</div>
<div class="line"><a name="l22964"></a><span class="lineno">22964</span>&#160;                <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/[\s]+preserveAspectRatio[\s]*=[\s]*&quot;([^&quot;]*)&quot;/si&#39;</span>, $regs[1], $tmp)) {</div>
<div class="line"><a name="l22965"></a><span class="lineno">22965</span>&#160;                    $aspect_ratio = preg_split(<span class="stringliteral">&#39;/[\s]+/si&#39;</span>, $tmp[1]);</div>
<div class="line"><a name="l22966"></a><span class="lineno">22966</span>&#160;                    <span class="keywordflow">switch</span> (count($aspect_ratio)) {</div>
<div class="line"><a name="l22967"></a><span class="lineno">22967</span>&#160;                        <span class="keywordflow">case</span> 3: {</div>
<div class="line"><a name="l22968"></a><span class="lineno">22968</span>&#160;                            $aspect_ratio_align = $aspect_ratio[1];</div>
<div class="line"><a name="l22969"></a><span class="lineno">22969</span>&#160;                            $aspect_ratio_ms = $aspect_ratio[2];</div>
<div class="line"><a name="l22970"></a><span class="lineno">22970</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l22971"></a><span class="lineno">22971</span>&#160;                        }</div>
<div class="line"><a name="l22972"></a><span class="lineno">22972</span>&#160;                        <span class="keywordflow">case</span> 2: {</div>
<div class="line"><a name="l22973"></a><span class="lineno">22973</span>&#160;                            $aspect_ratio_align = $aspect_ratio[0];</div>
<div class="line"><a name="l22974"></a><span class="lineno">22974</span>&#160;                            $aspect_ratio_ms = $aspect_ratio[1];</div>
<div class="line"><a name="l22975"></a><span class="lineno">22975</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l22976"></a><span class="lineno">22976</span>&#160;                        }</div>
<div class="line"><a name="l22977"></a><span class="lineno">22977</span>&#160;                        <span class="keywordflow">case</span> 1: {</div>
<div class="line"><a name="l22978"></a><span class="lineno">22978</span>&#160;                            $aspect_ratio_align = $aspect_ratio[0];</div>
<div class="line"><a name="l22979"></a><span class="lineno">22979</span>&#160;                            $aspect_ratio_ms = <span class="stringliteral">&#39;meet&#39;</span>;</div>
<div class="line"><a name="l22980"></a><span class="lineno">22980</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l22981"></a><span class="lineno">22981</span>&#160;                        }</div>
<div class="line"><a name="l22982"></a><span class="lineno">22982</span>&#160;                    }</div>
<div class="line"><a name="l22983"></a><span class="lineno">22983</span>&#160;                }</div>
<div class="line"><a name="l22984"></a><span class="lineno">22984</span>&#160;            }</div>
<div class="line"><a name="l22985"></a><span class="lineno">22985</span>&#160;        }</div>
<div class="line"><a name="l22986"></a><span class="lineno">22986</span>&#160;        <span class="keywordflow">if</span> ($ow &lt;= 0) {</div>
<div class="line"><a name="l22987"></a><span class="lineno">22987</span>&#160;            $ow = 1;</div>
<div class="line"><a name="l22988"></a><span class="lineno">22988</span>&#160;        }</div>
<div class="line"><a name="l22989"></a><span class="lineno">22989</span>&#160;        <span class="keywordflow">if</span> ($oh &lt;= 0) {</div>
<div class="line"><a name="l22990"></a><span class="lineno">22990</span>&#160;            $oh = 1;</div>
<div class="line"><a name="l22991"></a><span class="lineno">22991</span>&#160;        }</div>
<div class="line"><a name="l22992"></a><span class="lineno">22992</span>&#160;        <span class="comment">// calculate image width and height on document</span></div>
<div class="line"><a name="l22993"></a><span class="lineno">22993</span>&#160;        <span class="keywordflow">if</span> (($w &lt;= 0) AND ($h &lt;= 0)) {</div>
<div class="line"><a name="l22994"></a><span class="lineno">22994</span>&#160;            <span class="comment">// convert image size to document unit</span></div>
<div class="line"><a name="l22995"></a><span class="lineno">22995</span>&#160;            $w = $ow;</div>
<div class="line"><a name="l22996"></a><span class="lineno">22996</span>&#160;            $h = $oh;</div>
<div class="line"><a name="l22997"></a><span class="lineno">22997</span>&#160;        } elseif ($w &lt;= 0) {</div>
<div class="line"><a name="l22998"></a><span class="lineno">22998</span>&#160;            $w = $h * $ow / $oh;</div>
<div class="line"><a name="l22999"></a><span class="lineno">22999</span>&#160;        } elseif ($h &lt;= 0) {</div>
<div class="line"><a name="l23000"></a><span class="lineno">23000</span>&#160;            $h = $w * $oh / $ow;</div>
<div class="line"><a name="l23001"></a><span class="lineno">23001</span>&#160;        }</div>
<div class="line"><a name="l23002"></a><span class="lineno">23002</span>&#160;        <span class="comment">// fit the image on available space</span></div>
<div class="line"><a name="l23003"></a><span class="lineno">23003</span>&#160;        list($w, $h, $x, $y) = $this-&gt;fitBlock($w, $h, $x, $y, $fitonpage);</div>
<div class="line"><a name="l23004"></a><span class="lineno">23004</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;rasterize_vector_images) {</div>
<div class="line"><a name="l23005"></a><span class="lineno">23005</span>&#160;            <span class="comment">// convert SVG to raster image using GD or ImageMagick libraries</span></div>
<div class="line"><a name="l23006"></a><span class="lineno">23006</span>&#160;            <span class="keywordflow">return</span> $this-&gt;Image($file, $x, $y, $w, $h, <span class="stringliteral">&#39;SVG&#39;</span>, $link, $align, <span class="keyword">true</span>, 300, $palign, <span class="keyword">false</span>, <span class="keyword">false</span>, $border, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l23007"></a><span class="lineno">23007</span>&#160;        }</div>
<div class="line"><a name="l23008"></a><span class="lineno">23008</span>&#160;        <span class="comment">// set alignment</span></div>
<div class="line"><a name="l23009"></a><span class="lineno">23009</span>&#160;        $this-&gt;img_rb_y = $y + $h;</div>
<div class="line"><a name="l23010"></a><span class="lineno">23010</span>&#160;        <span class="comment">// set alignment</span></div>
<div class="line"><a name="l23011"></a><span class="lineno">23011</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l23012"></a><span class="lineno">23012</span>&#160;            <span class="keywordflow">if</span> ($palign == <span class="charliteral">&#39;L&#39;</span>) {</div>
<div class="line"><a name="l23013"></a><span class="lineno">23013</span>&#160;                $ximg = $this-&gt;lMargin;</div>
<div class="line"><a name="l23014"></a><span class="lineno">23014</span>&#160;            } elseif ($palign == <span class="charliteral">&#39;C&#39;</span>) {</div>
<div class="line"><a name="l23015"></a><span class="lineno">23015</span>&#160;                $ximg = ($this-&gt;w + $this-&gt;lMargin - $this-&gt;rMargin - $w) / 2;</div>
<div class="line"><a name="l23016"></a><span class="lineno">23016</span>&#160;            } elseif ($palign == <span class="charliteral">&#39;R&#39;</span>) {</div>
<div class="line"><a name="l23017"></a><span class="lineno">23017</span>&#160;                $ximg = $this-&gt;w - $this-&gt;rMargin - $w;</div>
<div class="line"><a name="l23018"></a><span class="lineno">23018</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l23019"></a><span class="lineno">23019</span>&#160;                $ximg = $x - $w;</div>
<div class="line"><a name="l23020"></a><span class="lineno">23020</span>&#160;            }</div>
<div class="line"><a name="l23021"></a><span class="lineno">23021</span>&#160;            $this-&gt;img_rb_x = $ximg;</div>
<div class="line"><a name="l23022"></a><span class="lineno">23022</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l23023"></a><span class="lineno">23023</span>&#160;            <span class="keywordflow">if</span> ($palign == <span class="charliteral">&#39;L&#39;</span>) {</div>
<div class="line"><a name="l23024"></a><span class="lineno">23024</span>&#160;                $ximg = $this-&gt;lMargin;</div>
<div class="line"><a name="l23025"></a><span class="lineno">23025</span>&#160;            } elseif ($palign == <span class="charliteral">&#39;C&#39;</span>) {</div>
<div class="line"><a name="l23026"></a><span class="lineno">23026</span>&#160;                $ximg = ($this-&gt;w + $this-&gt;lMargin - $this-&gt;rMargin - $w) / 2;</div>
<div class="line"><a name="l23027"></a><span class="lineno">23027</span>&#160;            } elseif ($palign == <span class="charliteral">&#39;R&#39;</span>) {</div>
<div class="line"><a name="l23028"></a><span class="lineno">23028</span>&#160;                $ximg = $this-&gt;w - $this-&gt;rMargin - $w;</div>
<div class="line"><a name="l23029"></a><span class="lineno">23029</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l23030"></a><span class="lineno">23030</span>&#160;                $ximg = $x;</div>
<div class="line"><a name="l23031"></a><span class="lineno">23031</span>&#160;            }</div>
<div class="line"><a name="l23032"></a><span class="lineno">23032</span>&#160;            $this-&gt;img_rb_x = $ximg + $w;</div>
<div class="line"><a name="l23033"></a><span class="lineno">23033</span>&#160;        }</div>
<div class="line"><a name="l23034"></a><span class="lineno">23034</span>&#160;        <span class="comment">// store current graphic vars</span></div>
<div class="line"><a name="l23035"></a><span class="lineno">23035</span>&#160;        $gvars = $this-&gt;getGraphicVars();</div>
<div class="line"><a name="l23036"></a><span class="lineno">23036</span>&#160;        <span class="comment">// store SVG position and scale factors</span></div>
<div class="line"><a name="l23037"></a><span class="lineno">23037</span>&#160;        $svgoffset_x = ($ximg - $ox) * $this-&gt;k;</div>
<div class="line"><a name="l23038"></a><span class="lineno">23038</span>&#160;        $svgoffset_y = -($y - $oy) * $this-&gt;k;</div>
<div class="line"><a name="l23039"></a><span class="lineno">23039</span>&#160;        <span class="keywordflow">if</span> (isset($view_box[2]) AND ($view_box[2] &gt; 0) AND ($view_box[3] &gt; 0)) {</div>
<div class="line"><a name="l23040"></a><span class="lineno">23040</span>&#160;            $ow = $view_box[2];</div>
<div class="line"><a name="l23041"></a><span class="lineno">23041</span>&#160;            $oh = $view_box[3];</div>
<div class="line"><a name="l23042"></a><span class="lineno">23042</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l23043"></a><span class="lineno">23043</span>&#160;            <span class="keywordflow">if</span> ($ow &lt;= 0) {</div>
<div class="line"><a name="l23044"></a><span class="lineno">23044</span>&#160;                $ow = $w;</div>
<div class="line"><a name="l23045"></a><span class="lineno">23045</span>&#160;            }</div>
<div class="line"><a name="l23046"></a><span class="lineno">23046</span>&#160;            <span class="keywordflow">if</span> ($oh &lt;= 0) {</div>
<div class="line"><a name="l23047"></a><span class="lineno">23047</span>&#160;                $oh = $h;</div>
<div class="line"><a name="l23048"></a><span class="lineno">23048</span>&#160;            }</div>
<div class="line"><a name="l23049"></a><span class="lineno">23049</span>&#160;        }</div>
<div class="line"><a name="l23050"></a><span class="lineno">23050</span>&#160;        $svgscale_x = $w / $ow;</div>
<div class="line"><a name="l23051"></a><span class="lineno">23051</span>&#160;        $svgscale_y = $h / $oh;</div>
<div class="line"><a name="l23052"></a><span class="lineno">23052</span>&#160;        <span class="comment">// scaling and alignment</span></div>
<div class="line"><a name="l23053"></a><span class="lineno">23053</span>&#160;        <span class="keywordflow">if</span> ($aspect_ratio_align != <span class="stringliteral">&#39;none&#39;</span>) {</div>
<div class="line"><a name="l23054"></a><span class="lineno">23054</span>&#160;            <span class="comment">// store current scaling values</span></div>
<div class="line"><a name="l23055"></a><span class="lineno">23055</span>&#160;            $svgscale_old_x = $svgscale_x;</div>
<div class="line"><a name="l23056"></a><span class="lineno">23056</span>&#160;            $svgscale_old_y = $svgscale_y;</div>
<div class="line"><a name="l23057"></a><span class="lineno">23057</span>&#160;            <span class="comment">// force uniform scaling</span></div>
<div class="line"><a name="l23058"></a><span class="lineno">23058</span>&#160;            <span class="keywordflow">if</span> ($aspect_ratio_ms == <span class="stringliteral">&#39;slice&#39;</span>) {</div>
<div class="line"><a name="l23059"></a><span class="lineno">23059</span>&#160;                <span class="comment">// the entire viewport is covered by the viewBox</span></div>
<div class="line"><a name="l23060"></a><span class="lineno">23060</span>&#160;                <span class="keywordflow">if</span> ($svgscale_x &gt; $svgscale_y) {</div>
<div class="line"><a name="l23061"></a><span class="lineno">23061</span>&#160;                    $svgscale_y = $svgscale_x;</div>
<div class="line"><a name="l23062"></a><span class="lineno">23062</span>&#160;                } elseif ($svgscale_x &lt; $svgscale_y) {</div>
<div class="line"><a name="l23063"></a><span class="lineno">23063</span>&#160;                    $svgscale_x = $svgscale_y;</div>
<div class="line"><a name="l23064"></a><span class="lineno">23064</span>&#160;                }</div>
<div class="line"><a name="l23065"></a><span class="lineno">23065</span>&#160;            } <span class="keywordflow">else</span> { <span class="comment">// meet</span></div>
<div class="line"><a name="l23066"></a><span class="lineno">23066</span>&#160;                <span class="comment">// the entire viewBox is visible within the viewport</span></div>
<div class="line"><a name="l23067"></a><span class="lineno">23067</span>&#160;                <span class="keywordflow">if</span> ($svgscale_x &lt; $svgscale_y) {</div>
<div class="line"><a name="l23068"></a><span class="lineno">23068</span>&#160;                    $svgscale_y = $svgscale_x;</div>
<div class="line"><a name="l23069"></a><span class="lineno">23069</span>&#160;                } elseif ($svgscale_x &gt; $svgscale_y) {</div>
<div class="line"><a name="l23070"></a><span class="lineno">23070</span>&#160;                    $svgscale_x = $svgscale_y;</div>
<div class="line"><a name="l23071"></a><span class="lineno">23071</span>&#160;                }</div>
<div class="line"><a name="l23072"></a><span class="lineno">23072</span>&#160;            }</div>
<div class="line"><a name="l23073"></a><span class="lineno">23073</span>&#160;            <span class="comment">// correct X alignment</span></div>
<div class="line"><a name="l23074"></a><span class="lineno">23074</span>&#160;            <span class="keywordflow">switch</span> (substr($aspect_ratio_align, 1, 3)) {</div>
<div class="line"><a name="l23075"></a><span class="lineno">23075</span>&#160;                <span class="keywordflow">case</span> <span class="stringliteral">&#39;Min&#39;</span>: {</div>
<div class="line"><a name="l23076"></a><span class="lineno">23076</span>&#160;                    <span class="comment">// do nothing</span></div>
<div class="line"><a name="l23077"></a><span class="lineno">23077</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l23078"></a><span class="lineno">23078</span>&#160;                }</div>
<div class="line"><a name="l23079"></a><span class="lineno">23079</span>&#160;                <span class="keywordflow">case</span> <span class="stringliteral">&#39;Max&#39;</span>: {</div>
<div class="line"><a name="l23080"></a><span class="lineno">23080</span>&#160;                    $svgoffset_x += (($w * $this-&gt;k) - ($ow * $this-&gt;k * $svgscale_x));</div>
<div class="line"><a name="l23081"></a><span class="lineno">23081</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l23082"></a><span class="lineno">23082</span>&#160;                }</div>
<div class="line"><a name="l23083"></a><span class="lineno">23083</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l23084"></a><span class="lineno">23084</span>&#160;                <span class="keywordflow">case</span> <span class="stringliteral">&#39;Mid&#39;</span>: {</div>
<div class="line"><a name="l23085"></a><span class="lineno">23085</span>&#160;                    $svgoffset_x += ((($w * $this-&gt;k) - ($ow * $this-&gt;k * $svgscale_x)) / 2);</div>
<div class="line"><a name="l23086"></a><span class="lineno">23086</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l23087"></a><span class="lineno">23087</span>&#160;                }</div>
<div class="line"><a name="l23088"></a><span class="lineno">23088</span>&#160;            }</div>
<div class="line"><a name="l23089"></a><span class="lineno">23089</span>&#160;            <span class="comment">// correct Y alignment</span></div>
<div class="line"><a name="l23090"></a><span class="lineno">23090</span>&#160;            <span class="keywordflow">switch</span> (substr($aspect_ratio_align, 5)) {</div>
<div class="line"><a name="l23091"></a><span class="lineno">23091</span>&#160;                <span class="keywordflow">case</span> <span class="stringliteral">&#39;Min&#39;</span>: {</div>
<div class="line"><a name="l23092"></a><span class="lineno">23092</span>&#160;                    <span class="comment">// do nothing</span></div>
<div class="line"><a name="l23093"></a><span class="lineno">23093</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l23094"></a><span class="lineno">23094</span>&#160;                }</div>
<div class="line"><a name="l23095"></a><span class="lineno">23095</span>&#160;                <span class="keywordflow">case</span> <span class="stringliteral">&#39;Max&#39;</span>: {</div>
<div class="line"><a name="l23096"></a><span class="lineno">23096</span>&#160;                    $svgoffset_y -= (($h * $this-&gt;k) - ($oh * $this-&gt;k * $svgscale_y));</div>
<div class="line"><a name="l23097"></a><span class="lineno">23097</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l23098"></a><span class="lineno">23098</span>&#160;                }</div>
<div class="line"><a name="l23099"></a><span class="lineno">23099</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l23100"></a><span class="lineno">23100</span>&#160;                <span class="keywordflow">case</span> <span class="stringliteral">&#39;Mid&#39;</span>: {</div>
<div class="line"><a name="l23101"></a><span class="lineno">23101</span>&#160;                    $svgoffset_y -= ((($h * $this-&gt;k) - ($oh * $this-&gt;k * $svgscale_y)) / 2);</div>
<div class="line"><a name="l23102"></a><span class="lineno">23102</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l23103"></a><span class="lineno">23103</span>&#160;                }</div>
<div class="line"><a name="l23104"></a><span class="lineno">23104</span>&#160;            }</div>
<div class="line"><a name="l23105"></a><span class="lineno">23105</span>&#160;        }</div>
<div class="line"><a name="l23106"></a><span class="lineno">23106</span>&#160;        <span class="comment">// store current page break mode</span></div>
<div class="line"><a name="l23107"></a><span class="lineno">23107</span>&#160;        $page_break_mode = $this-&gt;AutoPageBreak;</div>
<div class="line"><a name="l23108"></a><span class="lineno">23108</span>&#160;        $page_break_margin = $this-&gt;getBreakMargin();</div>
<div class="line"><a name="l23109"></a><span class="lineno">23109</span>&#160;        $cell_padding = $this-&gt;cell_padding;</div>
<div class="line"><a name="l23110"></a><span class="lineno">23110</span>&#160;        $this-&gt;SetCellPadding(0);</div>
<div class="line"><a name="l23111"></a><span class="lineno">23111</span>&#160;        $this-&gt;SetAutoPageBreak(<span class="keyword">false</span>);</div>
<div class="line"><a name="l23112"></a><span class="lineno">23112</span>&#160;        <span class="comment">// save the current graphic state</span></div>
<div class="line"><a name="l23113"></a><span class="lineno">23113</span>&#160;        $this-&gt;_out(<span class="charliteral">&#39;q&#39;</span>.$this-&gt;epsmarker);</div>
<div class="line"><a name="l23114"></a><span class="lineno">23114</span>&#160;        <span class="comment">// set initial clipping mask</span></div>
<div class="line"><a name="l23115"></a><span class="lineno">23115</span>&#160;        $this-&gt;Rect($ximg, $y, $w, $h, <span class="stringliteral">&#39;CNZ&#39;</span>, array(), array());</div>
<div class="line"><a name="l23116"></a><span class="lineno">23116</span>&#160;        <span class="comment">// scale and translate</span></div>
<div class="line"><a name="l23117"></a><span class="lineno">23117</span>&#160;        $e = $ox * $this-&gt;k * (1 - $svgscale_x);</div>
<div class="line"><a name="l23118"></a><span class="lineno">23118</span>&#160;        $f = ($this-&gt;h - $oy) * $this-&gt;k * (1 - $svgscale_y);</div>
<div class="line"><a name="l23119"></a><span class="lineno">23119</span>&#160;        $this-&gt;_out(sprintf(<span class="stringliteral">&#39;%F %F %F %F %F %F cm&#39;</span>, $svgscale_x, 0, 0, $svgscale_y, ($e + $svgoffset_x), ($f + $svgoffset_y)));</div>
<div class="line"><a name="l23120"></a><span class="lineno">23120</span>&#160;        <span class="comment">// creates a new XML parser to be used by the other XML functions</span></div>
<div class="line"><a name="l23121"></a><span class="lineno">23121</span>&#160;        $this-&gt;parser = xml_parser_create(<span class="stringliteral">&#39;UTF-8&#39;</span>);</div>
<div class="line"><a name="l23122"></a><span class="lineno">23122</span>&#160;        <span class="comment">// the following function allows to use parser inside object</span></div>
<div class="line"><a name="l23123"></a><span class="lineno">23123</span>&#160;        xml_set_object($this-&gt;parser, $this);</div>
<div class="line"><a name="l23124"></a><span class="lineno">23124</span>&#160;        <span class="comment">// disable case-folding for this XML parser</span></div>
<div class="line"><a name="l23125"></a><span class="lineno">23125</span>&#160;        xml_parser_set_option($this-&gt;parser, XML_OPTION_CASE_FOLDING, 0);</div>
<div class="line"><a name="l23126"></a><span class="lineno">23126</span>&#160;        <span class="comment">// sets the element handler functions for the XML parser</span></div>
<div class="line"><a name="l23127"></a><span class="lineno">23127</span>&#160;        xml_set_element_handler($this-&gt;parser, <span class="stringliteral">&#39;startSVGElementHandler&#39;</span>, <span class="stringliteral">&#39;endSVGElementHandler&#39;</span>);</div>
<div class="line"><a name="l23128"></a><span class="lineno">23128</span>&#160;        <span class="comment">// sets the character data handler function for the XML parser</span></div>
<div class="line"><a name="l23129"></a><span class="lineno">23129</span>&#160;        xml_set_character_data_handler($this-&gt;parser, <span class="stringliteral">&#39;segSVGContentHandler&#39;</span>);</div>
<div class="line"><a name="l23130"></a><span class="lineno">23130</span>&#160;        <span class="comment">// start parsing an XML document</span></div>
<div class="line"><a name="l23131"></a><span class="lineno">23131</span>&#160;        <span class="keywordflow">if</span> (!xml_parse($this-&gt;parser, $svgdata)) {</div>
<div class="line"><a name="l23132"></a><span class="lineno">23132</span>&#160;            $error_message = sprintf(<span class="stringliteral">&#39;SVG Error: %s at line %d&#39;</span>, xml_error_string(xml_get_error_code($this-&gt;parser)), xml_get_current_line_number($this-&gt;parser));</div>
<div class="line"><a name="l23133"></a><span class="lineno">23133</span>&#160;            $this-&gt;Error($error_message);</div>
<div class="line"><a name="l23134"></a><span class="lineno">23134</span>&#160;        }</div>
<div class="line"><a name="l23135"></a><span class="lineno">23135</span>&#160;        <span class="comment">// free this XML parser</span></div>
<div class="line"><a name="l23136"></a><span class="lineno">23136</span>&#160;        xml_parser_free($this-&gt;parser);</div>
<div class="line"><a name="l23137"></a><span class="lineno">23137</span>&#160;        <span class="comment">// restore previous graphic state</span></div>
<div class="line"><a name="l23138"></a><span class="lineno">23138</span>&#160;        $this-&gt;_out($this-&gt;epsmarker.<span class="charliteral">&#39;Q&#39;</span>);</div>
<div class="line"><a name="l23139"></a><span class="lineno">23139</span>&#160;        <span class="comment">// restore graphic vars</span></div>
<div class="line"><a name="l23140"></a><span class="lineno">23140</span>&#160;        $this-&gt;setGraphicVars($gvars);</div>
<div class="line"><a name="l23141"></a><span class="lineno">23141</span>&#160;        $this-&gt;lasth = $gvars[<span class="stringliteral">&#39;lasth&#39;</span>];</div>
<div class="line"><a name="l23142"></a><span class="lineno">23142</span>&#160;        <span class="keywordflow">if</span> (!empty($border)) {</div>
<div class="line"><a name="l23143"></a><span class="lineno">23143</span>&#160;            $bx = $this-&gt;x;</div>
<div class="line"><a name="l23144"></a><span class="lineno">23144</span>&#160;            $by = $this-&gt;y;</div>
<div class="line"><a name="l23145"></a><span class="lineno">23145</span>&#160;            $this-&gt;x = $ximg;</div>
<div class="line"><a name="l23146"></a><span class="lineno">23146</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;rtl) {</div>
<div class="line"><a name="l23147"></a><span class="lineno">23147</span>&#160;                $this-&gt;x += $w;</div>
<div class="line"><a name="l23148"></a><span class="lineno">23148</span>&#160;            }</div>
<div class="line"><a name="l23149"></a><span class="lineno">23149</span>&#160;            $this-&gt;y = $y;</div>
<div class="line"><a name="l23150"></a><span class="lineno">23150</span>&#160;            $this-&gt;Cell($w, $h, <span class="stringliteral">&#39;&#39;</span>, $border, 0, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="keyword">true</span>);</div>
<div class="line"><a name="l23151"></a><span class="lineno">23151</span>&#160;            $this-&gt;x = $bx;</div>
<div class="line"><a name="l23152"></a><span class="lineno">23152</span>&#160;            $this-&gt;y = $by;</div>
<div class="line"><a name="l23153"></a><span class="lineno">23153</span>&#160;        }</div>
<div class="line"><a name="l23154"></a><span class="lineno">23154</span>&#160;        <span class="keywordflow">if</span> ($link) {</div>
<div class="line"><a name="l23155"></a><span class="lineno">23155</span>&#160;            $this-&gt;Link($ximg, $y, $w, $h, $link, 0);</div>
<div class="line"><a name="l23156"></a><span class="lineno">23156</span>&#160;        }</div>
<div class="line"><a name="l23157"></a><span class="lineno">23157</span>&#160;        <span class="comment">// set pointer to align the next text/objects</span></div>
<div class="line"><a name="l23158"></a><span class="lineno">23158</span>&#160;        <span class="keywordflow">switch</span>($align) {</div>
<div class="line"><a name="l23159"></a><span class="lineno">23159</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>:{</div>
<div class="line"><a name="l23160"></a><span class="lineno">23160</span>&#160;                $this-&gt;y = $y;</div>
<div class="line"><a name="l23161"></a><span class="lineno">23161</span>&#160;                $this-&gt;x = $this-&gt;img_rb_x;</div>
<div class="line"><a name="l23162"></a><span class="lineno">23162</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l23163"></a><span class="lineno">23163</span>&#160;            }</div>
<div class="line"><a name="l23164"></a><span class="lineno">23164</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;M&#39;</span>:{</div>
<div class="line"><a name="l23165"></a><span class="lineno">23165</span>&#160;                $this-&gt;y = $y + round($h/2);</div>
<div class="line"><a name="l23166"></a><span class="lineno">23166</span>&#160;                $this-&gt;x = $this-&gt;img_rb_x;</div>
<div class="line"><a name="l23167"></a><span class="lineno">23167</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l23168"></a><span class="lineno">23168</span>&#160;            }</div>
<div class="line"><a name="l23169"></a><span class="lineno">23169</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;B&#39;</span>:{</div>
<div class="line"><a name="l23170"></a><span class="lineno">23170</span>&#160;                $this-&gt;y = $this-&gt;img_rb_y;</div>
<div class="line"><a name="l23171"></a><span class="lineno">23171</span>&#160;                $this-&gt;x = $this-&gt;img_rb_x;</div>
<div class="line"><a name="l23172"></a><span class="lineno">23172</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l23173"></a><span class="lineno">23173</span>&#160;            }</div>
<div class="line"><a name="l23174"></a><span class="lineno">23174</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;N&#39;</span>:{</div>
<div class="line"><a name="l23175"></a><span class="lineno">23175</span>&#160;                $this-&gt;SetY($this-&gt;img_rb_y);</div>
<div class="line"><a name="l23176"></a><span class="lineno">23176</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l23177"></a><span class="lineno">23177</span>&#160;            }</div>
<div class="line"><a name="l23178"></a><span class="lineno">23178</span>&#160;            <span class="keywordflow">default</span>:{</div>
<div class="line"><a name="l23179"></a><span class="lineno">23179</span>&#160;                <span class="comment">// restore pointer to starting position</span></div>
<div class="line"><a name="l23180"></a><span class="lineno">23180</span>&#160;                $this-&gt;x = $gvars[<span class="charliteral">&#39;x&#39;</span>];</div>
<div class="line"><a name="l23181"></a><span class="lineno">23181</span>&#160;                $this-&gt;y = $gvars[<span class="charliteral">&#39;y&#39;</span>];</div>
<div class="line"><a name="l23182"></a><span class="lineno">23182</span>&#160;                $this-&gt;page = $gvars[<span class="stringliteral">&#39;page&#39;</span>];</div>
<div class="line"><a name="l23183"></a><span class="lineno">23183</span>&#160;                $this-&gt;current_column = $gvars[<span class="stringliteral">&#39;current_column&#39;</span>];</div>
<div class="line"><a name="l23184"></a><span class="lineno">23184</span>&#160;                $this-&gt;tMargin = $gvars[<span class="stringliteral">&#39;tMargin&#39;</span>];</div>
<div class="line"><a name="l23185"></a><span class="lineno">23185</span>&#160;                $this-&gt;bMargin = $gvars[<span class="stringliteral">&#39;bMargin&#39;</span>];</div>
<div class="line"><a name="l23186"></a><span class="lineno">23186</span>&#160;                $this-&gt;w = $gvars[<span class="charliteral">&#39;w&#39;</span>];</div>
<div class="line"><a name="l23187"></a><span class="lineno">23187</span>&#160;                $this-&gt;h = $gvars[<span class="charliteral">&#39;h&#39;</span>];</div>
<div class="line"><a name="l23188"></a><span class="lineno">23188</span>&#160;                $this-&gt;wPt = $gvars[<span class="stringliteral">&#39;wPt&#39;</span>];</div>
<div class="line"><a name="l23189"></a><span class="lineno">23189</span>&#160;                $this-&gt;hPt = $gvars[<span class="stringliteral">&#39;hPt&#39;</span>];</div>
<div class="line"><a name="l23190"></a><span class="lineno">23190</span>&#160;                $this-&gt;fwPt = $gvars[<span class="stringliteral">&#39;fwPt&#39;</span>];</div>
<div class="line"><a name="l23191"></a><span class="lineno">23191</span>&#160;                $this-&gt;fhPt = $gvars[<span class="stringliteral">&#39;fhPt&#39;</span>];</div>
<div class="line"><a name="l23192"></a><span class="lineno">23192</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l23193"></a><span class="lineno">23193</span>&#160;            }</div>
<div class="line"><a name="l23194"></a><span class="lineno">23194</span>&#160;        }</div>
<div class="line"><a name="l23195"></a><span class="lineno">23195</span>&#160;        $this-&gt;endlinex = $this-&gt;img_rb_x;</div>
<div class="line"><a name="l23196"></a><span class="lineno">23196</span>&#160;        <span class="comment">// restore page break</span></div>
<div class="line"><a name="l23197"></a><span class="lineno">23197</span>&#160;        $this-&gt;SetAutoPageBreak($page_break_mode, $page_break_margin);</div>
<div class="line"><a name="l23198"></a><span class="lineno">23198</span>&#160;        $this-&gt;cell_padding = $cell_padding;</div>
<div class="line"><a name="l23199"></a><span class="lineno">23199</span>&#160;    }</div>
<div class="line"><a name="l23200"></a><span class="lineno">23200</span>&#160;</div>
<div class="line"><a name="l23208"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ad32b0c0ac023e7b13198f773c848ff2f">23208</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ad32b0c0ac023e7b13198f773c848ff2f">convertSVGtMatrix</a>($tm) {</div>
<div class="line"><a name="l23209"></a><span class="lineno">23209</span>&#160;        $a = $tm[0];</div>
<div class="line"><a name="l23210"></a><span class="lineno">23210</span>&#160;        $b = -$tm[1];</div>
<div class="line"><a name="l23211"></a><span class="lineno">23211</span>&#160;        $c = -$tm[2];</div>
<div class="line"><a name="l23212"></a><span class="lineno">23212</span>&#160;        $d = $tm[3];</div>
<div class="line"><a name="l23213"></a><span class="lineno">23213</span>&#160;        $e = $this-&gt;getHTMLUnitToUnits($tm[4], 1, $this-&gt;svgunit, <span class="keyword">false</span>) * $this-&gt;k;</div>
<div class="line"><a name="l23214"></a><span class="lineno">23214</span>&#160;        $f = -$this-&gt;getHTMLUnitToUnits($tm[5], 1, $this-&gt;svgunit, <span class="keyword">false</span>) * $this-&gt;k;</div>
<div class="line"><a name="l23215"></a><span class="lineno">23215</span>&#160;        $x = 0;</div>
<div class="line"><a name="l23216"></a><span class="lineno">23216</span>&#160;        $y = $this-&gt;h * $this-&gt;k;</div>
<div class="line"><a name="l23217"></a><span class="lineno">23217</span>&#160;        $e = ($x * (1 - $a)) - ($y * $c) + $e;</div>
<div class="line"><a name="l23218"></a><span class="lineno">23218</span>&#160;        $f = ($y * (1 - $d)) - ($x * $b) + $f;</div>
<div class="line"><a name="l23219"></a><span class="lineno">23219</span>&#160;        <span class="keywordflow">return</span> array($a, $b, $c, $d, $e, $f);</div>
<div class="line"><a name="l23220"></a><span class="lineno">23220</span>&#160;    }</div>
<div class="line"><a name="l23221"></a><span class="lineno">23221</span>&#160;</div>
<div class="line"><a name="l23228"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#ab7fb524bc243be585ab7fef00b434399">23228</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#ab7fb524bc243be585ab7fef00b434399">SVGTransform</a>($tm) {</div>
<div class="line"><a name="l23229"></a><span class="lineno">23229</span>&#160;        $this-&gt;Transform($this-&gt;convertSVGtMatrix($tm));</div>
<div class="line"><a name="l23230"></a><span class="lineno">23230</span>&#160;    }</div>
<div class="line"><a name="l23231"></a><span class="lineno">23231</span>&#160;</div>
<div class="line"><a name="l23247"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#abb955184ddd592fdfa3c29f4cc34bc69">23247</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#abb955184ddd592fdfa3c29f4cc34bc69">setSVGStyles</a>($svgstyle, $prevsvgstyle, $x=0, $y=0, $w=1, $h=1, $clip_function=<span class="stringliteral">&#39;&#39;</span>, $clip_params=array()) {</div>
<div class="line"><a name="l23248"></a><span class="lineno">23248</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;state != 2) {</div>
<div class="line"><a name="l23249"></a><span class="lineno">23249</span>&#160;             <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l23250"></a><span class="lineno">23250</span>&#160;        }</div>
<div class="line"><a name="l23251"></a><span class="lineno">23251</span>&#160;        $objstyle = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l23252"></a><span class="lineno">23252</span>&#160;        $minlen = (0.01 / $this-&gt;k); <span class="comment">// minimum acceptable length</span></div>
<div class="line"><a name="l23253"></a><span class="lineno">23253</span>&#160;        <span class="keywordflow">if</span> (!isset($svgstyle[<span class="stringliteral">&#39;opacity&#39;</span>])) {</div>
<div class="line"><a name="l23254"></a><span class="lineno">23254</span>&#160;            <span class="keywordflow">return</span> $objstyle;</div>
<div class="line"><a name="l23255"></a><span class="lineno">23255</span>&#160;        }</div>
<div class="line"><a name="l23256"></a><span class="lineno">23256</span>&#160;        <span class="comment">// clip-path</span></div>
<div class="line"><a name="l23257"></a><span class="lineno">23257</span>&#160;        $regs = array();</div>
<div class="line"><a name="l23258"></a><span class="lineno">23258</span>&#160;        <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/url\([\s]*\#([^\)]*)\)/si&#39;</span>, $svgstyle[<span class="stringliteral">&#39;clip-path&#39;</span>], $regs)) {</div>
<div class="line"><a name="l23259"></a><span class="lineno">23259</span>&#160;            $clip_path = $this-&gt;svgclippaths[$regs[1]];</div>
<div class="line"><a name="l23260"></a><span class="lineno">23260</span>&#160;            <span class="keywordflow">foreach</span> ($clip_path as $cp) {</div>
<div class="line"><a name="l23261"></a><span class="lineno">23261</span>&#160;                $this-&gt;startSVGElementHandler(<span class="stringliteral">&#39;clip-path&#39;</span>, $cp[<span class="stringliteral">&#39;name&#39;</span>], $cp[<span class="stringliteral">&#39;attribs&#39;</span>], $cp[<span class="stringliteral">&#39;tm&#39;</span>]);</div>
<div class="line"><a name="l23262"></a><span class="lineno">23262</span>&#160;            }</div>
<div class="line"><a name="l23263"></a><span class="lineno">23263</span>&#160;        }</div>
<div class="line"><a name="l23264"></a><span class="lineno">23264</span>&#160;        <span class="comment">// opacity</span></div>
<div class="line"><a name="l23265"></a><span class="lineno">23265</span>&#160;        <span class="keywordflow">if</span> ($svgstyle[<span class="stringliteral">&#39;opacity&#39;</span>] != 1) {</div>
<div class="line"><a name="l23266"></a><span class="lineno">23266</span>&#160;            $this-&gt;setAlpha($svgstyle[<span class="stringliteral">&#39;opacity&#39;</span>], <span class="stringliteral">&#39;Normal&#39;</span>, $svgstyle[<span class="stringliteral">&#39;opacity&#39;</span>], <span class="keyword">false</span>);</div>
<div class="line"><a name="l23267"></a><span class="lineno">23267</span>&#160;        }</div>
<div class="line"><a name="l23268"></a><span class="lineno">23268</span>&#160;        <span class="comment">// color</span></div>
<div class="line"><a name="l23269"></a><span class="lineno">23269</span>&#160;        $fill_color = TCPDF_COLORS::convertHTMLColorToDec($svgstyle[<span class="stringliteral">&#39;color&#39;</span>], $this-&gt;spot_colors);</div>
<div class="line"><a name="l23270"></a><span class="lineno">23270</span>&#160;        $this-&gt;SetFillColorArray($fill_color);</div>
<div class="line"><a name="l23271"></a><span class="lineno">23271</span>&#160;        <span class="comment">// text color</span></div>
<div class="line"><a name="l23272"></a><span class="lineno">23272</span>&#160;        $text_color = TCPDF_COLORS::convertHTMLColorToDec($svgstyle[<span class="stringliteral">&#39;text-color&#39;</span>], $this-&gt;spot_colors);</div>
<div class="line"><a name="l23273"></a><span class="lineno">23273</span>&#160;        $this-&gt;SetTextColorArray($text_color);</div>
<div class="line"><a name="l23274"></a><span class="lineno">23274</span>&#160;        <span class="comment">// clip</span></div>
<div class="line"><a name="l23275"></a><span class="lineno">23275</span>&#160;        <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/rect\(([a-z0-9\-\.]*)[\s]*([a-z0-9\-\.]*)[\s]*([a-z0-9\-\.]*)[\s]*([a-z0-9\-\.]*)\)/si&#39;</span>, $svgstyle[<span class="stringliteral">&#39;clip&#39;</span>], $regs)) {</div>
<div class="line"><a name="l23276"></a><span class="lineno">23276</span>&#160;            $top = (isset($regs[1])?$this-&gt;getHTMLUnitToUnits($regs[1], 0, $this-&gt;svgunit, <span class="keyword">false</span>):0);</div>
<div class="line"><a name="l23277"></a><span class="lineno">23277</span>&#160;            $right = (isset($regs[2])?$this-&gt;getHTMLUnitToUnits($regs[2], 0, $this-&gt;svgunit, <span class="keyword">false</span>):0);</div>
<div class="line"><a name="l23278"></a><span class="lineno">23278</span>&#160;            $bottom = (isset($regs[3])?$this-&gt;getHTMLUnitToUnits($regs[3], 0, $this-&gt;svgunit, <span class="keyword">false</span>):0);</div>
<div class="line"><a name="l23279"></a><span class="lineno">23279</span>&#160;            $left = (isset($regs[4])?$this-&gt;getHTMLUnitToUnits($regs[4], 0, $this-&gt;svgunit, <span class="keyword">false</span>):0);</div>
<div class="line"><a name="l23280"></a><span class="lineno">23280</span>&#160;            $cx = $x + $left;</div>
<div class="line"><a name="l23281"></a><span class="lineno">23281</span>&#160;            $cy = $y + $top;</div>
<div class="line"><a name="l23282"></a><span class="lineno">23282</span>&#160;            $cw = $w - $left - $right;</div>
<div class="line"><a name="l23283"></a><span class="lineno">23283</span>&#160;            $ch = $h - $top - $bottom;</div>
<div class="line"><a name="l23284"></a><span class="lineno">23284</span>&#160;            <span class="keywordflow">if</span> ($svgstyle[<span class="stringliteral">&#39;clip-rule&#39;</span>] == <span class="stringliteral">&#39;evenodd&#39;</span>) {</div>
<div class="line"><a name="l23285"></a><span class="lineno">23285</span>&#160;                $clip_rule = <span class="stringliteral">&#39;CNZ&#39;</span>;</div>
<div class="line"><a name="l23286"></a><span class="lineno">23286</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l23287"></a><span class="lineno">23287</span>&#160;                $clip_rule = <span class="stringliteral">&#39;CEO&#39;</span>;</div>
<div class="line"><a name="l23288"></a><span class="lineno">23288</span>&#160;            }</div>
<div class="line"><a name="l23289"></a><span class="lineno">23289</span>&#160;            $this-&gt;Rect($cx, $cy, $cw, $ch, $clip_rule, array(), array());</div>
<div class="line"><a name="l23290"></a><span class="lineno">23290</span>&#160;        }</div>
<div class="line"><a name="l23291"></a><span class="lineno">23291</span>&#160;        <span class="comment">// fill</span></div>
<div class="line"><a name="l23292"></a><span class="lineno">23292</span>&#160;        $regs = array();</div>
<div class="line"><a name="l23293"></a><span class="lineno">23293</span>&#160;        <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/url\([\s]*\#([^\)]*)\)/si&#39;</span>, $svgstyle[<span class="stringliteral">&#39;fill&#39;</span>], $regs)) {</div>
<div class="line"><a name="l23294"></a><span class="lineno">23294</span>&#160;            <span class="comment">// gradient</span></div>
<div class="line"><a name="l23295"></a><span class="lineno">23295</span>&#160;            $gradient = $this-&gt;svggradients[$regs[1]];</div>
<div class="line"><a name="l23296"></a><span class="lineno">23296</span>&#160;            <span class="keywordflow">if</span> (isset($gradient[<span class="stringliteral">&#39;xref&#39;</span>])) {</div>
<div class="line"><a name="l23297"></a><span class="lineno">23297</span>&#160;                <span class="comment">// reference to another gradient definition</span></div>
<div class="line"><a name="l23298"></a><span class="lineno">23298</span>&#160;                $newgradient = $this-&gt;svggradients[$gradient[<span class="stringliteral">&#39;xref&#39;</span>]];</div>
<div class="line"><a name="l23299"></a><span class="lineno">23299</span>&#160;                $newgradient[<span class="stringliteral">&#39;coords&#39;</span>] = $gradient[<span class="stringliteral">&#39;coords&#39;</span>];</div>
<div class="line"><a name="l23300"></a><span class="lineno">23300</span>&#160;                $newgradient[<span class="stringliteral">&#39;mode&#39;</span>] = $gradient[<span class="stringliteral">&#39;mode&#39;</span>];</div>
<div class="line"><a name="l23301"></a><span class="lineno">23301</span>&#160;                $newgradient[<span class="stringliteral">&#39;type&#39;</span>] = $gradient[<span class="stringliteral">&#39;type&#39;</span>];</div>
<div class="line"><a name="l23302"></a><span class="lineno">23302</span>&#160;                $newgradient[<span class="stringliteral">&#39;gradientUnits&#39;</span>] = $gradient[<span class="stringliteral">&#39;gradientUnits&#39;</span>];</div>
<div class="line"><a name="l23303"></a><span class="lineno">23303</span>&#160;                <span class="keywordflow">if</span> (isset($gradient[<span class="stringliteral">&#39;gradientTransform&#39;</span>])) {</div>
<div class="line"><a name="l23304"></a><span class="lineno">23304</span>&#160;                    $newgradient[<span class="stringliteral">&#39;gradientTransform&#39;</span>] = $gradient[<span class="stringliteral">&#39;gradientTransform&#39;</span>];</div>
<div class="line"><a name="l23305"></a><span class="lineno">23305</span>&#160;                }</div>
<div class="line"><a name="l23306"></a><span class="lineno">23306</span>&#160;                $gradient = $newgradient;</div>
<div class="line"><a name="l23307"></a><span class="lineno">23307</span>&#160;            }</div>
<div class="line"><a name="l23308"></a><span class="lineno">23308</span>&#160;            <span class="comment">//save current Graphic State</span></div>
<div class="line"><a name="l23309"></a><span class="lineno">23309</span>&#160;            $this-&gt;_outSaveGraphicsState();</div>
<div class="line"><a name="l23310"></a><span class="lineno">23310</span>&#160;            <span class="comment">//set clipping area</span></div>
<div class="line"><a name="l23311"></a><span class="lineno">23311</span>&#160;            <span class="keywordflow">if</span> (!empty($clip_function) AND method_exists($this, $clip_function)) {</div>
<div class="line"><a name="l23312"></a><span class="lineno">23312</span>&#160;                $bbox = call_user_func_array(array($this, $clip_function), $clip_params);</div>
<div class="line"><a name="l23313"></a><span class="lineno">23313</span>&#160;                <span class="keywordflow">if</span> ((!isset($gradient[<span class="stringliteral">&#39;type&#39;</span>]) OR ($gradient[<span class="stringliteral">&#39;type&#39;</span>] != 3)) AND is_array($bbox) AND (count($bbox) == 4)) {</div>
<div class="line"><a name="l23314"></a><span class="lineno">23314</span>&#160;                    list($x, $y, $w, $h) = $bbox;</div>
<div class="line"><a name="l23315"></a><span class="lineno">23315</span>&#160;                }</div>
<div class="line"><a name="l23316"></a><span class="lineno">23316</span>&#160;            }</div>
<div class="line"><a name="l23317"></a><span class="lineno">23317</span>&#160;            <span class="keywordflow">if</span> ($gradient[<span class="stringliteral">&#39;mode&#39;</span>] == <span class="stringliteral">&#39;measure&#39;</span>) {</div>
<div class="line"><a name="l23318"></a><span class="lineno">23318</span>&#160;                <span class="keywordflow">if</span> (!isset($gradient[<span class="stringliteral">&#39;coords&#39;</span>][4])) {</div>
<div class="line"><a name="l23319"></a><span class="lineno">23319</span>&#160;                    $gradient[<span class="stringliteral">&#39;coords&#39;</span>][4] = 0.5;</div>
<div class="line"><a name="l23320"></a><span class="lineno">23320</span>&#160;                }</div>
<div class="line"><a name="l23321"></a><span class="lineno">23321</span>&#160;                <span class="keywordflow">if</span> (isset($gradient[<span class="stringliteral">&#39;gradientTransform&#39;</span>]) AND !empty($gradient[<span class="stringliteral">&#39;gradientTransform&#39;</span>])) {</div>
<div class="line"><a name="l23322"></a><span class="lineno">23322</span>&#160;                    $gtm = $gradient[<span class="stringliteral">&#39;gradientTransform&#39;</span>];</div>
<div class="line"><a name="l23323"></a><span class="lineno">23323</span>&#160;                    <span class="comment">// apply transformation matrix</span></div>
<div class="line"><a name="l23324"></a><span class="lineno">23324</span>&#160;                    $xa = ($gtm[0] * $gradient[<span class="stringliteral">&#39;coords&#39;</span>][0]) + ($gtm[2] * $gradient[<span class="stringliteral">&#39;coords&#39;</span>][1]) + $gtm[4];</div>
<div class="line"><a name="l23325"></a><span class="lineno">23325</span>&#160;                    $ya = ($gtm[1] * $gradient[<span class="stringliteral">&#39;coords&#39;</span>][0]) + ($gtm[3] * $gradient[<span class="stringliteral">&#39;coords&#39;</span>][1]) + $gtm[5];</div>
<div class="line"><a name="l23326"></a><span class="lineno">23326</span>&#160;                    $xb = ($gtm[0] * $gradient[<span class="stringliteral">&#39;coords&#39;</span>][2]) + ($gtm[2] * $gradient[<span class="stringliteral">&#39;coords&#39;</span>][3]) + $gtm[4];</div>
<div class="line"><a name="l23327"></a><span class="lineno">23327</span>&#160;                    $yb = ($gtm[1] * $gradient[<span class="stringliteral">&#39;coords&#39;</span>][2]) + ($gtm[3] * $gradient[<span class="stringliteral">&#39;coords&#39;</span>][3]) + $gtm[5];</div>
<div class="line"><a name="l23328"></a><span class="lineno">23328</span>&#160;                    $r = sqrt(pow(($gtm[0] * $gradient[<span class="stringliteral">&#39;coords&#39;</span>][4]), 2) + pow(($gtm[1] * $gradient[<span class="stringliteral">&#39;coords&#39;</span>][4]), 2));</div>
<div class="line"><a name="l23329"></a><span class="lineno">23329</span>&#160;                    $gradient[<span class="stringliteral">&#39;coords&#39;</span>][0] = $xa;</div>
<div class="line"><a name="l23330"></a><span class="lineno">23330</span>&#160;                    $gradient[<span class="stringliteral">&#39;coords&#39;</span>][1] = $ya;</div>
<div class="line"><a name="l23331"></a><span class="lineno">23331</span>&#160;                    $gradient[<span class="stringliteral">&#39;coords&#39;</span>][2] = $xb;</div>
<div class="line"><a name="l23332"></a><span class="lineno">23332</span>&#160;                    $gradient[<span class="stringliteral">&#39;coords&#39;</span>][3] = $yb;</div>
<div class="line"><a name="l23333"></a><span class="lineno">23333</span>&#160;                    $gradient[<span class="stringliteral">&#39;coords&#39;</span>][4] = $r;</div>
<div class="line"><a name="l23334"></a><span class="lineno">23334</span>&#160;                }</div>
<div class="line"><a name="l23335"></a><span class="lineno">23335</span>&#160;                <span class="comment">// convert SVG coordinates to user units</span></div>
<div class="line"><a name="l23336"></a><span class="lineno">23336</span>&#160;                $gradient[<span class="stringliteral">&#39;coords&#39;</span>][0] = $this-&gt;getHTMLUnitToUnits($gradient[<span class="stringliteral">&#39;coords&#39;</span>][0], 0, $this-&gt;svgunit, <span class="keyword">false</span>);</div>
<div class="line"><a name="l23337"></a><span class="lineno">23337</span>&#160;                $gradient[<span class="stringliteral">&#39;coords&#39;</span>][1] = $this-&gt;getHTMLUnitToUnits($gradient[<span class="stringliteral">&#39;coords&#39;</span>][1], 0, $this-&gt;svgunit, <span class="keyword">false</span>);</div>
<div class="line"><a name="l23338"></a><span class="lineno">23338</span>&#160;                $gradient[<span class="stringliteral">&#39;coords&#39;</span>][2] = $this-&gt;getHTMLUnitToUnits($gradient[<span class="stringliteral">&#39;coords&#39;</span>][2], 0, $this-&gt;svgunit, <span class="keyword">false</span>);</div>
<div class="line"><a name="l23339"></a><span class="lineno">23339</span>&#160;                $gradient[<span class="stringliteral">&#39;coords&#39;</span>][3] = $this-&gt;getHTMLUnitToUnits($gradient[<span class="stringliteral">&#39;coords&#39;</span>][3], 0, $this-&gt;svgunit, <span class="keyword">false</span>);</div>
<div class="line"><a name="l23340"></a><span class="lineno">23340</span>&#160;                $gradient[<span class="stringliteral">&#39;coords&#39;</span>][4] = $this-&gt;getHTMLUnitToUnits($gradient[<span class="stringliteral">&#39;coords&#39;</span>][4], 0, $this-&gt;svgunit, <span class="keyword">false</span>);</div>
<div class="line"><a name="l23341"></a><span class="lineno">23341</span>&#160;                <span class="keywordflow">if</span> ($w &lt;= $minlen) {</div>
<div class="line"><a name="l23342"></a><span class="lineno">23342</span>&#160;                    $w = $minlen;</div>
<div class="line"><a name="l23343"></a><span class="lineno">23343</span>&#160;                }</div>
<div class="line"><a name="l23344"></a><span class="lineno">23344</span>&#160;                <span class="keywordflow">if</span> ($h &lt;= $minlen) {</div>
<div class="line"><a name="l23345"></a><span class="lineno">23345</span>&#160;                    $h = $minlen;</div>
<div class="line"><a name="l23346"></a><span class="lineno">23346</span>&#160;                }</div>
<div class="line"><a name="l23347"></a><span class="lineno">23347</span>&#160;                <span class="comment">// shift units</span></div>
<div class="line"><a name="l23348"></a><span class="lineno">23348</span>&#160;                <span class="keywordflow">if</span> ($gradient[<span class="stringliteral">&#39;gradientUnits&#39;</span>] == <span class="stringliteral">&#39;objectBoundingBox&#39;</span>) {</div>
<div class="line"><a name="l23349"></a><span class="lineno">23349</span>&#160;                    <span class="comment">// convert to SVG coordinate system</span></div>
<div class="line"><a name="l23350"></a><span class="lineno">23350</span>&#160;                    $gradient[<span class="stringliteral">&#39;coords&#39;</span>][0] += $x;</div>
<div class="line"><a name="l23351"></a><span class="lineno">23351</span>&#160;                    $gradient[<span class="stringliteral">&#39;coords&#39;</span>][1] += $y;</div>
<div class="line"><a name="l23352"></a><span class="lineno">23352</span>&#160;                    $gradient[<span class="stringliteral">&#39;coords&#39;</span>][2] += $x;</div>
<div class="line"><a name="l23353"></a><span class="lineno">23353</span>&#160;                    $gradient[<span class="stringliteral">&#39;coords&#39;</span>][3] += $y;</div>
<div class="line"><a name="l23354"></a><span class="lineno">23354</span>&#160;                }</div>
<div class="line"><a name="l23355"></a><span class="lineno">23355</span>&#160;                <span class="comment">// calculate percentages</span></div>
<div class="line"><a name="l23356"></a><span class="lineno">23356</span>&#160;                $gradient[<span class="stringliteral">&#39;coords&#39;</span>][0] = (($gradient[<span class="stringliteral">&#39;coords&#39;</span>][0] - $x) / $w);</div>
<div class="line"><a name="l23357"></a><span class="lineno">23357</span>&#160;                $gradient[<span class="stringliteral">&#39;coords&#39;</span>][1] = (($gradient[<span class="stringliteral">&#39;coords&#39;</span>][1] - $y) / $h);</div>
<div class="line"><a name="l23358"></a><span class="lineno">23358</span>&#160;                $gradient[<span class="stringliteral">&#39;coords&#39;</span>][2] = (($gradient[<span class="stringliteral">&#39;coords&#39;</span>][2] - $x) / $w);</div>
<div class="line"><a name="l23359"></a><span class="lineno">23359</span>&#160;                $gradient[<span class="stringliteral">&#39;coords&#39;</span>][3] = (($gradient[<span class="stringliteral">&#39;coords&#39;</span>][3] - $y) / $h);</div>
<div class="line"><a name="l23360"></a><span class="lineno">23360</span>&#160;                $gradient[<span class="stringliteral">&#39;coords&#39;</span>][4] /= $w;</div>
<div class="line"><a name="l23361"></a><span class="lineno">23361</span>&#160;            } elseif ($gradient[<span class="stringliteral">&#39;mode&#39;</span>] == <span class="stringliteral">&#39;percentage&#39;</span>) {</div>
<div class="line"><a name="l23362"></a><span class="lineno">23362</span>&#160;                <span class="keywordflow">foreach</span>($gradient[<span class="stringliteral">&#39;coords&#39;</span>] as $key =&gt; $val) {</div>
<div class="line"><a name="l23363"></a><span class="lineno">23363</span>&#160;                    $gradient[<span class="stringliteral">&#39;coords&#39;</span>][$key] = (intval($val) / 100);</div>
<div class="line"><a name="l23364"></a><span class="lineno">23364</span>&#160;                    <span class="keywordflow">if</span> ($val &lt; 0) {</div>
<div class="line"><a name="l23365"></a><span class="lineno">23365</span>&#160;                        $gradient[<span class="stringliteral">&#39;coords&#39;</span>][$key] = 0;</div>
<div class="line"><a name="l23366"></a><span class="lineno">23366</span>&#160;                    } elseif ($val &gt; 1) {</div>
<div class="line"><a name="l23367"></a><span class="lineno">23367</span>&#160;                        $gradient[<span class="stringliteral">&#39;coords&#39;</span>][$key] = 1;</div>
<div class="line"><a name="l23368"></a><span class="lineno">23368</span>&#160;                    }</div>
<div class="line"><a name="l23369"></a><span class="lineno">23369</span>&#160;                }</div>
<div class="line"><a name="l23370"></a><span class="lineno">23370</span>&#160;            }</div>
<div class="line"><a name="l23371"></a><span class="lineno">23371</span>&#160;            <span class="keywordflow">if</span> (($gradient[<span class="stringliteral">&#39;type&#39;</span>] == 2) AND ($gradient[<span class="stringliteral">&#39;coords&#39;</span>][0] == $gradient[<span class="stringliteral">&#39;coords&#39;</span>][2]) AND ($gradient[<span class="stringliteral">&#39;coords&#39;</span>][1] == $gradient[<span class="stringliteral">&#39;coords&#39;</span>][3])) {</div>
<div class="line"><a name="l23372"></a><span class="lineno">23372</span>&#160;                <span class="comment">// single color (no shading)</span></div>
<div class="line"><a name="l23373"></a><span class="lineno">23373</span>&#160;                $gradient[<span class="stringliteral">&#39;coords&#39;</span>][0] = 1;</div>
<div class="line"><a name="l23374"></a><span class="lineno">23374</span>&#160;                $gradient[<span class="stringliteral">&#39;coords&#39;</span>][1] = 0;</div>
<div class="line"><a name="l23375"></a><span class="lineno">23375</span>&#160;                $gradient[<span class="stringliteral">&#39;coords&#39;</span>][2] = 0.999;</div>
<div class="line"><a name="l23376"></a><span class="lineno">23376</span>&#160;                $gradient[<span class="stringliteral">&#39;coords&#39;</span>][3] = 0;</div>
<div class="line"><a name="l23377"></a><span class="lineno">23377</span>&#160;            }</div>
<div class="line"><a name="l23378"></a><span class="lineno">23378</span>&#160;            <span class="comment">// swap Y coordinates</span></div>
<div class="line"><a name="l23379"></a><span class="lineno">23379</span>&#160;            $tmp = $gradient[<span class="stringliteral">&#39;coords&#39;</span>][1];</div>
<div class="line"><a name="l23380"></a><span class="lineno">23380</span>&#160;            $gradient[<span class="stringliteral">&#39;coords&#39;</span>][1] = $gradient[<span class="stringliteral">&#39;coords&#39;</span>][3];</div>
<div class="line"><a name="l23381"></a><span class="lineno">23381</span>&#160;            $gradient[<span class="stringliteral">&#39;coords&#39;</span>][3] = $tmp;</div>
<div class="line"><a name="l23382"></a><span class="lineno">23382</span>&#160;            <span class="comment">// set transformation map for gradient</span></div>
<div class="line"><a name="l23383"></a><span class="lineno">23383</span>&#160;            $cy = ($this-&gt;h - $y);</div>
<div class="line"><a name="l23384"></a><span class="lineno">23384</span>&#160;            <span class="keywordflow">if</span> ($gradient[<span class="stringliteral">&#39;type&#39;</span>] == 3) {</div>
<div class="line"><a name="l23385"></a><span class="lineno">23385</span>&#160;                <span class="comment">// circular gradient</span></div>
<div class="line"><a name="l23386"></a><span class="lineno">23386</span>&#160;                $cy -= ($gradient[<span class="stringliteral">&#39;coords&#39;</span>][1] * ($w + $h));</div>
<div class="line"><a name="l23387"></a><span class="lineno">23387</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l23388"></a><span class="lineno">23388</span>&#160;                $cy -= $h;</div>
<div class="line"><a name="l23389"></a><span class="lineno">23389</span>&#160;            }</div>
<div class="line"><a name="l23390"></a><span class="lineno">23390</span>&#160;            $this-&gt;_out(sprintf(<span class="stringliteral">&#39;%F 0 0 %F %F %F cm&#39;</span>, ($w * $this-&gt;k), ($h * $this-&gt;k), ($x * $this-&gt;k), ($cy * $this-&gt;k)));</div>
<div class="line"><a name="l23391"></a><span class="lineno">23391</span>&#160;            <span class="keywordflow">if</span> (count($gradient[<span class="stringliteral">&#39;stops&#39;</span>]) &gt; 1) {</div>
<div class="line"><a name="l23392"></a><span class="lineno">23392</span>&#160;                $this-&gt;Gradient($gradient[<span class="stringliteral">&#39;type&#39;</span>], $gradient[<span class="stringliteral">&#39;coords&#39;</span>], $gradient[<span class="stringliteral">&#39;stops&#39;</span>], array(), <span class="keyword">false</span>);</div>
<div class="line"><a name="l23393"></a><span class="lineno">23393</span>&#160;            }</div>
<div class="line"><a name="l23394"></a><span class="lineno">23394</span>&#160;        } elseif ($svgstyle[<span class="stringliteral">&#39;fill&#39;</span>] != <span class="stringliteral">&#39;none&#39;</span>) {</div>
<div class="line"><a name="l23395"></a><span class="lineno">23395</span>&#160;            $fill_color = TCPDF_COLORS::convertHTMLColorToDec($svgstyle[<span class="stringliteral">&#39;fill&#39;</span>], $this-&gt;spot_colors);</div>
<div class="line"><a name="l23396"></a><span class="lineno">23396</span>&#160;            <span class="keywordflow">if</span> ($svgstyle[<span class="stringliteral">&#39;fill-opacity&#39;</span>] != 1) {</div>
<div class="line"><a name="l23397"></a><span class="lineno">23397</span>&#160;                $this-&gt;setAlpha($this-&gt;alpha[<span class="stringliteral">&#39;CA&#39;</span>], <span class="stringliteral">&#39;Normal&#39;</span>, $svgstyle[<span class="stringliteral">&#39;fill-opacity&#39;</span>], <span class="keyword">false</span>);</div>
<div class="line"><a name="l23398"></a><span class="lineno">23398</span>&#160;            }</div>
<div class="line"><a name="l23399"></a><span class="lineno">23399</span>&#160;            $this-&gt;SetFillColorArray($fill_color);</div>
<div class="line"><a name="l23400"></a><span class="lineno">23400</span>&#160;            <span class="keywordflow">if</span> ($svgstyle[<span class="stringliteral">&#39;fill-rule&#39;</span>] == <span class="stringliteral">&#39;evenodd&#39;</span>) {</div>
<div class="line"><a name="l23401"></a><span class="lineno">23401</span>&#160;                $objstyle .= <span class="stringliteral">&#39;F*&#39;</span>;</div>
<div class="line"><a name="l23402"></a><span class="lineno">23402</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l23403"></a><span class="lineno">23403</span>&#160;                $objstyle .= <span class="charliteral">&#39;F&#39;</span>;</div>
<div class="line"><a name="l23404"></a><span class="lineno">23404</span>&#160;            }</div>
<div class="line"><a name="l23405"></a><span class="lineno">23405</span>&#160;        }</div>
<div class="line"><a name="l23406"></a><span class="lineno">23406</span>&#160;        <span class="comment">// stroke</span></div>
<div class="line"><a name="l23407"></a><span class="lineno">23407</span>&#160;        <span class="keywordflow">if</span> ($svgstyle[<span class="stringliteral">&#39;stroke&#39;</span>] != <span class="stringliteral">&#39;none&#39;</span>) {</div>
<div class="line"><a name="l23408"></a><span class="lineno">23408</span>&#160;            <span class="keywordflow">if</span> ($svgstyle[<span class="stringliteral">&#39;stroke-opacity&#39;</span>] != 1) {</div>
<div class="line"><a name="l23409"></a><span class="lineno">23409</span>&#160;                $this-&gt;setAlpha($svgstyle[<span class="stringliteral">&#39;stroke-opacity&#39;</span>], <span class="stringliteral">&#39;Normal&#39;</span>, $this-&gt;alpha[<span class="stringliteral">&#39;ca&#39;</span>], <span class="keyword">false</span>);</div>
<div class="line"><a name="l23410"></a><span class="lineno">23410</span>&#160;            } elseif (preg_match(<span class="stringliteral">&#39;/rgba\(\d+%?,\s*\d+%?,\s*\d+%?,\s*(\d+(?:\.\d+)?)\)/i&#39;</span>, $svgstyle[<span class="stringliteral">&#39;stroke&#39;</span>], $rgba_matches)) {</div>
<div class="line"><a name="l23411"></a><span class="lineno">23411</span>&#160;                $this-&gt;setAlpha($rgba_matches[1], <span class="stringliteral">&#39;Normal&#39;</span>, $this-&gt;alpha[<span class="stringliteral">&#39;ca&#39;</span>], <span class="keyword">false</span>);</div>
<div class="line"><a name="l23412"></a><span class="lineno">23412</span>&#160;            }</div>
<div class="line"><a name="l23413"></a><span class="lineno">23413</span>&#160;            $stroke_style = array(</div>
<div class="line"><a name="l23414"></a><span class="lineno">23414</span>&#160;                <span class="stringliteral">&#39;color&#39;</span> =&gt; TCPDF_COLORS::convertHTMLColorToDec($svgstyle[<span class="stringliteral">&#39;stroke&#39;</span>], $this-&gt;spot_colors),</div>
<div class="line"><a name="l23415"></a><span class="lineno">23415</span>&#160;                <span class="stringliteral">&#39;width&#39;</span> =&gt; $this-&gt;getHTMLUnitToUnits($svgstyle[<span class="stringliteral">&#39;stroke-width&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>),</div>
<div class="line"><a name="l23416"></a><span class="lineno">23416</span>&#160;                <span class="stringliteral">&#39;cap&#39;</span> =&gt; $svgstyle[<span class="stringliteral">&#39;stroke-linecap&#39;</span>],</div>
<div class="line"><a name="l23417"></a><span class="lineno">23417</span>&#160;                <span class="stringliteral">&#39;join&#39;</span> =&gt; $svgstyle[<span class="stringliteral">&#39;stroke-linejoin&#39;</span>]</div>
<div class="line"><a name="l23418"></a><span class="lineno">23418</span>&#160;                );</div>
<div class="line"><a name="l23419"></a><span class="lineno">23419</span>&#160;            <span class="keywordflow">if</span> (isset($svgstyle[<span class="stringliteral">&#39;stroke-dasharray&#39;</span>]) AND !empty($svgstyle[<span class="stringliteral">&#39;stroke-dasharray&#39;</span>]) AND ($svgstyle[<span class="stringliteral">&#39;stroke-dasharray&#39;</span>] != <span class="stringliteral">&#39;none&#39;</span>)) {</div>
<div class="line"><a name="l23420"></a><span class="lineno">23420</span>&#160;                $stroke_style[<span class="stringliteral">&#39;dash&#39;</span>] = $svgstyle[<span class="stringliteral">&#39;stroke-dasharray&#39;</span>];</div>
<div class="line"><a name="l23421"></a><span class="lineno">23421</span>&#160;            }</div>
<div class="line"><a name="l23422"></a><span class="lineno">23422</span>&#160;            $this-&gt;SetLineStyle($stroke_style);</div>
<div class="line"><a name="l23423"></a><span class="lineno">23423</span>&#160;            $objstyle .= <span class="charliteral">&#39;D&#39;</span>;</div>
<div class="line"><a name="l23424"></a><span class="lineno">23424</span>&#160;        }</div>
<div class="line"><a name="l23425"></a><span class="lineno">23425</span>&#160;        <span class="comment">// font</span></div>
<div class="line"><a name="l23426"></a><span class="lineno">23426</span>&#160;        $regs = array();</div>
<div class="line"><a name="l23427"></a><span class="lineno">23427</span>&#160;        <span class="keywordflow">if</span> (!empty($svgstyle[<span class="stringliteral">&#39;font&#39;</span>])) {</div>
<div class="line"><a name="l23428"></a><span class="lineno">23428</span>&#160;            <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/font-family[\s]*:[\s]*([^\;\&quot;]*)/si&#39;</span>, $svgstyle[<span class="stringliteral">&#39;font&#39;</span>], $regs)) {</div>
<div class="line"><a name="l23429"></a><span class="lineno">23429</span>&#160;                $font_family = $this-&gt;getFontFamilyName($regs[1]);</div>
<div class="line"><a name="l23430"></a><span class="lineno">23430</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l23431"></a><span class="lineno">23431</span>&#160;                $font_family = $svgstyle[<span class="stringliteral">&#39;font-family&#39;</span>];</div>
<div class="line"><a name="l23432"></a><span class="lineno">23432</span>&#160;            }</div>
<div class="line"><a name="l23433"></a><span class="lineno">23433</span>&#160;            <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/font-size[\s]*:[\s]*([^\s\;\&quot;]*)/si&#39;</span>, $svgstyle[<span class="stringliteral">&#39;font&#39;</span>], $regs)) {</div>
<div class="line"><a name="l23434"></a><span class="lineno">23434</span>&#160;                $font_size = trim($regs[1]);</div>
<div class="line"><a name="l23435"></a><span class="lineno">23435</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l23436"></a><span class="lineno">23436</span>&#160;                $font_size = $svgstyle[<span class="stringliteral">&#39;font-size&#39;</span>];</div>
<div class="line"><a name="l23437"></a><span class="lineno">23437</span>&#160;            }</div>
<div class="line"><a name="l23438"></a><span class="lineno">23438</span>&#160;            <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/font-style[\s]*:[\s]*([^\s\;\&quot;]*)/si&#39;</span>, $svgstyle[<span class="stringliteral">&#39;font&#39;</span>], $regs)) {</div>
<div class="line"><a name="l23439"></a><span class="lineno">23439</span>&#160;                $font_style = trim($regs[1]);</div>
<div class="line"><a name="l23440"></a><span class="lineno">23440</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l23441"></a><span class="lineno">23441</span>&#160;                $font_style = $svgstyle[<span class="stringliteral">&#39;font-style&#39;</span>];</div>
<div class="line"><a name="l23442"></a><span class="lineno">23442</span>&#160;            }</div>
<div class="line"><a name="l23443"></a><span class="lineno">23443</span>&#160;            <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/font-weight[\s]*:[\s]*([^\s\;\&quot;]*)/si&#39;</span>, $svgstyle[<span class="stringliteral">&#39;font&#39;</span>], $regs)) {</div>
<div class="line"><a name="l23444"></a><span class="lineno">23444</span>&#160;                $font_weight = trim($regs[1]);</div>
<div class="line"><a name="l23445"></a><span class="lineno">23445</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l23446"></a><span class="lineno">23446</span>&#160;                $font_weight = $svgstyle[<span class="stringliteral">&#39;font-weight&#39;</span>];</div>
<div class="line"><a name="l23447"></a><span class="lineno">23447</span>&#160;            }</div>
<div class="line"><a name="l23448"></a><span class="lineno">23448</span>&#160;            <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/font-stretch[\s]*:[\s]*([^\s\;\&quot;]*)/si&#39;</span>, $svgstyle[<span class="stringliteral">&#39;font&#39;</span>], $regs)) {</div>
<div class="line"><a name="l23449"></a><span class="lineno">23449</span>&#160;                $font_stretch = trim($regs[1]);</div>
<div class="line"><a name="l23450"></a><span class="lineno">23450</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l23451"></a><span class="lineno">23451</span>&#160;                $font_stretch = $svgstyle[<span class="stringliteral">&#39;font-stretch&#39;</span>];</div>
<div class="line"><a name="l23452"></a><span class="lineno">23452</span>&#160;            }</div>
<div class="line"><a name="l23453"></a><span class="lineno">23453</span>&#160;            <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/letter-spacing[\s]*:[\s]*([^\s\;\&quot;]*)/si&#39;</span>, $svgstyle[<span class="stringliteral">&#39;font&#39;</span>], $regs)) {</div>
<div class="line"><a name="l23454"></a><span class="lineno">23454</span>&#160;                $font_spacing = trim($regs[1]);</div>
<div class="line"><a name="l23455"></a><span class="lineno">23455</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l23456"></a><span class="lineno">23456</span>&#160;                $font_spacing = $svgstyle[<span class="stringliteral">&#39;letter-spacing&#39;</span>];</div>
<div class="line"><a name="l23457"></a><span class="lineno">23457</span>&#160;            }</div>
<div class="line"><a name="l23458"></a><span class="lineno">23458</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l23459"></a><span class="lineno">23459</span>&#160;            $font_family = $this-&gt;getFontFamilyName($svgstyle[<span class="stringliteral">&#39;font-family&#39;</span>]);</div>
<div class="line"><a name="l23460"></a><span class="lineno">23460</span>&#160;            $font_size = $svgstyle[<span class="stringliteral">&#39;font-size&#39;</span>];</div>
<div class="line"><a name="l23461"></a><span class="lineno">23461</span>&#160;            $font_style = $svgstyle[<span class="stringliteral">&#39;font-style&#39;</span>];</div>
<div class="line"><a name="l23462"></a><span class="lineno">23462</span>&#160;            $font_weight = $svgstyle[<span class="stringliteral">&#39;font-weight&#39;</span>];</div>
<div class="line"><a name="l23463"></a><span class="lineno">23463</span>&#160;            $font_stretch = $svgstyle[<span class="stringliteral">&#39;font-stretch&#39;</span>];</div>
<div class="line"><a name="l23464"></a><span class="lineno">23464</span>&#160;            $font_spacing = $svgstyle[<span class="stringliteral">&#39;letter-spacing&#39;</span>];</div>
<div class="line"><a name="l23465"></a><span class="lineno">23465</span>&#160;        }</div>
<div class="line"><a name="l23466"></a><span class="lineno">23466</span>&#160;        $font_size = $this-&gt;getHTMLFontUnits($font_size, $this-&gt;svgstyles[0][<span class="stringliteral">&#39;font-size&#39;</span>], $prevsvgstyle[<span class="stringliteral">&#39;font-size&#39;</span>], $this-&gt;svgunit);</div>
<div class="line"><a name="l23467"></a><span class="lineno">23467</span>&#160;        $font_stretch = $this-&gt;getCSSFontStretching($font_stretch, $svgstyle[<span class="stringliteral">&#39;font-stretch&#39;</span>]);</div>
<div class="line"><a name="l23468"></a><span class="lineno">23468</span>&#160;        $font_spacing = $this-&gt;getCSSFontSpacing($font_spacing, $svgstyle[<span class="stringliteral">&#39;letter-spacing&#39;</span>]);</div>
<div class="line"><a name="l23469"></a><span class="lineno">23469</span>&#160;        <span class="keywordflow">switch</span> ($font_style) {</div>
<div class="line"><a name="l23470"></a><span class="lineno">23470</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;italic&#39;</span>: {</div>
<div class="line"><a name="l23471"></a><span class="lineno">23471</span>&#160;                $font_style = <span class="charliteral">&#39;I&#39;</span>;</div>
<div class="line"><a name="l23472"></a><span class="lineno">23472</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l23473"></a><span class="lineno">23473</span>&#160;            }</div>
<div class="line"><a name="l23474"></a><span class="lineno">23474</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;oblique&#39;</span>: {</div>
<div class="line"><a name="l23475"></a><span class="lineno">23475</span>&#160;                $font_style = <span class="charliteral">&#39;I&#39;</span>;</div>
<div class="line"><a name="l23476"></a><span class="lineno">23476</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l23477"></a><span class="lineno">23477</span>&#160;            }</div>
<div class="line"><a name="l23478"></a><span class="lineno">23478</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l23479"></a><span class="lineno">23479</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;normal&#39;</span>: {</div>
<div class="line"><a name="l23480"></a><span class="lineno">23480</span>&#160;                $font_style = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l23481"></a><span class="lineno">23481</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l23482"></a><span class="lineno">23482</span>&#160;            }</div>
<div class="line"><a name="l23483"></a><span class="lineno">23483</span>&#160;        }</div>
<div class="line"><a name="l23484"></a><span class="lineno">23484</span>&#160;        <span class="keywordflow">switch</span> ($font_weight) {</div>
<div class="line"><a name="l23485"></a><span class="lineno">23485</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;bold&#39;</span>:</div>
<div class="line"><a name="l23486"></a><span class="lineno">23486</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;bolder&#39;</span>: {</div>
<div class="line"><a name="l23487"></a><span class="lineno">23487</span>&#160;                $font_style .= <span class="charliteral">&#39;B&#39;</span>;</div>
<div class="line"><a name="l23488"></a><span class="lineno">23488</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l23489"></a><span class="lineno">23489</span>&#160;            }</div>
<div class="line"><a name="l23490"></a><span class="lineno">23490</span>&#160;        }</div>
<div class="line"><a name="l23491"></a><span class="lineno">23491</span>&#160;        <span class="keywordflow">switch</span> ($svgstyle[<span class="stringliteral">&#39;text-decoration&#39;</span>]) {</div>
<div class="line"><a name="l23492"></a><span class="lineno">23492</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;underline&#39;</span>: {</div>
<div class="line"><a name="l23493"></a><span class="lineno">23493</span>&#160;                $font_style .= <span class="charliteral">&#39;U&#39;</span>;</div>
<div class="line"><a name="l23494"></a><span class="lineno">23494</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l23495"></a><span class="lineno">23495</span>&#160;            }</div>
<div class="line"><a name="l23496"></a><span class="lineno">23496</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;overline&#39;</span>: {</div>
<div class="line"><a name="l23497"></a><span class="lineno">23497</span>&#160;                $font_style .= <span class="charliteral">&#39;O&#39;</span>;</div>
<div class="line"><a name="l23498"></a><span class="lineno">23498</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l23499"></a><span class="lineno">23499</span>&#160;            }</div>
<div class="line"><a name="l23500"></a><span class="lineno">23500</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;line-through&#39;</span>: {</div>
<div class="line"><a name="l23501"></a><span class="lineno">23501</span>&#160;                $font_style .= <span class="charliteral">&#39;D&#39;</span>;</div>
<div class="line"><a name="l23502"></a><span class="lineno">23502</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l23503"></a><span class="lineno">23503</span>&#160;            }</div>
<div class="line"><a name="l23504"></a><span class="lineno">23504</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l23505"></a><span class="lineno">23505</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;none&#39;</span>: {</div>
<div class="line"><a name="l23506"></a><span class="lineno">23506</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l23507"></a><span class="lineno">23507</span>&#160;            }</div>
<div class="line"><a name="l23508"></a><span class="lineno">23508</span>&#160;        }</div>
<div class="line"><a name="l23509"></a><span class="lineno">23509</span>&#160;        $this-&gt;SetFont($font_family, $font_style, $font_size);</div>
<div class="line"><a name="l23510"></a><span class="lineno">23510</span>&#160;        $this-&gt;setFontStretching($font_stretch);</div>
<div class="line"><a name="l23511"></a><span class="lineno">23511</span>&#160;        $this-&gt;setFontSpacing($font_spacing);</div>
<div class="line"><a name="l23512"></a><span class="lineno">23512</span>&#160;        <span class="keywordflow">return</span> $objstyle;</div>
<div class="line"><a name="l23513"></a><span class="lineno">23513</span>&#160;    }</div>
<div class="line"><a name="l23514"></a><span class="lineno">23514</span>&#160;</div>
<div class="line"><a name="l23533"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#af9d7a42a746c972f98d36e6fe7ab8f89">23533</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#af9d7a42a746c972f98d36e6fe7ab8f89">SVGPath</a>($d, $style=<span class="stringliteral">&#39;&#39;</span>) {</div>
<div class="line"><a name="l23534"></a><span class="lineno">23534</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;state != 2) {</div>
<div class="line"><a name="l23535"></a><span class="lineno">23535</span>&#160;             <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l23536"></a><span class="lineno">23536</span>&#160;        }</div>
<div class="line"><a name="l23537"></a><span class="lineno">23537</span>&#160;        <span class="comment">// set fill/stroke style</span></div>
<div class="line"><a name="l23538"></a><span class="lineno">23538</span>&#160;        $op = TCPDF_STATIC::getPathPaintOperator($style, <span class="stringliteral">&#39;&#39;</span>);</div>
<div class="line"><a name="l23539"></a><span class="lineno">23539</span>&#160;        <span class="keywordflow">if</span> (empty($op)) {</div>
<div class="line"><a name="l23540"></a><span class="lineno">23540</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l23541"></a><span class="lineno">23541</span>&#160;        }</div>
<div class="line"><a name="l23542"></a><span class="lineno">23542</span>&#160;        $paths = array();</div>
<div class="line"><a name="l23543"></a><span class="lineno">23543</span>&#160;        $d = preg_replace(<span class="stringliteral">&#39;/([0-9ACHLMQSTVZ])([\-\+])/si&#39;</span>, <span class="stringliteral">&#39;\\1 \\2&#39;</span>, $d);</div>
<div class="line"><a name="l23544"></a><span class="lineno">23544</span>&#160;        preg_match_all(<span class="stringliteral">&#39;/([ACHLMQSTVZ])[\s]*([^ACHLMQSTVZ\&quot;]*)/si&#39;</span>, $d, $paths, PREG_SET_ORDER);</div>
<div class="line"><a name="l23545"></a><span class="lineno">23545</span>&#160;        $x = 0;</div>
<div class="line"><a name="l23546"></a><span class="lineno">23546</span>&#160;        $y = 0;</div>
<div class="line"><a name="l23547"></a><span class="lineno">23547</span>&#160;        $x1 = 0;</div>
<div class="line"><a name="l23548"></a><span class="lineno">23548</span>&#160;        $y1 = 0;</div>
<div class="line"><a name="l23549"></a><span class="lineno">23549</span>&#160;        $x2 = 0;</div>
<div class="line"><a name="l23550"></a><span class="lineno">23550</span>&#160;        $y2 = 0;</div>
<div class="line"><a name="l23551"></a><span class="lineno">23551</span>&#160;        $xmin = 2147483647;</div>
<div class="line"><a name="l23552"></a><span class="lineno">23552</span>&#160;        $xmax = 0;</div>
<div class="line"><a name="l23553"></a><span class="lineno">23553</span>&#160;        $ymin = 2147483647;</div>
<div class="line"><a name="l23554"></a><span class="lineno">23554</span>&#160;        $ymax = 0;</div>
<div class="line"><a name="l23555"></a><span class="lineno">23555</span>&#160;        $relcoord = <span class="keyword">false</span>;</div>
<div class="line"><a name="l23556"></a><span class="lineno">23556</span>&#160;        $minlen = (0.01 / $this-&gt;k); <span class="comment">// minimum acceptable length (3 point)</span></div>
<div class="line"><a name="l23557"></a><span class="lineno">23557</span>&#160;        $firstcmd = <span class="keyword">true</span>; <span class="comment">// used to print first point</span></div>
<div class="line"><a name="l23558"></a><span class="lineno">23558</span>&#160;        <span class="comment">// draw curve pieces</span></div>
<div class="line"><a name="l23559"></a><span class="lineno">23559</span>&#160;        <span class="keywordflow">foreach</span> ($paths as $key =&gt; $val) {</div>
<div class="line"><a name="l23560"></a><span class="lineno">23560</span>&#160;            <span class="comment">// get curve type</span></div>
<div class="line"><a name="l23561"></a><span class="lineno">23561</span>&#160;            $cmd = trim($val[1]);</div>
<div class="line"><a name="l23562"></a><span class="lineno">23562</span>&#160;            <span class="keywordflow">if</span> (strtolower($cmd) == $cmd) {</div>
<div class="line"><a name="l23563"></a><span class="lineno">23563</span>&#160;                <span class="comment">// use relative coordinated instead of absolute</span></div>
<div class="line"><a name="l23564"></a><span class="lineno">23564</span>&#160;                $relcoord = <span class="keyword">true</span>;</div>
<div class="line"><a name="l23565"></a><span class="lineno">23565</span>&#160;                $xoffset = $x;</div>
<div class="line"><a name="l23566"></a><span class="lineno">23566</span>&#160;                $yoffset = $y;</div>
<div class="line"><a name="l23567"></a><span class="lineno">23567</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l23568"></a><span class="lineno">23568</span>&#160;                $relcoord = <span class="keyword">false</span>;</div>
<div class="line"><a name="l23569"></a><span class="lineno">23569</span>&#160;                $xoffset = 0;</div>
<div class="line"><a name="l23570"></a><span class="lineno">23570</span>&#160;                $yoffset = 0;</div>
<div class="line"><a name="l23571"></a><span class="lineno">23571</span>&#160;            }</div>
<div class="line"><a name="l23572"></a><span class="lineno">23572</span>&#160;            $params = array();</div>
<div class="line"><a name="l23573"></a><span class="lineno">23573</span>&#160;            <span class="keywordflow">if</span> (isset($val[2])) {</div>
<div class="line"><a name="l23574"></a><span class="lineno">23574</span>&#160;                <span class="comment">// get curve parameters</span></div>
<div class="line"><a name="l23575"></a><span class="lineno">23575</span>&#160;                $rawparams = preg_split(<span class="stringliteral">&#39;/([\,\s]+)/si&#39;</span>, trim($val[2]));</div>
<div class="line"><a name="l23576"></a><span class="lineno">23576</span>&#160;                $params = array();</div>
<div class="line"><a name="l23577"></a><span class="lineno">23577</span>&#160;                <span class="keywordflow">foreach</span> ($rawparams as $ck =&gt; $cp) {</div>
<div class="line"><a name="l23578"></a><span class="lineno">23578</span>&#160;                    $params[$ck] = $this-&gt;getHTMLUnitToUnits($cp, 0, $this-&gt;svgunit, <span class="keyword">false</span>);</div>
<div class="line"><a name="l23579"></a><span class="lineno">23579</span>&#160;                    <span class="keywordflow">if</span> (abs($params[$ck]) &lt; $minlen) {</div>
<div class="line"><a name="l23580"></a><span class="lineno">23580</span>&#160;                        <span class="comment">// aproximate little values to zero</span></div>
<div class="line"><a name="l23581"></a><span class="lineno">23581</span>&#160;                        $params[$ck] = 0;</div>
<div class="line"><a name="l23582"></a><span class="lineno">23582</span>&#160;                    }</div>
<div class="line"><a name="l23583"></a><span class="lineno">23583</span>&#160;                }</div>
<div class="line"><a name="l23584"></a><span class="lineno">23584</span>&#160;            }</div>
<div class="line"><a name="l23585"></a><span class="lineno">23585</span>&#160;            <span class="comment">// store current origin point</span></div>
<div class="line"><a name="l23586"></a><span class="lineno">23586</span>&#160;            $x0 = $x;</div>
<div class="line"><a name="l23587"></a><span class="lineno">23587</span>&#160;            $y0 = $y;</div>
<div class="line"><a name="l23588"></a><span class="lineno">23588</span>&#160;            <span class="keywordflow">switch</span> (strtoupper($cmd)) {</div>
<div class="line"><a name="l23589"></a><span class="lineno">23589</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;M&#39;</span>: { <span class="comment">// moveto</span></div>
<div class="line"><a name="l23590"></a><span class="lineno">23590</span>&#160;                    <span class="keywordflow">foreach</span> ($params as $ck =&gt; $cp) {</div>
<div class="line"><a name="l23591"></a><span class="lineno">23591</span>&#160;                        <span class="keywordflow">if</span> (($ck % 2) == 0) {</div>
<div class="line"><a name="l23592"></a><span class="lineno">23592</span>&#160;                            $x = $cp + $xoffset;</div>
<div class="line"><a name="l23593"></a><span class="lineno">23593</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l23594"></a><span class="lineno">23594</span>&#160;                            $y = $cp + $yoffset;</div>
<div class="line"><a name="l23595"></a><span class="lineno">23595</span>&#160;                            <span class="keywordflow">if</span> ($firstcmd OR (abs($x0 - $x) &gt;= $minlen) OR (abs($y0 - $y) &gt;= $minlen)) {</div>
<div class="line"><a name="l23596"></a><span class="lineno">23596</span>&#160;                                <span class="keywordflow">if</span> ($ck == 1) {</div>
<div class="line"><a name="l23597"></a><span class="lineno">23597</span>&#160;                                    $this-&gt;_outPoint($x, $y);</div>
<div class="line"><a name="l23598"></a><span class="lineno">23598</span>&#160;                                    $firstcmd = <span class="keyword">false</span>;</div>
<div class="line"><a name="l23599"></a><span class="lineno">23599</span>&#160;                                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l23600"></a><span class="lineno">23600</span>&#160;                                    $this-&gt;_outLine($x, $y);</div>
<div class="line"><a name="l23601"></a><span class="lineno">23601</span>&#160;                                }</div>
<div class="line"><a name="l23602"></a><span class="lineno">23602</span>&#160;                                $x0 = $x;</div>
<div class="line"><a name="l23603"></a><span class="lineno">23603</span>&#160;                                $y0 = $y;</div>
<div class="line"><a name="l23604"></a><span class="lineno">23604</span>&#160;                            }</div>
<div class="line"><a name="l23605"></a><span class="lineno">23605</span>&#160;                            $xmin = min($xmin, $x);</div>
<div class="line"><a name="l23606"></a><span class="lineno">23606</span>&#160;                            $ymin = min($ymin, $y);</div>
<div class="line"><a name="l23607"></a><span class="lineno">23607</span>&#160;                            $xmax = max($xmax, $x);</div>
<div class="line"><a name="l23608"></a><span class="lineno">23608</span>&#160;                            $ymax = max($ymax, $y);</div>
<div class="line"><a name="l23609"></a><span class="lineno">23609</span>&#160;                            <span class="keywordflow">if</span> ($relcoord) {</div>
<div class="line"><a name="l23610"></a><span class="lineno">23610</span>&#160;                                $xoffset = $x;</div>
<div class="line"><a name="l23611"></a><span class="lineno">23611</span>&#160;                                $yoffset = $y;</div>
<div class="line"><a name="l23612"></a><span class="lineno">23612</span>&#160;                            }</div>
<div class="line"><a name="l23613"></a><span class="lineno">23613</span>&#160;                        }</div>
<div class="line"><a name="l23614"></a><span class="lineno">23614</span>&#160;                    }</div>
<div class="line"><a name="l23615"></a><span class="lineno">23615</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l23616"></a><span class="lineno">23616</span>&#160;                }</div>
<div class="line"><a name="l23617"></a><span class="lineno">23617</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;L&#39;</span>: { <span class="comment">// lineto</span></div>
<div class="line"><a name="l23618"></a><span class="lineno">23618</span>&#160;                    <span class="keywordflow">foreach</span> ($params as $ck =&gt; $cp) {</div>
<div class="line"><a name="l23619"></a><span class="lineno">23619</span>&#160;                        <span class="keywordflow">if</span> (($ck % 2) == 0) {</div>
<div class="line"><a name="l23620"></a><span class="lineno">23620</span>&#160;                            $x = $cp + $xoffset;</div>
<div class="line"><a name="l23621"></a><span class="lineno">23621</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l23622"></a><span class="lineno">23622</span>&#160;                            $y = $cp + $yoffset;</div>
<div class="line"><a name="l23623"></a><span class="lineno">23623</span>&#160;                            <span class="keywordflow">if</span> ((abs($x0 - $x) &gt;= $minlen) OR (abs($y0 - $y) &gt;= $minlen)) {</div>
<div class="line"><a name="l23624"></a><span class="lineno">23624</span>&#160;                                $this-&gt;_outLine($x, $y);</div>
<div class="line"><a name="l23625"></a><span class="lineno">23625</span>&#160;                                $x0 = $x;</div>
<div class="line"><a name="l23626"></a><span class="lineno">23626</span>&#160;                                $y0 = $y;</div>
<div class="line"><a name="l23627"></a><span class="lineno">23627</span>&#160;                            }</div>
<div class="line"><a name="l23628"></a><span class="lineno">23628</span>&#160;                            $xmin = min($xmin, $x);</div>
<div class="line"><a name="l23629"></a><span class="lineno">23629</span>&#160;                            $ymin = min($ymin, $y);</div>
<div class="line"><a name="l23630"></a><span class="lineno">23630</span>&#160;                            $xmax = max($xmax, $x);</div>
<div class="line"><a name="l23631"></a><span class="lineno">23631</span>&#160;                            $ymax = max($ymax, $y);</div>
<div class="line"><a name="l23632"></a><span class="lineno">23632</span>&#160;                            <span class="keywordflow">if</span> ($relcoord) {</div>
<div class="line"><a name="l23633"></a><span class="lineno">23633</span>&#160;                                $xoffset = $x;</div>
<div class="line"><a name="l23634"></a><span class="lineno">23634</span>&#160;                                $yoffset = $y;</div>
<div class="line"><a name="l23635"></a><span class="lineno">23635</span>&#160;                            }</div>
<div class="line"><a name="l23636"></a><span class="lineno">23636</span>&#160;                        }</div>
<div class="line"><a name="l23637"></a><span class="lineno">23637</span>&#160;                    }</div>
<div class="line"><a name="l23638"></a><span class="lineno">23638</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l23639"></a><span class="lineno">23639</span>&#160;                }</div>
<div class="line"><a name="l23640"></a><span class="lineno">23640</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;H&#39;</span>: { <span class="comment">// horizontal lineto</span></div>
<div class="line"><a name="l23641"></a><span class="lineno">23641</span>&#160;                    <span class="keywordflow">foreach</span> ($params as $ck =&gt; $cp) {</div>
<div class="line"><a name="l23642"></a><span class="lineno">23642</span>&#160;                        $x = $cp + $xoffset;</div>
<div class="line"><a name="l23643"></a><span class="lineno">23643</span>&#160;                        <span class="keywordflow">if</span> ((abs($x0 - $x) &gt;= $minlen) OR (abs($y0 - $y) &gt;= $minlen)) {</div>
<div class="line"><a name="l23644"></a><span class="lineno">23644</span>&#160;                            $this-&gt;_outLine($x, $y);</div>
<div class="line"><a name="l23645"></a><span class="lineno">23645</span>&#160;                            $x0 = $x;</div>
<div class="line"><a name="l23646"></a><span class="lineno">23646</span>&#160;                            $y0 = $y;</div>
<div class="line"><a name="l23647"></a><span class="lineno">23647</span>&#160;                        }</div>
<div class="line"><a name="l23648"></a><span class="lineno">23648</span>&#160;                        $xmin = min($xmin, $x);</div>
<div class="line"><a name="l23649"></a><span class="lineno">23649</span>&#160;                        $xmax = max($xmax, $x);</div>
<div class="line"><a name="l23650"></a><span class="lineno">23650</span>&#160;                        <span class="keywordflow">if</span> ($relcoord) {</div>
<div class="line"><a name="l23651"></a><span class="lineno">23651</span>&#160;                            $xoffset = $x;</div>
<div class="line"><a name="l23652"></a><span class="lineno">23652</span>&#160;                        }</div>
<div class="line"><a name="l23653"></a><span class="lineno">23653</span>&#160;                    }</div>
<div class="line"><a name="l23654"></a><span class="lineno">23654</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l23655"></a><span class="lineno">23655</span>&#160;                }</div>
<div class="line"><a name="l23656"></a><span class="lineno">23656</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;V&#39;</span>: { <span class="comment">// vertical lineto</span></div>
<div class="line"><a name="l23657"></a><span class="lineno">23657</span>&#160;                    <span class="keywordflow">foreach</span> ($params as $ck =&gt; $cp) {</div>
<div class="line"><a name="l23658"></a><span class="lineno">23658</span>&#160;                        $y = $cp + $yoffset;</div>
<div class="line"><a name="l23659"></a><span class="lineno">23659</span>&#160;                        <span class="keywordflow">if</span> ((abs($x0 - $x) &gt;= $minlen) OR (abs($y0 - $y) &gt;= $minlen)) {</div>
<div class="line"><a name="l23660"></a><span class="lineno">23660</span>&#160;                            $this-&gt;_outLine($x, $y);</div>
<div class="line"><a name="l23661"></a><span class="lineno">23661</span>&#160;                            $x0 = $x;</div>
<div class="line"><a name="l23662"></a><span class="lineno">23662</span>&#160;                            $y0 = $y;</div>
<div class="line"><a name="l23663"></a><span class="lineno">23663</span>&#160;                        }</div>
<div class="line"><a name="l23664"></a><span class="lineno">23664</span>&#160;                        $ymin = min($ymin, $y);</div>
<div class="line"><a name="l23665"></a><span class="lineno">23665</span>&#160;                        $ymax = max($ymax, $y);</div>
<div class="line"><a name="l23666"></a><span class="lineno">23666</span>&#160;                        <span class="keywordflow">if</span> ($relcoord) {</div>
<div class="line"><a name="l23667"></a><span class="lineno">23667</span>&#160;                            $yoffset = $y;</div>
<div class="line"><a name="l23668"></a><span class="lineno">23668</span>&#160;                        }</div>
<div class="line"><a name="l23669"></a><span class="lineno">23669</span>&#160;                    }</div>
<div class="line"><a name="l23670"></a><span class="lineno">23670</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l23671"></a><span class="lineno">23671</span>&#160;                }</div>
<div class="line"><a name="l23672"></a><span class="lineno">23672</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;C&#39;</span>: { <span class="comment">// curveto</span></div>
<div class="line"><a name="l23673"></a><span class="lineno">23673</span>&#160;                    <span class="keywordflow">foreach</span> ($params as $ck =&gt; $cp) {</div>
<div class="line"><a name="l23674"></a><span class="lineno">23674</span>&#160;                        $params[$ck] = $cp;</div>
<div class="line"><a name="l23675"></a><span class="lineno">23675</span>&#160;                        <span class="keywordflow">if</span> ((($ck + 1) % 6) == 0) {</div>
<div class="line"><a name="l23676"></a><span class="lineno">23676</span>&#160;                            $x1 = $params[($ck - 5)] + $xoffset;</div>
<div class="line"><a name="l23677"></a><span class="lineno">23677</span>&#160;                            $y1 = $params[($ck - 4)] + $yoffset;</div>
<div class="line"><a name="l23678"></a><span class="lineno">23678</span>&#160;                            $x2 = $params[($ck - 3)] + $xoffset;</div>
<div class="line"><a name="l23679"></a><span class="lineno">23679</span>&#160;                            $y2 = $params[($ck - 2)] + $yoffset;</div>
<div class="line"><a name="l23680"></a><span class="lineno">23680</span>&#160;                            $x = $params[($ck - 1)] + $xoffset;</div>
<div class="line"><a name="l23681"></a><span class="lineno">23681</span>&#160;                            $y = $params[($ck)] + $yoffset;</div>
<div class="line"><a name="l23682"></a><span class="lineno">23682</span>&#160;                            $this-&gt;_outCurve($x1, $y1, $x2, $y2, $x, $y);</div>
<div class="line"><a name="l23683"></a><span class="lineno">23683</span>&#160;                            $xmin = min($xmin, $x, $x1, $x2);</div>
<div class="line"><a name="l23684"></a><span class="lineno">23684</span>&#160;                            $ymin = min($ymin, $y, $y1, $y2);</div>
<div class="line"><a name="l23685"></a><span class="lineno">23685</span>&#160;                            $xmax = max($xmax, $x, $x1, $x2);</div>
<div class="line"><a name="l23686"></a><span class="lineno">23686</span>&#160;                            $ymax = max($ymax, $y, $y1, $y2);</div>
<div class="line"><a name="l23687"></a><span class="lineno">23687</span>&#160;                            <span class="keywordflow">if</span> ($relcoord) {</div>
<div class="line"><a name="l23688"></a><span class="lineno">23688</span>&#160;                                $xoffset = $x;</div>
<div class="line"><a name="l23689"></a><span class="lineno">23689</span>&#160;                                $yoffset = $y;</div>
<div class="line"><a name="l23690"></a><span class="lineno">23690</span>&#160;                            }</div>
<div class="line"><a name="l23691"></a><span class="lineno">23691</span>&#160;                        }</div>
<div class="line"><a name="l23692"></a><span class="lineno">23692</span>&#160;                    }</div>
<div class="line"><a name="l23693"></a><span class="lineno">23693</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l23694"></a><span class="lineno">23694</span>&#160;                }</div>
<div class="line"><a name="l23695"></a><span class="lineno">23695</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;S&#39;</span>: { <span class="comment">// shorthand/smooth curveto</span></div>
<div class="line"><a name="l23696"></a><span class="lineno">23696</span>&#160;                    <span class="keywordflow">foreach</span> ($params as $ck =&gt; $cp) {</div>
<div class="line"><a name="l23697"></a><span class="lineno">23697</span>&#160;                        $params[$ck] = $cp;</div>
<div class="line"><a name="l23698"></a><span class="lineno">23698</span>&#160;                        <span class="keywordflow">if</span> ((($ck + 1) % 4) == 0) {</div>
<div class="line"><a name="l23699"></a><span class="lineno">23699</span>&#160;                            <span class="keywordflow">if</span> (($key &gt; 0) AND ((strtoupper($paths[($key - 1)][1]) == <span class="charliteral">&#39;C&#39;</span>) OR (strtoupper($paths[($key - 1)][1]) == <span class="charliteral">&#39;S&#39;</span>))) {</div>
<div class="line"><a name="l23700"></a><span class="lineno">23700</span>&#160;                                $x1 = (2 * $x) - $x2;</div>
<div class="line"><a name="l23701"></a><span class="lineno">23701</span>&#160;                                $y1 = (2 * $y) - $y2;</div>
<div class="line"><a name="l23702"></a><span class="lineno">23702</span>&#160;                            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l23703"></a><span class="lineno">23703</span>&#160;                                $x1 = $x;</div>
<div class="line"><a name="l23704"></a><span class="lineno">23704</span>&#160;                                $y1 = $y;</div>
<div class="line"><a name="l23705"></a><span class="lineno">23705</span>&#160;                            }</div>
<div class="line"><a name="l23706"></a><span class="lineno">23706</span>&#160;                            $x2 = $params[($ck - 3)] + $xoffset;</div>
<div class="line"><a name="l23707"></a><span class="lineno">23707</span>&#160;                            $y2 = $params[($ck - 2)] + $yoffset;</div>
<div class="line"><a name="l23708"></a><span class="lineno">23708</span>&#160;                            $x = $params[($ck - 1)] + $xoffset;</div>
<div class="line"><a name="l23709"></a><span class="lineno">23709</span>&#160;                            $y = $params[($ck)] + $yoffset;</div>
<div class="line"><a name="l23710"></a><span class="lineno">23710</span>&#160;                            $this-&gt;_outCurve($x1, $y1, $x2, $y2, $x, $y);</div>
<div class="line"><a name="l23711"></a><span class="lineno">23711</span>&#160;                            $xmin = min($xmin, $x, $x1, $x2);</div>
<div class="line"><a name="l23712"></a><span class="lineno">23712</span>&#160;                            $ymin = min($ymin, $y, $y1, $y2);</div>
<div class="line"><a name="l23713"></a><span class="lineno">23713</span>&#160;                            $xmax = max($xmax, $x, $x1, $x2);</div>
<div class="line"><a name="l23714"></a><span class="lineno">23714</span>&#160;                            $ymax = max($ymax, $y, $y1, $y2);</div>
<div class="line"><a name="l23715"></a><span class="lineno">23715</span>&#160;                            <span class="keywordflow">if</span> ($relcoord) {</div>
<div class="line"><a name="l23716"></a><span class="lineno">23716</span>&#160;                                $xoffset = $x;</div>
<div class="line"><a name="l23717"></a><span class="lineno">23717</span>&#160;                                $yoffset = $y;</div>
<div class="line"><a name="l23718"></a><span class="lineno">23718</span>&#160;                            }</div>
<div class="line"><a name="l23719"></a><span class="lineno">23719</span>&#160;                        }</div>
<div class="line"><a name="l23720"></a><span class="lineno">23720</span>&#160;                    }</div>
<div class="line"><a name="l23721"></a><span class="lineno">23721</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l23722"></a><span class="lineno">23722</span>&#160;                }</div>
<div class="line"><a name="l23723"></a><span class="lineno">23723</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;Q&#39;</span>: { <span class="comment">// quadratic Bezier curveto</span></div>
<div class="line"><a name="l23724"></a><span class="lineno">23724</span>&#160;                    <span class="keywordflow">foreach</span> ($params as $ck =&gt; $cp) {</div>
<div class="line"><a name="l23725"></a><span class="lineno">23725</span>&#160;                        $params[$ck] = $cp;</div>
<div class="line"><a name="l23726"></a><span class="lineno">23726</span>&#160;                        <span class="keywordflow">if</span> ((($ck + 1) % 4) == 0) {</div>
<div class="line"><a name="l23727"></a><span class="lineno">23727</span>&#160;                            <span class="comment">// convert quadratic points to cubic points</span></div>
<div class="line"><a name="l23728"></a><span class="lineno">23728</span>&#160;                            $x1 = $params[($ck - 3)] + $xoffset;</div>
<div class="line"><a name="l23729"></a><span class="lineno">23729</span>&#160;                            $y1 = $params[($ck - 2)] + $yoffset;</div>
<div class="line"><a name="l23730"></a><span class="lineno">23730</span>&#160;                            $xa = ($x + (2 * $x1)) / 3;</div>
<div class="line"><a name="l23731"></a><span class="lineno">23731</span>&#160;                            $ya = ($y + (2 * $y1)) / 3;</div>
<div class="line"><a name="l23732"></a><span class="lineno">23732</span>&#160;                            $x = $params[($ck - 1)] + $xoffset;</div>
<div class="line"><a name="l23733"></a><span class="lineno">23733</span>&#160;                            $y = $params[($ck)] + $yoffset;</div>
<div class="line"><a name="l23734"></a><span class="lineno">23734</span>&#160;                            $xb = ($x + (2 * $x1)) / 3;</div>
<div class="line"><a name="l23735"></a><span class="lineno">23735</span>&#160;                            $yb = ($y + (2 * $y1)) / 3;</div>
<div class="line"><a name="l23736"></a><span class="lineno">23736</span>&#160;                            $this-&gt;_outCurve($xa, $ya, $xb, $yb, $x, $y);</div>
<div class="line"><a name="l23737"></a><span class="lineno">23737</span>&#160;                            $xmin = min($xmin, $x, $xa, $xb);</div>
<div class="line"><a name="l23738"></a><span class="lineno">23738</span>&#160;                            $ymin = min($ymin, $y, $ya, $yb);</div>
<div class="line"><a name="l23739"></a><span class="lineno">23739</span>&#160;                            $xmax = max($xmax, $x, $xa, $xb);</div>
<div class="line"><a name="l23740"></a><span class="lineno">23740</span>&#160;                            $ymax = max($ymax, $y, $ya, $yb);</div>
<div class="line"><a name="l23741"></a><span class="lineno">23741</span>&#160;                            <span class="keywordflow">if</span> ($relcoord) {</div>
<div class="line"><a name="l23742"></a><span class="lineno">23742</span>&#160;                                $xoffset = $x;</div>
<div class="line"><a name="l23743"></a><span class="lineno">23743</span>&#160;                                $yoffset = $y;</div>
<div class="line"><a name="l23744"></a><span class="lineno">23744</span>&#160;                            }</div>
<div class="line"><a name="l23745"></a><span class="lineno">23745</span>&#160;                        }</div>
<div class="line"><a name="l23746"></a><span class="lineno">23746</span>&#160;                    }</div>
<div class="line"><a name="l23747"></a><span class="lineno">23747</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l23748"></a><span class="lineno">23748</span>&#160;                }</div>
<div class="line"><a name="l23749"></a><span class="lineno">23749</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>: { <span class="comment">// shorthand/smooth quadratic Bezier curveto</span></div>
<div class="line"><a name="l23750"></a><span class="lineno">23750</span>&#160;                    <span class="keywordflow">foreach</span> ($params as $ck =&gt; $cp) {</div>
<div class="line"><a name="l23751"></a><span class="lineno">23751</span>&#160;                        $params[$ck] = $cp;</div>
<div class="line"><a name="l23752"></a><span class="lineno">23752</span>&#160;                        <span class="keywordflow">if</span> (($ck % 2) != 0) {</div>
<div class="line"><a name="l23753"></a><span class="lineno">23753</span>&#160;                            <span class="keywordflow">if</span> (($key &gt; 0) AND ((strtoupper($paths[($key - 1)][1]) == <span class="charliteral">&#39;Q&#39;</span>) OR (strtoupper($paths[($key - 1)][1]) == <span class="charliteral">&#39;T&#39;</span>))) {</div>
<div class="line"><a name="l23754"></a><span class="lineno">23754</span>&#160;                                $x1 = (2 * $x) - $x1;</div>
<div class="line"><a name="l23755"></a><span class="lineno">23755</span>&#160;                                $y1 = (2 * $y) - $y1;</div>
<div class="line"><a name="l23756"></a><span class="lineno">23756</span>&#160;                            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l23757"></a><span class="lineno">23757</span>&#160;                                $x1 = $x;</div>
<div class="line"><a name="l23758"></a><span class="lineno">23758</span>&#160;                                $y1 = $y;</div>
<div class="line"><a name="l23759"></a><span class="lineno">23759</span>&#160;                            }</div>
<div class="line"><a name="l23760"></a><span class="lineno">23760</span>&#160;                            <span class="comment">// convert quadratic points to cubic points</span></div>
<div class="line"><a name="l23761"></a><span class="lineno">23761</span>&#160;                            $xa = ($x + (2 * $x1)) / 3;</div>
<div class="line"><a name="l23762"></a><span class="lineno">23762</span>&#160;                            $ya = ($y + (2 * $y1)) / 3;</div>
<div class="line"><a name="l23763"></a><span class="lineno">23763</span>&#160;                            $x = $params[($ck - 1)] + $xoffset;</div>
<div class="line"><a name="l23764"></a><span class="lineno">23764</span>&#160;                            $y = $params[($ck)] + $yoffset;</div>
<div class="line"><a name="l23765"></a><span class="lineno">23765</span>&#160;                            $xb = ($x + (2 * $x1)) / 3;</div>
<div class="line"><a name="l23766"></a><span class="lineno">23766</span>&#160;                            $yb = ($y + (2 * $y1)) / 3;</div>
<div class="line"><a name="l23767"></a><span class="lineno">23767</span>&#160;                            $this-&gt;_outCurve($xa, $ya, $xb, $yb, $x, $y);</div>
<div class="line"><a name="l23768"></a><span class="lineno">23768</span>&#160;                            $xmin = min($xmin, $x, $xa, $xb);</div>
<div class="line"><a name="l23769"></a><span class="lineno">23769</span>&#160;                            $ymin = min($ymin, $y, $ya, $yb);</div>
<div class="line"><a name="l23770"></a><span class="lineno">23770</span>&#160;                            $xmax = max($xmax, $x, $xa, $xb);</div>
<div class="line"><a name="l23771"></a><span class="lineno">23771</span>&#160;                            $ymax = max($ymax, $y, $ya, $yb);</div>
<div class="line"><a name="l23772"></a><span class="lineno">23772</span>&#160;                            <span class="keywordflow">if</span> ($relcoord) {</div>
<div class="line"><a name="l23773"></a><span class="lineno">23773</span>&#160;                                $xoffset = $x;</div>
<div class="line"><a name="l23774"></a><span class="lineno">23774</span>&#160;                                $yoffset = $y;</div>
<div class="line"><a name="l23775"></a><span class="lineno">23775</span>&#160;                            }</div>
<div class="line"><a name="l23776"></a><span class="lineno">23776</span>&#160;                        }</div>
<div class="line"><a name="l23777"></a><span class="lineno">23777</span>&#160;                    }</div>
<div class="line"><a name="l23778"></a><span class="lineno">23778</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l23779"></a><span class="lineno">23779</span>&#160;                }</div>
<div class="line"><a name="l23780"></a><span class="lineno">23780</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;A&#39;</span>: { <span class="comment">// elliptical arc</span></div>
<div class="line"><a name="l23781"></a><span class="lineno">23781</span>&#160;                    <span class="keywordflow">foreach</span> ($params as $ck =&gt; $cp) {</div>
<div class="line"><a name="l23782"></a><span class="lineno">23782</span>&#160;                        $params[$ck] = $cp;</div>
<div class="line"><a name="l23783"></a><span class="lineno">23783</span>&#160;                        <span class="keywordflow">if</span> ((($ck + 1) % 7) == 0) {</div>
<div class="line"><a name="l23784"></a><span class="lineno">23784</span>&#160;                            $x0 = $x;</div>
<div class="line"><a name="l23785"></a><span class="lineno">23785</span>&#160;                            $y0 = $y;</div>
<div class="line"><a name="l23786"></a><span class="lineno">23786</span>&#160;                            $rx = abs($params[($ck - 6)]);</div>
<div class="line"><a name="l23787"></a><span class="lineno">23787</span>&#160;                            $ry = abs($params[($ck - 5)]);</div>
<div class="line"><a name="l23788"></a><span class="lineno">23788</span>&#160;                            $ang = -$rawparams[($ck - 4)];</div>
<div class="line"><a name="l23789"></a><span class="lineno">23789</span>&#160;                            $angle = deg2rad($ang);</div>
<div class="line"><a name="l23790"></a><span class="lineno">23790</span>&#160;                            $fa = $rawparams[($ck - 3)]; <span class="comment">// large-arc-flag</span></div>
<div class="line"><a name="l23791"></a><span class="lineno">23791</span>&#160;                            $fs = $rawparams[($ck - 2)]; <span class="comment">// sweep-flag</span></div>
<div class="line"><a name="l23792"></a><span class="lineno">23792</span>&#160;                            $x = $params[($ck - 1)] + $xoffset;</div>
<div class="line"><a name="l23793"></a><span class="lineno">23793</span>&#160;                            $y = $params[$ck] + $yoffset;</div>
<div class="line"><a name="l23794"></a><span class="lineno">23794</span>&#160;                            <span class="keywordflow">if</span> ((abs($x0 - $x) &lt; $minlen) AND (abs($y0 - $y) &lt; $minlen)) {</div>
<div class="line"><a name="l23795"></a><span class="lineno">23795</span>&#160;                                <span class="comment">// endpoints are almost identical</span></div>
<div class="line"><a name="l23796"></a><span class="lineno">23796</span>&#160;                                $xmin = min($xmin, $x);</div>
<div class="line"><a name="l23797"></a><span class="lineno">23797</span>&#160;                                $ymin = min($ymin, $y);</div>
<div class="line"><a name="l23798"></a><span class="lineno">23798</span>&#160;                                $xmax = max($xmax, $x);</div>
<div class="line"><a name="l23799"></a><span class="lineno">23799</span>&#160;                                $ymax = max($ymax, $y);</div>
<div class="line"><a name="l23800"></a><span class="lineno">23800</span>&#160;                            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l23801"></a><span class="lineno">23801</span>&#160;                                $cos_ang = cos($angle);</div>
<div class="line"><a name="l23802"></a><span class="lineno">23802</span>&#160;                                $sin_ang = sin($angle);</div>
<div class="line"><a name="l23803"></a><span class="lineno">23803</span>&#160;                                $a = (($x0 - $x) / 2);</div>
<div class="line"><a name="l23804"></a><span class="lineno">23804</span>&#160;                                $b = (($y0 - $y) / 2);</div>
<div class="line"><a name="l23805"></a><span class="lineno">23805</span>&#160;                                $xa = ($a * $cos_ang) - ($b * $sin_ang);</div>
<div class="line"><a name="l23806"></a><span class="lineno">23806</span>&#160;                                $ya = ($a * $sin_ang) + ($b * $cos_ang);</div>
<div class="line"><a name="l23807"></a><span class="lineno">23807</span>&#160;                                $rx2 = $rx * $rx;</div>
<div class="line"><a name="l23808"></a><span class="lineno">23808</span>&#160;                                $ry2 = $ry * $ry;</div>
<div class="line"><a name="l23809"></a><span class="lineno">23809</span>&#160;                                $xa2 = $xa * $xa;</div>
<div class="line"><a name="l23810"></a><span class="lineno">23810</span>&#160;                                $ya2 = $ya * $ya;</div>
<div class="line"><a name="l23811"></a><span class="lineno">23811</span>&#160;                                $delta = ($xa2 / $rx2) + ($ya2 / $ry2);</div>
<div class="line"><a name="l23812"></a><span class="lineno">23812</span>&#160;                                <span class="keywordflow">if</span> ($delta &gt; 1) {</div>
<div class="line"><a name="l23813"></a><span class="lineno">23813</span>&#160;                                    $rx *= sqrt($delta);</div>
<div class="line"><a name="l23814"></a><span class="lineno">23814</span>&#160;                                    $ry *= sqrt($delta);</div>
<div class="line"><a name="l23815"></a><span class="lineno">23815</span>&#160;                                    $rx2 = $rx * $rx;</div>
<div class="line"><a name="l23816"></a><span class="lineno">23816</span>&#160;                                    $ry2 = $ry * $ry;</div>
<div class="line"><a name="l23817"></a><span class="lineno">23817</span>&#160;                                }</div>
<div class="line"><a name="l23818"></a><span class="lineno">23818</span>&#160;                                $numerator = (($rx2 * $ry2) - ($rx2 * $ya2) - ($ry2 * $xa2));</div>
<div class="line"><a name="l23819"></a><span class="lineno">23819</span>&#160;                                <span class="keywordflow">if</span> ($numerator &lt; 0) {</div>
<div class="line"><a name="l23820"></a><span class="lineno">23820</span>&#160;                                    $root = 0;</div>
<div class="line"><a name="l23821"></a><span class="lineno">23821</span>&#160;                                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l23822"></a><span class="lineno">23822</span>&#160;                                    $root = sqrt($numerator / (($rx2 * $ya2) + ($ry2 * $xa2)));</div>
<div class="line"><a name="l23823"></a><span class="lineno">23823</span>&#160;                                }</div>
<div class="line"><a name="l23824"></a><span class="lineno">23824</span>&#160;                                <span class="keywordflow">if</span> ($fa == $fs){</div>
<div class="line"><a name="l23825"></a><span class="lineno">23825</span>&#160;                                    $root *= -1;</div>
<div class="line"><a name="l23826"></a><span class="lineno">23826</span>&#160;                                }</div>
<div class="line"><a name="l23827"></a><span class="lineno">23827</span>&#160;                                $cax = $root * (($rx * $ya) / $ry);</div>
<div class="line"><a name="l23828"></a><span class="lineno">23828</span>&#160;                                $cay = -$root * (($ry * $xa) / $rx);</div>
<div class="line"><a name="l23829"></a><span class="lineno">23829</span>&#160;                                <span class="comment">// coordinates of ellipse center</span></div>
<div class="line"><a name="l23830"></a><span class="lineno">23830</span>&#160;                                $cx = ($cax * $cos_ang) - ($cay * $sin_ang) + (($x0 + $x) / 2);</div>
<div class="line"><a name="l23831"></a><span class="lineno">23831</span>&#160;                                $cy = ($cax * $sin_ang) + ($cay * $cos_ang) + (($y0 + $y) / 2);</div>
<div class="line"><a name="l23832"></a><span class="lineno">23832</span>&#160;                                <span class="comment">// get angles</span></div>
<div class="line"><a name="l23833"></a><span class="lineno">23833</span>&#160;                                $angs = TCPDF_STATIC::getVectorsAngle(1, 0, (($xa - $cax) / $rx), (($cay - $ya) / $ry));</div>
<div class="line"><a name="l23834"></a><span class="lineno">23834</span>&#160;                                $dang = TCPDF_STATIC::getVectorsAngle((($xa - $cax) / $rx), (($ya - $cay) / $ry), ((-$xa - $cax) / $rx), ((-$ya - $cay) / $ry));</div>
<div class="line"><a name="l23835"></a><span class="lineno">23835</span>&#160;                                <span class="keywordflow">if</span> (($fs == 0) AND ($dang &gt; 0)) {</div>
<div class="line"><a name="l23836"></a><span class="lineno">23836</span>&#160;                                    $dang -= (2 * M_PI);</div>
<div class="line"><a name="l23837"></a><span class="lineno">23837</span>&#160;                                } elseif (($fs == 1) AND ($dang &lt; 0)) {</div>
<div class="line"><a name="l23838"></a><span class="lineno">23838</span>&#160;                                    $dang += (2 * M_PI);</div>
<div class="line"><a name="l23839"></a><span class="lineno">23839</span>&#160;                                }</div>
<div class="line"><a name="l23840"></a><span class="lineno">23840</span>&#160;                                $angf = $angs - $dang;</div>
<div class="line"><a name="l23841"></a><span class="lineno">23841</span>&#160;                                <span class="keywordflow">if</span> ((($fs == 0) AND ($angs &gt; $angf)) OR (($fs == 1) AND ($angs &lt; $angf))) {</div>
<div class="line"><a name="l23842"></a><span class="lineno">23842</span>&#160;                                    <span class="comment">// reverse angles</span></div>
<div class="line"><a name="l23843"></a><span class="lineno">23843</span>&#160;                                    $tmp = $angs;</div>
<div class="line"><a name="l23844"></a><span class="lineno">23844</span>&#160;                                    $angs = $angf;</div>
<div class="line"><a name="l23845"></a><span class="lineno">23845</span>&#160;                                    $angf = $tmp;</div>
<div class="line"><a name="l23846"></a><span class="lineno">23846</span>&#160;                                }</div>
<div class="line"><a name="l23847"></a><span class="lineno">23847</span>&#160;                                $angs = round(rad2deg($angs), 6);</div>
<div class="line"><a name="l23848"></a><span class="lineno">23848</span>&#160;                                $angf = round(rad2deg($angf), 6);</div>
<div class="line"><a name="l23849"></a><span class="lineno">23849</span>&#160;                                <span class="comment">// covent angles to positive values</span></div>
<div class="line"><a name="l23850"></a><span class="lineno">23850</span>&#160;                                <span class="keywordflow">if</span> (($angs &lt; 0) AND ($angf &lt; 0)) {</div>
<div class="line"><a name="l23851"></a><span class="lineno">23851</span>&#160;                                    $angs += 360;</div>
<div class="line"><a name="l23852"></a><span class="lineno">23852</span>&#160;                                    $angf += 360;</div>
<div class="line"><a name="l23853"></a><span class="lineno">23853</span>&#160;                                }</div>
<div class="line"><a name="l23854"></a><span class="lineno">23854</span>&#160;                                $pie = <span class="keyword">false</span>;</div>
<div class="line"><a name="l23855"></a><span class="lineno">23855</span>&#160;                                <span class="keywordflow">if</span> (($key == 0) AND (isset($paths[($key + 1)][1])) AND (trim($paths[($key + 1)][1]) == <span class="charliteral">&#39;z&#39;</span>)) {</div>
<div class="line"><a name="l23856"></a><span class="lineno">23856</span>&#160;                                    $pie = <span class="keyword">true</span>;</div>
<div class="line"><a name="l23857"></a><span class="lineno">23857</span>&#160;                                }</div>
<div class="line"><a name="l23858"></a><span class="lineno">23858</span>&#160;                                list($axmin, $aymin, $axmax, $aymax) = $this-&gt;_outellipticalarc($cx, $cy, $rx, $ry, $ang, $angs, $angf, $pie, 2, <span class="keyword">false</span>, ($fs == 0), <span class="keyword">true</span>);</div>
<div class="line"><a name="l23859"></a><span class="lineno">23859</span>&#160;                                $xmin = min($xmin, $x, $axmin);</div>
<div class="line"><a name="l23860"></a><span class="lineno">23860</span>&#160;                                $ymin = min($ymin, $y, $aymin);</div>
<div class="line"><a name="l23861"></a><span class="lineno">23861</span>&#160;                                $xmax = max($xmax, $x, $axmax);</div>
<div class="line"><a name="l23862"></a><span class="lineno">23862</span>&#160;                                $ymax = max($ymax, $y, $aymax);</div>
<div class="line"><a name="l23863"></a><span class="lineno">23863</span>&#160;                            }</div>
<div class="line"><a name="l23864"></a><span class="lineno">23864</span>&#160;                            <span class="keywordflow">if</span> ($relcoord) {</div>
<div class="line"><a name="l23865"></a><span class="lineno">23865</span>&#160;                                $xoffset = $x;</div>
<div class="line"><a name="l23866"></a><span class="lineno">23866</span>&#160;                                $yoffset = $y;</div>
<div class="line"><a name="l23867"></a><span class="lineno">23867</span>&#160;                            }</div>
<div class="line"><a name="l23868"></a><span class="lineno">23868</span>&#160;                        }</div>
<div class="line"><a name="l23869"></a><span class="lineno">23869</span>&#160;                    }</div>
<div class="line"><a name="l23870"></a><span class="lineno">23870</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l23871"></a><span class="lineno">23871</span>&#160;                }</div>
<div class="line"><a name="l23872"></a><span class="lineno">23872</span>&#160;                <span class="keywordflow">case</span> <span class="charliteral">&#39;Z&#39;</span>: {</div>
<div class="line"><a name="l23873"></a><span class="lineno">23873</span>&#160;                    $this-&gt;_out(<span class="charliteral">&#39;h&#39;</span>);</div>
<div class="line"><a name="l23874"></a><span class="lineno">23874</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l23875"></a><span class="lineno">23875</span>&#160;                }</div>
<div class="line"><a name="l23876"></a><span class="lineno">23876</span>&#160;            }</div>
<div class="line"><a name="l23877"></a><span class="lineno">23877</span>&#160;            $firstcmd = <span class="keyword">false</span>;</div>
<div class="line"><a name="l23878"></a><span class="lineno">23878</span>&#160;        } <span class="comment">// end foreach</span></div>
<div class="line"><a name="l23879"></a><span class="lineno">23879</span>&#160;        <span class="keywordflow">if</span> (!empty($op)) {</div>
<div class="line"><a name="l23880"></a><span class="lineno">23880</span>&#160;            $this-&gt;_out($op);</div>
<div class="line"><a name="l23881"></a><span class="lineno">23881</span>&#160;        }</div>
<div class="line"><a name="l23882"></a><span class="lineno">23882</span>&#160;        <span class="keywordflow">return</span> array($xmin, $ymin, ($xmax - $xmin), ($ymax - $ymin));</div>
<div class="line"><a name="l23883"></a><span class="lineno">23883</span>&#160;    }</div>
<div class="line"><a name="l23884"></a><span class="lineno">23884</span>&#160;</div>
<div class="line"><a name="l23895"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a4de2d0545b1b22645043fd6656248144">23895</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a4de2d0545b1b22645043fd6656248144">startSVGElementHandler</a>($parser, $name, $attribs, $ctm=array()) {</div>
<div class="line"><a name="l23896"></a><span class="lineno">23896</span>&#160;        <span class="comment">// check if we are in clip mode</span></div>
<div class="line"><a name="l23897"></a><span class="lineno">23897</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;svgclipmode) {</div>
<div class="line"><a name="l23898"></a><span class="lineno">23898</span>&#160;            $this-&gt;svgclippaths[$this-&gt;svgclipid][] = array(<span class="stringliteral">&#39;name&#39;</span> =&gt; $name, <span class="stringliteral">&#39;attribs&#39;</span> =&gt; $attribs, <span class="stringliteral">&#39;tm&#39;</span> =&gt; $this-&gt;svgcliptm[$this-&gt;svgclipid]);</div>
<div class="line"><a name="l23899"></a><span class="lineno">23899</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l23900"></a><span class="lineno">23900</span>&#160;        }</div>
<div class="line"><a name="l23901"></a><span class="lineno">23901</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;svgdefsmode AND !in_array($name, array(<span class="stringliteral">&#39;clipPath&#39;</span>, <span class="stringliteral">&#39;linearGradient&#39;</span>, <span class="stringliteral">&#39;radialGradient&#39;</span>, <span class="stringliteral">&#39;stop&#39;</span>))) {</div>
<div class="line"><a name="l23902"></a><span class="lineno">23902</span>&#160;            <span class="keywordflow">if</span> (isset($attribs[<span class="stringliteral">&#39;id&#39;</span>])) {</div>
<div class="line"><a name="l23903"></a><span class="lineno">23903</span>&#160;                $attribs[<span class="stringliteral">&#39;child_elements&#39;</span>] = array();</div>
<div class="line"><a name="l23904"></a><span class="lineno">23904</span>&#160;                $this-&gt;svgdefs[$attribs[<span class="stringliteral">&#39;id&#39;</span>]] = array(<span class="stringliteral">&#39;name&#39;</span> =&gt; $name, <span class="stringliteral">&#39;attribs&#39;</span> =&gt; $attribs);</div>
<div class="line"><a name="l23905"></a><span class="lineno">23905</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l23906"></a><span class="lineno">23906</span>&#160;            }</div>
<div class="line"><a name="l23907"></a><span class="lineno">23907</span>&#160;            <span class="keywordflow">if</span> (end($this-&gt;svgdefs) !== FALSE) {</div>
<div class="line"><a name="l23908"></a><span class="lineno">23908</span>&#160;                $last_svgdefs_id = key($this-&gt;svgdefs);</div>
<div class="line"><a name="l23909"></a><span class="lineno">23909</span>&#160;                <span class="keywordflow">if</span> (isset($this-&gt;svgdefs[$last_svgdefs_id][<span class="stringliteral">&#39;attribs&#39;</span>][<span class="stringliteral">&#39;child_elements&#39;</span>])) {</div>
<div class="line"><a name="l23910"></a><span class="lineno">23910</span>&#160;                    $attribs[<span class="stringliteral">&#39;id&#39;</span>] = <span class="stringliteral">&#39;DF_&#39;</span>.(count($this-&gt;svgdefs[$last_svgdefs_id][<span class="stringliteral">&#39;attribs&#39;</span>][<span class="stringliteral">&#39;child_elements&#39;</span>]) + 1);</div>
<div class="line"><a name="l23911"></a><span class="lineno">23911</span>&#160;                    $this-&gt;svgdefs[$last_svgdefs_id][<span class="stringliteral">&#39;attribs&#39;</span>][<span class="stringliteral">&#39;child_elements&#39;</span>][$attribs[<span class="stringliteral">&#39;id&#39;</span>]] = array(<span class="stringliteral">&#39;name&#39;</span> =&gt; $name, <span class="stringliteral">&#39;attribs&#39;</span> =&gt; $attribs);</div>
<div class="line"><a name="l23912"></a><span class="lineno">23912</span>&#160;                    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l23913"></a><span class="lineno">23913</span>&#160;                }</div>
<div class="line"><a name="l23914"></a><span class="lineno">23914</span>&#160;            }</div>
<div class="line"><a name="l23915"></a><span class="lineno">23915</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l23916"></a><span class="lineno">23916</span>&#160;        }</div>
<div class="line"><a name="l23917"></a><span class="lineno">23917</span>&#160;        $clipping = <span class="keyword">false</span>;</div>
<div class="line"><a name="l23918"></a><span class="lineno">23918</span>&#160;        <span class="keywordflow">if</span> ($parser == <span class="stringliteral">&#39;clip-path&#39;</span>) {</div>
<div class="line"><a name="l23919"></a><span class="lineno">23919</span>&#160;            <span class="comment">// set clipping mode</span></div>
<div class="line"><a name="l23920"></a><span class="lineno">23920</span>&#160;            $clipping = <span class="keyword">true</span>;</div>
<div class="line"><a name="l23921"></a><span class="lineno">23921</span>&#160;        }</div>
<div class="line"><a name="l23922"></a><span class="lineno">23922</span>&#160;        <span class="comment">// get styling properties</span></div>
<div class="line"><a name="l23923"></a><span class="lineno">23923</span>&#160;        $prev_svgstyle = $this-&gt;svgstyles[max(0,(count($this-&gt;svgstyles) - 1))]; <span class="comment">// previous style</span></div>
<div class="line"><a name="l23924"></a><span class="lineno">23924</span>&#160;        $svgstyle = $this-&gt;svgstyles[0]; <span class="comment">// set default style</span></div>
<div class="line"><a name="l23925"></a><span class="lineno">23925</span>&#160;        <span class="keywordflow">if</span> ($clipping AND !isset($attribs[<span class="stringliteral">&#39;fill&#39;</span>]) AND (!isset($attribs[<span class="stringliteral">&#39;style&#39;</span>]) OR (!preg_match(<span class="stringliteral">&#39;/[;\&quot;\s]{1}fill[\s]*:[\s]*([^;\&quot;]*)/si&#39;</span>, $attribs[<span class="stringliteral">&#39;style&#39;</span>], $attrval)))) {</div>
<div class="line"><a name="l23926"></a><span class="lineno">23926</span>&#160;            <span class="comment">// default fill attribute for clipping</span></div>
<div class="line"><a name="l23927"></a><span class="lineno">23927</span>&#160;            $attribs[<span class="stringliteral">&#39;fill&#39;</span>] = <span class="stringliteral">&#39;none&#39;</span>;</div>
<div class="line"><a name="l23928"></a><span class="lineno">23928</span>&#160;        }</div>
<div class="line"><a name="l23929"></a><span class="lineno">23929</span>&#160;        <span class="keywordflow">if</span> (isset($attribs[<span class="stringliteral">&#39;style&#39;</span>]) AND !TCPDF_STATIC::empty_string($attribs[<span class="stringliteral">&#39;style&#39;</span>]) AND ($attribs[<span class="stringliteral">&#39;style&#39;</span>][0] != <span class="charliteral">&#39;;&#39;</span>)) {</div>
<div class="line"><a name="l23930"></a><span class="lineno">23930</span>&#160;            <span class="comment">// fix style for regular expression</span></div>
<div class="line"><a name="l23931"></a><span class="lineno">23931</span>&#160;            $attribs[<span class="stringliteral">&#39;style&#39;</span>] = <span class="charliteral">&#39;;&#39;</span>.$attribs[<span class="stringliteral">&#39;style&#39;</span>];</div>
<div class="line"><a name="l23932"></a><span class="lineno">23932</span>&#160;        }</div>
<div class="line"><a name="l23933"></a><span class="lineno">23933</span>&#160;        <span class="keywordflow">foreach</span> ($prev_svgstyle as $key =&gt; $val) {</div>
<div class="line"><a name="l23934"></a><span class="lineno">23934</span>&#160;            <span class="keywordflow">if</span> (in_array($key, TCPDF_IMAGES::$svginheritprop)) {</div>
<div class="line"><a name="l23935"></a><span class="lineno">23935</span>&#160;                <span class="comment">// inherit previous value</span></div>
<div class="line"><a name="l23936"></a><span class="lineno">23936</span>&#160;                $svgstyle[$key] = $val;</div>
<div class="line"><a name="l23937"></a><span class="lineno">23937</span>&#160;            }</div>
<div class="line"><a name="l23938"></a><span class="lineno">23938</span>&#160;            <span class="keywordflow">if</span> (isset($attribs[$key]) AND !TCPDF_STATIC::empty_string($attribs[$key])) {</div>
<div class="line"><a name="l23939"></a><span class="lineno">23939</span>&#160;                <span class="comment">// specific attribute settings</span></div>
<div class="line"><a name="l23940"></a><span class="lineno">23940</span>&#160;                <span class="keywordflow">if</span> ($attribs[$key] == <span class="stringliteral">&#39;inherit&#39;</span>) {</div>
<div class="line"><a name="l23941"></a><span class="lineno">23941</span>&#160;                    $svgstyle[$key] = $val;</div>
<div class="line"><a name="l23942"></a><span class="lineno">23942</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l23943"></a><span class="lineno">23943</span>&#160;                    $svgstyle[$key] = $attribs[$key];</div>
<div class="line"><a name="l23944"></a><span class="lineno">23944</span>&#160;                }</div>
<div class="line"><a name="l23945"></a><span class="lineno">23945</span>&#160;            } elseif (isset($attribs[<span class="stringliteral">&#39;style&#39;</span>]) AND !TCPDF_STATIC::empty_string($attribs[<span class="stringliteral">&#39;style&#39;</span>])) {</div>
<div class="line"><a name="l23946"></a><span class="lineno">23946</span>&#160;                <span class="comment">// CSS style syntax</span></div>
<div class="line"><a name="l23947"></a><span class="lineno">23947</span>&#160;                $attrval = array();</div>
<div class="line"><a name="l23948"></a><span class="lineno">23948</span>&#160;                <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/[;\&quot;\s]{1}&#39;</span>.$key.<span class="stringliteral">&#39;[\s]*:[\s]*([^;\&quot;]*)/si&#39;</span>, $attribs[<span class="stringliteral">&#39;style&#39;</span>], $attrval) AND isset($attrval[1])) {</div>
<div class="line"><a name="l23949"></a><span class="lineno">23949</span>&#160;                    <span class="keywordflow">if</span> ($attrval[1] == <span class="stringliteral">&#39;inherit&#39;</span>) {</div>
<div class="line"><a name="l23950"></a><span class="lineno">23950</span>&#160;                        $svgstyle[$key] = $val;</div>
<div class="line"><a name="l23951"></a><span class="lineno">23951</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l23952"></a><span class="lineno">23952</span>&#160;                        $svgstyle[$key] = $attrval[1];</div>
<div class="line"><a name="l23953"></a><span class="lineno">23953</span>&#160;                    }</div>
<div class="line"><a name="l23954"></a><span class="lineno">23954</span>&#160;                }</div>
<div class="line"><a name="l23955"></a><span class="lineno">23955</span>&#160;            }</div>
<div class="line"><a name="l23956"></a><span class="lineno">23956</span>&#160;        }</div>
<div class="line"><a name="l23957"></a><span class="lineno">23957</span>&#160;        <span class="comment">// transformation matrix</span></div>
<div class="line"><a name="l23958"></a><span class="lineno">23958</span>&#160;        <span class="keywordflow">if</span> (!empty($ctm)) {</div>
<div class="line"><a name="l23959"></a><span class="lineno">23959</span>&#160;            $tm = $ctm;</div>
<div class="line"><a name="l23960"></a><span class="lineno">23960</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l23961"></a><span class="lineno">23961</span>&#160;            $tm = array(1,0,0,1,0,0);</div>
<div class="line"><a name="l23962"></a><span class="lineno">23962</span>&#160;        }</div>
<div class="line"><a name="l23963"></a><span class="lineno">23963</span>&#160;        <span class="keywordflow">if</span> (isset($attribs[<span class="stringliteral">&#39;transform&#39;</span>]) AND !empty($attribs[<span class="stringliteral">&#39;transform&#39;</span>])) {</div>
<div class="line"><a name="l23964"></a><span class="lineno">23964</span>&#160;            $tm = TCPDF_STATIC::getTransformationMatrixProduct($tm, TCPDF_STATIC::getSVGTransformMatrix($attribs[<span class="stringliteral">&#39;transform&#39;</span>]));</div>
<div class="line"><a name="l23965"></a><span class="lineno">23965</span>&#160;        }</div>
<div class="line"><a name="l23966"></a><span class="lineno">23966</span>&#160;        $svgstyle[<span class="stringliteral">&#39;transfmatrix&#39;</span>] = $tm;</div>
<div class="line"><a name="l23967"></a><span class="lineno">23967</span>&#160;        $invisible = <span class="keyword">false</span>;</div>
<div class="line"><a name="l23968"></a><span class="lineno">23968</span>&#160;        <span class="keywordflow">if</span> (($svgstyle[<span class="stringliteral">&#39;visibility&#39;</span>] == <span class="stringliteral">&#39;hidden&#39;</span>) OR ($svgstyle[<span class="stringliteral">&#39;visibility&#39;</span>] == <span class="stringliteral">&#39;collapse&#39;</span>) OR ($svgstyle[<span class="stringliteral">&#39;display&#39;</span>] == <span class="stringliteral">&#39;none&#39;</span>)) {</div>
<div class="line"><a name="l23969"></a><span class="lineno">23969</span>&#160;            <span class="comment">// the current graphics element is invisible (nothing is painted)</span></div>
<div class="line"><a name="l23970"></a><span class="lineno">23970</span>&#160;            $invisible = <span class="keyword">true</span>;</div>
<div class="line"><a name="l23971"></a><span class="lineno">23971</span>&#160;        }</div>
<div class="line"><a name="l23972"></a><span class="lineno">23972</span>&#160;        <span class="comment">// process tag</span></div>
<div class="line"><a name="l23973"></a><span class="lineno">23973</span>&#160;        <span class="keywordflow">switch</span>($name) {</div>
<div class="line"><a name="l23974"></a><span class="lineno">23974</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;defs&#39;</span>: {</div>
<div class="line"><a name="l23975"></a><span class="lineno">23975</span>&#160;                $this-&gt;svgdefsmode = <span class="keyword">true</span>;</div>
<div class="line"><a name="l23976"></a><span class="lineno">23976</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l23977"></a><span class="lineno">23977</span>&#160;            }</div>
<div class="line"><a name="l23978"></a><span class="lineno">23978</span>&#160;            <span class="comment">// clipPath</span></div>
<div class="line"><a name="l23979"></a><span class="lineno">23979</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;clipPath&#39;</span>: {</div>
<div class="line"><a name="l23980"></a><span class="lineno">23980</span>&#160;                <span class="keywordflow">if</span> ($invisible) {</div>
<div class="line"><a name="l23981"></a><span class="lineno">23981</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l23982"></a><span class="lineno">23982</span>&#160;                }</div>
<div class="line"><a name="l23983"></a><span class="lineno">23983</span>&#160;                $this-&gt;svgclipmode = <span class="keyword">true</span>;</div>
<div class="line"><a name="l23984"></a><span class="lineno">23984</span>&#160;                <span class="keywordflow">if</span> (!isset($attribs[<span class="stringliteral">&#39;id&#39;</span>])) {</div>
<div class="line"><a name="l23985"></a><span class="lineno">23985</span>&#160;                    $attribs[<span class="stringliteral">&#39;id&#39;</span>] = <span class="stringliteral">&#39;CP_&#39;</span>.(count($this-&gt;svgcliptm) + 1);</div>
<div class="line"><a name="l23986"></a><span class="lineno">23986</span>&#160;                }</div>
<div class="line"><a name="l23987"></a><span class="lineno">23987</span>&#160;                $this-&gt;svgclipid = $attribs[<span class="stringliteral">&#39;id&#39;</span>];</div>
<div class="line"><a name="l23988"></a><span class="lineno">23988</span>&#160;                $this-&gt;svgclippaths[$this-&gt;svgclipid] = array();</div>
<div class="line"><a name="l23989"></a><span class="lineno">23989</span>&#160;                $this-&gt;svgcliptm[$this-&gt;svgclipid] = $tm;</div>
<div class="line"><a name="l23990"></a><span class="lineno">23990</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l23991"></a><span class="lineno">23991</span>&#160;            }</div>
<div class="line"><a name="l23992"></a><span class="lineno">23992</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;svg&#39;</span>: {</div>
<div class="line"><a name="l23993"></a><span class="lineno">23993</span>&#160;                <span class="comment">// start of SVG object</span></div>
<div class="line"><a name="l23994"></a><span class="lineno">23994</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l23995"></a><span class="lineno">23995</span>&#160;            }</div>
<div class="line"><a name="l23996"></a><span class="lineno">23996</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;g&#39;</span>: {</div>
<div class="line"><a name="l23997"></a><span class="lineno">23997</span>&#160;                <span class="comment">// group together related graphics elements</span></div>
<div class="line"><a name="l23998"></a><span class="lineno">23998</span>&#160;                array_push($this-&gt;svgstyles, $svgstyle);</div>
<div class="line"><a name="l23999"></a><span class="lineno">23999</span>&#160;                $this-&gt;StartTransform();</div>
<div class="line"><a name="l24000"></a><span class="lineno">24000</span>&#160;                $x = (isset($attribs[<span class="charliteral">&#39;x&#39;</span>])?$attribs[<span class="charliteral">&#39;x&#39;</span>]:0);</div>
<div class="line"><a name="l24001"></a><span class="lineno">24001</span>&#160;                $y = (isset($attribs[<span class="charliteral">&#39;y&#39;</span>])?$attribs[<span class="charliteral">&#39;y&#39;</span>]:0);</div>
<div class="line"><a name="l24002"></a><span class="lineno">24002</span>&#160;                $w = 1;<span class="comment">//(isset($attribs[&#39;width&#39;])?$attribs[&#39;width&#39;]:1);</span></div>
<div class="line"><a name="l24003"></a><span class="lineno">24003</span>&#160;                $h = 1;<span class="comment">//(isset($attribs[&#39;height&#39;])?$attribs[&#39;height&#39;]:1);</span></div>
<div class="line"><a name="l24004"></a><span class="lineno">24004</span>&#160;                $tm = TCPDF_STATIC::getTransformationMatrixProduct($tm, array($w, 0, 0, $h, $x, $y));</div>
<div class="line"><a name="l24005"></a><span class="lineno">24005</span>&#160;                $this-&gt;SVGTransform($tm);</div>
<div class="line"><a name="l24006"></a><span class="lineno">24006</span>&#160;                $this-&gt;setSVGStyles($svgstyle, $prev_svgstyle);</div>
<div class="line"><a name="l24007"></a><span class="lineno">24007</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l24008"></a><span class="lineno">24008</span>&#160;            }</div>
<div class="line"><a name="l24009"></a><span class="lineno">24009</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;linearGradient&#39;</span>: {</div>
<div class="line"><a name="l24010"></a><span class="lineno">24010</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;pdfa_mode) {</div>
<div class="line"><a name="l24011"></a><span class="lineno">24011</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l24012"></a><span class="lineno">24012</span>&#160;                }</div>
<div class="line"><a name="l24013"></a><span class="lineno">24013</span>&#160;                <span class="keywordflow">if</span> (!isset($attribs[<span class="stringliteral">&#39;id&#39;</span>])) {</div>
<div class="line"><a name="l24014"></a><span class="lineno">24014</span>&#160;                    $attribs[<span class="stringliteral">&#39;id&#39;</span>] = <span class="stringliteral">&#39;GR_&#39;</span>.(count($this-&gt;svggradients) + 1);</div>
<div class="line"><a name="l24015"></a><span class="lineno">24015</span>&#160;                }</div>
<div class="line"><a name="l24016"></a><span class="lineno">24016</span>&#160;                $this-&gt;svggradientid = $attribs[<span class="stringliteral">&#39;id&#39;</span>];</div>
<div class="line"><a name="l24017"></a><span class="lineno">24017</span>&#160;                $this-&gt;svggradients[$this-&gt;svggradientid] = array();</div>
<div class="line"><a name="l24018"></a><span class="lineno">24018</span>&#160;                $this-&gt;svggradients[$this-&gt;svggradientid][<span class="stringliteral">&#39;type&#39;</span>] = 2;</div>
<div class="line"><a name="l24019"></a><span class="lineno">24019</span>&#160;                $this-&gt;svggradients[$this-&gt;svggradientid][<span class="stringliteral">&#39;stops&#39;</span>] = array();</div>
<div class="line"><a name="l24020"></a><span class="lineno">24020</span>&#160;                <span class="keywordflow">if</span> (isset($attribs[<span class="stringliteral">&#39;gradientUnits&#39;</span>])) {</div>
<div class="line"><a name="l24021"></a><span class="lineno">24021</span>&#160;                    $this-&gt;svggradients[$this-&gt;svggradientid][<span class="stringliteral">&#39;gradientUnits&#39;</span>] = $attribs[<span class="stringliteral">&#39;gradientUnits&#39;</span>];</div>
<div class="line"><a name="l24022"></a><span class="lineno">24022</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l24023"></a><span class="lineno">24023</span>&#160;                    $this-&gt;svggradients[$this-&gt;svggradientid][<span class="stringliteral">&#39;gradientUnits&#39;</span>] = <span class="stringliteral">&#39;objectBoundingBox&#39;</span>;</div>
<div class="line"><a name="l24024"></a><span class="lineno">24024</span>&#160;                }</div>
<div class="line"><a name="l24025"></a><span class="lineno">24025</span>&#160;                <span class="comment">//$attribs[&#39;spreadMethod&#39;]</span></div>
<div class="line"><a name="l24026"></a><span class="lineno">24026</span>&#160;                <span class="keywordflow">if</span> (((!isset($attribs[<span class="stringliteral">&#39;x1&#39;</span>])) AND (!isset($attribs[<span class="stringliteral">&#39;y1&#39;</span>])) AND (!isset($attribs[<span class="stringliteral">&#39;x2&#39;</span>])) AND (!isset($attribs[<span class="stringliteral">&#39;y2&#39;</span>])))</div>
<div class="line"><a name="l24027"></a><span class="lineno">24027</span>&#160;                    OR ((isset($attribs[<span class="stringliteral">&#39;x1&#39;</span>]) AND (substr($attribs[<span class="stringliteral">&#39;x1&#39;</span>], -1) == <span class="charliteral">&#39;%&#39;</span>))</div>
<div class="line"><a name="l24028"></a><span class="lineno">24028</span>&#160;                        OR (isset($attribs[<span class="stringliteral">&#39;y1&#39;</span>]) AND (substr($attribs[<span class="stringliteral">&#39;y1&#39;</span>], -1) == <span class="charliteral">&#39;%&#39;</span>))</div>
<div class="line"><a name="l24029"></a><span class="lineno">24029</span>&#160;                        OR (isset($attribs[<span class="stringliteral">&#39;x2&#39;</span>]) AND (substr($attribs[<span class="stringliteral">&#39;x2&#39;</span>], -1) == <span class="charliteral">&#39;%&#39;</span>))</div>
<div class="line"><a name="l24030"></a><span class="lineno">24030</span>&#160;                        OR (isset($attribs[<span class="stringliteral">&#39;y2&#39;</span>]) AND (substr($attribs[<span class="stringliteral">&#39;y2&#39;</span>], -1) == <span class="charliteral">&#39;%&#39;</span>)))) {</div>
<div class="line"><a name="l24031"></a><span class="lineno">24031</span>&#160;                    $this-&gt;svggradients[$this-&gt;svggradientid][<span class="stringliteral">&#39;mode&#39;</span>] = <span class="stringliteral">&#39;percentage&#39;</span>;</div>
<div class="line"><a name="l24032"></a><span class="lineno">24032</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l24033"></a><span class="lineno">24033</span>&#160;                    $this-&gt;svggradients[$this-&gt;svggradientid][<span class="stringliteral">&#39;mode&#39;</span>] = <span class="stringliteral">&#39;measure&#39;</span>;</div>
<div class="line"><a name="l24034"></a><span class="lineno">24034</span>&#160;                }</div>
<div class="line"><a name="l24035"></a><span class="lineno">24035</span>&#160;                $x1 = (isset($attribs[<span class="stringliteral">&#39;x1&#39;</span>])?$attribs[<span class="stringliteral">&#39;x1&#39;</span>]:<span class="charliteral">&#39;0&#39;</span>);</div>
<div class="line"><a name="l24036"></a><span class="lineno">24036</span>&#160;                $y1 = (isset($attribs[<span class="stringliteral">&#39;y1&#39;</span>])?$attribs[<span class="stringliteral">&#39;y1&#39;</span>]:<span class="charliteral">&#39;0&#39;</span>);</div>
<div class="line"><a name="l24037"></a><span class="lineno">24037</span>&#160;                $x2 = (isset($attribs[<span class="stringliteral">&#39;x2&#39;</span>])?$attribs[<span class="stringliteral">&#39;x2&#39;</span>]:<span class="stringliteral">&#39;100&#39;</span>);</div>
<div class="line"><a name="l24038"></a><span class="lineno">24038</span>&#160;                $y2 = (isset($attribs[<span class="stringliteral">&#39;y2&#39;</span>])?$attribs[<span class="stringliteral">&#39;y2&#39;</span>]:<span class="charliteral">&#39;0&#39;</span>);</div>
<div class="line"><a name="l24039"></a><span class="lineno">24039</span>&#160;                <span class="keywordflow">if</span> (isset($attribs[<span class="stringliteral">&#39;gradientTransform&#39;</span>])) {</div>
<div class="line"><a name="l24040"></a><span class="lineno">24040</span>&#160;                    $this-&gt;svggradients[$this-&gt;svggradientid][<span class="stringliteral">&#39;gradientTransform&#39;</span>] = TCPDF_STATIC::getSVGTransformMatrix($attribs[<span class="stringliteral">&#39;gradientTransform&#39;</span>]);</div>
<div class="line"><a name="l24041"></a><span class="lineno">24041</span>&#160;                }</div>
<div class="line"><a name="l24042"></a><span class="lineno">24042</span>&#160;                $this-&gt;svggradients[$this-&gt;svggradientid][<span class="stringliteral">&#39;coords&#39;</span>] = array($x1, $y1, $x2, $y2);</div>
<div class="line"><a name="l24043"></a><span class="lineno">24043</span>&#160;                <span class="keywordflow">if</span> (isset($attribs[<span class="stringliteral">&#39;xlink:href&#39;</span>]) AND !empty($attribs[<span class="stringliteral">&#39;xlink:href&#39;</span>])) {</div>
<div class="line"><a name="l24044"></a><span class="lineno">24044</span>&#160;                    <span class="comment">// gradient is defined on another place</span></div>
<div class="line"><a name="l24045"></a><span class="lineno">24045</span>&#160;                    $this-&gt;svggradients[$this-&gt;svggradientid][<span class="stringliteral">&#39;xref&#39;</span>] = substr($attribs[<span class="stringliteral">&#39;xlink:href&#39;</span>], 1);</div>
<div class="line"><a name="l24046"></a><span class="lineno">24046</span>&#160;                }</div>
<div class="line"><a name="l24047"></a><span class="lineno">24047</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l24048"></a><span class="lineno">24048</span>&#160;            }</div>
<div class="line"><a name="l24049"></a><span class="lineno">24049</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;radialGradient&#39;</span>: {</div>
<div class="line"><a name="l24050"></a><span class="lineno">24050</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;pdfa_mode) {</div>
<div class="line"><a name="l24051"></a><span class="lineno">24051</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l24052"></a><span class="lineno">24052</span>&#160;                }</div>
<div class="line"><a name="l24053"></a><span class="lineno">24053</span>&#160;                <span class="keywordflow">if</span> (!isset($attribs[<span class="stringliteral">&#39;id&#39;</span>])) {</div>
<div class="line"><a name="l24054"></a><span class="lineno">24054</span>&#160;                    $attribs[<span class="stringliteral">&#39;id&#39;</span>] = <span class="stringliteral">&#39;GR_&#39;</span>.(count($this-&gt;svggradients) + 1);</div>
<div class="line"><a name="l24055"></a><span class="lineno">24055</span>&#160;                }</div>
<div class="line"><a name="l24056"></a><span class="lineno">24056</span>&#160;                $this-&gt;svggradientid = $attribs[<span class="stringliteral">&#39;id&#39;</span>];</div>
<div class="line"><a name="l24057"></a><span class="lineno">24057</span>&#160;                $this-&gt;svggradients[$this-&gt;svggradientid] = array();</div>
<div class="line"><a name="l24058"></a><span class="lineno">24058</span>&#160;                $this-&gt;svggradients[$this-&gt;svggradientid][<span class="stringliteral">&#39;type&#39;</span>] = 3;</div>
<div class="line"><a name="l24059"></a><span class="lineno">24059</span>&#160;                $this-&gt;svggradients[$this-&gt;svggradientid][<span class="stringliteral">&#39;stops&#39;</span>] = array();</div>
<div class="line"><a name="l24060"></a><span class="lineno">24060</span>&#160;                <span class="keywordflow">if</span> (isset($attribs[<span class="stringliteral">&#39;gradientUnits&#39;</span>])) {</div>
<div class="line"><a name="l24061"></a><span class="lineno">24061</span>&#160;                    $this-&gt;svggradients[$this-&gt;svggradientid][<span class="stringliteral">&#39;gradientUnits&#39;</span>] = $attribs[<span class="stringliteral">&#39;gradientUnits&#39;</span>];</div>
<div class="line"><a name="l24062"></a><span class="lineno">24062</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l24063"></a><span class="lineno">24063</span>&#160;                    $this-&gt;svggradients[$this-&gt;svggradientid][<span class="stringliteral">&#39;gradientUnits&#39;</span>] = <span class="stringliteral">&#39;objectBoundingBox&#39;</span>;</div>
<div class="line"><a name="l24064"></a><span class="lineno">24064</span>&#160;                }</div>
<div class="line"><a name="l24065"></a><span class="lineno">24065</span>&#160;                <span class="comment">//$attribs[&#39;spreadMethod&#39;]</span></div>
<div class="line"><a name="l24066"></a><span class="lineno">24066</span>&#160;                <span class="keywordflow">if</span> (((!isset($attribs[<span class="stringliteral">&#39;cx&#39;</span>])) AND (!isset($attribs[<span class="stringliteral">&#39;cy&#39;</span>])))</div>
<div class="line"><a name="l24067"></a><span class="lineno">24067</span>&#160;                    OR ((isset($attribs[<span class="stringliteral">&#39;cx&#39;</span>]) AND (substr($attribs[<span class="stringliteral">&#39;cx&#39;</span>], -1) == <span class="charliteral">&#39;%&#39;</span>))</div>
<div class="line"><a name="l24068"></a><span class="lineno">24068</span>&#160;                    OR (isset($attribs[<span class="stringliteral">&#39;cy&#39;</span>]) AND (substr($attribs[<span class="stringliteral">&#39;cy&#39;</span>], -1) == <span class="charliteral">&#39;%&#39;</span>)))) {</div>
<div class="line"><a name="l24069"></a><span class="lineno">24069</span>&#160;                    $this-&gt;svggradients[$this-&gt;svggradientid][<span class="stringliteral">&#39;mode&#39;</span>] = <span class="stringliteral">&#39;percentage&#39;</span>;</div>
<div class="line"><a name="l24070"></a><span class="lineno">24070</span>&#160;                } elseif (isset($attribs[<span class="charliteral">&#39;r&#39;</span>]) AND is_numeric($attribs[<span class="charliteral">&#39;r&#39;</span>]) AND ($attribs[<span class="charliteral">&#39;r&#39;</span>]) &lt;= 1) {</div>
<div class="line"><a name="l24071"></a><span class="lineno">24071</span>&#160;                    $this-&gt;svggradients[$this-&gt;svggradientid][<span class="stringliteral">&#39;mode&#39;</span>] = <span class="stringliteral">&#39;ratio&#39;</span>;</div>
<div class="line"><a name="l24072"></a><span class="lineno">24072</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l24073"></a><span class="lineno">24073</span>&#160;                    $this-&gt;svggradients[$this-&gt;svggradientid][<span class="stringliteral">&#39;mode&#39;</span>] = <span class="stringliteral">&#39;measure&#39;</span>;</div>
<div class="line"><a name="l24074"></a><span class="lineno">24074</span>&#160;                }</div>
<div class="line"><a name="l24075"></a><span class="lineno">24075</span>&#160;                $cx = (isset($attribs[<span class="stringliteral">&#39;cx&#39;</span>]) ? $attribs[<span class="stringliteral">&#39;cx&#39;</span>] : 0.5);</div>
<div class="line"><a name="l24076"></a><span class="lineno">24076</span>&#160;                $cy = (isset($attribs[<span class="stringliteral">&#39;cy&#39;</span>]) ? $attribs[<span class="stringliteral">&#39;cy&#39;</span>] : 0.5);</div>
<div class="line"><a name="l24077"></a><span class="lineno">24077</span>&#160;                $fx = (isset($attribs[<span class="stringliteral">&#39;fx&#39;</span>]) ? $attribs[<span class="stringliteral">&#39;fx&#39;</span>] : $cx);</div>
<div class="line"><a name="l24078"></a><span class="lineno">24078</span>&#160;                $fy = (isset($attribs[<span class="stringliteral">&#39;fy&#39;</span>]) ? $attribs[<span class="stringliteral">&#39;fy&#39;</span>] : $cy);</div>
<div class="line"><a name="l24079"></a><span class="lineno">24079</span>&#160;                $r = (isset($attribs[<span class="charliteral">&#39;r&#39;</span>]) ? $attribs[<span class="charliteral">&#39;r&#39;</span>] : 0.5);</div>
<div class="line"><a name="l24080"></a><span class="lineno">24080</span>&#160;                <span class="keywordflow">if</span> (isset($attribs[<span class="stringliteral">&#39;gradientTransform&#39;</span>])) {</div>
<div class="line"><a name="l24081"></a><span class="lineno">24081</span>&#160;                    $this-&gt;svggradients[$this-&gt;svggradientid][<span class="stringliteral">&#39;gradientTransform&#39;</span>] = TCPDF_STATIC::getSVGTransformMatrix($attribs[<span class="stringliteral">&#39;gradientTransform&#39;</span>]);</div>
<div class="line"><a name="l24082"></a><span class="lineno">24082</span>&#160;                }</div>
<div class="line"><a name="l24083"></a><span class="lineno">24083</span>&#160;                $this-&gt;svggradients[$this-&gt;svggradientid][<span class="stringliteral">&#39;coords&#39;</span>] = array($cx, $cy, $fx, $fy, $r);</div>
<div class="line"><a name="l24084"></a><span class="lineno">24084</span>&#160;                <span class="keywordflow">if</span> (isset($attribs[<span class="stringliteral">&#39;xlink:href&#39;</span>]) AND !empty($attribs[<span class="stringliteral">&#39;xlink:href&#39;</span>])) {</div>
<div class="line"><a name="l24085"></a><span class="lineno">24085</span>&#160;                    <span class="comment">// gradient is defined on another place</span></div>
<div class="line"><a name="l24086"></a><span class="lineno">24086</span>&#160;                    $this-&gt;svggradients[$this-&gt;svggradientid][<span class="stringliteral">&#39;xref&#39;</span>] = substr($attribs[<span class="stringliteral">&#39;xlink:href&#39;</span>], 1);</div>
<div class="line"><a name="l24087"></a><span class="lineno">24087</span>&#160;                }</div>
<div class="line"><a name="l24088"></a><span class="lineno">24088</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l24089"></a><span class="lineno">24089</span>&#160;            }</div>
<div class="line"><a name="l24090"></a><span class="lineno">24090</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;stop&#39;</span>: {</div>
<div class="line"><a name="l24091"></a><span class="lineno">24091</span>&#160;                <span class="comment">// gradient stops</span></div>
<div class="line"><a name="l24092"></a><span class="lineno">24092</span>&#160;                <span class="keywordflow">if</span> (substr($attribs[<span class="stringliteral">&#39;offset&#39;</span>], -1) == <span class="charliteral">&#39;%&#39;</span>) {</div>
<div class="line"><a name="l24093"></a><span class="lineno">24093</span>&#160;                    $offset = floatval(substr($attribs[<span class="stringliteral">&#39;offset&#39;</span>], -1)) / 100;</div>
<div class="line"><a name="l24094"></a><span class="lineno">24094</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l24095"></a><span class="lineno">24095</span>&#160;                    $offset = floatval($attribs[<span class="stringliteral">&#39;offset&#39;</span>]);</div>
<div class="line"><a name="l24096"></a><span class="lineno">24096</span>&#160;                    <span class="keywordflow">if</span> ($offset &gt; 1) {</div>
<div class="line"><a name="l24097"></a><span class="lineno">24097</span>&#160;                        $offset /= 100;</div>
<div class="line"><a name="l24098"></a><span class="lineno">24098</span>&#160;                    }</div>
<div class="line"><a name="l24099"></a><span class="lineno">24099</span>&#160;                }</div>
<div class="line"><a name="l24100"></a><span class="lineno">24100</span>&#160;                $stop_color = isset($svgstyle[<span class="stringliteral">&#39;stop-color&#39;</span>])?TCPDF_COLORS::convertHTMLColorToDec($svgstyle[<span class="stringliteral">&#39;stop-color&#39;</span>], $this-&gt;spot_colors):<span class="stringliteral">&#39;black&#39;</span>;</div>
<div class="line"><a name="l24101"></a><span class="lineno">24101</span>&#160;                $opacity = isset($svgstyle[<span class="stringliteral">&#39;stop-opacity&#39;</span>])?$svgstyle[<span class="stringliteral">&#39;stop-opacity&#39;</span>]:1;</div>
<div class="line"><a name="l24102"></a><span class="lineno">24102</span>&#160;                $this-&gt;svggradients[$this-&gt;svggradientid][<span class="stringliteral">&#39;stops&#39;</span>][] = array(<span class="stringliteral">&#39;offset&#39;</span> =&gt; $offset, <span class="stringliteral">&#39;color&#39;</span> =&gt; $stop_color, <span class="stringliteral">&#39;opacity&#39;</span> =&gt; $opacity);</div>
<div class="line"><a name="l24103"></a><span class="lineno">24103</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l24104"></a><span class="lineno">24104</span>&#160;            }</div>
<div class="line"><a name="l24105"></a><span class="lineno">24105</span>&#160;            <span class="comment">// paths</span></div>
<div class="line"><a name="l24106"></a><span class="lineno">24106</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;path&#39;</span>: {</div>
<div class="line"><a name="l24107"></a><span class="lineno">24107</span>&#160;                <span class="keywordflow">if</span> ($invisible) {</div>
<div class="line"><a name="l24108"></a><span class="lineno">24108</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l24109"></a><span class="lineno">24109</span>&#160;                }</div>
<div class="line"><a name="l24110"></a><span class="lineno">24110</span>&#160;                <span class="keywordflow">if</span> (isset($attribs[<span class="charliteral">&#39;d&#39;</span>])) {</div>
<div class="line"><a name="l24111"></a><span class="lineno">24111</span>&#160;                    $d = trim($attribs[<span class="charliteral">&#39;d&#39;</span>]);</div>
<div class="line"><a name="l24112"></a><span class="lineno">24112</span>&#160;                    <span class="keywordflow">if</span> (!empty($d)) {</div>
<div class="line"><a name="l24113"></a><span class="lineno">24113</span>&#160;                        $x = (isset($attribs[<span class="charliteral">&#39;x&#39;</span>])?$attribs[<span class="charliteral">&#39;x&#39;</span>]:0);</div>
<div class="line"><a name="l24114"></a><span class="lineno">24114</span>&#160;                        $y = (isset($attribs[<span class="charliteral">&#39;y&#39;</span>])?$attribs[<span class="charliteral">&#39;y&#39;</span>]:0);</div>
<div class="line"><a name="l24115"></a><span class="lineno">24115</span>&#160;                        $w = (isset($attribs[<span class="stringliteral">&#39;width&#39;</span>])?$attribs[<span class="stringliteral">&#39;width&#39;</span>]:1);</div>
<div class="line"><a name="l24116"></a><span class="lineno">24116</span>&#160;                        $h = (isset($attribs[<span class="stringliteral">&#39;height&#39;</span>])?$attribs[<span class="stringliteral">&#39;height&#39;</span>]:1);</div>
<div class="line"><a name="l24117"></a><span class="lineno">24117</span>&#160;                        $tm = TCPDF_STATIC::getTransformationMatrixProduct($tm, array($w, 0, 0, $h, $x, $y));</div>
<div class="line"><a name="l24118"></a><span class="lineno">24118</span>&#160;                        <span class="keywordflow">if</span> ($clipping) {</div>
<div class="line"><a name="l24119"></a><span class="lineno">24119</span>&#160;                            $this-&gt;SVGTransform($tm);</div>
<div class="line"><a name="l24120"></a><span class="lineno">24120</span>&#160;                            $this-&gt;SVGPath($d, <span class="stringliteral">&#39;CNZ&#39;</span>);</div>
<div class="line"><a name="l24121"></a><span class="lineno">24121</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l24122"></a><span class="lineno">24122</span>&#160;                            $this-&gt;StartTransform();</div>
<div class="line"><a name="l24123"></a><span class="lineno">24123</span>&#160;                            $this-&gt;SVGTransform($tm);</div>
<div class="line"><a name="l24124"></a><span class="lineno">24124</span>&#160;                            $obstyle = $this-&gt;setSVGStyles($svgstyle, $prev_svgstyle, $x, $y, $w, $h, <span class="stringliteral">&#39;SVGPath&#39;</span>, array($d, <span class="stringliteral">&#39;CNZ&#39;</span>));</div>
<div class="line"><a name="l24125"></a><span class="lineno">24125</span>&#160;                            <span class="keywordflow">if</span> (!empty($obstyle)) {</div>
<div class="line"><a name="l24126"></a><span class="lineno">24126</span>&#160;                                $this-&gt;SVGPath($d, $obstyle);</div>
<div class="line"><a name="l24127"></a><span class="lineno">24127</span>&#160;                            }</div>
<div class="line"><a name="l24128"></a><span class="lineno">24128</span>&#160;                            $this-&gt;StopTransform();</div>
<div class="line"><a name="l24129"></a><span class="lineno">24129</span>&#160;                        }</div>
<div class="line"><a name="l24130"></a><span class="lineno">24130</span>&#160;                    }</div>
<div class="line"><a name="l24131"></a><span class="lineno">24131</span>&#160;                }</div>
<div class="line"><a name="l24132"></a><span class="lineno">24132</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l24133"></a><span class="lineno">24133</span>&#160;            }</div>
<div class="line"><a name="l24134"></a><span class="lineno">24134</span>&#160;            <span class="comment">// shapes</span></div>
<div class="line"><a name="l24135"></a><span class="lineno">24135</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;rect&#39;</span>: {</div>
<div class="line"><a name="l24136"></a><span class="lineno">24136</span>&#160;                <span class="keywordflow">if</span> ($invisible) {</div>
<div class="line"><a name="l24137"></a><span class="lineno">24137</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l24138"></a><span class="lineno">24138</span>&#160;                }</div>
<div class="line"><a name="l24139"></a><span class="lineno">24139</span>&#160;                $x = (isset($attribs[<span class="charliteral">&#39;x&#39;</span>])?$this-&gt;getHTMLUnitToUnits($attribs[<span class="charliteral">&#39;x&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>):0);</div>
<div class="line"><a name="l24140"></a><span class="lineno">24140</span>&#160;                $y = (isset($attribs[<span class="charliteral">&#39;y&#39;</span>])?$this-&gt;getHTMLUnitToUnits($attribs[<span class="charliteral">&#39;y&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>):0);</div>
<div class="line"><a name="l24141"></a><span class="lineno">24141</span>&#160;                $w = (isset($attribs[<span class="stringliteral">&#39;width&#39;</span>])?$this-&gt;getHTMLUnitToUnits($attribs[<span class="stringliteral">&#39;width&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>):0);</div>
<div class="line"><a name="l24142"></a><span class="lineno">24142</span>&#160;                $h = (isset($attribs[<span class="stringliteral">&#39;height&#39;</span>])?$this-&gt;getHTMLUnitToUnits($attribs[<span class="stringliteral">&#39;height&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>):0);</div>
<div class="line"><a name="l24143"></a><span class="lineno">24143</span>&#160;                $rx = (isset($attribs[<span class="stringliteral">&#39;rx&#39;</span>])?$this-&gt;getHTMLUnitToUnits($attribs[<span class="stringliteral">&#39;rx&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>):0);</div>
<div class="line"><a name="l24144"></a><span class="lineno">24144</span>&#160;                $ry = (isset($attribs[<span class="stringliteral">&#39;ry&#39;</span>])?$this-&gt;getHTMLUnitToUnits($attribs[<span class="stringliteral">&#39;ry&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>):$rx);</div>
<div class="line"><a name="l24145"></a><span class="lineno">24145</span>&#160;                <span class="keywordflow">if</span> ($clipping) {</div>
<div class="line"><a name="l24146"></a><span class="lineno">24146</span>&#160;                    $this-&gt;SVGTransform($tm);</div>
<div class="line"><a name="l24147"></a><span class="lineno">24147</span>&#160;                    $this-&gt;RoundedRectXY($x, $y, $w, $h, $rx, $ry, <span class="stringliteral">&#39;1111&#39;</span>, <span class="stringliteral">&#39;CNZ&#39;</span>, array(), array());</div>
<div class="line"><a name="l24148"></a><span class="lineno">24148</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l24149"></a><span class="lineno">24149</span>&#160;                    $this-&gt;StartTransform();</div>
<div class="line"><a name="l24150"></a><span class="lineno">24150</span>&#160;                    $this-&gt;SVGTransform($tm);</div>
<div class="line"><a name="l24151"></a><span class="lineno">24151</span>&#160;                    $obstyle = $this-&gt;setSVGStyles($svgstyle, $prev_svgstyle, $x, $y, $w, $h, <span class="stringliteral">&#39;RoundedRectXY&#39;</span>, array($x, $y, $w, $h, $rx, $ry, <span class="stringliteral">&#39;1111&#39;</span>, <span class="stringliteral">&#39;CNZ&#39;</span>));</div>
<div class="line"><a name="l24152"></a><span class="lineno">24152</span>&#160;                    <span class="keywordflow">if</span> (!empty($obstyle)) {</div>
<div class="line"><a name="l24153"></a><span class="lineno">24153</span>&#160;                        $this-&gt;RoundedRectXY($x, $y, $w, $h, $rx, $ry, <span class="stringliteral">&#39;1111&#39;</span>, $obstyle, array(), array());</div>
<div class="line"><a name="l24154"></a><span class="lineno">24154</span>&#160;                    }</div>
<div class="line"><a name="l24155"></a><span class="lineno">24155</span>&#160;                    $this-&gt;StopTransform();</div>
<div class="line"><a name="l24156"></a><span class="lineno">24156</span>&#160;                }</div>
<div class="line"><a name="l24157"></a><span class="lineno">24157</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l24158"></a><span class="lineno">24158</span>&#160;            }</div>
<div class="line"><a name="l24159"></a><span class="lineno">24159</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;circle&#39;</span>: {</div>
<div class="line"><a name="l24160"></a><span class="lineno">24160</span>&#160;                <span class="keywordflow">if</span> ($invisible) {</div>
<div class="line"><a name="l24161"></a><span class="lineno">24161</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l24162"></a><span class="lineno">24162</span>&#160;                }</div>
<div class="line"><a name="l24163"></a><span class="lineno">24163</span>&#160;                $r = (isset($attribs[<span class="charliteral">&#39;r&#39;</span>]) ? $this-&gt;getHTMLUnitToUnits($attribs[<span class="charliteral">&#39;r&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>) : 0);</div>
<div class="line"><a name="l24164"></a><span class="lineno">24164</span>&#160;                $cx = (isset($attribs[<span class="stringliteral">&#39;cx&#39;</span>]) ? $this-&gt;getHTMLUnitToUnits($attribs[<span class="stringliteral">&#39;cx&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>) : (isset($attribs[<span class="charliteral">&#39;x&#39;</span>]) ? $this-&gt;getHTMLUnitToUnits($attribs[<span class="charliteral">&#39;x&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>) : 0));</div>
<div class="line"><a name="l24165"></a><span class="lineno">24165</span>&#160;                $cy = (isset($attribs[<span class="stringliteral">&#39;cy&#39;</span>]) ? $this-&gt;getHTMLUnitToUnits($attribs[<span class="stringliteral">&#39;cy&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>) : (isset($attribs[<span class="charliteral">&#39;y&#39;</span>]) ? $this-&gt;getHTMLUnitToUnits($attribs[<span class="charliteral">&#39;y&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>) : 0));</div>
<div class="line"><a name="l24166"></a><span class="lineno">24166</span>&#160;                $x = ($cx - $r);</div>
<div class="line"><a name="l24167"></a><span class="lineno">24167</span>&#160;                $y = ($cy - $r);</div>
<div class="line"><a name="l24168"></a><span class="lineno">24168</span>&#160;                $w = (2 * $r);</div>
<div class="line"><a name="l24169"></a><span class="lineno">24169</span>&#160;                $h = $w;</div>
<div class="line"><a name="l24170"></a><span class="lineno">24170</span>&#160;                <span class="keywordflow">if</span> ($clipping) {</div>
<div class="line"><a name="l24171"></a><span class="lineno">24171</span>&#160;                    $this-&gt;SVGTransform($tm);</div>
<div class="line"><a name="l24172"></a><span class="lineno">24172</span>&#160;                    $this-&gt;Circle($cx, $cy, $r, 0, 360, <span class="stringliteral">&#39;CNZ&#39;</span>, array(), array(), 8);</div>
<div class="line"><a name="l24173"></a><span class="lineno">24173</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l24174"></a><span class="lineno">24174</span>&#160;                    $this-&gt;StartTransform();</div>
<div class="line"><a name="l24175"></a><span class="lineno">24175</span>&#160;                    $this-&gt;SVGTransform($tm);</div>
<div class="line"><a name="l24176"></a><span class="lineno">24176</span>&#160;                    $obstyle = $this-&gt;setSVGStyles($svgstyle, $prev_svgstyle, $x, $y, $w, $h, <span class="stringliteral">&#39;Circle&#39;</span>, array($cx, $cy, $r, 0, 360, <span class="stringliteral">&#39;CNZ&#39;</span>));</div>
<div class="line"><a name="l24177"></a><span class="lineno">24177</span>&#160;                    <span class="keywordflow">if</span> (!empty($obstyle)) {</div>
<div class="line"><a name="l24178"></a><span class="lineno">24178</span>&#160;                        $this-&gt;Circle($cx, $cy, $r, 0, 360, $obstyle, array(), array(), 8);</div>
<div class="line"><a name="l24179"></a><span class="lineno">24179</span>&#160;                    }</div>
<div class="line"><a name="l24180"></a><span class="lineno">24180</span>&#160;                    $this-&gt;StopTransform();</div>
<div class="line"><a name="l24181"></a><span class="lineno">24181</span>&#160;                }</div>
<div class="line"><a name="l24182"></a><span class="lineno">24182</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l24183"></a><span class="lineno">24183</span>&#160;            }</div>
<div class="line"><a name="l24184"></a><span class="lineno">24184</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;ellipse&#39;</span>: {</div>
<div class="line"><a name="l24185"></a><span class="lineno">24185</span>&#160;                <span class="keywordflow">if</span> ($invisible) {</div>
<div class="line"><a name="l24186"></a><span class="lineno">24186</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l24187"></a><span class="lineno">24187</span>&#160;                }</div>
<div class="line"><a name="l24188"></a><span class="lineno">24188</span>&#160;                $rx = (isset($attribs[<span class="stringliteral">&#39;rx&#39;</span>]) ? $this-&gt;getHTMLUnitToUnits($attribs[<span class="stringliteral">&#39;rx&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>) : 0);</div>
<div class="line"><a name="l24189"></a><span class="lineno">24189</span>&#160;                $ry = (isset($attribs[<span class="stringliteral">&#39;ry&#39;</span>]) ? $this-&gt;getHTMLUnitToUnits($attribs[<span class="stringliteral">&#39;ry&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>) : 0);</div>
<div class="line"><a name="l24190"></a><span class="lineno">24190</span>&#160;                $cx = (isset($attribs[<span class="stringliteral">&#39;cx&#39;</span>]) ? $this-&gt;getHTMLUnitToUnits($attribs[<span class="stringliteral">&#39;cx&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>) : (isset($attribs[<span class="charliteral">&#39;x&#39;</span>]) ? $this-&gt;getHTMLUnitToUnits($attribs[<span class="charliteral">&#39;x&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>) : 0));</div>
<div class="line"><a name="l24191"></a><span class="lineno">24191</span>&#160;                $cy = (isset($attribs[<span class="stringliteral">&#39;cy&#39;</span>]) ? $this-&gt;getHTMLUnitToUnits($attribs[<span class="stringliteral">&#39;cy&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>) : (isset($attribs[<span class="charliteral">&#39;y&#39;</span>]) ? $this-&gt;getHTMLUnitToUnits($attribs[<span class="charliteral">&#39;y&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>) : 0));</div>
<div class="line"><a name="l24192"></a><span class="lineno">24192</span>&#160;                $x = ($cx - $rx);</div>
<div class="line"><a name="l24193"></a><span class="lineno">24193</span>&#160;                $y = ($cy - $ry);</div>
<div class="line"><a name="l24194"></a><span class="lineno">24194</span>&#160;                $w = (2 * $rx);</div>
<div class="line"><a name="l24195"></a><span class="lineno">24195</span>&#160;                $h = (2 * $ry);</div>
<div class="line"><a name="l24196"></a><span class="lineno">24196</span>&#160;                <span class="keywordflow">if</span> ($clipping) {</div>
<div class="line"><a name="l24197"></a><span class="lineno">24197</span>&#160;                    $this-&gt;SVGTransform($tm);</div>
<div class="line"><a name="l24198"></a><span class="lineno">24198</span>&#160;                    $this-&gt;Ellipse($cx, $cy, $rx, $ry, 0, 0, 360, <span class="stringliteral">&#39;CNZ&#39;</span>, array(), array(), 8);</div>
<div class="line"><a name="l24199"></a><span class="lineno">24199</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l24200"></a><span class="lineno">24200</span>&#160;                    $this-&gt;StartTransform();</div>
<div class="line"><a name="l24201"></a><span class="lineno">24201</span>&#160;                    $this-&gt;SVGTransform($tm);</div>
<div class="line"><a name="l24202"></a><span class="lineno">24202</span>&#160;                    $obstyle = $this-&gt;setSVGStyles($svgstyle, $prev_svgstyle, $x, $y, $w, $h, <span class="stringliteral">&#39;Ellipse&#39;</span>, array($cx, $cy, $rx, $ry, 0, 0, 360, <span class="stringliteral">&#39;CNZ&#39;</span>));</div>
<div class="line"><a name="l24203"></a><span class="lineno">24203</span>&#160;                    <span class="keywordflow">if</span> (!empty($obstyle)) {</div>
<div class="line"><a name="l24204"></a><span class="lineno">24204</span>&#160;                        $this-&gt;Ellipse($cx, $cy, $rx, $ry, 0, 0, 360, $obstyle, array(), array(), 8);</div>
<div class="line"><a name="l24205"></a><span class="lineno">24205</span>&#160;                    }</div>
<div class="line"><a name="l24206"></a><span class="lineno">24206</span>&#160;                    $this-&gt;StopTransform();</div>
<div class="line"><a name="l24207"></a><span class="lineno">24207</span>&#160;                }</div>
<div class="line"><a name="l24208"></a><span class="lineno">24208</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l24209"></a><span class="lineno">24209</span>&#160;            }</div>
<div class="line"><a name="l24210"></a><span class="lineno">24210</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;line&#39;</span>: {</div>
<div class="line"><a name="l24211"></a><span class="lineno">24211</span>&#160;                <span class="keywordflow">if</span> ($invisible) {</div>
<div class="line"><a name="l24212"></a><span class="lineno">24212</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l24213"></a><span class="lineno">24213</span>&#160;                }</div>
<div class="line"><a name="l24214"></a><span class="lineno">24214</span>&#160;                $x1 = (isset($attribs[<span class="stringliteral">&#39;x1&#39;</span>])?$this-&gt;getHTMLUnitToUnits($attribs[<span class="stringliteral">&#39;x1&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>):0);</div>
<div class="line"><a name="l24215"></a><span class="lineno">24215</span>&#160;                $y1 = (isset($attribs[<span class="stringliteral">&#39;y1&#39;</span>])?$this-&gt;getHTMLUnitToUnits($attribs[<span class="stringliteral">&#39;y1&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>):0);</div>
<div class="line"><a name="l24216"></a><span class="lineno">24216</span>&#160;                $x2 = (isset($attribs[<span class="stringliteral">&#39;x2&#39;</span>])?$this-&gt;getHTMLUnitToUnits($attribs[<span class="stringliteral">&#39;x2&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>):0);</div>
<div class="line"><a name="l24217"></a><span class="lineno">24217</span>&#160;                $y2 = (isset($attribs[<span class="stringliteral">&#39;y2&#39;</span>])?$this-&gt;getHTMLUnitToUnits($attribs[<span class="stringliteral">&#39;y2&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>):0);</div>
<div class="line"><a name="l24218"></a><span class="lineno">24218</span>&#160;                $x = $x1;</div>
<div class="line"><a name="l24219"></a><span class="lineno">24219</span>&#160;                $y = $y1;</div>
<div class="line"><a name="l24220"></a><span class="lineno">24220</span>&#160;                $w = abs($x2 - $x1);</div>
<div class="line"><a name="l24221"></a><span class="lineno">24221</span>&#160;                $h = abs($y2 - $y1);</div>
<div class="line"><a name="l24222"></a><span class="lineno">24222</span>&#160;                <span class="keywordflow">if</span> (!$clipping) {</div>
<div class="line"><a name="l24223"></a><span class="lineno">24223</span>&#160;                    $this-&gt;StartTransform();</div>
<div class="line"><a name="l24224"></a><span class="lineno">24224</span>&#160;                    $this-&gt;SVGTransform($tm);</div>
<div class="line"><a name="l24225"></a><span class="lineno">24225</span>&#160;                    $obstyle = $this-&gt;setSVGStyles($svgstyle, $prev_svgstyle, $x, $y, $w, $h, <span class="stringliteral">&#39;Line&#39;</span>, array($x1, $y1, $x2, $y2));</div>
<div class="line"><a name="l24226"></a><span class="lineno">24226</span>&#160;                    $this-&gt;Line($x1, $y1, $x2, $y2);</div>
<div class="line"><a name="l24227"></a><span class="lineno">24227</span>&#160;                    $this-&gt;StopTransform();</div>
<div class="line"><a name="l24228"></a><span class="lineno">24228</span>&#160;                }</div>
<div class="line"><a name="l24229"></a><span class="lineno">24229</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l24230"></a><span class="lineno">24230</span>&#160;            }</div>
<div class="line"><a name="l24231"></a><span class="lineno">24231</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;polyline&#39;</span>:</div>
<div class="line"><a name="l24232"></a><span class="lineno">24232</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;polygon&#39;</span>: {</div>
<div class="line"><a name="l24233"></a><span class="lineno">24233</span>&#160;                <span class="keywordflow">if</span> ($invisible) {</div>
<div class="line"><a name="l24234"></a><span class="lineno">24234</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l24235"></a><span class="lineno">24235</span>&#160;                }</div>
<div class="line"><a name="l24236"></a><span class="lineno">24236</span>&#160;                $points = (isset($attribs[<span class="stringliteral">&#39;points&#39;</span>])?$attribs[<span class="stringliteral">&#39;points&#39;</span>]:<span class="stringliteral">&#39;0 0&#39;</span>);</div>
<div class="line"><a name="l24237"></a><span class="lineno">24237</span>&#160;                $points = trim($points);</div>
<div class="line"><a name="l24238"></a><span class="lineno">24238</span>&#160;                <span class="comment">// note that point may use a complex syntax not covered here</span></div>
<div class="line"><a name="l24239"></a><span class="lineno">24239</span>&#160;                $points = preg_split(<span class="stringliteral">&#39;/[\,\s]+/si&#39;</span>, $points);</div>
<div class="line"><a name="l24240"></a><span class="lineno">24240</span>&#160;                <span class="keywordflow">if</span> (count($points) &lt; 4) {</div>
<div class="line"><a name="l24241"></a><span class="lineno">24241</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l24242"></a><span class="lineno">24242</span>&#160;                }</div>
<div class="line"><a name="l24243"></a><span class="lineno">24243</span>&#160;                $p = array();</div>
<div class="line"><a name="l24244"></a><span class="lineno">24244</span>&#160;                $xmin = 2147483647;</div>
<div class="line"><a name="l24245"></a><span class="lineno">24245</span>&#160;                $xmax = 0;</div>
<div class="line"><a name="l24246"></a><span class="lineno">24246</span>&#160;                $ymin = 2147483647;</div>
<div class="line"><a name="l24247"></a><span class="lineno">24247</span>&#160;                $ymax = 0;</div>
<div class="line"><a name="l24248"></a><span class="lineno">24248</span>&#160;                <span class="keywordflow">foreach</span> ($points as $key =&gt; $val) {</div>
<div class="line"><a name="l24249"></a><span class="lineno">24249</span>&#160;                    $p[$key] = $this-&gt;getHTMLUnitToUnits($val, 0, $this-&gt;svgunit, <span class="keyword">false</span>);</div>
<div class="line"><a name="l24250"></a><span class="lineno">24250</span>&#160;                    <span class="keywordflow">if</span> (($key % 2) == 0) {</div>
<div class="line"><a name="l24251"></a><span class="lineno">24251</span>&#160;                        <span class="comment">// X coordinate</span></div>
<div class="line"><a name="l24252"></a><span class="lineno">24252</span>&#160;                        $xmin = min($xmin, $p[$key]);</div>
<div class="line"><a name="l24253"></a><span class="lineno">24253</span>&#160;                        $xmax = max($xmax, $p[$key]);</div>
<div class="line"><a name="l24254"></a><span class="lineno">24254</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l24255"></a><span class="lineno">24255</span>&#160;                        <span class="comment">// Y coordinate</span></div>
<div class="line"><a name="l24256"></a><span class="lineno">24256</span>&#160;                        $ymin = min($ymin, $p[$key]);</div>
<div class="line"><a name="l24257"></a><span class="lineno">24257</span>&#160;                        $ymax = max($ymax, $p[$key]);</div>
<div class="line"><a name="l24258"></a><span class="lineno">24258</span>&#160;                    }</div>
<div class="line"><a name="l24259"></a><span class="lineno">24259</span>&#160;                }</div>
<div class="line"><a name="l24260"></a><span class="lineno">24260</span>&#160;                $x = $xmin;</div>
<div class="line"><a name="l24261"></a><span class="lineno">24261</span>&#160;                $y = $ymin;</div>
<div class="line"><a name="l24262"></a><span class="lineno">24262</span>&#160;                $w = ($xmax - $xmin);</div>
<div class="line"><a name="l24263"></a><span class="lineno">24263</span>&#160;                $h = ($ymax - $ymin);</div>
<div class="line"><a name="l24264"></a><span class="lineno">24264</span>&#160;                <span class="keywordflow">if</span> ($name == <span class="stringliteral">&#39;polyline&#39;</span>) {</div>
<div class="line"><a name="l24265"></a><span class="lineno">24265</span>&#160;                    $this-&gt;StartTransform();</div>
<div class="line"><a name="l24266"></a><span class="lineno">24266</span>&#160;                    $this-&gt;SVGTransform($tm);</div>
<div class="line"><a name="l24267"></a><span class="lineno">24267</span>&#160;                    $obstyle = $this-&gt;setSVGStyles($svgstyle, $prev_svgstyle, $x, $y, $w, $h, <span class="stringliteral">&#39;PolyLine&#39;</span>, array($p, <span class="stringliteral">&#39;CNZ&#39;</span>));</div>
<div class="line"><a name="l24268"></a><span class="lineno">24268</span>&#160;                    <span class="keywordflow">if</span> (!empty($obstyle)) {</div>
<div class="line"><a name="l24269"></a><span class="lineno">24269</span>&#160;                        $this-&gt;PolyLine($p, $obstyle, array(), array());</div>
<div class="line"><a name="l24270"></a><span class="lineno">24270</span>&#160;                    }</div>
<div class="line"><a name="l24271"></a><span class="lineno">24271</span>&#160;                    $this-&gt;StopTransform();</div>
<div class="line"><a name="l24272"></a><span class="lineno">24272</span>&#160;                } <span class="keywordflow">else</span> { <span class="comment">// polygon</span></div>
<div class="line"><a name="l24273"></a><span class="lineno">24273</span>&#160;                    <span class="keywordflow">if</span> ($clipping) {</div>
<div class="line"><a name="l24274"></a><span class="lineno">24274</span>&#160;                        $this-&gt;SVGTransform($tm);</div>
<div class="line"><a name="l24275"></a><span class="lineno">24275</span>&#160;                        $this-&gt;Polygon($p, <span class="stringliteral">&#39;CNZ&#39;</span>, array(), array(), <span class="keyword">true</span>);</div>
<div class="line"><a name="l24276"></a><span class="lineno">24276</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l24277"></a><span class="lineno">24277</span>&#160;                        $this-&gt;StartTransform();</div>
<div class="line"><a name="l24278"></a><span class="lineno">24278</span>&#160;                        $this-&gt;SVGTransform($tm);</div>
<div class="line"><a name="l24279"></a><span class="lineno">24279</span>&#160;                        $obstyle = $this-&gt;setSVGStyles($svgstyle, $prev_svgstyle, $x, $y, $w, $h, <span class="stringliteral">&#39;Polygon&#39;</span>, array($p, <span class="stringliteral">&#39;CNZ&#39;</span>));</div>
<div class="line"><a name="l24280"></a><span class="lineno">24280</span>&#160;                        <span class="keywordflow">if</span> (!empty($obstyle)) {</div>
<div class="line"><a name="l24281"></a><span class="lineno">24281</span>&#160;                            $this-&gt;Polygon($p, $obstyle, array(), array(), <span class="keyword">true</span>);</div>
<div class="line"><a name="l24282"></a><span class="lineno">24282</span>&#160;                        }</div>
<div class="line"><a name="l24283"></a><span class="lineno">24283</span>&#160;                        $this-&gt;StopTransform();</div>
<div class="line"><a name="l24284"></a><span class="lineno">24284</span>&#160;                    }</div>
<div class="line"><a name="l24285"></a><span class="lineno">24285</span>&#160;                }</div>
<div class="line"><a name="l24286"></a><span class="lineno">24286</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l24287"></a><span class="lineno">24287</span>&#160;            }</div>
<div class="line"><a name="l24288"></a><span class="lineno">24288</span>&#160;            <span class="comment">// image</span></div>
<div class="line"><a name="l24289"></a><span class="lineno">24289</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;image&#39;</span>: {</div>
<div class="line"><a name="l24290"></a><span class="lineno">24290</span>&#160;                <span class="keywordflow">if</span> ($invisible) {</div>
<div class="line"><a name="l24291"></a><span class="lineno">24291</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l24292"></a><span class="lineno">24292</span>&#160;                }</div>
<div class="line"><a name="l24293"></a><span class="lineno">24293</span>&#160;                <span class="keywordflow">if</span> (!isset($attribs[<span class="stringliteral">&#39;xlink:href&#39;</span>]) OR empty($attribs[<span class="stringliteral">&#39;xlink:href&#39;</span>])) {</div>
<div class="line"><a name="l24294"></a><span class="lineno">24294</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l24295"></a><span class="lineno">24295</span>&#160;                }</div>
<div class="line"><a name="l24296"></a><span class="lineno">24296</span>&#160;                $x = (isset($attribs[<span class="charliteral">&#39;x&#39;</span>])?$this-&gt;getHTMLUnitToUnits($attribs[<span class="charliteral">&#39;x&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>):0);</div>
<div class="line"><a name="l24297"></a><span class="lineno">24297</span>&#160;                $y = (isset($attribs[<span class="charliteral">&#39;y&#39;</span>])?$this-&gt;getHTMLUnitToUnits($attribs[<span class="charliteral">&#39;y&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>):0);</div>
<div class="line"><a name="l24298"></a><span class="lineno">24298</span>&#160;                $w = (isset($attribs[<span class="stringliteral">&#39;width&#39;</span>])?$this-&gt;getHTMLUnitToUnits($attribs[<span class="stringliteral">&#39;width&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>):0);</div>
<div class="line"><a name="l24299"></a><span class="lineno">24299</span>&#160;                $h = (isset($attribs[<span class="stringliteral">&#39;height&#39;</span>])?$this-&gt;getHTMLUnitToUnits($attribs[<span class="stringliteral">&#39;height&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>):0);</div>
<div class="line"><a name="l24300"></a><span class="lineno">24300</span>&#160;                $img = $attribs[<span class="stringliteral">&#39;xlink:href&#39;</span>];</div>
<div class="line"><a name="l24301"></a><span class="lineno">24301</span>&#160;                <span class="keywordflow">if</span> (!$clipping) {</div>
<div class="line"><a name="l24302"></a><span class="lineno">24302</span>&#160;                    $this-&gt;StartTransform();</div>
<div class="line"><a name="l24303"></a><span class="lineno">24303</span>&#160;                    $this-&gt;SVGTransform($tm);</div>
<div class="line"><a name="l24304"></a><span class="lineno">24304</span>&#160;                    $obstyle = $this-&gt;setSVGStyles($svgstyle, $prev_svgstyle, $x, $y, $w, $h);</div>
<div class="line"><a name="l24305"></a><span class="lineno">24305</span>&#160;                    <span class="keywordflow">if</span> (preg_match(<span class="stringliteral">&#39;/^data:image\/[^;]+;base64,/&#39;</span>, $img, $m) &gt; 0) {</div>
<div class="line"><a name="l24306"></a><span class="lineno">24306</span>&#160;                        <span class="comment">// embedded image encoded as base64</span></div>
<div class="line"><a name="l24307"></a><span class="lineno">24307</span>&#160;                        $img = <span class="charliteral">&#39;@&#39;</span>.base64_decode(substr($img, strlen($m[0])));</div>
<div class="line"><a name="l24308"></a><span class="lineno">24308</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l24309"></a><span class="lineno">24309</span>&#160;                        <span class="comment">// fix image path</span></div>
<div class="line"><a name="l24310"></a><span class="lineno">24310</span>&#160;                        <span class="keywordflow">if</span> (!TCPDF_STATIC::empty_string($this-&gt;svgdir) AND (($img[0] == <span class="charliteral">&#39;.&#39;</span>) OR (basename($img) == $img))) {</div>
<div class="line"><a name="l24311"></a><span class="lineno">24311</span>&#160;                            <span class="comment">// replace relative path with full server path</span></div>
<div class="line"><a name="l24312"></a><span class="lineno">24312</span>&#160;                            $img = $this-&gt;svgdir.<span class="charliteral">&#39;/&#39;</span>.$img;</div>
<div class="line"><a name="l24313"></a><span class="lineno">24313</span>&#160;                        }</div>
<div class="line"><a name="l24314"></a><span class="lineno">24314</span>&#160;                        <span class="keywordflow">if</span> (($img[0] == <span class="charliteral">&#39;/&#39;</span>) AND !empty(<a class="code" href="../../d5/dab/tcpdf__autoconfig_8php.html#a438a0ae7ce372c95f49c1a0f29f9eeb6">$_SERVER</a>[<span class="stringliteral">&#39;DOCUMENT_ROOT&#39;</span>]) AND (<a class="code" href="../../d5/dab/tcpdf__autoconfig_8php.html#a438a0ae7ce372c95f49c1a0f29f9eeb6">$_SERVER</a>[<span class="stringliteral">&#39;DOCUMENT_ROOT&#39;</span>] != <span class="charliteral">&#39;/&#39;</span>)) {</div>
<div class="line"><a name="l24315"></a><span class="lineno">24315</span>&#160;                            $findroot = strpos($img, <a class="code" href="../../d5/dab/tcpdf__autoconfig_8php.html#a438a0ae7ce372c95f49c1a0f29f9eeb6">$_SERVER</a>[<span class="stringliteral">&#39;DOCUMENT_ROOT&#39;</span>]);</div>
<div class="line"><a name="l24316"></a><span class="lineno">24316</span>&#160;                            <span class="keywordflow">if</span> (($findroot === <span class="keyword">false</span>) OR ($findroot &gt; 1)) {</div>
<div class="line"><a name="l24317"></a><span class="lineno">24317</span>&#160;                                <span class="keywordflow">if</span> (substr(<a class="code" href="../../d5/dab/tcpdf__autoconfig_8php.html#a438a0ae7ce372c95f49c1a0f29f9eeb6">$_SERVER</a>[<span class="stringliteral">&#39;DOCUMENT_ROOT&#39;</span>], -1) == <span class="charliteral">&#39;/&#39;</span>) {</div>
<div class="line"><a name="l24318"></a><span class="lineno">24318</span>&#160;                                    $img = substr(<a class="code" href="../../d5/dab/tcpdf__autoconfig_8php.html#a438a0ae7ce372c95f49c1a0f29f9eeb6">$_SERVER</a>[<span class="stringliteral">&#39;DOCUMENT_ROOT&#39;</span>], 0, -1).$img;</div>
<div class="line"><a name="l24319"></a><span class="lineno">24319</span>&#160;                                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l24320"></a><span class="lineno">24320</span>&#160;                                    $img = <a class="code" href="../../d5/dab/tcpdf__autoconfig_8php.html#a438a0ae7ce372c95f49c1a0f29f9eeb6">$_SERVER</a>[<span class="stringliteral">&#39;DOCUMENT_ROOT&#39;</span>].$img;</div>
<div class="line"><a name="l24321"></a><span class="lineno">24321</span>&#160;                                }</div>
<div class="line"><a name="l24322"></a><span class="lineno">24322</span>&#160;                            }</div>
<div class="line"><a name="l24323"></a><span class="lineno">24323</span>&#160;                        }</div>
<div class="line"><a name="l24324"></a><span class="lineno">24324</span>&#160;                        $img = urldecode($img);</div>
<div class="line"><a name="l24325"></a><span class="lineno">24325</span>&#160;                        $testscrtype = @parse_url($img);</div>
<div class="line"><a name="l24326"></a><span class="lineno">24326</span>&#160;                        <span class="keywordflow">if</span> (!isset($testscrtype[<span class="stringliteral">&#39;query&#39;</span>]) OR empty($testscrtype[<span class="stringliteral">&#39;query&#39;</span>])) {</div>
<div class="line"><a name="l24327"></a><span class="lineno">24327</span>&#160;                            <span class="comment">// convert URL to server path</span></div>
<div class="line"><a name="l24328"></a><span class="lineno">24328</span>&#160;                            $img = str_replace(K_PATH_URL, K_PATH_MAIN, $img);</div>
<div class="line"><a name="l24329"></a><span class="lineno">24329</span>&#160;                        }</div>
<div class="line"><a name="l24330"></a><span class="lineno">24330</span>&#160;                    }</div>
<div class="line"><a name="l24331"></a><span class="lineno">24331</span>&#160;                    <span class="comment">// get image type</span></div>
<div class="line"><a name="l24332"></a><span class="lineno">24332</span>&#160;                    $imgtype = TCPDF_IMAGES::getImageFileType($img);</div>
<div class="line"><a name="l24333"></a><span class="lineno">24333</span>&#160;                    <span class="keywordflow">if</span> (($imgtype == <span class="stringliteral">&#39;eps&#39;</span>) OR ($imgtype == <span class="stringliteral">&#39;ai&#39;</span>)) {</div>
<div class="line"><a name="l24334"></a><span class="lineno">24334</span>&#160;                        $this-&gt;ImageEps($img, $x, $y, $w, $h);</div>
<div class="line"><a name="l24335"></a><span class="lineno">24335</span>&#160;                    } elseif ($imgtype == <span class="stringliteral">&#39;svg&#39;</span>) {</div>
<div class="line"><a name="l24336"></a><span class="lineno">24336</span>&#160;                        $this-&gt;ImageSVG($img, $x, $y, $w, $h);</div>
<div class="line"><a name="l24337"></a><span class="lineno">24337</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l24338"></a><span class="lineno">24338</span>&#160;                        $this-&gt;Image($img, $x, $y, $w, $h);</div>
<div class="line"><a name="l24339"></a><span class="lineno">24339</span>&#160;                    }</div>
<div class="line"><a name="l24340"></a><span class="lineno">24340</span>&#160;                    $this-&gt;StopTransform();</div>
<div class="line"><a name="l24341"></a><span class="lineno">24341</span>&#160;                }</div>
<div class="line"><a name="l24342"></a><span class="lineno">24342</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l24343"></a><span class="lineno">24343</span>&#160;            }</div>
<div class="line"><a name="l24344"></a><span class="lineno">24344</span>&#160;            <span class="comment">// text</span></div>
<div class="line"><a name="l24345"></a><span class="lineno">24345</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;text&#39;</span>:</div>
<div class="line"><a name="l24346"></a><span class="lineno">24346</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;tspan&#39;</span>: {</div>
<div class="line"><a name="l24347"></a><span class="lineno">24347</span>&#160;                <span class="comment">// only basic support - advanced features must be implemented</span></div>
<div class="line"><a name="l24348"></a><span class="lineno">24348</span>&#160;                $this-&gt;svgtextmode[<span class="stringliteral">&#39;invisible&#39;</span>] = $invisible;</div>
<div class="line"><a name="l24349"></a><span class="lineno">24349</span>&#160;                <span class="keywordflow">if</span> ($invisible) {</div>
<div class="line"><a name="l24350"></a><span class="lineno">24350</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l24351"></a><span class="lineno">24351</span>&#160;                }</div>
<div class="line"><a name="l24352"></a><span class="lineno">24352</span>&#160;                array_push($this-&gt;svgstyles, $svgstyle);</div>
<div class="line"><a name="l24353"></a><span class="lineno">24353</span>&#160;                <span class="keywordflow">if</span> (isset($attribs[<span class="charliteral">&#39;x&#39;</span>])) {</div>
<div class="line"><a name="l24354"></a><span class="lineno">24354</span>&#160;                    $x = $this-&gt;getHTMLUnitToUnits($attribs[<span class="charliteral">&#39;x&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>);</div>
<div class="line"><a name="l24355"></a><span class="lineno">24355</span>&#160;                } elseif ($name == <span class="stringliteral">&#39;tspan&#39;</span>) {</div>
<div class="line"><a name="l24356"></a><span class="lineno">24356</span>&#160;                    $x = $this-&gt;x;</div>
<div class="line"><a name="l24357"></a><span class="lineno">24357</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l24358"></a><span class="lineno">24358</span>&#160;                    $x = 0;</div>
<div class="line"><a name="l24359"></a><span class="lineno">24359</span>&#160;                }</div>
<div class="line"><a name="l24360"></a><span class="lineno">24360</span>&#160;                <span class="keywordflow">if</span> (isset($attribs[<span class="stringliteral">&#39;dx&#39;</span>])) {</div>
<div class="line"><a name="l24361"></a><span class="lineno">24361</span>&#160;                    $x += $this-&gt;getHTMLUnitToUnits($attribs[<span class="stringliteral">&#39;dx&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>);</div>
<div class="line"><a name="l24362"></a><span class="lineno">24362</span>&#160;                }</div>
<div class="line"><a name="l24363"></a><span class="lineno">24363</span>&#160;                <span class="keywordflow">if</span> (isset($attribs[<span class="charliteral">&#39;y&#39;</span>])) {</div>
<div class="line"><a name="l24364"></a><span class="lineno">24364</span>&#160;                    $y = $this-&gt;getHTMLUnitToUnits($attribs[<span class="charliteral">&#39;y&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>);</div>
<div class="line"><a name="l24365"></a><span class="lineno">24365</span>&#160;                } elseif ($name == <span class="stringliteral">&#39;tspan&#39;</span>) {</div>
<div class="line"><a name="l24366"></a><span class="lineno">24366</span>&#160;                    $y = $this-&gt;y;</div>
<div class="line"><a name="l24367"></a><span class="lineno">24367</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l24368"></a><span class="lineno">24368</span>&#160;                    $y = 0;</div>
<div class="line"><a name="l24369"></a><span class="lineno">24369</span>&#160;                }</div>
<div class="line"><a name="l24370"></a><span class="lineno">24370</span>&#160;                <span class="keywordflow">if</span> (isset($attribs[<span class="stringliteral">&#39;dy&#39;</span>])) {</div>
<div class="line"><a name="l24371"></a><span class="lineno">24371</span>&#160;                    $y += $this-&gt;getHTMLUnitToUnits($attribs[<span class="stringliteral">&#39;dy&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>);</div>
<div class="line"><a name="l24372"></a><span class="lineno">24372</span>&#160;                }</div>
<div class="line"><a name="l24373"></a><span class="lineno">24373</span>&#160;                $svgstyle[<span class="stringliteral">&#39;text-color&#39;</span>] = $svgstyle[<span class="stringliteral">&#39;fill&#39;</span>];</div>
<div class="line"><a name="l24374"></a><span class="lineno">24374</span>&#160;                $this-&gt;svgtext = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l24375"></a><span class="lineno">24375</span>&#160;                <span class="keywordflow">if</span> (isset($svgstyle[<span class="stringliteral">&#39;text-anchor&#39;</span>])) {</div>
<div class="line"><a name="l24376"></a><span class="lineno">24376</span>&#160;                    $this-&gt;svgtextmode[<span class="stringliteral">&#39;text-anchor&#39;</span>] = $svgstyle[<span class="stringliteral">&#39;text-anchor&#39;</span>];</div>
<div class="line"><a name="l24377"></a><span class="lineno">24377</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l24378"></a><span class="lineno">24378</span>&#160;                    $this-&gt;svgtextmode[<span class="stringliteral">&#39;text-anchor&#39;</span>] = <span class="stringliteral">&#39;start&#39;</span>;</div>
<div class="line"><a name="l24379"></a><span class="lineno">24379</span>&#160;                }</div>
<div class="line"><a name="l24380"></a><span class="lineno">24380</span>&#160;                <span class="keywordflow">if</span> (isset($svgstyle[<span class="stringliteral">&#39;direction&#39;</span>])) {</div>
<div class="line"><a name="l24381"></a><span class="lineno">24381</span>&#160;                    <span class="keywordflow">if</span> ($svgstyle[<span class="stringliteral">&#39;direction&#39;</span>] == <span class="stringliteral">&#39;rtl&#39;</span>) {</div>
<div class="line"><a name="l24382"></a><span class="lineno">24382</span>&#160;                        $this-&gt;svgtextmode[<span class="stringliteral">&#39;rtl&#39;</span>] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l24383"></a><span class="lineno">24383</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l24384"></a><span class="lineno">24384</span>&#160;                        $this-&gt;svgtextmode[<span class="stringliteral">&#39;rtl&#39;</span>] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l24385"></a><span class="lineno">24385</span>&#160;                    }</div>
<div class="line"><a name="l24386"></a><span class="lineno">24386</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l24387"></a><span class="lineno">24387</span>&#160;                    $this-&gt;svgtextmode[<span class="stringliteral">&#39;rtl&#39;</span>] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l24388"></a><span class="lineno">24388</span>&#160;                }</div>
<div class="line"><a name="l24389"></a><span class="lineno">24389</span>&#160;                <span class="keywordflow">if</span> (isset($svgstyle[<span class="stringliteral">&#39;stroke&#39;</span>]) AND ($svgstyle[<span class="stringliteral">&#39;stroke&#39;</span>] != <span class="stringliteral">&#39;none&#39;</span>) AND isset($svgstyle[<span class="stringliteral">&#39;stroke-width&#39;</span>]) AND ($svgstyle[<span class="stringliteral">&#39;stroke-width&#39;</span>] &gt; 0)) {</div>
<div class="line"><a name="l24390"></a><span class="lineno">24390</span>&#160;                    $this-&gt;svgtextmode[<span class="stringliteral">&#39;stroke&#39;</span>] = $this-&gt;getHTMLUnitToUnits($svgstyle[<span class="stringliteral">&#39;stroke-width&#39;</span>], 0, $this-&gt;svgunit, <span class="keyword">false</span>);</div>
<div class="line"><a name="l24391"></a><span class="lineno">24391</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l24392"></a><span class="lineno">24392</span>&#160;                    $this-&gt;svgtextmode[<span class="stringliteral">&#39;stroke&#39;</span>] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l24393"></a><span class="lineno">24393</span>&#160;                }</div>
<div class="line"><a name="l24394"></a><span class="lineno">24394</span>&#160;                $this-&gt;StartTransform();</div>
<div class="line"><a name="l24395"></a><span class="lineno">24395</span>&#160;                $this-&gt;SVGTransform($tm);</div>
<div class="line"><a name="l24396"></a><span class="lineno">24396</span>&#160;                $obstyle = $this-&gt;setSVGStyles($svgstyle, $prev_svgstyle, $x, $y, 1, 1);</div>
<div class="line"><a name="l24397"></a><span class="lineno">24397</span>&#160;                $this-&gt;x = $x;</div>
<div class="line"><a name="l24398"></a><span class="lineno">24398</span>&#160;                $this-&gt;y = $y;</div>
<div class="line"><a name="l24399"></a><span class="lineno">24399</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l24400"></a><span class="lineno">24400</span>&#160;            }</div>
<div class="line"><a name="l24401"></a><span class="lineno">24401</span>&#160;            <span class="comment">// use</span></div>
<div class="line"><a name="l24402"></a><span class="lineno">24402</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;use&#39;</span>: {</div>
<div class="line"><a name="l24403"></a><span class="lineno">24403</span>&#160;                <span class="keywordflow">if</span> (isset($attribs[<span class="stringliteral">&#39;xlink:href&#39;</span>]) AND !empty($attribs[<span class="stringliteral">&#39;xlink:href&#39;</span>])) {</div>
<div class="line"><a name="l24404"></a><span class="lineno">24404</span>&#160;                    $svgdefid = substr($attribs[<span class="stringliteral">&#39;xlink:href&#39;</span>], 1);</div>
<div class="line"><a name="l24405"></a><span class="lineno">24405</span>&#160;                    <span class="keywordflow">if</span> (isset($this-&gt;svgdefs[$svgdefid])) {</div>
<div class="line"><a name="l24406"></a><span class="lineno">24406</span>&#160;                        $use = $this-&gt;svgdefs[$svgdefid];</div>
<div class="line"><a name="l24407"></a><span class="lineno">24407</span>&#160;                        <span class="keywordflow">if</span> (isset($attribs[<span class="stringliteral">&#39;xlink:href&#39;</span>])) {</div>
<div class="line"><a name="l24408"></a><span class="lineno">24408</span>&#160;                            unset($attribs[<span class="stringliteral">&#39;xlink:href&#39;</span>]);</div>
<div class="line"><a name="l24409"></a><span class="lineno">24409</span>&#160;                        }</div>
<div class="line"><a name="l24410"></a><span class="lineno">24410</span>&#160;                        <span class="keywordflow">if</span> (isset($attribs[<span class="stringliteral">&#39;id&#39;</span>])) {</div>
<div class="line"><a name="l24411"></a><span class="lineno">24411</span>&#160;                            unset($attribs[<span class="stringliteral">&#39;id&#39;</span>]);</div>
<div class="line"><a name="l24412"></a><span class="lineno">24412</span>&#160;                        }</div>
<div class="line"><a name="l24413"></a><span class="lineno">24413</span>&#160;                        <span class="keywordflow">if</span> (isset($use[<span class="stringliteral">&#39;attribs&#39;</span>][<span class="charliteral">&#39;x&#39;</span>]) AND isset($attribs[<span class="charliteral">&#39;x&#39;</span>])) {</div>
<div class="line"><a name="l24414"></a><span class="lineno">24414</span>&#160;                            $attribs[<span class="charliteral">&#39;x&#39;</span>] += $use[<span class="stringliteral">&#39;attribs&#39;</span>][<span class="charliteral">&#39;x&#39;</span>];</div>
<div class="line"><a name="l24415"></a><span class="lineno">24415</span>&#160;                        }</div>
<div class="line"><a name="l24416"></a><span class="lineno">24416</span>&#160;                        <span class="keywordflow">if</span> (isset($use[<span class="stringliteral">&#39;attribs&#39;</span>][<span class="charliteral">&#39;y&#39;</span>]) AND isset($attribs[<span class="charliteral">&#39;y&#39;</span>])) {</div>
<div class="line"><a name="l24417"></a><span class="lineno">24417</span>&#160;                            $attribs[<span class="charliteral">&#39;y&#39;</span>] += $use[<span class="stringliteral">&#39;attribs&#39;</span>][<span class="charliteral">&#39;y&#39;</span>];</div>
<div class="line"><a name="l24418"></a><span class="lineno">24418</span>&#160;                        }</div>
<div class="line"><a name="l24419"></a><span class="lineno">24419</span>&#160;                        <span class="keywordflow">if</span> (empty($attribs[<span class="stringliteral">&#39;style&#39;</span>])) {</div>
<div class="line"><a name="l24420"></a><span class="lineno">24420</span>&#160;                            $attribs[<span class="stringliteral">&#39;style&#39;</span>] = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l24421"></a><span class="lineno">24421</span>&#160;                        }</div>
<div class="line"><a name="l24422"></a><span class="lineno">24422</span>&#160;                        <span class="keywordflow">if</span> (!empty($use[<span class="stringliteral">&#39;attribs&#39;</span>][<span class="stringliteral">&#39;style&#39;</span>])) {</div>
<div class="line"><a name="l24423"></a><span class="lineno">24423</span>&#160;                            <span class="comment">// merge styles</span></div>
<div class="line"><a name="l24424"></a><span class="lineno">24424</span>&#160;                            $attribs[<span class="stringliteral">&#39;style&#39;</span>] = str_replace(<span class="stringliteral">&#39;;;&#39;</span>,<span class="charliteral">&#39;;&#39;</span>,<span class="charliteral">&#39;;&#39;</span>.$use[<span class="stringliteral">&#39;attribs&#39;</span>][<span class="stringliteral">&#39;style&#39;</span>].$attribs[<span class="stringliteral">&#39;style&#39;</span>]);</div>
<div class="line"><a name="l24425"></a><span class="lineno">24425</span>&#160;                        }</div>
<div class="line"><a name="l24426"></a><span class="lineno">24426</span>&#160;                        $attribs = array_merge($use[<span class="stringliteral">&#39;attribs&#39;</span>], $attribs);</div>
<div class="line"><a name="l24427"></a><span class="lineno">24427</span>&#160;                        $this-&gt;startSVGElementHandler($parser, $use[<span class="stringliteral">&#39;name&#39;</span>], $attribs);</div>
<div class="line"><a name="l24428"></a><span class="lineno">24428</span>&#160;                        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l24429"></a><span class="lineno">24429</span>&#160;                    }</div>
<div class="line"><a name="l24430"></a><span class="lineno">24430</span>&#160;                }</div>
<div class="line"><a name="l24431"></a><span class="lineno">24431</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l24432"></a><span class="lineno">24432</span>&#160;            }</div>
<div class="line"><a name="l24433"></a><span class="lineno">24433</span>&#160;            <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l24434"></a><span class="lineno">24434</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l24435"></a><span class="lineno">24435</span>&#160;            }</div>
<div class="line"><a name="l24436"></a><span class="lineno">24436</span>&#160;        } <span class="comment">// end of switch</span></div>
<div class="line"><a name="l24437"></a><span class="lineno">24437</span>&#160;        <span class="comment">// process child elements</span></div>
<div class="line"><a name="l24438"></a><span class="lineno">24438</span>&#160;        <span class="keywordflow">if</span> (!empty($attribs[<span class="stringliteral">&#39;child_elements&#39;</span>])) {</div>
<div class="line"><a name="l24439"></a><span class="lineno">24439</span>&#160;            $child_elements = $attribs[<span class="stringliteral">&#39;child_elements&#39;</span>];</div>
<div class="line"><a name="l24440"></a><span class="lineno">24440</span>&#160;            unset($attribs[<span class="stringliteral">&#39;child_elements&#39;</span>]);</div>
<div class="line"><a name="l24441"></a><span class="lineno">24441</span>&#160;            <span class="keywordflow">foreach</span>($child_elements as $child_element) {</div>
<div class="line"><a name="l24442"></a><span class="lineno">24442</span>&#160;                <span class="keywordflow">if</span> (empty($child_element[<span class="stringliteral">&#39;attribs&#39;</span>][<span class="stringliteral">&#39;closing_tag&#39;</span>])) {</div>
<div class="line"><a name="l24443"></a><span class="lineno">24443</span>&#160;                    $this-&gt;startSVGElementHandler(<span class="stringliteral">&#39;child-tag&#39;</span>, $child_element[<span class="stringliteral">&#39;name&#39;</span>], $child_element[<span class="stringliteral">&#39;attribs&#39;</span>]);</div>
<div class="line"><a name="l24444"></a><span class="lineno">24444</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l24445"></a><span class="lineno">24445</span>&#160;                    <span class="keywordflow">if</span> (isset($child_element[<span class="stringliteral">&#39;attribs&#39;</span>][<span class="stringliteral">&#39;content&#39;</span>])) {</div>
<div class="line"><a name="l24446"></a><span class="lineno">24446</span>&#160;                        $this-&gt;svgtext = $child_element[<span class="stringliteral">&#39;attribs&#39;</span>][<span class="stringliteral">&#39;content&#39;</span>];</div>
<div class="line"><a name="l24447"></a><span class="lineno">24447</span>&#160;                    }</div>
<div class="line"><a name="l24448"></a><span class="lineno">24448</span>&#160;                    $this-&gt;endSVGElementHandler(<span class="stringliteral">&#39;child-tag&#39;</span>, $child_element[<span class="stringliteral">&#39;name&#39;</span>]);</div>
<div class="line"><a name="l24449"></a><span class="lineno">24449</span>&#160;                }</div>
<div class="line"><a name="l24450"></a><span class="lineno">24450</span>&#160;            }</div>
<div class="line"><a name="l24451"></a><span class="lineno">24451</span>&#160;        }</div>
<div class="line"><a name="l24452"></a><span class="lineno">24452</span>&#160;    }</div>
<div class="line"><a name="l24453"></a><span class="lineno">24453</span>&#160;</div>
<div class="line"><a name="l24462"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a07c49fa22978666529a6f66a8b8cb87f">24462</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a07c49fa22978666529a6f66a8b8cb87f">endSVGElementHandler</a>($parser, $name) {</div>
<div class="line"><a name="l24463"></a><span class="lineno">24463</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;svgdefsmode AND !in_array($name, array(<span class="stringliteral">&#39;defs&#39;</span>, <span class="stringliteral">&#39;clipPath&#39;</span>, <span class="stringliteral">&#39;linearGradient&#39;</span>, <span class="stringliteral">&#39;radialGradient&#39;</span>, <span class="stringliteral">&#39;stop&#39;</span>))) {;</div>
<div class="line"><a name="l24464"></a><span class="lineno">24464</span>&#160;            <span class="keywordflow">if</span> (end($this-&gt;svgdefs) !== FALSE) {</div>
<div class="line"><a name="l24465"></a><span class="lineno">24465</span>&#160;                $last_svgdefs_id = key($this-&gt;svgdefs);</div>
<div class="line"><a name="l24466"></a><span class="lineno">24466</span>&#160;                <span class="keywordflow">if</span> (isset($this-&gt;svgdefs[$last_svgdefs_id][<span class="stringliteral">&#39;attribs&#39;</span>][<span class="stringliteral">&#39;child_elements&#39;</span>])) {</div>
<div class="line"><a name="l24467"></a><span class="lineno">24467</span>&#160;                    <span class="keywordflow">foreach</span>($this-&gt;svgdefs[$last_svgdefs_id][<span class="stringliteral">&#39;attribs&#39;</span>][<span class="stringliteral">&#39;child_elements&#39;</span>] as $child_element) {</div>
<div class="line"><a name="l24468"></a><span class="lineno">24468</span>&#160;                        <span class="keywordflow">if</span> (isset($child_element[<span class="stringliteral">&#39;attribs&#39;</span>][<span class="stringliteral">&#39;id&#39;</span>]) AND ($child_element[<span class="stringliteral">&#39;name&#39;</span>] == $name)) {</div>
<div class="line"><a name="l24469"></a><span class="lineno">24469</span>&#160;                            $this-&gt;svgdefs[$last_svgdefs_id][<span class="stringliteral">&#39;attribs&#39;</span>][<span class="stringliteral">&#39;child_elements&#39;</span>][$child_element[<span class="stringliteral">&#39;attribs&#39;</span>][<span class="stringliteral">&#39;id&#39;</span>].<span class="stringliteral">&#39;_CLOSE&#39;</span>] = array(<span class="stringliteral">&#39;name&#39;</span> =&gt; $name, <span class="stringliteral">&#39;attribs&#39;</span> =&gt; array(<span class="stringliteral">&#39;closing_tag&#39;</span> =&gt; TRUE, <span class="stringliteral">&#39;content&#39;</span> =&gt; $this-&gt;svgtext));</div>
<div class="line"><a name="l24470"></a><span class="lineno">24470</span>&#160;                            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l24471"></a><span class="lineno">24471</span>&#160;                        }</div>
<div class="line"><a name="l24472"></a><span class="lineno">24472</span>&#160;                    }</div>
<div class="line"><a name="l24473"></a><span class="lineno">24473</span>&#160;                    <span class="keywordflow">if</span> ($this-&gt;svgdefs[$last_svgdefs_id][<span class="stringliteral">&#39;name&#39;</span>] == $name) {</div>
<div class="line"><a name="l24474"></a><span class="lineno">24474</span>&#160;                        $this-&gt;svgdefs[$last_svgdefs_id][<span class="stringliteral">&#39;attribs&#39;</span>][<span class="stringliteral">&#39;child_elements&#39;</span>][$last_svgdefs_id.<span class="stringliteral">&#39;_CLOSE&#39;</span>] = array(<span class="stringliteral">&#39;name&#39;</span> =&gt; $name, <span class="stringliteral">&#39;attribs&#39;</span> =&gt; array(<span class="stringliteral">&#39;closing_tag&#39;</span> =&gt; TRUE, <span class="stringliteral">&#39;content&#39;</span> =&gt; $this-&gt;svgtext));</div>
<div class="line"><a name="l24475"></a><span class="lineno">24475</span>&#160;                        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l24476"></a><span class="lineno">24476</span>&#160;                    }</div>
<div class="line"><a name="l24477"></a><span class="lineno">24477</span>&#160;                }</div>
<div class="line"><a name="l24478"></a><span class="lineno">24478</span>&#160;            }</div>
<div class="line"><a name="l24479"></a><span class="lineno">24479</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l24480"></a><span class="lineno">24480</span>&#160;        }</div>
<div class="line"><a name="l24481"></a><span class="lineno">24481</span>&#160;        <span class="keywordflow">switch</span>($name) {</div>
<div class="line"><a name="l24482"></a><span class="lineno">24482</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;defs&#39;</span>: {</div>
<div class="line"><a name="l24483"></a><span class="lineno">24483</span>&#160;                $this-&gt;svgdefsmode = <span class="keyword">false</span>;</div>
<div class="line"><a name="l24484"></a><span class="lineno">24484</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l24485"></a><span class="lineno">24485</span>&#160;            }</div>
<div class="line"><a name="l24486"></a><span class="lineno">24486</span>&#160;            <span class="comment">// clipPath</span></div>
<div class="line"><a name="l24487"></a><span class="lineno">24487</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;clipPath&#39;</span>: {</div>
<div class="line"><a name="l24488"></a><span class="lineno">24488</span>&#160;                $this-&gt;svgclipmode = <span class="keyword">false</span>;</div>
<div class="line"><a name="l24489"></a><span class="lineno">24489</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l24490"></a><span class="lineno">24490</span>&#160;            }</div>
<div class="line"><a name="l24491"></a><span class="lineno">24491</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;g&#39;</span>: {</div>
<div class="line"><a name="l24492"></a><span class="lineno">24492</span>&#160;                <span class="comment">// ungroup: remove last style from array</span></div>
<div class="line"><a name="l24493"></a><span class="lineno">24493</span>&#160;                array_pop($this-&gt;svgstyles);</div>
<div class="line"><a name="l24494"></a><span class="lineno">24494</span>&#160;                $this-&gt;StopTransform();</div>
<div class="line"><a name="l24495"></a><span class="lineno">24495</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l24496"></a><span class="lineno">24496</span>&#160;            }</div>
<div class="line"><a name="l24497"></a><span class="lineno">24497</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;text&#39;</span>:</div>
<div class="line"><a name="l24498"></a><span class="lineno">24498</span>&#160;            <span class="keywordflow">case</span> <span class="stringliteral">&#39;tspan&#39;</span>: {</div>
<div class="line"><a name="l24499"></a><span class="lineno">24499</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;svgtextmode[<span class="stringliteral">&#39;invisible&#39;</span>]) {</div>
<div class="line"><a name="l24500"></a><span class="lineno">24500</span>&#160;                    <span class="comment">// This implementation must be fixed to following the rule:</span></div>
<div class="line"><a name="l24501"></a><span class="lineno">24501</span>&#160;                    <span class="comment">// If the &#39;visibility&#39; property is set to hidden on a &#39;tspan&#39;, &#39;tref&#39; or &#39;altGlyph&#39; element, then the text is invisible but still takes up space in text layout calculations.</span></div>
<div class="line"><a name="l24502"></a><span class="lineno">24502</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l24503"></a><span class="lineno">24503</span>&#160;                }</div>
<div class="line"><a name="l24504"></a><span class="lineno">24504</span>&#160;                <span class="comment">// print text</span></div>
<div class="line"><a name="l24505"></a><span class="lineno">24505</span>&#160;                $text = $this-&gt;svgtext;</div>
<div class="line"><a name="l24506"></a><span class="lineno">24506</span>&#160;                <span class="comment">//$text = $this-&gt;stringTrim($text);</span></div>
<div class="line"><a name="l24507"></a><span class="lineno">24507</span>&#160;                $textlen = $this-&gt;GetStringWidth($text);</div>
<div class="line"><a name="l24508"></a><span class="lineno">24508</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;svgtextmode[<span class="stringliteral">&#39;text-anchor&#39;</span>] != <span class="stringliteral">&#39;start&#39;</span>) {</div>
<div class="line"><a name="l24509"></a><span class="lineno">24509</span>&#160;                    <span class="comment">// check if string is RTL text</span></div>
<div class="line"><a name="l24510"></a><span class="lineno">24510</span>&#160;                    <span class="keywordflow">if</span> ($this-&gt;svgtextmode[<span class="stringliteral">&#39;text-anchor&#39;</span>] == <span class="stringliteral">&#39;end&#39;</span>) {</div>
<div class="line"><a name="l24511"></a><span class="lineno">24511</span>&#160;                        <span class="keywordflow">if</span> ($this-&gt;svgtextmode[<span class="stringliteral">&#39;rtl&#39;</span>]) {</div>
<div class="line"><a name="l24512"></a><span class="lineno">24512</span>&#160;                            $this-&gt;x += $textlen;</div>
<div class="line"><a name="l24513"></a><span class="lineno">24513</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l24514"></a><span class="lineno">24514</span>&#160;                            $this-&gt;x -= $textlen;</div>
<div class="line"><a name="l24515"></a><span class="lineno">24515</span>&#160;                        }</div>
<div class="line"><a name="l24516"></a><span class="lineno">24516</span>&#160;                    } elseif ($this-&gt;svgtextmode[<span class="stringliteral">&#39;text-anchor&#39;</span>] == <span class="stringliteral">&#39;middle&#39;</span>) {</div>
<div class="line"><a name="l24517"></a><span class="lineno">24517</span>&#160;                        <span class="keywordflow">if</span> ($this-&gt;svgtextmode[<span class="stringliteral">&#39;rtl&#39;</span>]) {</div>
<div class="line"><a name="l24518"></a><span class="lineno">24518</span>&#160;                            $this-&gt;x += ($textlen / 2);</div>
<div class="line"><a name="l24519"></a><span class="lineno">24519</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l24520"></a><span class="lineno">24520</span>&#160;                            $this-&gt;x -= ($textlen / 2);</div>
<div class="line"><a name="l24521"></a><span class="lineno">24521</span>&#160;                        }</div>
<div class="line"><a name="l24522"></a><span class="lineno">24522</span>&#160;                    }</div>
<div class="line"><a name="l24523"></a><span class="lineno">24523</span>&#160;                }</div>
<div class="line"><a name="l24524"></a><span class="lineno">24524</span>&#160;                $textrendermode = $this-&gt;textrendermode;</div>
<div class="line"><a name="l24525"></a><span class="lineno">24525</span>&#160;                $textstrokewidth = $this-&gt;textstrokewidth;</div>
<div class="line"><a name="l24526"></a><span class="lineno">24526</span>&#160;                $this-&gt;setTextRenderingMode($this-&gt;svgtextmode[<span class="stringliteral">&#39;stroke&#39;</span>], <span class="keyword">true</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l24527"></a><span class="lineno">24527</span>&#160;                <span class="keywordflow">if</span> ($name == <span class="stringliteral">&#39;text&#39;</span>) {</div>
<div class="line"><a name="l24528"></a><span class="lineno">24528</span>&#160;                    <span class="comment">// store current coordinates</span></div>
<div class="line"><a name="l24529"></a><span class="lineno">24529</span>&#160;                    $tmpx = $this-&gt;x;</div>
<div class="line"><a name="l24530"></a><span class="lineno">24530</span>&#160;                    $tmpy = $this-&gt;y;</div>
<div class="line"><a name="l24531"></a><span class="lineno">24531</span>&#160;                }</div>
<div class="line"><a name="l24532"></a><span class="lineno">24532</span>&#160;                $this-&gt;Cell($textlen, 0, $text, 0, 0, <span class="stringliteral">&#39;&#39;</span>, <span class="keyword">false</span>, <span class="stringliteral">&#39;&#39;</span>, 0, <span class="keyword">false</span>, <span class="charliteral">&#39;L&#39;</span>, <span class="charliteral">&#39;T&#39;</span>);</div>
<div class="line"><a name="l24533"></a><span class="lineno">24533</span>&#160;                <span class="keywordflow">if</span> ($name == <span class="stringliteral">&#39;text&#39;</span>) {</div>
<div class="line"><a name="l24534"></a><span class="lineno">24534</span>&#160;                    <span class="comment">// restore coordinates</span></div>
<div class="line"><a name="l24535"></a><span class="lineno">24535</span>&#160;                    $this-&gt;x = $tmpx;</div>
<div class="line"><a name="l24536"></a><span class="lineno">24536</span>&#160;                    $this-&gt;y = $tmpy;</div>
<div class="line"><a name="l24537"></a><span class="lineno">24537</span>&#160;                }</div>
<div class="line"><a name="l24538"></a><span class="lineno">24538</span>&#160;                <span class="comment">// restore previous rendering mode</span></div>
<div class="line"><a name="l24539"></a><span class="lineno">24539</span>&#160;                $this-&gt;textrendermode = $textrendermode;</div>
<div class="line"><a name="l24540"></a><span class="lineno">24540</span>&#160;                $this-&gt;textstrokewidth = $textstrokewidth;</div>
<div class="line"><a name="l24541"></a><span class="lineno">24541</span>&#160;                $this-&gt;svgtext = <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l24542"></a><span class="lineno">24542</span>&#160;                $this-&gt;StopTransform();</div>
<div class="line"><a name="l24543"></a><span class="lineno">24543</span>&#160;                <span class="keywordflow">if</span> (!$this-&gt;svgdefsmode) {</div>
<div class="line"><a name="l24544"></a><span class="lineno">24544</span>&#160;                    array_pop($this-&gt;svgstyles);</div>
<div class="line"><a name="l24545"></a><span class="lineno">24545</span>&#160;                }</div>
<div class="line"><a name="l24546"></a><span class="lineno">24546</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l24547"></a><span class="lineno">24547</span>&#160;            }</div>
<div class="line"><a name="l24548"></a><span class="lineno">24548</span>&#160;            <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l24549"></a><span class="lineno">24549</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l24550"></a><span class="lineno">24550</span>&#160;            }</div>
<div class="line"><a name="l24551"></a><span class="lineno">24551</span>&#160;        }</div>
<div class="line"><a name="l24552"></a><span class="lineno">24552</span>&#160;    }</div>
<div class="line"><a name="l24553"></a><span class="lineno">24553</span>&#160;</div>
<div class="line"><a name="l24562"></a><span class="lineno"><a class="line" href="../../d4/d40/classTCPDF.html#a35562c18384ac908528a044e4d1c3d60">24562</a></span>&#160;    <span class="keyword">protected</span> <span class="keyword">function</span> <a class="code" href="../../d4/d40/classTCPDF.html#a35562c18384ac908528a044e4d1c3d60">segSVGContentHandler</a>($parser, $data) {</div>
<div class="line"><a name="l24563"></a><span class="lineno">24563</span>&#160;        $this-&gt;svgtext .= $data;</div>
<div class="line"><a name="l24564"></a><span class="lineno">24564</span>&#160;    }</div>
<div class="line"><a name="l24565"></a><span class="lineno">24565</span>&#160;</div>
<div class="line"><a name="l24566"></a><span class="lineno">24566</span>&#160;    <span class="comment">// --- END SVG METHODS -----------------------------------------------------</span></div>
<div class="line"><a name="l24567"></a><span class="lineno">24567</span>&#160;</div>
<div class="line"><a name="l24568"></a><span class="lineno">24568</span>&#160;} <span class="comment">// END OF TCPDF CLASS</span></div>
<div class="line"><a name="l24569"></a><span class="lineno">24569</span>&#160;</div>
<div class="line"><a name="l24570"></a><span class="lineno">24570</span>&#160;<span class="comment">//============================================================+</span></div>
<div class="line"><a name="l24571"></a><span class="lineno">24571</span>&#160;<span class="comment">// END OF FILE</span></div>
<div class="line"><a name="l24572"></a><span class="lineno">24572</span>&#160;<span class="comment">//============================================================+</span></div>
<div class="ttc" id="classTCPDF_html_a4816d61822a4bad6e35bb441c1699aab"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a4816d61822a4bad6e35bb441c1699aab">TCPDF\write1DBarcode</a></div><div class="ttdeci">write1DBarcode($code, $type, $x='', $y='', $w='', $h='', $xres='', $style='', $align='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l15315">tcpdf.php:15315</a></div></div>
<div class="ttc" id="classTCPDF_html_a2a0c1bccf252929e1d46725e97cfefdf"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a2a0c1bccf252929e1d46725e97cfefdf">TCPDF\$page_boxes</a></div><div class="ttdeci">$page_boxes</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01809">tcpdf.php:1809</a></div></div>
<div class="ttc" id="classTCPDF_html_aae395cced777e52fac95cbbba28af98a"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aae395cced777e52fac95cbbba28af98a">TCPDF\RoundedRectXY</a></div><div class="ttdeci">RoundedRectXY($x, $y, $w, $h, $rx, $ry, $round_corner='1111', $style='', $border_style=array(), $fill_color=array())</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l12189">tcpdf.php:12189</a></div></div>
<div class="ttc" id="classTCPDF_html_abb054390914b3cb23d207f4c36f0395c"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#abb054390914b3cb23d207f4c36f0395c">TCPDF\getGroupPageNo</a></div><div class="ttdeci">getGroupPageNo()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l13786">tcpdf.php:13786</a></div></div>
<div class="ttc" id="classTCPDF_html_a10215105777b306528a827f3669e936e"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a10215105777b306528a827f3669e936e">TCPDF\resetLastH</a></div><div class="ttdeci">resetLastH()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02446">tcpdf.php:2446</a></div></div>
<div class="ttc" id="classTCPDF_html_af7f6494da3088dec66ca1172c546c9e2"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#af7f6494da3088dec66ca1172c546c9e2">TCPDF\$column_start_page</a></div><div class="ttdeci">$column_start_page</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01450">tcpdf.php:1450</a></div></div>
<div class="ttc" id="classTCPDF_html_aa389d4419c77510dc3998f0af78d8a00"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aa389d4419c77510dc3998f0af78d8a00">TCPDF\setPageFormat</a></div><div class="ttdeci">setPageFormat($format, $orientation='P')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02109">tcpdf.php:2109</a></div></div>
<div class="ttc" id="classTCPDF_html_a9eeb118916ac86a5441ca15a24a243f2"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a9eeb118916ac86a5441ca15a24a243f2">TCPDF\$footerpos</a></div><div class="ttdeci">$footerpos</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00980">tcpdf.php:980</a></div></div>
<div class="ttc" id="classTCPDF_html_a5addd56687b7a3d97f6abac7c7cdb253"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a5addd56687b7a3d97f6abac7c7cdb253">TCPDF\__destruct</a></div><div class="ttdeci">__destruct()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02002">tcpdf.php:2002</a></div></div>
<div class="ttc" id="classTCPDF_html_ae8f57f5a0dc2a796269772b2cd490c5e"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ae8f57f5a0dc2a796269772b2cd490c5e">TCPDF\$PageBreakTrigger</a></div><div class="ttdeci">$PageBreakTrigger</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00452">tcpdf.php:452</a></div></div>
<div class="ttc" id="classTCPDF_html_ac1fbdc28360fd6efe6539755b08b321e"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ac1fbdc28360fd6efe6539755b08b321e">TCPDF\$radiobutton_groups</a></div><div class="ttdeci">$radiobutton_groups</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01387">tcpdf.php:1387</a></div></div>
<div class="ttc" id="classTCPDF_html_a8038a0a2a6d0b98e1b86307a6f9ded1f"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a8038a0a2a6d0b98e1b86307a6f9ded1f">TCPDF\$header_line_color</a></div><div class="ttdeci">$header_line_color</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00669">tcpdf.php:669</a></div></div>
<div class="ttc" id="classTCPDF_html_a1de30d6f895d9fb9722f4440d9ae82d7"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a1de30d6f895d9fb9722f4440d9ae82d7">TCPDF\_putocg</a></div><div class="ttdeci">_putocg()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l13815">tcpdf.php:13815</a></div></div>
<div class="ttc" id="classTCPDF_html_ade7bced891aaa3b0a5ce236eb7a5c8ba"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ade7bced891aaa3b0a5ce236eb7a5c8ba">TCPDF\$TextColor</a></div><div class="ttdeci">$TextColor</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00434">tcpdf.php:434</a></div></div>
<div class="ttc" id="classTCPDF_html_affd380e0adfc726dbc519860de0b175c"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#affd380e0adfc726dbc519860de0b175c">TCPDF\$encrypted</a></div><div class="ttdeci">$encrypted</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00801">tcpdf.php:801</a></div></div>
<div class="ttc" id="classTCPDF_html_ae4a86c2e1ba1b7026fbfb1eb43845f1a"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ae4a86c2e1ba1b7026fbfb1eb43845f1a">TCPDF\$alpha</a></div><div class="ttdeci">$alpha</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01802">tcpdf.php:1802</a></div></div>
<div class="ttc" id="classTCPDF_html_ad5303676c4d5a355672dd599eb263a50"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ad5303676c4d5a355672dd599eb263a50">TCPDF\addTOCPage</a></div><div class="ttdeci">addTOCPage($orientation='', $format='', $keepmargins=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l03083">tcpdf.php:3083</a></div></div>
<div class="ttc" id="classTCPDF_html_a2ea842192062587293c25981098c820c"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a2ea842192062587293c25981098c820c">TCPDF\Close</a></div><div class="ttdeci">Close()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02957">tcpdf.php:2957</a></div></div>
<div class="ttc" id="classTCPDF_html_a06a80145927b40683b26d9013ec8d3c6"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a06a80145927b40683b26d9013ec8d3c6">TCPDF\setJPEGQuality</a></div><div class="ttdeci">setJPEGQuality($quality)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l14069">tcpdf.php:14069</a></div></div>
<div class="ttc" id="classTCPDF_html_ac4f7fe7f2836e624fb0317f75a74236b"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ac4f7fe7f2836e624fb0317f75a74236b">TCPDF\_putshaders</a></div><div class="ttdeci">_putshaders()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l14695">tcpdf.php:14695</a></div></div>
<div class="ttc" id="classTCPDF_html_a17c2f9d587880ac42a8bb8638bd05811"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a17c2f9d587880ac42a8bb8638bd05811">TCPDF\$tagvspaces</a></div><div class="ttdeci">$tagvspaces</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01099">tcpdf.php:1099</a></div></div>
<div class="ttc" id="classTCPDF_html_a83d9c1f132f0147413259259b4a2ca7d"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a83d9c1f132f0147413259259b4a2ca7d">TCPDF\setFooterMargin</a></div><div class="ttdeci">setFooterMargin($fm=10)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l03327">tcpdf.php:3327</a></div></div>
<div class="ttc" id="classTCPDF_html_a2803ddf7b83704355bcf1225f06cfcbb"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a2803ddf7b83704355bcf1225f06cfcbb">TCPDF\setPDFVersion</a></div><div class="ttdeci">setPDFVersion($version='1.7')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l14111">tcpdf.php:14111</a></div></div>
<div class="ttc" id="classTCPDF_html_a63318e9e32a06621bb98c59cd660a835"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a63318e9e32a06621bb98c59cd660a835">TCPDF\ImagePngAlpha</a></div><div class="ttdeci">ImagePngAlpha($file, $x, $y, $wpx, $hpx, $w, $h, $type, $link, $align, $resize, $dpi, $palign, $filehash='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l07272">tcpdf.php:7272</a></div></div>
<div class="ttc" id="classTCPDF_html_a2111c4472eae611423616d58c1e85430"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a2111c4472eae611423616d58c1e85430">TCPDF\$pagelen</a></div><div class="ttdeci">$pagelen</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01163">tcpdf.php:1163</a></div></div>
<div class="ttc" id="classTCPDF_html_a32dee1790e5a2b68404a76c117872b57"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a32dee1790e5a2b68404a76c117872b57">TCPDF\getNumberOfColumns</a></div><div class="ttdeci">getNumberOfColumns()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l22035">tcpdf.php:22035</a></div></div>
<div class="ttc" id="classTCPDF_html_a12227210f010059895875006d839f318"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a12227210f010059895875006d839f318">TCPDF\$file_id</a></div><div class="ttdeci">$file_id</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00829">tcpdf.php:829</a></div></div>
<div class="ttc" id="classTCPDF_html_a1651570142db46f184f83373fbd72a04"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a1651570142db46f184f83373fbd72a04">TCPDF\_putviewerpreferences</a></div><div class="ttdeci">_putviewerpreferences()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l09900">tcpdf.php:9900</a></div></div>
<div class="ttc" id="classTCPDF_html_ae46a35098766581d1ad9ba173b17da5f"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ae46a35098766581d1ad9ba173b17da5f">TCPDF\$bgcolor</a></div><div class="ttdeci">$bgcolor</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00752">tcpdf.php:752</a></div></div>
<div class="ttc" id="classTCPDF_html_a62459f3a2f6d85c0deb15f1f0ad30d0b"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a62459f3a2f6d85c0deb15f1f0ad30d0b">TCPDF\$svgdefsmode</a></div><div class="ttdeci">$svgdefsmode</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01631">tcpdf.php:1631</a></div></div>
<div class="ttc" id="classTCPDF_html_a708b96db375900604367c3fe1e0df118"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a708b96db375900604367c3fe1e0df118">TCPDF\$empty_signature_appearance</a></div><div class="ttdeci">$empty_signature_appearance</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01289">tcpdf.php:1289</a></div></div>
<div class="ttc" id="classTCPDF_html_ad00f8a524481e110dd8b6da59934252c"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ad00f8a524481e110dd8b6da59934252c">TCPDF\getFontSubsetting</a></div><div class="ttdeci">getFontSubsetting()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l22332">tcpdf.php:22332</a></div></div>
<div class="ttc" id="classTCPDF_html_ae34b176081245381bd47ba322a3a522e"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ae34b176081245381bd47ba322a3a522e">TCPDF\getCellPaddings</a></div><div class="ttdeci">getCellPaddings()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02674">tcpdf.php:2674</a></div></div>
<div class="ttc" id="classTCPDF_html_a8b80c7e5aae2bc717b469eda5ee755fd"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a8b80c7e5aae2bc717b469eda5ee755fd">TCPDF\setColor</a></div><div class="ttdeci">setColor($type, $col1=0, $col2=-1, $col3=-1, $col4=-1, $ret=false, $name='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l03898">tcpdf.php:3898</a></div></div>
<div class="ttc" id="classTCPDF_html_a0e0245500627af0752a6954ec348fa92"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a0e0245500627af0752a6954ec348fa92">TCPDF\$listcount</a></div><div class="ttdeci">$listcount</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00728">tcpdf.php:728</a></div></div>
<div class="ttc" id="classTCPDF_html_a188a10529c5479241c1403f2d438e861"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a188a10529c5479241c1403f2d438e861">TCPDF\setLastH</a></div><div class="ttdeci">setLastH($h)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02423">tcpdf.php:2423</a></div></div>
<div class="ttc" id="classTCPDF_html_aef5168b3e7714914541a1632f5eeb01b"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aef5168b3e7714914541a1632f5eeb01b">TCPDF\_putresourcedict</a></div><div class="ttdeci">_putresourcedict()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l09427">tcpdf.php:9427</a></div></div>
<div class="ttc" id="classTCPDF_html_aa2a1cf622454f1a9931b2f79fab0f98f"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aa2a1cf622454f1a9931b2f79fab0f98f">TCPDF\$tocpage</a></div><div class="ttdeci">$tocpage</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01498">tcpdf.php:1498</a></div></div>
<div class="ttc" id="classTCPDF_html_ab87bf1826384fbfe30eb499d42f1d994"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ab87bf1826384fbfe30eb499d42f1d994">TCPDF\Link</a></div><div class="ttdeci">Link($x, $y, $w, $h, $link, $spaces=0)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l04760">tcpdf.php:4760</a></div></div>
<div class="ttc" id="classTCPDF_html_ac9dc6318fd217971aff282532ab91e43"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ac9dc6318fd217971aff282532ab91e43">TCPDF\GetNumChars</a></div><div class="ttdeci">GetNumChars($s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l04141">tcpdf.php:4141</a></div></div>
<div class="ttc" id="classTCPDF_html_aee22655aad0ae32a3194298585da16a2"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aee22655aad0ae32a3194298585da16a2">TCPDF\setHeaderFont</a></div><div class="ttdeci">setHeaderFont($font)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l10418">tcpdf.php:10418</a></div></div>
<div class="ttc" id="classTCPDF_html_abad599cd85cc60cbe9cbb7765ccfb535"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#abad599cd85cc60cbe9cbb7765ccfb535">TCPDF\SetFillColor</a></div><div class="ttdeci">SetFillColor($col1=0, $col2=-1, $col3=-1, $col4=-1, $ret=false, $name='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l04005">tcpdf.php:4005</a></div></div>
<div class="ttc" id="classTCPDF_html_a24d3c102468b6ab9d2f4859a8b01863a"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a24d3c102468b6ab9d2f4859a8b01863a">TCPDF\getGraphicVars</a></div><div class="ttdeci">getGraphicVars()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l20626">tcpdf.php:20626</a></div></div>
<div class="ttc" id="classTCPDF_html_a553f8a9bbb5301f983ebfd64544cb7a8"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a553f8a9bbb5301f983ebfd64544cb7a8">TCPDF\Header</a></div><div class="ttdeci">Header()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l03398">tcpdf.php:3398</a></div></div>
<div class="ttc" id="classTCPDF_html_a471562985997be1573d387f0aeae6964"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a471562985997be1573d387f0aeae6964">TCPDF\addTTFfont</a></div><div class="ttdeci">addTTFfont($fontfile, $fonttype='', $enc='', $flags=32, $outpath='', $platid=3, $encid=1, $addcbbox=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l04192">tcpdf.php:4192</a></div></div>
<div class="ttc" id="classTCPDF_html_a61840390b5ae16c58b1b6bd6b060af46"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a61840390b5ae16c58b1b6bd6b060af46">TCPDF\$buffer</a></div><div class="ttdeci">$buffer</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00166">tcpdf.php:166</a></div></div>
<div class="ttc" id="classTCPDF_html_a26a8652b0892c721a2904e0b3676682e"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a26a8652b0892c721a2904e0b3676682e">TCPDF\$page_regions</a></div><div class="ttdeci">$page_regions</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01562">tcpdf.php:1562</a></div></div>
<div class="ttc" id="classTCPDF_html_ae87d16aa348205f2a1654cc2ac42367c"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ae87d16aa348205f2a1654cc2ac42367c">TCPDF\getFontsList</a></div><div class="ttdeci">getFontsList()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l04153">tcpdf.php:4153</a></div></div>
<div class="ttc" id="classTCPDF_html_a321e26613df419d2d216805fa7405d68"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a321e26613df419d2d216805fa7405d68">TCPDF\$linestyleJoin</a></div><div class="ttdeci">$linestyleJoin</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01022">tcpdf.php:1022</a></div></div>
<div class="ttc" id="classTCPDF_html_a569179128414ccd12d17e0c7cbbd121f"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a569179128414ccd12d17e0c7cbbd121f">TCPDF\$svgclipmode</a></div><div class="ttdeci">$svgclipmode</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01645">tcpdf.php:1645</a></div></div>
<div class="ttc" id="classTCPDF_html_ab2887c4ed584490249c4964a4ec0e2fc"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ab2887c4ed584490249c4964a4ec0e2fc">TCPDF\$form_obj_id</a></div><div class="ttdeci">$form_obj_id</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01338">tcpdf.php:1338</a></div></div>
<div class="ttc" id="classTCPDF_html_acbeb582e8fb3a6771c5d7c1279966ddb"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#acbeb582e8fb3a6771c5d7c1279966ddb">TCPDF\$fonts</a></div><div class="ttdeci">$fonts</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00324">tcpdf.php:324</a></div></div>
<div class="ttc" id="classTCPDF_html_ac9c37f99a7bbc56109a019f4d5fab568"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ac9c37f99a7bbc56109a019f4d5fab568">TCPDF\addJavascriptObject</a></div><div class="ttdeci">addJavascriptObject($script, $onload=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l12624">tcpdf.php:12624</a></div></div>
<div class="ttc" id="classTCPDF_html_ab0a7280484f906a0b2d58e3a15dbb469"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ab0a7280484f906a0b2d58e3a15dbb469">TCPDF\_outPoint</a></div><div class="ttdeci">_outPoint($x, $y)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l11502">tcpdf.php:11502</a></div></div>
<div class="ttc" id="classTCPDF_html_a55b5b6cb30c082e93dfdcddb1d7fb41b"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a55b5b6cb30c082e93dfdcddb1d7fb41b">TCPDF\$underline</a></div><div class="ttdeci">$underline</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00392">tcpdf.php:392</a></div></div>
<div class="ttc" id="classTCPDF_html_abb955184ddd592fdfa3c29f4cc34bc69"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#abb955184ddd592fdfa3c29f4cc34bc69">TCPDF\setSVGStyles</a></div><div class="ttdeci">setSVGStyles($svgstyle, $prevsvgstyle, $x=0, $y=0, $w=1, $h=1, $clip_function='', $clip_params=array())</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l23247">tcpdf.php:23247</a></div></div>
<div class="ttc" id="classTCPDF_html_a6df400b01d3ec1579e1e925b98c31d5f"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a6df400b01d3ec1579e1e925b98c31d5f">TCPDF\SetFontSize</a></div><div class="ttdeci">SetFontSize($size, $out=true)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l04493">tcpdf.php:4493</a></div></div>
<div class="ttc" id="classTCPDF_html_a70437676b6ee2c9ff985b38d5789fb90"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a70437676b6ee2c9ff985b38d5789fb90">TCPDF\getHeaderData</a></div><div class="ttdeci">getHeaderData()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l03290">tcpdf.php:3290</a></div></div>
<div class="ttc" id="classTCPDF_html_aef2a1b2504a6605d63e5851c01839149"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aef2a1b2504a6605d63e5851c01839149">TCPDF\applyTSA</a></div><div class="ttdeci">applyTSA($signature)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l13663">tcpdf.php:13663</a></div></div>
<div class="ttc" id="classTCPDF_html_aa41b8f844cab4dccdfa5f34cb667c46a"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aa41b8f844cab4dccdfa5f34cb667c46a">TCPDF\MirrorP</a></div><div class="ttdeci">MirrorP($x='', $y='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l11207">tcpdf.php:11207</a></div></div>
<div class="ttc" id="classTCPDF_html_ad99d9dea88f659fedf9fe11f30586a99"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ad99d9dea88f659fedf9fe11f30586a99">TCPDF\SetDisplayMode</a></div><div class="ttdeci">SetDisplayMode($zoom, $layout='SinglePage', $mode='UseNone')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02820">tcpdf.php:2820</a></div></div>
<div class="ttc" id="classTCPDF_html_afb1dec1e7e779c6bf5869c3ab7a295ed"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#afb1dec1e7e779c6bf5869c3ab7a295ed">TCPDF\$signature_data</a></div><div class="ttdeci">$signature_data</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01268">tcpdf.php:1268</a></div></div>
<div class="ttc" id="classTCPDF_html_a797b9be1f9c2d031e5dce8c5b3a9e27c"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a797b9be1f9c2d031e5dce8c5b3a9e27c">TCPDF\startTransaction</a></div><div class="ttdeci">startTransaction()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l21824">tcpdf.php:21824</a></div></div>
<div class="ttc" id="classTCPDF_html_a94ed72c3dc79bd9436fd02ad6de955a1"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a94ed72c3dc79bd9436fd02ad6de955a1">TCPDF\setHeaderTemplateAutoreset</a></div><div class="ttdeci">setHeaderTemplateAutoreset($val=true)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l03389">tcpdf.php:3389</a></div></div>
<div class="ttc" id="classTCPDF_html_a93f18d686b7db10133a76317bfbb0d59"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a93f18d686b7db10133a76317bfbb0d59">TCPDF\Button</a></div><div class="ttdeci">Button($name, $w, $h, $caption, $action, $prop=array(), $opt=array(), $x='', $y='', $js=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l13240">tcpdf.php:13240</a></div></div>
<div class="ttc" id="classTCPDF_html_a215c81355915eff7d0c1586013591b75"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a215c81355915eff7d0c1586013591b75">TCPDF\TranslateX</a></div><div class="ttdeci">TranslateX($t_x)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l11232">tcpdf.php:11232</a></div></div>
<div class="ttc" id="classTCPDF_html_a71d382a4356e7fb3f9fa72e53642c09c"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a71d382a4356e7fb3f9fa72e53642c09c">TCPDF\TextField</a></div><div class="ttdeci">TextField($name, $w, $h, $prop=array(), $opt=array(), $x='', $y='', $js=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l12763">tcpdf.php:12763</a></div></div>
<div class="ttc" id="classTCPDF_html_a7b0675e51b6f7ab3e4730feef3c86fb5"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a7b0675e51b6f7ab3e4730feef3c86fb5">TCPDF\setFooter</a></div><div class="ttdeci">setFooter()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l03563">tcpdf.php:3563</a></div></div>
<div class="ttc" id="classTCPDF_html_af623eface3ce63b2bc1709d47c84ab69"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#af623eface3ce63b2bc1709d47c84ab69">TCPDF\_outRestoreGraphicsState</a></div><div class="ttdeci">_outRestoreGraphicsState()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l20759">tcpdf.php:20759</a></div></div>
<div class="ttc" id="classTCPDF_html_ae47afd58a8f71596ad26a55444208b55"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ae47afd58a8f71596ad26a55444208b55">TCPDF\$overline</a></div><div class="ttdeci">$overline</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00398">tcpdf.php:398</a></div></div>
<div class="ttc" id="classTCPDF_html_ad5cecadb5d4b25324516668aaf23c3ca"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ad5cecadb5d4b25324516668aaf23c3ca">TCPDF\$footer_margin</a></div><div class="ttdeci">$footer_margin</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00581">tcpdf.php:581</a></div></div>
<div class="ttc" id="classTCPDF_html_a917bed78601b25201a9c507d841fc538"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a917bed78601b25201a9c507d841fc538">TCPDF\getFontSpacing</a></div><div class="ttdeci">getFontSpacing()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l22700">tcpdf.php:22700</a></div></div>
<div class="ttc" id="classTCPDF_html_a84f86576ad997f0751c81ee45650ee6e"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a84f86576ad997f0751c81ee45650ee6e">TCPDF\setPageBoxTypes</a></div><div class="ttdeci">setPageBoxTypes($boxes)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l07929">tcpdf.php:7929</a></div></div>
<div class="ttc" id="classTCPDF_html_a81fcfeb26eaac6977cb9ade5a0944154"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a81fcfeb26eaac6977cb9ade5a0944154">TCPDF\$tmprtl</a></div><div class="ttdeci">$tmprtl</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00792">tcpdf.php:792</a></div></div>
<div class="ttc" id="classTCPDF_html_ad252eae91d3151b11d1dd15aebe9a4a4"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ad252eae91d3151b11d1dd15aebe9a4a4">TCPDF\$AutoPageBreak</a></div><div class="ttdeci">$AutoPageBreak</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00446">tcpdf.php:446</a></div></div>
<div class="ttc" id="classTCPDF_html_a628e3e22a136173a0bac253ce9842c56"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a628e3e22a136173a0bac253ce9842c56">TCPDF\$FontAscent</a></div><div class="ttdeci">$FontAscent</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00379">tcpdf.php:379</a></div></div>
<div class="ttc" id="classTCPDF_html_a48d90dc02b21b040d95122abf89a2b18"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a48d90dc02b21b040d95122abf89a2b18">TCPDF\$fhPt</a></div><div class="ttdeci">$fhPt</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00214">tcpdf.php:214</a></div></div>
<div class="ttc" id="classTCPDF_html_ac3f2312e2cdab48afc7999ee05ae71cb"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ac3f2312e2cdab48afc7999ee05ae71cb">TCPDF\$n_dests</a></div><div class="ttdeci">$n_dests</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01589">tcpdf.php:1589</a></div></div>
<div class="ttc" id="classTCPDF_html_af57416c0d1b618b2af389b7c651756be"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#af57416c0d1b618b2af389b7c651756be">TCPDF\SetBooklet</a></div><div class="ttdeci">SetBooklet($booklet=true, $inner=-1, $outer=-1)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l20254">tcpdf.php:20254</a></div></div>
<div class="ttc" id="classTCPDF_html_a9e36d6b325764815dd652636ece7eead"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a9e36d6b325764815dd652636ece7eead">TCPDF\setHeader</a></div><div class="ttdeci">setHeader()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l03522">tcpdf.php:3522</a></div></div>
<div class="ttc" id="classTCPDF_html_af8fbad549f0384a7f76fa6db13193075"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#af8fbad549f0384a7f76fa6db13193075">TCPDF\getAllInternalPageNumberAliases</a></div><div class="ttdeci">getAllInternalPageNumberAliases()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l07876">tcpdf.php:7876</a></div></div>
<div class="ttc" id="classTCPDF_html_a0368d51e3742f13e5972b2e2f7d6fd28"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a0368d51e3742f13e5972b2e2f7d6fd28">TCPDF\getImageRBY</a></div><div class="ttdeci">getImageRBY()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l03372">tcpdf.php:3372</a></div></div>
<div class="ttc" id="classTCPDF_html_ae4bdb1a4c29d0a0d707caad308dcd320"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ae4bdb1a4c29d0a0d707caad308dcd320">TCPDF\unhtmlentities</a></div><div class="ttdeci">unhtmlentities($text_to_convert)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l10543">tcpdf.php:10543</a></div></div>
<div class="ttc" id="classTCPDF_html_a465409fb33aa269efd0fc709e1eaef58"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a465409fb33aa269efd0fc709e1eaef58">TCPDF\$footerlen</a></div><div class="ttdeci">$footerlen</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00987">tcpdf.php:987</a></div></div>
<div class="ttc" id="classTCPDF_html_a3d0447ea40384cf67763041a55cf6eca"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a3d0447ea40384cf67763041a55cf6eca">TCPDF\SetDrawColor</a></div><div class="ttdeci">SetDrawColor($col1=0, $col2=-1, $col3=-1, $col4=-1, $ret=false, $name='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l03988">tcpdf.php:3988</a></div></div>
<div class="ttc" id="classTCPDF_html_af75b91429604ea426b2aa255bbff089f"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#af75b91429604ea426b2aa255bbff089f">TCPDF\$fontlist</a></div><div class="ttdeci">$fontlist</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00710">tcpdf.php:710</a></div></div>
<div class="ttc" id="classTCPDF_html_a63acf0babc0299784cbb54354329a734"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a63acf0babc0299784cbb54354329a734">TCPDF\$title</a></div><div class="ttdeci">$title</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00488">tcpdf.php:488</a></div></div>
<div class="ttc" id="classTCPDF_html_aae92c359fcd3d68b063b38de2a92aa51"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aae92c359fcd3d68b063b38de2a92aa51">TCPDF\getScaleFactor</a></div><div class="ttdeci">getScaleFactor()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02553">tcpdf.php:2553</a></div></div>
<div class="ttc" id="classTCPDF_html_a26e2c92f3d3177b8f5508f4724f516a8"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a26e2c92f3d3177b8f5508f4724f516a8">TCPDF\PieSectorXY</a></div><div class="ttdeci">PieSectorXY($xc, $yc, $rx, $ry, $a, $b, $style='FD', $cw=false, $o=0, $nc=2)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l14908">tcpdf.php:14908</a></div></div>
<div class="ttc" id="classTCPDF_html_acd3d7dae873b9873302616698abafcf3"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#acd3d7dae873b9873302616698abafcf3">TCPDF\getCSSPadding</a></div><div class="ttdeci">getCSSPadding($csspadding, $width=0)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l16068">tcpdf.php:16068</a></div></div>
<div class="ttc" id="classTCPDF_html_ac6009bf1f27a31ee208d9687cb4b91eb"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ac6009bf1f27a31ee208d9687cb4b91eb">TCPDF\setFontSubBuffer</a></div><div class="ttdeci">setFontSubBuffer($font, $key, $data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l21006">tcpdf.php:21006</a></div></div>
<div class="ttc" id="classTCPDF_html_ae40eff8871e1deebf4bea96de4d8a3e4"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ae40eff8871e1deebf4bea96de4d8a3e4">TCPDF\Footer</a></div><div class="ttdeci">Footer()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l03475">tcpdf.php:3475</a></div></div>
<div class="ttc" id="classTCPDF_html_a0dba58ac6400cc0701127487b4e8dcf4"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a0dba58ac6400cc0701127487b4e8dcf4">TCPDF\getFontBBox</a></div><div class="ttdeci">getFontBBox()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l04533">tcpdf.php:4533</a></div></div>
<div class="ttc" id="classTCPDF_html_a9612d9b2bafafa217fc425a6dae4e5ac"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a9612d9b2bafafa217fc425a6dae4e5ac">TCPDF\getNumPages</a></div><div class="ttdeci">getNumPages()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l03070">tcpdf.php:3070</a></div></div>
<div class="ttc" id="classTCPDF_html_af34383b2ad0cda65b8327d62065afdbc"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#af34383b2ad0cda65b8327d62065afdbc">TCPDF\$offsets</a></div><div class="ttdeci">$offsets</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00154">tcpdf.php:154</a></div></div>
<div class="ttc" id="classTCPDF_html_a65bfa0bffc92dd5c359c114b837c81c0"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a65bfa0bffc92dd5c359c114b837c81c0">TCPDF\_putpages</a></div><div class="ttdeci">_putpages()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l07942">tcpdf.php:7942</a></div></div>
<div class="ttc" id="classTCPDF_html_a570325299ecf78f328faa53e8758a015"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a570325299ecf78f328faa53e8758a015">TCPDF\_putXMP</a></div><div class="ttdeci">_putXMP()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l09575">tcpdf.php:9575</a></div></div>
<div class="ttc" id="classTCPDF_html_aa9d049671275dc2a39e4654f3028544c"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aa9d049671275dc2a39e4654f3028544c">TCPDF\setFontSpacing</a></div><div class="ttdeci">setFontSpacing($spacing=0)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l22689">tcpdf.php:22689</a></div></div>
<div class="ttc" id="classTCPDF_html_a9ffebab4b2d31f52b7afae1061b4fc4d"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a9ffebab4b2d31f52b7afae1061b4fc4d">TCPDF\$emptypagemrk</a></div><div class="ttdeci">$emptypagemrk</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00966">tcpdf.php:966</a></div></div>
<div class="ttc" id="classTCPDF_html_ab45f86866ef0d753a8fca04dddd63d68"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ab45f86866ef0d753a8fca04dddd63d68">TCPDF\Ellipse</a></div><div class="ttdeci">Ellipse($x0, $y0, $rx, $ry='', $angle=0, $astart=0, $afinish=360, $style='', $line_style=array(), $fill_color=array(), $nc=2)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l11770">tcpdf.php:11770</a></div></div>
<div class="ttc" id="classTCPDF_html_a1df083d5359c42f8b124771f1f92d9fa"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a1df083d5359c42f8b124771f1f92d9fa">TCPDF\SetCreator</a></div><div class="ttdeci">SetCreator($creator)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02917">tcpdf.php:2917</a></div></div>
<div class="ttc" id="classTCPDF_html_a42a44895af6f9c61714d178ec0260267"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a42a44895af6f9c61714d178ec0260267">TCPDF\_putbookmarks</a></div><div class="ttdeci">_putbookmarks()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l12485">tcpdf.php:12485</a></div></div>
<div class="ttc" id="classTCPDF_html_ab1c0ea925d0e76abd0298ebab4f75140"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ab1c0ea925d0e76abd0298ebab4f75140">TCPDF\SetTextColor</a></div><div class="ttdeci">SetTextColor($col1=0, $col2=-1, $col3=-1, $col4=-1, $ret=false, $name='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l04022">tcpdf.php:4022</a></div></div>
<div class="ttc" id="classTCPDF_html_acf41c6c04c29e1323bb270fdea6b5a9f"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#acf41c6c04c29e1323bb270fdea6b5a9f">TCPDF\getFontAscent</a></div><div class="ttdeci">getFontAscent($font, $style='', $size=0)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l04620">tcpdf.php:4620</a></div></div>
<div class="ttc" id="classTCPDF_html_a8c7be67402e96a5220556cfa9db8500a"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a8c7be67402e96a5220556cfa9db8500a">TCPDF\getPageHeight</a></div><div class="ttdeci">getPageHeight($pagenum='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02523">tcpdf.php:2523</a></div></div>
<div class="ttc" id="classTCPDF_html_ab79dc8e8a21ee6aa54d648f2afb1c49f"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ab79dc8e8a21ee6aa54d648f2afb1c49f">TCPDF\$header_xobj_autoreset</a></div><div class="ttdeci">$header_xobj_autoreset</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00569">tcpdf.php:569</a></div></div>
<div class="ttc" id="classTCPDF_html_a4f11d769024fd07e1f663efd02d10517"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a4f11d769024fd07e1f663efd02d10517">TCPDF\selectColumn</a></div><div class="ttdeci">selectColumn($col='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l21946">tcpdf.php:21946</a></div></div>
<div class="ttc" id="classTCPDF_html_a228f3f0796f010e77806ee1af35adcfe"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a228f3f0796f010e77806ee1af35adcfe">TCPDF\$ZoomMode</a></div><div class="ttdeci">$ZoomMode</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00470">tcpdf.php:470</a></div></div>
<div class="ttc" id="classTCPDF_html_a44fb75b85bea40ced25fdea9d89dc8e9"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a44fb75b85bea40ced25fdea9d89dc8e9">TCPDF\$rMargin</a></div><div class="ttdeci">$rMargin</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00250">tcpdf.php:250</a></div></div>
<div class="ttc" id="classTCPDF_html_a91c1d0b385b593f4834a1fd3f9c4ab65"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a91c1d0b385b593f4834a1fd3f9c4ab65">TCPDF\$lispacer</a></div><div class="ttdeci">$lispacer</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00764">tcpdf.php:764</a></div></div>
<div class="ttc" id="classTCPDF_html_afa3c48bada4819f910fb2d6a1ffc2c14"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#afa3c48bada4819f910fb2d6a1ffc2c14">TCPDF\$numimages</a></div><div class="ttdeci">$numimages</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01170">tcpdf.php:1170</a></div></div>
<div class="ttc" id="classTCPDF_html_af8cc74fe5806eb009a22791c3a4c7cce"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#af8cc74fe5806eb009a22791c3a4c7cce">TCPDF\$cell_height_ratio</a></div><div class="ttdeci">$cell_height_ratio</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00924">tcpdf.php:924</a></div></div>
<div class="ttc" id="classTCPDF_html_a40e972ed81a794c72ef784a5ba23bf72"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a40e972ed81a794c72ef784a5ba23bf72">TCPDF\sortBookmarks</a></div><div class="ttdeci">sortBookmarks()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l12467">tcpdf.php:12467</a></div></div>
<div class="ttc" id="classTCPDF_html_ae9b45d6f58118e2bc12c44cca8eed61b"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ae9b45d6f58118e2bc12c44cca8eed61b">TCPDF\SetDefaultMonospacedFont</a></div><div class="ttdeci">SetDefaultMonospacedFont($font)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l04704">tcpdf.php:4704</a></div></div>
<div class="ttc" id="classTCPDF_html_a73f32971feef0aa29e061bac60a90e7a"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a73f32971feef0aa29e061bac60a90e7a">TCPDF\getAutoPageBreak</a></div><div class="ttdeci">getAutoPageBreak()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02808">tcpdf.php:2808</a></div></div>
<div class="ttc" id="classTCPDF_html_a15d65cdde4d6d9df6d1c7fdb985c0e22"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a15d65cdde4d6d9df6d1c7fdb985c0e22">TCPDF\setPageMark</a></div><div class="ttdeci">setPageMark()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l03229">tcpdf.php:3229</a></div></div>
<div class="ttc" id="classTCPDF_html_a642c62438ec9c983283a98d5099ba7ba"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a642c62438ec9c983283a98d5099ba7ba">TCPDF\$FontFamily</a></div><div class="ttdeci">$FontFamily</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00366">tcpdf.php:366</a></div></div>
<div class="ttc" id="classTCPDF_html_ac8927d78b3aafff19cb3188f6879117b"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ac8927d78b3aafff19cb3188f6879117b">TCPDF\$signature_max_length</a></div><div class="ttdeci">$signature_max_length</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01275">tcpdf.php:1275</a></div></div>
<div class="ttc" id="classTCPDF_html_a56507b79d0b3c74332aaacc32dab873a"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a56507b79d0b3c74332aaacc32dab873a">TCPDF\getRemainingWidth</a></div><div class="ttdeci">getRemainingWidth()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l06735">tcpdf.php:6735</a></div></div>
<div class="ttc" id="classTCPDF_html_a4a6a1902a07dbb6a98f107ae2b9574ce"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a4a6a1902a07dbb6a98f107ae2b9574ce">TCPDF\getDestination</a></div><div class="ttdeci">getDestination()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l12367">tcpdf.php:12367</a></div></div>
<div class="ttc" id="classTCPDF_html_a7d067c080614c7f55b6623adfc80a1c1"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a7d067c080614c7f55b6623adfc80a1c1">TCPDF\setRTL</a></div><div class="ttdeci">setRTL($enable, $resetx=true)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02354">tcpdf.php:2354</a></div></div>
<div class="ttc" id="classTCPDF_html_a6fce74bcde6c138d286dce274950dff7"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a6fce74bcde6c138d286dce274950dff7">TCPDF\$FontStyle</a></div><div class="ttdeci">$FontStyle</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00372">tcpdf.php:372</a></div></div>
<div class="ttc" id="classTCPDF_html_ace8e68000d6185a28a180bbe4531b428"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ace8e68000d6185a28a180bbe4531b428">TCPDF\$img_rb_x</a></div><div class="ttdeci">$img_rb_x</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00526">tcpdf.php:526</a></div></div>
<div class="ttc" id="classTCPDF_html_ab9eb18c6a757b07560c111ffb1533049"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ab9eb18c6a757b07560c111ffb1533049">TCPDF\$transfmatrix</a></div><div class="ttdeci">$transfmatrix</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01071">tcpdf.php:1071</a></div></div>
<div class="ttc" id="classTCPDF_html_a9a8cd7928fa36f7a9679a00d908d1427"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a9a8cd7928fa36f7a9679a00d908d1427">TCPDF\$header_xobjid</a></div><div class="ttdeci">$header_xobjid</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00563">tcpdf.php:563</a></div></div>
<div class="ttc" id="classTCPDF_html_a1d91b56a9679cf395342ad0b6c2a4191"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a1d91b56a9679cf395342ad0b6c2a4191">TCPDF\colorRegistrationBar</a></div><div class="ttdeci">colorRegistrationBar($x, $y, $w, $h, $transition=true, $vertical=false, $colors='A, R, G, B, C, M, Y, K')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l14146">tcpdf.php:14146</a></div></div>
<div class="ttc" id="classTCPDF_html_a89c0fac95da962719ba92b057df9c201"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a89c0fac95da962719ba92b057df9c201">TCPDF\Line</a></div><div class="ttdeci">Line($x1, $y1, $x2, $y2, $style=array())</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l11599">tcpdf.php:11599</a></div></div>
<div class="ttc" id="classTCPDF_html_a3c441291e8b83dc4a15794ea92f44415"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a3c441291e8b83dc4a15794ea92f44415">TCPDF\_getstream</a></div><div class="ttdeci">_getstream($s, $n=0)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l10369">tcpdf.php:10369</a></div></div>
<div class="ttc" id="classTCPDF_html_a79a8b6ca37c76f3d5ebfb26be77613db"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a79a8b6ca37c76f3d5ebfb26be77613db">TCPDF\$creator</a></div><div class="ttdeci">$creator</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00512">tcpdf.php:512</a></div></div>
<div class="ttc" id="classTCPDF_html_a4b01dfbc5e4e8453f3fce47026a264f2"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a4b01dfbc5e4e8453f3fce47026a264f2">TCPDF\MirrorH</a></div><div class="ttdeci">MirrorH($x='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l11184">tcpdf.php:11184</a></div></div>
<div class="ttc" id="classTCPDF_html_a64e2ec56774d7d3554db999f1910c6b9"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a64e2ec56774d7d3554db999f1910c6b9">TCPDF\getHTMLUnitToUnits</a></div><div class="ttdeci">getHTMLUnitToUnits($htmlval, $refsize=1, $defaultunit='px', $points=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l20340">tcpdf.php:20340</a></div></div>
<div class="ttc" id="classTCPDF_html_aa4460c72a6e45784dff4dad7708c372c"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aa4460c72a6e45784dff4dad7708c372c">TCPDF\$FontSize</a></div><div class="ttdeci">$FontSize</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00416">tcpdf.php:416</a></div></div>
<div class="ttc" id="classTCPDF_html_aa152b05eedf7152d8163ab4f5083de1c"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aa152b05eedf7152d8163ab4f5083de1c">TCPDF\_encrypt_data</a></div><div class="ttdeci">_encrypt_data($n, $s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l10578">tcpdf.php:10578</a></div></div>
<div class="ttc" id="classTCPDF_html_a00ec13928f57b17c21040acc881fe482"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a00ec13928f57b17c21040acc881fe482">TCPDF\SetXY</a></div><div class="ttdeci">SetXY($x, $y, $rtloff=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l07534">tcpdf.php:7534</a></div></div>
<div class="ttc" id="classTCPDF_html_a8203a3a6bda94f38f973de2825b76ea3"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a8203a3a6bda94f38f973de2825b76ea3">TCPDF\getBreakMargin</a></div><div class="ttdeci">getBreakMargin($pagenum='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02539">tcpdf.php:2539</a></div></div>
<div class="ttc" id="classTCPDF_html_a5eeae8e0584a2f04846aea057780fd39"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a5eeae8e0584a2f04846aea057780fd39">TCPDF\$js_objects</a></div><div class="ttdeci">$js_objects</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01352">tcpdf.php:1352</a></div></div>
<div class="ttc" id="classTCPDF_html_aacc2ee9f1c08cda7c71f2a203ed9d6c2"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aacc2ee9f1c08cda7c71f2a203ed9d6c2">TCPDF\_outRect</a></div><div class="ttdeci">_outRect($x, $y, $w, $h, $op)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l11532">tcpdf.php:11532</a></div></div>
<div class="ttc" id="classTCPDF_html_a4ccd9d69e0839838b105328953794a40"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a4ccd9d69e0839838b105328953794a40">TCPDF\$rtl</a></div><div class="ttdeci">$rtl</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00785">tcpdf.php:785</a></div></div>
<div class="ttc" id="classTCPDF_html_af17e978f511addd7a3000d71ebf4ab55"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#af17e978f511addd7a3000d71ebf4ab55">TCPDF\SetDrawSpotColor</a></div><div class="ttdeci">SetDrawSpotColor($name, $tint=100)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l03784">tcpdf.php:3784</a></div></div>
<div class="ttc" id="classTCPDF_html_af484c6dc7debd34e2310f9f391448de7"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#af484c6dc7debd34e2310f9f391448de7">TCPDF\getRawCharWidth</a></div><div class="ttdeci">getRawCharWidth($char)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l04115">tcpdf.php:4115</a></div></div>
<div class="ttc" id="classTCPDF_html_a7965ee64ad21a3c638933ae96cb23f94"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a7965ee64ad21a3c638933ae96cb23f94">TCPDF\$hPt</a></div><div class="ttdeci">$hPt</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00226">tcpdf.php:226</a></div></div>
<div class="ttc" id="classTCPDF_html_a274314ff17c5df9ae105f9c91893a4a7"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a274314ff17c5df9ae105f9c91893a4a7">TCPDF\$encoding</a></div><div class="ttdeci">$encoding</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00771">tcpdf.php:771</a></div></div>
<div class="ttc" id="classTCPDF_html_a59be161aa1bfab0a103a9f9442638e1a"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a59be161aa1bfab0a103a9f9442638e1a">TCPDF\$efnames</a></div><div class="ttdeci">$efnames</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01596">tcpdf.php:1596</a></div></div>
<div class="ttc" id="classTCPDF_html_a71cec8b4c54a78429640e4767648e73e"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a71cec8b4c54a78429640e4767648e73e">TCPDF\setHtmlVSpace</a></div><div class="ttdeci">setHtmlVSpace($tagvs)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l20294">tcpdf.php:20294</a></div></div>
<div class="ttc" id="classTCPDF_html_a320d4c4b03adf1480bf550aa64cdf8f1"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a320d4c4b03adf1480bf550aa64cdf8f1">TCPDF\$tsa_data</a></div><div class="ttdeci">$tsa_data</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01303">tcpdf.php:1303</a></div></div>
<div class="ttc" id="classTCPDF_html_a52ace3318c0320d4059a1b969cc2eb20"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a52ace3318c0320d4059a1b969cc2eb20">TCPDF\closeHTMLTagHandler</a></div><div class="ttdeci">closeHTMLTagHandler($dom, $key, $cell, $maxbottomliney=0)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l19441">tcpdf.php:19441</a></div></div>
<div class="ttc" id="classTCPDF_html_a3ddff5ab94a793cf535b06de3e773826"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a3ddff5ab94a793cf535b06de3e773826">TCPDF\_putjavascript</a></div><div class="ttdeci">_putjavascript()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l12640">tcpdf.php:12640</a></div></div>
<div class="ttc" id="classTCPDF_html_ac3fdf25fcd36f1dce04f92187c621407"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ac3fdf25fcd36f1dce04f92187c621407">TCPDF\writeHTML</a></div><div class="ttdeci">writeHTML($html, $ln=true, $fill=false, $reseth=false, $cell=false, $align='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l17214">tcpdf.php:17214</a></div></div>
<div class="ttc" id="classTCPDF_html_a8075c1f04b6fbddc957cff786c4b16d9"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a8075c1f04b6fbddc957cff786c4b16d9">TCPDF\GetStringWidth</a></div><div class="ttdeci">GetStringWidth($s, $fontname='', $fontstyle='', $fontsize=0, $getarray=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l04038">tcpdf.php:4038</a></div></div>
<div class="ttc" id="classTCPDF_html_a0315276a2fb102cd8ef24a440741b3d4"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a0315276a2fb102cd8ef24a440741b3d4">TCPDF\$DrawColor</a></div><div class="ttdeci">$DrawColor</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00422">tcpdf.php:422</a></div></div>
<div class="ttc" id="classTCPDF_html_a3cfc462353c8c404e621556232319d81"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a3cfc462353c8c404e621556232319d81">TCPDF\getImageScale</a></div><div class="ttdeci">getImageScale()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02478">tcpdf.php:2478</a></div></div>
<div class="ttc" id="classTCPDF_html_a22272525668774dab75d46dfd66ff2f2"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a22272525668774dab75d46dfd66ff2f2">TCPDF\$dpi</a></div><div class="ttdeci">$dpi</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00882">tcpdf.php:882</a></div></div>
<div class="ttc" id="classTCPDF_html_ae36b54ab4599f14fc4116bb77ffbcc6b"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ae36b54ab4599f14fc4116bb77ffbcc6b">TCPDF\$diskcache</a></div><div class="ttdeci">$diskcache</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01191">tcpdf.php:1191</a></div></div>
<div class="ttc" id="classTCPDF_html_a94cc2168d0b49e11f6c4d1420a6eb509"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a94cc2168d0b49e11f6c4d1420a6eb509">TCPDF\setDestination</a></div><div class="ttdeci">setDestination($name, $y=-1, $page='', $x=-1)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l12324">tcpdf.php:12324</a></div></div>
<div class="ttc" id="tcpdf__config_8php_html_a24c5be6597b6e1ffd1a8011e2917ddf7"><div class="ttname"><a href="../../d5/dc0/tcpdf__config_8php.html#a24c5be6597b6e1ffd1a8011e2917ddf7">PDF_FONT_NAME_MAIN</a></div><div class="ttdeci">const PDF_FONT_NAME_MAIN</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dc0/tcpdf__config_8php_source.html#l00160">tcpdf_config.php:160</a></div></div>
<div class="ttc" id="classTCPDF_html_a505b4eabece70b8679ebdeb86964b798"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a505b4eabece70b8679ebdeb86964b798">TCPDF\$newline</a></div><div class="ttdeci">$newline</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00994">tcpdf.php:994</a></div></div>
<div class="ttc" id="classTCPDF_html_a615b71100b4526459d22e385fffe1660"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a615b71100b4526459d22e385fffe1660">TCPDF\resetHeaderTemplate</a></div><div class="ttdeci">resetHeaderTemplate()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l03380">tcpdf.php:3380</a></div></div>
<div class="ttc" id="classTCPDF_html_a6917075860ef7a8d300698ff6f678a04"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a6917075860ef7a8d300698ff6f678a04">TCPDF\$FillColor</a></div><div class="ttdeci">$FillColor</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00428">tcpdf.php:428</a></div></div>
<div class="ttc" id="classTCPDF_html_a68092d68b3e4947ea283efe0a990e7d9"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a68092d68b3e4947ea283efe0a990e7d9">TCPDF\setImageBuffer</a></div><div class="ttdeci">setImageBuffer($image, $data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l20919">tcpdf.php:20919</a></div></div>
<div class="ttc" id="classTCPDF_html_a4d67b0a8681222f71fa9f9f6e65e0c56"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a4d67b0a8681222f71fa9f9f6e65e0c56">TCPDF\getPageBuffer</a></div><div class="ttdeci">getPageBuffer($page)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l20902">tcpdf.php:20902</a></div></div>
<div class="ttc" id="classTCPDF_html_ad66f051c544895eb0a35ad0e033c3fa9"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ad66f051c544895eb0a35ad0e033c3fa9">TCPDF\setBarcode</a></div><div class="ttdeci">setBarcode($bc='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l15271">tcpdf.php:15271</a></div></div>
<div class="ttc" id="classTCPDF_html_a75a59cadddf08174c12801049c23b862"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a75a59cadddf08174c12801049c23b862">TCPDF\$extgstates</a></div><div class="ttdeci">$extgstates</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00910">tcpdf.php:910</a></div></div>
<div class="ttc" id="classTCPDF_html_a7f6ac3771776732243563ec438ab055f"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a7f6ac3771776732243563ec438ab055f">TCPDF\$FontDescent</a></div><div class="ttdeci">$FontDescent</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00386">tcpdf.php:386</a></div></div>
<div class="ttc" id="classTCPDF_html_ad32b0c0ac023e7b13198f773c848ff2f"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ad32b0c0ac023e7b13198f773c848ff2f">TCPDF\convertSVGtMatrix</a></div><div class="ttdeci">convertSVGtMatrix($tm)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l23208">tcpdf.php:23208</a></div></div>
<div class="ttc" id="classTCPDF_html_a5fa62d7764cd7f3ff96fb902bf2ad7c5"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a5fa62d7764cd7f3ff96fb902bf2ad7c5">TCPDF\RoundedRect</a></div><div class="ttdeci">RoundedRect($x, $y, $w, $h, $r, $round_corner='1111', $style='', $border_style=array(), $fill_color=array())</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l12170">tcpdf.php:12170</a></div></div>
<div class="ttc" id="classTCPDF_html_a6aa9631fbfb07623604d43d59cffeb5b"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a6aa9631fbfb07623604d43d59cffeb5b">TCPDF\$svgclipid</a></div><div class="ttdeci">$svgclipid</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01666">tcpdf.php:1666</a></div></div>
<div class="ttc" id="classTCPDF_html_a4de2d0545b1b22645043fd6656248144"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a4de2d0545b1b22645043fd6656248144">TCPDF\startSVGElementHandler</a></div><div class="ttdeci">startSVGElementHandler($parser, $name, $attribs, $ctm=array())</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l23895">tcpdf.php:23895</a></div></div>
<div class="ttc" id="classTCPDF_html_ace0583441eed657b827420fcfb37a3bd"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ace0583441eed657b827420fcfb37a3bd">TCPDF\ImageEps</a></div><div class="ttdeci">ImageEps($file, $x='', $y='', $w=0, $h=0, $link='', $useBoundingBox=true, $align='', $palign='', $border=0, $fitonpage=false, $fixoutvals=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l14952">tcpdf.php:14952</a></div></div>
<div class="ttc" id="classTCPDF_html_a10e1f5a4bd93b5f2a81cc20509e2093d"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a10e1f5a4bd93b5f2a81cc20509e2093d">TCPDF\$sign</a></div><div class="ttdeci">$sign</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01261">tcpdf.php:1261</a></div></div>
<div class="ttc" id="classTCPDF_html_a1302c5172587123038e0c947b888b6ec"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a1302c5172587123038e0c947b888b6ec">TCPDF\openHTMLTagHandler</a></div><div class="ttdeci">openHTMLTagHandler($dom, $key, $cell)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l18771">tcpdf.php:18771</a></div></div>
<div class="ttc" id="classTCPDF_html_a2b53ae6043ae30ed4c80fd0e7542160b"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a2b53ae6043ae30ed4c80fd0e7542160b">TCPDF\writeDiskCache</a></div><div class="ttdeci">writeDiskCache($filename, $data, $append=false, $serialize=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l20772">tcpdf.php:20772</a></div></div>
<div class="ttc" id="classTCPDF_html_aa24f8123d1e2d35446002d13a9715850"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aa24f8123d1e2d35446002d13a9715850">TCPDF\$strokecolor</a></div><div class="ttdeci">$strokecolor</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01485">tcpdf.php:1485</a></div></div>
<div class="ttc" id="classTCPDF_html_a937dcd07bad79ae3900236f87b29194b"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a937dcd07bad79ae3900236f87b29194b">TCPDF\setSpacesRE</a></div><div class="ttdeci">setSpacesRE($re='/[^\S\xa0]/')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02329">tcpdf.php:2329</a></div></div>
<div class="ttc" id="classTCPDF_html_a130bd080e3028082d43b4d1d64f6702e"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a130bd080e3028082d43b4d1d64f6702e">TCPDF\getFontStyle</a></div><div class="ttdeci">getFontStyle()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l15934">tcpdf.php:15934</a></div></div>
<div class="ttc" id="classTCPDF_html_a983e0a8da2a4d76c24efb0a91281712a"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a983e0a8da2a4d76c24efb0a91281712a">TCPDF\SetAuthor</a></div><div class="ttdeci">SetAuthor($author)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02895">tcpdf.php:2895</a></div></div>
<div class="ttc" id="classTCPDF_html_a26529ccdd9f9ec9d0ea0c40980776760"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a26529ccdd9f9ec9d0ea0c40980776760">TCPDF\StopTransform</a></div><div class="ttdeci">StopTransform()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l11086">tcpdf.php:11086</a></div></div>
<div class="ttc" id="classTCPDF_html_a765be81c830574535ed8cb33f0ad2065"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a765be81c830574535ed8cb33f0ad2065">TCPDF\ScaleXY</a></div><div class="ttdeci">ScaleXY($s, $x='', $y='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l11137">tcpdf.php:11137</a></div></div>
<div class="ttc" id="classTCPDF_html_a00969cf629d72b3d29ee435f15906820"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a00969cf629d72b3d29ee435f15906820">TCPDF\Ln</a></div><div class="ttdeci">Ln($h='', $cell=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l07394">tcpdf.php:7394</a></div></div>
<div class="ttc" id="classTCPDF_html_a4afa2740651c35051628d9a9a1d1edb8"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a4afa2740651c35051628d9a9a1d1edb8">TCPDF\PolyLine</a></div><div class="ttdeci">PolyLine($p, $style='', $line_style=array(), $fill_color=array())</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l11960">tcpdf.php:11960</a></div></div>
<div class="ttc" id="classTCPDF_html_aa36b100b48a17cd6c35de87431a3d54c"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aa36b100b48a17cd6c35de87431a3d54c">TCPDF\_outellipticalarc</a></div><div class="ttdeci">_outellipticalarc($xc, $yc, $rx, $ry, $xang=0, $angs=0, $angf=360, $pie=false, $nc=2, $startpoint=true, $ccw=true, $svg=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l11811">tcpdf.php:11811</a></div></div>
<div class="ttc" id="classTCPDF_html_a0f0bc306116b145ea0efbc1c709a23b6"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a0f0bc306116b145ea0efbc1c709a23b6">TCPDF\$InFooter</a></div><div class="ttdeci">$InFooter</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00464">tcpdf.php:464</a></div></div>
<div class="ttc" id="classTCPDF_html_a27ecf2a6c86b4b7976ebfaf5912b0f91"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a27ecf2a6c86b4b7976ebfaf5912b0f91">TCPDF\Error</a></div><div class="ttdeci">Error($msg)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02927">tcpdf.php:2927</a></div></div>
<div class="ttc" id="classTCPDF_html_a24b714e8e56b4f8672886180e5037cd7"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a24b714e8e56b4f8672886180e5037cd7">TCPDF\getBuffer</a></div><div class="ttdeci">getBuffer()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l20859">tcpdf.php:20859</a></div></div>
<div class="ttc" id="classTCPDF_html_a8689e059bc8cb0f8436b77d07c7ab32c"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a8689e059bc8cb0f8436b77d07c7ab32c">TCPDF\setHtmlLinksStyle</a></div><div class="ttdeci">setHtmlLinksStyle($color=array(0, 0, 255), $fontstyle='U')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l20325">tcpdf.php:20325</a></div></div>
<div class="ttc" id="classTCPDF_html_a5667689bccca7385dc41c64040e59121"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a5667689bccca7385dc41c64040e59121">TCPDF\getCSSMargin</a></div><div class="ttdeci">getCSSMargin($cssmargin, $width=0)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l16122">tcpdf.php:16122</a></div></div>
<div class="ttc" id="classTCPDF_html_aec5762185293ba0a36782ceeaba19a94"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aec5762185293ba0a36782ceeaba19a94">TCPDF\$inxobj</a></div><div class="ttdeci">$inxobj</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01533">tcpdf.php:1533</a></div></div>
<div class="ttc" id="classTCPDF_html_a8d34f3978888eaf89b4d78a361fb4416"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a8d34f3978888eaf89b4d78a361fb4416">TCPDF\getFontSizePt</a></div><div class="ttdeci">getFontSizePt()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l15914">tcpdf.php:15914</a></div></div>
<div class="ttc" id="classTCPDF_html_a7db0d9878a041a04273e251228540b56"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a7db0d9878a041a04273e251228540b56">TCPDF\getColumn</a></div><div class="ttdeci">getColumn()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l22025">tcpdf.php:22025</a></div></div>
<div class="ttc" id="classTCPDF_html_a54cc2d89767ef5425957a0c0a9b34269"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a54cc2d89767ef5425957a0c0a9b34269">TCPDF\_putstream</a></div><div class="ttdeci">_putstream($s, $n=0)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l10380">tcpdf.php:10380</a></div></div>
<div class="ttc" id="classTCPDF_html_adfc2d921b91adad5a68441245ddb2180"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#adfc2d921b91adad5a68441245ddb2180">TCPDF\setExtGState</a></div><div class="ttdeci">setExtGState($gs)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l13946">tcpdf.php:13946</a></div></div>
<div class="ttc" id="classTCPDF_html_ab9f43ce707ad6b533224aab3fddffebb"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ab9f43ce707ad6b533224aab3fddffebb">TCPDF\$cached_files</a></div><div class="ttdeci">$cached_files</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00348">tcpdf.php:348</a></div></div>
<div class="ttc" id="classTCPDF_html_acd080ff16d09e445402c5bc8e831af7b"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#acd080ff16d09e445402c5bc8e831af7b">TCPDF\getFontSize</a></div><div class="ttdeci">getFontSize()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l15904">tcpdf.php:15904</a></div></div>
<div class="ttc" id="classTCPDF_html_acf73334191df85e1c4effbc5cf257cf5"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#acf73334191df85e1c4effbc5cf257cf5">TCPDF\getFontFamily</a></div><div class="ttdeci">getFontFamily()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l15924">tcpdf.php:15924</a></div></div>
<div class="ttc" id="classTCPDF_html_abe60f253ebfc6088b3248e84ccf0a4fe"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#abe60f253ebfc6088b3248e84ccf0a4fe">TCPDF\_Ovalue</a></div><div class="ttdeci">_Ovalue()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l10772">tcpdf.php:10772</a></div></div>
<div class="ttc" id="classTCPDF_html_a5f1c38efd67c4e1d70a40f13a7b286bb"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a5f1c38efd67c4e1d70a40f13a7b286bb">TCPDF\_outCurveV</a></div><div class="ttdeci">_outCurveV($x2, $y2, $x3, $y3)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l11566">tcpdf.php:11566</a></div></div>
<div class="ttc" id="classTCPDF_html_aef1e19d18b0a82b1c45b53d3f17ae2b5"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aef1e19d18b0a82b1c45b53d3f17ae2b5">TCPDF\Rotate</a></div><div class="ttdeci">Rotate($angle, $x='', $y='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l11277">tcpdf.php:11277</a></div></div>
<div class="ttc" id="classTCPDF_html_acef86c1b60f2b45323f27c4dc9620922"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#acef86c1b60f2b45323f27c4dc9620922">TCPDF\$textstrokewidth</a></div><div class="ttdeci">$textstrokewidth</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01478">tcpdf.php:1478</a></div></div>
<div class="ttc" id="classTCPDF_html_a2ed08174efade970d4b641f77ab2b0d5"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a2ed08174efade970d4b641f77ab2b0d5">TCPDF\startPageGroup</a></div><div class="ttdeci">startPageGroup($page='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l13678">tcpdf.php:13678</a></div></div>
<div class="ttc" id="classTCPDF_html_ace8343242b398fd16a4acb1926b6efa7"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ace8343242b398fd16a4acb1926b6efa7">TCPDF\$tMargin</a></div><div class="ttdeci">$tMargin</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00268">tcpdf.php:268</a></div></div>
<div class="ttc" id="tcpdf__autoconfig_8php_html_a438a0ae7ce372c95f49c1a0f29f9eeb6"><div class="ttname"><a href="../../d5/dab/tcpdf__autoconfig_8php.html#a438a0ae7ce372c95f49c1a0f29f9eeb6">$_SERVER</a></div><div class="ttdeci">if((!isset($_SERVER['DOCUMENT_ROOT'])) OR(empty($_SERVER['DOCUMENT_ROOT']))) $_SERVER['DOCUMENT_ROOT']</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dab/tcpdf__autoconfig_8php_source.html#l00054">tcpdf_autoconfig.php:54</a></div></div>
<div class="ttc" id="classTCPDF_html_aaf231db32674770a4a2f254f22f5f826"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aaf231db32674770a4a2f254f22f5f826">TCPDF\$pdflayers</a></div><div class="ttdeci">$pdflayers</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01575">tcpdf.php:1575</a></div></div>
<div class="ttc" id="classTCPDF_html_a62e82c3bdf531f0c898926124696e77e"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a62e82c3bdf531f0c898926124696e77e">TCPDF\getPageDimensions</a></div><div class="ttdeci">getPageDimensions($pagenum='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02491">tcpdf.php:2491</a></div></div>
<div class="ttc" id="classTCPDF_html_a415a80a301208fa77552048b27d2e0ce"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a415a80a301208fa77552048b27d2e0ce">TCPDF\GetX</a></div><div class="ttdeci">GetX()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l07428">tcpdf.php:7428</a></div></div>
<div class="ttc" id="classTCPDF_html_ae7cd5ea4b0ef3a0910ed0044bea97f1d"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ae7cd5ea4b0ef3a0910ed0044bea97f1d">TCPDF\$thead</a></div><div class="ttdeci">$thead</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01247">tcpdf.php:1247</a></div></div>
<div class="ttc" id="classTCPDF_html_a92b743d472f53d5260274c7915829ff7"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a92b743d472f53d5260274c7915829ff7">TCPDF\$listnum</a></div><div class="ttdeci">$listnum</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00734">tcpdf.php:734</a></div></div>
<div class="ttc" id="classTCPDF_html_accba6f1471acb211de74e6b34107041d"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#accba6f1471acb211de74e6b34107041d">TCPDF\isRTLTextDir</a></div><div class="ttdeci">isRTLTextDir()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02412">tcpdf.php:2412</a></div></div>
<div class="ttc" id="classTCPDF_html_a0c8374150dbc8ca092618ca430713f70"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a0c8374150dbc8ca092618ca430713f70">TCPDF\getFontDescent</a></div><div class="ttdeci">getFontDescent($font, $style='', $size=0)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l04599">tcpdf.php:4599</a></div></div>
<div class="ttc" id="classTCPDF_html_a1a003edf69be144993c85c07a220315c"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a1a003edf69be144993c85c07a220315c">TCPDF\getImageBuffer</a></div><div class="ttdeci">getImageBuffer($image)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l20964">tcpdf.php:20964</a></div></div>
<div class="ttc" id="classTCPDF_html_a7db5d71deb95779481ed9e99fcf3d19a"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a7db5d71deb95779481ed9e99fcf3d19a">TCPDF\setTextShadow</a></div><div class="ttdeci">setTextShadow($params=array('enabled'=&gt;false, 'depth_w'=&gt;0, 'depth_h'=&gt;0, 'color'=&gt;false, 'opacity'=&gt;1, 'blend_mode'=&gt;'Normal'))</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l22102">tcpdf.php:22102</a></div></div>
<div class="ttc" id="classTCPDF_html_af1b0f1f3ec868528230e8b0293a23a4c"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#af1b0f1f3ec868528230e8b0293a23a4c">TCPDF\setFooterFont</a></div><div class="ttdeci">setFooterFont($font)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l10438">tcpdf.php:10438</a></div></div>
<div class="ttc" id="classTCPDF_html_aa194abd22d0ba5e5f2c52c5e05f4e107"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aa194abd22d0ba5e5f2c52c5e05f4e107">TCPDF\setTextRenderingMode</a></div><div class="ttdeci">setTextRenderingMode($stroke=0, $fill=true, $clip=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l22047">tcpdf.php:22047</a></div></div>
<div class="ttc" id="classTCPDF_html_a8a5cfe86f13b8b547ed17e97fa350a80"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a8a5cfe86f13b8b547ed17e97fa350a80">TCPDF\$ur</a></div><div class="ttdeci">$ur</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00875">tcpdf.php:875</a></div></div>
<div class="ttc" id="classTCPDF_html_a90efde54832587803c17467bfff03038"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a90efde54832587803c17467bfff03038">TCPDF\_outCurve</a></div><div class="ttdeci">_outCurve($x1, $y1, $x2, $y2, $x3, $y3)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l11550">tcpdf.php:11550</a></div></div>
<div class="ttc" id="classTCPDF_html_aa63bed5d5f585edcbfedceecea15a1db"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aa63bed5d5f585edcbfedceecea15a1db">TCPDF\SetDocInfoUnicode</a></div><div class="ttdeci">SetDocInfoUnicode($unicode=true)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02862">tcpdf.php:2862</a></div></div>
<div class="ttc" id="classTCPDF_html_a3a6255516dcf07089fe29f13b3ef67bf"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a3a6255516dcf07089fe29f13b3ef67bf">TCPDF\getAliasNbPages</a></div><div class="ttdeci">getAliasNbPages()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l13728">tcpdf.php:13728</a></div></div>
<div class="ttc" id="classTCPDF_html_a936a4f5037af85ab74f698e43cd88022"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a936a4f5037af85ab74f698e43cd88022">TCPDF\setTimeStamp</a></div><div class="ttdeci">setTimeStamp($tsa_host='', $tsa_username='', $tsa_password='', $tsa_cert='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l13635">tcpdf.php:13635</a></div></div>
<div class="ttc" id="classTCPDF_html_a20314c160153895145ce7e8a91e75ffc"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a20314c160153895145ce7e8a91e75ffc">TCPDF\_putfonts</a></div><div class="ttdeci">_putfonts()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l08837">tcpdf.php:8837</a></div></div>
<div class="ttc" id="classTCPDF_html_aa198175b5bdc3ed8663efa6b5286a74a"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aa198175b5bdc3ed8663efa6b5286a74a">TCPDF\stringRightTrim</a></div><div class="ttdeci">stringRightTrim($str, $replace='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l22358">tcpdf.php:22358</a></div></div>
<div class="ttc" id="classTCPDF_html_a75ae8e6fcf6f618c962e18dc11987753"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a75ae8e6fcf6f618c962e18dc11987753">TCPDF\$dests</a></div><div class="ttdeci">$dests</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01582">tcpdf.php:1582</a></div></div>
<div class="ttc" id="classTCPDF_html_a304b018598f42b236e0720a97a192e04"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a304b018598f42b236e0720a97a192e04">TCPDF\setSRGBmode</a></div><div class="ttdeci">setSRGBmode($mode=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02851">tcpdf.php:2851</a></div></div>
<div class="ttc" id="classTCPDF_html_a1dd465e43c8c86c254abafc6da408400"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a1dd465e43c8c86c254abafc6da408400">TCPDF\$txtshadow</a></div><div class="ttdeci">$txtshadow</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00690">tcpdf.php:690</a></div></div>
<div class="ttc" id="classTCPDF_html_a850dd347f649c99548a193f2b84a502e"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a850dd347f649c99548a193f2b84a502e">TCPDF\SetFillColorArray</a></div><div class="ttdeci">SetFillColorArray($color, $ret=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l03868">tcpdf.php:3868</a></div></div>
<div class="ttc" id="classTCPDF_html_a6c68aee9927218cac5798416a037f1a3"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a6c68aee9927218cac5798416a037f1a3">TCPDF\startLayer</a></div><div class="ttdeci">startLayer($name='', $print=true, $view=true, $lock=true)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l13843">tcpdf.php:13843</a></div></div>
<div class="ttc" id="classTCPDF_html_aa0c76ae0aa3fb88a2adbecbdd39a3736"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aa0c76ae0aa3fb88a2adbecbdd39a3736">TCPDF\$check_page_regions</a></div><div class="ttdeci">$check_page_regions</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01568">tcpdf.php:1568</a></div></div>
<div class="ttc" id="classTCPDF_html_ac7082d1545bb2ee22c4713ab57879d81"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ac7082d1545bb2ee22c4713ab57879d81">TCPDF\_textstring</a></div><div class="ttdeci">_textstring($s, $n=0)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l10318">tcpdf.php:10318</a></div></div>
<div class="ttc" id="classTCPDF_html_a885b5862782e1d3ff05f349f278ca664"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a885b5862782e1d3ff05f349f278ca664">TCPDF\addHTMLVertSpace</a></div><div class="ttdeci">addHTMLVertSpace($hbz=0, $hb=0, $cell=false, $firsttag=false, $lasttag=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l19987">tcpdf.php:19987</a></div></div>
<div class="ttc" id="classTCPDF_html_a52a8502589754eefe8da17efdd40329b"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a52a8502589754eefe8da17efdd40329b">TCPDF\setTableHeader</a></div><div class="ttdeci">setTableHeader()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l03628">tcpdf.php:3628</a></div></div>
<div class="ttc" id="classTCPDF_html_aca0a3c26e95c17b68bd0a5420f88629b"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aca0a3c26e95c17b68bd0a5420f88629b">TCPDF\getPageRegions</a></div><div class="ttdeci">getPageRegions()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l22712">tcpdf.php:22712</a></div></div>
<div class="ttc" id="classTCPDF_html_a4e9c60bd295bc60a66d7c6492072d1ef"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a4e9c60bd295bc60a66d7c6492072d1ef">TCPDF\addExtGState</a></div><div class="ttdeci">addExtGState($parms)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l13915">tcpdf.php:13915</a></div></div>
<div class="ttc" id="classTCPDF_html_a1302a2cfd195515184e2baab0ab20c7e"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a1302a2cfd195515184e2baab0ab20c7e">TCPDF\$form_action</a></div><div class="ttdeci">$form_action</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01359">tcpdf.php:1359</a></div></div>
<div class="ttc" id="classTCPDF_html_a7381d7ff2d161c30e0ee5156c956c638"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a7381d7ff2d161c30e0ee5156c956c638">TCPDF\_putinfo</a></div><div class="ttdeci">_putinfo()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l09514">tcpdf.php:9514</a></div></div>
<div class="ttc" id="tcpdf__config_8php_html_a82a1d9035f18432d5e17e0e56d188a52"><div class="ttname"><a href="../../d5/dc0/tcpdf__config_8php.html#a82a1d9035f18432d5e17e0e56d188a52">K_PATH_IMAGES</a></div><div class="ttdeci">const K_PATH_IMAGES</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dc0/tcpdf__config_8php_source.html#l00067">tcpdf_config.php:67</a></div></div>
<div class="ttc" id="classTCPDF2DBarcode_html"><div class="ttname"><a href="../../d5/d90/classTCPDF2DBarcode.html">TCPDF2DBarcode</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/d17/tcpdf__barcodes__2d_8php_source.html#l00050">tcpdf_barcodes_2d.php:50</a></div></div>
<div class="ttc" id="classTCPDF_html_af37c03f21372a70598f00034b7e41c0a"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#af37c03f21372a70598f00034b7e41c0a">TCPDF\$doc_creation_timestamp</a></div><div class="ttdeci">$doc_creation_timestamp</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01772">tcpdf.php:1772</a></div></div>
<div class="ttc" id="classTCPDF_html_abc05496cf88772b492f67e87c53121d0"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#abc05496cf88772b492f67e87c53121d0">TCPDF\$img_rb_y</a></div><div class="ttdeci">$img_rb_y</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00534">tcpdf.php:534</a></div></div>
<div class="ttc" id="classTCPDF_html_abdf07c1c5b4fb70b3ed325031d187257"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#abdf07c1c5b4fb70b3ed325031d187257">TCPDF\$CurOrientation</a></div><div class="ttdeci">$CurOrientation</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00190">tcpdf.php:190</a></div></div>
<div class="ttc" id="classTCPDF_html_a148f0ae58c3b0f5644f8ab158b17c2ed"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a148f0ae58c3b0f5644f8ab158b17c2ed">TCPDF\$isunicode</a></div><div class="ttdeci">$isunicode</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00550">tcpdf.php:550</a></div></div>
<div class="ttc" id="classTCPDF_html_a7310f6d7bd966343955e3133756df710"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a7310f6d7bd966343955e3133756df710">TCPDF\$linestyleDash</a></div><div class="ttdeci">$linestyleDash</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01029">tcpdf.php:1029</a></div></div>
<div class="ttc" id="classTCPDF_html_a23895bb8d9fae071308f9d307ea638fd"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a23895bb8d9fae071308f9d307ea638fd">TCPDF\Curve</a></div><div class="ttdeci">Curve($x0, $y0, $x1, $y1, $x2, $y2, $x3, $y3, $style='', $line_style=array(), $fill_color=array())</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l11700">tcpdf.php:11700</a></div></div>
<div class="ttc" id="classTCPDF_html_a7a19257fcbaa5c79ce4a5aa4319ec8af"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a7a19257fcbaa5c79ce4a5aa4319ec8af">TCPDF\_putannotsrefs</a></div><div class="ttdeci">_putannotsrefs($n)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l08108">tcpdf.php:8108</a></div></div>
<div class="ttc" id="classTCPDF_html_a7195b85507609d798c03df2f183578b7"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a7195b85507609d798c03df2f183578b7">TCPDF\$footer_line_color</a></div><div class="ttdeci">$footer_line_color</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00683">tcpdf.php:683</a></div></div>
<div class="ttc" id="classTCPDF_html_a21df9dfbc3a918515ba028dd26063956"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a21df9dfbc3a918515ba028dd26063956">TCPDF\ScaleY</a></div><div class="ttdeci">ScaleY($s_y, $x='', $y='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l11124">tcpdf.php:11124</a></div></div>
<div class="ttc" id="classTCPDF_html_a161ff5500c93e6a3af01b87df1ee7877"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a161ff5500c93e6a3af01b87df1ee7877">TCPDF\_dooverlinew</a></div><div class="ttdeci">_dooverlinew($x, $y, $w)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l10229">tcpdf.php:10229</a></div></div>
<div class="ttc" id="classTCPDF_html_aa3332213fe963b311077498a19d05cbe"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aa3332213fe963b311077498a19d05cbe">TCPDF\setDocCreationTimestamp</a></div><div class="ttdeci">setDocCreationTimestamp($time)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l10256">tcpdf.php:10256</a></div></div>
<div class="ttc" id="classTCPDF_html_aea769a906ed606706e862bd7576e9a34"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aea769a906ed606706e862bd7576e9a34">TCPDF\$num_columns</a></div><div class="ttdeci">$num_columns</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01436">tcpdf.php:1436</a></div></div>
<div class="ttc" id="classTCPDF_html_a642af8de9018d16a0b916dd0d3f20ea8"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a642af8de9018d16a0b916dd0d3f20ea8">TCPDF\$default_graphic_vars</a></div><div class="ttdeci">$default_graphic_vars</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01519">tcpdf.php:1519</a></div></div>
<div class="ttc" id="classTCPDF_html_ac93ed171cb920eca2d52c3afcedff82e"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ac93ed171cb920eca2d52c3afcedff82e">TCPDF\getDocCreationTimestamp</a></div><div class="ttdeci">getDocCreationTimestamp()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l10282">tcpdf.php:10282</a></div></div>
<div class="ttc" id="classTCPDF_html_af38b4f69c334a8662ce586597fdad151"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#af38b4f69c334a8662ce586597fdad151">TCPDF\setLIsymbol</a></div><div class="ttdeci">setLIsymbol($symbol='!')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l20231">tcpdf.php:20231</a></div></div>
<div class="ttc" id="classTCPDF_html_aac34b7d5674382a748a05db919fbe759"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aac34b7d5674382a748a05db919fbe759">TCPDF\$pdfa_mode</a></div><div class="ttdeci">$pdfa_mode</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01765">tcpdf.php:1765</a></div></div>
<div class="ttc" id="classTCPDF_html_adf1682524d9c24f3b8c8f4aabf4bd034"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#adf1682524d9c24f3b8c8f4aabf4bd034">TCPDF\setHeaderMargin</a></div><div class="ttdeci">setHeaderMargin($hm=10)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l03307">tcpdf.php:3307</a></div></div>
<div class="ttc" id="classTCPDF_html_aac92d698d00f2c049c2941a6faa8253b"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aac92d698d00f2c049c2941a6faa8253b">TCPDF\$default_form_prop</a></div><div class="ttdeci">$default_form_prop</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01345">tcpdf.php:1345</a></div></div>
<div class="ttc" id="classTCPDF_html"><div class="ttname"><a href="../../d4/d40/classTCPDF.html">TCPDF</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00134">tcpdf.php:134</a></div></div>
<div class="ttc" id="classTCPDF_html_a795063487ebbe283e4b5e74f66ee6e23"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a795063487ebbe283e4b5e74f66ee6e23">TCPDF\_putcatalog</a></div><div class="ttdeci">_putcatalog()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l09713">tcpdf.php:9713</a></div></div>
<div class="ttc" id="classTCPDF_html_a0ba200eb136effe5ff79cafed3f0fd92"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a0ba200eb136effe5ff79cafed3f0fd92">TCPDF\$CoreFonts</a></div><div class="ttdeci">$CoreFonts</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00318">tcpdf.php:318</a></div></div>
<div class="ttc" id="classTCPDF_html_ad09b32089f8e68c9d8424a2777627c21"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ad09b32089f8e68c9d8424a2777627c21">TCPDF\setViewerPreferences</a></div><div class="ttdeci">setViewerPreferences($preferences)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l14129">tcpdf.php:14129</a></div></div>
<div class="ttc" id="classTCPDF_html_a5d5b8dbfad7917b489603b4bc69dd9b8"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a5d5b8dbfad7917b489603b4bc69dd9b8">TCPDF\$tempfontsize</a></div><div class="ttdeci">$tempfontsize</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00758">tcpdf.php:758</a></div></div>
<div class="ttc" id="classTCPDF_html_abd475a94dce95a71e139e29d378d1dd4"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#abd475a94dce95a71e139e29d378d1dd4">TCPDF\$pageobjects</a></div><div class="ttdeci">$pageobjects</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00160">tcpdf.php:160</a></div></div>
<div class="ttc" id="classTCPDF_html_a3a38b9e6a4264d6e2c7dd6e0c7a88905"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a3a38b9e6a4264d6e2c7dd6e0c7a88905">TCPDF\$imagekeys</a></div><div class="ttdeci">$imagekeys</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01177">tcpdf.php:1177</a></div></div>
<div class="ttc" id="classTCPDF_html_adaef81b9b034e5d10c56b3f2fea83175"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#adaef81b9b034e5d10c56b3f2fea83175">TCPDF\getInternalPageNumberAliases</a></div><div class="ttdeci">getInternalPageNumberAliases($a= '')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l07855">tcpdf.php:7855</a></div></div>
<div class="ttc" id="classTCPDF_html_af5cab8b0e1e29a3ee19a14007e37bd99"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#af5cab8b0e1e29a3ee19a14007e37bd99">TCPDF\getNumLines</a></div><div class="ttdeci">getNumLines($txt, $w=0, $reseth=false, $autopadding=true, $cellpadding='', $border=0)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l06152">tcpdf.php:6152</a></div></div>
<div class="ttc" id="classTCPDF_html_ace5be60e7857953ea5e2b89cb90df0ae"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ace5be60e7857953ea5e2b89cb90df0ae">TCPDF\SetLink</a></div><div class="ttdeci">SetLink($link, $y=0, $page=-1)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l04731">tcpdf.php:4731</a></div></div>
<div class="ttc" id="classTCPDF_html_afe09291dfba7203e225a507e71e1d43e"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#afe09291dfba7203e225a507e71e1d43e">TCPDF\GetArrStringWidth</a></div><div class="ttdeci">GetArrStringWidth($sa, $fontname='', $fontstyle='', $fontsize=0, $getarray=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l04054">tcpdf.php:4054</a></div></div>
<div class="ttc" id="classTCPDF_html_a25b565e4885c362df7211dd7f3b9c4fa"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a25b565e4885c362df7211dd7f3b9c4fa">TCPDF\$default_monospaced_font</a></div><div class="ttdeci">$default_monospaced_font</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01226">tcpdf.php:1226</a></div></div>
<div class="ttc" id="classTCPDF_html_a36337c6c1101f048451ef83c054e011b"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a36337c6c1101f048451ef83c054e011b">TCPDF\$objcopy</a></div><div class="ttdeci">$objcopy</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01233">tcpdf.php:1233</a></div></div>
<div class="ttc" id="classTCPDF_html_a30c63dd9a18c06de743d3d6423e15a0d"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a30c63dd9a18c06de743d3d6423e15a0d">TCPDF\$annotation_fonts</a></div><div class="ttdeci">$annotation_fonts</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01380">tcpdf.php:1380</a></div></div>
<div class="ttc" id="classTCPDF_html_a2ade1952794fe6eb23191314fd74550c"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a2ade1952794fe6eb23191314fd74550c">TCPDF\getAbsFontMeasure</a></div><div class="ttdeci">getAbsFontMeasure($s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l04572">tcpdf.php:4572</a></div></div>
<div class="ttc" id="classTCPDF_html_a54142bcb00841f1e2be988fe37ad8dde"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a54142bcb00841f1e2be988fe37ad8dde">TCPDF\$svgunit</a></div><div class="ttdeci">$svgunit</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01610">tcpdf.php:1610</a></div></div>
<div class="ttc" id="tcpdf__config_8php_html_a47cb3659c4650130ba258727ca17f510"><div class="ttname"><a href="../../d5/dc0/tcpdf__config_8php.html#a47cb3659c4650130ba258727ca17f510">K_THAI_TOPCHARS</a></div><div class="ttdeci">const K_THAI_TOPCHARS</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dc0/tcpdf__config_8php_source.html#l00210">tcpdf_config.php:210</a></div></div>
<div class="ttc" id="classTCPDF_html_a945deedf891e7d49d60b3fe2a7cbbf95"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a945deedf891e7d49d60b3fe2a7cbbf95">TCPDF\$print_header</a></div><div class="ttdeci">$print_header</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00625">tcpdf.php:625</a></div></div>
<div class="ttc" id="classTCPDF_html_afd56e360c43553830d543323e81bc045"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#afd56e360c43553830d543323e81bc045">TCPDF\SetFont</a></div><div class="ttdeci">SetFont($family, $style='', $size=null, $fontfile='', $subset='default', $out=true)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l04465">tcpdf.php:4465</a></div></div>
<div class="ttc" id="classTCPDF_html_a3f31f18974b7e7626d8fc99dbbe51d90"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a3f31f18974b7e7626d8fc99dbbe51d90">TCPDF\_putresources</a></div><div class="ttdeci">_putresources()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l09491">tcpdf.php:9491</a></div></div>
<div class="ttc" id="classTCPDF_html_a906d52a85a3f7efd4949f6c05132e1a9"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a906d52a85a3f7efd4949f6c05132e1a9">TCPDF\$embeddedfiles</a></div><div class="ttdeci">$embeddedfiles</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01120">tcpdf.php:1120</a></div></div>
<div class="ttc" id="classTCPDF_html_a7d007815ed4a9c0aa036f6de09e81c3b"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a7d007815ed4a9c0aa036f6de09e81c3b">TCPDF\unichr</a></div><div class="ttdeci">unichr($c)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l04172">tcpdf.php:4172</a></div></div>
<div class="ttc" id="classTCPDF_html_a0c5df96854236ada4bd14962d9ddbbb5"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a0c5df96854236ada4bd14962d9ddbbb5">TCPDF\lastPage</a></div><div class="ttdeci">lastPage($resetmargins=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l03048">tcpdf.php:3048</a></div></div>
<div class="ttc" id="classTCPDF_html_ada0489b022bfd41ff1fa7a3fd666831a"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ada0489b022bfd41ff1fa7a3fd666831a">TCPDF\Arrow</a></div><div class="ttdeci">Arrow($x0, $y0, $x1, $y1, $head_style=0, $arm_size=5, $arm_angle=15)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l12259">tcpdf.php:12259</a></div></div>
<div class="ttc" id="classTCPDF_html_aef325c0f70f72018cd52744380c56d47"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aef325c0f70f72018cd52744380c56d47">TCPDF\$re_space</a></div><div class="ttdeci">$re_space</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01317">tcpdf.php:1317</a></div></div>
<div class="ttc" id="classTCPDF_html_af5e5357f5db0128c824f0a22cab63719"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#af5e5357f5db0128c824f0a22cab63719">TCPDF\_outLine</a></div><div class="ttdeci">_outLine($x, $y)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l11516">tcpdf.php:11516</a></div></div>
<div class="ttc" id="classTCPDF_html_acb8e8249a228d343d4c5254f8cd6c75a"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#acb8e8249a228d343d4c5254f8cd6c75a">TCPDF\$viewer_preferences</a></div><div class="ttdeci">$viewer_preferences</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00931">tcpdf.php:931</a></div></div>
<div class="ttc" id="classTCPDF_html_ae6e2854e4d5c71966ef5121934c24566"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ae6e2854e4d5c71966ef5121934c24566">TCPDF\SetTextColorArray</a></div><div class="ttdeci">SetTextColorArray($color, $ret=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l03881">tcpdf.php:3881</a></div></div>
<div class="ttc" id="classTCPDF_html_ae19b61fda7662a88bda031589ae95e32"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ae19b61fda7662a88bda031589ae95e32">TCPDF\_escapetext</a></div><div class="ttdeci">_escapetext($s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l10334">tcpdf.php:10334</a></div></div>
<div class="ttc" id="classTCPDF_html_a73ce7a4a68a80ec0efb9317b15819ab4"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a73ce7a4a68a80ec0efb9317b15819ab4">TCPDF\_fixAES256Password</a></div><div class="ttdeci">_fixAES256Password($password)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l10824">tcpdf.php:10824</a></div></div>
<div class="ttc" id="classTCPDF_html_a87afce48ac2a2849fbb1f5e923e75c0b"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a87afce48ac2a2849fbb1f5e923e75c0b">TCPDF\drawHTMLTagBorder</a></div><div class="ttdeci">drawHTMLTagBorder($tag, $xmax)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l20029">tcpdf.php:20029</a></div></div>
<div class="ttc" id="classTCPDF_html_a1185953f1c5222a3d048f4cde6500300"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a1185953f1c5222a3d048f4cde6500300">TCPDF\setFooterData</a></div><div class="ttdeci">setFooterData($tc=array(0, 0, 0), $lc=array(0, 0, 0))</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l03278">tcpdf.php:3278</a></div></div>
<div class="ttc" id="classTCPDF_html_a8458280d15b73d3baffb28eebe2d9246"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a8458280d15b73d3baffb28eebe2d9246">TCPDF\writeHTMLCell</a></div><div class="ttdeci">writeHTMLCell($w, $h, $x, $y, $html='', $border=0, $ln=0, $fill=false, $reseth=true, $align='', $autopadding=true)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l17197">tcpdf.php:17197</a></div></div>
<div class="ttc" id="classTCPDF_html_abb4e21366924e76df3400312434d95e1"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#abb4e21366924e76df3400312434d95e1">TCPDF\$subject</a></div><div class="ttdeci">$subject</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00494">tcpdf.php:494</a></div></div>
<div class="ttc" id="classTCPDF_html_a90ad3198737e6fead5791fa317a8a1f0"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a90ad3198737e6fead5791fa317a8a1f0">TCPDF\setCellHeightRatio</a></div><div class="ttdeci">setCellHeightRatio($h)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l14092">tcpdf.php:14092</a></div></div>
<div class="ttc" id="classTCPDF_html_af73382321461f24798a639c2f433a67f"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#af73382321461f24798a639c2f433a67f">TCPDF\getPageGroupAlias</a></div><div class="ttdeci">getPageGroupAlias()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l13758">tcpdf.php:13758</a></div></div>
<div class="ttc" id="classTCPDF_html_af4e98dda815a0a7123c6480a951b4e24"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#af4e98dda815a0a7123c6480a951b4e24">TCPDF\setImageScale</a></div><div class="ttdeci">setImageScale($scale)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02467">tcpdf.php:2467</a></div></div>
<div class="ttc" id="classTCPDF_html_aa486c0cad639e303d878b1f4b5ef772e"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aa486c0cad639e303d878b1f4b5ef772e">TCPDF\_Uvalue</a></div><div class="ttdeci">_Uvalue()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l10726">tcpdf.php:10726</a></div></div>
<div class="ttc" id="classTCPDF_html_a0e77f99c65a62b6af3d07419e4750bc5"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a0e77f99c65a62b6af3d07419e4750bc5">TCPDF\$lisymbol</a></div><div class="ttdeci">$lisymbol</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01057">tcpdf.php:1057</a></div></div>
<div class="ttc" id="classTCPDF_html_a420a1fac2969936a7d57f4cb9c99849b"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a420a1fac2969936a7d57f4cb9c99849b">TCPDF\$font_stretching</a></div><div class="ttdeci">$font_stretching</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01547">tcpdf.php:1547</a></div></div>
<div class="ttc" id="classTCPDF_html_aee936c5d712d93615fff662e6393316a"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aee936c5d712d93615fff662e6393316a">TCPDF\SetAbsXY</a></div><div class="ttdeci">SetAbsXY($x, $y)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l07569">tcpdf.php:7569</a></div></div>
<div class="ttc" id="classTCPDF_html_a6669ae88090963e9487d0388c7577dc9"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a6669ae88090963e9487d0388c7577dc9">TCPDF\Write</a></div><div class="ttdeci">Write($h, $txt, $link='', $fill=false, $align='', $ln=false, $stretch=0, $firstline=false, $firstblock=false, $maxh=0, $wadj=0, $margin='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l06304">tcpdf.php:6304</a></div></div>
<div class="ttc" id="classTCPDF_html_a58f2abc77f4289613100fcf64c52f0ae"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a58f2abc77f4289613100fcf64c52f0ae">TCPDF\$default_table_columns</a></div><div class="ttdeci">$default_table_columns</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00696">tcpdf.php:696</a></div></div>
<div class="ttc" id="classTCPDF_html_ace119a75cb1f30b4b8b9852d160baeff"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ace119a75cb1f30b4b8b9852d160baeff">TCPDF\$k</a></div><div class="ttdeci">$k</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00202">tcpdf.php:202</a></div></div>
<div class="ttc" id="classTCPDF_html_a71afe1786fa1c806b0e64b516c715b03"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a71afe1786fa1c806b0e64b516c715b03">TCPDF\setOpenCell</a></div><div class="ttdeci">setOpenCell($isopen)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l20314">tcpdf.php:20314</a></div></div>
<div class="ttc" id="classTCPDF_html_ae11c5f52caa0df8609ec22c30cd54055"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ae11c5f52caa0df8609ec22c30cd54055">TCPDF\getAliasNumPage</a></div><div class="ttdeci">getAliasNumPage()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l13743">tcpdf.php:13743</a></div></div>
<div class="ttc" id="classTCPDF_html_ae4db27f9e17c4a6f48117669fa94a1bb"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ae4db27f9e17c4a6f48117669fa94a1bb">TCPDF\$bordermrk</a></div><div class="ttdeci">$bordermrk</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00959">tcpdf.php:959</a></div></div>
<div class="ttc" id="classTCPDF_html_abf1daa47cbb1f2abe310d19124a1e35e"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#abf1daa47cbb1f2abe310d19124a1e35e">TCPDF\Text</a></div><div class="ttdeci">Text($x, $y, $txt, $fstroke=false, $fclip=false, $ffill=true, $border=0, $ln=0, $align='', $fill=false, $link='', $stretch=0, $ignore_min_height=false, $calign='T', $valign='M', $rtloff=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l04925">tcpdf.php:4925</a></div></div>
<div class="ttc" id="classTCPDF_html_a41e87b05a84dd56c2c824af49470e295"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a41e87b05a84dd56c2c824af49470e295">TCPDF\$lasth</a></div><div class="ttdeci">$lasth</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00306">tcpdf.php:306</a></div></div>
<div class="ttc" id="classTCPDF_html_ac138de610bac7bee8885178db32dcea0"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ac138de610bac7bee8885178db32dcea0">TCPDF\PieSector</a></div><div class="ttdeci">PieSector($xc, $yc, $r, $a, $b, $style='FD', $cw=true, $o=90)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l14887">tcpdf.php:14887</a></div></div>
<div class="ttc" id="classTCPDF_html_a1fc76cf135e8b98b3f654461d8345a57"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a1fc76cf135e8b98b3f654461d8345a57">TCPDF\_addfield</a></div><div class="ttdeci">_addfield($type, $name, $x, $y, $w, $h, $prop)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l12698">tcpdf.php:12698</a></div></div>
<div class="ttc" id="classTCPDF_html_a8637af5bc22147a813797a4fbda3dba2"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a8637af5bc22147a813797a4fbda3dba2">TCPDF\_objectkey</a></div><div class="ttdeci">_objectkey($n)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l10558">tcpdf.php:10558</a></div></div>
<div class="ttc" id="classTCPDF_html_a02c319c0adc5a464351d428ae4602aae"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a02c319c0adc5a464351d428ae4602aae">TCPDF\startPage</a></div><div class="ttdeci">startPage($orientation='', $format='', $tocpage=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l03158">tcpdf.php:3158</a></div></div>
<div class="ttc" id="classTCPDF_html_a7c7c1beebd83fa777197a842f2ca73eb"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a7c7c1beebd83fa777197a842f2ca73eb">TCPDF\_getrawstream</a></div><div class="ttdeci">_getrawstream($s, $n=0)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l10354">tcpdf.php:10354</a></div></div>
<div class="ttc" id="classTCPDF_html_a1f87a9ca1927053aed6c3188edeb1d28"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a1f87a9ca1927053aed6c3188edeb1d28">TCPDF\$listindentlevel</a></div><div class="ttdeci">$listindentlevel</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00746">tcpdf.php:746</a></div></div>
<div class="ttc" id="classTCPDF_html_ac57877b76c37aef3195ad45731715b9e"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ac57877b76c37aef3195ad45731715b9e">TCPDF\_out</a></div><div class="ttdeci">_out($s)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l10389">tcpdf.php:10389</a></div></div>
<div class="ttc" id="classTCPDF_html_a4702bedfb7ce4c5260c12d3637419c7a"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a4702bedfb7ce4c5260c12d3637419c7a">TCPDF\$force_srgb</a></div><div class="ttdeci">$force_srgb</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01758">tcpdf.php:1758</a></div></div>
<div class="ttc" id="classTCPDF_html_a712ce18cedd4b397a0375d9972f6aea8"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a712ce18cedd4b397a0375d9972f6aea8">TCPDF\$header_text_color</a></div><div class="ttdeci">$header_text_color</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00662">tcpdf.php:662</a></div></div>
<div class="ttc" id="classTCPDF_html_a13f370f8e1553105eaa3553f52c3fc6c"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a13f370f8e1553105eaa3553f52c3fc6c">TCPDF\inPageBody</a></div><div class="ttdeci">inPageBody()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l03619">tcpdf.php:3619</a></div></div>
<div class="ttc" id="classTCPDF_html_a90bee4debe4218064059014965f8d52a"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a90bee4debe4218064059014965f8d52a">TCPDF\$original_lMargin</a></div><div class="ttdeci">$original_lMargin</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00588">tcpdf.php:588</a></div></div>
<div class="ttc" id="classTCPDF_html_a45310f49168f541285b71f190645ff45"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a45310f49168f541285b71f190645ff45">TCPDF\$textrendermode</a></div><div class="ttdeci">$textrendermode</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01471">tcpdf.php:1471</a></div></div>
<div class="ttc" id="classTCPDF_html_a0d8075a3d1489875d600e7735c790929"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a0d8075a3d1489875d600e7735c790929">TCPDF\getCSSFontStretching</a></div><div class="ttdeci">getCSSFontStretching($stretch, $parent=100)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l16241">tcpdf.php:16241</a></div></div>
<div class="ttc" id="classTCPDF_html_a1f5bcb7dd420836d8f1a287ff4b5a08e"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a1f5bcb7dd420836d8f1a287ff4b5a08e">TCPDF\getAlpha</a></div><div class="ttdeci">getAlpha()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l14059">tcpdf.php:14059</a></div></div>
<div class="ttc" id="classTCPDF_html_aa043d6a67959c785e8decc6ef1400cd8"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aa043d6a67959c785e8decc6ef1400cd8">TCPDF\$barcode</a></div><div class="ttdeci">$barcode</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00619">tcpdf.php:619</a></div></div>
<div class="ttc" id="classTCPDF_html_a3f214500dcd7555dd9e7cfc2a0130086"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a3f214500dcd7555dd9e7cfc2a0130086">TCPDF\$svgdefs</a></div><div class="ttdeci">$svgdefs</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01638">tcpdf.php:1638</a></div></div>
<div class="ttc" id="classTCPDF_html_a9ce01e710ad7b958dbb41269770461f5"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a9ce01e710ad7b958dbb41269770461f5">TCPDF\$PageAnnots</a></div><div class="ttdeci">$PageAnnots</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00354">tcpdf.php:354</a></div></div>
<div class="ttc" id="classTCPDF_html_ad19f623e09f67dd7fbd433196f804ec1"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ad19f623e09f67dd7fbd433196f804ec1">TCPDF\MirrorL</a></div><div class="ttdeci">MirrorL($angle=0, $x='', $y='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l11220">tcpdf.php:11220</a></div></div>
<div class="ttc" id="classTCPDF_html_aa57e6af79ccaf81eeeeb97d5eae93ecf"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aa57e6af79ccaf81eeeeb97d5eae93ecf">TCPDF\StarPolygon</a></div><div class="ttdeci">StarPolygon($x0, $y0, $r, $nv, $ng, $angle=0, $draw_circle=false, $style='', $line_style=array(), $fill_color=array(), $circle_style='', $circle_outLine_style=array(), $circle_fill_color=array())</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l12128">tcpdf.php:12128</a></div></div>
<div class="ttc" id="classTCPDF_html_a7a008584775e8222aa88781cb677c514"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a7a008584775e8222aa88781cb677c514">TCPDF\$w</a></div><div class="ttdeci">$w</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00232">tcpdf.php:232</a></div></div>
<div class="ttc" id="classTCPDF_html_a69d53096e1daf8973011f291c78e4139"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a69d53096e1daf8973011f291c78e4139">TCPDF\$PageMode</a></div><div class="ttdeci">$PageMode</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00938">tcpdf.php:938</a></div></div>
<div class="ttc" id="classTCPDF_html_ac78410b152f371b7239405ba246cee92"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ac78410b152f371b7239405ba246cee92">TCPDF\$currpagegroup</a></div><div class="ttdeci">$currpagegroup</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00903">tcpdf.php:903</a></div></div>
<div class="ttc" id="classTCPDF_html_a01ab8d5030f2862528e88607174f5fee"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a01ab8d5030f2862528e88607174f5fee">TCPDF\readDiskCache</a></div><div class="ttdeci">readDiskCache($filename, $unserialize=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l20803">tcpdf.php:20803</a></div></div>
<div class="ttc" id="classTCPDF_html_a0757c5909a61c91c055d5867c57e0d3e"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a0757c5909a61c91c055d5867c57e0d3e">TCPDF\$feps</a></div><div class="ttdeci">$feps</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01092">tcpdf.php:1092</a></div></div>
<div class="ttc" id="classTCPDF_html_aae16fb109eb4f3aaa9ba860cfb1cf1f2"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aae16fb109eb4f3aaa9ba860cfb1cf1f2">TCPDF\swapMargins</a></div><div class="ttdeci">swapMargins($reverse=true)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l20270">tcpdf.php:20270</a></div></div>
<div class="ttc" id="classTCPDF_html_a3f4d91c3489a2c62b628c347551f7adf"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a3f4d91c3489a2c62b628c347551f7adf">TCPDF\$font_spacing</a></div><div class="ttdeci">$font_spacing</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01554">tcpdf.php:1554</a></div></div>
<div class="ttc" id="classTCPDF_html_a127e3d16c986f858bfbe189c535c6ada"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a127e3d16c986f858bfbe189c535c6ada">TCPDF\$sig_obj_id</a></div><div class="ttdeci">$sig_obj_id</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01324">tcpdf.php:1324</a></div></div>
<div class="ttc" id="classTCPDF_html_a8a0828e6deefbe232d94e55cdb816fa1"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a8a0828e6deefbe232d94e55cdb816fa1">TCPDF\_dolinethrough</a></div><div class="ttdeci">_dolinethrough($x, $y, $txt)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l10190">tcpdf.php:10190</a></div></div>
<div class="ttc" id="classTCPDF_html_a996258e3c16a3bb8de1f5c1ff8b8c9d8"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a996258e3c16a3bb8de1f5c1ff8b8c9d8">TCPDF\endLayer</a></div><div class="ttdeci">endLayer()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l13863">tcpdf.php:13863</a></div></div>
<div class="ttc" id="classTCPDF_html_a8dc91462430bd190502e04aec229153f"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a8dc91462430bd190502e04aec229153f">TCPDF\setPrintFooter</a></div><div class="ttdeci">setPrintFooter($val=true)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l03354">tcpdf.php:3354</a></div></div>
<div class="ttc" id="classTCPDF_html_a06342f489c3f60c456c95a825217629b"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a06342f489c3f60c456c95a825217629b">TCPDF\MirrorV</a></div><div class="ttdeci">MirrorV($y='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l11195">tcpdf.php:11195</a></div></div>
<div class="ttc" id="classTCPDF_html_a33b265e5eb3e4d1d4fedfe29f8166f31"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a33b265e5eb3e4d1d4fedfe29f8166f31">TCPDF\Cell</a></div><div class="ttdeci">Cell($w, $h=0, $txt='', $border=0, $ln=0, $align='', $fill=false, $link='', $stretch=0, $ignore_min_height=false, $calign='T', $valign='M')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l05026">tcpdf.php:5026</a></div></div>
<div class="ttc" id="classTCPDF_html_abde8cefba6202d748b708b515bfce9ce"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#abde8cefba6202d748b708b515bfce9ce">TCPDF\$header_logo</a></div><div class="ttdeci">$header_logo</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00637">tcpdf.php:637</a></div></div>
<div class="ttc" id="classTCPDF_html_aa3deb91c4ae36afa6253c831df589b3d"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aa3deb91c4ae36afa6253c831df589b3d">TCPDF\getBarcode</a></div><div class="ttdeci">getBarcode()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l15281">tcpdf.php:15281</a></div></div>
<div class="ttc" id="classTCPDF_html_a06741a9ee7ad2babd6c212d50701dca8"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a06741a9ee7ad2babd6c212d50701dca8">TCPDF\$pdfunit</a></div><div class="ttdeci">$pdfunit</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01492">tcpdf.php:1492</a></div></div>
<div class="ttc" id="classTCPDF_html_ad3439990de56253b039bca6a09305758"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ad3439990de56253b039bca6a09305758">TCPDF\SetY</a></div><div class="ttdeci">SetY($y, $resetx=true, $rtloff=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l07501">tcpdf.php:7501</a></div></div>
<div class="ttc" id="classTCPDF_html_abe8ea9785cede5c50969a8c2a37aae84"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#abe8ea9785cede5c50969a8c2a37aae84">TCPDF\$numfonts</a></div><div class="ttdeci">$numfonts</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01198">tcpdf.php:1198</a></div></div>
<div class="ttc" id="classTCPDF_html_a6478721dced8d81bbed6aed8dbe5a4d1"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a6478721dced8d81bbed6aed8dbe5a4d1">TCPDF\$endlinex</a></div><div class="ttdeci">$endlinex</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01001">tcpdf.php:1001</a></div></div>
<div class="ttc" id="classTCPDF_html_a7a19b2f2308c1f3a4ddb97447cb5ee90"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a7a19b2f2308c1f3a4ddb97447cb5ee90">TCPDF\setBuffer</a></div><div class="ttdeci">setBuffer($data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l20823">tcpdf.php:20823</a></div></div>
<div class="ttc" id="classTCPDF_html_a6ad1b9e1a4efc3d80e3867ceb430cb09"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a6ad1b9e1a4efc3d80e3867ceb430cb09">TCPDF\$n</a></div><div class="ttdeci">$n</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00148">tcpdf.php:148</a></div></div>
<div class="ttc" id="classTCPDF_html_afbe8a897cf05ec784297f9b660c698b7"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#afbe8a897cf05ec784297f9b660c698b7">TCPDF\SetKeywords</a></div><div class="ttdeci">SetKeywords($keywords)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02906">tcpdf.php:2906</a></div></div>
<div class="ttc" id="classTCPDF_html_aa316f47dbdd13a6dd2897d6be347cbbb"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aa316f47dbdd13a6dd2897d6be347cbbb">TCPDF\_outSaveGraphicsState</a></div><div class="ttdeci">_outSaveGraphicsState()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l20751">tcpdf.php:20751</a></div></div>
<div class="ttc" id="classTCPDF_html_afddcb4a76989be254dc5a4eb4e1e0c90"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#afddcb4a76989be254dc5a4eb4e1e0c90">TCPDF\setSignatureAppearance</a></div><div class="ttdeci">setSignatureAppearance($x=0, $y=0, $w=0, $h=0, $page=-1, $name='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l13569">tcpdf.php:13569</a></div></div>
<div class="ttc" id="classTCPDF_html_a185c0c5c32718d210add5f1be3b2b14e"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a185c0c5c32718d210add5f1be3b2b14e">TCPDF\$print_footer</a></div><div class="ttdeci">$print_footer</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00631">tcpdf.php:631</a></div></div>
<div class="ttc" id="classTCPDF_html_a5171e20b366b74523709d84c349c1ced"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a5171e20b366b74523709d84c349c1ced">TCPDF\AddPage</a></div><div class="ttdeci">AddPage($orientation='', $format='', $keepmargins=false, $tocpage=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l03108">tcpdf.php:3108</a></div></div>
<div class="ttc" id="classTCPDF_html_a5c3ee3344be02f70dcd5b3db312b28f0"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a5c3ee3344be02f70dcd5b3db312b28f0">TCPDF\$header_logo_width</a></div><div class="ttdeci">$header_logo_width</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00643">tcpdf.php:643</a></div></div>
<div class="ttc" id="classTCPDF_html_a996483e91d4c2567d354e3c4a755d4bc"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a996483e91d4c2567d354e3c4a755d4bc">TCPDF\setPageRegions</a></div><div class="ttdeci">setPageRegions($regions=array())</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l22727">tcpdf.php:22727</a></div></div>
<div class="ttc" id="classTCPDF_html_aa6e5b824889f7c484cc76ce1c134e2ed"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aa6e5b824889f7c484cc76ce1c134e2ed">TCPDF\getPage</a></div><div class="ttdeci">getPage()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l03059">tcpdf.php:3059</a></div></div>
<div class="ttc" id="classTCPDF_html_a8a4701753ef6b45df310b34cecde6497"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a8a4701753ef6b45df310b34cecde6497">TCPDF\setBookmark</a></div><div class="ttdeci">setBookmark($txt, $level=0, $y=-1, $page='', $style='', $color=array(0, 0, 0), $x=-1, $link='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l12403">tcpdf.php:12403</a></div></div>
<div class="ttc" id="classTCPDF_html_a25c7f71b3fcb19024497ea620f885346"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a25c7f71b3fcb19024497ea620f885346">TCPDF\getCellHeight</a></div><div class="ttdeci">getCellHeight($fontsize, $padding=TRUE)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02433">tcpdf.php:2433</a></div></div>
<div class="ttc" id="classTCPDF_html_a50525de041ad2206e3a360bc99dabd19"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a50525de041ad2206e3a360bc99dabd19">TCPDF\$pagedim</a></div><div class="ttdeci">$pagedim</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00196">tcpdf.php:196</a></div></div>
<div class="ttc" id="classTCPDF_html_ad12417c3708effd84de35320ac10077a"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ad12417c3708effd84de35320ac10077a">TCPDF\$font_subsetting</a></div><div class="ttdeci">$font_subsetting</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01512">tcpdf.php:1512</a></div></div>
<div class="ttc" id="classTCPDF_html_aab81c25eefaf486adf004eb20bc22881"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aab81c25eefaf486adf004eb20bc22881">TCPDF\$current_column</a></div><div class="ttdeci">$current_column</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01443">tcpdf.php:1443</a></div></div>
<div class="ttc" id="classTCPDF_html_a42fd9a6c1fdd354da7e199c730f1c0f7"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a42fd9a6c1fdd354da7e199c730f1c0f7">TCPDF\_dounderlinew</a></div><div class="ttdeci">_dounderlinew($x, $y, $w)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l10178">tcpdf.php:10178</a></div></div>
<div class="ttc" id="classTCPDF_html_a47928b951e68ff27c1b4f39523aaeef7"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a47928b951e68ff27c1b4f39523aaeef7">TCPDF\$header_string</a></div><div class="ttdeci">$header_string</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00655">tcpdf.php:655</a></div></div>
<div class="ttc" id="classTCPDF_html_a66ab086d27a31dd0a7a7c69ea87b3767"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a66ab086d27a31dd0a7a7c69ea87b3767">TCPDF\$listindent</a></div><div class="ttdeci">$listindent</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00740">tcpdf.php:740</a></div></div>
<div class="ttc" id="classTCPDF_html_a951ded3fd87dba651b96586dc39bf1a8"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a951ded3fd87dba651b96586dc39bf1a8">TCPDF\setExtraXMP</a></div><div class="ttdeci">setExtraXMP($xmp)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l09565">tcpdf.php:9565</a></div></div>
<div class="ttc" id="classTCPDF_html_abdc6aa462bc81023df2ec043742bcb4b"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#abdc6aa462bc81023df2ec043742bcb4b">TCPDF\stringTrim</a></div><div class="ttdeci">stringTrim($str, $replace='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l22371">tcpdf.php:22371</a></div></div>
<div class="ttc" id="classTCPDF_html_a8e520f160f6725a4f0a7d7affc67cbd8"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a8e520f160f6725a4f0a7d7affc67cbd8">TCPDF\getAllSpotColors</a></div><div class="ttdeci">getAllSpotColors()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l03705">tcpdf.php:3705</a></div></div>
<div class="ttc" id="classTCPDF_html_a79695745bece08e32a7899f8217bf74d"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a79695745bece08e32a7899f8217bf74d">TCPDF\getCSSBorderWidth</a></div><div class="ttdeci">getCSSBorderWidth($width)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l15961">tcpdf.php:15961</a></div></div>
<div class="ttc" id="classTCPDF_html_af037a681d72f4eeaecd641680257a16f"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#af037a681d72f4eeaecd641680257a16f">TCPDF\_endpage</a></div><div class="ttdeci">_endpage()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l10126">tcpdf.php:10126</a></div></div>
<div class="ttc" id="classTCPDF_html_a6140a1ff2c5ed3f490592b6917f5adf3"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a6140a1ff2c5ed3f490592b6917f5adf3">TCPDF\SetCompression</a></div><div class="ttdeci">SetCompression($compress=true)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02837">tcpdf.php:2837</a></div></div>
<div class="ttc" id="classTCPDF_html_ae950ca495f922385c27c6ded218c3cfa"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ae950ca495f922385c27c6ded218c3cfa">TCPDF\$state</a></div><div class="ttdeci">$state</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00178">tcpdf.php:178</a></div></div>
<div class="ttc" id="classTCPDF_html_af1db92d221fd87c76d7c607f32266d0a"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#af1db92d221fd87c76d7c607f32266d0a">TCPDF\fitBlock</a></div><div class="ttdeci">fitBlock($w, $h, $x, $y, $fitonpage=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l06755">tcpdf.php:6755</a></div></div>
<div class="ttc" id="classTCPDF_html_ac80fd149e908cb48ea0c796f5bc7961b"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ac80fd149e908cb48ea0c796f5bc7961b">TCPDF\_putxobjects</a></div><div class="ttdeci">_putxobjects()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l09292">tcpdf.php:9292</a></div></div>
<div class="ttc" id="classTCPDF_html_a7dc662e76aa078c76ef4f6c19afa7d98"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a7dc662e76aa078c76ef4f6c19afa7d98">TCPDF\_datestring</a></div><div class="ttdeci">_datestring($n=0, $timestamp=0)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l10304">tcpdf.php:10304</a></div></div>
<div class="ttc" id="classTCPDF_html_afde44c5da51ba62be8c27491975c528f"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#afde44c5da51ba62be8c27491975c528f">TCPDF\$outlines</a></div><div class="ttdeci">$outlines</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00838">tcpdf.php:838</a></div></div>
<div class="ttc" id="classTCPDF_html_abc79f156bc4418c5446e81653519c632"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#abc79f156bc4418c5446e81653519c632">TCPDF\getCharBBox</a></div><div class="ttdeci">getCharBBox($char)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l04582">tcpdf.php:4582</a></div></div>
<div class="ttc" id="classTCPDF_html_a0a25521fa461d9d52aabce5687795650"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a0a25521fa461d9d52aabce5687795650">TCPDF\stringLeftTrim</a></div><div class="ttdeci">stringLeftTrim($str, $replace='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l22345">tcpdf.php:22345</a></div></div>
<div class="ttc" id="classTCPDF_html_a7530cee43f2dbb68f0b1370b73d1cb59"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a7530cee43f2dbb68f0b1370b73d1cb59">TCPDF\$cell_padding</a></div><div class="ttdeci">$cell_padding</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00281">tcpdf.php:281</a></div></div>
<div class="ttc" id="classTCPDF_html_a803fd6fac1ef9574bdd67dac9583edf7"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a803fd6fac1ef9574bdd67dac9583edf7">TCPDF\_dooverline</a></div><div class="ttdeci">_dooverline($x, $y, $txt)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l10216">tcpdf.php:10216</a></div></div>
<div class="ttc" id="classTCPDF_html_a5971d565157974939d3edf96baeb0eeb"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a5971d565157974939d3edf96baeb0eeb">TCPDF\$LineWidth</a></div><div class="ttdeci">$LineWidth</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00312">tcpdf.php:312</a></div></div>
<div class="ttc" id="classTCPDF_html_a39aa922f08cdbb517438aaaef43e9cb5"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a39aa922f08cdbb517438aaaef43e9cb5">TCPDF\hyphenateWord</a></div><div class="ttdeci">hyphenateWord($word, $patterns, $dictionary=array(), $leftmin=1, $rightmin=2, $charmin=1, $charmax=8)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l22162">tcpdf.php:22162</a></div></div>
<div class="ttc" id="classTCPDF_html_a04f8930e0bdba4d6c1462425cb75fb5f"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a04f8930e0bdba4d6c1462425cb75fb5f">TCPDF\$crMargin</a></div><div class="ttdeci">$crMargin</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00262">tcpdf.php:262</a></div></div>
<div class="ttc" id="classTCPDF_html_af2999e4e50aa693faf0d7c0009dfa43c"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#af2999e4e50aa693faf0d7c0009dfa43c">TCPDF\_dolinethroughw</a></div><div class="ttdeci">_dolinethroughw($x, $y, $w)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l10203">tcpdf.php:10203</a></div></div>
<div class="ttc" id="classTCPDF_html_aa29f2cb5b3679f1c6658e2a1e775bcb3"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aa29f2cb5b3679f1c6658e2a1e775bcb3">TCPDF\$header_font</a></div><div class="ttdeci">$header_font</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00601">tcpdf.php:601</a></div></div>
<div class="ttc" id="classTCPDF_html_a7e7f5d97a5c33e2245d3860aed35a593"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a7e7f5d97a5c33e2245d3860aed35a593">TCPDF\Circle</a></div><div class="ttdeci">Circle($x0, $y0, $r, $angstr=0, $angend=360, $style='', $line_style=array(), $fill_color=array(), $nc=2)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l11942">tcpdf.php:11942</a></div></div>
<div class="ttc" id="classTCPDF_html_a7cd52df1697c10362b74645261fb38f1"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a7cd52df1697c10362b74645261fb38f1">TCPDF\getCSSBorderDashStyle</a></div><div class="ttdeci">getCSSBorderDashStyle($style)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l15981">tcpdf.php:15981</a></div></div>
<div class="ttc" id="classTCPDF_html_a8f5242efde7c458dd3ec011f52010503"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a8f5242efde7c458dd3ec011f52010503">TCPDF\commitTransaction</a></div><div class="ttdeci">commitTransaction()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l21841">tcpdf.php:21841</a></div></div>
<div class="ttc" id="classTCPDF_html_a1d8b1b2420194c155de303fac195264f"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a1d8b1b2420194c155de303fac195264f">TCPDF\setListIndentWidth</a></div><div class="ttdeci">setListIndentWidth($width)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l20304">tcpdf.php:20304</a></div></div>
<div class="ttc" id="classTCPDF_html_a77e62aa96deef4fed708e97c11cbac05"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a77e62aa96deef4fed708e97c11cbac05">TCPDF\setDefaultTableColumns</a></div><div class="ttdeci">setDefaultTableColumns($cols=4)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l14082">tcpdf.php:14082</a></div></div>
<div class="ttc" id="classTCPDF_html_ade9ed50def3b504470fe4f157092e7e2"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ade9ed50def3b504470fe4f157092e7e2">TCPDF\$textindent</a></div><div class="ttdeci">$textindent</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01401">tcpdf.php:1401</a></div></div>
<div class="ttc" id="classTCPDF_html_a63fc9b0fba1a33cc5d27588f3e512df8"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a63fc9b0fba1a33cc5d27588f3e512df8">TCPDF\$footer_font</a></div><div class="ttdeci">$footer_font</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00607">tcpdf.php:607</a></div></div>
<div class="ttc" id="classTCPDF_html_a792338a2edffd53283684c4b355611c7"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a792338a2edffd53283684c4b355611c7">TCPDF\$form_enctype</a></div><div class="ttdeci">$form_enctype</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01366">tcpdf.php:1366</a></div></div>
<div class="ttc" id="classTCPDF_html_a106771c9857d515f45619020ec2bf5c6"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a106771c9857d515f45619020ec2bf5c6">TCPDF\$OutlineRoot</a></div><div class="ttdeci">$OutlineRoot</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00845">tcpdf.php:845</a></div></div>
<div class="ttc" id="classTCPDF_html_ae5dd5203ba48e26efcb24a6a6cabbb42"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ae5dd5203ba48e26efcb24a6a6cabbb42">TCPDF\$numpages</a></div><div class="ttdeci">$numpages</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01156">tcpdf.php:1156</a></div></div>
<div class="ttc" id="classTCPDF_html_aebb91d5d8046cf1b91b65d3a2d8694be"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aebb91d5d8046cf1b91b65d3a2d8694be">TCPDF\getCellMargins</a></div><div class="ttdeci">getCellMargins()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02710">tcpdf.php:2710</a></div></div>
<div class="ttc" id="classTCPDF_html_ab3fe86d6cc29768a5f1559585015e711"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ab3fe86d6cc29768a5f1559585015e711">TCPDF\$xobjects</a></div><div class="ttdeci">$xobjects</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01526">tcpdf.php:1526</a></div></div>
<div class="ttc" id="classTCPDF_html_aeb84582f37f9d68c1a9f5723849d0009"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aeb84582f37f9d68c1a9f5723849d0009">TCPDF\setEqualColumns</a></div><div class="ttdeci">setEqualColumns($numcols=0, $width=0, $y='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l21887">tcpdf.php:21887</a></div></div>
<div class="ttc" id="classTCPDF_html_ad80a884a2336e06f2f8ed9b8c31d11c9"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ad80a884a2336e06f2f8ed9b8c31d11c9">TCPDF\ScaleX</a></div><div class="ttdeci">ScaleX($s_x, $x='', $y='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l11111">tcpdf.php:11111</a></div></div>
<div class="ttc" id="classTCPDF_html_a5b0c0782a3d4238495cb23e4e17ed13d"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a5b0c0782a3d4238495cb23e4e17ed13d">TCPDF\_putcidfont0</a></div><div class="ttdeci">_putcidfont0($font)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l09093">tcpdf.php:9093</a></div></div>
<div class="ttc" id="classTCPDF_html_a568b961f0419fcc3edd28f9bb50bab86"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a568b961f0419fcc3edd28f9bb50bab86">TCPDF\setRasterizeVectorImages</a></div><div class="ttdeci">setRasterizeVectorImages($mode)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l22306">tcpdf.php:22306</a></div></div>
<div class="ttc" id="classTCPDF_html_a67d3ebe4959018ae32058d9962d76c1c"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a67d3ebe4959018ae32058d9962d76c1c">TCPDF\$n_js</a></div><div class="ttdeci">$n_js</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00861">tcpdf.php:861</a></div></div>
<div class="ttc" id="classTCPDF_html_a082e1feab2282c76f5b7e2eaafc6f457"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a082e1feab2282c76f5b7e2eaafc6f457">TCPDF\AddSpotColor</a></div><div class="ttdeci">AddSpotColor($name, $c, $m, $y, $k)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l03722">tcpdf.php:3722</a></div></div>
<div class="ttc" id="classTCPDF_html_a281f922889bd1ae2dc96e421042ad8e4"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a281f922889bd1ae2dc96e421042ad8e4">TCPDF\GetCharWidth</a></div><div class="ttdeci">GetCharWidth($char, $notlast=true)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l04093">tcpdf.php:4093</a></div></div>
<div class="ttc" id="classTCPDF_html_afb4db924e2500df58789320694169785"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#afb4db924e2500df58789320694169785">TCPDF\CoonsPatchMesh</a></div><div class="ttdeci">CoonsPatchMesh($x, $y, $w, $h, $col1=array(), $col2=array(), $col3=array(), $col4=array(), $coords=array(0.00, 0.0, 0.33, 0.00, 0.67, 0.00, 1.00, 0.00, 1.00, 0.33, 1.00, 0.67, 1.00, 1.00, 0.67, 1.00, 0.33, 1.00, 0.00, 1.00, 0.00, 0.67, 0.00, 0.33), $coords_min=0, $coords_max=1, $antialias=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l14469">tcpdf.php:14469</a></div></div>
<div class="ttc" id="classTCPDF_html_a22858ae709885860e1f6c5db6f754218"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a22858ae709885860e1f6c5db6f754218">TCPDF\$internal_encoding</a></div><div class="ttdeci">$internal_encoding</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00778">tcpdf.php:778</a></div></div>
<div class="ttc" id="classTCPDF_html_a462e1c7c06da31458cdb0d95acb086a8"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a462e1c7c06da31458cdb0d95acb086a8">TCPDF\$signature_appearance</a></div><div class="ttdeci">$signature_appearance</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01282">tcpdf.php:1282</a></div></div>
<div class="ttc" id="classTCPDF_html_a591ae03ca6c5202c19a36d3dccb1eb0a"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a591ae03ca6c5202c19a36d3dccb1eb0a">TCPDF\getHtmlDomArray</a></div><div class="ttdeci">getHtmlDomArray($html)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l16367">tcpdf.php:16367</a></div></div>
<div class="ttc" id="classTCPDF_html_a2e1b92a30f94f161fe51c8ce232885d2"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a2e1b92a30f94f161fe51c8ce232885d2">TCPDF\copyPage</a></div><div class="ttdeci">copyPage($page=0)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l21404">tcpdf.php:21404</a></div></div>
<div class="ttc" id="classTCPDF_html_a1184d1ac9ef4d6313bf23ddba45936dc"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a1184d1ac9ef4d6313bf23ddba45936dc">TCPDF\setSignature</a></div><div class="ttdeci">setSignature($signing_cert='', $private_key='', $private_key_password='', $extracerts='', $cert_type=2, $info=array(), $approval='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l13532">tcpdf.php:13532</a></div></div>
<div class="ttc" id="classTCPDF_html_abe4390b4e1939e10c9b61a986adfc117"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#abe4390b4e1939e10c9b61a986adfc117">TCPDF\$xobjid</a></div><div class="ttdeci">$xobjid</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01540">tcpdf.php:1540</a></div></div>
<div class="ttc" id="classTCPDF_html_a5436c5f4de6f6506231423ca3c4e9a6a"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a5436c5f4de6f6506231423ca3c4e9a6a">TCPDF\$linethrough</a></div><div class="ttdeci">$linethrough</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00868">tcpdf.php:868</a></div></div>
<div class="ttc" id="classTCPDF_html_a28372fd5aa301e06535d2223025a0b29"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a28372fd5aa301e06535d2223025a0b29">TCPDF\SetLeftMargin</a></div><div class="ttdeci">SetLeftMargin($margin)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02589">tcpdf.php:2589</a></div></div>
<div class="ttc" id="classTCPDF_html_a47524cc909428afea2ee2eb02a72130f"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a47524cc909428afea2ee2eb02a72130f">TCPDF\_UEvalue</a></div><div class="ttdeci">_UEvalue()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l10759">tcpdf.php:10759</a></div></div>
<div class="ttc" id="classTCPDF_html_a80e96cb97ad08e7feb952d2e5e8dc36d"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a80e96cb97ad08e7feb952d2e5e8dc36d">TCPDF\setCellMargins</a></div><div class="ttdeci">setCellMargins($left='', $top='', $right='', $bottom='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02688">tcpdf.php:2688</a></div></div>
<div class="ttc" id="classTCPDF_html_a3d6dcb62298ec9d42e9125ee2f5b23a1"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a3d6dcb62298ec9d42e9125ee2f5b23a1">TCPDF\Output</a></div><div class="ttdeci">Output($name='doc.pdf', $dest='I')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l07584">tcpdf.php:7584</a></div></div>
<div class="ttc" id="classTCPDF_html_aad2c0cbfe5b6330eed5850f87c2a32d9"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aad2c0cbfe5b6330eed5850f87c2a32d9">TCPDF\setPageUnit</a></div><div class="ttdeci">setPageUnit($unit)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02017">tcpdf.php:2017</a></div></div>
<div class="ttc" id="classTCPDF_html_a71e0449a3a1c35c8e5009450834787e7"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a71e0449a3a1c35c8e5009450834787e7">TCPDF\$linestyleWidth</a></div><div class="ttdeci">$linestyleWidth</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01008">tcpdf.php:1008</a></div></div>
<div class="ttc" id="classTCPDF_html_a1cff8ee966955eb911a71e2535735683"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a1cff8ee966955eb911a71e2535735683">TCPDF\getPDFData</a></div><div class="ttdeci">getPDFData()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l10471">tcpdf.php:10471</a></div></div>
<div class="ttc" id="classTCPDF_html_a338034ba746f7c607473207b9caa4e1f"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a338034ba746f7c607473207b9caa4e1f">TCPDF\rollbackTransaction</a></div><div class="ttdeci">rollbackTransaction($self=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l21855">tcpdf.php:21855</a></div></div>
<div class="ttc" id="classTCPDF_html_a08aec0a405ab1a1a311bf20aacc5b36d"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a08aec0a405ab1a1a311bf20aacc5b36d">TCPDF\setFontSubsetting</a></div><div class="ttdeci">setFontSubsetting($enable=true)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l22317">tcpdf.php:22317</a></div></div>
<div class="ttc" id="classTCPDF_html_a271d4b388e1d57856c6f569cd97cb58f"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a271d4b388e1d57856c6f569cd97cb58f">TCPDF\$overprint</a></div><div class="ttdeci">$overprint</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01794">tcpdf.php:1794</a></div></div>
<div class="ttc" id="classTCPDF_html_aa24046de2993933f62d60a2936a22970"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aa24046de2993933f62d60a2936a22970">TCPDF\AcceptPageBreak</a></div><div class="ttdeci">AcceptPageBreak()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l04945">tcpdf.php:4945</a></div></div>
<div class="ttc" id="classTCPDF_html_af63a9b95cacf42745e338057ce03c734"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#af63a9b95cacf42745e338057ce03c734">TCPDF\$x</a></div><div class="ttdeci">$x</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00294">tcpdf.php:294</a></div></div>
<div class="ttc" id="classTCPDF_html_a9e8e4b4d75485b8f1e3aa2133a811e50"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a9e8e4b4d75485b8f1e3aa2133a811e50">TCPDF\checkPageBreak</a></div><div class="ttdeci">checkPageBreak($h=0, $y='', $addpage=true)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l04972">tcpdf.php:4972</a></div></div>
<div class="ttc" id="classTCPDF_html_a7e72e7d134966fec42290897902c7aac"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a7e72e7d134966fec42290897902c7aac">TCPDF\$premode</a></div><div class="ttdeci">$premode</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01127">tcpdf.php:1127</a></div></div>
<div class="ttc" id="tcpdf__config_8php_html_a08375f80cec3cc396da966460d2fdb64"><div class="ttname"><a href="../../d5/dc0/tcpdf__config_8php.html#a08375f80cec3cc396da966460d2fdb64">K_TCPDF_THROW_EXCEPTION_ERROR</a></div><div class="ttdeci">const K_TCPDF_THROW_EXCEPTION_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dc0/tcpdf__config_8php_source.html#l00221">tcpdf_config.php:221</a></div></div>
<div class="ttc" id="tcpdf__config_8php_html_a2caf7ac30acb5a1d373ad91fadd6b0df"><div class="ttname"><a href="../../d5/dc0/tcpdf__config_8php.html#a2caf7ac30acb5a1d373ad91fadd6b0df">K_TCPDF_CALLS_IN_HTML</a></div><div class="ttdeci">const K_TCPDF_CALLS_IN_HTML</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dc0/tcpdf__config_8php_source.html#l00216">tcpdf_config.php:216</a></div></div>
<div class="ttc" id="classTCPDF_html_a196f73a0f173f0d5977c7eb7a53b53d5"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a196f73a0f173f0d5977c7eb7a53b53d5">TCPDF\$clMargin</a></div><div class="ttdeci">$clMargin</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00256">tcpdf.php:256</a></div></div>
<div class="ttc" id="classTCPDF_html_aaabaabe0dbda7572c99b84af46a64a36"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aaabaabe0dbda7572c99b84af46a64a36">TCPDF\getTextShadow</a></div><div class="ttdeci">getTextShadow()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l22144">tcpdf.php:22144</a></div></div>
<div class="ttc" id="classTCPDF_html_a714c2bee7d6b39d4d6d304540c761352"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a714c2bee7d6b39d4d6d304540c761352">TCPDF\Image</a></div><div class="ttdeci">Image($file, $x='', $y='', $w=0, $h=0, $type='', $link='', $align='', $resize=false, $dpi=300, $palign='', $ismask=false, $imgmask=false, $border=0, $fitbox=false, $hidden=false, $fitonpage=false, $alt=false, $altimgs=array())</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l06850">tcpdf.php:6850</a></div></div>
<div class="ttc" id="classTCPDF_html_aeba2b911ed732e58cb99c0b9b29ed05f"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aeba2b911ed732e58cb99c0b9b29ed05f">TCPDF\_beginpage</a></div><div class="ttdeci">_beginpage($orientation='', $format='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l10083">tcpdf.php:10083</a></div></div>
<div class="ttc" id="classTCPDF_html_a7355db3de3a948cc20f408c42542962c"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a7355db3de3a948cc20f408c42542962c">TCPDF\_getxobjectdict</a></div><div class="ttdeci">_getxobjectdict()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l09415">tcpdf.php:9415</a></div></div>
<div class="ttc" id="classTCPDF_html_a7ec79640f33b5a1334632c2a893571b7"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a7ec79640f33b5a1334632c2a893571b7">TCPDF\getCSSBorderMargin</a></div><div class="ttdeci">getCSSBorderMargin($cssbspace, $width=0)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l16176">tcpdf.php:16176</a></div></div>
<div class="ttc" id="classTCPDF_html_a6053be73563ad95518920ecdc8cae6fb"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a6053be73563ad95518920ecdc8cae6fb">TCPDF\$CurrentFont</a></div><div class="ttdeci">$CurrentFont</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00404">tcpdf.php:404</a></div></div>
<div class="ttc" id="classTCPDF_html_a4235ea24726644eb13d82a2ebe8ee882"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a4235ea24726644eb13d82a2ebe8ee882">TCPDF\_putAPXObject</a></div><div class="ttdeci">_putAPXObject($w=0, $h=0, $stream='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l08807">tcpdf.php:8807</a></div></div>
<div class="ttc" id="classTCPDF_html_ae91c72441bff1164a3ab9d237a4e1faa"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ae91c72441bff1164a3ab9d237a4e1faa">TCPDF\_destroy</a></div><div class="ttdeci">_destroy($destroyall=false, $preserve_objcopy=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l07797">tcpdf.php:7797</a></div></div>
<div class="ttc" id="classTCPDF_html_a749522038ed7786c3e1701435dcb891e"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a749522038ed7786c3e1701435dcb891e">TCPDF\AddLink</a></div><div class="ttdeci">AddLink()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l04715">tcpdf.php:4715</a></div></div>
<div class="ttc" id="classTCPDF_html_aba22c5159414bb96cadfa66efd89bc7c"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aba22c5159414bb96cadfa66efd89bc7c">TCPDF\setCellPaddings</a></div><div class="ttdeci">setCellPaddings($left='', $top='', $right='', $bottom='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02652">tcpdf.php:2652</a></div></div>
<div class="ttc" id="classTCPDF_html_a7f1fa220561198a793cdd56a3390438d"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a7f1fa220561198a793cdd56a3390438d">TCPDF\getFooterMargin</a></div><div class="ttdeci">getFooterMargin()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l03337">tcpdf.php:3337</a></div></div>
<div class="ttc" id="classTCPDF_html_a3d3b6c9de1643d382406ebfecdbe415b"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a3d3b6c9de1643d382406ebfecdbe415b">TCPDF\$pagegroups</a></div><div class="ttdeci">$pagegroups</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00896">tcpdf.php:896</a></div></div>
<div class="ttc" id="classTCPDF_html_a0ade674cd5fe2d8901c056e689b6ab52"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a0ade674cd5fe2d8901c056e689b6ab52">TCPDF\_putsignature</a></div><div class="ttdeci">_putsignature()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l13407">tcpdf.php:13407</a></div></div>
<div class="ttc" id="error__404_8php_html_aea8bd098bc952d8b75498dae4c304fd7"><div class="ttname"><a href="../../d0/dd3/error__404_8php.html#aea8bd098bc952d8b75498dae4c304fd7">if</a></div><div class="ttdeci">if(isset($complete_role))</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/dd3/error__404_8php_source.html#l00058">error_404.php:58</a></div></div>
<div class="ttc" id="classTCPDF_html_a6b1f180bd6e591a9c20f8621e08125e5"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a6b1f180bd6e591a9c20f8621e08125e5">TCPDF\$javascript</a></div><div class="ttdeci">$javascript</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00854">tcpdf.php:854</a></div></div>
<div class="ttc" id="classTCPDF_html_ae9bd660bf5b5e00eea82f1168cc67b5b"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ae9bd660bf5b5e00eea82f1168cc67b5b">TCPDF\getMargins</a></div><div class="ttdeci">getMargins()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l15863">tcpdf.php:15863</a></div></div>
<div class="ttc" id="classTCPDF_html_ad0bbadba37c598911425309c4f88d08e"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ad0bbadba37c598911425309c4f88d08e">TCPDF\$cntmrk</a></div><div class="ttdeci">$cntmrk</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00973">tcpdf.php:973</a></div></div>
<div class="ttc" id="classTCPDF_html_a1fb5403b2b6997d476dc797787065bf4"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a1fb5403b2b6997d476dc797787065bf4">TCPDF\$form_mode</a></div><div class="ttdeci">$form_mode</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01373">tcpdf.php:1373</a></div></div>
<div class="ttc" id="classTCPDF_html_a6765cafbc343aeacdcbd0a97c6c90ca5"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a6765cafbc343aeacdcbd0a97c6c90ca5">TCPDF\getFontStretching</a></div><div class="ttdeci">getFontStretching()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l22678">tcpdf.php:22678</a></div></div>
<div class="ttc" id="classTCPDF_html_a73e8adbbe29b64c860af2d9c23105c3d"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a73e8adbbe29b64c860af2d9c23105c3d">TCPDF\cropMark</a></div><div class="ttdeci">cropMark($x, $y, $w, $h, $type='T, R, B, L', $color=array(100, 100, 100, 100,'All'))</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l14286">tcpdf.php:14286</a></div></div>
<div class="ttc" id="classTCPDF_html_a072053646725b19770a795050b3b6221"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a072053646725b19770a795050b3b6221">TCPDF\setGraphicVars</a></div><div class="ttdeci">setGraphicVars($gvars, $extended=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l20687">tcpdf.php:20687</a></div></div>
<div class="ttc" id="classTCPDF_html_af4d75f0ad6d41ae94761b18f520eaaa8"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#af4d75f0ad6d41ae94761b18f520eaaa8">TCPDF\$svggradients</a></div><div class="ttdeci">$svggradients</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01617">tcpdf.php:1617</a></div></div>
<div class="ttc" id="classTCPDF_html_a99075a970e4fec86e1b31e8ecc923e00"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a99075a970e4fec86e1b31e8ecc923e00">TCPDF\setPage</a></div><div class="ttdeci">setPage($pnum, $resetmargins=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l03001">tcpdf.php:3001</a></div></div>
<div class="ttc" id="classTCPDF_html_a8fc7b86c255aeb0f14d281bdaeb2015c"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a8fc7b86c255aeb0f14d281bdaeb2015c">TCPDF\Rect</a></div><div class="ttdeci">Rect($x, $y, $w, $h, $style='', $border_style=array(), $fill_color=array())</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l11629">tcpdf.php:11629</a></div></div>
<div class="ttc" id="classTCPDF_html_aa763f850e5163efe95d15785b174de71"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aa763f850e5163efe95d15785b174de71">TCPDF\$starting_page_number</a></div><div class="ttdeci">$starting_page_number</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00518">tcpdf.php:518</a></div></div>
<div class="ttc" id="classTCPDF_html_a62801a15bfbe77fba2203df026b0d716"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a62801a15bfbe77fba2203df026b0d716">TCPDF\$font_obj_ids</a></div><div class="ttdeci">$font_obj_ids</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01212">tcpdf.php:1212</a></div></div>
<div class="ttc" id="classTCPDF_html_ae80e86c6d3f113518cb28a1b0aa3bebc"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ae80e86c6d3f113518cb28a1b0aa3bebc">TCPDF\getSignatureAppearanceArray</a></div><div class="ttdeci">getSignatureAppearanceArray($x=0, $y=0, $w=0, $h=0, $page=-1, $name='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l13603">tcpdf.php:13603</a></div></div>
<div class="ttc" id="classTCPDF_html_a128e3d25eed996dbd78dd10be6f0c4c4"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a128e3d25eed996dbd78dd10be6f0c4c4">TCPDF\getCellBorder</a></div><div class="ttdeci">getCellBorder($x, $y, $w, $h, $brd)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l05586">tcpdf.php:5586</a></div></div>
<div class="ttc" id="classTCPDF_html_ad8e48a29b04d0916aa3e7e7d2c25bab0"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ad8e48a29b04d0916aa3e7e7d2c25bab0">TCPDF\$h</a></div><div class="ttdeci">$h</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00238">tcpdf.php:238</a></div></div>
<div class="ttc" id="classTCPDF_html_ac168053a0ff19f84a7da3d525fa9b9a2"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ac168053a0ff19f84a7da3d525fa9b9a2">TCPDF\$start_transaction_y</a></div><div class="ttdeci">$start_transaction_y</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01415">tcpdf.php:1415</a></div></div>
<div class="ttc" id="classTCPDF_html_a5d889cef79795c6d0e8c175fc820f87d"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a5d889cef79795c6d0e8c175fc820f87d">TCPDF\$jpeg_quality</a></div><div class="ttdeci">$jpeg_quality</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00917">tcpdf.php:917</a></div></div>
<div class="ttc" id="classTCPDF_html_a295eb20ff68b8f2a04b33e4dadd66dc4"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a295eb20ff68b8f2a04b33e4dadd66dc4">TCPDF\setStartingPageNumber</a></div><div class="ttdeci">setStartingPageNumber($num=1)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l13691">tcpdf.php:13691</a></div></div>
<div class="ttc" id="classTCPDF_html_a4430365ea0b9015b4aefedad1ba77ea9"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a4430365ea0b9015b4aefedad1ba77ea9">TCPDF\SetAutoPageBreak</a></div><div class="ttdeci">SetAutoPageBreak($auto, $margin=0)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02796">tcpdf.php:2796</a></div></div>
<div class="ttc" id="classTCPDF_html_a015d1f6a5d39877206bf2b12163eddcc"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a015d1f6a5d39877206bf2b12163eddcc">TCPDF\getPageNumGroupAlias</a></div><div class="ttdeci">getPageNumGroupAlias()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l13773">tcpdf.php:13773</a></div></div>
<div class="ttc" id="classTCPDF_html_a5df552585bd6e930184e5e6e5bae19cd"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a5df552585bd6e930184e5e6e5bae19cd">TCPDF\getDocModificationTimestamp</a></div><div class="ttdeci">getDocModificationTimestamp()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l10292">tcpdf.php:10292</a></div></div>
<div class="ttc" id="classTCPDF_html_a8d4bf72b31a199786829e4bee4bae6f5"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a8d4bf72b31a199786829e4bee4bae6f5">TCPDF\$last_enc_key</a></div><div class="ttdeci">$last_enc_key</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00815">tcpdf.php:815</a></div></div>
<div class="ttc" id="classTCPDF_html_a89fceafd528f56d4eff01d8ecb11fcbe"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a89fceafd528f56d4eff01d8ecb11fcbe">TCPDF\$y</a></div><div class="ttdeci">$y</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00300">tcpdf.php:300</a></div></div>
<div class="ttc" id="classTCPDF_html_a968b07e5ebb6722f7c6a649e083fccd9"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a968b07e5ebb6722f7c6a649e083fccd9">TCPDF\replaceChar</a></div><div class="ttdeci">replaceChar($oldchar, $newchar)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l05563">tcpdf.php:5563</a></div></div>
<div class="ttc" id="classTCPDF_html_aaf0b4fbcfc6c68a0a0877b39667184ef"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aaf0b4fbcfc6c68a0a0877b39667184ef">TCPDF\Polycurve</a></div><div class="ttdeci">Polycurve($x0, $y0, $segments, $style='', $line_style=array(), $fill_color=array())</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l11730">tcpdf.php:11730</a></div></div>
<div class="ttc" id="classTCPDF_html_a8e4cdd8552955c46ab2d35bb0cbfa277"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a8e4cdd8552955c46ab2d35bb0cbfa277">TCPDF\$opencell</a></div><div class="ttdeci">$opencell</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01113">tcpdf.php:1113</a></div></div>
<div class="ttc" id="classTCPDF_html_a514d8fa634d23eac396e0b4471acccba"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a514d8fa634d23eac396e0b4471acccba">TCPDF\$FontFiles</a></div><div class="ttdeci">$FontFiles</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00330">tcpdf.php:330</a></div></div>
<div class="ttc" id="classTCPDF_html_a9d5b2e618c656365a57eeacc66940311"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a9d5b2e618c656365a57eeacc66940311">TCPDF\$customlistindent</a></div><div class="ttdeci">$customlistindent</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01106">tcpdf.php:1106</a></div></div>
<div class="ttc" id="classTCPDFBarcode_html"><div class="ttname"><a href="../../d1/d8c/classTCPDFBarcode.html">TCPDFBarcode</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d0a/tcpdf__barcodes__1d_8php_source.html#l00050">tcpdf_barcodes_1d.php:50</a></div></div>
<div class="ttc" id="classTCPDF_html_af8af438c6e81b9794dc8d37c8f602aaf"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#af8af438c6e81b9794dc8d37c8f602aaf">TCPDF\setSpotColor</a></div><div class="ttdeci">setSpotColor($type, $name, $tint=100)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l03738">tcpdf.php:3738</a></div></div>
<div class="ttc" id="classTCPDF_html_ad69e13e0b99d5d72440bc95cde06dbcd"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ad69e13e0b99d5d72440bc95cde06dbcd">TCPDF\setFontStretching</a></div><div class="ttdeci">setFontStretching($perc=100)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l22667">tcpdf.php:22667</a></div></div>
<div class="ttc" id="classTCPDF_html_ac2cb5e6e0c0de533310a0965c5a2d908"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ac2cb5e6e0c0de533310a0965c5a2d908">TCPDF\$tsa_timestamp</a></div><div class="ttdeci">$tsa_timestamp</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01296">tcpdf.php:1296</a></div></div>
<div class="ttc" id="classTCPDF_html_aa6f690ff30d06f1a76086ea16b24f3dd"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aa6f690ff30d06f1a76086ea16b24f3dd">TCPDF\$radio_groups</a></div><div class="ttdeci">$radio_groups</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01394">tcpdf.php:1394</a></div></div>
<div class="ttc" id="classTCPDF_html_a3ca50045ed09382a1ed2877778dce3a9"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a3ca50045ed09382a1ed2877778dce3a9">TCPDF\movePage</a></div><div class="ttdeci">movePage($frompage, $topage)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l21043">tcpdf.php:21043</a></div></div>
<div class="ttc" id="classTCPDF_html_a877cd98eb569f30730b86a09b61825aa"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a877cd98eb569f30730b86a09b61825aa">TCPDF\_dounderline</a></div><div class="ttdeci">_dounderline($x, $y, $txt)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l10165">tcpdf.php:10165</a></div></div>
<div class="ttc" id="classTCPDF_html_aed7678d695337818bfcc454197f8674c"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aed7678d695337818bfcc454197f8674c">TCPDF\$svgtext</a></div><div class="ttdeci">$svgtext</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01673">tcpdf.php:1673</a></div></div>
<div class="ttc" id="classTCPDF_html_aa0bd7035053a662b8d946ec411bebb14"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aa0bd7035053a662b8d946ec411bebb14">TCPDF\setColorArray</a></div><div class="ttdeci">setColorArray($type, $color, $ret=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l03823">tcpdf.php:3823</a></div></div>
<div class="ttc" id="classTCPDF_html_ac17fad9cbf5ec25f76e79adb61aa3f10"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ac17fad9cbf5ec25f76e79adb61aa3f10">TCPDF\$booklet</a></div><div class="ttdeci">$booklet</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01085">tcpdf.php:1085</a></div></div>
<div class="ttc" id="classTCPDF_html_a55c3dfafc6dd5b278d0bc7298e829d77"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a55c3dfafc6dd5b278d0bc7298e829d77">TCPDF\_enddoc</a></div><div class="ttdeci">_enddoc()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l09981">tcpdf.php:9981</a></div></div>
<div class="ttc" id="classTCPDF_html_a9e5fbe1cabbea954c6b5d4f9837bc3b0"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a9e5fbe1cabbea954c6b5d4f9837bc3b0">TCPDF\$compress</a></div><div class="ttdeci">$compress</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00184">tcpdf.php:184</a></div></div>
<div class="ttc" id="classTCPDF_html_a7a8df2d51b5521504df1bcb23915094f"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a7a8df2d51b5521504df1bcb23915094f">TCPDF\$l</a></div><div class="ttdeci">$l</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00613">tcpdf.php:613</a></div></div>
<div class="ttc" id="classTCPDF_html_a8f4ca031806c6392225a504eff945f1e"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a8f4ca031806c6392225a504eff945f1e">TCPDF\registrationMarkCMYK</a></div><div class="ttdeci">registrationMarkCMYK($x, $y, $r)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l14384">tcpdf.php:14384</a></div></div>
<div class="ttc" id="classTCPDF_html_ad558e09c5de15501f3f845cd9f478a94"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ad558e09c5de15501f3f845cd9f478a94">TCPDF\$linestyleCap</a></div><div class="ttdeci">$linestyleCap</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01015">tcpdf.php:1015</a></div></div>
<div class="ttc" id="classTCPDF_html_a72e9f4b59b7aa0dfd4f96c011d460e56"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a72e9f4b59b7aa0dfd4f96c011d460e56">TCPDF\ListBox</a></div><div class="ttdeci">ListBox($name, $w, $h, $values, $prop=array(), $opt=array(), $x='', $y='', $js=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l12987">tcpdf.php:12987</a></div></div>
<div class="ttc" id="classTCPDF_html_a27c982afeec6a29678a0b16ae0b4e755"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a27c982afeec6a29678a0b16ae0b4e755">TCPDF\$ColorFlag</a></div><div class="ttdeci">$ColorFlag</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00440">tcpdf.php:440</a></div></div>
<div class="ttc" id="classTCPDF_html_a1d99e81697a90efb13a6734001427f40"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a1d99e81697a90efb13a6734001427f40">TCPDF\checkPageRegions</a></div><div class="ttdeci">checkPageRegions($h, $x, $y)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l22784">tcpdf.php:22784</a></div></div>
<div class="ttc" id="classTCPDF_html_a12c5aa5d0e1d13569bdb1ca8e6442884"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a12c5aa5d0e1d13569bdb1ca8e6442884">TCPDF\$inthead</a></div><div class="ttdeci">$inthead</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01422">tcpdf.php:1422</a></div></div>
<div class="ttc" id="classTCPDF_html_a76d33e30b8292c2483e80bc98566483f"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a76d33e30b8292c2483e80bc98566483f">TCPDF\$original_rMargin</a></div><div class="ttdeci">$original_rMargin</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00595">tcpdf.php:595</a></div></div>
<div class="ttc" id="classTCPDF_html_ae0f4faf05227d82fa7ed924ba9044da7"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ae0f4faf05227d82fa7ed924ba9044da7">TCPDF\resetColumns</a></div><div class="ttdeci">resetColumns()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l21919">tcpdf.php:21919</a></div></div>
<div class="ttc" id="classTCPDF_html_a487f96d4c8261189e774c33d1f6c3409"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a487f96d4c8261189e774c33d1f6c3409">TCPDF\setOverprint</a></div><div class="ttdeci">setOverprint($stroking=true, $nonstroking='', $mode=0)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l13988">tcpdf.php:13988</a></div></div>
<div class="ttc" id="classTCPDF_html_ae738323ab05788503f5d9772a397c8d0"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ae738323ab05788503f5d9772a397c8d0">TCPDF\$maxselcol</a></div><div class="ttdeci">$maxselcol</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01457">tcpdf.php:1457</a></div></div>
<div class="ttc" id="classTCPDF_html_a8f3481f3ce8a4fcd40ac1e1a6bd8960e"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a8f3481f3ce8a4fcd40ac1e1a6bd8960e">TCPDF\SetDrawColorArray</a></div><div class="ttdeci">SetDrawColorArray($color, $ret=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l03854">tcpdf.php:3854</a></div></div>
<div class="ttc" id="classTCPDF_html_a9ad828b184f08828f570a7e52316ba79"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a9ad828b184f08828f570a7e52316ba79">TCPDF\PageNo</a></div><div class="ttdeci">PageNo()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l03695">tcpdf.php:3695</a></div></div>
<div class="ttc" id="classTCPDF_html_a5dedfd8b2f29748200d45a186182c86c"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a5dedfd8b2f29748200d45a186182c86c">TCPDF\$htmlLinkFontStyle</a></div><div class="ttdeci">$htmlLinkFontStyle</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01149">tcpdf.php:1149</a></div></div>
<div class="ttc" id="classTCPDF_html_a28c086439c0e458e09a76d0964518a6c"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a28c086439c0e458e09a76d0964518a6c">TCPDF\$pageopen</a></div><div class="ttdeci">$pageopen</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01219">tcpdf.php:1219</a></div></div>
<div class="ttc" id="classTCPDF_html_a458fb5ffaa345608b1346a38fdbbb096"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a458fb5ffaa345608b1346a38fdbbb096">TCPDF\Translate</a></div><div class="ttdeci">Translate($t_x, $t_y)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l11255">tcpdf.php:11255</a></div></div>
<div class="ttc" id="classTCPDF_html_a7a2fb19f3fcf13ef670ba8cdf3b4c5a4"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a7a2fb19f3fcf13ef670ba8cdf3b4c5a4">TCPDF\$openMarkedContent</a></div><div class="ttdeci">$openMarkedContent</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01036">tcpdf.php:1036</a></div></div>
<div class="ttc" id="classTCPDF_html_ab5675888a7271f898545886b4c3277c3"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ab5675888a7271f898545886b4c3277c3">TCPDF\$wPt</a></div><div class="ttdeci">$wPt</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00220">tcpdf.php:220</a></div></div>
<div class="ttc" id="classTCPDF_html_aebcb9fe17da560731acc6c5329366c52"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aebcb9fe17da560731acc6c5329366c52">TCPDF\_generateencryptionkey</a></div><div class="ttdeci">_generateencryptionkey()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l10839">tcpdf.php:10839</a></div></div>
<div class="ttc" id="classTCPDF_html_a54a81ac7f1da272429ed6262d0fdc9f5"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a54a81ac7f1da272429ed6262d0fdc9f5">TCPDF\replaceMissingChars</a></div><div class="ttdeci">replaceMissingChars($text, $font='', $style='', $subs=array())</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l04667">tcpdf.php:4667</a></div></div>
<div class="ttc" id="classTCPDF_html_a07ca3ed85ede02b10c0c6e55a63c762b"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a07ca3ed85ede02b10c0c6e55a63c762b">TCPDF\_putimages</a></div><div class="ttdeci">_putimages()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l09163">tcpdf.php:9163</a></div></div>
<div class="ttc" id="classTCPDF_html_afdcd761ffeab6ede2a7ed79cb2b5d33d"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#afdcd761ffeab6ede2a7ed79cb2b5d33d">TCPDF\$header_margin</a></div><div class="ttdeci">$header_margin</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00575">tcpdf.php:575</a></div></div>
<div class="ttc" id="classTCPDF_html_afe93f88db5be010a17cdf7c5ba4b9b10"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#afe93f88db5be010a17cdf7c5ba4b9b10">TCPDF\getLastH</a></div><div class="ttdeci">getLastH()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02456">tcpdf.php:2456</a></div></div>
<div class="ttc" id="classTCPDF_html_ae3b6169ba729309f289a5ac9680dd799"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ae3b6169ba729309f289a5ac9680dd799">TCPDF\GetY</a></div><div class="ttdeci">GetY()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l07455">tcpdf.php:7455</a></div></div>
<div class="ttc" id="classTCPDF_html_ad314dda630c9467efd594d46d24abcd5"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ad314dda630c9467efd594d46d24abcd5">TCPDF\$htmlLinkColorArray</a></div><div class="ttdeci">$htmlLinkColorArray</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01142">tcpdf.php:1142</a></div></div>
<div class="ttc" id="classTCPDF_html_a10b35d62b1ca2a4c8726aa910ccf7f57"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a10b35d62b1ca2a4c8726aa910ccf7f57">TCPDF\SetTopMargin</a></div><div class="ttdeci">SetTopMargin($margin)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02604">tcpdf.php:2604</a></div></div>
<div class="ttc" id="classTCPDF_html_ab5ed9ad2bde4d072fbd2facb96599e95"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ab5ed9ad2bde4d072fbd2facb96599e95">TCPDF\_putencryption</a></div><div class="ttdeci">_putencryption()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l10606">tcpdf.php:10606</a></div></div>
<div class="ttc" id="classTCPDF_html_ae476d39b2a2721941c0c3044a922b633"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ae476d39b2a2721941c0c3044a922b633">TCPDF\$imgscale</a></div><div class="ttdeci">$imgscale</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00542">tcpdf.php:542</a></div></div>
<div class="ttc" id="classTCPDF_html_ab991dc3ec6359223a68f1177746d61f3"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ab991dc3ec6359223a68f1177746d61f3">TCPDF\$InHeader</a></div><div class="ttdeci">$InHeader</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00458">tcpdf.php:458</a></div></div>
<div class="ttc" id="classTCPDF_html_a2aa8a59e174cfa8f61eb1a33489ce16b"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a2aa8a59e174cfa8f61eb1a33489ce16b">TCPDF\Polygon</a></div><div class="ttdeci">Polygon($p, $style='', $line_style=array(), $fill_color=array(), $closed=true)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l11979">tcpdf.php:11979</a></div></div>
<div class="ttc" id="classTCPDF_html_a2e65a8cc55a9b4b9c9ac01e6513d64c7"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a2e65a8cc55a9b4b9c9ac01e6513d64c7">TCPDF\getCSSBorderStyle</a></div><div class="ttdeci">getCSSBorderStyle($cssborder)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l16017">tcpdf.php:16017</a></div></div>
<div class="ttc" id="classTCPDF_html_a43d7a316bc0f19d6540f238ebebe62d5"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a43d7a316bc0f19d6540f238ebebe62d5">TCPDF\PageNoFormatted</a></div><div class="ttdeci">PageNoFormatted()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l13806">tcpdf.php:13806</a></div></div>
<div class="ttc" id="classTCPDF_html_a141a622244b576f4eb239b93c8826b32"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a141a622244b576f4eb239b93c8826b32">TCPDF\$re_spaces</a></div><div class="ttdeci">$re_spaces</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01310">tcpdf.php:1310</a></div></div>
<div class="ttc" id="classTCPDF_html_ac92bf6e625a271c53f17bf23c508613e"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ac92bf6e625a271c53f17bf23c508613e">TCPDF\getGroupPageNoFormatted</a></div><div class="ttdeci">getGroupPageNoFormatted()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l13796">tcpdf.php:13796</a></div></div>
<div class="ttc" id="classTCPDF_html_a104cb1d0c57aea34a2a29edcb85fd772"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a104cb1d0c57aea34a2a29edcb85fd772">TCPDF\$page_obj_id</a></div><div class="ttdeci">$page_obj_id</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01331">tcpdf.php:1331</a></div></div>
<div class="ttc" id="classTCPDF_html_a96869f3f3defc5d706c09dbd987c2752"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a96869f3f3defc5d706c09dbd987c2752">TCPDF\$htmlvspace</a></div><div class="ttdeci">$htmlvspace</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01043">tcpdf.php:1043</a></div></div>
<div class="ttc" id="classTCPDF_html_a3a58677c9c6a6e9e7702fcb3041b7253"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a3a58677c9c6a6e9e7702fcb3041b7253">TCPDF\printTemplate</a></div><div class="ttdeci">printTemplate($id, $x='', $y='', $w=0, $h=0, $align='', $palign='', $fitonpage=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l22534">tcpdf.php:22534</a></div></div>
<div class="ttc" id="classTCPDF_html_a7ea250b2b4e3d7e55e657d52732a3b1d"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a7ea250b2b4e3d7e55e657d52732a3b1d">TCPDF\SetProtection</a></div><div class="ttdeci">SetProtection($permissions=array('print', 'modify', 'copy', 'annot-forms', 'fill-forms', 'extract', 'assemble', 'print-high'), $user_pass='', $owner_pass=null, $mode=0, $pubkeys=null)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l10960">tcpdf.php:10960</a></div></div>
<div class="ttc" id="classTCPDF_html_a25c26ce9fab4b1d38773ab3629d985aa"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a25c26ce9fab4b1d38773ab3629d985aa">TCPDF\$author</a></div><div class="ttdeci">$author</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00500">tcpdf.php:500</a></div></div>
<div class="ttc" id="classTCPDF_html_a134232ae3ad1ec186ed45046f94b7755"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a134232ae3ad1ec186ed45046f94b7755">TCPDF\__construct</a></div><div class="ttdeci">__construct($orientation='P', $unit='mm', $format='A4', $unicode=true, $encoding='UTF-8', $diskcache=false, $pdfa=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01845">tcpdf.php:1845</a></div></div>
<div class="ttc" id="classTCPDF_html_a9e27c6426fd6cce5613f9ecd2ceecee4"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a9e27c6426fd6cce5613f9ecd2ceecee4">TCPDF\_putheader</a></div><div class="ttdeci">_putheader()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l09972">tcpdf.php:9972</a></div></div>
<div class="ttc" id="classTCPDF_html_a37c3ca1d77b99662e49c2931728f33a8"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a37c3ca1d77b99662e49c2931728f33a8">TCPDF\$footer_text_color</a></div><div class="ttdeci">$footer_text_color</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00676">tcpdf.php:676</a></div></div>
<div class="ttc" id="classTCPDF_html_a81c8257af5d6d6e40f1bb77d6b507b97"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a81c8257af5d6d6e40f1bb77d6b507b97">TCPDF\isUnicodeFont</a></div><div class="ttdeci">isUnicodeFont()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l22384">tcpdf.php:22384</a></div></div>
<div class="ttc" id="classTCPDF_html_ae6ad7850d488bb6c9b32a688f7b4c241"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ae6ad7850d488bb6c9b32a688f7b4c241">TCPDF\addTOC</a></div><div class="ttdeci">addTOC($page='', $numbersfont='', $filler='.', $toc_name='TOC', $style='', $color=array(0, 0, 0))</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l21481">tcpdf.php:21481</a></div></div>
<div class="ttc" id="classTCPDF_html_a16a896313dd8736178a90d367edb6f61"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a16a896313dd8736178a90d367edb6f61">TCPDF\LinearGradient</a></div><div class="ttdeci">LinearGradient($x, $y, $w, $h, $col1=array(), $col2=array(), $coords=array(0, 0, 1, 0))</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l14428">tcpdf.php:14428</a></div></div>
<div class="ttc" id="classTCPDF_html_aa07b31137128fee6f4d505cb1e7052ec"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aa07b31137128fee6f4d505cb1e7052ec">TCPDF\StartTransform</a></div><div class="ttdeci">StartTransform()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l11063">tcpdf.php:11063</a></div></div>
<div class="ttc" id="classTCPDF_html_a11ee884b1e2c9ef718bf9744ce942940"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a11ee884b1e2c9ef718bf9744ce942940">TCPDF\$svgclippaths</a></div><div class="ttdeci">$svgclippaths</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01652">tcpdf.php:1652</a></div></div>
<div class="ttc" id="classTCPDF_html_a6563f6f3fb785efb230ee37719cf76f9"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a6563f6f3fb785efb230ee37719cf76f9">TCPDF\SkewY</a></div><div class="ttdeci">SkewY($angle_y, $x='', $y='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l11320">tcpdf.php:11320</a></div></div>
<div class="ttc" id="classTCPDF_html_ad1fedbeb11482327ed38385f0d21d349"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ad1fedbeb11482327ed38385f0d21d349">TCPDF\$svgstyles</a></div><div class="ttdeci">$svgstyles</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01687">tcpdf.php:1687</a></div></div>
<div class="ttc" id="classTCPDF_html_afb73712e74059488feca5f8b850ff6a4"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#afb73712e74059488feca5f8b850ff6a4">TCPDF\$newpagegroup</a></div><div class="ttdeci">$newpagegroup</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00889">tcpdf.php:889</a></div></div>
<div class="ttc" id="classTCPDF_html_a35562c18384ac908528a044e4d1c3d60"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a35562c18384ac908528a044e4d1c3d60">TCPDF\segSVGContentHandler</a></div><div class="ttdeci">segSVGContentHandler($parser, $data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l24562">tcpdf.php:24562</a></div></div>
<div class="ttc" id="classTCPDF_html_a6286b84256565aa46926b83494525bd3"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a6286b84256565aa46926b83494525bd3">TCPDF\$fontkeys</a></div><div class="ttdeci">$fontkeys</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01205">tcpdf.php:1205</a></div></div>
<div class="ttc" id="classTCPDF_html_aff67c582d024c7d0ee6b61d479710635"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aff67c582d024c7d0ee6b61d479710635">TCPDF\getGDgamma</a></div><div class="ttdeci">getGDgamma($img, $c)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l07369">tcpdf.php:7369</a></div></div>
<div class="ttc" id="classTCPDF_html_a5354fe3c04ce60df877c38c7b10557da"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a5354fe3c04ce60df877c38c7b10557da">TCPDF\$lMargin</a></div><div class="ttdeci">$lMargin</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00244">tcpdf.php:244</a></div></div>
<div class="ttc" id="classTCPDF_html_a5bbbb689c42b3173b755c08cf9c0b58d"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a5bbbb689c42b3173b755c08cf9c0b58d">TCPDF\_putextgstates</a></div><div class="ttdeci">_putextgstates()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l13959">tcpdf.php:13959</a></div></div>
<div class="ttc" id="classTCPDF_html_aca943b0187b25b36e1cb3e37e299ad1b"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aca943b0187b25b36e1cb3e37e299ad1b">TCPDF\$gdgammacache</a></div><div class="ttdeci">$gdgammacache</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01823">tcpdf.php:1823</a></div></div>
<div class="ttc" id="classTCPDF_html_a3d9b3717cd9ad8db31642155c832d148"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a3d9b3717cd9ad8db31642155c832d148">TCPDF\SetLineStyle</a></div><div class="ttdeci">SetLineStyle($style, $ret=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l11440">tcpdf.php:11440</a></div></div>
<div class="ttc" id="classTCPDF_html_a3cc157ddb157c99b7001bead20c6e7b0"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a3cc157ddb157c99b7001bead20c6e7b0">TCPDF\SetRightMargin</a></div><div class="ttdeci">SetRightMargin($margin)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02619">tcpdf.php:2619</a></div></div>
<div class="ttc" id="classTCPDF_html_a860b030382957cd7a0835bb67d6e792c"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a860b030382957cd7a0835bb67d6e792c">TCPDF\$columns</a></div><div class="ttdeci">$columns</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01429">tcpdf.php:1429</a></div></div>
<div class="ttc" id="classTCPDF_html_a6bada8d1ad88d9fa54368619de43b866"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a6bada8d1ad88d9fa54368619de43b866">TCPDF\setTempRTL</a></div><div class="ttdeci">setTempRTL($mode)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02380">tcpdf.php:2380</a></div></div>
<div class="ttc" id="classTCPDF_html_a9928801520cbb84e9f88c02bfd957b73"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a9928801520cbb84e9f88c02bfd957b73">TCPDF\serializeTCPDFtagParameters</a></div><div class="ttdeci">serializeTCPDFtagParameters($pararray)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l17171">tcpdf.php:17171</a></div></div>
<div class="ttc" id="classTCPDF_html_abbcad4f482db857c9068d1d4846081ba"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#abbcad4f482db857c9068d1d4846081ba">TCPDF\replaceBuffer</a></div><div class="ttdeci">replaceBuffer($data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l20841">tcpdf.php:20841</a></div></div>
<div class="ttc" id="classTCPDF_html_a83e077f753f29339c8eb08401e52e2f1"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a83e077f753f29339c8eb08401e52e2f1">TCPDF\$tcpdflink</a></div><div class="ttdeci">$tcpdflink</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01816">tcpdf.php:1816</a></div></div>
<div class="ttc" id="classTCPDF_html_af2bfd0376f18244ad8c7aa3a85399c58"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#af2bfd0376f18244ad8c7aa3a85399c58">TCPDF\getHeaderMargin</a></div><div class="ttdeci">getHeaderMargin()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l03317">tcpdf.php:3317</a></div></div>
<div class="ttc" id="classTCPDF_html_a58f93b800daf9a608c3c1ad90a69e46e"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a58f93b800daf9a608c3c1ad90a69e46e">TCPDF\Open</a></div><div class="ttdeci">Open()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02945">tcpdf.php:2945</a></div></div>
<div class="ttc" id="classTCPDF_html_a02a272341e600d3c69836d1a564d29e0"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a02a272341e600d3c69836d1a564d29e0">TCPDF\endTOCPage</a></div><div class="ttdeci">endTOCPage()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l03093">tcpdf.php:3093</a></div></div>
<div class="ttc" id="classTCPDF_html_af353ab2d04ac6b69733765f7ea35ebcc"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#af353ab2d04ac6b69733765f7ea35ebcc">TCPDF\Clip</a></div><div class="ttdeci">Clip($x, $y, $w, $h)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l14561">tcpdf.php:14561</a></div></div>
<div class="ttc" id="classTCPDF_html_ad68e86a862fe437a8ac1728cecaaa2e9"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ad68e86a862fe437a8ac1728cecaaa2e9">TCPDF\getStringHeight</a></div><div class="ttdeci">getStringHeight($w, $txt, $reseth=false, $autopadding=true, $cellpadding='', $border=0)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l06271">tcpdf.php:6271</a></div></div>
<div class="ttc" id="classTCPDF_html_aa9eef41ab9ce56515dea68e21509eda6"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aa9eef41ab9ce56515dea68e21509eda6">TCPDF\$last_enc_key_c</a></div><div class="ttdeci">$last_enc_key_c</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00822">tcpdf.php:822</a></div></div>
<div class="ttc" id="tcpdf__config_8php_html_aec29ec2331d6b086a2aa2316be8b47f1"><div class="ttname"><a href="../../d5/dc0/tcpdf__config_8php.html#aec29ec2331d6b086a2aa2316be8b47f1">K_BLANK_IMAGE</a></div><div class="ttdeci">const K_BLANK_IMAGE</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dc0/tcpdf__config_8php_source.html#l00089">tcpdf_config.php:89</a></div></div>
<div class="ttc" id="classTCPDF_html_ab2369921b0e2075fb797dc03f701f205"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ab2369921b0e2075fb797dc03f701f205">TCPDF\$bufferlen</a></div><div class="ttdeci">$bufferlen</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01184">tcpdf.php:1184</a></div></div>
<div class="ttc" id="classTCPDF_html_ab3bbdb7c85ea08d175fd559be6132ba0"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ab3bbdb7c85ea08d175fd559be6132ba0">TCPDF\SetMargins</a></div><div class="ttdeci">SetMargins($left, $top, $right=-1, $keepmargins=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02567">tcpdf.php:2567</a></div></div>
<div class="ttc" id="classTCPDF_html_a07c49fa22978666529a6f66a8b8cb87f"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a07c49fa22978666529a6f66a8b8cb87f">TCPDF\endSVGElementHandler</a></div><div class="ttdeci">endSVGElementHandler($parser, $name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l24462">tcpdf.php:24462</a></div></div>
<div class="ttc" id="classTCPDF_html_aca6e7dacb9814682736ba2c7129be338"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aca6e7dacb9814682736ba2c7129be338">TCPDF\SetSubject</a></div><div class="ttdeci">SetSubject($subject)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02884">tcpdf.php:2884</a></div></div>
<div class="ttc" id="classTCPDF_html_a0b98de81d99a1a0e983dd0016e30fc75"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a0b98de81d99a1a0e983dd0016e30fc75">TCPDF\endTemplate</a></div><div class="ttdeci">endTemplate()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l22505">tcpdf.php:22505</a></div></div>
<div class="ttc" id="classTCPDF_html_ad089fa332b723086484ae0497ae90590"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ad089fa332b723086484ae0497ae90590">TCPDF\getAliasRightShift</a></div><div class="ttdeci">getAliasRightShift()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l13702">tcpdf.php:13702</a></div></div>
<div class="ttc" id="classTCPDF_html_ab0f6ca38653854c80ef47a1909685030"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ab0f6ca38653854c80ef47a1909685030">TCPDF\setVisibility</a></div><div class="ttdeci">setVisibility($v)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l13882">tcpdf.php:13882</a></div></div>
<div class="ttc" id="classTCPDF_html_a2e2600620c41132dda5479a902374b5c"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a2e2600620c41132dda5479a902374b5c">TCPDF\putHtmlListBullet</a></div><div class="ttdeci">putHtmlListBullet($listdepth, $listtype='', $size=10)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l20424">tcpdf.php:20424</a></div></div>
<div class="ttc" id="classTCPDF_html_a8a1af14cce3111886a7ec8024a02bbbc"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a8a1af14cce3111886a7ec8024a02bbbc">TCPDF\RadioButton</a></div><div class="ttdeci">RadioButton($name, $w, $prop=array(), $opt=array(), $onvalue='On', $checked=false, $x='', $y='', $js=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l12884">tcpdf.php:12884</a></div></div>
<div class="ttc" id="classTCPDF_html_af3ca25bafc44372ca6d7fd7951dcad46"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#af3ca25bafc44372ca6d7fd7951dcad46">TCPDF\replaceRightShiftPageNumAliases</a></div><div class="ttdeci">replaceRightShiftPageNumAliases($page, $aliases, $diff)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l07894">tcpdf.php:7894</a></div></div>
<div class="ttc" id="classTCPDF_html_a2c5467db3b3e3b9261be1914b9ec1991"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a2c5467db3b3e3b9261be1914b9ec1991">TCPDF\SetAbsX</a></div><div class="ttdeci">SetAbsX($x)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l07546">tcpdf.php:7546</a></div></div>
<div class="ttc" id="classTCPDF_html_aae83f746192e3b8d28bedefe664b6c6d"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aae83f746192e3b8d28bedefe664b6c6d">TCPDF\RadialGradient</a></div><div class="ttdeci">RadialGradient($x, $y, $w, $h, $col1=array(), $col2=array(), $coords=array(0.5, 0.5, 0.5, 0.5, 1))</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l14446">tcpdf.php:14446</a></div></div>
<div class="ttc" id="classTCPDF_html_a6e8de9cf793935f3c61d1bf2c4e160ac"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a6e8de9cf793935f3c61d1bf2c4e160ac">TCPDF\$cache_file_length</a></div><div class="ttdeci">$cache_file_length</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01240">tcpdf.php:1240</a></div></div>
<div class="ttc" id="classTCPDF_html_aa853a06ba07b77833755b83194f1fb1e"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aa853a06ba07b77833755b83194f1fb1e">TCPDF\TranslateY</a></div><div class="ttdeci">TranslateY($t_y)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l11243">tcpdf.php:11243</a></div></div>
<div class="ttc" id="classTCPDF_html_a9a0a09e2334f92e7a54cf1f550c3f921"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a9a0a09e2334f92e7a54cf1f550c3f921">TCPDF\pixelsToUnits</a></div><div class="ttdeci">pixelsToUnits($px)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l10532">tcpdf.php:10532</a></div></div>
<div class="ttc" id="classTCPDF_html_a458536902daa1aaead2c627dcf71e66b"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a458536902daa1aaead2c627dcf71e66b">TCPDF\isCharDefined</a></div><div class="ttdeci">isCharDefined($char, $font='', $style='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l04640">tcpdf.php:4640</a></div></div>
<div class="ttc" id="classTCPDF_html_ac7f2c7f76bd73f9c6874ec6b3a738a2c"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ac7f2c7f76bd73f9c6874ec6b3a738a2c">TCPDF\getHTMLFontUnits</a></div><div class="ttdeci">getHTMLFontUnits($val, $refsize=12, $parent_size=12, $defaultunit='pt')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l16313">tcpdf.php:16313</a></div></div>
<div class="ttc" id="classTCPDF_html_a06db7c5a86921654c8361f0e924d48b8"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a06db7c5a86921654c8361f0e924d48b8">TCPDF\$encryptdata</a></div><div class="ttdeci">$encryptdata</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00808">tcpdf.php:808</a></div></div>
<div class="ttc" id="classTCPDF_html_a25c924c6b9a12aba0d0a3e535eca224d"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a25c924c6b9a12aba0d0a3e535eca224d">TCPDF\$spot_colors</a></div><div class="ttdeci">$spot_colors</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01050">tcpdf.php:1050</a></div></div>
<div class="ttc" id="classTCPDF_html_a17346daa2c4848e475ad4f408376e2c2"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a17346daa2c4848e475ad4f408376e2c2">TCPDF\_dochecks</a></div><div class="ttdeci">_dochecks()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l07838">tcpdf.php:7838</a></div></div>
<div class="ttc" id="classTCPDF_html_ad6a3575405b61049ff85ce019df5451d"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ad6a3575405b61049ff85ce019df5451d">TCPDF\setPageOrientation</a></div><div class="ttdeci">setPageOrientation($orientation, $autopagebreak='', $bottommargin='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02223">tcpdf.php:2223</a></div></div>
<div class="ttc" id="classTCPDF_html_add40afd65a8b5349248c69d057cb462d"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#add40afd65a8b5349248c69d057cb462d">TCPDF\$listordered</a></div><div class="ttdeci">$listordered</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00722">tcpdf.php:722</a></div></div>
<div class="ttc" id="classTCPDF_html_afc93b05f36dcad498c71cdfe214716ef"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#afc93b05f36dcad498c71cdfe214716ef">TCPDF\$LayoutMode</a></div><div class="ttdeci">$LayoutMode</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00476">tcpdf.php:476</a></div></div>
<div class="ttc" id="classTCPDF_html_ab050e61a9d3a6d628990a26c9032ec0e"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ab050e61a9d3a6d628990a26c9032ec0e">TCPDF\$links</a></div><div class="ttdeci">$links</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00360">tcpdf.php:360</a></div></div>
<div class="ttc" id="classTCPDF_html_a057c8815533ff886e4b23a9780e31f78"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a057c8815533ff886e4b23a9780e31f78">TCPDF\IncludeJS</a></div><div class="ttdeci">IncludeJS($script)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l12611">tcpdf.php:12611</a></div></div>
<div class="ttc" id="classTCPDF_html_a83795ec8999b91ef291c34d63209c8f2"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a83795ec8999b91ef291c34d63209c8f2">TCPDF\setHeaderData</a></div><div class="ttdeci">setHeaderData($ln='', $lw=0, $ht='', $hs='', $tc=array(0, 0, 0), $lc=array(0, 0, 0))</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l03263">tcpdf.php:3263</a></div></div>
<div class="ttc" id="classTCPDF_html_a6e29d82b9a9e318c703370ec474499ad"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a6e29d82b9a9e318c703370ec474499ad">TCPDF\getCellHeightRatio</a></div><div class="ttdeci">getCellHeightRatio()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l14101">tcpdf.php:14101</a></div></div>
<div class="ttc" id="classTCPDF_html_add34ab0872e65557749d744941fd435d"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#add34ab0872e65557749d744941fd435d">TCPDF\RegularPolygon</a></div><div class="ttdeci">RegularPolygon($x0, $y0, $r, $ns, $angle=0, $draw_circle=false, $style='', $line_style=array(), $fill_color=array(), $circle_style='', $circle_outLine_style=array(), $circle_fill_color=array())</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l12080">tcpdf.php:12080</a></div></div>
<div class="ttc" id="classTCPDF_html_afddb62386f44b3011c9e4a8ed1d90517"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#afddb62386f44b3011c9e4a8ed1d90517">TCPDF\write2DBarcode</a></div><div class="ttdeci">write2DBarcode($code, $type, $x='', $y='', $w='', $h='', $style='', $align='', $distort=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l15634">tcpdf.php:15634</a></div></div>
<div class="ttc" id="classTCPDF_html_a06cba4fc5e83b02bb37a947e56196776"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a06cba4fc5e83b02bb37a947e56196776">TCPDF\AddFont</a></div><div class="ttdeci">AddFont($family, $style='', $fontfile='', $subset='default')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l04209">tcpdf.php:4209</a></div></div>
<div class="ttc" id="classTCPDF_html_acfe6c98519acb01dd53aa153c12bf79b"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#acfe6c98519acb01dd53aa153c12bf79b">TCPDF\$bMargin</a></div><div class="ttdeci">$bMargin</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00274">tcpdf.php:274</a></div></div>
<div class="ttc" id="classTCPDF_html_a475b483b9b8f649582c3237af5fb03d4"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a475b483b9b8f649582c3237af5fb03d4">TCPDF\setColumnsArray</a></div><div class="ttdeci">setColumnsArray($columns)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l21932">tcpdf.php:21932</a></div></div>
<div class="ttc" id="classTCPDF_html_a374b24751bf76e4ca5ba7694f87ec2c1"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a374b24751bf76e4ca5ba7694f87ec2c1">TCPDF\SetCellPadding</a></div><div class="ttdeci">SetCellPadding($pad)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02633">tcpdf.php:2633</a></div></div>
<div class="ttc" id="classTCPDF_html_a1611451af253619217095e279f52fa52"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a1611451af253619217095e279f52fa52">TCPDF\setFormDefaultProp</a></div><div class="ttdeci">setFormDefaultProp($prop=array())</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l12734">tcpdf.php:12734</a></div></div>
<div class="ttc" id="classTCPDF_html_a1d40e45dc074815d0fdaf55af9e22d81"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a1d40e45dc074815d0fdaf55af9e22d81">TCPDF\setUserRights</a></div><div class="ttdeci">setUserRights($enable=true, $document='/FullSave', $annots='/Create/Delete/Modify/Copy/Import/Export', $form='/Add/Delete/FillIn/Import/Export/SubmitStandalone/SpawnTemplate', $signature='/Modify', $ef='/Create/Delete/Modify/Import', $formex='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l13495">tcpdf.php:13495</a></div></div>
<div class="ttc" id="classTCPDF_html_a56536508fb1b5aede7d2ed27f56c2353"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a56536508fb1b5aede7d2ed27f56c2353">TCPDF\ImageSVG</a></div><div class="ttdeci">ImageSVG($file, $x='', $y='', $w=0, $h=0, $link='', $align='', $palign='', $border=0, $fitonpage=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l22887">tcpdf.php:22887</a></div></div>
<div class="ttc" id="classTCPDF_html_a40cc24bda71b85b4013d070896cd97de"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a40cc24bda71b85b4013d070896cd97de">TCPDF\$PDFVersion</a></div><div class="ttdeci">$PDFVersion</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00557">tcpdf.php:557</a></div></div>
<div class="ttc" id="classTCPDF_html_a752bede1485e51bff5ad315ca83c804d"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a752bede1485e51bff5ad315ca83c804d">TCPDF\$keywords</a></div><div class="ttdeci">$keywords</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00506">tcpdf.php:506</a></div></div>
<div class="ttc" id="classTCPDF_html_a2490e635d8ff11d41b6578bab46acba5"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a2490e635d8ff11d41b6578bab46acba5">TCPDF\getHeaderFont</a></div><div class="ttdeci">getHeaderFont()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l10428">tcpdf.php:10428</a></div></div>
<div class="ttc" id="classTCPDF_html_ad4357fbfe88ee671132009ca8bb199ef"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ad4357fbfe88ee671132009ca8bb199ef">TCPDF\_datastring</a></div><div class="ttdeci">_datastring($s, $n=0)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l10242">tcpdf.php:10242</a></div></div>
<div class="ttc" id="classTCPDF_html_a5a55ff5ef0a33fcd4b8b4f924f576020"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a5a55ff5ef0a33fcd4b8b4f924f576020">TCPDF\Scale</a></div><div class="ttdeci">Scale($s_x, $s_y, $x='', $y='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l11151">tcpdf.php:11151</a></div></div>
<div class="ttc" id="classTCPDF_html_a2a38a999dd99b95bbd140ea31da36f44"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a2a38a999dd99b95bbd140ea31da36f44">TCPDF\Bookmark</a></div><div class="ttdeci">Bookmark($txt, $level=0, $y=-1, $page='', $style='', $color=array(0, 0, 0), $x=-1, $link='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l12420">tcpdf.php:12420</a></div></div>
<div class="ttc" id="classTCPDF_html_ae11c5c603573f58c854481fb3d74d588"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ae11c5c603573f58c854481fb3d74d588">TCPDF\fixHTMLCode</a></div><div class="ttdeci">fixHTMLCode($html, $default_css='', $tagvs='', $tidy_options='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l15950">tcpdf.php:15950</a></div></div>
<div class="ttc" id="classTCPDF_html_a78c46e485a0c0c10b0f8aee7169ffc67"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a78c46e485a0c0c10b0f8aee7169ffc67">TCPDF\SetFillSpotColor</a></div><div class="ttdeci">SetFillSpotColor($name, $tint=100)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l03796">tcpdf.php:3796</a></div></div>
<div class="ttc" id="classTCPDF_html_a08e9cd78d75c94166e9e4f629b4daa8c"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a08e9cd78d75c94166e9e4f629b4daa8c">TCPDF\$custom_xmp</a></div><div class="ttdeci">$custom_xmp</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01786">tcpdf.php:1786</a></div></div>
<div class="ttc" id="classTCPDF_html_a0ef34c0ce76bd8e4671da42b3588d9b6"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a0ef34c0ce76bd8e4671da42b3588d9b6">TCPDF\SetLineWidth</a></div><div class="ttdeci">SetLineWidth($width)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l11397">tcpdf.php:11397</a></div></div>
<div class="ttc" id="classTCPDF_html_a8f7b75b709d2a2c58b569f33cfedf180"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a8f7b75b709d2a2c58b569f33cfedf180">TCPDF\hyphenateText</a></div><div class="ttdeci">hyphenateText($text, $patterns, $dictionary=array(), $leftmin=1, $rightmin=2, $charmin=1, $charmax=8)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l22242">tcpdf.php:22242</a></div></div>
<div class="ttc" id="classTCPDF_html_a1ef3c591556f7668c8a62b81e98da8a1"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a1ef3c591556f7668c8a62b81e98da8a1">TCPDF\_getobj</a></div><div class="ttdeci">_getobj($objid='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l10148">tcpdf.php:10148</a></div></div>
<div class="ttc" id="classTCPDF_html_a9237608d2579943f4bb2428617bfb73c"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a9237608d2579943f4bb2428617bfb73c">TCPDF\CheckBox</a></div><div class="ttdeci">CheckBox($name, $w, $checked=false, $prop=array(), $opt=array(), $onvalue='Yes', $x='', $y='', $js=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l13160">tcpdf.php:13160</a></div></div>
<div class="ttc" id="classTCPDF_html_a0cee973f21b885929d2c71c28782adac"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a0cee973f21b885929d2c71c28782adac">TCPDF\getOriginalMargins</a></div><div class="ttdeci">getOriginalMargins()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l15890">tcpdf.php:15890</a></div></div>
<div class="ttc" id="classTCPDF_html_a42cfd0a9e84edfcaa1e46d3d7283ef73"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a42cfd0a9e84edfcaa1e46d3d7283ef73">TCPDF\_getannotsrefs</a></div><div class="ttdeci">_getannotsrefs($n)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l08120">tcpdf.php:8120</a></div></div>
<div class="ttc" id="classTCPDF_html_af166f060da54f13a6d9871160284cc30"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#af166f060da54f13a6d9871160284cc30">TCPDF\$transfmatrix_key</a></div><div class="ttdeci">$transfmatrix_key</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01078">tcpdf.php:1078</a></div></div>
<div class="ttc" id="classTCPDF_html_a12cedc58d49cf0473c2d3d459f042cbc"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a12cedc58d49cf0473c2d3d459f042cbc">TCPDF\$transfmrk</a></div><div class="ttdeci">$transfmrk</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01135">tcpdf.php:1135</a></div></div>
<div class="ttc" id="classTCPDF_html_a2748e6f033deb7641e4050e0370f1839"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a2748e6f033deb7641e4050e0370f1839">TCPDF\$svgcliptm</a></div><div class="ttdeci">$svgcliptm</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01659">tcpdf.php:1659</a></div></div>
<div class="ttc" id="classTCPDF_html_afc90d19ade9358676bbde3633db5d808"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#afc90d19ade9358676bbde3633db5d808">TCPDF\_outCurveY</a></div><div class="ttdeci">_outCurveY($x1, $y1, $x3, $y3)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l11582">tcpdf.php:11582</a></div></div>
<div class="ttc" id="classTCPDF_html_af01238bb928c4e3de6ed6aaa855fd788"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#af01238bb928c4e3de6ed6aaa855fd788">TCPDF\getRTL</a></div><div class="ttdeci">getRTL()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02370">tcpdf.php:2370</a></div></div>
<div class="ttc" id="classTCPDF_html_a04519421e767c221f2f3bfbe51574896"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a04519421e767c221f2f3bfbe51574896">TCPDF\$doc_modification_timestamp</a></div><div class="ttdeci">$doc_modification_timestamp</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01779">tcpdf.php:1779</a></div></div>
<div class="ttc" id="classTCPDF_html_ad3e9b80cfbd309301aa9a10d29282749"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ad3e9b80cfbd309301aa9a10d29282749">TCPDF\_putEmbeddedFiles</a></div><div class="ttdeci">_putEmbeddedFiles()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l04867">tcpdf.php:4867</a></div></div>
<div class="ttc" id="classTCPDF_html_a7cef73bdad50b34e32accaeb6292095d"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a7cef73bdad50b34e32accaeb6292095d">TCPDF\$intmrk</a></div><div class="ttdeci">$intmrk</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00952">tcpdf.php:952</a></div></div>
<div class="ttc" id="classTCPDF_html_a7416404adf787407cc9c87effbbb8d1e"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a7416404adf787407cc9c87effbbb8d1e">TCPDF\addPageRegion</a></div><div class="ttdeci">addPageRegion($region)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l22747">tcpdf.php:22747</a></div></div>
<div class="ttc" id="classTCPDF_html_a73e52ac5a6301ce1ea8a6b1a9fc45e71"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a73e52ac5a6301ce1ea8a6b1a9fc45e71">TCPDF\$diffs</a></div><div class="ttdeci">$diffs</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00336">tcpdf.php:336</a></div></div>
<div class="ttc" id="classTCPDF_html_ab3c410ce9315c42d12408f9982f626bc"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ab3c410ce9315c42d12408f9982f626bc">TCPDF\$HREF</a></div><div class="ttdeci">$HREF</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00704">tcpdf.php:704</a></div></div>
<div class="ttc" id="classTCPDF_html_afa577c56100df8d110993150ae9e05dd"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#afa577c56100df8d110993150ae9e05dd">TCPDF\$epsmarker</a></div><div class="ttdeci">$epsmarker</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01064">tcpdf.php:1064</a></div></div>
<div class="ttc" id="classTCPDF_html_a3ff8e789876c7376f95a614c8e2a8a7d"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a3ff8e789876c7376f95a614c8e2a8a7d">TCPDF\getFooterFont</a></div><div class="ttdeci">getFooterFont()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l10448">tcpdf.php:10448</a></div></div>
<div class="ttc" id="classTCPDF_html_abb40c80af416b4d177860872f5b27758"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#abb40c80af416b4d177860872f5b27758">TCPDF\SkewX</a></div><div class="ttdeci">SkewX($angle_x, $x='', $y='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l11307">tcpdf.php:11307</a></div></div>
<div class="ttc" id="classTCPDF_html_ab5d6a8d1d360e0845909cd24f4637266"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ab5d6a8d1d360e0845909cd24f4637266">TCPDF\$docinfounicode</a></div><div class="ttdeci">$docinfounicode</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00482">tcpdf.php:482</a></div></div>
<div class="ttc" id="classTCPDF_html_a1760eea2d8db110ab161f309c29d6fd1"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a1760eea2d8db110ab161f309c29d6fd1">TCPDF\$page</a></div><div class="ttdeci">$page</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00142">tcpdf.php:142</a></div></div>
<div class="ttc" id="classTCPDF_html_a1b321a324b9dde239fe1a61974174c7c"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a1b321a324b9dde239fe1a61974174c7c">TCPDF\registrationMark</a></div><div class="ttdeci">registrationMark($x, $y, $r, $double=false, $cola=array(100, 100, 100, 100,'All'), $colb=array(0, 0, 0, 0,'None'))</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l14357">tcpdf.php:14357</a></div></div>
<div class="ttc" id="classTCPDF_html_a4624d23bdfb5df6a8760b63602d8b203"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a4624d23bdfb5df6a8760b63602d8b203">TCPDF\setAlpha</a></div><div class="ttdeci">setAlpha($stroking=1, $bm='Normal', $nonstroking='', $ais=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l14027">tcpdf.php:14027</a></div></div>
<div class="ttc" id="classTCPDF_html_a9c8927b37b10208b3793fc9e05e14ab4"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a9c8927b37b10208b3793fc9e05e14ab4">TCPDF\$start_transaction_page</a></div><div class="ttdeci">$start_transaction_page</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01408">tcpdf.php:1408</a></div></div>
<div class="ttc" id="classTCPDF_html_a2a5521c59a12125acade8485634c04ec"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a2a5521c59a12125acade8485634c04ec">TCPDF\removePageRegion</a></div><div class="ttdeci">removePageRegion($key)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l22766">tcpdf.php:22766</a></div></div>
<div class="ttc" id="classTCPDF_html_a9dd28e7bb04ba8f881492d06f501bce5"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a9dd28e7bb04ba8f881492d06f501bce5">TCPDF\GetLineWidth</a></div><div class="ttdeci">GetLineWidth()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l11413">tcpdf.php:11413</a></div></div>
<div class="ttc" id="classTCPDF_html_abb8b93313ba45826395085b42bffdab8"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#abb8b93313ba45826395085b42bffdab8">TCPDF\$pages</a></div><div class="ttdeci">$pages</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00172">tcpdf.php:172</a></div></div>
<div class="ttc" id="classTCPDF_html_a647e9da3d08df82049ad403508fe247b"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a647e9da3d08df82049ad403508fe247b">TCPDF\Transform</a></div><div class="ttdeci">Transform($tm)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l11365">tcpdf.php:11365</a></div></div>
<div class="ttc" id="classTCPDF_html_ad46aa89be17efef08753845fb01fa901"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ad46aa89be17efef08753845fb01fa901">TCPDF\setDocModificationTimestamp</a></div><div class="ttdeci">setDocModificationTimestamp($time)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l10269">tcpdf.php:10269</a></div></div>
<div class="ttc" id="classTCPDF_html_a6decef4569cfd79d75e47cab1315fa77"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a6decef4569cfd79d75e47cab1315fa77">TCPDF\$cell_margin</a></div><div class="ttdeci">$cell_margin</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00288">tcpdf.php:288</a></div></div>
<div class="ttc" id="classTCPDF_html_af9d7a42a746c972f98d36e6fe7ab8f89"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#af9d7a42a746c972f98d36e6fe7ab8f89">TCPDF\SVGPath</a></div><div class="ttdeci">SVGPath($d, $style='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l23533">tcpdf.php:23533</a></div></div>
<div class="ttc" id="classTCPDF_html_a0199618a45cf13b30bf23d044e4c8103"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a0199618a45cf13b30bf23d044e4c8103">TCPDF\$colxshift</a></div><div class="ttdeci">$colxshift</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01464">tcpdf.php:1464</a></div></div>
<div class="ttc" id="classTCPDF_html_a2a3a0126924898c8bbf889ecd5f8b5b5"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a2a3a0126924898c8bbf889ecd5f8b5b5">TCPDF\$images</a></div><div class="ttdeci">$images</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00342">tcpdf.php:342</a></div></div>
<div class="ttc" id="classTCPDF_html_ab52fb17ae0baa062810c29dbcbba8179"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ab52fb17ae0baa062810c29dbcbba8179">TCPDF\$gradients</a></div><div class="ttdeci">$gradients</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00945">tcpdf.php:945</a></div></div>
<div class="ttc" id="classTCPDF_html_a4d385a5f09edf2774d73c67d774a4336"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a4d385a5f09edf2774d73c67d774a4336">TCPDF\addEmptySignatureAppearance</a></div><div class="ttdeci">addEmptySignatureAppearance($x=0, $y=0, $w=0, $h=0, $page=-1, $name='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l13585">tcpdf.php:13585</a></div></div>
<div class="ttc" id="classTCPDF_html_a5ff1d1bb3ba604c5cadff4388962432e"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a5ff1d1bb3ba604c5cadff4388962432e">TCPDF\getBorderStartPosition</a></div><div class="ttdeci">getBorderStartPosition()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l20013">tcpdf.php:20013</a></div></div>
<div class="ttc" id="classTCPDF_html_ad38280c03ec462b14d73b5c042ae7a76"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ad38280c03ec462b14d73b5c042ae7a76">TCPDF\$svgtextmode</a></div><div class="ttdeci">$svgtextmode</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01680">tcpdf.php:1680</a></div></div>
<div class="ttc" id="classTCPDF_html_aa81d4b585de305c054760ec983ed3ece"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aa81d4b585de305c054760ec983ed3ece">TCPDF\MultiCell</a></div><div class="ttdeci">MultiCell($w, $h, $txt, $border=0, $align='J', $fill=false, $ln=1, $x='', $y='', $reseth=true, $stretch=0, $ishtml=false, $autopadding=true, $maxh=0, $valign='T', $fitcell=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l05789">tcpdf.php:5789</a></div></div>
<div class="ttc" id="classTCPDF_html_a510ab21d6a373934bcd3bd4683704b7e"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a510ab21d6a373934bcd3bd4683704b7e">TCPDF\getPageWidth</a></div><div class="ttdeci">getPageWidth($pagenum='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02507">tcpdf.php:2507</a></div></div>
<div class="ttc" id="tcpdf__config_8php_html_af5215614354b049d4e070e92194b8acc"><div class="ttname"><a href="../../d5/dc0/tcpdf__config_8php.html#af5215614354b049d4e070e92194b8acc">K_SMALL_RATIO</a></div><div class="ttdeci">const K_SMALL_RATIO</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dc0/tcpdf__config_8php_source.html#l00205">tcpdf_config.php:205</a></div></div>
<div class="ttc" id="classTCPDF_html_a979b6d066b2a0a5cc1496907bc9841e6"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a979b6d066b2a0a5cc1496907bc9841e6">TCPDF\Skew</a></div><div class="ttdeci">Skew($angle_x, $angle_y, $x='', $y='')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l11334">tcpdf.php:11334</a></div></div>
<div class="ttc" id="classTCPDF_html_a8d831d202e6420fe8fa6aeae7d3a2e8e"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a8d831d202e6420fe8fa6aeae7d3a2e8e">TCPDF\SetX</a></div><div class="ttdeci">SetX($x, $rtloff=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l07468">tcpdf.php:7468</a></div></div>
<div class="ttc" id="classTCPDF_html_a574cf231b14aa43921ac83716b27b3e4"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a574cf231b14aa43921ac83716b27b3e4">TCPDF\adjustCellPadding</a></div><div class="ttdeci">adjustCellPadding($brd=0)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02721">tcpdf.php:2721</a></div></div>
<div class="ttc" id="classTCPDF_html_af26dfbff2e1507f87a2fae64eebe08e1"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#af26dfbff2e1507f87a2fae64eebe08e1">TCPDF\addHtmlLink</a></div><div class="ttdeci">addHtmlLink($url, $name, $fill=false, $firstline=false, $color='', $style=-1, $firstblock=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l10490">tcpdf.php:10490</a></div></div>
<div class="ttc" id="classTCPDF_html_a1fe3c9e300219815332728c0f2216856"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a1fe3c9e300219815332728c0f2216856">TCPDF\_putspotcolors</a></div><div class="ttdeci">_putspotcolors()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l09395">tcpdf.php:9395</a></div></div>
<div class="ttc" id="classTCPDF_html_a6b05e14a0ff7b12eb78f884cabd69e9b"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a6b05e14a0ff7b12eb78f884cabd69e9b">TCPDF\Annotation</a></div><div class="ttdeci">Annotation($x, $y, $w, $h, $text, $opt=array('Subtype'=&gt;'Text'), $spaces=0)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l04777">tcpdf.php:4777</a></div></div>
<div class="ttc" id="classTCPDF_html_aca1da710f70d3b0e756be97adf23418c"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aca1da710f70d3b0e756be97adf23418c">TCPDF\getFormDefaultProp</a></div><div class="ttdeci">getFormDefaultProp()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l12745">tcpdf.php:12745</a></div></div>
<div class="ttc" id="classTCPDF_html_a2b85f6395de14dd40cab8839b3ce25a8"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a2b85f6395de14dd40cab8839b3ce25a8">TCPDF\setPageBuffer</a></div><div class="ttdeci">setPageBuffer($page, $data, $append=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l20875">tcpdf.php:20875</a></div></div>
<div class="ttc" id="classTCPDF_html_a7eae5df3511dac591b5b76ab5d8b9a68"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a7eae5df3511dac591b5b76ab5d8b9a68">TCPDF\startTemplate</a></div><div class="ttdeci">startTemplate($w=0, $h=0, $group=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l22440">tcpdf.php:22440</a></div></div>
<div class="ttc" id="classTCPDF_html_a9d325db7b1243a5f1184b3c3365d588d"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a9d325db7b1243a5f1184b3c3365d588d">TCPDF\_OEvalue</a></div><div class="ttdeci">_OEvalue()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l10810">tcpdf.php:10810</a></div></div>
<div class="ttc" id="classTCPDF_html_adaa629208532173a3e3bc604f32c07d8"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#adaa629208532173a3e3bc604f32c07d8">TCPDF\$rasterize_vector_images</a></div><div class="ttdeci">$rasterize_vector_images</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01505">tcpdf.php:1505</a></div></div>
<div class="ttc" id="classTCPDF_html_aa064c22c3ff653664433fc4e05fa8efc"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aa064c22c3ff653664433fc4e05fa8efc">TCPDF\getCellCode</a></div><div class="ttdeci">getCellCode($w, $h=0, $txt='', $border=0, $ln=0, $align='', $fill=false, $link='', $stretch=0, $ignore_min_height=false, $calign='T', $valign='M')</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l05095">tcpdf.php:5095</a></div></div>
<div class="ttc" id="classTCPDF_html_a7a9badafb7fca4cb3d6fe7c5e771d79e"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a7a9badafb7fca4cb3d6fe7c5e771d79e">TCPDF\$header_title</a></div><div class="ttdeci">$header_title</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00649">tcpdf.php:649</a></div></div>
<div class="ttc" id="classTCPDF_html_ab4f165583b4f50a0a0bbf81eb346e4bb"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ab4f165583b4f50a0a0bbf81eb346e4bb">TCPDF\Gradient</a></div><div class="ttdeci">Gradient($type, $coords, $stops, $background=array(), $antialias=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l14588">tcpdf.php:14588</a></div></div>
<div class="ttc" id="classTCPDF_html_af18f6bdb79e68fd8ed6386d2bb98e9a2"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#af18f6bdb79e68fd8ed6386d2bb98e9a2">TCPDF\SetTextSpotColor</a></div><div class="ttdeci">SetTextSpotColor($name, $tint=100)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l03808">tcpdf.php:3808</a></div></div>
<div class="ttc" id="tcpdf__config_8php_html_aa677efad07ef009287d0490aa2eb21a2"><div class="ttname"><a href="../../d5/dc0/tcpdf__config_8php.html#aa677efad07ef009287d0490aa2eb21a2">K_CELL_HEIGHT_RATIO</a></div><div class="ttdeci">const K_CELL_HEIGHT_RATIO</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dc0/tcpdf__config_8php_source.html#l00195">tcpdf_config.php:195</a></div></div>
<div class="ttc" id="classTCPDF_html_a137bd1e5f930eda5324ce99afb9d1e40"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a137bd1e5f930eda5324ce99afb9d1e40">TCPDF\addHTMLTOC</a></div><div class="ttdeci">addHTMLTOC($page='', $toc_name='TOC', $templates=array(), $correct_align=true, $style='', $color=array(0, 0, 0))</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l21691">tcpdf.php:21691</a></div></div>
<div class="ttc" id="classTCPDF_html_a623785c4dc57739d845b36e810704a89"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a623785c4dc57739d845b36e810704a89">TCPDF\getSpaceString</a></div><div class="ttdeci">getSpaceString()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l17155">tcpdf.php:17155</a></div></div>
<div class="ttc" id="classTCPDF_html_abc3ef1743fa889f0190b61d80490a770"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#abc3ef1743fa889f0190b61d80490a770">TCPDF\_putdests</a></div><div class="ttdeci">_putdests()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l12377">tcpdf.php:12377</a></div></div>
<div class="ttc" id="classTCPDF_html_a4d9df541d8b8347b55b5d048566c769d"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a4d9df541d8b8347b55b5d048566c769d">TCPDF\_newobj</a></div><div class="ttdeci">_newobj()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l10136">tcpdf.php:10136</a></div></div>
<div class="ttc" id="classTCPDF_html_a5c834acaa7ef363abc6bca4ab8545432"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a5c834acaa7ef363abc6bca4ab8545432">TCPDF\GetAbsX</a></div><div class="ttdeci">GetAbsX()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l07444">tcpdf.php:7444</a></div></div>
<div class="ttc" id="classTCPDF_html_a79a37b42b7c47e3ec1f5f150129d3b3c"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a79a37b42b7c47e3ec1f5f150129d3b3c">TCPDF\endPage</a></div><div class="ttdeci">endPage($tocpage=false)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l03132">tcpdf.php:3132</a></div></div>
<div class="ttc" id="classTCPDF_html_a9240c96d0ce715acb3ebe8e8362202f7"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a9240c96d0ce715acb3ebe8e8362202f7">TCPDF\setPrintHeader</a></div><div class="ttdeci">setPrintHeader($val=true)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l03345">tcpdf.php:3345</a></div></div>
<div class="ttc" id="classTCPDF_html_ab7fb524bc243be585ab7fef00b434399"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ab7fb524bc243be585ab7fef00b434399">TCPDF\SVGTransform</a></div><div class="ttdeci">SVGTransform($tm)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l23228">tcpdf.php:23228</a></div></div>
<div class="ttc" id="classTCPDF_html_a98585a6dd732caf2ba4c0ae2d9aa9841"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a98585a6dd732caf2ba4c0ae2d9aa9841">TCPDF\$fgcolor</a></div><div class="ttdeci">$fgcolor</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00716">tcpdf.php:716</a></div></div>
<div class="ttc" id="classTCPDF_html_ac63fff093a17846764bbcc09af7c8640"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ac63fff093a17846764bbcc09af7c8640">TCPDF\getFontBuffer</a></div><div class="ttdeci">getFontBuffer($font)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l21026">tcpdf.php:21026</a></div></div>
<div class="ttc" id="classTCPDF_html_a1545ffbbb4d3e78ac3bf8413300016eb"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a1545ffbbb4d3e78ac3bf8413300016eb">TCPDF\$theadMargins</a></div><div class="ttdeci">$theadMargins</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01254">tcpdf.php:1254</a></div></div>
<div class="ttc" id="classTCPDF_html_a33ce8521d553c47b685d61d82bffbb5c"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a33ce8521d553c47b685d61d82bffbb5c">TCPDF\deletePage</a></div><div class="ttdeci">deletePage($page)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l21214">tcpdf.php:21214</a></div></div>
<div class="ttc" id="classTCPDF_html_a9a787786c9f1a04f54f1dec622869d4d"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a9a787786c9f1a04f54f1dec622869d4d">TCPDF\$FontSizePt</a></div><div class="ttdeci">$FontSizePt</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00410">tcpdf.php:410</a></div></div>
<div class="ttc" id="classTCPDF_html_a94d0edc7f6a71717a136e8408372cc22"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a94d0edc7f6a71717a136e8408372cc22">TCPDF\$svgdir</a></div><div class="ttdeci">$svgdir</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01603">tcpdf.php:1603</a></div></div>
<div class="ttc" id="classTCPDF_html_a7f6c277af6ed456e709c6b397cf34c51"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a7f6c277af6ed456e709c6b397cf34c51">TCPDF\setImageSubBuffer</a></div><div class="ttdeci">setImageSubBuffer($image, $key, $data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l20944">tcpdf.php:20944</a></div></div>
<div class="ttc" id="classTCPDF_html_a1454645fa7a1e35f6f8a634c0978ed2e"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a1454645fa7a1e35f6f8a634c0978ed2e">TCPDF\getFontFamilyName</a></div><div class="ttdeci">getFontFamilyName($fontfamily)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l22396">tcpdf.php:22396</a></div></div>
<div class="ttc" id="classTCPDF_html_a841a13b219f66597674ebac87deb03bb"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a841a13b219f66597674ebac87deb03bb">TCPDF\SetAbsY</a></div><div class="ttdeci">SetAbsY($y)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l07557">tcpdf.php:7557</a></div></div>
<div class="ttc" id="classTCPDF_html_a4f4b2eb6bd3ea30b0cfa58a10396736b"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a4f4b2eb6bd3ea30b0cfa58a10396736b">TCPDF\getCSSFontSpacing</a></div><div class="ttdeci">getCSSFontSpacing($spacing, $parent=0)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l16210">tcpdf.php:16210</a></div></div>
<div class="ttc" id="classTCPDF_html_a278cba1881265c0b47036a629a67863f"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a278cba1881265c0b47036a629a67863f">TCPDF\setContentMark</a></div><div class="ttdeci">setContentMark($page=0)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l03242">tcpdf.php:3242</a></div></div>
<div class="ttc" id="classTCPDF_html_ab7edf9bb8be446509d03a9c70eba3ca3"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ab7edf9bb8be446509d03a9c70eba3ca3">TCPDF\_puttruetypeunicode</a></div><div class="ttdeci">_puttruetypeunicode($font)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l08989">tcpdf.php:8989</a></div></div>
<div class="ttc" id="classTCPDF_html_a9dabd5e4c0295bd5caef55968375da9e"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a9dabd5e4c0295bd5caef55968375da9e">TCPDF\_putannotsobjs</a></div><div class="ttdeci">_putannotsobjs()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l08164">tcpdf.php:8164</a></div></div>
<div class="ttc" id="classTCPDF_html_aa9eb763490acb3dfdf3f0cf445e83ca6"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#aa9eb763490acb3dfdf3f0cf445e83ca6">TCPDF\setFontBuffer</a></div><div class="ttdeci">setFontBuffer($font, $data)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l20980">tcpdf.php:20980</a></div></div>
<div class="ttc" id="classTCPDF_html_a295aec7c13f7d3c3a5e3b17a8d833cb2"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a295aec7c13f7d3c3a5e3b17a8d833cb2">TCPDF\$svggradientid</a></div><div class="ttdeci">$svggradientid</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l01624">tcpdf.php:1624</a></div></div>
<div class="ttc" id="classTCPDF_html_ac467f297fed79882bcab2bf20d423efb"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#ac467f297fed79882bcab2bf20d423efb">TCPDF\SetTitle</a></div><div class="ttdeci">SetTitle($title)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l02873">tcpdf.php:2873</a></div></div>
<div class="ttc" id="classTCPDF_html_a2a7cc18749cac51d0efca5d491d9217c"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a2a7cc18749cac51d0efca5d491d9217c">TCPDF\setLanguageArray</a></div><div class="ttdeci">setLanguageArray($language)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l10458">tcpdf.php:10458</a></div></div>
<div class="ttc" id="classTCPDF_html_a26b593699320edd0a9e49fdf7acc0758"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a26b593699320edd0a9e49fdf7acc0758">TCPDF\getOverprint</a></div><div class="ttdeci">getOverprint()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l14014">tcpdf.php:14014</a></div></div>
<div class="ttc" id="classTCPDF_html_a2b9dd5ea5f109626189153dadd12f680"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a2b9dd5ea5f109626189153dadd12f680">TCPDF\$fwPt</a></div><div class="ttdeci">$fwPt</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l00208">tcpdf.php:208</a></div></div>
<div class="ttc" id="classTCPDF_html_a67b4394647eef529a62e103d20324a76"><div class="ttname"><a href="../../d4/d40/classTCPDF.html#a67b4394647eef529a62e103d20324a76">TCPDF\getImageRBX</a></div><div class="ttdeci">getImageRBX()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d6e/tcpdf_8php_source.html#l03363">tcpdf.php:3363</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Documentación SYSCAP 4.2.1 - Abril 2015
</small></address>
</body>
</html>
